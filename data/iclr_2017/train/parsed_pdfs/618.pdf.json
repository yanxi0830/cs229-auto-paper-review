{
  "name" : "618.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "DYNAMIC STEERABLE FRAME NETWORKS",
    "authors" : [ "Jörn-Henrik Jacobsen", "Bert De Brabandere", "Arnold W.M. Smeulders" ],
    "emails" : [ "j.jacobsen@uva.nl", "a.w.m.smeulders@uva.nl", "bert.debrabandere@esat.kuleuven.be" ],
    "sections" : [ {
      "heading" : "1 INTRODUCTION",
      "text" : "For images, as well as any other sensory data, convolutional networks are typically learned from individual pixel values. Using them as a basis of the learned parameters is the standard approach for almost all CNNs. In this paper, we argue, that the pixel basis is not necessarily the best choice for representing signals. We show, that suitable alternatives yield increased classification performance by replacement only, while such a replacement adds additional properties to the learned filters that allow us to transform them under arbitrary pre-defined Lie groups.\nFrom our perspective, the pixel values span an orthogonal basis for the filters in the network (in every layer). Such a pixel basis is complete as it may represent an arbitrary vector in Rn by linear combination, where n is the dimensionality of the filter. In this paper we consider alternatives to this basis, both orthogonal bases, and non-orthogonal frames, arriving at superior expressiveness through steerable function spaces that allow us to transform filters locally and continuously, conditioned on their input.\nUtilizing the steerability properties of frames in practice, we propose Dynamic Steerable Frame Networks (DSFNs) that fill the gap between Spatial Transformer Networks (STNs) (Jaderberg et al., 2015) and Dynamic Filter Networks (DFNs) (De Brabandere et al., 2016). STNs are not locally adaptive, thus they fail in many cases where it is not beneficial to transform the image globally as it would destroy discriminative information (multiple deformable objects, discriminative dynamic movements) or where global registration is performed as a preprocessing step (medical images).\nDFNs are overcoming this restriction by locally transforming filters instead of globally transforming the whole feature stack as STNs do. However, DFNs are black boxes and not data-efficient, as they introduce many unconstrained parameters. Such a behavior is undesirable when data is limited and interpretability is key. DSFNs are locally adaptive, interpretable and data-efficient. They overcome the weaknesses of both approaches by combining their strengths, as illustrated in multiple experiments.\nOur contributions:\n• We argue that suitable frame bases are beneficial when representing sensory data compared to the commonly used pixel basis.\n• Exploiting the transformation properties of frames further, we derive Dynamic Steerable Frame Networks that are able to continuously transform features locally and fill the gap between Spatial Transformer Networks and Dynamic Filter Networks.\n• Dynamic Steerable Frame Networks learn to separate pose and feature. This enables the network to be locally equivariant or invariant with respect to certain feature poses, or even to perform in network quasi data-augmentation, while only the inputs and the backpropagated error signals determine which and to what extent these are applied.\nWe introduce the generalized notion of frames to CNNs that extend possible bases to learn from to non-orthogonal and overcomplete sets without loss in generalization. We show that many choices are possible, while overcomplete, non-orthogonal bases consistently outperform the pixel basis when applied to a ResNet (He et al., 2016) for image classification, as illustrated on Cifar-10+. We derive the Dynamic Steerable Frame Networks, based on the notion of steerable frames, that can locally adapt the filters in every feature map, conditioned on the input. We illustrate the strength of the approach in an edge detection task, where it outperforms a Dynamic Filter Network. We further show in a limited data video classification task, that Dynamic Steerable Frame Networks improve classification performance over Spatial Transformer Networks when global invariance is not desirable."
    }, {
      "heading" : "2 DYNAMICALLY STEERABLE FRAME NETWORKS",
      "text" : ""
    }, {
      "heading" : "2.1 FRAMES",
      "text" : "Frames are a natural generalization of orthogonal bases (Christensen, 2003). In frame terminology, an orthonormal basis is a Parseval-tight frame with unit norm. Every tight frame preserves the signal norm and exhibits perfect reconstruction. Frames can be seen as a superset of orthogonal bases in the sense that every basis is a frame, but not the reverse, see figure 1. The advantage of considering frames over orthogonal bases is that intrinsic signal properties can be spelled out explicitly in the new representation with the advantage, that these properties are directly accessible during learning. From an overcomplete representation, it will be more easily visible which part of the features is robust and which part is sensitive to accidental noise variations.\nIn a standard convolutional network, a filter kernel is a linear combination over the standard basis for l2(N). The standard basis is composed from a delta function for every dimension and Wi is the ith filter of the network with parameters win:\ne1 = {1, 0, 0, ..., 0} e2 = {0, 1, 0, ..., 0} ...\nen = {0, 0, 0, ..., 1}\nWi = N∑ n=1 winen\nWithout loss of generalization the orthonormal standard basis can be replaced by a frame to include non-orthogonality, overcompleteness, increased symmetries or steerability into the representation. Changing from the pixel to an arbitrary frame is as simple as replacing the pixel basis en with a frame of choice with elements vn as follows:\nWi = N∑ n=1 winvn (1)\nwhere wi1, ..., w i n are again the filter coefficients being learned.\nIn practice for CNNs working on images we investigate derived bases from steerability requirements, orthogonal polynomials, Framelets and members of the Gaussian derivative family. See figure 2 for a selection of frames."
    }, {
      "heading" : "2.2 STEERING FRAMES UNDER ARBITRARY LIE-GROUPS",
      "text" : "A pleasant property of many frames is steerability (Unser & Chenouard, 2013; Hel-Or & Teo, 1998; Michaelis & Sommer, 1995), the power of a function to represent transformed versions of itself by linear combination. The advantage of steerability in CNNs working on images is the ability to produce infinitely many transformed variants of a visual feature fτ (x, y) ∈ R2 → R from its canonical appearance.\nTo achieve this goal we cast these variations as the result of the action of a family of transformations g(τ) on the canonical features f(x, y), where τ ∈ Rk parametrizes these k-parameter transformations. If the problem at hand requires the distinction between multiple unknown poses of the same feature in a typical CNN they all have to be computed exhaustively to determine if a particular pose is present or not. Things go out of hand when the search space is a continuous transformation group, such as the Lie group of affine transformations, requiring k →∞ number of feature maps which is computationally intractable or requires expensive searches over all possible transformations (Gens & Domingos, 2014). One way out is to coarsely sample a few equally spaced points on the equivariant transformation manifold or to restrict the space to a smaller group (Cohen & Welling, 2016; Dieleman et al., 2016). What remains, however, is that the number of resulting feature maps for more general groups quickly becomes infeasible. An elegant way to overcome these limitations is the concept of steerability by (Freeman & Adelson, 1991; Perona, 1992; Unser & Chenouard, 2013) which is taken as inspiration here.\nIn this work, we focus on Lie groups. Transformations g(τ) over a range constitute a Lie group if they are closed under composition, they are associative, they are invertible, there exists an identity element, and their maps for inverse and composition are infinitely differentiable (Hel-Or & Teo, 1998). Teo and colleagues (Teo & Hel-Or, 1998) have given the following definition.\nDefinition 1 (Steerability): A function f(x, y): R2 → R is steerable under a k-parameter Lie transformation group G if any transformation g(τ) ∈ G of f can be written as a linear combination of a fixed, finite set of frame functions φm(x, y):\ng(τ)f(x, y) = M∑ m=1 βm(τ)φm(x, y) = B T (τ)Φ(x, y) (2)\nWhere BT (τ) denote the collected steering functions describing the transformation and Φ(x, y) the collected steerable frame functions.\nA function steerable under a k-parameter Lie group is capable of representing infinitely many states of a particular set of transformations. In many cases, only a finite set of frame functions is needed to represent these. In CNN terms, this means that a limited number of feature maps are sufficient to represent complete continuous transformation groups when the frame functions and the steering functions are chosen appropriately. Finding appropriate frame functions is the biggest challenge in steering arbitrary functions over arbitrary Lie groups.\nTo study the action of a Lie group G on a function we use the close relation between the Lie group and its tangent space. The Algebra’s tangent space spanned by the group’s infinitesimal generators. The differential operators of the group action are obtained by computing the derivative of the group action with respect to its parameters at the identity element. A Lie Algebra can be considered as an ”infinitesimal” Lie group. If the group is simply connected, the group action on a visual feature f(x, y) can be obtained via the exponential map (Teo & Hel-Or, 1998):\ng(τ1, ..., τk)f(x, y) = e ( ∑k i=1 τiLi)f(x, y) (3)\nwhere\neτiLi = I + τiLi + 1\n2! τ2i L 2 i + ... (4)\nwhere Li are the group’s infinitesimal generators and I is the identity element. This implies that one can compute the Taylor expansion with respect to the desired transformation group parameters to obtain elements of the group. If a finite frame set is equivariant towards the desired transformation group (it contains the orbit of the function to be steered), the series expansion yields linearly dependent elements after a finite number of steps. Then the frame is globally steerable under the desired transformation group. If this is not the case, as for example when scaling a Gaussian function, a finite frame set is only sufficient to accurately steer the function over a bounded interval, the function is locally steerable, but not globally."
    }, {
      "heading" : "2.3 SEPARATING POSE AND CANONICAL APPEARANCE",
      "text" : "When training a CNN the functions represented by each feature naturally change from update to update. It is desirable to separate the frame functions from the effective features as learned by the network. In such a Structured Receptive Fields Network (RFNN) (Jacobsen et al., 2016), each filters parameters are not its mere pixel values, but the coefficients weighting the sum over a fixed frame set. Thus, analogous to equation 1, every effective filter Wi(x, y) has the following form:\nWi(x, y) = w i 1v1 + w i 2v2 + ...+ w i nvn, (5)\nwhere vn denotes the nth element of the frame.\nTo be able to separate a features pose from its canonical appearance, we are interested in a steerable version of an arbitrary filter Wi(x, y) under a k-parameter Lie group. From 5 follows:\ng(τ)Wi(x, y) = N∑ n=1 wing(τ)v i n. (6)\nAnd by substituting according to equation 2 it follows:\ng(τ)Wi(x, y) = N∑ n=1 win M∑ m=1 βm(τ)φm(x, y). (7)\nThus it is sufficient to determine the group action on the fixed frame by steering it to separate the canonical feature itself from its k-parameter variants, i.e. vin govern the weight of each frame coefficient to form a featureWi(x, y) and βm are the steering functions governing the transformation of g(τ) acting on Wi(x, y) as a whole. From now on learning and transforming features amounts to a point-wise multiplication of frame coefficients with cos, sin and exp activation functions, which is suitable for learning in a CNN."
    }, {
      "heading" : "2.4 DERIVING THE FRAME AND STEERING FUNCTIONS",
      "text" : "Now the problem is reduced to finding a suitable frame as a function space underlying the learned filters. There are many approaches to derive a function space that is closed under the desired transformation group and as we show, many options give rise to bases that work considerably well when inserted into state-of-the-art CNNs. The most straightforward way is to derive it from the group’s infinitesimal generators, for brevity we refer the interested reader to (Hel-Or & Teo, 1998) and directly cite some derived equivariant function spaces from the paper.\nOnce a frame is chosen, we can simply check if it is closed under the given transformation group by verifying for each generator Li that:\nLiΦ(x, y) = BiΦ(x, y), (8)\nwhere Bi is some finite dimensional n×nmatrix. If this is the case, the function space is equivariant under the transformation group and we can compute the steering equations of the group composed of multiple generators as: A(τ) = eτkBk · ... · eτ1B1 . (9) To arrive at a practical solution, we have to consider the problem that locally bounded functions can not be steered globally with a finite steerable frame. To achieve a suitable approximation for our case, we separate scaling into two parts, an inner {σx, σy} and an outer scale σa, where a stands for aperture. The inner scale can directly be steered via the above derivation and represents the slope of the local measurement taken by a filter, while the outer scale represents the size and shape of the filters receptive field. To achieve anisotropic receptive fields, we propose to first steer the scale at every pixel and steer the derived function space on this non-uniformly scaled grid, resulting in locally deformable receptive fields. Due to associativity of convolution, we can combine steering the derived function space and the receptive field scale into one operation. In this work, we use a second order approximation of the Gaussian that is capable of giving a good approximation to common CNN receptive field sizes 3x3, 5x5 and 7x7. For scaling over larger ranges, we recommend the spectral decomposition approach (Koutaki & Uchimura, 2014)."
    }, {
      "heading" : "2.5 DYNAMIC STEERABLE FRAME NETWORKS",
      "text" : "Estimating the local pose of a feature from a steerable function space is analytically intractable in the case of most multi-parameter groups. In this paper, we introduce the Dynamic Steerable Frame Network that combines the advantages of steerable function spaces with the power of neural network function estimators, by estimating pose parameters from a function space equivariant under the transformation group at hand. Specifically, our architecture is inspired by the recently introduced Dynamic Filter Networks (De Brabandere et al., 2016). The Dynamic Filter Network (DFN) generates one feature per location in a feature map, which boils down to a locally connected convolution layer, for which the parameters are generated by a different network that estimates them from the input, yielding a different filter kernel for every location in the input.\nThe DFN takes the form: O(x, y) = F x,yτ (I(x, y)), (10)\nwhere F x,yτ are generated by another network from the input. We propose the Dynamic Steerable Frame Network, where the parameters θ that condition the filter are pose transformation parameters of the steerable function space, estimated from the input, similar to how it is done in the Spatial Transformer Networks, just that in our case we aim for locally adaptive filters. The filters F x,yτ share the same set of weights in the whole feature map, so they represent the same canonical appearance everywhere. While their local pose is dynamically estimated by a Pose-Generating Network Ψ that takes the form:\nτ(x, y) = Ψ(I(x, y)). (11)\nThus, the canonical appearance is translation invariant, but its geometrical pose is not. In terms of equation 5, this means the set of win is fixed, but the frame v τ(x,y) n is locally transformed under a pre-defined k-parameter group with parameters τ . See figure 5 for an illustration.\nThe method consists of two parts: i) A Pose-Generating network estimating local pose parameters of a feature conditioned on the input from a steerable input space. ii) A Dynamic Filtering mechanism, convolving transformed versions of a feature with every location in the input feature map, based on the estimates of the pose generating network. Due to linearity of convolution, we can first perform a transformation of the input into the steerable frame space and in this space we perform i) and ii) as point-wise multiplications."
    }, {
      "heading" : "3 RELATED WORK",
      "text" : "Steerable Filters is a concept established early for signal processing. Initially introduced by (Freeman & Adelson, 1991), the concept was extended to the Steerable Pyramid by (Simoncelli & Freeman, 1995) and further extended to a Lie-group formulation by (Hel-Or & Teo, 1998; Michaelis & Sommer, 1995). Further, steerability has recently been extended to tight frames, presenting Simoncelli’s Steerable Pyramid and multiple other Wavelets arising as a special case of the non-orthogonal Riesz transform (Unser & Chenouard, 2013). Steerable pyramids have been applied to CNNs as a pre-processing step (Xue et al., 2016), but have not yet been learnable. We incorporate steerable frames in CNNs to increase their de facto expressiveness and to allow them to learn their configurations, rather than picking them a priori.\nConvolutional Networks with alternative bases have been proposed with various degrees of flexibility. A number of works utilizes change of basis to stabilize training and increase convergence behavior (Rippel et al., 2015; Arjovsky et al., 2015). Another line of research is concerned with complex-valued CNNs, either learned (Tygert et al., 2016), or fully designed like the Scattering networks (Bruna & Mallat, 2013; Oyallon & Mallat, 2015).\nScattering, as well as the complex-valued networks, rest upon a direct connection between the signal processing literature and CNNs. Inspired by the former, Structured Receptive Field Networks are learned from an overcomplete multi-scale frame, effectively improving performance for small datasets due to restricted feature spaces (Jacobsen et al., 2016). Also related is the work on Groupequivariant CNNs (Cohen & Welling, 2016) and Cyclic Pooling (Dieleman et al., 2016), where equivariance towards the dihedral group is theoretically guaranteed, yielding increased accuracy. Inspired by CNNs learned from alternative bases, we introduce the general principle of Frame-based convolutional networks that allow for non-orthogonal, overcomplete and steerable feature spaces.\nAnother way to impose structure onto CNN representations and subsequently increase their dataefficiency is to incorporate explicit geometrical transformations into them. Either by learning transformation operators and group representations (Cohen et al., 2014; Wang et al., 2009). Or by predefining the possible transformations, as done in Transforming Autoencoders (Hinton et al., 2011), which map their inputs from the image to pose space through a neural network. The Spatial Transformer Networks (Jaderberg et al., 2015) learn global transformation parameters in a similar way while applying them to a nonlinear co-registration of the feature stack to some learned pose. This yields especially high performance on tasks where centering the objects is beneficial. Dynamic Filter Networks move one step further and estimate filters for each location, conditioned on their input. These approaches are all dynamic in a sense that they condition their parameters on the input appearance. We combine the idea of Dynamic Filter Networks with explicit pose prediction into Dynamic Steerable Frame Networks that can estimate poses from continuous input space, conditioned on the input. As such, we overcome the difficulty of estimating local pose, while being able to separate pose and feature learning globally."
    }, {
      "heading" : "4 EXPERIMENTS",
      "text" : ""
    }, {
      "heading" : "4.1 GENERALIZING PIXELS TO FRAMES ON CIFAR-10+",
      "text" : "To show the validity of general frame representations, we compare different bases in a state-of-theart pre-activation deep residual network architecture (He et al., 2016) on the Cifar-10+ (Krizhevsky & Hinton, 2009) dataset with moderate data augmentation of crops and flips.\nWe evaluated our approach on multiple networks and network sizes. The setup used for the ResNet is as described in (He et al., 2016). The batch size is chosen to be 64 and we train for 164 epochs with the described learning rate decrease. The ResNet architectures used are without bottlenecks having 20, 56 and 110 layers. For the Densenets we follow (Huang et al., 2016) and evaluate on the K=12 and L=40, and the K=12 and L=100 models. We run our experiments in Keras (Chollet, 2015) and Tensorflow (Abadi et al., 2016). In the first experiment, we run the models on the standard pixel basis to get a viable baseline. Secondly, we replace the pixel-basis with widely-used frames that take natural image statistics into account, namely non-orthogonal, overcomplete Gaussian derivatives (Florack et al., 1992) and non-orthogonal framelets (Daubechies et al., 2003) in an alternating fashion, yielding superior performance compared to the pixel-basis by replacement only.\nWe also show that the naive xpyq frame (see table 1) performs consistently worse than the other two choices, as it does not take natural image properties into account, while it is important to mention that this 1% performance decrease also comes with additional properties that might be highly beneficial in particular tasks. We have also found orthogonal polynomials to not work very well (around 3% performance decrease), which is in line with our expectation that suitable frames should take natural image statistics into account. 2D frames are generated from 1D functions via the following generating process:\nFrame = {v0, v1, v2, v3} ⊗ {v0, v1, v2, v3}T . (12)\nThe results are reported in table 2. The fact that the pixel-basis can be replaced by steerable frames and performance even improves when the frame is chosen well, is remarkable, as this means every filter in the CNN enjoys additional properties, while performance improves in the standard setting already and finding suitable frames is not more expensive than running the same smallest CNN as many times as one has frames to choose from, as the performance we observed was consistent across multiple model sizes. Frame-based CNNs run at the same runtime as vanilla CNNs."
    }, {
      "heading" : "4.2 DYNAMIC STEERABLE FRAME NETWORKS",
      "text" : "In this section we report two experiments. The first experiment is an edge detection task, highlighting the difference between our approach and multiple baselines in a fine-grained pixel-wise labeling task. In the second experiment, we apply a 2D convolutional LSTM on a small hand gesture recognition video dataset to illustrate how the Dynamic Steerable Frame Network regularizes the model effectively and to illustrate its benefits over Spatial Transform Networks.\nThe model used in both experiments is learned from a steerable Gauss-Hermite frame. The Dynamic Steerable Frame Network consists of three processing steps. 1) Change to frame space on the input, 2) the Pose-Generating network estimates the pose from this transformed input, outputting a set of pose variables for each location in the image. 3) the steering functions derived in section 2.4 are applied to these pose variable maps and effectively act as nonlinear pose-parametrized activation functions that regularize the Pose-Generating network to output an explicitly interpretable pose space. Finally, a 1x1 convolution layer is applied to the already transformed output maps, representing the weights win, governing the canonical appearance of the ith feature map, see also figure 5. Dynamic Steerable Frame Networks run at the same computational cost as vanilla Dynamic Filter Networks."
    }, {
      "heading" : "4.2.1 EDGE DETECTION",
      "text" : "In this experiment, we compare a Dynamic Filter Network (De Brabandere et al., 2016) baseline with an autoencoder and a Dynamic Steerable Frame Network on the task of edge detection. The problem is formulated as a pixel-wise classification task and reported is the root mean-squared error on an unseen test set. The labels are the edges. The dataset is infinite, as we produce random blobs and create the edge labels with a standard scikit image function. The standard DFN can freely learn an input layer with 2 filters and 3 subsequent 1x1 layers that can non-linearly recombine the inputs, whereas the Frame DFN receives a steerable frame as an input, allowing it to leverage the finegrained orientation information without the need to learn it. The Dynamic Steerable Frame Network has the exact same architecture as the DFN but is geometrically regularized on its output as can be seen in figure 5, as an input it receives a first order Gauss-Hermite frame that can be steered globally towards rotation and locally towards scale.\nLocation varying methods are clearly superior in this task, compared to the location invariant autoencoder. The DFN increases its performance substantially when getting the steerable frame as an input, indicating its inability to learn a continuously transforming frame by itself. Finally, the Dynamic Steerable Frame Network clearly outperforms all baselines due to its ability to continuously transform its filters in a well-regularized manner. As an extra, we get the local feature pose for free from the output of the DSFN, the baseline has no notion of an explicit pose parameter, see figure 4."
    }, {
      "heading" : "4.2.2 SMALL SCALE VIDEO CLASSIFICATION",
      "text" : "To show the ability of the Dynamic Steerable Frame Network to effectively regularize in dynamic settings where poses play an important role and where Spatial Transformer Networks do not work well, we apply it on the task of Hand-Gesture Recognition. Namely, on the Cambridge Hand-Gesture dataset (Kim & Cipolla, 2009), consisting of 9 classes of hand movement and poses in 900 videos, we use 750 for training, 50 for validation and 100 for testing. The dataset is very small and contains classes where global movement plays an important role and thus provides a good test bed to show effectiveness of the DSFN regularization ability compared to Spatial Transformers.\nOur baseline model is a convolutional LSTM with 10 output feature maps, batch normalization and a dense layer for classification. As a second baseline, we increase the capacity of the model by adding a second LSTM layer and a second batch normalization step. We combine two instances of a Spatial Transformer Network with a convolutional LSTM, one that can perform full affine transformations and one that is restricted to rotation and scaling. The DSFN module is applied to the input layer of the smaller model with 4 output feature maps. The setup of the steerable frame used in this model is a Gauss-Hermite frame.\nThe steerability is uniquely parametrized as: {BsBθ}. Allowing for scaling and rotation. Both Spatial Transformer Networks do not manage to learn useful warps of the input image and therefore decrease performance of the baseline. The affine model only manages to correctly classify multiple instances of a static class that has no movement information related to its label, while the rot/scale model increases performance, but still does not manage to learn useful scalings or rotations. The DSFN manages to learn locally rotation and scale invariant filters, that follow the boundaries and other features across the video as desired. Results are reported in Table 3.\nFor visualizations of the learned transformations, see Appendix A. The results illustrate the effectiveness of the DSFN to regularize the LSTM on a small-scale task where mostly local invariance is desired, but global invariance destroys most of the class-specific information. The DSFN improves performance over the baseline by about 22%, while the Spatial Transformer Network decreases performance by about 15%, or even to random in the full-affine case."
    }, {
      "heading" : "5 DISCUSSION",
      "text" : "We have introduced the notion of Frame-based convolutional networks. Our experiments illustrate that a simple replacement of the standard basis by a frame suitable for natural images leads to increased performance.\nThe insight that multiple frames can be considered as viable spanning sets for CNN representations leads us to steerable frames whose properties we exploit explicitly in our derived Dynamic Steerable Frame Networks, such that they can readily be accessed during training. The proposed method is a hybrid of Dynamic Filter Networks and Spatial Transformer Networks, enabling locally adaptive filtering with geometrical constraints.\nWe illustrate the effectiveness of the approach on an edge detection task, that requires fine-grained pixel-wise labeling, where Dynamic Steerable Frame Networks outperform a standard Dynamic Filter Network and an autoencoder baseline. Further, we illustrate the ability of the Dynamic Steerable Frame Network to regularize recurrent networks in a small-data video classification scenario where Spatial Transformer Networks fail to learn meaningful transformations.\nFuture work is to apply the model to other problem domains like egocentric video, robotics applications, as well as volumetric medical imaging videos of moving organs. We expect our Dynamic Steerable Frame Network approach to be beneficial in any problem where spatiotemporal continuity, data-efficiency, or interpretable pose spaces are key."
    }, {
      "heading" : "ACKNOWLEDGEMENTS",
      "text" : "We would like to thank Edouard Oyallon and Taco Cohen for insightful comments and discussions."
    }, {
      "heading" : "APPENDIX A VISUALIZING DSFN AND STN TRANSFORMATIONS",
      "text" : ""
    }, {
      "heading" : "APPENDIX B EQUIVARIANCE PROOF & STEERING EQUATION DERIVATION",
      "text" : "To prove that a frame is equivariant with respect to the action of a group transformation, determined by its generator Li, we simply have to show that:\nLiΦ(x, y) = BiΦ(x, y), (13)\nWhere Bi is some n× n matrix. In case of the Hermite polynomials (here considered up to second order), we have:\nΦ(x, y) = {1, x, y, x2 − 1, xy, y2 − 1}. (14)\nTo verify that these functions span an equivariant function space with respect to rotation, we apply the generator of rotations to the frame and verify that equation 13 holds. The generator of rotations\nin the plane is given by Lr = −x ddy + y d dx , applied to each frame element, we get:\nLrΦ(x, y) =  0 y −x 2xy\n−x2 + y2 −2xy\n = Br  1 x y x2 − 1 xy\ny2 − 1  . (15) It is straightforward to solve this linear system and obtain the 6× 6 matrix Br:\nBr =  0 0 0 0 0 0 0 0 1 0 0 0 0 −1 0 0 0 0 0 0 0 0 2 0 0 0 0 −1 0 1 0 0 0 0 −2 0  . Thus, we have proven that the function space is closed under the action of the group and the Hermite polynomials constitute an equivariant function space with respect to rotation.\nSubsequently, the exponential map directly yields the steering equations collected in the interpolation matrix Aθ, that can rotate the whole frame by θ:\nΦθ(x, y) =eθBrΦ(x, y) = AθΦ(x, y),\nΦθ(x, y) =  1 0 0 0 0 0 0 cos θ sin θ 0 0 0 0 − sin θ cos θ 0 0 0 0 0 0 12 + 1 2 cos 2θ sin 2θ 1 2 − 1 2 cos 2θ\n0 0 0 − 12 sin 2θ cos 2θ 1 2 sin 2θ 0 0 0 12 − 1 2 cos 2θ − sin 2θ 1 2 + 1 2 cos 2θ\n  1 x y x2 − 1 xy\ny2 − 1\n .\nΦθ(x, y) is the frame rotated by some angle θ. Combining this result with equation 7, gives us the possibility to rotate any learned feature by arbitrary and continuous angles θ. The whole procedure is completely analogous for any other Lie group transformation. Further, k-parameter transformation groups can be composed according to equation 9 from smaller groups. Here an example of the general linear group of rotation, anisotropic scalings and skew:\nΦ{θ1,sx,sy,θ2}(x, y) = A{θ1,sx,sy,θ2}Φ(x, y) = eθ2Br · esxBsx · esyBsy · eθ1BrΦ(x, y). (16)"
    }, {
      "heading" : "APPENDIX C BACKPROPAGATION THROUGH STEERABLE FILTERS",
      "text" : "Will be added to final manuscript."
    } ],
    "references" : [ {
      "title" : "Tensorflow: Large-scale machine learning on heterogeneous distributed systems",
      "author" : [ "Martın Abadi", "Ashish Agarwal", "Paul Barham", "Eugene Brevdo", "Zhifeng Chen", "Craig Citro", "Greg S Corrado", "Andy Davis", "Jeffrey Dean", "Matthieu Devin" ],
      "venue" : "arXiv preprint arXiv:1603.04467,",
      "citeRegEx" : "Abadi et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Abadi et al\\.",
      "year" : 2016
    }, {
      "title" : "Unitary evolution recurrent neural networks",
      "author" : [ "Martin Arjovsky", "Amar Shah", "Yoshua Bengio" ],
      "venue" : "arXiv preprint arXiv:1511.06464,",
      "citeRegEx" : "Arjovsky et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Arjovsky et al\\.",
      "year" : 2015
    }, {
      "title" : "Invariant scattering convolution networks",
      "author" : [ "Joan Bruna", "Stéphane Mallat" ],
      "venue" : "IEEE transactions on pattern analysis and machine intelligence,",
      "citeRegEx" : "Bruna and Mallat.,? \\Q2013\\E",
      "shortCiteRegEx" : "Bruna and Mallat.",
      "year" : 2013
    }, {
      "title" : "An introduction to frames and Riesz bases, volume 7",
      "author" : [ "Ole Christensen" ],
      "venue" : null,
      "citeRegEx" : "Christensen.,? \\Q2003\\E",
      "shortCiteRegEx" : "Christensen.",
      "year" : 2003
    }, {
      "title" : "Learning the irreducible representations of commutative lie groups",
      "author" : [ "Taco Cohen", "Max Welling" ],
      "venue" : "In ICML, pp",
      "citeRegEx" : "Cohen and Welling,? \\Q2014\\E",
      "shortCiteRegEx" : "Cohen and Welling",
      "year" : 2014
    }, {
      "title" : "Group equivariant convolutional networks",
      "author" : [ "Taco S Cohen", "Max Welling" ],
      "venue" : "arXiv preprint arXiv:1602.07576,",
      "citeRegEx" : "Cohen and Welling.,? \\Q2016\\E",
      "shortCiteRegEx" : "Cohen and Welling.",
      "year" : 2016
    }, {
      "title" : "Framelets: Mra-based constructions of wavelet frames",
      "author" : [ "Ingrid Daubechies", "Bin Han", "Amos Ron", "Zuowei Shen" ],
      "venue" : "Applied and computational harmonic analysis,",
      "citeRegEx" : "Daubechies et al\\.,? \\Q2003\\E",
      "shortCiteRegEx" : "Daubechies et al\\.",
      "year" : 2003
    }, {
      "title" : "Dynamic filter networks",
      "author" : [ "Bert De Brabandere", "Xu Jia", "Tinne Tuytelaars", "Luc Van Gool" ],
      "venue" : "arXiv preprint arXiv:1605.09673,",
      "citeRegEx" : "Brabandere et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Brabandere et al\\.",
      "year" : 2016
    }, {
      "title" : "Exploiting cyclic symmetry in convolutional neural networks",
      "author" : [ "Sander Dieleman", "Jeffrey De Fauw", "Koray Kavukcuoglu" ],
      "venue" : "arXiv preprint arXiv:1602.02660,",
      "citeRegEx" : "Dieleman et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Dieleman et al\\.",
      "year" : 2016
    }, {
      "title" : "Scale and the differential structure of images",
      "author" : [ "Luc MJ Florack", "Bart M ter Haar Romeny", "Jan J Koenderink", "Max A Viergever" ],
      "venue" : "Image and Vision Computing,",
      "citeRegEx" : "Florack et al\\.,? \\Q1992\\E",
      "shortCiteRegEx" : "Florack et al\\.",
      "year" : 1992
    }, {
      "title" : "The design and use of steerable filters",
      "author" : [ "William T Freeman", "Edward H Adelson" ],
      "venue" : "IEEE Transactions on Pattern analysis and machine intelligence,",
      "citeRegEx" : "Freeman and Adelson.,? \\Q1991\\E",
      "shortCiteRegEx" : "Freeman and Adelson.",
      "year" : 1991
    }, {
      "title" : "Deep symmetry networks",
      "author" : [ "Robert Gens", "Pedro M Domingos" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "Gens and Domingos.,? \\Q2014\\E",
      "shortCiteRegEx" : "Gens and Domingos.",
      "year" : 2014
    }, {
      "title" : "Identity mappings in deep residual networks",
      "author" : [ "Kaiming He", "Xiangyu Zhang", "Shaoqing Ren", "Jian Sun" ],
      "venue" : "arXiv preprint arXiv:1603.05027,",
      "citeRegEx" : "He et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "He et al\\.",
      "year" : 2016
    }, {
      "title" : "Canonical decomposition of steerable functions",
      "author" : [ "Yacov Hel-Or", "Patrick C Teo" ],
      "venue" : "Journal of Mathematical Imaging and Vision,",
      "citeRegEx" : "Hel.Or and Teo.,? \\Q1998\\E",
      "shortCiteRegEx" : "Hel.Or and Teo.",
      "year" : 1998
    }, {
      "title" : "Transforming auto-encoders",
      "author" : [ "Geoffrey E Hinton", "Alex Krizhevsky", "Sida D Wang" ],
      "venue" : "In International Conference on Artificial Neural Networks,",
      "citeRegEx" : "Hinton et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2011
    }, {
      "title" : "Densely connected convolutional networks",
      "author" : [ "Gao Huang", "Zhuang Liu", "Kilian Q Weinberger" ],
      "venue" : "arXiv preprint arXiv:1608.06993,",
      "citeRegEx" : "Huang et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Huang et al\\.",
      "year" : 2016
    }, {
      "title" : "Structured receptive fields in cnns",
      "author" : [ "Jörn-Henrik Jacobsen", "Jan van Gemert", "Zhongyu Lou", "Arnold W.M. Smeulders" ],
      "venue" : null,
      "citeRegEx" : "Jacobsen et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Jacobsen et al\\.",
      "year" : 2016
    }, {
      "title" : "Spatial transformer networks",
      "author" : [ "Max Jaderberg", "Karen Simonyan", "Andrew Zisserman" ],
      "venue" : "In Advances in Neural Information Processing Systems, pp. 2017–2025,",
      "citeRegEx" : "Jaderberg et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Jaderberg et al\\.",
      "year" : 2015
    }, {
      "title" : "Canonical correlation analysis of video volume tensors for action categorization and detection",
      "author" : [ "Tae-Kyun Kim", "Roberto Cipolla" ],
      "venue" : "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
      "citeRegEx" : "Kim and Cipolla.,? \\Q2009\\E",
      "shortCiteRegEx" : "Kim and Cipolla.",
      "year" : 2009
    }, {
      "title" : "Scale-space processing using polynomial representations",
      "author" : [ "Gou Koutaki", "Keiichi Uchimura" ],
      "venue" : "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,",
      "citeRegEx" : "Koutaki and Uchimura.,? \\Q2014\\E",
      "shortCiteRegEx" : "Koutaki and Uchimura.",
      "year" : 2014
    }, {
      "title" : "Learning multiple layers of features from tiny images",
      "author" : [ "Alex Krizhevsky", "Geoffrey Hinton" ],
      "venue" : null,
      "citeRegEx" : "Krizhevsky and Hinton.,? \\Q2009\\E",
      "shortCiteRegEx" : "Krizhevsky and Hinton.",
      "year" : 2009
    }, {
      "title" : "A lie group approach to steerable filters",
      "author" : [ "Markus Michaelis", "Gerald Sommer" ],
      "venue" : "Pattern Recognition Letters,",
      "citeRegEx" : "Michaelis and Sommer.,? \\Q1995\\E",
      "shortCiteRegEx" : "Michaelis and Sommer.",
      "year" : 1995
    }, {
      "title" : "Deep roto-translation scattering for object classification",
      "author" : [ "Edouard Oyallon", "Stéphane Mallat" ],
      "venue" : "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,",
      "citeRegEx" : "Oyallon and Mallat.,? \\Q2015\\E",
      "shortCiteRegEx" : "Oyallon and Mallat.",
      "year" : 2015
    }, {
      "title" : "Steerable-scalable kernels for edge detection and junction analysis",
      "author" : [ "Pietro Perona" ],
      "venue" : "In ECCV,",
      "citeRegEx" : "Perona.,? \\Q1992\\E",
      "shortCiteRegEx" : "Perona.",
      "year" : 1992
    }, {
      "title" : "Spectral representations for convolutional neural networks",
      "author" : [ "Oren Rippel", "Jasper Snoek", "Ryan P Adams" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Rippel et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Rippel et al\\.",
      "year" : 2015
    }, {
      "title" : "Lie generators for computing steerable functions",
      "author" : [ "Patrick C Teo", "Yacov Hel-Or" ],
      "venue" : "Pattern Recognition Letters,",
      "citeRegEx" : "Teo and Hel.Or.,? \\Q1998\\E",
      "shortCiteRegEx" : "Teo and Hel.Or.",
      "year" : 1998
    }, {
      "title" : "A mathematical motivation for complex-valued convolutional networks",
      "author" : [ "Mark Tygert", "Joan Bruna", "Soumith Chintala", "Yann LeCun", "Serkan Piantino", "Arthur Szlam" ],
      "venue" : "Neural computation,",
      "citeRegEx" : "Tygert et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Tygert et al\\.",
      "year" : 2016
    }, {
      "title" : "A unifying parametric framework for 2d steerable wavelet transforms",
      "author" : [ "Michael Unser", "Nicolas Chenouard" ],
      "venue" : "SIAM Journal on Imaging Sciences,",
      "citeRegEx" : "Unser and Chenouard.,? \\Q2013\\E",
      "shortCiteRegEx" : "Unser and Chenouard.",
      "year" : 2013
    } ],
    "referenceMentions" : [ {
      "referenceID" : 17,
      "context" : "Utilizing the steerability properties of frames in practice, we propose Dynamic Steerable Frame Networks (DSFNs) that fill the gap between Spatial Transformer Networks (STNs) (Jaderberg et al., 2015) and Dynamic Filter Networks (DFNs) (De Brabandere et al.",
      "startOffset" : 175,
      "endOffset" : 199
    }, {
      "referenceID" : 12,
      "context" : "We show that many choices are possible, while overcomplete, non-orthogonal bases consistently outperform the pixel basis when applied to a ResNet (He et al., 2016) for image classification, as illustrated on Cifar-10+.",
      "startOffset" : 146,
      "endOffset" : 163
    }, {
      "referenceID" : 3,
      "context" : "Frames are a natural generalization of orthogonal bases (Christensen, 2003).",
      "startOffset" : 56,
      "endOffset" : 75
    }, {
      "referenceID" : 8,
      "context" : "One way out is to coarsely sample a few equally spaced points on the equivariant transformation manifold or to restrict the space to a smaller group (Cohen & Welling, 2016; Dieleman et al., 2016).",
      "startOffset" : 149,
      "endOffset" : 195
    }, {
      "referenceID" : 23,
      "context" : "An elegant way to overcome these limitations is the concept of steerability by (Freeman & Adelson, 1991; Perona, 1992; Unser & Chenouard, 2013) which is taken as inspiration here.",
      "startOffset" : 79,
      "endOffset" : 143
    }, {
      "referenceID" : 16,
      "context" : "In such a Structured Receptive Fields Network (RFNN) (Jacobsen et al., 2016), each filters parameters are not its mere pixel values, but the coefficients weighting the sum over a fixed frame set.",
      "startOffset" : 53,
      "endOffset" : 76
    }, {
      "referenceID" : 24,
      "context" : "A number of works utilizes change of basis to stabilize training and increase convergence behavior (Rippel et al., 2015; Arjovsky et al., 2015).",
      "startOffset" : 99,
      "endOffset" : 143
    }, {
      "referenceID" : 1,
      "context" : "A number of works utilizes change of basis to stabilize training and increase convergence behavior (Rippel et al., 2015; Arjovsky et al., 2015).",
      "startOffset" : 99,
      "endOffset" : 143
    }, {
      "referenceID" : 26,
      "context" : "Another line of research is concerned with complex-valued CNNs, either learned (Tygert et al., 2016), or fully designed like the Scattering networks (Bruna & Mallat, 2013; Oyallon & Mallat, 2015).",
      "startOffset" : 79,
      "endOffset" : 100
    }, {
      "referenceID" : 16,
      "context" : "Inspired by the former, Structured Receptive Field Networks are learned from an overcomplete multi-scale frame, effectively improving performance for small datasets due to restricted feature spaces (Jacobsen et al., 2016).",
      "startOffset" : 198,
      "endOffset" : 221
    }, {
      "referenceID" : 8,
      "context" : "Also related is the work on Groupequivariant CNNs (Cohen & Welling, 2016) and Cyclic Pooling (Dieleman et al., 2016), where equivariance towards the dihedral group is theoretically guaranteed, yielding increased accuracy.",
      "startOffset" : 93,
      "endOffset" : 116
    }, {
      "referenceID" : 14,
      "context" : "Or by predefining the possible transformations, as done in Transforming Autoencoders (Hinton et al., 2011), which map their inputs from the image to pose space through a neural network.",
      "startOffset" : 85,
      "endOffset" : 106
    }, {
      "referenceID" : 17,
      "context" : "The Spatial Transformer Networks (Jaderberg et al., 2015) learn global transformation parameters in a similar way while applying them to a nonlinear co-registration of the feature stack to some learned pose.",
      "startOffset" : 33,
      "endOffset" : 57
    }, {
      "referenceID" : 12,
      "context" : "To show the validity of general frame representations, we compare different bases in a state-of-theart pre-activation deep residual network architecture (He et al., 2016) on the Cifar-10+ (Krizhevsky & Hinton, 2009) dataset with moderate data augmentation of crops and flips.",
      "startOffset" : 153,
      "endOffset" : 170
    }, {
      "referenceID" : 12,
      "context" : "The setup used for the ResNet is as described in (He et al., 2016).",
      "startOffset" : 49,
      "endOffset" : 66
    }, {
      "referenceID" : 15,
      "context" : "For the Densenets we follow (Huang et al., 2016) and evaluate on the K=12 and L=40, and the K=12 and L=100 models.",
      "startOffset" : 28,
      "endOffset" : 48
    }, {
      "referenceID" : 0,
      "context" : "We run our experiments in Keras (Chollet, 2015) and Tensorflow (Abadi et al., 2016).",
      "startOffset" : 63,
      "endOffset" : 83
    }, {
      "referenceID" : 9,
      "context" : "Secondly, we replace the pixel-basis with widely-used frames that take natural image statistics into account, namely non-orthogonal, overcomplete Gaussian derivatives (Florack et al., 1992) and non-orthogonal framelets (Daubechies et al.",
      "startOffset" : 167,
      "endOffset" : 189
    }, {
      "referenceID" : 6,
      "context" : ", 1992) and non-orthogonal framelets (Daubechies et al., 2003) in an alternating fashion, yielding superior performance compared to the pixel-basis by replacement only.",
      "startOffset" : 37,
      "endOffset" : 62
    } ],
    "year" : 2017,
    "abstractText" : "Filters in a convolutional network are typically parametrized in a pixel basis. As an orthonormal basis, pixels may represent any arbitrary vector in R. In this paper, we relax this orthonormality requirement and extend the set of viable bases to the generalized notion of frames. When applying suitable frame bases to ResNets on Cifar-10+ we demonstrate improved error rates by substitution only. By exploiting the transformation properties of such generalized bases, we arrive at steerable frames, that allow to continuously transform CNN filters under arbitrary Lie-groups. Further allowing us to locally separate pose from canonical appearance. We implement this in the Dynamic Steerable Frame Network, that dynamically estimates the transformations of filters, conditioned on its input. The derived method presents a hybrid of Dynamic Filter Networks and Spatial Transformer Networks that can be implemented in any convolutional architecture, as we illustrate in two examples. First, we illustrate estimation properties of steerable frames with a Dynamic Steerable Frame Network, compared to a Dynamic Filter Network on the task of edge detection, where we show clear advantages of the derived steerable frames. Lastly, we insert the Dynamic Steerable Frame Network as a module in a convolutional LSTM on the task of limited-data hand-gesture recognition from video and illustrate effective dynamic regularization and show clear advantages over Spatial Transformer Networks. In this paper, we have laid out the foundations of Frame-based convolutional networks and Dynamic Steerable Frame Networks while illustrating their advantages for continuously transforming features and data-efficient learning.",
    "creator" : "LaTeX with hyperref package"
  }
}