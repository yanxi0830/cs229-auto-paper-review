{
  "name" : "1604.03930.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Efficient Algorithms for Large-scale Generalized Eigenvector Computation and Canonical Correlation Analysis",
    "authors" : [ "Rong Ge", "Chi Jin", "Sham M. Kakade", "Praneeth Netrapalli", "Aaron Sidford" ],
    "emails" : [ "rongge@cs.duke.edu", "chijin@cs.berkeley.edu", "sham@cs.washington.edu", "praneeth@microsoft.com", "asid@microsoft.com" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n60 4.\n03 93\n0v 2\n[ cs\n.L G\n] 2\n7 M\nWe provide simple iterative algorithms, with improved runtimes, for solving these problems that are globally linearly convergent with moderate dependencies on the condition numbers and eigenvalue gaps of the matrices involved.\nWe obtain our results by reducing CCA to the top-k generalized eigenvector problem. We solve this problem through a general framework that simply requires black box access to an approximate linear system solver. Instantiating this framework with accelerated gradient descent we obtain a running time of O ( zk √ κ\nρ log(1/ǫ) log (kκ/ρ)\n) where z is the total number of nonzero\nentries, κ is the condition number and ρ is the relative eigenvalue gap of the appropriate matrices. Our algorithm is linear in the input size and the number of components k up to a log(k) factor. This is essential for handling large-scale matrices that appear in practice. To the best of our knowledge this is the first such algorithm with global linear convergence. We hope that our results prompt further research and ultimately improve the practical running time for performing these important data analysis procedures on large data sets."
    }, {
      "heading" : "1 Introduction",
      "text" : "Canonical-correlation analysis (CCA) and the generalized eigenvector problem are fundamental problems in scientific computing, data analysis, and statistics (Barnett and Preisendorfer, 1987; Friman et al., 2001).\nThese problems arise naturally in statistical settings. Let X,Y ∈ Rn×d denote two large sets of data points, with empirical covariance matrices Sx = 1 nX ⊤X, Sy = 1 nY ⊤Y, and Sxy = 1 nX\n⊤Y and suppose we wish to find features x,y ∈ Rd that best encapsulate the similarity or dissimilarity\n∗Duke University. Email: rongge@cs.duke.edu †UC Berkeley. Email: chijin@cs.berkeley.edu ‡University of Washington. Email: sham@cs.washington.edu §Microsoft Research New England. Email: praneeth@microsoft.com ¶Microsoft Research New England. Email: asid@microsoft.com\nof the data sets. CCA is the problem of maximizing the empirical correlation\nmax x⊤Sxxx=1 and y⊤Syyy=1\nx⊤Sxyy (1)\nand thereby extracts common features of the data sets. On the other hand the generalized eigenvalue problems\nmax x 6=0 x⊤Sxxx x⊤Syyx and max y 6=0 y⊤Syyy y⊤Sxxy\ncompute features that maximizes discrepancies between the data sets. Both these problems are easily extended to the k-feature case (See Section 3). Algorithms for solving them are commonly used to extract features to compare and contrast large data sets and are used commonly in regression (Kakade and Foster, 2007), clustering (Chaudhuri et al., 2009), classification (Karampatziakis and Mineiro, 2013), word embeddings (Dhillon et al., 2011) and more.\nDespite the prevalence of these problems and the breadth of research on solving them in practice ((Barnett and Preisendorfer, 1987; Barnston and Ropelewski, 1992; Sherry and Henson, 2005; Karampatziakis and Mineiro, 2013) to name a few), there are relatively few results on obtaining provably efficient algorithms. Both problems can be reduced to performing principle component analysis (PCA), albeit on complicated matrices e.g S −1/2 yy S ⊤ xyS −1 xxSxyS −1/2 yy for CCA and S −1/2 yy SxxS −1/2 yy for generalized eigenvector. However applying PCA to these matrices traditionally involves the formation of S −1/2 xx and S −1/2 yy which is prohibitive for sufficiently large datasets if we only want to estimate top-k eigenspace.\nA natural open question in this area is to what degree can the formation of S −1/2 xx and S −1/2 yy can be bypassed to obtain efficient scalable algorithms in the case where the number of features k is much smaller than the dimensions of the problem n and d. Can we develop simple iterative practical methods that solve this problem in close to linear time when k is small and the condition number and eigenvalue gaps are bounded? While there has been recent work on solving these problems using iterative methods (Avron et al., 2014; Paul, 2015; Lu and Foster, 2014; Ma et al., 2015) we are unaware of previous provable global convergence results and more strongly, linearly convergent scalable algorithms.\nThe central goal of this paper is to answer this question in the affirmative. We present simple globally linearly convergent iterative methods that solve these problems. The running time of these problems scale well as the number of features and conditioning of the problem stay fixed and the size of the datasets grow. Moreover, we implement the method and perform experiments demonstrating that the techniques may be effective for large scale problems.\nSpecializing our results to the single feature case we show how to solve the problems all in time\nO(z √ κ\nρ log 1 ρ log 1 ǫ ), where κ is the maximum of condition numbers of Sxx and Syy and ρ is the\neigengap of appropriate matrices and mentioned above, and z is the number of nonzero entries in X and Y. To the best of our knowledge this is the first such globally linear convergent algorithm for solving these problems.\nWe achieve our results through a general and versatile framework that allows us to utilize fast linear system solvers in various regimes. We hope that by initiating this theoretical and practical analysis of CCA and the generalized eigenvector problem we can promote further research on the problem and ultimately advance the state-of-the-art for efficient data analysis."
    }, {
      "heading" : "1.1 Our Approach",
      "text" : "To solve the problems motivated in the previous section we first directly reduce CCA to a generalized eigenvector problem (See Section 5). Consequently, for the majority of the paper we focus on the following:\nDefinition 1 (Top-k Generalized Eigenvector1). Given symmetric matrices A,B where B is positive definite compute w1, · · · ,wk defined for all i ∈ [k] by\nwi ∈ argmax w\n∣∣∣w⊤Aw ∣∣∣ s.t. w ⊤Bw = 1 and w⊤Bwj = 0 ∀ j ∈ [i− 1].\nThe generalized eigenvector is equivalent to the problem of computing the PCA of A in the B norm. Consequently, it is the same as computing the top k eigenvectors of largest absolute value of the symmetric matrix M = B−1/2AB−1/2 and then multiplying by B−1/2.\nUnfortunately, as we have discussed, explicitly computing B−1/2 is prohibitively expensive when n is large and therefore we wish to avoid forming M explicitly. One natural approach is to develop an iterative methods to approximately apply B−1/2 to a vector and then use that method as a subroutine to perform the power method on M. Even if we could perform the error analysis to make this work, such an approach would likely require at least a suboptimal Ω(log2(1/ǫ)) iterations to achieve error ǫ.\nTo bypass these difficulties, we take a closer look at the power method. For some initial vector x, let y = B−1/2Mix be the result of i iterations of power method on M followed by multiplying B−1/2. Clearly y = (B−1A)iB−1/2x. Furthermore, since we typically initialize the power method by a random vector and since B is positive definite, if we instead we computed y = (B−1A)ix for random x we would likely converge at the same rate as the power method at the cost of just a slightly worse initialization quality.\nConsequently, we can compute our desired eigenvectors by simply alternating between applying A and B−1 to a random initial vector. Unfortunately, computing B−1 exactly is again outside our computational budget. At best we should only attempt to apply B−1 approximately by linear system solvers.\nOne of our main technical contributions is to argue about the effect of inexact solvers in this method. Whereas solving every linear system to target accuracy ǫ would again require O(log(1/ǫ)) time per linear system, which leads to a sub-optimal O(log2(1/ǫ)) overall running time, i.e. sublinear convergence, we instead show how to warm start the linear system solvers and obtain a faster rate. We exploit the fact that as we perform many iterations of power methods, points at time t converge to eigenvectors and therefore we can initialize our linear system solver at time t carefully using our points at time t− 1. Ultimately we show that we only need to make fixed multiplicative progress in solving the linear system in every iteration of the power method, thus the runtime for solving each linear system is independent of ǫ.\nPutting these pieces together with careful error analysis yields our main result. Our algorithm only requires the ability to apply A to a vector and an approximate linear system solver for B, which in turn can be obtained by just applying B to vectors. Consequently, our framework is versatile, scalable, and easily adaptable to take advantage of faster linear system solvers.\n1We use the term generalized eigenvector to refer to a non-zero vector v such that Av = λBv for symmetric A and B, not the general notion of eigenvectors for asymmetric matrices."
    }, {
      "heading" : "1.2 Previous Work",
      "text" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004). Our analysis in this paper draws on this work extensively and our results should be viewed as the principled application of them to the generalized eigenvector problem.\nThere has been much recent interest in designing scalable algorithms for CCA(Ma et al., 2015; Wang et al., 2015; Wang and Livescu, 2015; Michaeli et al., 2015). To our knowledge, there are no provable guarantees for approximate methods for this problem. Heuristic-based approachs (Witten et al., 2009; Lu and Foster, 2014) compute efficiently, but only give suboptimal result due to coarse approximation. The work in (Ma et al., 2015) provides one natural iterative procedure, where the per iterate computational complexity is low. This work only provides local convergence guarantees and does not provide guarantees of global convergence.\nAlso of note is that many recent algorithms (Ma et al., 2015; Wang et al., 2015) have mini-batch variations, but there’s no guarantees for mini-batch style algorithm for CCA yet. Our algorithm can also be easily extends to a mini-batch version. While we do not explicitly analyze this variation, and we believe our analysis and techniques are helpful for extensions to this setting. We also view this as an important direction for future work.\nWe hope that by establishing the generalized eigenvector problem and providing provable guarantees under moderate regularity assumptions that our results may be further improved and ultimately this may advance the state-of-the-art in practical algorithms for performing data analysis."
    }, {
      "heading" : "1.3 Our Results",
      "text" : "Our main result in this paper is a linearly convergent algorithm for computing the top generalized eigenvectors (see Definition 1). In order to be able to state our results we introduce some notation. Let λ1, · · · , λd be the eigenvalues of B−1A (their existence is guaranteed by Lemma 9 in the appendix). The eigengap ρ\ndef = 1− |λk+1||λk| and γ def = |λ1||λk| . Let z denote the number of nonzero entries\nin A and B.\nTheorem 2 (Informal version of Theorem 6). Given two matrices A and B ∈ Rd×d, there is an algorithm that computes the top-k generalized eigenvectors up to an error ǫ in time Õ( zk √ κ(B)\nρ log 1 ǫ ),\nwhere κ (B) is the condition number of B and Õ (·) hides logarithmic terms in d, γ, κ (B) and ρ, and nothing else.\nHere is a comparison of our result with previous work.\nTurning to the problem of CCA, cf. (1), the relevant parameters are κ def = max (κ (Sxx) , κ (Syy)) i.e., the maximum of the condition numbers of Sxx and Syy, γ def = |λ1||λk | where λ1, · · · , λk are the eigenvalues of S−1yy SyxS −1 xxSxy in decreasing absolute value. Let z denote the number of nonzeros in X and Y. Our main results are a reduction from CCA to the generalized eigenvector problem.\nTheorem 3 (Informal version of Theorem 7). Given two data matrices X ∈ Rd1×n and Y ∈ Rd2×n, there is an algorithm that performs top-k CCA up to an error ǫ in time Õ(zk √ κ\nρ log 1 ǫ ), where\nd = d1 + d2 and Õ (·) hides logarithmic terms in d, γ, κ and ρ, and nothing else.\nTable 2 compares our result with existing results. 2\nWe should note that the actual bounds we obtain are somewhat stronger than the above informal bounds. Some of the terms in logarithm also appear only as additive terms. Finally we also give natural stochastic extensions of our algorithms where the cost of each iteration may be much smaller than the input size. The key idea behind our approach is to use an approximate linear system solver as a black box inside power method on an appropriate matrix. We show that this dependence on a linear system solver is in some sense essential. In Section 6 we show that the generalized eigenvector problem is strictly more general than the problem of solving positive semidefinite linear systems and consequently our dependence on the condition number of B is in some cases optimal.\nSubsequent to the submission of this paper, we learned of the closely related work in (Wang et al., 2016), which presents a number of additional interesting results. We think it is worthwhile to point out that our algorithm only requires black box access to any linear solver. Although the result in Theorem 3 was stated by instantiating the linear system solver by accelerated gradient descent\n2(Ma et al., 2015) only shows local convergence for S-AppGrad. Starting within this radius of convergence requires us to already solve the problem to a high accuracy.\n3This table was inspired by (Wang et al., 2016) in order to facilitate comparison to existing work.\n(AGD), it is immediate to apply Theorem 7 and give the corresponding rates if we instantiate it by other popular algorithms, including gradient descent (GD), stochastic variance reduction (SVRG) (Johnson and Zhang, 2013), and its accelerated version (ASVRG) (Frostig et al., 2015; Lin et al., 2015). We summarize the corresponding runtime in Table 3. There κ̃ def = max\n( maxi ‖xi‖2 σmin(Sxx) , maxi ‖yi‖ 2 σmin(Syy) ) ,\nand xi, yi are i-th column of matrix X and Y. Note by definition we always have κ̃ ≥ κ. For generalized eigenvector problem, results of similar flavor as in Table 3 can also be easily derived.\nFinally, we also run experiments to demonstrate the practical effectiveness of our algorithm on both small and large scale datasets."
    }, {
      "heading" : "1.4 Paper Overview",
      "text" : "In Section 2, we present our notation. In Section 3, we formally define the problems we solve and their relevant parameters. In Section 4, we present our results for the generalized eigenvector problem. In Section 5, we present our results for the CCA problem. In Section 6 we argue that generalized eigenvector computation is as hard as linear system solving and that our dependence on κ(B) is near optimal. In Section 7, we present experimental results of our algorithms on some real world data sets. Due to space limitations, proofs are deferred to the appendix."
    }, {
      "heading" : "2 Notation",
      "text" : "We use bold capital letters (A,B, · · · ) to denote matrices and bold lowercase letters (u,v, · · · ) for vectors. For symmetric positive semidefinite (PSD) matrix B, we let ‖u‖B def= √ u⊤Bu denote the B-norm of u and we let 〈u,v〉B def= u⊤Bv denotes the inner product of u and v in the B-norm. We say that a matrix W is B-orthonormal if W⊤BW = I. We let σi(A) denotes the ith largest singular value of A, σmin (A) and σmax (A) denote the smallest and largest singular values of A respectively. Similarly we let λi(A) refers to the i\nth largest eigenvalue of A in magnitude. We let nnz (A) denotes the number of nonzeros in A. We also let κ(B) denote the condition number of B (i.e., the ratio of the largest to smallest eigenvalue)."
    }, {
      "heading" : "3 Problem Statement",
      "text" : "In this section, we recall the generalized eigenvalue problem, define our error metric, and introduce all relevant parameters. Recall that the generalized eigenvalue problem is to find k vectors wi, i ∈ [k] such that\nwi ∈ argmax w\n∣∣∣w⊤Aw ∣∣∣ s.t. w ⊤Bw = 1 and w⊤Bwj = 0 ∀ j ∈ [i− 1].\nUsing stationarity conditions, it can be shown that the vectors wi are given by wi = vi, where vi is an eigenvector of B\n−1A with eigenvalue λi such that |λ1| ≥ · · · ≥ λn. Our goal is to recover the top-k eigen space i.e., span{v1, · · · ,vk}. In order to quantify the error in estimating the eigenspace, we use largest principal angle, which is a standard notion of distance between subspaces (Golub and Van Loan, 2012).\nDefinition 4 (Largest principal angle). Let W and V be two k dimensional subspaces, W and V their B-orthonormal basis respectively. The largest principal angle θ (W,V) in the B-norm is defined to be\nθ (W,V) def= arccos ( σmin ( V⊤BW )) ,\nIntuitively, the largest principal angle corresponds to the largest angle between any vector in the span of W and its projection onto the span of V. In the special case where k = 1, the above definition reduces to our choice in the top-1 setting. Given two matrices W and V, we use θ (W,V) to denote the largest principle angle between the subspaces spanned by the columns of W and V. We say that W achieves an error of ǫ if W⊤BW = I and sin θ (W,V) ≤ ǫ, where V is the d × k matrix whose columns are v1, · · · ,vk. The relevant parameters for us are the eigengap, i.e. the relative difference between kth and (k + 1)th eigenvalues, ρ\ndef = 1 − |λk+1||λk| , and κ(B), the condition\nnumber of B."
    }, {
      "heading" : "4 Our Results",
      "text" : "In this section, we provide our algorithms and results for solving the generalized eigenvector problem. We present our results for the special case of computing the top generalized eigenvector (Section 4.1) followed by the general case of computing the top-k generalized eigenvectors (Section 4.2). However, first we formally define a linear system solver as follows:\nLinear system solver: In each of our main results (Theorems 5 and 6) we assume black box access to an approximate linear system solver. Given a PSD matrix B, a vector b, an initial estimate u0, and an error parameter δ, we require to decrease the error by a multiplicative δ, i.e. output u1 with ‖u1 −B−1b‖2B ≤ δ‖u0 −B−1b‖2B. We let T (δ) denote the time needed for this operation. Since the error metric ‖u1 −B−1b‖2B is equivalent to function error on minimizing the convex quadratic f(u)\ndef = 12u ⊤Bu−u⊤b up to constant scaling, an approximate linear system solver is equivalent to an optimization algorithm for f(u). We also specialize our results using Nesterov’s accelerated gradient descent to state our bounds. Stating our results using linear system solver as a blackbox allows the user to choose an efficient solver depending on the structure of B and helps pass any improvements in linear system solvers on to the problem of generalized eigenvectors."
    }, {
      "heading" : "4.1 Top-1 Setting",
      "text" : "Our algorithm for computing the top generalized eigenvector, GenELin is given in Algorithm 1. The algorithm implements an approximate power method where each iteration consists of approximately multiplying a vector by B−1A. In order to do this, GenELin solves a linear system in B and then scales the resulting vector to have unit B-norm. Our main result states that given an oracle for solving the linear systems,4 the number of iterations taken by Algorithm 1 to compute the top eigenvector up to an accuracy of ǫ is at most 4ρ log 1 ǫ cos θ0 where θ0 def = θ (w0,v1).\nTheorem 5. Recall that the linear system solver takes time T (δ) to reduce the error by a factor δ. Given matrices A and B, GenELin (Algorithm 1) computes a vector wT achieving an error of ǫ in\n4For example, we could use Nesterov’s accelerated gradient descent, Algorithm 4\nAlgorithm 1 Generalized Eigenvector via Linear System Solver (GenELin)\nInput: T , symmetric matrix A, PSD matrix B. Output: top generalized eigenvector w.\nw̃0 ← sample uniformly from unit sphere in Rd w0 ← w̃0/‖w̃0‖B for t = 0, · · · , T − 1 do\nβt ← w⊤t Awt/w⊤t Bwt w̃t+1 ← argminw∈Rd [12w⊤Bw −w⊤Awt]\n{Use an optimization subroutine with initialization βtwt }\nwt+1 ← w̃t+1/‖w̃t+1‖B end for Return wT .\nT = 2ρ log 1 ǫ cos θ0 iterations, where θ0 def = θ (w0,v1). The running time of the algorithm is at most\nO\n( 1\nρ\n( log 1 cos θ0 · T ( ρ2 cos2 θ0 16 ) + log 1 ǫ · T ( ρ2 16 )) + 1 ρ (nnz (A) + nnz (B) + d) log\n1\nǫ cos θ0\n) .\nFurthermore, if we use Nesterov’s accelerated gradient descent (Algorithm 4) to solve the linear systems in Algorithm 1, the time can be bounded as\nO\n( nnz (B) √ κ(B)\nρ\n( log 1\ncos θ0 log\n1\nρ cos θ0 + log\n1 ǫ log 1 ρ\n) + 1\nρ nnz (A) log\n1\nǫ cos θ0\n) .\nRemarks:\n• Since GenELin chooses w0 randomly, Lemma 13 tells us that cos θ0 ≥ ζ√ dκ(B) with probability\ngreater than 1− ζ.\n• Note that GenELin exploits the sparsity of input matrices since we only need to apply them as operators.\n• Depending on computational restrictions, we can also use a subset of samples in each iteration of GenELin. In some large scale learning applications using minibatches of data in each iteration helps make the method scalable while still maintaining the quality of performance."
    }, {
      "heading" : "4.2 Top-k Setting",
      "text" : "In this section, we give an extension of our algorithm and result for computing the top-k generalized eigenvectors. Our algorithm, GenELinK is formally given as Algorithm 2.\nGenELinK is a natural generalization of GenELin from the previous section. Given an initial set of vectors W0, the algorithm proceeds by doing approximate orthogonal iteration. Each iteration involves solving k independent linear systems5 and orthonormalizing the iterates. The following theorem is the main result of our paper which gives runtime bounds for Algorithm 2. As before, we\n5Similarly, as before, we could use Nesterov’s accelerated gradient descent, i.e. Algorithm 4.\nAlgorithm 2 Generalized Eigenvectors via Linear System Solvers-K (GenELinK).\nInput: T , k, symmetric matrix A, PSD matrix B. a subroutine GSB(·) that performs Gram-Schmidt process, with inner product 〈·, ·〉B. Output: top k eigen-space W ∈ Rd×k. W̃0 ← random d× k matrix with each entry i.i.d from N (0, 1) W0 ← GSB(W̃0). for t = 0, · · · , T − 1 do\nΓt ← (W⊤t BWt)−1(W⊤t AWt) W̃t+1 ← argminW tr(12W⊤BW −W⊤AWt)\n{Use an optimization subroutine with initialization WtΓt }\nWt+1 ← GSB(W̃t+1) end for Return WT .\nassume access to a blackbox linear system solver and also give a result instantiating the theorem with Nesterov’s accelerated gradient descent algorithm.\nTheorem 6. Suppose the linear system solver takes time T (δ) to reduce the error by a factor δ. Given input matrices A and B, GenELinK computes a d × k matrix WT which is an estimate of the top generalized eigenvectors V with an error of ǫ i.e., W⊤TBWT = I and sin θT ≤ ǫ, where θT def = θ (WT ,V) in T = 2 ρ log 1 ǫ cos θ0\niterations where θ0 = θ (W0,V). The run time of this algorithm is at most\nO\n( 1\nρ\n( log 1 cos θ0 · T ( ρ2 cos4 θ0 64kγ2 ) + T ( ρ2 64kγ2 ) log 1 ǫ ) + 1 ρ ( nnz (A) k + nnz (B) k + dk2 ) log\n1\nǫ cos θ0\n) ,\nwhere γ def = |λ1||λk| , |λ1| ≥ · · · ≥ |λk| being the top-k eigenvalues of B −1A. Furthermore, if we use Nesterov’s accelerated gradient descent (Algorithm 4) to solve the linear systems in Algorithm 2, the time above can be bounded as\nO\n( nnz (B) k √ κ(B)\nρ\n( log 1\ncos θ0 log\nkγ\nρ cos θ0 + log\n1 ǫ log kγ ρ\n) + ( nnz (A) k + dk2 )\nρ log\n1\nǫ cos θ0\n) .\nRemarks:\n• Lemma 13 again tells us that since W0 is chosen to be normalized after choosing uniformly at random from the unit sphere, cos θ0 ≥ ζ√\ndkκ(B) with probability greater than 1− ζ.\n• This result recovers Theorem 5 as a special case, since when k = 1, we also have γ = |λ1||λ1| = 1."
    }, {
      "heading" : "5 Application to CCA",
      "text" : "We now outline how the CCA problem can be reduced to computing generalized eigenvectors. The CCA problem is as follows. Given two sets of data points X ∈ Rn×d1 and Y ∈ Rn×d2 , let\nSx def = X⊤X/n, Sy def = Y⊤Y/n, and Sxy def = X⊤Y/n. We wish to find vectors φ1, · · · , φk and ψ1, · · · , ψk which are defined recursively as\n(φi, ψi) ∈ argmax φ,ψ φ⊤Sxyψ\ns.t. ‖φ‖Sx = 1 and φ⊤Sxφj = 0 ∀ j ≤ i− 1 ‖ψ‖Sy = 1 and ψ⊤Syψj = 0 ∀ j ≤ i− 1.\nwhere the values of φ⊤i Sxyψi are called canonical correlations between X and Y. For reduction, we know any stationary point of this optimization problem satisfies Sxyψi = λiSxφi, and Syxφi = µiSyψi, where λi and µi are two constants. Combined with the con-\nstraints, we also see that λi = µi. This can be written in matrix form as\n( 0 Sxy\nSyx 0 )( φi ψi ) =\nλi ( Sx 0 0 Sy )( φi ψi ) . Suppose the generalized eigenvalues of the above matrices are −λ1 < −λ2 < · · · < λ2 < λ1. The top 2k-dimensional eigen-space of this generalized eigenvalue problem corresponds to the linear subspace spanned by the eigenvectors of λi and−λi, which are\n( φi ψi ) , ( −φi ψi ) ∀ i ∈\n[k]. Once we solve the top-2k generalized eigenvector problem for the matrices\n( 0 Sxy\nSyx 0\n) and\n( Sxx 0 0 Syy ) , we can pick any orthonormal basis that spans the output subspace and choose a random k-dimensional projection of those vectors. The formal algorithm is given in Algorithm 3. Combining this with our results for computing generalized eigenvectors, we obtain the following result.\nAlgorithm 3 CCA via Linear System Solvers (CCALin) Input: T , k, data matrix X ∈ Rn×d1 ,Y ∈ Rn×d2 Output: top k canonical subspace Wx ∈ Rd1×k,Wy ∈ Rd2×k.\nSxx ← X⊤X/n, Syy ← Y⊤Y/n, Sxy ← X⊤Y/n. A ← ( 0 Sxy\nS⊤xy 0\n) , B ← ( Sxx 0 0 Syy )\n( W̄x ∈ Rd1×2k W̄y ∈ Rd2×2k ) ← GenELinK(A,B). U ← 2k × k random Gaussian matrix W̃x ← W̄xU. W̃y ← W̄yU. Wx = GSSxx(W̃x),Wx = GSSyy(W̃y) Return Wx,Wy.\nTheorem 7. Suppose the linear system solver takes time T (δ) to reduce the error by a factor δ. Given inputs X and Y, with probability greater than 1 − ζ, then there is some universal constant c, so that Algorithm 3 outputs Wx and Wy such that sin θ(span (φi; i ∈ [k]) ,Wx) ≤ ǫ, and\nsin θ(span (ψi; i ∈ [k]) ,Wy) ≤ ǫ, in time\nO\n( 1\nρ\n( log dκ ζ · T ( cζ6ρ2 d2k5κ2γ2 ) + T ( cζ2ρ2 k3γ2 ) log 1 ǫ ) + 1 ρ ( nnz (X,Y) k + dk2 ) log dκ ζǫ ) ,\nwhere nnz (X,Y) def = nnz (X) + nnz (Y) and κ def = max (κ (Sxx) , κ (Syy)) and γ def = λ1λk . If we use Nesterov’s accelerated gradient descent (Algorithm 4) to solve the linear systems in GenELink, then the total runtime is\nO\n( nnz (X,Y) k √ κ\nρ\n( log dκ\nζ log\ndκγ\nζρ + log\n1 ǫ log kγ ρ\n) + dk2\nρ log\ndκ\nζǫ\n) ,\nRemarks:\n• Note that we depend on the maximum of the condition numbers of Sxx and Syy since the linear systems that arise in GenELinK decompose into two separate linear systems, one in Sxx and the other in Syy.\n• We can also exploit sparsity in the data matrices X and Y since we only need to apply Sxx,Sxy or Syy only as operators, which can be done by applying X and Y in appropriate order. Exploiting sparsity is crucial for any large scale algorithm since there are many data sets (e.g., URL dataset in our experiments) where dense operations are impractical."
    }, {
      "heading" : "6 Reduction to Linear System",
      "text" : "Here we show that solving linear systems inB is inherent in solving the top-k generalized eigenvector problem in the worst case and we provide evidence a √ κ(B) factor in the running time is essential for a broad class of iterative methods for the problem. Let M be a symmetric positive definite matrix and suppose we wish to solve the linear system Mx = m, i.e. compute x∗ with Mx∗ = m. If we set A = mm⊤ and B = M then\nargmax x⊤Bx=1\nx⊤Ax = B−1m\nm⊤B−1m\nand consequently computing the top-1 generalized eigenvector yields the solution to the linear system. Therefore, the problem of computing top-k generalized eigenvectors is in general harder than the problem of solving symmetric positive definite linear systems.\nMoreover, it is well known that any method which starts at m and iteratively applies M to linear combinations of the points computed so far must apply M at least Ω( √ κ(B)) in order to halve the error in the standard norm for the problem (Shewchuk, 1994). Consequently, methods that solve the top-1 generalized eigenvector problem by simply applying A and B, which is the same as applying M and taking linear combinations with m, must apply M at least Ω( √ κ(M)) times to achieve small error, unless they exploit more structure of M or the initialization."
    }, {
      "heading" : "7 Simulations",
      "text" : "In this section, we present our experiment results performing CCA on three benchmark datasets which are summarized in Table 4. We wish to demonstrate two things via these simulations: 1)\nthe behavior of CCALin verifies our theoretical result on relatively small-scale dataset, and 2) scalability of CCALin comparing it with other existing algorithms on a large-scale dataset.\nLet us now specify the error metrics we use in our experiments. The first ones are the principal angles between the estimated subspaces and the true ones. Let Wx and Wy be the estimated subspaces andVx, Vy be the true canonical subspaces. We will use principle angles θx = θ(Wx,Vx)\nunder Sxx-norm, θy = θ(Wx,Vx) under Syy-norm and θB = θ (( Vx 0 0 Vy ) , ( W̄x W̄y )) 7, under\nthe ( Sxx 0 0 Syy ) norm. Unfortunately, we cannot compute these error metrics for large-scale datasets since they require knowledge of the true canonical components. Instead we will use Total Correlations Captured (TCC), which is another metric widely used by practitioners, defined to be the sum of canonical correlation between two matrices. Also, Proportion of Correlations Captured is given as\nPCC = TCC(XWx,YWy)/TCC(XVx,YVy)\nFor a fair comparison with other algorithms (which usually call highly optimized matrix inversion subroutines), we use number of FLOPs instead of wall clock time to measure the performance."
    }, {
      "heading" : "7.1 Small-scale Datasets",
      "text" : "MNIST dataset(LeCun et al., 1998) consists of 60,000 handwritten digits from 0 to 9. Each digit is a image represented by 392 × 392 real values in [0,1]. Here CCA is performed between left half images and right half images. The data matrix is dense but the dimension is fairly small. Penn Tree Bank (PTB) dataset comes from full Wall Street Journal Part of Penn Tree Bank which consists of 1.17 million tokens and a vocabulary size of 43k(Marcus et al., 1993), which has already been used to successfully learn the word embedding by CCA(Dhillon et al., 2011). Here, the task is to learn correlated components between two consecutive words. We only use the top 10,000 most frequent words. Each row of data matrix X is an indicator vector and hence it is very sparse and X⊤X is diagonal.\nSince the input matrices are very ill conditioned, we add some regularization and replace Sxx by Sxx + λI (and similarly with Syy). In CCALin, we run GenELinK with k = 10 and accelerated gradient descent (Algorithm 4 in the supplementary material) to solve the linear systems. The results are presented in Figure 1 and Figure 2.\nFigure 1 shows a typical run of CCALin from random initialization on both MNIST and PTB dataset. We see although θx, θy may be even 90 degree at some point respectively, θB is always\n6Sparsity is given by (nnz (X) + nnz (Y))/(nd1 + nd2). 7See Algorithm 3 for definition of W̄x,W̄y\nmonotonically decreasing (as cos θB monotonically increasing) as predicted by our theory. In the end, as θB goes to zero, it will push both θx and θy go to zero, and PCC go to 1. This demonstrates that our algorithm indeed converges to the true canonical space.\nFurthermore, by a more detailed examination of experimental data in Figure 1, we observe in Figure 2 that sin θB is indeed linearly convergent as we predicted in the theory. In the meantime, sin θx and sin θy may initially converge a bit slower than sin θB, but in the end they will be upper bounded by sin θB times a constant factor, thus will eventually converge at a linear rate at least as fast as sin θB."
    }, {
      "heading" : "7.2 Large-scale Dataset",
      "text" : "URL Reputation dataset contains 2.4 million URLs and 3.2 million features including both host-based features and lexical based features. Each feature is either real valued or binary. For experiments in this section, we follow the setting of (Ma et al., 2015). We use the first 2 million samples, and run CCA between a subset of host based features and a subset of lexical based features to extract the top 20 components. Although the data matrix X is relatively sparse,\nunlike PTB, it has strong correlations among different coordinates, which makes X⊤X much denser (nnz ( X⊤X ) /d21 ≈ 10−3).\nClassical algorithms are impractical for this dataset on a typical computer, either running out of memory or requiring prohibitive amount of time. Since we cannot estimate the principal angles, we will evaluate TCC performance of CCALin.\nWe compare our algorithm to S-AppGrad (Ma et al., 2015) which is an iterative algorithm and PCA-CCA (Ma et al., 2015), NW-CCA (Witten et al., 2009) and DW-CCA (Lu and Foster, 2014) which are one-shot estimation procedures.\nIn CCALin, we employ GenELinK using stochastic accelerated gradient descent for solving linear systems using minibatches in each of the gradient steps and also leverage sparsity of the data to deal with the large data size. The result is shown in Figure 3. It is clear from the plot that our algorithm takes fewer computations than the other algorithms to achieve the same accuracy."
    }, {
      "heading" : "8 Conclusion",
      "text" : "In summary, we have provided the first provable globally linearly convergent algorithms for solving canonical correlation analysis and the generalized eigenvector problems. We have shown that for recovering the top k components our algorithms are much faster than traditional methods based on fast matrix multiplication and singular value decomposition when k ≪ n and the condition numbers and eigenvalue gaps of the matrices involved are moderate. Moreover, we have provided empirical evidence that our algorithms may be useful in practice. We hope these results serve as the basis for further improvements in performing large scale data analysis both in theory and in practice."
    }, {
      "heading" : "A Solving Linear System via Accelerated Gradient Descent",
      "text" : "Algorithm 4 Nesterov’s accelerated gradient descent Input: learning rate η, factor Q, initial point x0, T . Output: minimizer x⋆ of f .\nfor t = 0, · · · , T − 1 do yt+1 ← xt − (1/β) · ∇f(xt) xt+1 ← yt+1 + ( √ Q− 1)/(√Q+ 1) · (yt+1 − yt) end for Return yT .\nSince we use accelerated gradient descent in our main theorems, for completeness, we put the algorithm and cite its result about iteration complexity here without proof.\nTheorem 8 ((Nesterov, 1983)). Let f be α-strongly convex and β-smooth, then accelerated gradient descent with learning rate η = 1β and Q = β/α satisfies:\nf(xt)− f(x⋆) ≤ 2(f(x0)− f(x⋆)) exp(− t√ Q ) (2)"
    }, {
      "heading" : "B Proofs of Main Theorem",
      "text" : "In this section we will prove Theorems 5, 6 and 7.\nB.1 Rank-1 Setting\nWe first prove our claim that B−1A has an eigenbasis.\nLemma 9. Let (ui, σi) be the eigenpairs of the symmetric matrix B −1/2AB−1/2. Then B−1/2ui is an eigenvector of B−1A with eigenvalue σi.\nProof. The proof is straightforward.\nB−1A ( B−1/2ui ) = B−1/2 ( B−1/2AB−1/2ui ) = σiB −1/2ui.\nDenote the eigenpairs of B−1A by (λi,vi), the above lemma further tells us that v⊤i Bvj = u⊤i uj = δij .\nRecall that we defined the angle between w and v1 in the B-norm: θ (w,v1) = arccos ( |v⊤1 Bw| ) .\nTo measure the distance from optimality, we use the following potential function for normalized vector w (‖w‖B = 1):\ntan θ(w,v1) =\n√ 1− |v⊤1 Bw|2\n|v⊤1 Bw| . (3)\nLemma 10. Consider any w such that ‖w‖B = 1 and tan θ(w,v1) ≤ ǫ. Then, we have:\ncos2 θ(w,v1) = (v ⊤ 1 Bw) 2 ≥ 1− ǫ2 and w⊤Aw ≥ λ1(1− ǫ2).\nProof. Clearly,\n(v⊤1 Bw) 2 = cos2 θ(w,v1) =\n1 1 + tan2 θ(w,v1) ≥ 1 1 + ǫ2 ≥ 1− ǫ2,\nproving the first part. For the second part, we have the following:\nw⊤Aw = ∑\ni,j\n(v⊤i Bw)(v ⊤ j Bw)v ⊤ i Avj =\n∑\ni,j\nλj(v ⊤ i Bw)(v ⊤ j Bw)v ⊤ i Bvj\n= ∑\ni\nλi(v ⊤ i Bw) 2 ≥ λ1(v⊤1 Bw)2 ≥ (1− ǫ2)λ1,\nproving the lemma.\nProof of Theorem 5. We will show that the potential function tan θ(wt,v1) decreases geometrically with t. This will directly provides an upper bound for sin θ(wt,v1). For simplicity, through out the proof we will simply denote θ(wt,vi) as θt.\nRecall the updates in Algorithm 1, suppose at time t, we have wt such that ‖wt‖B = 1. Let us say\nwt+1 = 1 Z (B−1Awt + ξ) (4)\nwhere Z is some normalization factor, and ξ is the error in solving the least squares. We will first prove the geometric convergence claim assuming\n‖ξ‖B ≤ |λ1| − |λ2|\n4 min{cos θt, sin θt}, (5)\nand then bound the time taken by black-box linear system solver to provide such an accuracy. Since wt can be written as wt = ∑ i ( w⊤t Bvi ) vi, we know B −1Awt = ∑d i=1 λi ( w⊤t Bvi ) vi. Since ‖wt+1‖B = 1 and v⊤i Bvj = δij , we have\ntan θt+1 =\n√ Z2 − |v⊤1 BZwt+1|2\n|v⊤1 BZwt+1| ≤\n√∑d i=2 ( w⊤t Bvi )2 λ2i + ‖ξ‖B\n| ( w⊤t Bv1 ) λ1| − ‖ξ‖B\n≤\n√ 1− ( w⊤t Bv1 )2\n|w⊤t Bv1| ×\n|λ2|+ ‖ξ‖B√ 1−(w⊤t Bv1) 2\n|λ1| − ‖ξ‖B|w⊤t Bv1| = tan θt ×\n|λ2|+ ‖ξ‖B√ 1−(w⊤t Bv1) 2\n|λ1| − ‖ξ‖B|w⊤t Bv1|\nBy definition of θt, we know cos θt = |w⊤t Bv1| and sin θt = √ 1− ( w⊤t Bv1 )2 giving us\ntan θt+1 ≤ tan θt × |λ2|+ ‖ξ‖Bsin θt |λ1| − ‖ξ‖Bcos θt .\nSince ‖ξ‖B ≤ |λ1|−|λ2|4 min{cos θt, sin θt}, we have that\ntan θt+1 ≤ |λ1|+ 3|λ2| 3|λ1|+ |λ2| × tan θt.\nLetting γ = 3|λ1|+|λ2||λ1|+3|λ2| , this shows that G(wt) ≤ γ tG(w0). Recalling the definition of eigengap ρ = 1− |λ2||λ1| , choosing t to be\nt ≥ 2 ρ log\n( 1\nǫ cos θ0\n) ≥\nlog ( tan θ0\nǫ\n)\n( 1 γ − 1\n) ≥ log ( tan θ0 ǫ )\nlog (\n1 γ\n) , (6)\nwe are guaranteed that sin θt ≤ tan θt ≤ ǫ. This number of iterations 2ρ log ( 1 ǫ cos θ0 ) could be further decompose into two phase: 1) initial phase 2ρ log 1 cos θ0 which mainly caused by large initial angle, 2) convergence phase 2ρ log 1 ǫ which is mainly due to the high accuracy ǫ we need.\nWe now focus on how to obtain the iterate wt+1 using accelerated gradient descent such that the error ξ has norm bounded as in (5).\nLet f(w) def = 12w ⊤Bw −w⊤Awt and recall that in each iteration, we use linear system solver to solve the following optimization problem:\nmin w f(w). (7)\nThe minimizer of (7) is B−1Awt. Define ǫinit and ǫdes as initial error and required destination error of linear system solver ‖w −B−1Awt‖2B. Observe that for any w we have equality,\n‖w −B−1Awt‖2B = 2(f(w)− f(B−1Awt)) (8)\nEq.(5) directly poses a condition on ǫdes:\nǫdes ≤ (|λ1| − |λ2|)2\n16 min{cos2 θt, sin2 θt}\nSince we initialize Algorithm 4 with βtwt, where βt def = w⊤t Awt\nw⊤t Bwt , the initial error can be bounded\nas follows:\nǫinit = 2(f(βtwt)− f(B−1Awt)) = 2(min\nβ f(βwt)− f(B−1Awt)) ≤ 2(f(λ1wt)− f(B−1Awt))\n= ‖λ1wt −B−1Awt‖2B = ∑\ni≥2 (λ1 − λi)2\n( w⊤t Bvi )2 ≤ λ21(1− ( w⊤t Bv1 )2 ) = λ21 sin 2 θt.\nThis means that we wish to decrease the ratio of final to initial error smaller than\nǫdes ǫinit ≤ (|λ1| − |λ2|) 2 16 min{cos2 θt, sin2 θt} ×\n1\nλ21 sin 2 θt\n= ρ2\n16 min\n{ 1\ntan2 θt , 1\n} . (9)\nRecall we defined T (δ) as the time for linear system solver to reduce the error by a factor δ. Therefore, in the initial phase where θt is large, it would be suffice to solve linear system up to factor δ = ρ 2 cos2 θ0\n16 ≤ ρ2 16 tan θt . In convergence phase, where θt is small, choose δ = ρ2\n16 would be sufficient.\nTherefore, adding the computational cost of Algorithm 1 other than by linear system solver, it’s not hard to get the total running time will be bounded by\n2\nρ\n( log 1 cos θ0 · T ( ρ2 cos2 θ0 16 ) + log 1 ǫ · T ( ρ2 16 )) + 2 ρ (nnz (A) + nnz (B) + d) log\n1\nǫ cos θ0 .\nFurthermore, if we run Nesterov’s accelerated gradient descent (Algorithm 4) on function f(w) to solve the linear systems. Since the condition number of the optimization problem (7) is κ(B), by Theorem 8, we know T (δ) = O(nnz (B) √ κ(B) log 1δ ). Substituting this gives runtime:\nO\n( nnz (B) √ κ(B)\nρ\n( log 1\ncos θ0 log\n1\nρ cos θ0 + log\n1 ǫ log 1 ρ\n) + 1\nρ nnz (A) log\n1\nǫ cos θ0\n) .\nwhich finishes the proof.\nB.2 Top-k Setting\nTo prove the convergence of subspace, we need a notion of angle between subspaces. The standard definition the is principal angles.\nDefinition 11 (Principal angles). Let X and Y be subspaces of Rd of dimension at least k. The principal angles 0 ≤ θ(1) ≤ · · · ≤ θ(k) between X and Y with respect to B-based scalar product are defined recursively via:\nθ(i)(X ,Y) = min{arccos( 〈x,y〉B‖x‖B‖y‖B ) : x ∈ X ,y ∈ Y,x ⊥B xj ,y ⊥B yj for all j < i} (xi,yi) ∈ argmin{arccos( 〈x,y〉B\n‖x‖B‖y‖B ) : x ∈ X ,y ∈ Y,x ⊥B xj ,y ⊥B yj for all j < i}\nFor matrices X and Y, we use θj(X,Y) to denote the j-th principal angle between their range.\nSince for our interest, we only care the largest principal angle, thus, in the following proof, without ambiguity, for X,Y ∈ Rd×k, we use θ(X,Y) to indicate θ(k)(X,Y). Next lemma will tells us this definition of θ(X,Y) to be the largest principal angle is same as what we defined in the main paper Definition 4.\nLemma 12. Let X,Y ∈ Rd×k be orthonormal bases (w.r.t B) for subspace X ,Y respectively. Let X⊥ be an orthonormal basis for orthogonal complement of X (w.r.t B). Then we have\ncos θ(X ,Y) = σk(X⊤BY), sin θ(X ,Y) = ‖X⊤⊥BY‖ (10)\nand assuming X⊤BY is invertible (θ(X ,Y) < π2 ), we have:\ntan θ(X ,Y) = ‖X⊤⊥BY(X⊤BY)−1‖ (11)\nProof. By definition of principal angle, it’s easy to show cos θ(X ,Y) = σk(X⊤BY). The projection operator onto subspace X is XX⊤B. It’s also easy to show XX⊤B+X⊥X⊤⊥B = I Then, we have:\n(X⊤⊥BY) ⊤X⊤⊥BY = Y ⊤BX⊥X ⊤ ⊥BY\n= Y⊤B(I−XX⊤B)Y = Y⊤BY − (X⊤BY)⊤(X⊤BY) = I− (X⊤BY)⊤(X⊤BY) (12)\nTherefore: ‖X⊤⊥BY‖2 = 1− σ2k(X⊤BY) = 1− cos2 θ(X ,Y) = sin2 θ(X ,Y) (13)\nSimilarily:\n[X⊤⊥BY(X ⊤BY)−1]⊤X⊤⊥BY(X ⊤BY)−1\n=[(X⊤BY)−1]⊤[I− (X⊤BY)⊤(X⊤BY)](X⊤BY)−1 =[(X⊤BY)−1]⊤(X⊤BY)−1 − I (14)\nTherefore:\n‖X⊤⊥BY(X⊤BY)−1‖2 = 1\nσ2k(X ⊤BY)\n− 1 = 1 cos2 θ(X ,Y) − 1 = tan 2 θ(X ,Y) (15)\nObviously, θ(X ,Y) is acute, thus sin θ(X ,Y) > 0 and tan θ(X ,Y) > 0, which finishes the proof.\nSimilar to the top one case, for simplicity, we denote θt def = θ (Wt,V), where V ∈ Rd×k is top k eigen-vector of generalized eigenvalue problem. Now we are ready to prove the theorem. We also denote V⊥ ∈ Rd×(d−k). Also throughout the proof, for any matrix X, we use notation ‖X‖B ≡ ‖B 1 2X‖ ≡ √ ‖X⊤BX‖ and ‖X‖B,F = ‖B 1 2X‖F = √ tr(X⊤BX).\nProof of Theorem 5. Let V ∈ Rd×k,ΛV ∈ Rk×k be the top k generalized eigen-pairs; and V⊥ ∈ R d×(d−k),ΛV⊥ ∈ R(d−k)×(d−k) be the remaining (d − k) generalized eigen-pairs (assume all eigenvectors normalized w.r.t. B). Then, we have:\nA = B(VΛVV ⊤ +V⊥ΛV⊥V ⊤ ⊥)B B = B(VV⊤ +V⊥V ⊤ ⊥)B\nBy approximately solving argminW∈Rd×k tr( 1 2W ⊤BW−W⊤AWt) and Gram-Schmidt process, we have:\nWt+1 = (B −1AWt + ξ)R (16)\nwhere R ∈ Rk×k is an invertable matrix generated by Gram-Schmidt process. We will follow the same strategy as in top 1 case, which will first prove the geometric convergence of tan θt assuming\n‖ξ‖B ≤ |λk| − |λk+1|\n4 min{sin θt, cos θt} (17)\nNote here ξ is a matrix, and ‖ξ‖B = ‖B 1 2 ξ‖ = √\n‖ξ⊤Bξ‖. Then we will bound the time taken by black-box linear system solver to provide such an accuracy.\nBy definition of tan θt and linear algebra calculation, we have\ntan θt+1 = ‖V⊤⊥BWt+1(V⊤BWt+1)−1‖ = ‖V⊤⊥BW̃t+1(V⊤BW̃t+1)−1‖ = ‖(ΛV⊥V⊤⊥BWt +V⊤⊥Bξ)(ΛVV⊤BWt +V⊤Bξ)−1‖\n≤ ‖(ΛV⊥V ⊤ ⊥BWt +V ⊤ ⊥Bξ)(V ⊤BWt)−1‖ σk(ΛV +V⊤Bξ(V⊤BWt)−1) ≤ ‖ΛV⊥‖ tan θt + ‖V ⊤ ⊥Bξ(V\n⊤BWt)−1‖ σk(ΛV)− ‖V⊤Bξ(V⊤BWt)−1‖\n≤ ‖ΛV⊥‖ tan θt + ‖V ⊤ ⊥Bξ‖‖V⊤BWt)−1‖\nσk(ΛV)− ‖V⊤Bξ‖‖(V⊤BWt)−1‖\n= ‖ΛV⊥‖ tan θt +\n‖V⊤ ⊥ Bξ‖\ncos θt\nσk(ΛV)− ‖V ⊤Bξ‖\ncos θt\n≤ tan θt |λk+1|+ ‖ξ‖Bsin θt |λk| − ‖ξ‖Bcos θt\n(18)\nSince ‖ξ‖B ≤ |λk|−|λk+1|4 min{sin θt, cos θt}, we have that:\ntan θt+1 ≤ |λk|+ 3|λk+1| 3|λk|+ |λk+1| tan θt (19)\n= (1− 2(|λk| − |λk+1|) 3|λk|+ |λk+1| ) tan θt ≤ exp(− |λk| − |λk+1| 2|λk| ) tan θt (20)\nRecall in this problem ρ = 1− |λk+1||λk| , therefore, we know:\nsin θt ≤ tan θt ≤ exp(− ρ\n2 · t) tan θ0 ≤ exp(−\nρ 2 · t) 1 cos θ0 (21)\nIf we want sin θt ≤ ǫ, which gives iterations:\nt ≥ 2 ρ log\n1\nǫ cos θ0 (22)\nLet f(W) = tr(12W ⊤BW−W⊤AWt). For this problem, we can view W as a dk dimensional vector, and use linear system to solve this d, k dimensional problem. Therefore, if we represent W in terms of matrix, the corresponding linear system error is ‖W −B−1AWt‖B,F , recall ‖W‖B,F = ‖B 12W‖F = √ tr(W⊤BW). To satisfy the accuracy requirement, we only need\nǫdes = ‖ξ‖2B,F ≤ (|λk| − |λk+1|)2\n16 min{sin2 θt, cos2 θt} (23)\nRecall we initialize the linear system solver with WtΓt with Γt = (W ⊤ t BWt) −1(W⊤t AWt), we then have\nǫinit = ‖WtΓt −B−1AWt‖2B,F = tr[(WtΓt −B−1AWt)⊤B(WtΓt −B−1AWt)] =2[f(WtΓt)− f(B−1AWt)] = 2[argmin\nΓ∈Rk×k f(WtΓ)− f(B−1AWt)] (24)\nLet Γ̂t = (V ⊤BWt)−1ΛV(V⊤BWt), and observe ‖ξ‖2B,F = ‖B 1 2 ξ‖2F = ‖V⊤Bξ‖2F + ‖V⊤⊥Bξ‖2F (Pythagorean theorem under B norm), then we have:\nǫinit =‖WtΓt −B−1AWt‖2B,F = 2[argmin Γ∈Rk×k f(WtΓ)− f(B−1AWt)]\n≤2[f(WtΓ̂t)− f(B−1AWt)] = ‖WtΓ̂t −B−1AWt‖2B,F =‖V⊤B(WtΓ̂t −B−1AWt)‖2F + ‖V⊤⊥B(WtΓ̂t −B−1AWt)‖2F =‖V⊤BWtΓ̂t − ΛVV⊤BWt‖2F + ‖V⊤⊥BWtΓ̂t − ΛV⊥V⊤⊥BWt‖2F =0 + ‖V⊤⊥BWtΓ̂t − ΛV⊥V⊤⊥BWt‖2F ≤k‖V⊤⊥BWtΓ̂t − ΛV⊥V⊤⊥BWt‖2 ≤2k sin2 θt(‖Γ̂t‖2 + ‖ΛV⊥‖2) ≤ 4k|λ1|2 tan2 θt (25)\nThe last step is correct since ‖ΛV⊥‖ ≤ |λ1| and ‖Γ̂t‖ ≤ ‖(V⊤BWt)−1‖‖ΛV‖‖V⊤B 1 2 ‖‖B 12Wt‖ ≤ 1\ncos θt |λ1|\nThis means we wish to decrease the ratio of final to initial error smaller than:\nǫdes ǫinit ≤ ρ 2 64kγ2 min{ 1 cos2 θt , sin2 θt cos4 θt } (26)\nwhere γ = |λ1||λk| . Therefore, a two phase analysis of running time depending on θt is large or small similar to top 1 case would gives the total runtime:\n2\nρ\n( log 1 cos θ0 · T ( ρ2 cos4 θ0 64kγ2 ) + log 1 ǫ · T ( ρ2 64kγ2 )) + 2 ρ ( nnz (A) k + nnz (B) k + dk2 ) log\n1\nǫ cos θ0 ,\nif we are using the accelerated gradient descent to solve the linear system, we are essentially solve k disjoint optimization problem, with each problem dimension d and condition number κ(B). Directly apply Theorem 8 gives runtime\nO\n( nnz (B) k √ κ(B)\nρ\n( log 1\ncos θ0 log\nkγ\nρ cos θ0 + log\n1 ǫ log kγ ρ\n) + ( nnz (A) k + dk2 )\nρ log\n1\nǫ cos θ0\n) .\nFinally, since both results Theorem 5 and Theorem 7 are stated in terms of initialization θ0, here we will give probablistic guarantee for random initialization.\nLemma 13 (Random Initialization). Let top k eigen-vector be V ∈ Rd×k, and the remaining eigenvector be V⊥ ∈ Rd×(d−k). If we initialize W0 as in Algorithm 2, then With at least probability 1−η, we have:\ntan θ0 = ‖V⊤⊥BW0(V⊤BW0)−1‖ ≤ O( √ κ(B)dk\nη ) (27)\nProof. Recall W̃ is entry-wise sampled from standard Gaussian, and\ntan θ0 =‖V⊤⊥BW0(V⊤BW0)−1‖ = ‖V⊤⊥BW̃0(V⊤BW̃0)−1‖ ≤ ‖V⊤⊥BW̃0‖ σk(V⊤BW̃0)\n≤ ‖V ⊤ ⊥BṼ⊥‖\nσk(V⊤BṼ)\n‖Ṽ⊥ ⊤ W̃0‖ σk(Ṽ⊤W̃0) (28)\nWhere Ṽ⊥, Ṽ are the right singular vectors of V⊤⊥B,V ⊤B respectively. Then, we have first term:\n‖V⊤⊥BṼ⊥‖ σk(V⊤BṼ) = ‖V⊤⊥B‖ σk(V⊤B) ≤ ‖V ⊤ ⊥B 1 2‖‖B 12‖ σk(V⊤B 1 2 )σmin(B 1 2 ) = κ(B) 1 2 (29)\nThe last step is true since both V⊤⊥B 1 2 and V⊤B 1 2 are orthonormal matrix.\nFor the second term, we know ‖Ṽ⊥ ⊤ W̃0‖ ∼ O( √ d+ √ k) with high probability, and by equation 3.2 in (Rudelson and Vershynin, 2010) we know σk(Ṽ ⊤W̃0) ≥ η√k with probability at least 1− η, which finishes the proof.\nB.3 CCA Setting\nSince our approach to CCA directly calls Algorithm 2 for solving generalized eigenvalue problem as subroutine, most of the theoretical property should be clear other than random projection step in Algorithm 3. Here, we give following lemma. The proof of Theorem 7 easily follow from the combination of this lemma and Theorem 6.\nLemma 14. If the ( W̄x W̄y ) as constructed in Algorithm 3 has angle at most θ with the true top2k generalized eigenspace of A,B, then with probability 1 − ζ, both Wx, Wy has angle at most O(k2θ/ζ2) with the true top-k canonical space of X,Y.\nProof. We will prove this for Wy, the proof for Wx follows directly from same strategy.\nRecall B = ( Sxx 0 0 Syy ) . Let Φ ∈ Rd1×k be the true top k subspace of X and Ψ ∈ Rd2×k be the true top k subspace of Y.Then by construction we know the top 2k subspace should be\n1√ 2 ( Φ −Φ Ψ Ψ ) .\nBy properties of principal angle, we know there exists an orthonormal matrix R ∈ R2k×2k such that\n‖ 1√ 2 B1/2 ( Φ −Φ Ψ Ψ ) R−B1/2 ( W̄x W̄y ) ‖ ≤ 2 sin θ 2 .\nIn particular, if we only look at the last d2 rows, we have\n‖ 1√ 2 S1/2yy\n( Ψ Ψ ) R− S1/2yy W̄y‖ ≤ 2 sin θ\n2 .\nLet U be the random Gaussian projection we used, and let RU = ( U1 U2 ) , we know\nS1/2yy W̄yU = 1√ 2 S1/2yy\n( Ψ Ψ )( U1 U2 ) +E\n= 1√ 2 S1/2yy Ψ(U1 +U2) +E,\nwhere E is the error (after multipled by random matrix U), with ‖E‖ ≤ O(2 √ k sin θ2) ≤ O( √ kθ).\nLet V = (S 1/2 yy W̄yU) ⊤S1/2yy W̄yU, the orthonormalization step gives a matrix Wy that is equivalent (up to rotation) to W̄yUV\n−1/2. Our goal is to show V−1/2 ≈ ((U1 +U2)⊤(U1 +U2))−1/2 so we get roughly Ψ.\nNote that Ψ⊤SyyΨ = I, therefore V = 12 (U1 + U2) ⊤(U1 + U2) + E′ where the error E′ =\n( 1√ 2 S 1/2 yy Ψ(U1+U2)) ⊤E+ 1√ 2 E⊤(S1/2yy Ψ(U1+U2))+E⊤E). We know with high probability ‖U1+\nU2‖ ≤ O( √ k), with probability at least 1 − ζ, σmin(U1 + U2) ≥ Ω(ζ/ √ k). Therefore we know σmin[(U1 +U2) ⊤(U1 +U2)] ≥ Ω(ζ2/k) and ‖E′‖ ≤ O(kθ). By matrix perturbation for inverse we\nknow ‖V−1/2 − √ 2((U1 +U2)\n⊤(U1 +U2))−1/2‖ ≤ O(k2θ/ζ2). Since (U1 +U2)((U1 +U2)⊤(U1 + U2)) −1/2 = R′ is an orthonormal matrix, we know there’s some orthonormal matrix R′′ so that:\n‖S1/2yy Wy − S1/2yy ΨR′′‖ = ‖S1/2yy W̄yUV−1/2 − S1/2yy ΨR′‖ ≤‖S1/2yy W̄yUV−1/2 − √ 2S1/2yy W̄yU((U1 +U2) ⊤(U1 +U2)) −1/2‖\n+ ‖ √ 2S1/2yy W̄yU((U1 +U2) ⊤(U1 +U2)) −1/2 − S1/2yy ΨR′‖ ≤ O(k2θ/ζ2)\nTherefore the angle between the Wy and the truth Ψ is bounded by O(k 2θ/ζ2)."
    } ],
    "references" : [ {
      "title" : "Efficient dimensionality reduction for canonical correlation analysis",
      "author" : [ "H. Avron", "C. Boutsidis", "S. Toledo", "A. Zouzias" ],
      "venue" : "SIAM Journal on Scientific Computing, 36(5):S111–S131.",
      "citeRegEx" : "Avron et al\\.,? 2014",
      "shortCiteRegEx" : "Avron et al\\.",
      "year" : 2014
    }, {
      "title" : "Origins and levels of monthly and seasonal forecast skill for united states surface air temperatures determined by canonical correlation analysis",
      "author" : [ "T. Barnett", "R. Preisendorfer" ],
      "venue" : "Monthly Weather Review, 115(9):1825–1850.",
      "citeRegEx" : "Barnett and Preisendorfer,? 1987",
      "shortCiteRegEx" : "Barnett and Preisendorfer",
      "year" : 1987
    }, {
      "title" : "Prediction of enso episodes using canonical correlation analysis",
      "author" : [ "A.G. Barnston", "C.F. Ropelewski" ],
      "venue" : "Journal of climate, 5(11):1316–1345.",
      "citeRegEx" : "Barnston and Ropelewski,? 1992",
      "shortCiteRegEx" : "Barnston and Ropelewski",
      "year" : 1992
    }, {
      "title" : "Multi-view clustering via canonical correlation analysis",
      "author" : [ "K. Chaudhuri", "S.M. Kakade", "K. Livescu", "K. Sridharan" ],
      "venue" : "Proceedings of the 26th annual international conference on machine learning, pages 129–136. ACM.",
      "citeRegEx" : "Chaudhuri et al\\.,? 2009",
      "shortCiteRegEx" : "Chaudhuri et al\\.",
      "year" : 2009
    }, {
      "title" : "Multi-view learning of word embeddings via cca",
      "author" : [ "P. Dhillon", "D.P. Foster", "L.H. Ungar" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 199–207.",
      "citeRegEx" : "Dhillon et al\\.,? 2011",
      "shortCiteRegEx" : "Dhillon et al\\.",
      "year" : 2011
    }, {
      "title" : "Detection of neural activity in functional mri using canonical correlation analysis",
      "author" : [ "O. Friman", "J. Cedefamn", "P. Lundberg", "M. Borga", "H. Knutsson" ],
      "venue" : "Magnetic Resonance in Medicine, 45(2):323–330.",
      "citeRegEx" : "Friman et al\\.,? 2001",
      "shortCiteRegEx" : "Friman et al\\.",
      "year" : 2001
    }, {
      "title" : "Un-regularizing: approximate proximal point and faster stochastic algorithms for empirical risk minimization",
      "author" : [ "R. Frostig", "R. Ge", "S.M. Kakade", "A. Sidford" ],
      "venue" : "ICML2015.",
      "citeRegEx" : "Frostig et al\\.,? 2015",
      "shortCiteRegEx" : "Frostig et al\\.",
      "year" : 2015
    }, {
      "title" : "Fast and simple pca via convex optimization",
      "author" : [ "D. Garber", "E. Hazan" ],
      "venue" : "arXiv preprint arXiv:1509.05647.",
      "citeRegEx" : "Garber and Hazan,? 2015",
      "shortCiteRegEx" : "Garber and Hazan",
      "year" : 2015
    }, {
      "title" : "Matrix computations, volume 3",
      "author" : [ "G.H. Golub", "C.F. Van Loan" ],
      "venue" : "JHU Press.",
      "citeRegEx" : "Golub and Loan,? 2012",
      "shortCiteRegEx" : "Golub and Loan",
      "year" : 2012
    }, {
      "title" : "Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions",
      "author" : [ "N. Halko", "Martinsson", "P.-G.", "J.A. Tropp" ],
      "venue" : "SIAM review, 53(2):217– 288.",
      "citeRegEx" : "Halko et al\\.,? 2011",
      "shortCiteRegEx" : "Halko et al\\.",
      "year" : 2011
    }, {
      "title" : "Canonical correlation analysis: An overview with application to learning methods",
      "author" : [ "D.R. Hardoon", "S. Szedmak", "J. Shawe-Taylor" ],
      "venue" : "Neural computation, 16(12):2639–2664.",
      "citeRegEx" : "Hardoon et al\\.,? 2004",
      "shortCiteRegEx" : "Hardoon et al\\.",
      "year" : 2004
    }, {
      "title" : "Methods of conjugate gradients for solving linear systems, volume 49",
      "author" : [ "M.R. Hestenes", "E. Stiefel" ],
      "venue" : "NBS.",
      "citeRegEx" : "Hestenes and Stiefel,? 1952",
      "shortCiteRegEx" : "Hestenes and Stiefel",
      "year" : 1952
    }, {
      "title" : "Relations between two sets of variates",
      "author" : [ "H. Hotelling" ],
      "venue" : "Biometrika, 28(3/4):321–377.",
      "citeRegEx" : "Hotelling,? 1936",
      "shortCiteRegEx" : "Hotelling",
      "year" : 1936
    }, {
      "title" : "Robust shift-and-invert preconditioning: Faster and more sample efficient algorithms for eigenvector computation",
      "author" : [ "C. Jin", "S.M. Kakade", "C. Musco", "P. Netrapalli", "A. Sidford" ],
      "venue" : "CoRR, abs/1510.08896.",
      "citeRegEx" : "Jin et al\\.,? 2015",
      "shortCiteRegEx" : "Jin et al\\.",
      "year" : 2015
    }, {
      "title" : "Accelerating stochastic gradient descent using predictive variance reduction",
      "author" : [ "R. Johnson", "T. Zhang" ],
      "venue" : "NIPS2013, pages 315–323.",
      "citeRegEx" : "Johnson and Zhang,? 2013",
      "shortCiteRegEx" : "Johnson and Zhang",
      "year" : 2013
    }, {
      "title" : "Multi-view regression via canonical correlation analysis",
      "author" : [ "S.M. Kakade", "D.P. Foster" ],
      "venue" : "Learning theory, pages 82–96. Springer.",
      "citeRegEx" : "Kakade and Foster,? 2007",
      "shortCiteRegEx" : "Kakade and Foster",
      "year" : 2007
    }, {
      "title" : "Discriminative features via generalized eigenvectors",
      "author" : [ "N. Karampatziakis", "P. Mineiro" ],
      "venue" : "arXiv preprint arXiv:1310.1934.",
      "citeRegEx" : "Karampatziakis and Mineiro,? 2013",
      "shortCiteRegEx" : "Karampatziakis and Mineiro",
      "year" : 2013
    }, {
      "title" : "The mnist database of handwritten digits",
      "author" : [ "Y. LeCun", "C. Cortes", "C.J. Burges" ],
      "venue" : null,
      "citeRegEx" : "LeCun et al\\.,? \\Q1998\\E",
      "shortCiteRegEx" : "LeCun et al\\.",
      "year" : 1998
    }, {
      "title" : "A universal catalyst for first-order optimization",
      "author" : [ "H. Lin", "J. Mairal", "Z. Harchaoui" ],
      "venue" : "arXiv preprint arXiv:1506.02186.",
      "citeRegEx" : "Lin et al\\.,? 2015",
      "shortCiteRegEx" : "Lin et al\\.",
      "year" : 2015
    }, {
      "title" : "Large scale canonical correlation analysis with iterative least squares",
      "author" : [ "Y. Lu", "D.P. Foster" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 91–99.",
      "citeRegEx" : "Lu and Foster,? 2014",
      "shortCiteRegEx" : "Lu and Foster",
      "year" : 2014
    }, {
      "title" : "Finding Linear Structure in Large Datasets with Scalable Canonical Correlation Analysis",
      "author" : [ "Z. Ma", "Y. Lu", "D.P. Foster" ],
      "venue" : "Proceedings of the 32nd International Conference on Machine Learning, JMLR Proceedings.",
      "citeRegEx" : "Ma et al\\.,? 2015",
      "shortCiteRegEx" : "Ma et al\\.",
      "year" : 2015
    }, {
      "title" : "Building a large annotated corpus of english: The penn treebank",
      "author" : [ "M.P. Marcus", "M.A. Marcinkiewicz", "B. Santorini" ],
      "venue" : "Computational linguistics, 19(2):313–330.",
      "citeRegEx" : "Marcus et al\\.,? 1993",
      "shortCiteRegEx" : "Marcus et al\\.",
      "year" : 1993
    }, {
      "title" : "Nonparametric Canonical Correlation Analysis",
      "author" : [ "T. Michaeli", "W. Wang", "K. Livescu" ],
      "venue" : "CoRR, abs/1511.04839.",
      "citeRegEx" : "Michaeli et al\\.,? 2015",
      "shortCiteRegEx" : "Michaeli et al\\.",
      "year" : 2015
    }, {
      "title" : "Stronger approximate singular value decomposition via the block lanczos and power methods",
      "author" : [ "C. Musco", "C. Musco" ],
      "venue" : "arXiv preprint arXiv:1504.05477.",
      "citeRegEx" : "Musco and Musco,? 2015",
      "shortCiteRegEx" : "Musco and Musco",
      "year" : 2015
    }, {
      "title" : "A method of solving a convex programming problem with convergence rate o (1/k2)",
      "author" : [ "Y. Nesterov" ],
      "venue" : "Soviet Mathematics Doklady, volume 27, pages 372–376.",
      "citeRegEx" : "Nesterov,? 1983",
      "shortCiteRegEx" : "Nesterov",
      "year" : 1983
    }, {
      "title" : "Core-sets for canonical correlation analysis",
      "author" : [ "S. Paul" ],
      "venue" : "Proceedings of the 24th ACM International on Conference on Information and Knowledge Management, pages 1887–1890. ACM.",
      "citeRegEx" : "Paul,? 2015",
      "shortCiteRegEx" : "Paul",
      "year" : 2015
    }, {
      "title" : "A randomized algorithm for principal component analysis",
      "author" : [ "V. Rokhlin", "A. Szlam", "M. Tygert" ],
      "venue" : "SIAM Journal on Matrix Analysis and Applications, 31(3):1100–1124.",
      "citeRegEx" : "Rokhlin et al\\.,? 2009",
      "shortCiteRegEx" : "Rokhlin et al\\.",
      "year" : 2009
    }, {
      "title" : "Non-asymptotic theory of random matrices: extreme singular values",
      "author" : [ "M. Rudelson", "R. Vershynin" ],
      "venue" : "arXiv preprint arXiv:1003.2990.",
      "citeRegEx" : "Rudelson and Vershynin,? 2010",
      "shortCiteRegEx" : "Rudelson and Vershynin",
      "year" : 2010
    }, {
      "title" : "Conducting and interpreting canonical correlation analysis in personality research: A user-friendly primer",
      "author" : [ "A. Sherry", "R.K. Henson" ],
      "venue" : "Journal of personality assessment, 84(1):37–48.",
      "citeRegEx" : "Sherry and Henson,? 2005",
      "shortCiteRegEx" : "Sherry and Henson",
      "year" : 2005
    }, {
      "title" : "An introduction to the conjugate gradient method without the agonizing pain",
      "author" : [ "J.R. Shewchuk" ],
      "venue" : "Technical report, Pittsburgh, PA, USA.",
      "citeRegEx" : "Shewchuk,? 1994",
      "shortCiteRegEx" : "Shewchuk",
      "year" : 1994
    }, {
      "title" : "Normalized cuts and image segmentation",
      "author" : [ "J. Shi", "J. Malik" ],
      "venue" : "Pattern Analysis and Machine Intelligence, IEEE Transactions on, 22(8):888–905.",
      "citeRegEx" : "Shi and Malik,? 2000",
      "shortCiteRegEx" : "Shi and Malik",
      "year" : 2000
    }, {
      "title" : "Nearly-linear time algorithms for graph partitioning, graph sparsification, and solving linear systems",
      "author" : [ "D.A. Spielman", "Teng", "S.-H." ],
      "venue" : "Proceedings of the thirty-sixth annual ACM symposium on Theory of computing, pages 81–90. ACM.",
      "citeRegEx" : "Spielman et al\\.,? 2004",
      "shortCiteRegEx" : "Spielman et al\\.",
      "year" : 2004
    }, {
      "title" : "Stochastic optimization for deep CCA via nonlinear orthogonal iterations",
      "author" : [ "W. Wang", "R. Arora", "K. Livescu", "N. Srebro" ],
      "venue" : "volume abs/1510.02054. 16",
      "citeRegEx" : "Wang et al\\.,? 2015",
      "shortCiteRegEx" : "Wang et al\\.",
      "year" : 2015
    }, {
      "title" : "Large-Scale Approximate Kernel Canonical Correlation Analysis",
      "author" : [ "W. Wang", "K. Livescu" ],
      "venue" : "CoRR, abs/1511.04773.",
      "citeRegEx" : "Wang and Livescu,? 2015",
      "shortCiteRegEx" : "Wang and Livescu",
      "year" : 2015
    }, {
      "title" : "Globally convergent stochastic optimization for canonical correlation analysis",
      "author" : [ "W. Wang", "J. Wang", "N. Srebro" ],
      "venue" : "arXiv preprint arXiv:1604.01870.",
      "citeRegEx" : "Wang et al\\.,? 2016",
      "shortCiteRegEx" : "Wang et al\\.",
      "year" : 2016
    }, {
      "title" : "A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis",
      "author" : [ "D.M. Witten", "R. Tibshirani", "T. Hastie" ],
      "venue" : "Biostatistics, page kxp008. 17",
      "citeRegEx" : "Witten et al\\.,? 2009",
      "shortCiteRegEx" : "Witten et al\\.",
      "year" : 2009
    } ],
    "referenceMentions" : [ {
      "referenceID" : 12,
      "context" : "This paper considers the problem of canonical-correlation analysis (CCA) (Hotelling, 1936) and, more broadly, the generalized eigenvector problem for a pair of symmetric matrices.",
      "startOffset" : 73,
      "endOffset" : 90
    }, {
      "referenceID" : 30,
      "context" : "These are two fundamental problems in data analysis and scientific computing with numerous applications in machine learning and statistics (Shi and Malik, 2000; Hardoon et al., 2004; Witten et al., 2009).",
      "startOffset" : 139,
      "endOffset" : 203
    }, {
      "referenceID" : 10,
      "context" : "These are two fundamental problems in data analysis and scientific computing with numerous applications in machine learning and statistics (Shi and Malik, 2000; Hardoon et al., 2004; Witten et al., 2009).",
      "startOffset" : 139,
      "endOffset" : 203
    }, {
      "referenceID" : 35,
      "context" : "These are two fundamental problems in data analysis and scientific computing with numerous applications in machine learning and statistics (Shi and Malik, 2000; Hardoon et al., 2004; Witten et al., 2009).",
      "startOffset" : 139,
      "endOffset" : 203
    }, {
      "referenceID" : 1,
      "context" : "Canonical-correlation analysis (CCA) and the generalized eigenvector problem are fundamental problems in scientific computing, data analysis, and statistics (Barnett and Preisendorfer, 1987; Friman et al., 2001).",
      "startOffset" : 157,
      "endOffset" : 211
    }, {
      "referenceID" : 5,
      "context" : "Canonical-correlation analysis (CCA) and the generalized eigenvector problem are fundamental problems in scientific computing, data analysis, and statistics (Barnett and Preisendorfer, 1987; Friman et al., 2001).",
      "startOffset" : 157,
      "endOffset" : 211
    }, {
      "referenceID" : 15,
      "context" : "Algorithms for solving them are commonly used to extract features to compare and contrast large data sets and are used commonly in regression (Kakade and Foster, 2007), clustering (Chaudhuri et al.",
      "startOffset" : 142,
      "endOffset" : 167
    }, {
      "referenceID" : 3,
      "context" : "Algorithms for solving them are commonly used to extract features to compare and contrast large data sets and are used commonly in regression (Kakade and Foster, 2007), clustering (Chaudhuri et al., 2009), classification (Karampatziakis and Mineiro, 2013), word embeddings (Dhillon et al.",
      "startOffset" : 180,
      "endOffset" : 204
    }, {
      "referenceID" : 16,
      "context" : ", 2009), classification (Karampatziakis and Mineiro, 2013), word embeddings (Dhillon et al.",
      "startOffset" : 24,
      "endOffset" : 58
    }, {
      "referenceID" : 4,
      "context" : ", 2009), classification (Karampatziakis and Mineiro, 2013), word embeddings (Dhillon et al., 2011) and more.",
      "startOffset" : 76,
      "endOffset" : 98
    }, {
      "referenceID" : 1,
      "context" : "Despite the prevalence of these problems and the breadth of research on solving them in practice ((Barnett and Preisendorfer, 1987; Barnston and Ropelewski, 1992; Sherry and Henson, 2005; Karampatziakis and Mineiro, 2013) to name a few), there are relatively few results on obtaining provably efficient algorithms.",
      "startOffset" : 98,
      "endOffset" : 221
    }, {
      "referenceID" : 2,
      "context" : "Despite the prevalence of these problems and the breadth of research on solving them in practice ((Barnett and Preisendorfer, 1987; Barnston and Ropelewski, 1992; Sherry and Henson, 2005; Karampatziakis and Mineiro, 2013) to name a few), there are relatively few results on obtaining provably efficient algorithms.",
      "startOffset" : 98,
      "endOffset" : 221
    }, {
      "referenceID" : 28,
      "context" : "Despite the prevalence of these problems and the breadth of research on solving them in practice ((Barnett and Preisendorfer, 1987; Barnston and Ropelewski, 1992; Sherry and Henson, 2005; Karampatziakis and Mineiro, 2013) to name a few), there are relatively few results on obtaining provably efficient algorithms.",
      "startOffset" : 98,
      "endOffset" : 221
    }, {
      "referenceID" : 16,
      "context" : "Despite the prevalence of these problems and the breadth of research on solving them in practice ((Barnett and Preisendorfer, 1987; Barnston and Ropelewski, 1992; Sherry and Henson, 2005; Karampatziakis and Mineiro, 2013) to name a few), there are relatively few results on obtaining provably efficient algorithms.",
      "startOffset" : 98,
      "endOffset" : 221
    }, {
      "referenceID" : 0,
      "context" : "Can we develop simple iterative practical methods that solve this problem in close to linear time when k is small and the condition number and eigenvalue gaps are bounded? While there has been recent work on solving these problems using iterative methods (Avron et al., 2014; Paul, 2015; Lu and Foster, 2014; Ma et al., 2015) we are unaware of previous provable global convergence results and more strongly, linearly convergent scalable algorithms.",
      "startOffset" : 255,
      "endOffset" : 325
    }, {
      "referenceID" : 25,
      "context" : "Can we develop simple iterative practical methods that solve this problem in close to linear time when k is small and the condition number and eigenvalue gaps are bounded? While there has been recent work on solving these problems using iterative methods (Avron et al., 2014; Paul, 2015; Lu and Foster, 2014; Ma et al., 2015) we are unaware of previous provable global convergence results and more strongly, linearly convergent scalable algorithms.",
      "startOffset" : 255,
      "endOffset" : 325
    }, {
      "referenceID" : 19,
      "context" : "Can we develop simple iterative practical methods that solve this problem in close to linear time when k is small and the condition number and eigenvalue gaps are bounded? While there has been recent work on solving these problems using iterative methods (Avron et al., 2014; Paul, 2015; Lu and Foster, 2014; Ma et al., 2015) we are unaware of previous provable global convergence results and more strongly, linearly convergent scalable algorithms.",
      "startOffset" : 255,
      "endOffset" : 325
    }, {
      "referenceID" : 20,
      "context" : "Can we develop simple iterative practical methods that solve this problem in close to linear time when k is small and the condition number and eigenvalue gaps are bounded? While there has been recent work on solving these problems using iterative methods (Avron et al., 2014; Paul, 2015; Lu and Foster, 2014; Ma et al., 2015) we are unaware of previous provable global convergence results and more strongly, linearly convergent scalable algorithms.",
      "startOffset" : 255,
      "endOffset" : 325
    }, {
      "referenceID" : 26,
      "context" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 169,
      "endOffset" : 276
    }, {
      "referenceID" : 9,
      "context" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 169,
      "endOffset" : 276
    }, {
      "referenceID" : 23,
      "context" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 169,
      "endOffset" : 276
    }, {
      "referenceID" : 7,
      "context" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 169,
      "endOffset" : 276
    }, {
      "referenceID" : 13,
      "context" : "While there has been limited previous work on provably solving CCA and generalized eigenvectors, we note that there is an impressive body of literature on performing PCA(Rokhlin et al., 2009; Halko et al., 2011; Musco and Musco, 2015; Garber and Hazan, 2015; Jin et al., 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 169,
      "endOffset" : 276
    }, {
      "referenceID" : 11,
      "context" : ", 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 56,
      "endOffset" : 125
    }, {
      "referenceID" : 24,
      "context" : ", 2015) and solving positive semidefinite linear systems(Hestenes and Stiefel, 1952; Nesterov, 1983; Spielman and Teng, 2004).",
      "startOffset" : 56,
      "endOffset" : 125
    }, {
      "referenceID" : 20,
      "context" : "There has been much recent interest in designing scalable algorithms for CCA(Ma et al., 2015; Wang et al., 2015; Wang and Livescu, 2015; Michaeli et al., 2015).",
      "startOffset" : 76,
      "endOffset" : 159
    }, {
      "referenceID" : 32,
      "context" : "There has been much recent interest in designing scalable algorithms for CCA(Ma et al., 2015; Wang et al., 2015; Wang and Livescu, 2015; Michaeli et al., 2015).",
      "startOffset" : 76,
      "endOffset" : 159
    }, {
      "referenceID" : 33,
      "context" : "There has been much recent interest in designing scalable algorithms for CCA(Ma et al., 2015; Wang et al., 2015; Wang and Livescu, 2015; Michaeli et al., 2015).",
      "startOffset" : 76,
      "endOffset" : 159
    }, {
      "referenceID" : 22,
      "context" : "There has been much recent interest in designing scalable algorithms for CCA(Ma et al., 2015; Wang et al., 2015; Wang and Livescu, 2015; Michaeli et al., 2015).",
      "startOffset" : 76,
      "endOffset" : 159
    }, {
      "referenceID" : 35,
      "context" : "Heuristic-based approachs (Witten et al., 2009; Lu and Foster, 2014) compute efficiently, but only give suboptimal result due to coarse approximation.",
      "startOffset" : 26,
      "endOffset" : 68
    }, {
      "referenceID" : 19,
      "context" : "Heuristic-based approachs (Witten et al., 2009; Lu and Foster, 2014) compute efficiently, but only give suboptimal result due to coarse approximation.",
      "startOffset" : 26,
      "endOffset" : 68
    }, {
      "referenceID" : 20,
      "context" : "The work in (Ma et al., 2015) provides one natural iterative procedure, where the per iterate computational complexity is low.",
      "startOffset" : 12,
      "endOffset" : 29
    }, {
      "referenceID" : 20,
      "context" : "Also of note is that many recent algorithms (Ma et al., 2015; Wang et al., 2015) have mini-batch variations, but there’s no guarantees for mini-batch style algorithm for CCA yet.",
      "startOffset" : 44,
      "endOffset" : 80
    }, {
      "referenceID" : 32,
      "context" : "Also of note is that many recent algorithms (Ma et al., 2015; Wang et al., 2015) have mini-batch variations, but there’s no guarantees for mini-batch style algorithm for CCA yet.",
      "startOffset" : 44,
      "endOffset" : 80
    }, {
      "referenceID" : 20,
      "context" : "S-AppGrad (Ma et al., 2015) Õ( ρ log 1 ǫ )",
      "startOffset" : 10,
      "endOffset" : 27
    }, {
      "referenceID" : 34,
      "context" : "Subsequent to the submission of this paper, we learned of the closely related work in (Wang et al., 2016), which presents a number of additional interesting results.",
      "startOffset" : 86,
      "endOffset" : 105
    }, {
      "referenceID" : 20,
      "context" : "(Ma et al., 2015) only shows local convergence for S-AppGrad.",
      "startOffset" : 0,
      "endOffset" : 17
    }, {
      "referenceID" : 34,
      "context" : "This table was inspired by (Wang et al., 2016) in order to facilitate comparison to existing work.",
      "startOffset" : 27,
      "endOffset" : 46
    }, {
      "referenceID" : 14,
      "context" : "(AGD), it is immediate to apply Theorem 7 and give the corresponding rates if we instantiate it by other popular algorithms, including gradient descent (GD), stochastic variance reduction (SVRG) (Johnson and Zhang, 2013), and its accelerated version (ASVRG) (Frostig et al.",
      "startOffset" : 195,
      "endOffset" : 220
    }, {
      "referenceID" : 6,
      "context" : "(AGD), it is immediate to apply Theorem 7 and give the corresponding rates if we instantiate it by other popular algorithms, including gradient descent (GD), stochastic variance reduction (SVRG) (Johnson and Zhang, 2013), and its accelerated version (ASVRG) (Frostig et al., 2015; Lin et al., 2015).",
      "startOffset" : 258,
      "endOffset" : 298
    }, {
      "referenceID" : 18,
      "context" : "(AGD), it is immediate to apply Theorem 7 and give the corresponding rates if we instantiate it by other popular algorithms, including gradient descent (GD), stochastic variance reduction (SVRG) (Johnson and Zhang, 2013), and its accelerated version (ASVRG) (Frostig et al., 2015; Lin et al., 2015).",
      "startOffset" : 258,
      "endOffset" : 298
    }, {
      "referenceID" : 29,
      "context" : "Moreover, it is well known that any method which starts at m and iteratively applies M to linear combinations of the points computed so far must apply M at least Ω( √ κ(B)) in order to halve the error in the standard norm for the problem (Shewchuk, 1994).",
      "startOffset" : 238,
      "endOffset" : 254
    }, {
      "referenceID" : 17,
      "context" : "MNIST dataset(LeCun et al., 1998) consists of 60,000 handwritten digits from 0 to 9.",
      "startOffset" : 13,
      "endOffset" : 33
    }, {
      "referenceID" : 21,
      "context" : "17 million tokens and a vocabulary size of 43k(Marcus et al., 1993), which has already been used to successfully learn the word embedding by CCA(Dhillon et al.",
      "startOffset" : 46,
      "endOffset" : 67
    }, {
      "referenceID" : 4,
      "context" : ", 1993), which has already been used to successfully learn the word embedding by CCA(Dhillon et al., 2011).",
      "startOffset" : 84,
      "endOffset" : 106
    }, {
      "referenceID" : 20,
      "context" : "For experiments in this section, we follow the setting of (Ma et al., 2015).",
      "startOffset" : 58,
      "endOffset" : 75
    }, {
      "referenceID" : 20,
      "context" : "We compare our algorithm to S-AppGrad (Ma et al., 2015) which is an iterative algorithm and PCA-CCA (Ma et al.",
      "startOffset" : 38,
      "endOffset" : 55
    }, {
      "referenceID" : 20,
      "context" : ", 2015) which is an iterative algorithm and PCA-CCA (Ma et al., 2015), NW-CCA (Witten et al.",
      "startOffset" : 52,
      "endOffset" : 69
    }, {
      "referenceID" : 35,
      "context" : ", 2015), NW-CCA (Witten et al., 2009) and DW-CCA (Lu and Foster, 2014) which are one-shot estimation procedures.",
      "startOffset" : 16,
      "endOffset" : 37
    }, {
      "referenceID" : 19,
      "context" : ", 2009) and DW-CCA (Lu and Foster, 2014) which are one-shot estimation procedures.",
      "startOffset" : 19,
      "endOffset" : 40
    } ],
    "year" : 2016,
    "abstractText" : "This paper considers the problem of canonical-correlation analysis (CCA) (Hotelling, 1936) and, more broadly, the generalized eigenvector problem for a pair of symmetric matrices. These are two fundamental problems in data analysis and scientific computing with numerous applications in machine learning and statistics (Shi and Malik, 2000; Hardoon et al., 2004; Witten et al., 2009). We provide simple iterative algorithms, with improved runtimes, for solving these problems that are globally linearly convergent with moderate dependencies on the condition numbers and eigenvalue gaps of the matrices involved. We obtain our results by reducing CCA to the top-k generalized eigenvector problem. We solve this problem through a general framework that simply requires black box access to an approximate linear system solver. Instantiating this framework with accelerated gradient descent we obtain a running time of O ( zk √ κ ρ log(1/ǫ) log (kκ/ρ) ) where z is the total number of nonzero entries, κ is the condition number and ρ is the relative eigenvalue gap of the appropriate matrices. Our algorithm is linear in the input size and the number of components k up to a log(k) factor. This is essential for handling large-scale matrices that appear in practice. To the best of our knowledge this is the first such algorithm with global linear convergence. We hope that our results prompt further research and ultimately improve the practical running time for performing these important data analysis procedures on large data sets.",
    "creator" : "LaTeX with hyperref package"
  }
}