{
  "name" : "1603.03130.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Theoretical Comparisons of Positive-Unlabeled Learning against Positive-Negative Learning",
    "authors" : [ "Gang Niu", "Marthinus C. du Plessis", "Tomoya Sakai", "Yao Ma", "Masashi Sugiyama" ],
    "emails" : [ "gang@ms.,", "christo@ms.,", "sakai@ms.,", "yao@ms.," ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Positive-unlabeled (PU) learning, where a binary classifier is trained from P and U data, has drawn considerable attention recently [1, 2, 3, 4, 5, 6, 7, 8]. It is appealing to not only the academia but also the industry, since for example the click-through data automatically collected in search engines are highly PU due to position biases [9, 10, 11]. Although PU learning uses no negative (N) data, it is sometimes even better than PN learning (i.e., ordinary supervised learning, perhaps with class-prior change [12]) in practice. Nevertheless, there is neither theoretical nor experimental analysis for this phenomenon, and it is still an open problem when PU learning is likely to outperform PN learning. We clarify this question in this paper.\nProblem settings For PU learning, there are two problem settings based on one sample (OS) and two samples (TS) of data respectively. More specifically, let X ∈ Rd and Y ∈ {±1} (d ∈ N) be the input and output random variables and equipped with an underlying joint density p(x, y). In OS [3], a set of U data is sampled from the marginal density p(x). Then if a data point x is P, this P label is observed with probability c, and x remains U with probability 1− c; if x is N, this N label is never observed, and x remains U with probability 1. In TS [4], a set of P data is drawn from the positive marginal density p(x | Y = +1) and a set of U data is drawn from p(x). Denote by n+ and nu the sizes of P and U data. As two random variables, they are fully independent in TS, and they satisfy n+/(n+ + nu) ≈ cπ in OS where π = p(Y = +1) is the class-prior probability. Therefore, TS is slightly more general than OS, and we will focus on TS problem settings.\nSimilarly, consider TS problem settings of PN and NU learning, where a set of N data (of size n−) is sampled from p(x | Y = −1) independently of the P/U data. For PN learning, if we enforce that n+/(n+ + n−) ≈ π when sampling the data, it will be ordinary supervised learning; otherwise, it is supervised learning with class-prior change, a.k.a. prior probability shift [12].\n30th Conference on Neural Information Processing Systems (NIPS 2016), Barcelona, Spain.\nar X\niv :1\n60 3.\n03 13\n0v 3\n[ cs\n.L G\n] 2\n8 O\nct 2\nIn [7], a cost-sensitive formulation for PU learning was proposed, and its risk estimator was proven unbiased if the surrogate loss is non-convex and satisfies a symmetric condition. Therefore, we can naturally compare empirical risk minimizers in PU and NU learning against that in PN learning.\nContributions We establish risk bounds of three risk minimizers in PN, PU and NU learning for comparisons in a flavor of statistical learning theory [13, 14]. For each minimizer, we firstly derive a uniform deviation bound from the risk estimator to the risk using Rademacher complexities (see, e.g., [15, 16, 17, 18]), and secondly obtain an estimation error bound. Thirdly, if the surrogate loss is classification-calibrated [19], an excess risk bound is an immediate corollary. In [7], there was a generalization error bound similar to our uniform deviation bound for PU learning. However, it is based on a tricky decomposition of the risk, where surrogate losses for risk minimization and risk analysis are different and labels of U data are needed for risk evaluation, so that no further bound is implied. On the other hand, ours utilizes the same surrogate loss for risk minimization and analysis and requires no label of U data for risk evaluation, so that an estimation error bound is possible.\nOur main results can be summarized as follows. Denote by ĝpn, ĝpu and ĝnu the risk minimizers in PN, PU and NU learning. Under a mild assumption on the function class and data distributions,\n• Finite-sample case: The estimation error bound of ĝpu is tighter than that of ĝpn whenever π/ √ n+ + 1/ √ nu < (1 − π)/ √ n−, and so is the bound of ĝnu tighter than that of ĝpn if\n(1− π)/√n− + 1/ √ nu < π/ √ n+.\n• Asymptotic case: Either the limit of bounds of ĝpu or that of ĝnu (depending on π, n+ and n−) will improve on that of ĝpn, if n+, n− →∞ in the same order and nu →∞ faster in order than n+ and n−.\nNotice that both results rely on only the constant π and variables n+, n− and nu; they are simple and independent of the specific forms of the function class and/or the data distributions. The asymptotic case is from the finite-sample case that is based on theoretical comparisons of the aforementioned upper bounds on the estimation errors of ĝpn, ĝpu and ĝnu. To the best of our knowledge, this is the first work that compares PU learning against PN learning.\nThroughout the paper, we assume that the class-prior probability π is known. In practice, it can be effectively estimated from P, N and U data [20, 21, 22] or only P and U data [23, 24].\nOrganization The rest of this paper is organized as follows. Unbiased estimators are reviewed in Section 2. Then in Section 3 we present our theoretical comparisons based on risk bounds. Finally experiments are discussed in Section 4."
    }, {
      "heading" : "2 Unbiased estimators to the risk",
      "text" : "For convenience, denote by p+(x) = p(x | Y = +1) and p−(x) = p(x | Y = −1) partial marginal densities. Recall that instead of data sampled from p(x, y), we consider three sets of data X+, X− and Xu which are drawn from three marginal densities p+(x), p−(x) and p(x) independently.\nLet g : Rd → R be a real-valued decision function for binary classification and ` : R× {±1} → R be a Lipschitz-continuous loss function. Denote by\nR+(g) = E+[`(g(X),+1)], R−(g) = E−[`(g(X),−1)] partial risks, where E±[·] = EX∼p± [·]. Then the risk of g w.r.t. ` under p(x, y) is given by\nR(g) = E(X,Y )[`(g(X), Y )] = πR+(g) + (1− π)R−(g). (1) In PN learning, by approximating R(g) based on Eq. (1), we can get an empirical risk estimator as\nR̂pn(g) = π n+ ∑ xi∈X+ `(g(xi),+1) + 1−π n− ∑ xj∈X− `(g(xj),−1).\nFor any fixed g, R̂pn(g) is an unbiased and consistent estimator to R(g) and its convergence rate is of order Op(1/ √ n+ + 1/ √ n−) according to the central limit theorem [25], where Op denotes the order in probability.\nIn PU learning, X− is not available and then R−(g) cannot be directly estimated. However, [7] has shown that we can estimate R(g) without any bias if ` satisfies the following symmetric condition:\n`(t,+1) + `(t,−1) = 1. (2)\nSpecifically, let Ru,−(g) = EX [`(g(X),−1)] = πE+[`(g(X),−1)] + (1− π)R−(g) be a risk that U data are regarded as N data. Given Eq. (2), we have E+[`(g(X),−1)] = 1−R+(g), and hence\nR(g) = 2πR+(g) +Ru,−(g)− π. (3)\nBy approximating R(g) based on (3) using X+ and Xu, we can obtain R̂pu(g) = −π + 2πn+ ∑ xi∈X+ `(g(xi),+1) + 1 nu ∑ xj∈Xu `(g(xj),−1).\nAlthough R̂pu(g) regards Xu as N data and aims at separating X+ and Xu if being minimized, it is an unbiased and consistent estimator to R(g) with a convergence rate Op(1/ √ n+ + 1/ √ nu) [25].\nSimilarly, in NU learning R+(g) cannot be directly estimated. Let Ru,+(g) = EX [`(g(X),+1)] = πR+(g) + (1− π)E−[`(g(X),+1)]. Given Eq. (2), E−[`(g(X),+1)] = 1−R−(g), and\nR(g) = Ru,+(g) + 2(1− π)R−(g)− (1− π). (4)\nBy approximating R(g) based on (4) using Xu and X−, we can obtain R̂nu(g) = −(1− π) + 1nu ∑ xi∈Xu `(g(xi),+1) + 2(1−π) n− ∑ xj∈X− `(g(xj),−1).\nOn the loss function In order to train g by minimizing these estimators, it remains to specify the loss `. The zero-one loss `01(t, y) = (1− sign(ty))/2 satisfies (2) but is non-smooth. [7] proposed to use a scaled ramp loss as the surrogate loss for `01 in PU learning:\n`sr(t, y) = max{0,min{1, (1− ty)/2}},\ninstead of the popular hinge loss that does not satisfy (2). Let I(g) = E(X,Y )[`01(g(X), Y )] be the risk of g w.r.t. `01 under p(x, y). Then, `sr is neither an upper bound of `01 so that I(g) ≤ R(g) is not guaranteed, nor a convex loss so that it gets more difficult to know whether `sr is classificationcalibrated or not [19].1 If it is, we are able to control the excess risk w.r.t. `01 by that w.r.t. `. Here we prove the classification calibration of `sr, and consequently it is a safe surrogate loss for `01. Theorem 1. The scaled ramp loss `sr is classification-calibrated (see Appendix A for the proof)."
    }, {
      "heading" : "3 Theoretical comparisons based on risk bounds",
      "text" : "When learning is involved, suppose we are given a function class G, and let g∗ = arg ming∈G R(g) be the optimal decision function in G, ĝpn = arg ming∈G R̂pn(g), ĝpu = arg ming∈G R̂pu(g), and ĝnu = arg ming∈G R̂nu(g) be arbitrary global minimizers to three risk estimators. Furthermore, let R∗ = infg R(g) and I∗ = infg I(g) denote the Bayes risks w.r.t. ` and `01, where the infimum of g is over all measurable functions.\nIn this section, we derive and compare risk bounds of three risk minimizers ĝpn, ĝpu and ĝnu under the following mild assumption on G, p(x), p+(x) and p−(x): There is a constant CG > 0 such that\nRn,q(G) ≤ CG/ √ n (5)\nfor any marginal density q(x) ∈ {p(x), p+(x), p−(x)}, where Rn,q(G) = EX∼qnEσ [ supg∈G 1 n ∑ xi∈X σig(xi) ] is the Rademacher complexity of G for the sampling of size n from q(x) (that is, X = {x1, . . . , xn} and σ = {σ1, . . . , σn}, with each xi drawn from q(x) and each σi as a Rademacher variable) [18]. A special case is covered, namely, sets of hyperplanes with bounded normals and feature maps:\nG = {g(x) = 〈w, φ(x)〉H | ‖w‖H ≤ Cw, ‖φ(x)‖H ≤ Cφ}, (6)\nwhereH is a Hilbert space with an inner product 〈·, ·〉H, w ∈ H is a normal vector, φ : Rd → H is a feature map, and Cw > 0 and Cφ > 0 are constants [26].\n1A loss function ` is classification-calibrated if and only if there is a convex, invertible and nondecreasing transformation ψ` with ψ`(0) = 0, such that ψ`(I(g)− infg I(g)) ≤ R(g)− infg R(g) [19]."
    }, {
      "heading" : "3.1 Risk bounds",
      "text" : "Let L` be the Lipschitz constant of ` in its first parameter. To begin with, we establish the learning guarantee of ĝpu (the proof can be found in Appendix A). Theorem 2. Assume (2). For any δ > 0, with probability at least 1− δ,2\nR(ĝpu)−R(g∗) ≤ 8πL`Rn+,p+(G) + 4L`Rnu,p(G) + 2π √ 2 ln(4/δ) n+ + √ 2 ln(4/δ) nu , (7)\nwhere Rn+,p+(G) and Rnu,p(G) are the Rademacher complexities of G for the sampling of size n+ from p+(x) and the sampling of size nu from p(x). Moreover, if ` is a classification-calibrated loss, there exists nondecreasing ϕ with ϕ(0) = 0, such that with probability at least 1− δ,\nI(ĝpu)−I∗ ≤ ϕ ( R(g∗)−R∗+8πL`Rn+,p+(G)+4L`Rnu,p(G)+2π √ 2 ln(4/δ) n+ + √ 2 ln(4/δ) nu ) . (8)\nIn Theorem 2, R(ĝpu) and I(ĝpu) are w.r.t. p(x, y), though ĝpu is trained from two samples following p+(x) and p(x). We can see that (7) is an upper bound of the estimation error of ĝpu w.r.t. `, whose right-hand side (RHS) is small if G is small; (8) is an upper bound of the excess risk of ĝpu w.r.t. `01, whose RHS also involves the approximation error of G (i.e., R(g∗)−R∗) that is small if G is large. When G is fixed and satisfies (5), we have Rn+,p+(G) = O(1/ √ n+) and Rnu,p(G) = O(1/ √ nu), and then R(ĝpu)−R(g∗)→ 0, I(ĝpu)− I∗ → ϕ(R(g∗)−R∗) in Op(1/ √ n+ + 1/ √ nu). On the other hand, when the size of G grows with n+ and nu properly, those complexities of G vanish slower in order than O(1/√n+) and O(1/ √ nu) but we may have R(ĝpu)−R(g∗)→ 0, I(ĝpu)− I∗ → 0, which means ĝpu approaches the Bayes classifier if ` is a classification-calibrated loss, in an order slower than Op(1/ √ n+ + 1/ √ nu) due to the growth of G.\nSimilarly, we can derive the learning guarantees of ĝpn and ĝnu for comparisons. We will just focus on estimation error bounds, because excess risk bounds are their immediate corollaries. Theorem 3. Assume (2). For any δ > 0, with probability at least 1− δ,\nR(ĝpn)−R(g∗) ≤ 4πL`Rn+,p+(G) + 4(1− π)L`Rn−,p−(G) + π √ 2 ln(4/δ) n+ + (1− π) √ 2 ln(4/δ) n− , (9) where Rn−,p−(G) is the Rademacher complexity of G for the sampling of size n− from p−(x). Theorem 4. Assume (2). For any δ > 0, with probability at least 1− δ,\nR(ĝnu)−R(g∗) ≤ 4L`Rnu,p(G)+8(1−π)L`Rn−,p−(G)+ √ 2 ln(4/δ) nu +2(1−π) √ 2 ln(4/δ) n− . (10)\nIn order to compare the bounds, we simplify (9), (7) and (10) using Eq. (5). To this end, we define f(δ) = 4L`CG + √ 2 ln(4/δ). For the special case of G defined in (6), define f(δ) accordingly as\nf(δ) = 4L`CwCφ + √\n2 ln(4/δ). Corollary 5. The estimation error bounds below hold separately with probability at least 1− δ:\nR(ĝpn)−R(g∗) ≤ f(δ) · {π/ √ n+ + (1− π)/ √ n−}, (11) R(ĝpu)−R(g∗) ≤ f(δ) · {2π/ √ n+ + 1/ √ nu}, (12) R(ĝnu)−R(g∗) ≤ f(δ) · {1/ √ nu + 2(1− π)/ √ n−}. (13)"
    }, {
      "heading" : "3.2 Finite-sample comparisons",
      "text" : "Note that three risk minimizers ĝpn, ĝpu and ĝnu work in similar problem settings and their bounds in Corollary 5 are proven using exactly the same proof technique. Then, the differences in bounds reflect the intrinsic differences between risk minimizers. Let us compare those bounds. Define\nαpu,pn = ( π/ √ n+ + 1/ √ nu ) / ( (1− π)/√n− ) , (14)\nαnu,pn = ( (1− π)/√n− + 1/ √ nu ) / ( π/ √ n+ ) . (15)\nEqs. (14) and (15) constitute our first main result. 2Here, the probability is over repeated sampling of data for training ĝpu, while in Lemma 8, it will be for\nevaluating R̂pu(g).\nTheorem 6 (Finite-sample comparisons). Assume (5) is satisfied. Then the estimation error bound of ĝpu in (12) is tighter than that of ĝpn in (11) if and only if αpu,pn < 1; also, the estimation error bound of ĝnu in (13) is tighter than that of ĝpn if and only if αnu,pn < 1.\nProof. Fix π, n+, n− and nu, and then denote by Vpn, Vpu and Vnu the values of the RHSs of (11), (12) and (13). In fact, the definitions of αpu,pn and αnu,pn in (14) and (15) came from\nαpu,pn = Vpu − πf(δ)/\n√ n+\nVpn − πf(δ)/ √ n+\n, αnu,pn = Vnu − (1− π)f(δ)/\n√ n−\nVpn − (1− π)f(δ)/ √ n− .\nAs a consequence, compared with Vpn, Vpu is smaller and (12) is tighter if and only if αpu,pn < 1, and Vnu is smaller and (13) is tighter if and only if αnu,pn < 1.\nWe analyze some properties of αpu,pn before going to our second main result. The most important property is that it relies on π, n+, n− and nu only; it is independent of G, p(x, y), p(x), p+(x) and p−(x) as long as (5) is satisfied. Next, αpu,pn is obviously a monotonic function of π, n+, n− and nu. Furthermore, it is unbounded no matter if π is fixed or not. Properties of αnu,pn are similar, as summarized in Table 1.\nImplications of the monotonicity of αpu,pn are given as follows. Intuitively, when other factors are fixed, larger nu or n− improves ĝpu or ĝpn respectively. However, it is complicated why αpu,pn is monotonically decreasing with n+ and increasing with π. The weights of the empirical average of X+ is 2π in R̂pu(g) and π in R̂pn(g), as in R̂pu(g) it also joins the estimation of (1− π)R−(g). It makes X+ more important for R̂pu(g), and thus larger n+ improves ĝpu more than ĝpn. Moreover, (1− π)R−(g) is directly estimated in R̂pn(g) and the concentration Op((1− π)/ √ n−) is better if\nπ is larger, whereas it is indirectly estimated through Ru,−(g)− π(1−R+(g)) in R̂pu(g) and the concentration Op(π/ √ n+ + 1/ √ nu) is worse if π is larger. As a result, when the sample sizes are fixed ĝpu is more (or less) favorable as π decreases (or increases).\nA natural question is what the monotonicity of αpu,pn would be if we enforce n+, n− and nu to be proportional. To answer this question, we assume n+/n− = ρpn, n+/nu = ρpu and n−/nu = ρnu where ρpn, ρpu and ρnu are certain constants, then (14) and (15) can be rewritten as\nαpu,pn = (π + √ ρpu)/((1− π) √ ρpn), αnu,pn = (1− π + √ ρnu)/(π/ √ ρpn).\nAs shown in Table 1, αpu,pn is now increasing with ρpu and decreasing with ρpn. It is because, for instance, when ρpn is fixed and ρpu increases, nu is meant to decrease relatively to n+ and n−.\nFinally, the properties will dramatically change if we enforce ρpn = π/(1− π) that approximately holds in ordinary supervised learning. Under this constraint, we have\nαpu,pn = (π + √ ρpu)/ √ π(1− π) ≥ 2 √ ρpu + √ ρpu,\nwhere the equality is achieved at π̄ = √ρpu/(2 √ ρpu + 1). Here, αpu,pn decreases with π if π < π̄ and increases with π if π > π̄, though it is not convex in π. Only if nu is sufficiently larger than n+ (e.g., ρpu < 0.04), could αpu,pn < 1 be possible and ĝpu have a tighter estimation error bound."
    }, {
      "heading" : "3.3 Asymptotic comparisons",
      "text" : "In practice, we may find that ĝpu is worse than ĝpn and αpu,pn > 1 given X+, X− and Xu. This is probably the consequence especially when nu is not sufficiently larger than n+ and n−. Should we then try to collect much more U data or just give up PU learning? Moreover, if we are able to have as many U data as possible, is there any solution that would be provably better than PN learning?\nWe answer these questions by asymptotic comparisons. Notice that each pair of (n+, nu) yields a value of the RHS of (12), each (n+, n−) yields a value of the RHS of (11), and consequently each triple of (n+, n−, nu) determines a value of αpu,pn. Define the limits of αpu,pn and αnu,pn as\nα∗pu,pn = limn+,n−,nu→∞ αpu,pn, α ∗ nu,pn = limn+,n−,nu→∞ αnu,pn.\nRecall that n+, n− and nu are independent, and we need two conditions for the existence of α∗pu,pn and α∗nu,pn: n+ →∞ and n− →∞ in the same order and nu →∞ faster in order than them. It is a bit stricter than what is necessary, but is consistent with a practical assumption: P and N data are roughly equally expensive, whereas U data are much cheaper than P and N data. Intuitively, since αpu,pn and αnu,pn measure relative qualities of the estimation error bounds of ĝpu and ĝnu against that of ĝpn, α∗pu,pn and α ∗ nu,pn measure relative qualities of the limits of those bounds accordingly.\nIn order to illustrate properties of α∗pu,pn and α ∗ nu,pn, assume only nu approaches infinity while n+ and n− stay finite, so that α∗pu,pn = π √ n−/((1 − π) √ n+) and α∗nu,pn = (1 − π) √ n+/(π √ n−). Thus, α∗pu,pnα ∗ nu,pn = 1, which implies α ∗ pu,pn < 1 or α ∗ nu,pn < 1 unless n+/n− = π\n2/(1 − π)2. In principle, this exception should be exceptionally rare since n+/n− is a rational number whereas π2/(1− π)2 is a real number. This argument constitutes our second main result. Theorem 7 (Asymptotic comparisons). Assume (5) and one set of conditions below are satisfied:\n(a) n+ <∞, n− <∞ and nu →∞. In this case, let α∗ = (π √ n−)/((1− π) √ n+);\n(b) 0 < limn+,n−→∞ n+/n− <∞ and limn+,n−,nu→∞(n+ + n−)/nu = 0. In this case, let α∗ = π/((1− π) √ ρ∗pn) where ρ ∗ pn = limn+,n−→∞ n+/n−. Then, either the limit of estimation error bounds of ĝpu will improve on that of ĝpn (i.e., α∗pu,pn < 1) if α∗ < 1, or the limit of bounds of ĝnu will improve on that of ĝpn (i.e., α∗nu,pn < 1) if α\n∗ > 1. The only exception is n+/n− = π2/(1− π)2 in (a) or ρ∗pn = π2/(1− π)2 in (b). Proof. Note that α∗ = α∗pu,pn in both cases. The proof of case (a) has been given as an illustration of the properties of α∗pu,pn and α ∗ nu,pn. The proof of case (b) is analogous.\nAs a result, when we find that ĝpu is worse than ĝpn and αpu,pn > 1, we should look at α∗ defined in Theorem 7. If α∗ < 1, ĝpu is promising and we should collect more U data; if α∗ > 1 otherwise, we should give up ĝpu, but instead ĝnu is promising and we should collect more U data as well. In addition, the gap between α∗ and one indicates how many U data would be sufficient. If the gap is significant, slightly more U data may be enough; if the gap is slight, significantly more U data may be necessary. In practice, however, U data are cheaper but not free, and we cannot have as many U data as possible. Therefore, ĝpn is still of practical importance given limited budgets."
    }, {
      "heading" : "3.4 Remarks",
      "text" : "Theorem 2 relies on a fundamental lemma of the uniform deviation from the risk estimator R̂pu(g) to the risk R(g): Lemma 8. For any δ > 0, with probability at least 1− δ,\nsupg∈G |R̂pu(g)−R(g)| ≤ 4πL`Rn+,p+(G) + 2L`Rnu,p(G) + 2π √ ln(4/δ) 2n+ + √ ln(4/δ) 2nu .\nIn Lemma 8,R(g) is w.r.t. p(x, y), though R̂pu(g) is w.r.t. p+(x) and p(x). Rademacher complexities are also w.r.t. p+(x) and p(x), and they can be bounded easily for G defined in Eq. (6). Theorems 6 and 7 rely on (5). Thanks to it, we can simplify Theorems 2, 3 and 4. In fact, (5) holds for not only the special case of G defined in (6), but also the vast majority of discriminative models in machine learning that are nonlinear in parameters such as decision trees (cf. Theorem 17 in [16]) and feedforward neural networks (cf. Theorem 18 in [16]).\nTheorem 2 in [7] is a similar bound of the same order as our Lemma 8. That theorem is based on a tricky decomposition of the risk\nE(X,Y )[`(g(X), Y )] = πE+[˜̀(g(X),+1)] + E(X,Y )[˜̀(g(X), Y )],\nwhere the surrogate loss ˜̀(t, y) = (2/(y + 3))`(t, y) is not ` for risk minimization and labels of Xu are needed for risk evaluation, so that no further bound is implied. Lemma 8 uses the same ` as risk minimization and requires no label of Xu for evaluating R̂pu(g), so that it can serve as the stepping stone to our estimation error bound in Theorem 2."
    }, {
      "heading" : "4 Experiments",
      "text" : "In this section, we experimentally validate our theoretical findings.\nArtificial data Here, X+, X− and Xu are in R2 and drawn from three marginal densities\np+(x) = N(+12/ √ 2, I2), p−(x) = N(−12/ √\n2, I2), p(x) = πp+(x) + (1− π)p−(x), where N(µ,Σ) is the normal distribution with mean µ and covariance Σ, 12 and I2 are the all-one vector and identity matrix of size 2. The test set contains one million data drawn from p(x, y).\nThe model g(x) = 〈w, x〉+ b where w ∈ R2, b ∈ R and the scaled ramp loss `sr are employed. In addition, an `2-regularization is added with the regularization parameter fixed to 10−3, and there is no hard constraint on ‖w‖2 or ‖x‖2 as in Eq. (6). The solver for minimizing three regularized risk estimators comes from [7] (refer also to [27, 28] for the optimization technique).\nThe results are reported in Figure 1. In (a)(b), n+ = 45, n− = 5, π = 0.5, and nu varies from 5 to 200; in (c)(d), n+ = 45, n− = 5, nu = 100, and π varies from 0.05 to 0.95. Specifically, (a) shows αpu,pn and αnu,pn as functions of nu, and (c) shows them as functions of π. For the experimental results, ĝpn, ĝpu and ĝnu were trained based on 100 random samplings for every nu in (b) and π in (d), and means with standard errors of the misclassification rates are shown, as `sr is classificationcalibrated. Note that the empirical misclassification rates are essentially the risks w.r.t. `01 as there were one million test data, and the fluctuations are attributed to the non-convex nature of `sr. Also, the curve of ĝpn is not a flat line in (b), since its training data at every nu were exactly same as the training data of ĝpu and ĝnu for fair experimental comparisons.\nIn Figure 1, the theoretical and experimental results are highly consistent. The red and blue curves intersect at nearly the same positions in (a)(b) and in (c)(d), even though the risk minimizers in the experiments were locally optimal and regularized, making our estimation error bounds inexact.\nBenchmark data Table 2 summarizes the specification of benchmarks, which were downloaded from many sources including the IDA benchmark repository [29], the UCI machine learning repository, the semi-supervised learning book [30], and the European ESPRIT 5516 project.3 In Table 2, three rows describe the number of features, the number of data, and the ratio of P data according to the true class labels. Given a random sampling of X+, X− and Xu, the test set has all the remaining data if they are less than 104, or else drawn uniformly from the remaining data of size 104.\nFor benchmark data, the linear model for the artificial data is not enough, and its kernel version is employed. Consider training ĝpu for example. Given a random sampling, g(x) = 〈w, φ(x)〉+ b is used where w ∈ Rn++nu , b ∈ R and φ : Rd → Rn++nu is the empirical kernel map [26] based on X+ and Xu for the Gaussian kernel. The kernel width and the regularization parameter are selected by five-fold cross-validation for each risk minimizer and each random sampling.\n3See http://www.raetschlab.org/Members/raetsch/benchmark/ for IDA, http://archive.ics. uci.edu/ml/ for UCI, http://olivier.chapelle.cc/ssl-book/ for the SSL book and https://www. elen.ucl.ac.be/neural-nets/Research/Projects/ELENA/ for the ELENA project.\nThe results by varying nu and π are reported in Figures 2 and 3 respectively. Similarly to Figure 1, in Figure 2, n+ = 25, n− = 5, π = 0.5, and nu varies from 10 to 300, while in Figure 3, n+ = 25, n− = 5, nu = 200, and π varies from 0.05 to 0.95. Figures 2(a) and 2(k) depict αpu,pn and αnu,pn as functions of nu and π, and all the remaining subfigures depict means with standard errors of the misclassification rates based on 100 random samplings for every nu and π.\nThe theoretical and experimental results based on benchmarks are still highly consistent. However, unlike in Figure 1(b), in Figure 2 only the errors of ĝpu decrease with nu, and the errors of ĝnu just fluctuate randomly. This may be because benchmark data are more difficult than artificial data and hence n− = 5 is not sufficiently informative for ĝnu even when nu = 300. On the other hand, we can see that Figures 2(k) and 1(c) look alike, and so do all the remaining subfigures in Figure 3 and Figure 1(d). Nevertheless, three intersections in Figure 2(k) are closer than those in Figure 1(c), as nu = 200 in Figure 2(k) and nu = 100 in Figure 1(c). The three intersections will become a single one if nu =∞. By observing the experimental results, three curves in Figure 3 are also closer than those in Figure 1(d) when π ≥ 0.6, which demonstrates the validity of our theoretical findings."
    }, {
      "heading" : "5 Conclusions",
      "text" : "In this paper, we studied a fundamental problem in PU learning, namely, when PU learning is likely to outperform PN learning. Estimation error bounds of the risk minimizers were established in PN, PU and NU learning. We found that under the very mild assumption (5): The PU (or NU) bound is tighter than the PN bound, if αpu,pn in (14) (or αnu,pn in (15)) is smaller than one (cf. Theorem 6); either the limit of αpu,pn or that of αnu,pn will be smaller than one, if the size of U data increases faster in order than the sizes of P and N data (cf. Theorem 7). We validated our theoretical findings experimentally using one artificial data and nine benchmark data."
    }, {
      "heading" : "Acknowledgments",
      "text" : "GN was supported by the JST CREST program and Microsoft Research Asia. MCdP, YM, and MS were supported by the JST CREST program. TS was supported by JSPS KAKENHI 15J09111."
    }, {
      "heading" : "A Proofs",
      "text" : "In this appendix, we prove Theorem 1 in Section 2, and Lemma 8, Theorem 2, and Corollary 5 in Section 3. The proofs of Theorems 3 and 4 are omitted, since they are essentially similar to that of Theorem 2 relying on slightly different uniform deviation bounds.\nA.1 Proof of Theorem 1\nThe proof is straightforward. Denote by π+(x) = p(Y = +1 | X = x), π−(x) = p(Y = −1 | X = x),\nthen the conditional risk is EY [`sr(g(X), Y ) | X = x] = π+(x)`sr(g(x),+1) + π−(x)`sr(g(x),−1)\n=  π+(x), g(x) ≤ −1, 1/2− (π+(x)− π−(x))g(x)/2, −1 < g(x) < +1, π−(x), g(x) ≥ +1.\nThe minimum is achieved by g(x) = sign(π+(x)− π−(x)), which is actually the Bayes classifier. Therefore, `sr is classification-calibrated according to Theorem 1.3.c in [19].\nA.2 Proof of Lemma 8\nSimilarly to the decomposition in Eq. (3) such that R(g) = 2πR+(g) +Ru,−(g)− π,\nwe have seen in the definition of R̂pu(g) that it can also be decomposed into\nR̂pu(g) = 2πR̂+(g) + R̂u,−(g)− π, where\nR̂+(g) = 1 n+ ∑ xi∈X+ `(g(xi),+1), R̂u,−(g) = 1 nu ∑ xj∈Xu `(g(xj),−1)\nare the empirical averages corresponding to R+(g) and Ru,−(g). Due to the sub-additivity of the supremum operators, it holds that\nsupg∈G |R̂pu(g)−R(g)| ≤ 2π supg∈G |R̂+(g)−R+(g)|+ supg∈G |R̂u,−(g)−Ru,−(g)|. As a result, in order to prove Lemma 8, it suffices to show that with probability at least 1− δ/2, the uniform deviation bounds below hold separately:\nsupg∈G |R̂+(g)−R+(g)| ≤ 2L`Rn+,p+(G) + √ ln(4/δ) 2n+ , (16)\nsupg∈G |R̂u,−(g)−Ru,−(g)| ≤ 2L`Rnu,p(G) + √ ln(4/δ) 2nu . (17)\nIn the following we prove (16), and then (17) can be proven using the same proof technique.\nSince the surrogate loss ` is bounded by 0 and 1 according to (2), the change of R̂+(g) will be no more than 1/n+ if some xi in X+ is replaced with x′i. Thus McDiarmid’s inequality [31] implies\nPr [ |R̂+(g)−R+(g)| ≥ ] ≤ 2 exp ( − 2 2\nn+(1/n+)2 ) for any fixed g. Equivalently, for any fixed g, with probability at least 1− δ/2,\n|R̂+(g)−R+(g)| ≤ √\nln(4/δ) 2n+ .\nThen, according to the basic uniform deviation bound using the Rademacher complexity [18], with probability at least 1− δ/2,\nsupg∈G |R̂+(g)−R+(g)| ≤ 2Rn+,p+(` ◦ G) + √ ln(4/δ) 2n+ , (18)\nwhere Rn+,p+(` ◦ G) is the Rademacher complexity of the composite function class (` ◦ G) for the sampling of size n+ from p+(x) defined by\nRn+,p+(` ◦ G) = EX+∼pn++ Eσ [ supg∈G 1 n+ ∑ xi∈X+ σi`(g(xi),+1) ] .\nAs `(t, y) is L`-Lipschitz-continuous in t for every y, we have Rn+,p+(` ◦ G) ≤ L`Rn+,p+(G) by Talagrand’s contraction lemma [32], which proves (16).\nA.3 Proof of Theorem 2\nBased on Lemma 8, the estimation error bound (7) is proven through R(ĝpu)−R(g∗) = ( R̂pu(ĝpu)− R̂pu(g∗) ) + ( R(ĝpu)− R̂pu(ĝpu) ) + ( R̂pu(g ∗)−R(g∗) )\n≤ 0 + 2 supg∈G |R̂pu(g)−R(g)| ≤ 8πL`Rn+,p+(G) + 4L`Rnu,p(G) + 2π √ 2 ln(4/δ) n+ + √ 2 ln(4/δ) nu ,\nwhere we have used R̂pu(ĝpu) ≤ R̂pu(g∗) by the definition of ĝpu. Moreover, if ` is classification-calibrated, Theorem 1 in [19] implies that there will exist a convex, invertible and nondecreasing transformation ψ` with ψ`(0) = 0, such that\nψ`(I(ĝpu)− I∗) ≤ R(ĝpu)−R∗.\nHence, let ϕ = ψ−1` , we have\nI(ĝpu)− I∗ ≤ ϕ(R(ĝpu)−R∗) = ϕ(R(g∗)−R∗ +R(ĝpu)−R(g∗)),\nand subsequently the excess risk bound (8) is an immediate corollary of (7).\nA.4 Proof of Corollary 5\nGiven (5), the estimation error bound (7) can be rewritten into\nR(ĝpu)−R(g∗) ≤ 8πL`CG/ √ n+ + 2π √ 2 ln(4/δ) n+ + 4L`CG/ √ nu + √ 2 ln(4/δ) nu\n= 2πf(δ)/ √ n+ + f(δ)/ √ nu,\nwhere f(δ) = 4L`CG + √\n2 ln(4/δ). This proves (12). In exactly the same way, we could get (11) from (9) and (13) from (10).\nConsider the special case of G defined in (6). Recall that Rn,q(G) is the Rademacher complexity of G for X = {x1, . . . , xn} with each xi drawn from q(x). Given any such X , denote by R̂X (G) the empirical Rademacher complexity of G conditioned on X [18]:\nR̂X (G) = Eσ [ supg∈G 1 n ∑ xi∈X σig(xi) ] .\nIt is known that R̂X (G) ≤ CwCφ/ √ n and thus Rn,q(G) = EX [R̂X (G)] ≤ CwCφ/ √ n [18]. Then, letting CG = CwCφ completes the proof."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2016,
    "abstractText" : "In PU learning, a binary classifier is trained from positive (P) and unlabeled (U) data<lb>without negative (N) data. Although N data is missing, it sometimes outperforms<lb>PN learning (i.e., ordinary supervised learning). Hitherto, neither theoretical nor<lb>experimental analysis has been given to explain this phenomenon. In this paper,<lb>we theoretically compare PU (and NU) learning against PN learning based on the<lb>upper bounds on estimation errors. We find simple conditions when PU and NU<lb>learning are likely to outperform PN learning, and we prove that, in terms of the<lb>upper bounds, either PU or NU learning (depending on the class-prior probability<lb>and the sizes of P and N data) given infinite U data will improve on PN learning.<lb>Our theoretical findings well agree with the experimental results on artificial and<lb>benchmark data even when the experimental setup does not match the theoretical<lb>assumptions exactly.",
    "creator" : "LaTeX with hyperref package"
  }
}