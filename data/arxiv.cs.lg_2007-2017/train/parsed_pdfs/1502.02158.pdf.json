{
  "name" : "1502.02158.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Learning Parametric-Output HMMs with Two Aliased States",
    "authors" : [ "Roi Weiss", "Boaz Nadler" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "HMMs are a fundamental tool in the analysis of time series. A discrete time HMM with n hidden states is characterized by a n × n transition matrix, and by the emissions probabilities from these n states. In several applications, the HMMs, or more general processes such as partially observable Markov decision processes, are aliased, with some states having identical output distributions. In modeling of ion channel gating, for example, one postulates that at any given time an ion channel can be in only one of a finite number of hidden states, some of which are open and conducting current while others are closed, see e.g. Fredkin & Rice [1992]. Given electric current measurements, one fits an aliased HMM and infers important biological insight regarding the gating process. Other examples appear in the fields of reinforcement learning [Chrisman, 1992, McCallum, 1995, Brafman & Shani, 2004, Shani et al., 2005] and robot navigation [Jefferies & Yeap, 2008, Zatuchna & Bagnall, 2009]. In the latter case, aliasing occurs whenever different spatial locations appear (statistically) identical to the robot, given its limited sensing devices. As a last example, HMMs with several silent states that do not emit any output [Leggetter & Woodland, 1994, Stanke & Waack, 2003, Brejova et al., 2007], can also be viewed as aliased.\nar X\niv :1\n50 2.\n02 15\n8v 1\n[ cs\n.L G\n] 7\nKey notions related to the study of HMMs, be them aliased or not, are their minimality, identifiability and learnability:\nMinimality. Is there an HMM with fewer states that induces the same distribution over all output sequences?\nIdentifiability. Does the distribution over all output sequences uniquely determines the HMM’s parameters, up to a permutation of its hidden states?\nLearning. Given a long output sequence from a minimal and identifiable HMM, efficiently learn its parameters.\nFor non-aliased HMMs, these notions have been intensively studied and by now are relatively well understood, see for example Petrie [1969], Finesso [1990], Leroux [1992], Allman et al. [2009] and Cappé et al. [2005]. The most common approach to learn the parameters of an HMM is via the Baum-Welch iterative algorithm [Baum et al., 1970]. Recently, tensor decompositions and other computationally efficient spectral methods have been developed to learn non-aliased HMMs [Hsu et al., 2009, Siddiqi et al., 2010, Anandkumar et al., 2012, Kontorovich et al., 2013].\nIn contrast, the minimality, identifiability and learnability of aliased HMMs have been long standing problems, with only partial solutions provided thus far. For example, Blackwell & Koopmans [1957] characterized the identifiability of a specific aliased HMM with 4 states. The identifiability of deterministic output HMMs, where each hidden state outputs a deterministic symbol, was partially resolved by Ito et al. [1992]. To the best of our knowledge, precise characterizations of the minimality, identifiability and learnability of probabilistic output HMMs with aliased states are still open problems. In particular, the recently developed tensor and spectral methods mentioned above, explicitly require the HMM to be non-aliasing, and are not directly applicable to learning aliased HMMs.\nMain results. In this paper we study the minimality, identifiability and learnability of parametric-output HMMs that have exactly two aliased states. This is the simplest possible class of aliased HMMs, and as shown below, even its analysis is far from trivial. Our main contributions are as follows: First, we provide a complete characterization of their minimality and identifiability, deriving necessary and sufficient conditions for each of these notions to hold. Our identifiability conditions are easy to check for any given 2-aliased HMM, and extend those of Ito et al. [1992] for the case of deterministic outputs. Second, we solve the problem of learning a possibly aliased HMM, from a long sequence of its outputs. To this end, we first derive an algorithm to detect whether an observed output sequence corresponds to a non-aliased HMM or to an aliased one. In the former case, the HMM can be learned by various methods, such as Anandkumar et al. [2012], Kontorovich et al. [2013]. In the latter case we show how the aliased states can be identified and present a method to recover the HMM parameters. Our approach is applicable to any family of output distributions whose mixtures are efficiently learnable. Examples include high dimensional Gaussians and products distributions, see Feldman et al. [2008], Belkin & Sinha [2010], Anandkumar et al. [2012] and references\ntherein. After learning the output mixture parameters, our moment-based algorithm requires only a single pass over the data. It is possibly the first statistically consistent and computationally efficient scheme to handle 2-aliased HMMs. While our approach may be extended to more complicated aliasing, such cases are beyond the scope of this paper. We conclude with some simulations illustrating the performance of our suggested algorithms."
    }, {
      "heading" : "2 Definitions & Problem Setup",
      "text" : "Notation. We denote by In the n×n identity matrix and 1n = (1, . . . , 1)T ∈ Rn. For v ∈ Rn, diag(v) is the n× n diagonal matrix with entries vi on its diagonal. The i-th row and column of a matrix A ∈ Rn×n are denoted by A[i,·] and A[·,i], respectively. We also denote [n] = {1, 2, . . . , n}. For a discrete random variable X we abbreviate P (x) for Pr(X = x). For a second random variable Z, the quantity P (z |x) denotes either Pr(Z = z |X = x), or the conditional density p(Z = z|X = x), depending on whether Z is discrete or continuous.\nHidden Markov Models. Consider a discrete-time HMM with n hidden states {1, . . . , n}, whose output alphabet Y is either discrete or continuous. Let Fθ = {fθ : Y → R | θ ∈ Θ} be a family of parametric probability density functions where Θ is a suitable parameter space. A parametric-output HMM is defined by a tupleH = (A,θ,π0) where A is the n× n transition matrix of the hidden states\nAij = Pr(Xt+1 = i |Xt = j) = P (i | j),\nπ0 ∈ Rn is the distribution of the initial state, and the vector of parameters θ = (θ1, θ2, . . . , θn) ∈ Θn determines the n probability density functions (fθ1 , fθ2 , . . . , fθn).\nThe output sequence of the HMM is generated as follows. First, an unobserved Markov sequence of hidden states x = (xt)T−1t=0 is generated according to the distribution\nP (x) = π0x0 T−1∏ t=1 P (xt |xt−1).\nThe output yt ∈ Y at time t depends only on the hidden state xt via P (yt |xt) ≡ fθxt (yt). Hence the conditional distribution of an output sequence y = (yt) T−1 t=0 is\nP (y |x) = T−1∏ t=0 P (yt |xt) = T−1∏ t=0 fθxt (yt).\nWe denote by PH,k : Yk → R the joint distribution of the first k consecutive outputs of the HMM H . For y = (y0, . . . , yk−1) ∈ Yk this distribution is given by\nPH,k(y) = ∑ x∈[n]k P (y |x)P (x).\nFurther we denote by PH = {PH,k | k ≥ 1} the set of all these distributions.\n2-Aliased HMMs. For an HMM H with output parameters θ = (θ1, θ2, . . . , θn) ∈ Θn we say that states i and j are aliased if θi = θj . In this paper we consider the special case where H has exactly two aliased states, denoted as 2A-HMM. Without loss of generality, we assume the aliased states are the two last ones, n−1 and n. Thus,\nθ1 6= θ2 6= · · · 6= θn−2 6= θn−1 and θn−1 = θn.\nWe denote the vector of the n−1 unique output parameters ofH by θ̄ = (θ1, θ2, . . . , θn−2, θn−1) ∈ Θn−1. For future use, we define the aliased kernel K̄ ∈ R(n−1)×(n−1) as the matrix of inner products between the n−1 different fθi ’s,\nK̄ij ≡ 〈fθi , fθj 〉 = ∫ Y fθi(y)fθj (y)dy, i, j ∈ [n−1]. (1)\nAssumptions. As in previous works [Leroux, 1992, Kontorovich et al., 2013], we make the following standard assumptions:\n(A1) The parametric family Fθ of the output distributions is linearly independent of order n: for any distinct {θi}ni=1, ∑n i=1 aifθi ≡ 0 iff ai = 0 for all i ∈ [n].\n(A2) The transition matrix A is ergodic and its unique stationary distribution π = (π1, π2, . . . , πn) is positive.\nNote that assumption (A1) implies that the parametric familyFθ is identifiable, namely fθ = fθ′ iff θ = θ′. It also implies that the kernel matrix K̄ of (1) is full rank n−1."
    }, {
      "heading" : "3 Decomposing the transition matrix A",
      "text" : "The main tool in our analysis is a novel decomposition of the 2A-HMM’s transition matrix into its non-aliased and aliased parts. As shown in Lemma 1 below, the aliased part consists of three rank-one matrices, that correspond to the dynamics of exit from, entrance to, and within the two aliased states. This decomposition is used to derive the conditions for minimality and identifiability (Section 4), and plays a key role in learning the HMM (Section 5).\nTo this end, we introduce a pseudo-state n̄, combining the two aliased states n−1 and n. We define\nπn̄ = πn−1 + πn and β = πn−1/πn̄. (2)\nWe shall make extensive use of the following two matrices:\nB =  0 0 In−2 ... ... 0 0\n0 . . . 0 1 1\n ∈ R(n−1)×n,\nCβ =  0 In−2 ... 0\n0 . . . 0 β 0 . . . 0 1−β  ∈ Rn×(n−1). As explained below, these matrices can be viewed as projection and lifting operators, mapping between non-aliased and aliased quantities.\nNon-aliased part. The non-aliased part ofA is a stochastic matrix Ā ∈ R(n−1)×(n−1), obtained by merging the two aliased states n−1 and n into the pseudo-state n̄. Its entries are given by\nĀ=  P (1 | n̄) A[1:n−2]×[1:n−2] ... P (n−2 | n̄)\nP (n̄ | 1) . . . P (n̄ |n−2) P (n̄ | n̄)  , (3) where the transition probabilities into the pseudo-state are\nP (n̄ | j) = P (n−1 | j) + P (n | j), ∀j ∈ [n],\nthe transition probabilities out of the pseudo-state are defined with respect to the stationary distribution by\nP (i | n̄) = βP (i |n−1) + (1−β)P (i |n), ∀i ∈ [n]\nand lastly, the probability to stay in the pseudo-state is\nP (n̄ | n̄) = βP (n̄ |n−1) + (1−β)P (n̄ |n).\nIt is easy to check that the unique stationary distribution of Ā is π̄ = (π1, π2, . . . , πn−2, πn̄) ∈ Rn−1. Finally, note that Ā = BACβ , π̄ = Bπ and π = Cβπ̄, justifying the lifting and projection interpretation of the matrices B,Cβ .\nAliased part. Next we present some key quantities that distinguish between the two aliased states. Let suppin = {j ∈ [n] |P (n̄ | j) > 0} be the set of states that can move into either one of the aliased states. We define\nαj =\n{ P (n−1 | j) P (n̄ | j) j ∈ suppin\n0 otherwise, (4)\nas the relative probability of moving from state j to state n−1, conditional on moving to either n−1 or n. We define the two vectors δout, δin ∈ Rn−1 as follows: ∀i, j ∈ [n−1],\nδouti = { P (i |n−1)− P (i |n) i < n− 1 P (n̄ |n−1)− P (n̄ |n) i = n− 1\n(5)\nδinj =  (αj−β)P (n̄ | j) j < n−1\nβ(αn−1−β)P (n̄ |n−1) + (1−β)(αn−β)P (n̄ |n) j = n−1.\n(6)\nIn other words, δout captures the differences in the transition probabilities out of the aliased states. In particular, if δout = 0 then starting from either one of the two aliased states, the Markov chain evolution is identical. Intuitively such an HMM is not minimal, as its two aliased states can be lumped together, see Theorem 1 below.\nSimilarly, δin compares the relative probabilities into the aliased states αj , to the stationary relative probability β = πn−1/πn̄. This quantity also plays a role in the minimality of the HMM.\nLastly, for our decomposition, we define the scalar\nκ = (αn−1 − β)P (n̄ |n−1)− (αn − β)P (n̄ |n). (7)\nDecomposing A. The following lemma provides a decomposition of the transition matrix in terms of Ā, δout, δin, κ and β (all omitted proofs are given in the Appendix).\nLemma 1. The transition matrix A of a 2A-HMM can be written as\nA = CβĀB + Cβδ outcTβ + b(δ in)TB + κ bcTβ , (8)\nwhere cβT = (0, . . . , 0, 1−β,−β) ∈ Rn and b = (0, . . . , 0, 1,−1)T ∈ Rn.\nIn (8), the first term is the merged transition matrix Ā ∈ R(n−1)×(n−1) lifted back into Rn×n. This term captures all of the non-aliased transitions. The second matrix is zero except in the last two columns, accounting for the exit transition probabilities from the two aliased states. Similarly, the third matrix is zero except in the last two rows, differentiating the entry probabilities. The fourth term is non-zero only on the lower right 2 × 2 block involving the aliased states n−1, n. This term corresponds to the internal dynamics between them. Note that each of the last three terms is at most a rank-1 matrix, which together can be seen as a perturbation due to the presence of aliasing.\nIn section 5 we shall see that given a long output sequence from the HMM, the presence of aliasing can be detected and the quantities Ā, δout, δin, κ and β can all be estimated from it. An estimate for A is then obtained via Eq. (8)."
    }, {
      "heading" : "4 Minimality and Identifiability",
      "text" : "Two HMMs H and H ′ are said to be equivalent if their observed output sequences are statistically indistinguishable, namely PH′ = PH . Similarly, an HMM H is minimal if\nthere is no equivalent HMM with fewer number of states. Note that if H is non-aliased then Assumptions (A1-A2) readily imply that it is also minimal [Leroux, 1992]. In this section we present necessary and sufficient conditions for a 2A-HMM to be minimal, and for two minimal 2A-HMMs to be equivalent. Finally, we derive necessary and sufficient conditions for a minimal 2A-HMM to be identifiable."
    }, {
      "heading" : "4.1 Minimality",
      "text" : "The minimality of an HMM is closely related to the notion of lumpability: can hidden states be merged without affecting the distribution PH [Fredkin & Rice, 1986, White et al., 2000, Huang et al., 2014]. Obviously, an HMM is minimal iff no subset of hidden states can be merged. In the following theorem we give precise conditions for the minimality of a 2A-HMM.\nTheorem 1. Let H be a 2A-HMM satisfying Assumptions (A1-A2) whose initial state X0 is distributed according to π0 = (π01 , π 0 2 , . . . , β 0π0n̄, (1−β0)π0n̄). Then,\n(i) If π0n̄ 6= 0 and β0 6= β then H is minimal iff δ out 6= 0.\n(ii) If π0n̄ = 0 or β 0 = β then H is minimal iff both δout 6= 0 and δin 6= 0.\nBy Theorem 1, a necessary condition for minimality of a 2A-HMM is that the two aliased states have different exit probabilities, δout 6= 0. Namely, there exists a nonaliased state i ∈ [n−2] such that P (i |n−1) 6= P (i |n). Otherwise the two aliased states can be merged. If the 2A-HMM is started from its stationary distribution, then an additional necessary condition is δin 6= 0. This last condition implies that there is a non-aliased state j ∈ suppin \\{n−1, n} with relative entrance probability αj 6= β."
    }, {
      "heading" : "4.2 Identifiability",
      "text" : "Recall that an HMMH is (strictly) identifiable ifPH uniquely determines the transition matrix A and the output parameters θ, up to a permutation of the hidden states. We establish the conditions for identifiability of a 2A-HMM in two steps. First we derive a novel geometric characterization of the set of all minimal HMMs that are equivalent to H , up to a permutation of the hidden states (Theorem 2). Then we give necessary and sufficient conditions for H to be identifiable, namely for this set to be the singleton set, consisting of onlyH itself (Appendix C). In the process, we provide a simple procedure (Algorithm 1) to determine whether a given minimal 2A-HMM is identifiable or not.\nEquivalence between minimal 2A-HMMs. Necessary and sufficient conditions for the equivalence of two minimal HMMs were studied in several works [Finesso, 1990, Ito et al., 1992, Vanluyten et al., 2008]. We now provide analogous conditions for parametric output 2A-HMMs. Toward this end, we define the following 2-dimensional\nfamily of matrices S(τn−1, τn) ∈ Rn×n given by\nS(τn−1, τn) =  0 0 In−2 ... ... 0 0\n0 . . . 0 τn−1 τn 0 . . . 0 1−τn−1 1−τn\n .\nClearly, for τn−1 6= τn, S is invertible. As in Ito et al. [1992], consider then the following similarity transformation of the transition matrix A,\nAH(τn−1, τn) = S(τn−1, τn) −1AS(τn−1, τn). (9)\nIt is easy to verify that 1TnAH = 1 T n. However, AH is not necessarily stochastic, as depending on τn−1, τn it may have negative entries. The following lemma resolves the equivalence of 2A-HMMs, in terms of this transformation.\nLemma 2. LetH = (A,θ,π) be a minimal 2A-HMM satisfying Assumptions (A1-A2). Then a minimal HMM H ′ = (A′,θ′,π′) with n′ states is equivalent to H iff n′ = n and there exists a permutation matrix Π ∈ Rn×n and τn−1 > τn such that θ′ = Πθ and\nπ′ = ΠS(τn−1, τn) −1π A′ = ΠAH(τn−1, τn) Π −1 ≥ 0.\nThe feasible region. By Lemma 2, any matrix AH(τn−1, τn) whose entries are all non-negative yields an HMM equivalent to the original one. We thus define the feasible region of H by\nΓH = {(τn−1, τn) ∈ R2 |AH(τn−1, τn) ≥ 0, τn−1>τn}. (10)\nBy definition, ΓH is non-empty, since (τn−1, τn) = (1, 0) recover the original matrixA. As we show below, ΓH is determined by three simpler regions Γ1,Γ2,Γ3 ⊂ R2. The region Γ1 ensures that all entries of AH are non-negative except possibly in the lower right 2× 2 block corresponding to the two aliased states. The regions Γ2 and Γ3 ensure non-negativity of the latter, depending on whether the aliased relative probabilities of (4) satisfy αn−1 ≥ αn or αn−1 < αn, respectively. For ease of exposition we assume as a convention that P (n̄ |n−1) ≥ P (n̄ |n).\nTheorem 2. Let H be a minimal 2A-HMM satisfying Assumptions (A1-A2). There exist (τminn−1 , τ min n ), (τ max n−1 , τ max n ), (τ\n−, τ+) ∈ R2, and convex monotonic decreasing functions f, g : R→ R such that\nΓH = { Γ1 ∩ Γ2 αn−1 ≥ αn Γ1 ∩ Γ3 αn−1 < αn,\nwhere the regions Γ1,Γ2,Γ3 ⊂ R2 are given by\nΓ1 = [τ min n−1 , τ max n−1 ]× [τmaxn , τminn ]\nΓ2 = [τ +,∞)× [τ−, τ+]\nΓ3 = {(τn−1, τn) ∈ Γ1 | f(τn−1) ≤ τn ≤ g(τn−1) }."
    }, {
      "heading" : "In addition, the set ΓH is connected.",
      "text" : "The feasible regions in the two possible cases (αn−1 ≥ αn or αn−1 < αn) are depicted in Appendix C, Fig.6.\nStrict Identifiability. By Lemma 2, for strict identifiability of H , ΓH should be the singleton set ΓH = {(1, 0)}. Due to lack of space, sufficient and necessary conditions for this to hold, as well as a corresponding simple procedure to determine whether a 2A-HMM is identifiable, are given in Appendix C.2.\nRemark. While beyond the scope of this paper, we note that instead of strict identifiability of a given HMM, several works studied a different concept of generic identifiability [Allman et al., 2009], proving that under mild conditions the class of HMMs is generically identifiable. In contrast, if we restrict ourselves to the class of 2A-HMMs, then our Theorem 2 implies that this class is generically non-identifiable. The reason is that by Theorem 2, for any 2A-HMM whose matrix A has all its entries positive, there are an infinite number of equivalent 2A-HMMs, implying non-identifiability."
    }, {
      "heading" : "5 Learning a 2A-HMM",
      "text" : "Let (Yt)T−1t=0 be an output sequence generated by a parametric-output HMM that satisfies Assumptions (A1-A2) and initialized with its stationary distribution, X0 ∼ π. We assume the HMM is either non-aliasing, with n−1 states, or 2-aliasing with n states. We further assume that the HMM is minimal and identifiable, as otherwise its parameters cannot be uniquely determined.\nIn this section we study the problems of detecting whether the HMM is aliasing and recovering its output parameters θ and transition matrix A, all in terms of (Yt)T−1t=0 .\nHigh level description. The proposed learning procedure consists of the following steps (see Fig.1):\n(i) Determine the number of output components n−1 and estimate the n−1 unique output distribution parameters θ̄ and the projected stationary distribution π̄.\n(ii) Detect if the HMM is 2-aliasing.\n(iii) In case of a non-aliased HMM, estimate the (n−1) × (n−1) transition matrix Ā, as for example in Kontorovich et al. [2013] or Anandkumar et al. [2012].\n(iv) In case of a 2-aliased HMM, identify the component θn−1 corresponding to the two aliased states, and estimate the n× n transition matrix A.\nWe now describe in detail each of these steps. As far as we know, our learning procedure is the first to consistently learn a 2A-HMM in a computationally efficient way. In particular, the solutions for problems (ii) and (iv) are new.\nEstimating the output distribution parameters. As the HMM is stationary, each observable Yt is a random realization from the following parametric mixture model,\nY ∼ n−1∑ i=1 π̄ifθ̄i(y). (11)\nHence, the number of unique output components n − 1, the corresponding output parameters θ̄ and the projected stationary distribution π̄ can be estimated by fitting a mixture model (11) to the observed output sequence (Yt)T−1t=0 .\nConsistent methods to determine the number of components in a mixture are well known in the literature [Titterington et al., 1985]. The estimation of θ̄ and π̄ is typically done by either applying an EM algorithm, or any recently developed spectral method [Dasgupta, 1999, Achlioptas & McSherry, 2005, Anandkumar et al., 2012]. As our focus is on the aliasing aspects of the HMM, in what follows we assume that the number of unique output components n−1, the output parameters θ̄ and the projected stationary distribution π̄ are exactly known. As in Kontorovich et al. [2013], it is possible to show that our method is robust to small perturbations in these quantities (not presented)."
    }, {
      "heading" : "5.1 Moments",
      "text" : "To solve problems (ii), (iii) and (iv) above, we first introduce the moment-based quantities we shall make use of. Given θ̄ and π̄ or estimates of them, for any i, j ∈ [n−1], we define the second order moments with time lag t by\nM(t)ij = E[fθi(Y0)fθj (Yt)], t ∈ {1, 2, 3}. (12)\nThe consecutive in time third order moments are defined by\nG(c)ij = E[fθi(Y0)fθc(Y1)fθj (Y2)], ∀c ∈ [n−1]. (13)\nWe also define the lifted kernel, K = BTK̄B ∈ Rn×n. One can easily verify that for a 2A-HMM,\nM(t) = K̄BAtCβ diag(π̄)K̄ (14) G(c) = K̄BAdiag(K[·,c])ACβ diag(π̄)K̄. (15)\nNext we define the kernel free moments M (t), G(c) ∈ R(n−1)×(n−1) as follows:\nM (t) = K̄−1M(t)K̄−1 diag(π̄)−1 (16) G(c) = K̄−1G(c)K̄−1 diag(π̄)−1. (17)\nNote that by Assumption (A1), the kernel K̄ is full rank and thus K̄−1 exists. Similarly, by (A2) π̄ > 0, so diag(π̄)−1 also exists. Thus, (16,17) are well defined.\nLet R(2), R(3), F (c) ∈ R(n−1)×(n−1) be given by\nR(2) = M (2) − (M (1))2 (18) R(3) = M (3)−M (2)M (1)−M (1)M (2) + (M (1))3 (19) F (c) = G(c) −M (1) diag(K̄[·,c])M (1). (20)\nThe following key lemma relates the moments (18, 19, 20) to the decomposition (8) of the transition matrix A.\nLemma 3. Let H be a minimal 2A-HMM with aliased states n−1 and n. Let Ā, δout, δin and κ be defined in (3,5,6,7) respectively. Then the following relations hold:\nM (1) = Ā (21) R(2) = δout(δin)T (22) R(3) = κR(2) (23) F (c) = K̄n−1,cR (2), ∀c ∈ [n−1]. (24)\nIn the following, these relations will be used to detect aliasing, identify the aliased states and recover the aliased transition matrix A.\nEmpirical moments. In practice, the unknown moments (12,13) are estimated from the output sequence (Yt)T−1t=0 by\nM̂(t)ij = 1\nT − t T−t−1∑ l=0 fθi(Yl)fθj (Yl+t),\nĜ(c)ij = 1\nT − 2 T−3∑ l=0 fθi(Yl)fθc(Yl+1)fθj (Yl+2).\nWith K̄, π̄ known, the corresponding empirical kernel free moments are given by\nM̂ (t) = K̄−1M̂(t)K̄−1 diag(π̄)−1 (25) Ĝ(c) = K̄−1Ĝ(c)K̄−1 diag(π̄)−1. (26)\nThe empirical estimates for (18,19,20) similarly follow. To analyze the error between the empirical and population quantities, we make the following additional assumption: (A3) The output distributions are bounded. Namely there exists L > 0 such that ∀i ∈ [n] and ∀y ∈ Y , fθi(y) ≤ L.\nLemma 4. Let (Yt)T−1t=0 be an output sequence generated by an HMM satisfying Assumptions (A1-A3). Then, as T → ∞, for any t ∈ {1, 2, 3} and c ∈ [n−1], all error terms M̂ (t) −M (t), R̂(t) −R(t) and F̂ (c) − F (c) are OP (T− 1 2 ).\nIn fact, due to strong mixing, all of the above quantities are asymptotically normally distributed [Bradley, 2005]."
    }, {
      "heading" : "5.2 Detection of aliasing",
      "text" : "We now proceed to detect if the HMM is aliased (step (ii) in Fig.1). We pose this as a hypothesis testing problem:\nH0 : H is non-aliased with n−1 states vs. H1 : H is 2-aliased with n states.\nWe begin with the following simple observation:\nLemma 5. LetH be a minimal non-aliased HMM with n−1 states, satisfying Assumptions (A1-A3). Then R(2) = 0.\nIn contrast, if H is 2-aliasing then according to (22) we have R(2) = δout(δin)T. In addition, since the HMM is assumed to be minimal and started from the stationary distribution, Theorem 1 implies that both δout 6= 0 and δin 6= 0. Thus R(2) is exactly a rank-1 matrix, which we write as\nR(2) = σuvT with ‖u‖2 = ‖v‖2 = 1, σ > 0, (27)\nwhere σ is the unique non-zero singular value of R(2). Hence, our hypothesis testing problem takes the form:\nH0 : R(2) = 0 vs. H1 : R(2) = σuvT with σ > 0.\nIn practice, we only have the empirical estimate R̂(2). Even if σ = 0, this matrix is typically full rank with n−1 non-zero singular values. Our problem is thus detecting the rank of a matrix from a noisy version of it. There are multiple methods to do so. In this paper, motivated by Kritchman & Nadler [2009], we adopt the largest singular value σ̂1 of R̂(2) as our test statistic. The resulting test is\nif σ̂1 ≥ hT returnH1, otherwise returnH0, (28)\nwhere hT is a predefined threshold. By Lemma 4, as T → ∞ the singular values of R̂(2) converge to those of R(2). Thus, as the following lemma shows, with a suitable threshold this test is asymptotically consistent.\nLemma 6. Let H be a minimal HMM satisfying Assumptions (A1-A3) which is either non-aliased or 2-aliased. Then for any 0< < 12 , the test (28) with hT = Ω(T\n− 12 + ) is consistent: as T →∞, with probability one, it will correctly detect whether the HMM is non-aliased or 2-aliased.\nEstimating the non-aliased transition matrix Ā. If the HMM was detected as nonaliasing, then its (n−1)× (n−1) transition matrix Ā can be estimated for example by the spectral methods given in Kontorovich et al. [2013] or Anandkumar et al. [2012]. It is shown there, that these methods are (strongly) consistent. Moreover, as T →∞,\nˆ̄A = Ā+OP (T − 12 ). (29)"
    }, {
      "heading" : "5.3 Identifying the aliased component θn−1",
      "text" : "Assuming the HMM was detected as 2-aliasing, our next task, step (iv), is to identify the aliased component. Recall that if the aliased component is θn−1, then by (24)\nF (c) = K̄n−1,cR (2), ∀c ∈ [n−1].\nWe thus estimate the index i ∈ [n−1] of the aliased component by solving the following least squares problem:\nî = argmin i∈[n−1] ∑ c∈[n−1] ∥∥∥F̂ (c) − K̄i,cR̂(2)∥∥∥2 F . (30)\nThe following result shows this method is consistent.\nLemma 7. For a minimal 2A-HMM satisfying Assumptions (A1-A3) with aliased states n−1 and n,\nlim T→∞\nPr(̂i 6= n−1) = 0."
    }, {
      "heading" : "5.4 Learning the aliased transition matrix A",
      "text" : "Given the aliased component, we estimate the n × n transition matrix A using the decomposition (8). First, recall that by (22), R(2) = δout(δin)T = σuvT. As singular vectors are determined only up to scaling, we have that\nδout = γu and δin = σ\nγ v,\nwhere γ ∈ R is a yet undetermined constant. Thus, the decomposition (8) of A takes the form:\nA = CβĀB + γCβuc T β +\nσ γ bvTB + κ bcTβ . (31)\nGiven that Ā, σ,u and v are known from previous steps, we are left to determine the scalars γ, β and κ of Eq. (7).\nAs for κ, according to (23) we have R(3) = κR(2). Thus, plugging the empirical versions, κ̂ is estimated by\nκ̂ = argmin r∈R ∥∥∥R̂(3) − rR̂(2)∥∥∥2 F . (32)\nTo determine γ and β we turn to the similarity transformation AH(τn−1, τn), given in (9). As shown in Section 3, this transformation characterizes all transition matrices equivalent to A. To relate AH to the form of the decomposition (31), we reparametrize τn−1 and τn as follows:\nγ′ = γ(τn−1 − τn), β′ = β − τn τn−1 − τn .\nReplacing τn−1, τn with γ′, β′ we find that AH is given by\nAH = Cβ′ĀB + γ ′Cβ′uc T β′ +\nσ γ′ bvTB + κ bcTβ′ . (33)\nNote that putting γ′ = γ and β′ = β recovers the decomposition (31) for the original transition matrix A.\nNow, since H is assumed identifiable, the constraint AH(τn−1, τn) ≥ 0 has the unique solution (τn−1, τn) = (1, 0), or equivalently (γ′, β′) = (γ, β). Thus, with exact knowledge of the various moments, only a single pair of values (γ′, β′) will yield a non-negative matrix (33). This perfectly recovers γ, β and the original transition matrix A.\nIn practice we plug into (33) the empirical versions ˆ̄A, κ̂, σ̂1, û1 and v̂1, where û1, v̂1 are the left and right singular vectors of R̂(2), corresponding to the singular value σ̂1. As described in Appendix D.5, the values (γ̂, β̂) are found by maximizing a simple two dimensional smooth function. The resulting estimate for the aliased transition matrix is\nÂ = Cβ̂ ˆ̄AB + γ̂Cβ̂û1c T β̂ + σ̂1 γ̂ bv̂T1B + κ̂ bc T β̂ .\nThe following theorem proves our method is consistent.\nTheorem 3. Let H be a 2A-HMM satisfying assumption (A1-A3) with aliased states n−1 and n. Then as T →∞,\nÂ = A+ oP (1)."
    }, {
      "heading" : "6 Numerical simulations",
      "text" : "We present simulation results, illustrating the consistency of our methods for the detection of aliasing, identifying the aliased component and learning the transition matrix\nA. As our focus is on the aliasing, we assume for simplicity that the output parameters θ̄ and the projected stationary distributions π̄ are exactly known.\nMotivated by applications in modeling of ion channel gating [Crouzy & Sigworth, 1990, Rosales et al., 2001, Witkoskie & Cao, 2004], we consider the following HMM H with n = 4 hidden states (see Fig.2, left). The output distributions are univariate Gaussians N (µi, σ2i ) . Its matrix A and (fθi)4i=1 are given by\nA =  0.3 0.25 0.0 0.8 0.6 0.25 0.2 0.0 0.0 0.5 0.1 0.1 0.1 0.0 0.7 0.1  , fθ1 = N (3, 1) fθ2 = N (6, 1) fθ3 = N (0, 1) fθ4 = N (0, 1).\nStates 3 and 4 are aliased and by Procedure 1 in Appendix C.3 this 2A-HMM is identifiable. The rank-1 matrix R(2) has a singular value σ = 0.33. Fig.2 (right) shows its non-aliased version H̄ with states 3 and 4 merged.\nTo illustrate the ability of our algorithm to detect aliasing, we generated T outputs from the original aliased HMM and from its non-aliased version H̄ . Fig.3 (left) shows the empirical densities (averaged over 1000 independent runs) of the largest singular value of R̂(2), for both H and H̄ . In Fig.3 (right) we show similar results for a 2A-HMM with σ = 0.22. When σ = 0.33, already T = 1000 outputs suffice for essentially perfect detection of aliasing. For the smaller σ = 0.22, more samples are required.\nFig.4 (left) shows the false alarm and misdetection probability vs. sample size T of the aliasing detection test (28) with threshold hT = 2T− 1 3 . The consistency of our method is evident. Fig.4 (right) shows the probability of misidentifying the aliased component θ3̄. We considered the same 2A-HMM H but with different means for the Gaussian output distribution of the aliased states, µ3̄ = {0, 1, 2}. As expected, when fθ3̄ is closer to the output distribution of the non-aliased state fθ1 (with mean µ1 = 3), identifying the aliased component is more difficult.\nFinally, to estimate A we considered the following methods: The Baum-Welch algorithm with random initial guess of the HMM parameters (BW); our method of moments with exactly known θ̄ (MoM+Exact); BW initialized with the output of our method (BW+MoM+Exact); and BW with exactly known output distributions but random initial guess of the transition matrix (BW+Exact).\nFig.5 (left) shows on a logarithmic scale the mean square error E||Â − A||2F vs. sample size T , averaged over 100 independent realizations. Fig.5 (right) shows the running time as a function of T . In these two figures, the number of iterations of the BW was set to 20.\nThese results show that with a random initial guess of the HMM parameters, BW requires far more than 20 iterations to converge. Even with exact knowledge of the output distributions but a random initial guess for the transition matrix, BW still fails to converge after 20 iterations. In contrast, our method yields a relatively accurate estimator in only a fraction of run-time. For an improved accuracy, this estimator can further be used as an initial guess for A in the BW algorithm."
    }, {
      "heading" : "A Proofs for Section 3 (Decomposing A)",
      "text" : "Proof of Lemma 1. Writing each term in the decomposition (8) explicitly and summing these together we find a match between all entries to those of A.\nAs a representative example let us consider the last entry An,n = P (n |n). The first term gives\n(CβĀB)[n,n] = (1− β)P (n̄ |n).\nThe second term gives\n(Cβδ outcTβ)[n,n] = −β(1−β)δoutn−1\n= −β(1−β)(P (n̄ |n−1)−P (n̄ |n)).\nThe third term,\n(b(δin)TB)[n,n] = −δinn−1 = −β(αn−1−β)P (n̄ |n−1) − (1−β)(αn−β)P (n̄ |n).\nAnd lastly, the fourth term gives\n(κbcTβ)[n,n] = β(αn−1 − β)P (n̄ |n−1) −β(αn − β)P (n̄ |n).\nPutting P (n̄ |n) = P (n−1 |n) + P (n |n) and P (n̄ |n−1) = P (n−1 |n−1) + P (n |n−1), and summing all these four terms we obtain P (n |n) as needed. The other entries of A are obtained similarly."
    }, {
      "heading" : "B Proofs for Section 4.1 (Minimality)",
      "text" : "Let H = (A,θ,π0) be a 2A-HMM. For any k ≥ 1 the distribution PH,k ∈ PH can be cast in an explicit matrix form. Let o ∈ Y . The observable operator Tθ(o) ∈ Rn×n is defined by\nTθ(o) = diag (fθ1(o), fθ2(o), . . . , fθn(o)) .\nLet y = (y0, y1, . . . , yk−1) ∈ Yk be a sequence of k ≥ 1 initial consecutive observations. Then the distribution PH,k(y) is given by Jaeger [2000],\nPH,k(y) = 1 T nTθ(yk−1)A . . . ATθ(y1)ATθ(y0)π 0. (34)\nProof of Theorem 1. Let us first show that δout 6= 0 is necessary for minimality, namely if δout = 0 then H is not minimal, regardless of the initial distribution π0. The nonminimality will be shown by explicitly constructing a n−1 state HMM equivalent to H . Let us denote the lifting of the merged transition matrix by\nÃ = CβĀB ∈ Rn×n.\nAssume that δout = 0. We will shortly see that for any π0 and for any k ≥ 2 consecutive observations y = (y0, y1, . . . , yk−1) ∈ Yk we have that\nTθ(yk−1)A . . . Tθ(y1)ATθ(y0)π 0 (35)\n− Tθ(yk−1)Ã . . . Tθ(y1)ÃTθ(y0)π0 ∝ b.\nCombining (35) with (34), and the fact that 1Tnb = 0, we have that P(A,θ,π0) = P(Ã,θ,π0). Since Ã has identical (n−1)-th and n-th columns, and fθn−1 = fθn we have that P(Ã,θ,π0) = P(Ā,θ̄,π̄0). Thus H ′ = (Ā, θ̄, π̄0) is an equivalent (n−1)-state HMM and H is not minimal, proving the claim. We prove (35) by induction on the sequence length k ≥ 2. First note that since δout = 0, by Lemma 1 we have that\nA = Ã+ b((δin)TB + κcTβ).\nSince for any y ∈ Y , Tθ(y)b = fθn̄(y)b, we have that\nTθ(y)A− Tθ(y)Ã = fθn̄(y)b((δ in)TB + κcTβ) ∝ b.\nThis proves the case k = 2. Next, assume (35) holds for all sequences of length at least 2 and smaller than k, namely, for some a ∈ R\nTθ(yk−2)A . . . Tθ(y1)ATθ(y0)π 0\n= ab+ Tθ(yk−2)Ã . . . Tθ(y1)ÃTθ(y0)π 0.\nUsing the fact that Bb = 0 we have Tθ(yk−1)Ãb = 0. Inserting the expansion of A in the l.h.s of (35) we get\nfθn̄(yk−1)b ( (δin)TB + κcTβ ) × ( ab+ ÃTθ(yk−2) . . . Tθ(y1)ÃTθ(y0)π 0 ) .\nSince this last expression is proportional to b we are done.\n(ii) The case π0n̄ = 0 or β0 = β. As we just saw, having δ out = 0 implies that the HMM is not minimal. We now show that if δin = 0 then H is not minimal either. By contraposition this will prove the first direction of (ii).\nSo assume that δin = 0. Lemma 1 implies\nA = Ã+ (Cβ(δ out) + κb)cTβ . (36)\nNow note that for all y ∈ Y , cTβTθ(y) = fθn−1(y)cTβ and since either π0n̄ = 0 or β0 = β we have that cTβπ 0 = 0. Thus cβTθ(y)π0 = 0 and we find that\nTθ(yk−1)A . . . ATθ(y1)ATθ(y0)π 0 (37)\n= Tθ(yk−1)A . . . ATθ(y1)ÃTθ(y0)π 0. (38)\nNow since cTβCβ = 0 we have that for any y ∈ Y , cTβTθ(y)Ã = 0 and thus expanding A by (36) we find that for any y ∈ Y ,\nATθ(y)Ã = ( Ã+ (Cβ(δ out) + κb)cTβ ) Tθ(y)Ã = ÃTθ(y)Ã.\nThus each A in the right hand side of (37) can be replaced by Ã and we conclude that P(A,θ,π0) = P(Ã,θn,π0). Similarly to the case δ\nout = 0 we have that H ′ = (Ā, θ̄, π̄0) is an equivalent (n−1)-state HMM and thus H is not minimal.\nIn order to prove the other direction we will show that if H is not minimal then either δout = 0 or δin = 0. This is equivalent to the condition δoutδin T = 0.\nAssuming H is not minimal, there exists an HMM H ′ with n′ < n states such that PH′ = PH . Assumptions (A1-A3) readily imply that H ′ must have n′ = n−1 states and that the unique n−1 output components are identical for H and H ′. Since PH′ is invariant to permutations, we may assume that θ̄′ = θ̄ and consequently the kernel matrices in (1) for both H and H ′ are equal K̄ = K̄ ′.\nLetA′ ∈ R(n−1)×(n−1) be the transition matrix ofH ′ and defineH ′′ = (A′′,θ′′, π′′) as the equivalent n-state HMM to H ′ by setting β′′ = β, A′′ = CβA′B, θ′′ = θ̄ ′ B and π′′ = Cβπ̄′. Note that for H ′′, by construction we have δout ′′ (δin ′′ )T = 0.\nNow, by the equivalence of the two models H and H ′′, we have that the second order momentsM(2) given in (12) are the same for both. By the fact that K̄ ′′ = K̄, π̄′′ = π̄ and by (22) in Lemma 3 we must have that δout(δin) T = δout ′′ (δin ′′ )T. Thus δout(δin) T = 0 and the claim is proved.\n(i) The case π0n̄ 6= 0 and β0 6= β. We saw above that if H is minimal then δ out 6= 0. Thus, in order to prove the claim we are left to show that if H is not minimal then δout = 0.\nSo assume H is not minimal and let H ′′ be constructed as above. By way of contradiction assume δout 6= 0. As we just saw, sinceH is not minimal then δout(δin)T = 0. Thus by the assumption δout 6= 0 we must have δin = 0. This implies that A is in the form (36). Since PH = PH′′ we have PH,2 = PH′′,2 where:\nPH,2 = 1 T nTθ(y2)ATθ(y1)π 0 = 1TnTθ(y2) ( Ã+ (Cβδ out + κb)cTβ ) Tθ(y1)π 0\nPH′′,2 = 1 T nTθ(y2)A ′′Tθ(y1)π 0.\nIn addition, by the fact that K̄ ′′ = K̄, π̄′′ = π̄ we must have that M (1) = M ′′(1), where M (1) is defined in (16) and M ′′(1) is defined similarly with the parameters of H ′′ instead of H . By (21) in Lemma 3 we thus have\nM ′′ (1) = A′ = Ā = M (1).\nHence A′′ = Ã and PH,2 = PH′′,2 is equivalent to\n1TnTθ(y2) ( Cβδ out + κb ) cTβTθ(y1)π 0 = 0. (39)\nNow, note that ∀y1, y2 ∈ Y we have\n1TnTθ(y2)b = 0\ncTβTθ(y1)π 0 = (β0 − β)π0n̄fθn̄(y1) 1TnTθ(y2)Cβ = (fθ1(y2), . . . , fθn−1(y2)).\nThus, (39) is given by (β0 − β)π0n̄fθn−1(y1) ( fθ1(y2), . . . , fθn−1(y2) ) · δout = 0.\nSince by assumption (β0 − β)π0n̄ 6= 0 we have ∀y1, y2 ∈ Y fθn−1(y1) ( fθ1(y2), . . . , fθn−1(y2) ) · δout = 0.\nFor each i ∈ [n−1], multiplying by fθi(y2) and integrating over y1, y2 ∈ Y we get\nK̄δout = 0.\nSince K̄ is full rank we must have δout = 0 in contradiction to the assumption δout 6= 0. This concludes the proof of the Theorem."
    }, {
      "heading" : "C Proofs for Section 4.2 (Identifiability)",
      "text" : ""
    }, {
      "heading" : "C.1 Proof of Theorem 2",
      "text" : "Before characterizing ΓH let us first give some intuition on the role of (τn−1, τn). Consider the n−1 dimensional columns {āi | i ∈ [n]} of the matrix BA. These can be\nplotted on the n−1 dimensional simplex, as shown in Fig.7 (top), for n = 4 and aliased states {3, 4}. Recall that\nAH(τn−1, τn) = S(τn−1, τn) −1AS(τn−1, τn)\nand let {āH,i | i ∈ [n]} be the columns of the matrix BAH ∈ Rn−1×n. Since BS(τn−1, τn)−1 = B we have BAH = BAS(τn−1, τn). So the non-aliased columns of BAH are unaltered from these of BA, i.e. for all i ∈ [n−2], āi = āH,i. The new aliased columns of BAH are\nāH,n−1 = ān + τn−1δ out\nāH,n = ān + τnδ out.\nThus τn−1 (τn) determines the position of the vector āH,n−1 (āH,n) along the ray passing through ān−1 and ān (dashed line in Fig.7).\nHence a necessary condition forAH to be a valid transition matrix is that āH,n−1 ≥ 0 and āH,n ≥ 0, and one cannot take τn−1 and τn arbitrarily. In particular, there are τmaxn−1 and τmaxn such that āH,n−1 and āH,n are as “far” apart as possible by putting them on\nthe opposite sides of the ray connecting them, such that both sit on the simplex boundary. This is achieved by taking\nāmaxH,n−1 = ān + τ max n−1 δ out\nāmaxH,n = ān + τ max n δ out,\nwhere\nτmaxn−1 = minj∈X\\{n−1,n} 1 2 (1+sign(δ out j ))−(ān)j\nδoutj ≥ 0\nτmaxn = maxj∈X\\{n−1,n} 1 2 (1−sign(δ out j ))−(ān)j\nδoutj ≤ 0.\n(see Fig.7, bottom). Since we assumed as a convention that τn−1 > τn we have that any τn−1 ≤ τmaxn−1 and τn ≥ τmaxn results in a non negative matrix BAH . Note that BAH ≥ 0 implies AH [1:n−2,1:n] ≥ 0.\nNext, consider the new relative probabilities αH,i as defined by (4) with AH replacing A. One can verify that these satisfy\nαH,i = αi − τn τn−1 − τn , i ∈ suppin \\{n−1, n}.\nObviously, a necessary condition for AH to be a valid transition matrix is that\n0 ≤ αH,i = αi − τn τn−1 − τn ≤ 1, i ∈ suppin \\{n−1, n}. (40)\nDefine the minimal and maximal relative probabilities of the non-aliased states by\nαmin = min {αi | i ∈ suppin \\{n−1, n}} αmax = max {αi | i ∈ suppin \\{n−1, n}}.\nLet αminH and α max H be defined similarly. Taking\nτminn−1 = α max τminn = α min,\nwe have αminH = 0 and α max H = 1. Hence, for any τn−1 ≥ τminn−1 and τn ≤ τminn the constraint (40) holds and consequently AH [1:n,1:n−2] is non-negative. The corresponding columns āminH,n−1 = ān + τ min n−1 δ out and āminH,n = ān + τ min n δ\nout are depicted in Fig.7 (bottom).\nCombining the above constraints we have that the four parameters τminn−1 , τ min n , τ max n−1 , τ max n\ndefine the rectangle\nΓ1 = [τ min n−1 , τ max n−1 ]× [τmaxn , τminn ], (41)\nwhich characterize the equivalent matrices AH having all entries non-negative except of possibly in the 2× 2 aliased block (see Fig.6). Thus we must have ΓH ⊂ Γ1.\nWe are left to find the conditions under which the 2 × 2 aliased block is nonnegative. Writing AH explicitly we have that these conditions are\nAH,n,n−1 = τn−1(τn−1 − αn−1)P (n̄ |n−1) (42) + (1− τn−1)(τn−1 − αn)P (n̄ |n) ≥ 0\nAH,n−1,n = τn(αn−1 − τn)P (n̄ |n−1) (43) + (1− τn)(αn − τn)P (n̄ |n) ≥ 0\nAH,n−1,n−1 = τn−1(αn−1−τn)P (n̄ |n−1) (44) + (1−τn−1)(αn − τn)P (n̄ |n) ≥ 0\nAH,n,n = τn(τn−1 − αn−1)P (n̄ |n−1) (45) + (1− τn)(τn−1 − αn)P (n̄ |n) ≥ 0.\nAs the case P (n̄ |n−1) = P (n̄ |n) = 0 is trivial, we assume that at least one of P (n̄ |n−1), P (n̄ |n) is nonzero (and since by convention P (n̄ |n−1) ≥ P (n̄ |n), this is equivalent to P (n̄ |n−1) > 0).\nRecall that by definition δoutn−1 = P (n̄ |n−1)−P (n̄ |n) (see (5)). We now consider the cases δoutn−1 = 0 and δ out n−1 > 0 separately.\nThe case δoutn−1 = 0. Consider first the off-diagonal constraint (43) for AH,n−1,n ≥ 0, taking the form\nτn(1− (αn−1 − αn))) ≤ αn.\nDenote τ0 = αn/(1− (αn−1 − αn)).\nSince αn−1 − αn ≤ 1 we need τn ≤ τ0. Similarly, (42) is satisfied if and only if τn−1 ≥ τ0. Thus in order for the off-diagonal entries AH,n,n−1, AH,n−1,n to be nonnegative we need (τn−1, τn) ∈ Γ02 where\nΓ02 = [τ 0,∞]× [−∞, τ0]. (46)\nNext, the on-diagonal constraint (44) for AH,n−1,n−1 ≥ 0 is equivalent to\nτn ≤ αn + τn−1(αn−1 − αn). (47)\nSimilarly, the on-diagonal constrain (45) for AH,n,n ≥ 0 is\nτn(αn−1 − αn) ≤ τn−1 − αn. (48)\nDefine the two linear functions g0, f0 : R→ R by\ng0(τn−1) = αn + τn−1(αn−1 − αn) f0(τn−1) = τn−1 − αn αn−1 − αn .\nNote that τ0 is a fixed point of both g0 and f0,\nτ0 = g0(τ0) = f0(τ0).\nNote also that for αn−1 ≥ αn the functions g0 and f0 are increasing, while for αn−1 < αn they are decreasing. Thus, if αn−1 ≥ αn the constrains (47,48) are automatically satisfied for (τn−1, τn) ∈ Γ02, so in this case AH,n−1,n−1, AH,n,n are also guaranteed to be non-negative.\nIf αn−1 < αn then with τn−1 ≥ τn (as we assume here) we have f0(τn−1) ≤ g0(τn−1) ≤ τ0 and the constraints (47,48) take the form f0(τn−1) ≤ τn ≤ g0(τn−1). Thus, in order for the on-diagonal entries AH,n−1,n−1 and AH,n,n to be non-negative we must have (τn−1, τn) ∈ Γ03, where\nΓ03 = {(τn−1, τn) ∈ Γ1 | f0(τn−1) ≤ τn ≤ g0(τn−1)}. (49)\nWe are left to ensure that for αn−1 < αn the off diagonal entries are also nonnegative. Indeed, since τn ≤ τn−1, τ0 is a fixed point and g(τn−1), f(τn−1) are decreasing, for any (τn−1, τn) ∈ Γ03 we automatically have that τ0 ≤ τn−1 and τn ≤ τ0, so (τn−1, τn) ∈ Γ03 implies (τn−1, τn) ∈ Γ02. Thus all entries of the aliasing block are guaranteed to be non-negative.\nTo conclude, we have shown that for δoutn−1 = 0 the feasible region (10) is given by\nΓ0H = { Γ1 ∩ Γ02 αn−1 ≥ αn Γ1 ∩ Γ03 αn−1 < αn.\nThe case δoutn−1 > 0. This case has the same characteristics as for the δoutn−1 = 0 case, but it is a bit more complex to analyze. Define τ± (as the analogues of τ0) by\nτ± = 1\n2δoutn−1\n( αn−1P (n̄ |n−1) (50)\n−(1 + αn)P (n̄ |n)± √ ∆ ) ,\nwhere\n∆ = ( αn−1P (n̄ |n−1)− (1 + αn)P (n̄ |n) )2 + 4αnP (n̄ |n)δoutn−1 ≥ 0.\nAnd define the regions\nΓ2 = [τ +,∞]× [τ−, τ+] (51)\nΓ3 = {(τn−1, τn) ∈ Γ1 | f(τn−1) ≤ τn ≤ g(τn−1)} (52)\nwhere the functions g, f : R→ R are given by\ng(τn−1) =\n( αn−1P (n̄ |n−1)− αnP (n̄ |n)\nδoutn−1\n) (53)\n− P (n̄ |n−1)P (n̄ |n)(αn−1 − αn) (δoutn−1) 2\n× ( τn−1 − (−P (n̄ |n) δoutn−1 ))−1 and\nf(τn−1) = ( −P (n̄ |n) δoutn−1 ) (54)\n− P (n̄ |n−1)P (n̄ |n)(αn−1 − αn) (δoutn−1) 2\n× ( τn−1 − (αn−1P (n̄ |n−1)− αnP (n̄ |n) δoutn−1 ))−1 .\nLemma 8. Let Γ1 be defined in (41) and let Γ2 and Γ3 be defined according to whether δoutn−1 = 0 (46,49) or not (51,52). Then the feasible region ΓH satisfies\nΓH = { Γ1 ∩ Γ2 αn−1 ≥ αn Γ1 ∩ Γ3 αn−1 < αn.\nProof. As the case δoutn−1 = 0 was treated above, we consider the case δ out n−1 > 0. Consider first the off diagonal constraint (43). Multiplying by (−1), we need to solve the following inequality for τ ∈ R,\nτ2δoutn−1 − τ(αn−1P (n̄ |n−1) (55) −(1 + αn)P (n̄ |n))− αnP (n̄ |n) ≤ 0.\nWe first solve with equality to find the solutions τ−, τ+ given in (50). Thus, since ∆ ≥ 0 we have that any feasible τn must satisfy τ− ≤ τn ≤ τ+. Note that the constraint (42) for τn−1 is the complement of (43), and by assumption τn−1 ≥ τn, so (42) is satisfied iff τ+ ≤ τn−1. Thus, the region Γ2 given in (51) indeed characterize the non-negativity of both An−1,n and An,n−1. With some algebra, τ+ and τ− can be shown to satisfy the following useful relations:\n• If αn−1 ≥ αn then\n−P (n̄ |n−1) δoutn−1 ≤ τ− ≤ 0 (56)\nand\n0 ≤ τ+ ≤ αn−1P (n̄ |n−1)− αnP (n̄ |n) δoutn−1 . (57)\n• If αn−1 < αn then\nτ− ≤ −P (n̄ |n) δoutn−1\n(58)\n≤ αn−1P (n̄ |n−1)− αnP (n̄ |n) δoutn−1 ≤ τ+.\nWe proceed to handle the constraints (44) and (45) corresponding to the region Γ3. We begin by solving the inequality (44):\n−τn(P (n̄ |n) + τn−1δoutn−1) + αnP (n̄ |n) + τn−1(αn−1P (n̄ |n−1)− αnP (n̄ |n)) ≥ 0.\nNote that for (τn−1, τn) ∈ Γ1 we have (P (n̄ |n) + τn−1δoutn−1) ≥ 0. Rearranging we get that in order for AH,n−1,n−1 to be non-negative we must have that\nif τn−1 ≥ − P (n̄ |n) δoutn−1 then τn ≤ g(τn−1), (59)\nwhere g is the function given in (53). Similarly, consider the condition (45),\nτn ( αnP (n̄ |n)− αn−1P (n̄ |n−1) + τn−1δoutn−1 ) +P (n̄ |n)(αn − τn−1) ≥ 0.\nRearranging we find that in order for AH,n,n ≥ 0 we must have{ τn ≤ f(τn−1) τn−1 ≤ αn−1P (n̄ |n−1)−αnP (n̄ |n)P (n̄ |n−1)−P (n̄ |n) τn ≥ f(τn−1) otherwise,\n(60)\nwhere the function f is given in (54). Note that g (res. f ) defines the boundary where (44) (res. (45)) changes sign, namely any pair (τn−1, τn) = (τn−1, g(τn−1)) is on the curve making Equation (44) equal zero, and similarly f(τn−1) is such that (τn−1, τn) = (τn−1, f(τn−1)) is on the curve making (45) equal zero. Having the boundaries g, f in our disposal let us first consider the case αn−1 ≥ αn.\nThe sub-case αn−1 ≥ αn. We show that in this case, having (τn−1, τn) ∈ Γ1 ∩ Γ2 already ensures that conditions (59) and (60) are trivially met, which in turn implies the non-negativity of both AH,n−1,n−1 and AH,n,n. This is done by showing that for any (τn−1, τn) ∈ Γ1 ∩ Γ2 the curve (τn−1, g(τn−1)) is above (τn−1, τ+). Similarly, for τn−1 < (αn−1P (n̄ |n−1)− αnP (n̄ |n))/δoutn−1 the curve (τn−1, f(τn−1)) is above (τn−1, τ\n+) and for τn−1 > (αn−1P (n̄ |n−1)− αnP (n̄ |n))/δoutn−1 the curve (τn−1, f(τn−1)) is below (τn−1, τ−), thus making conditions (59) and (60) true. Toward this end consider the equality g(τ) = f(τ) given by\n0 = ( αn−1P (n̄ |n−1) + (1− αn)P (n̄ |n) ) ×(\nτ2δoutn−1 + τ((1 + αn)P (n̄ |n) −αn−1P (n̄ |n−1))− αnP (n̄ |n) ) .\nThus if (αn−1P (n̄ |n−1) + (1− αn)P (n̄ |n)) = 0 we have that g = f identically. Otherwise we need to solve again (55) so the solutions are τ+, τ− with g(τ+) = f(τ+) and g(τ−) = f(τ−). In addition one can show that τ+ and τ− are in fact fixed points of both g and f , so together we have\nτ+ = g(τ+) = f(τ+) τ− = g(τ−) = f(τ−).\nInspecting g(τn−1) one can see that for τn−1 ≥ −P (n̄ |n)/δoutn−1, g(τn−1) is monotonic increasing and concave. Since by (57) we have τ+ ≥ −P (n̄ |n)/δoutn−1 we get that for τn−1 ≥ τ+ we must have g(τn−1) ≥ τ+ as needed. Similarly, for τ+ ≤ τn−1 < (αn−1P (n̄ |n−1)− αnP (n̄ |n))/δoutn−1 the function f(τn−1) is increasing and convex and thus above τ+, while for (αn−1P (n̄ |n−1)− αnP (n̄ |n))/δoutn−1 < τn−1 it is increasing but always below τ−. Thus, for αn−1 ≥ αn we have that Γ1 ∩ Γ2 also characterize the non-negativity of AH,n−1,n−1 and AH,n,n as claimed.\nThe sub-caseαn−1 < αn. Note that by (58) we have τ+ ≥ (αn−1P (n̄ |n−1)− αnP (n̄ |n))/δoutn−1. Thus for τ+ ≤ τn−1 both g and f are decreasing and convex and f(τn−1) ≤ g(τn−1). Thus in order to ensure (59, 60) we need f(τn−1) ≤ τn ≤ g(τn−1). Thus, Γ3 as defined in (52) characterize the non-negativity of AH,n,n, AH,n−1,n−1. Finally we need to show that having (τn−1, τn) ∈ Γ3 also ensures the non-negativity of AH,n,n−1 and AH,n−1,n. But by (58) we have that for τn−1 ≥ τ+ both g(τn−1), f(τn−1) ≥ τ− and thus Γ3 ⊂ Γ2. Hence we have shown that ΓH is characterized as claimed.\nLemma 9. The set ΓH is connected.\nProof. If αn−1 ≥ αn then ΓH = Γ1 ∩Γ2 is a rectangle and thus connected. In the case αn−1 < αn we have that f(τn−1) ≤ g(τn−1) and are both decreasing and convex thus the region Γ3 with intersection with a rectangle is a connected set."
    }, {
      "heading" : "C.2 Conditions for |ΓH | = 1",
      "text" : "Let us first write\n(τn−1, τn) = (1, 0) + (∆τn−1,∆τn).\nWe characterize the conditions for |ΓH | = 1 by determining the geometrical constraints the entries of the transition matrix A pose on (∆τn−1,∆τn) in order to ensure AH(1 + ∆τn−1,∆τn) ≥ 0. Note that |ΓH | = 1 iff these constraints imply that (∆τn−1,∆τn) = (0, 0) is the unique feasible pair.\nAs a first example, consider a 2A-HMM H having a transition matrix with all entries being strictly positive, A ≥ > 0. Since the mapping (9) is continuous in ∆τn−1,∆τn, there exists a neighborhood N ⊂ R2 of (∆τn−1,∆τn) = (0, 0), such that for any (∆τn−1,∆τn) ∈ N the matrix AH(1 + ∆τn−1,∆τn) is non-negative, and thus N ⊂ ΓH . This condition can be represented in the (∆τn−1,∆τn) plane (i.e. R2) as the ”full” diagram Fig.8. On the other hand, the condition that (∆τn−1,∆τn) = (0, 0) is the unique feasible pair can be represented by a point like diagram as in Fig.8.\nIn general, the entries of the transition matrix A put constraints on the feasible (∆τn−1,∆τn) only when (τn−1, τn) = (1, 0) is on the boundary of ΓH . These constraints can be explicitly determined in terms of A’s entries by considering the exact characterization of ΓH given in Theorem 2. Note however that by the fact that ΓH is connected, and as far as the condition |ΓH | = 1 is concerned, we only need to consider the shape of these constraints in a small neighborhood of (τn−1, τn) = (1, 0), i.e for |∆τn−1| , |∆τn| << 1. Any such neighborhood can be represented on the R2 plane (as in Fig.8). The shape of this neighborhood for a given H is called the effective feasible\nregion of ΓH . Now, as the example with A ≥ > 0 shows, a non-trivial constraint on the (effective) feasible region must results from A having some zeros entries. Each such a zero entry, as determined by its position in A, put a boundary constraint on (∆τn−1,∆τn). These in turn corresponds to a suitable diagram in R2 (as the diagram for ∆τn ≥ 0 in Fig.8). The effective feasible region of A is obtained by taking the intersection of all these diagrams. The exact correspondence between A’s entries and the corresponding diagrams is given in Tables 1,2,3,4. The procedure for determining the effective feasible region of a 2A-HMM is given in Algorithm 1. The correctness of the algorithm is demonstrated in the proof of Lemma 8.\nAlgorithm 1 determining the effective feasible region for minimal 2A-HMM H 1: permute aliased states so that P (n̄ |n−1) ≥ P (n̄ |n) 2: collect the following diagrams:\n- ∀i ∈ [n−2] with Ai,n ∈ {0, 1} or Ai,n−1 ∈ {0, 1} pick the relevant diagram in Table 1\n- ∀j ∈ suppin \\{n−1, n} with αj ∈ {0, 1} pick corresponding diagram in Table 2\n- if αn−1 ≥ αn pick relevant diagram in table 3 and if αn−1 < αn pick relevant diagram in Table 4\n3: Return the intersection of all the regions obtained in previous step"
    }, {
      "heading" : "C.3 Examples.",
      "text" : "We demonstrate our Algorithm 1 for determining the identifiability of 2A-HMMs on the 2A-HMM given in Section 6, shown in Fig 2 (left). Going through the steps of Algorithm 1 we get the following diagrams for the effective feasible region:\n︸ ︷︷ ︸ from Table 1:\nA1,3=0∧A1,4 6=0\n∩ ︸ ︷︷ ︸ from Table 1:\nA2,4=0∧A2,3 6=0 ∩ ︸ ︷︷ ︸ from Table 2: α1=1 ∩ ︸ ︷︷ ︸ from Table 2: α2=0 = .\nSince their intersection results in a point like diagram, this 2A-HMM is identifiable. More generally, for a minimal stationary 2A-HMM satisfying Assumptions (A1A2) with aliased states n and n−1, a sufficient condition for uniqueness is the following constraints on the allowed transitions between the hidden states: ∃in−1, jn−1, in, jn ∈\n[n−2] such that\nX in−1 → n−1 → jn−1 X in−1 → n→ ∗ X in → n→ jn X in → n−1 → ∗\nX ∗ → n−1 → jn X ∗ → n→ jn−1.\nOne can check that these conditions give the same set of diagrams as above."
    }, {
      "heading" : "D Proofs for Section 5 (Learning)",
      "text" : ""
    }, {
      "heading" : "D.1 Proof of Lemma 3",
      "text" : "The claim in (21) that M (1) = BACβ = Ā follows directly from (14) and (16). Next, we have\nR(2) = BAACβ −BACβBACβ = BA(In − CβB)ACβ = BAbcTβACβ ,\nwhere the last equality is by the fact that (In − CβB) = bcTβ . Since BAb = δ out and cTβACβ = (δ in)T we have R(2) = δout(δin)T as claimed in (22).\nAs for (23) we have,\nR(3) = BAAACβ −BAACβBACβ −BACβBAACβ +BACβBACβBACβ\n= BA(In − CβB)A(In − CβB)ACβ = δoutcTβAb(δ in)T.\nSince by definition κ = cTβAb we have R (3) = κR(2) and the claim in (23) is proved.\nFinally, F (c) = BA ( diag(K[·,c])− Cβ diag(K̄[·,c])B ) ACβ .\nSince\ndiag(K[·,c])− Cβ diag(K̄[·,c])B = K̄n−1,cb(cβ)T\nwe have that F (c) = K̄n−1,cR(2) as claimed in (24)."
    }, {
      "heading" : "D.2 Proof of Lemma 4",
      "text" : "Assumption (A2) combined with the fact that the HMM has a finite number of states imply that the HMM is geometrically ergodic: there exist parameters G < ∞ and ψ ∈ [0, 1) such that from any initial distribution π0,∥∥Atπ0 − π∥∥\n1 ≤ 2Gψt, ∀t ∈ N. (61)\nThus, we may apply the following concentration bound, given in Kontorovich & Weiss [2014]:\nTheorem 4. Let Y = Y0, . . . , YT−1 ∈ YT be the output of a HMM with transition matrixA and output parameters θ. Assume thatA is geometrically ergodic with constants G,ψ. Let F : (Y0, . . . , YT−1) 7→ R be any function that is Lipschitz wit constatnt l with respect to the Hamming metric on YT . Then, for all > 0,\nPr(|F (Y )− EF | > T ) ≤ 2 exp ( −T (1− ψ) 2 2\n2l2G2\n) . (62)\nIn order to apply the theorem note that ∀t ∈ {1, 2, 3}, E[M̂(t)ij ] = M (t) ij for any i, j ∈ [n−1]. In addition, following Assumption (A3), (T − t)M̂(t)ij is (t + 1)L2Lipschitz with respect to the Hamming metric on YT . Thus, taking ≈ T− 12 in Theorem 4 and applying a union bound on i, j readily gives\nM̂(t) = M(t) +OP ( T− 1 2 ) .\nThe kernel-free moments M̂ (t) given in (25) incur additional error which results in a factor of at most 1/(σmin(K̄)2 mini πi) hidden in theOP notation. SinceR(t) are (low order) polynomials of M (t), the asymptotics OP ( T− 1 2 ) carry on to the error in R̂(t).\nA similar argument yields the claim for F (c)."
    }, {
      "heading" : "D.3 Proof of Lemma 6",
      "text" : "Let σ1 and σ̂1 be the largest singular values of R(2) and R̂(2), respectively. Combining Weyl’s Theorem [Stewart & Sun, 1990] with Lemma 4 gives\n|σ1 − σ̂1| ≤ ∥∥∥R(2) − R̂(2)∥∥∥\nF = OP (T\n− 12 ),\nRecall that under the null hypothesis H0, we have σ1 = 0. Thus, with high probability σ̂1 < ξ0T− 1 2 , for some ξ0 > 0. In contrast, underH1 we have σ1 = σ > 0, thus for some ξ1 > 0, σ̂1 > σ − ξ1T− 1 2 . Hence, taking T sufficiently large, we have that for any ch > 0 and 0 < < 12 , with hT = chT − 12 + ,\nin caseH0 : σ̂1 < hT in caseH1 : σ̂1 > hT ,\nwith high probability. Thus, the correct detection of aliasing is with high probability."
    }, {
      "heading" : "D.4 Proof of Lemma 7",
      "text" : "Let us define the following score function for any i ∈ [n−1],\nscore(i) = ∑\nj∈[n−1]\n∥∥∥F̂ (j) − K̄i,jR̂(2)∥∥∥2 F .\nAccording to Eq. (30) the chosen aliased component is the index with minimal score. Hence, in order to prove the Lemma we need to show that\nlim T→∞\nPr(∃i 6= n−1 : score(i) < score(n−1)) = 0.\nBy Lemma 4 and (20) we have\nF̂ (j) = F (j) + ξ (j) F√ T = K̄n−1,jR (2) + ξ (j) F√ T\nR̂(2) = R(2) + ξR√ T ,\nfor some ξR, ξ (j) F ∈ R(n−1)×(n−1) with OP (ξR) = 1 and OP (ξ (j) F ) = 1. Thus,\nscore(n−1) = 1√ T ∑ j∈[n−1] ∥∥∥ξ(j)F − K̄j,n−1ξR∥∥∥2 F P−→ 0.\nIn contrast, for any i 6= n−1 we may write score(i) as\n∑ j∈[n−1] ∥∥∥∥(K̄j,i − K̄j,n−1)R(2) + 1√T (ξ(j)F − K̄j,n−1ξR) ∥∥∥∥2 F .\nApplying the (inverse) triangle inequality we have\nscore(i) ≥ σ2 ∥∥K̄[·,n−1] − K̄[·,i]∥∥2 −OP (T− 12 ).\nSince K̄ is full rank, σ2 ∥∥K̄[·,n−1] − K̄[·,i]∥∥2 > 0. Thus, for any i 6= n−1 as T → ∞, w.h.p score(i) > score(n−1). Taking a union bound over i yields the claim."
    }, {
      "heading" : "D.5 Estimating γ and β",
      "text" : "We now show how to estimate γ and β. As discussed in Section 5.4, this is done by searching for γ′, β′ ensuring the non-negativity of (33), namely, A′H(γ\n′, β′) ≥ 0, where\nA′H(γ ′, β′) ≡ Cβ′ĀB + γ′Cβ′ucβ′ T +\nσ γ′ bvTB + κ bcβ′ T.\nWe pose this as a non-linear two dimensional optimization problem. For any γ′ ≥ 0 and 0 ≤ β′ ≤ 1 define the objective function h : R2 → R by\nh(γ′, β′) = min i,j∈[n] {γ′A′H(γ′, β′)ij}.\nNote that h(γ′, β′) ≥ 0 iff A′H(γ′, β′) does not have negative entries. Recall that by the identifiability of H , if we constrain γ′ ≥ 0 then the constraint A′H(γ′, β′) ≥ 0 has the unique solution (γ, β) (this is the equivalent to the convention τn−1 ≥ τn made in Section 4.2). Namely, any (γ′, β′) 6= (γ, β) results in at least one negative entry in\nA′H(γ ′, β′). Hence, h(γ′, β′) has a unique maximum, obtained at the true (γ, β). In addition, since ‖u‖2 = ‖v‖2 = 1, a feasible solution must have γ′ ≤ 2/σ. So our optimization problem is:\n(γ̂, β̂) = argmax (γ′,β′)∈[0, 2σ ]×[0,1]\nh(γ′, β′) (63)\nThis two dimensional optimization problem can be solved by either brute force or any non-linear problem solver.\nIn practice, we solve the optimization problem (63) with the empirical estimates plugged in, that is\nÂ′H(γ ′, β′) = Cβ̂ ˆ̄AB + γ′Cβ′û1c T β′ + σ̂1 γ′ bv̂T1B + κ̂ bc T β′ .\nThe empirical objective function ĥ(γ′, β′) is defined similarly. Such a perturbation may results in a problem with many feasible solutions, or worse, with no feasible solutions at all. Nevertheless, as shown in the proof of Theorem 3, this method is consistent. Namely, as T →∞, the above method will return an arbitrarily close solution (in ‖·‖F) to the true transition matrix A, with high probability."
    }, {
      "heading" : "D.6 Proof of Theorem 3",
      "text" : "Recall the definitions of A′H(γ ′, β′) and its empirical version Â′H(γ ′, β′), given in the previous Section D.5. To prove the theorem we show that∥∥∥Â′H(γ̂, β̂)−A′H(γ, β)∥∥∥ F P−→ 0.\nToward this goal we bound the l.h.s by∥∥∥Â′H(γ̂, β̂)−A′H(γ̂, β̂)∥∥∥ F + ∥∥∥A′H(γ̂, β̂)−A′H(γ, β)∥∥∥ F , (64)\nand show that each term converges to 0 in probability. We shall need the following lemma, establishing the pointwise convergence in probability of ÂH to AH :\nLemma 10. For any 0 < γ′ and 0 ≤ β′ ≤ 1,∥∥∥ÂH(γ′, β′)−AH(γ′, β′)∥∥∥ F = oP (1).\nProof. By (29), ˆ̄A P−→ Ā. In addition, in Section D.3 we saw σ̂1 P−→ σ and one can easily show that κ̂ P−→ κ. Thus, in order to prove the claim it suffices to show that û1 P−→ u and v̂1 P−→ v. By Wedin’s Theorem [Stewart & Sun, 1990]:\n‖û1 − u‖2 ≤ C\n∥∥∥R̂(2) −R(2)∥∥∥ 2\nσ ,\nfor some C > 0. Combining this with Lemma 4 gives that ‖û1 − u‖2 = OP (T− 1 2 ). The same argument goes for ‖v̂1 − v‖2.\nWe begin with the second term in (64). The first step is showing that the estimated parameters γ̂, β̂ in (63) converge with probability to the true parameters γ, β. We first need to following lemma, establishing the convergence of ĥ to h uniformly in probability:\nLemma 11. For any > 0,\nPr ( sup\n(γ′,β′)∈[0,2]×[0,1] ∣∣∣ĥ(γ′, β′)− h(γ′, β′)∣∣∣ > ) = o(1). Proof. Note that ĥ(γ′, β′) is the value of the minimal entry of a matrix with all entries being polynomials of γ′, β′ with bounded coefficients. Thus ĥ is Lipschitz. In addition [0, 2]× [0, 1] is compact and, similarly to Lemma 10, ĥ(γ′, β′) converges in probability pointwise to h(γ′, β′). Hence, the claim follows by Newey [1991, Corollary 2.2].\nLemma 12. (γ̂, β̂) P−→ (γ, β).\nProof. Recall that (γ̂, β̂) are the maximizers of ĥ(γ′, β′) and (γ, β) are the maximizers of h(γ′, β′), over (γ′, β′) ∈ [0, 2]× [0, 1]. To prove the claim we need to show that for any δ > 0,\nPr (∥∥∥(γ̂, β̂)− (γ, β)∥∥∥ > δ) = o(1).\nToward this end define\n(δ) ≡ h(γ, β)− max ‖(γ′,β′)−(γ,β)‖>δ\nh(γ′, β′).\nNote that (δ) > 0 since h(γ′, β′) has the unique maximum (γ, β). Now,by Lemma 11, we have that\nPr ( sup γ′,β′ ∣∣∣ĥ(γ′, β′)− h(γ′, β′)∣∣∣ > (δ)/4) = o(1). (65) Thus, if we show that sup\n∣∣∣ĥ− h∣∣∣ ≤ (δ)/4 implies ∥∥∥(γ̂, β̂)− (γ, β)∥∥∥ ≤ δ then the claim is proved. So assume\nsup γ′,β′ ∣∣∣ĥ(γ′, β′)− h(γ′, β′)∣∣∣ ≤ (δ)/4. Toward getting a contradiction let us assume that\n∥∥∥(γ̂, β̂)− (γ, β)∥∥∥ > δ. Then the following relations hold:\nh(γ̂, β̂) ≤ h(γ, β)− (δ) ĥ(γ̂, β̂) ≤ h(γ̂, β̂) + (δ)/4 ĥ(γ, β) ≥ h(γ, β)− (δ)/4.\nThus,\nĥ(γ̂, β̂) ≤ ĥ(γ, β)− (δ)/2,\nin contradiction to the optimality of (γ̂, β̂).\nBy Lemma 12, (γ̂, β̂) P−→ (γ, β). Since H is minimal, Theorem 1 implies γ > 0 and thus γ̂ ≥P γ/2. In addition, AH is continuous in the compact set [γ/2, 2]× [0, 1]. Thus, by the continuous mapping theorem we have∥∥∥AH(γ̂, β̂)−AH(γ, β)∥∥∥\nF\nP−→ 0.\nThis proves the case for the right term of (64). The convergence in probability of the left term of (64) to zero is a direct consequence of the following uniform convergence lemma:\nLemma 13.\nsup (γ′,β′)∈[ γ2 ,2]×[0,1]\n∥∥∥ÂH(γ′, β′)−AH(γ′, β′)∥∥∥ F = oP (1).\nProof. Since γ′ ≥ γ/2 we have that for any i, j ∈ [n], ÂH(γ′, β′)ij is Lipschitz. In addition, by Lemma 10, for any (γ′, β′) ∈ [γ2 , 2] × [0, 1], each entry ÂH(γ\n′, β′)ij converge pointwise in probability to AH(γ′, β′)ij . Finally, [γ2 , 2] × [0, 1] is compact. Thus, the claim follows from Newey [1991, Corollary 2.2] with an application of a union bound over i, j ∈ [n]."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "<lb>In various applications involving hidden Markov models (HMMs), some of<lb>the hidden states are aliased, having identical output distributions. The minimal-<lb>ity, identifiability and learnability of such aliased HMMs have been long standing<lb>problems, with only partial solutions provided thus far. In this paper we focus<lb>on parametric-output HMMs, whose output distributions come from a parametric<lb>family, and that have exactly two aliased states. For this class, we present a com-<lb>plete characterization of their minimality and identifiability. Furthermore, for a<lb>large family of parametric output distributions, we derive computationally efficient<lb>and statistically consistent algorithms to detect the presence of aliasing and learn<lb>the aliased HMM transition and emission parameters. We illustrate our theoretical<lb>analysis by several simulations.",
    "creator" : "TeX"
  }
}