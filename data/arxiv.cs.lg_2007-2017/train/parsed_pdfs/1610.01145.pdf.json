{
  "name" : "1610.01145.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Error bounds for approximations with deep ReLU networks",
    "authors" : [ "Dmitry Yarotsky" ],
    "emails" : [ "d.yarotsky@skoltech.ru" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Recently, multiple successful applications of deep neural networks to pattern recognition problems (Schmidhuber [2015], LeCun et al. [2015]) have revived active interest in theoretical properties of such networks, in particular their expressive power. It has been argued that deep networks may be more expressive than shallow ones of comparable size (see, e.g., Delalleau and Bengio [2011], Raghu et al. [2016], Montufar et al. [2014], Bianchini and Scarselli [2014], Telgarsky [2015]). In contrast to a shallow network, a deep one can be viewed as a long sequence of non-commutative transformations, which is a natural setting for high expressiveness (cf. the well-known Solovay-Kitaev theorem on fast approximation of arbitrary quantum operations by sequences of non-commutative gates, see Kitaev et al. [2002], Dawson and Nielsen [2006]).\nThere are various ways to characterize expressive power of networks. Delalleau and Bengio 2011 consider sum-product networks and prove for certain classes of polynomials that they are much more easily represented by deep networks than by shallow networks. Montufar\n∗Skolkovo Institute of Science and Technology, Skolkovo Innovation Center, Building 3, Moscow 143026 Russia †Institute for Information Transmission Problems, Bolshoy Karetny per. 19, build.1, Moscow 127051, Russia\nar X\niv :1\n61 0.\n01 14\n5v 3\n[ cs\n.L G\n] 1\nM ay\net al. 2014 estimate the number of linear regions in the network’s landscape. Bianchini and Scarselli 2014 give bounds for Betti numbers characterizing topological properties of functions represented by networks. Telgarsky 2015, 2016 provides specific examples of classification problems where deep networks are provably more efficient than shallow ones.\nIn the context of classification problems, a general and standard approach to characterizing expressiveness is based on the notion of the Vapnik-Chervonenkis dimension (Vapnik and Chervonenkis [2015]). There exist several bounds for VC-dimension of deep networks with piece-wise polynomial activation functions that go back to geometric techniques of Goldberg and Jerrum 1995 and earlier results of Warren 1968; see Bartlett et al. [1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]).\nA very general approach to expressiveness in the context of approximation is the method of nonlinear widths by DeVore et al. 1989 that concerns approximation of a family of functions under assumption of a continuous dependence of the model on the approximated function.\nIn this paper we examine the problem of shallow-vs-deep expressiveness from the perspective of approximation theory and general spaces of functions having derivatives up to certain order (Sobolev-type spaces). In this framework, the problem of expressiveness is very well studied in the case of shallow networks with a single hidden layer, where it is known, in particular, that to approximate a Cn-function on a d-dimensional set with infinitesimal error one needs a network of size about −d/n, assuming a smooth activation function (see, e.g., Mhaskar [1996], Pinkus [1999] for a number of related rigorous upper and lower bounds and further qualifications of this result). Much less seems to be known about deep networks in this setting, though Mhaskar et al. 2016, 2016 have recently introduced functional spaces constructed using deep dependency graphs and obtained expressiveness bounds for related deep networks.\nWe will focus our attention on networks with the ReLU activation function σ(x) = max(0, x), which, despite its utter simplicity, seems to be the most popular choice in practical applications LeCun et al. [2015]. We will consider L∞-error of approximation of functions belonging to the Sobolev spacesWn,∞([0, 1]d) (without any assumptions of hierarchical structure). We will often consider families of approximations, as the approximated function runs over the unit ball Fd,n in Wn,∞([0, 1]d). In such cases we will distinguish scenarios of fixed and adaptive network architectures. Our goal is to obtain lower and upper bounds on the expressiveness of deep and shallow networks in different scenarios. We measure complexity of networks in a conventional way, by counting the number of their weights and computation units (cf. Anthony and Bartlett [2009]).\nThe main body of the paper consists of Sections 2, 3 and 4. In Section 2 we describe our ReLU network model and show that the ReLU function is replaceable by any other continuous piece-wise linear activation function, up to constant factors in complexity asymptotics (Proposition 1).\nIn Section 3 we establish several upper bounds on the complexity of approximating by\nReLU networks, in particular showing that deep networks are quite efficient for approximating smooth functions. Specifically:\n• In Subsection 3.1 we show that the function f(x) = x2 can be -approximated by a network of depth and complexity O(ln(1/ )) (Proposition 2). This also leads to similar upper bounds on the depth and complexity that are sufficient to implement an approximate multiplication in a ReLU network (Proposition 3).\n• In Subsection 3.2 we describe a ReLU network architecture of depth O(ln(1/ )) and complexity O( −d/n ln(1/ )) that is capable of approximating with error any function from Fd,n (Theorem 1).\n• In Subsection 3.3 we show that, even with fixed-depth networks, one can further decrease the approximation complexity if the network architecture is allowed to depend on the approximated function. Specifically, we prove that one can -approximate a given Lipschitz function on the segment [0, 1] by a depth-6 ReLU network with O( 1\nln(1/ ) )\nconnections and activation units (Theorem 2). This upper bound is of interest since it lies below the lower bound provided by the method of nonlinear widths under assumption of continuous model selection (see Subsection 4.1).\nIn Section 4 we obtain several lower bounds on the complexity of approximation by deep and shallow ReLU networks, using different approaches and assumptions.\n• In Subsection 4.1 we recall the general lower bound provided by the method of continuous nonlinear widths. This method assumes that parameters of the approximation continuously depend on the approximated function, but does not assume anything about how the approximation depends on its parameters. In this setup, at least ∼ −d/n connections and weights are required for an -approximation on Fd,n (Theorem 3). As already mentioned, for d = n = 1 this lower bound is above the upper bound provided by Theorem 2.\n• In Subsection 4.2 we consider the setup where the same network architecture is used to approximate all functions in Fd,n, but the weights are not assumed to continuously depend on the function. In this case, application of existing results on VC-dimension of deep piece-wise polynomial networks yields a ∼ d/(2n) lower bound in general and a ∼ −d/n ln−2p−1(1/ ) lower bound if the network depth grows as O(lnp(1/ )) (Theorem 4).\n• In Subsection 4.3 we consider an individual approximation, without any assumptions regarding it as an element of a family as in Subsections 4.1 and 4.2. We prove that for any d, n there exists a function inWn,∞([0, 1]d) such that its approximation complexity is not o( −d/(9n)) as → 0 (Theorem 5).\n• In Subsection 4.4 we prove that -approximation of any nonlinear C2-function by a network of fixed depth L requires at least ∼ −1/(2(L−2)) computation units (Theorem 6). By comparison with Theorem 1, this shows that for sufficiently smooth functions\napproximation by fixed-depth ReLU networks is less efficient than by unbounded-depth networks.\nIn Section 5 we discuss the obtained bounds and summarize their implications, in particular comparing deep vs. shallow networks and fixed vs. adaptive architectures.\nThe arXiv preprint of the first version of the present work appeared almost simultaneously with the work of Liang and Srikant Liang and Srikant [2016] containing results partly overlapping with our results in Subsections 3.1,3.2 and 4.4. Liang and Srikant consider networks equipped with both ReLU and threshold activation functions. They prove a logarithmic upper bound for the complexity of approximating the function f(x) = x2, which is analogous to our Proposition 2. Then, they extend this upper bound to polynomials and smooth functions. In contrast to our treatment of generic smooth functions based on standard Sobolev spaces, they impose more complex assumptions on the function (including, in particular, how many derivatives it has) that depend on the required approximation accuracy . As a consequence, they obtain strong O(lnc(1/ )) complexity bounds rather different from our bound in Theorem 1 (in fact, our lower bound proved in Theorem 5 rules out, in general, such strong upper bounds for functions having only finitely many derivatives). Also, Liang and Srikant prove a lower bound for the complexity of approximating convex functions by shallow networks. Our version of this result, given in Subsection 4.4, is different in that we assume smoothness and nonlinearity instead of global convexity."
    }, {
      "heading" : "2 The ReLU network model",
      "text" : "Throughout the paper, we consider feedforward neural networks with the ReLU (Rectified Linear Unit) activation function\nσ(x) = max(0, x).\nThe network consists of several input units, one output unit, and a number of “hidden” computation units. Each hidden unit performs an operation of the form\ny = σ ( N∑\nk=1\nwkxk + b )\n(1)\nwith some weights (adjustable parameters) (wk) N k=1 and b depending on the unit. The output unit is also a computation unit, but without the nonlinearity, i.e., it computes y = ∑N k=1 wkxk + b. The units are grouped in layers, and the inputs (xk) N k=1 of a computation unit in a certain layer are outputs of some units belonging to any of the preceding layers (see Fig. 1). Note that we allow connections between units in non-neighboring layers. Occasionally, when this cannot cause confusion, we may denote the network and the function it implements by the same symbol.\nThe depth of the network, the number of units and the total number of weights are standard measures of network complexity (Anthony and Bartlett [2009]). We will use these measures throughout the paper. The number of weights is, clearly, the sum of the total number of connections and the number of computation units. We identify the depth with the number of layers (in particular, the most common type of neural networks – shallow networks having a single hidden layer – are depth-3 networks according to this convention).\nWe finish this subsection with a proposition showing that, given our complexity measures, using the ReLU activation function is not much different from using any other piece-wise linear activation function with finitely many breakpoints: one can replace one network by an equivalent one but having another activation function while only increasing the number of units and weights by constant factors. This justifies our restricted attention to the ReLU networks (which could otherwise have been perceived as an excessively particular example of networks).\nProposition 1. Let ρ : R→ R be any continuous piece-wise linear function with M breakpoints, where 1 ≤M <∞.\na) Let ξ be a network with the activation function ρ, having depth L, W weights and U computation units. Then there exists a ReLU network η that has depth L, not more than (M + 1)2W weights and not more than (M + 1)U units, and that computes the same function as ξ.\nb) Conversely, let η be a ReLU network of depth L with W weights and U computation units. Let D be a bounded subset of Rn, where n is the input dimension of η. Then there exists a network with the activation function ρ that has depth L, 4W weights and 2U units, and that computes the same function as η on the set D.\nProof. a) Let a1 < . . . < aM be the breakpoints of ρ, i.e., the points where its derivative is discontinuous: ρ′(ak+) 6= ρ′(ak−). We can then express ρ via the ReLU function σ, as a linear combination\nρ(x) = c0σ(a1 − x) + M∑\nm=1\ncmσ(x− am) + h\nwith appropriately chosen coefficients (cm) M m=0 and h. It follows that computation performed by a single ρ-unit,\nx1, . . . , xN 7→ ρ ( N∑\nk=1\nwkxk + b ) ,\ncan be equivalently represented by a linear combination of a constant function and computations of M + 1 σ-units,\nx1, . . . , xN 7→    σ (∑N k=1 wkxk + b− am ) , m = 1, . . . ,M, σ ( a1 − b− ∑N k=1wkxk), m = 0\n(here m is the index of a ρ-unit). We can then replace one-by-one all the ρ-units in the network ξ by σ-units, without changing the output of the network. Obviously, these replacements do not change the network depth. Since each hidden unit gets replaced by M + 1 new units, the number of units in the new network is not greater than M + 1 times their number in the original network. Note also that the number of connections in the network is multiplied, at most, by (M + 1)2. Indeed, each unit replacement entails replacing each of the incoming and outgoing connections of this unit by M + 1 new connections, and each connection is replaced twice: as an incoming and as an outgoing one. These considerations imply the claimed complexity bounds for the resulting σ-network η.\nb) Let a be any breakpoint of ρ, so that ρ′(a+) 6= ρ′(a−). Let r0 be the distance separating a from the nearest other breakpoint, so that ρ is linear on [a, a + r0] and on [a − r0, a] (if ρ has only one node, any r0 > 0 will do). Then, for any r > 0, we can express the ReLU function σ via ρ in the r-neighborhood of 0:\nσ(x) = ρ ( a+ r0 2r x ) − ρ ( a− r0 2 + r0 2r x ) − ρ(a) + ρ ( a− r0 2 ) ( ρ′(a+)− ρ′(a−) ) r0 2r , x ∈ [−r, r].\nIt follows that a computation performed by a single σ-unit,\nx1, . . . , xN 7→ σ ( N∑\nk=1\nwkxk + b ) ,\ncan be equivalently represented by a linear combination of a constant function and two ρ-units,\nx1, . . . , xN 7→    ρ ( a+ r0 2r b+ r0 2r ∑N k=1wkxk ) , ρ ( a− r0\n2 + r0 2r b+ r0 2r ∑N k=1wkxk ) ,\nprovided the condition N∑\nk=1\nwkxk + b ∈ [−r, r] (2)\nholds. Since D is a bounded set, we can choose r at each unit of the initial network η sufficiently large so as to satisfy condition (2) for all network inputs from D. Then, like in a), we replace each σ-unit with two ρ-units, which produces the desired ρ-network."
    }, {
      "heading" : "3 Upper bounds",
      "text" : "Throughout the paper, we will be interested in approximating functions f : [0, 1]d → R by ReLU networks. Given a function f : [0, 1]d → R and its approximation f̃ , by the approximation error we will always mean the uniform maximum error\n‖f − f̃‖∞ = max x∈[0,1]d |f(x)− f̃(x)|."
    }, {
      "heading" : "3.1 Fast deep approximation of squaring and multiplication",
      "text" : "Our first key result shows that ReLU networks with unconstrained depth can very efficiently approximate the function f(x) = x2 (more efficiently than any fixed-depth network, as we will see in Section 4.4). Our construction uses the “sawtooth” function that has previously appeared in the paper Telgarsky [2015].\nProposition 2. The function f(x) = x2 on the segment [0, 1] can be approximated with any error > 0 by a ReLU network having the depth and the number of weights and computation units O(ln(1/ )).\nProof. Consider the “tooth” (or “mirror”) function g : [0, 1]→ [0, 1],\ng(x) =\n{ 2x, x < 1\n2 ,\n2(1− x), x ≥ 1 2 ,\nand the iterated functions gs(x) = g ◦ g ◦ · · · ◦ g︸ ︷︷ ︸\ns\n(x).\nTelgarsky has shown (see Lemma 2.4 in Telgarsky [2015]) that gs is a “sawtooth” function with 2s−1 uniformly distributed “teeth” (each application of g doubles the number of teeth):\ngs(x) =\n{ 2s ( x− 2k\n2s\n) , x ∈ [ 2k 2s , 2k+1 2s ], k = 0, 1, . . . , 2s−1 − 1,\n2s ( 2k 2s − x ) , x ∈ [ 2k−1 2s , 2k 2s ], k = 1, 2, . . . , 2s−1,\n(see Fig. 2a). Our key observation now is that the function f(x) = x2 can be approximated by linear combinations of the functions gs. Namely, let fm be the piece-wise linear interpolation of f with 2m + 1 uniformly distributed breakpoints k\n2m , k = 0, . . . , 2m:\nfm ( k 2m ) = ( k 2m )2 , k = 0, . . . , 2m\n(see Fig. 2b). The function fm approximates f with the error m = 2 −2m−2. Now note that refining the interpolation from fm−1 to fm amounts to adjusting it by a function proportional to a sawtooth function:\nfm−1(x)− fm(x) = gm(x)\n22m .\nHence\nfm(x) = x− m∑\ns=1\ngs(x)\n22s .\nSince g can be implemented by a finite ReLU network (as g(x) = 2σ(x)−4σ ( x− 1\n2\n) +2σ(x−1))\nand since construction of fm only involves O(m) linear operations and compositions of g, we can implement fm by a ReLU network having depth and the number of weights and computation units all being O(m) (see Fig. 2c). This implies the claim of the proposition.\nSince\nxy = 1\n2 ((x+ y)2 − x2 − y2), (3)\nwe can use Proposition 2 to efficiently implement accurate multiplication in a ReLU network. The implementation will depend on the required accuracy and the magnitude of the multiplied quantities.\nProposition 3. Given M > 0 and ∈ (0, 1), there is a ReLU network η with two input units that implements a function ×̃ : R2 → R so that\na) for any inputs x, y, if |x| ≤M and |y| ≤M, then |×̃(x, y)− xy| ≤ ;\nb) if x = 0 or y = 0, then ×̃(x, y) = 0;\nc) the depth and the number of weights and computation units in η is not greater than c1 ln(1/ ) + c2 with an absolute constant c1 and a constant c2 = c2(M).\nProof. Let f̃sq,δ be the approximate squaring function from Proposition 2 such that f̃sq,δ(0) = 0 and |f̃sq,δ(x) − x2| < δ for x ∈ [0, 1]. Assume without loss of generality that M ≥ 1 and set\n×̃(x, y) = M 2\n8\n( f̃sq,δ ( |x+ y| 2M ) − f̃sq,δ ( |x| 2M ) − f̃sq,δ ( |y| 2M )) , (4)\nwhere δ = 8 3M2 . Then property b) is immediate and a) follows easily using expansion (3). To conclude c), observe that computation (4) consists of three instances of f̃sq,δ and finitely many linear and ReLU operations, so, using Proposition 2, we can implement ×̃ by a ReLU network such that its depth and the number of computation units and weights are O(ln(1/δ)), i.e. are O(ln(1/ ) + lnM)."
    }, {
      "heading" : "3.2 Fast deep approximation of general smooth functions",
      "text" : "In order to formulate our general result, Theorem 1, we consider the Sobolev spaces Wn,∞([0, 1]d) with n = 1, 2, . . . Recall that Wn,∞([0, 1]d) is defined as the space of functions on [0, 1]d lying in L∞ along with their weak derivatives up to order n. The norm in Wn,∞([0, 1]d) can be defined by\n‖f‖Wn,∞([0,1]d) = max n:|n|≤n ess sup x∈[0,1]d |Dnf(x)|,\nwhere n = (n1, . . . , nd) ∈ {0, 1, . . .}d, |n| = n1 + . . . + nd, and Dnf is the respective weak derivative. Here and in the sequel we denote vectors by boldface characters. The space Wn,∞([0, 1]d) can be equivalently described as consisting of the functions from Cn−1([0, 1]d) such that all their derivatives of order n− 1 are Lipschitz continuous.\nThroughout the paper, we denote by Fn,d the unit ball in Wn,∞([0, 1]d):\nFn,d = {f ∈ Wn,∞([0, 1]d) : ‖f‖Wn,∞([0,1]d) ≤ 1}.\nAlso, it will now be convenient to make a distinction between networks and network architectures : we define the latter as the former with unspecified weights. We say that a network architecture is capable of expressing any function from Fd,n with error meaning that this can be achieved by some weight assignment.\nTheorem 1. For any d, n and ∈ (0, 1), there is a ReLU network architecture that\n1. is capable of expressing any function from Fd,n with error ;\n2. has the depth at most c(ln(1/ ) + 1) and at most c −d/n(ln(1/ ) + 1) weights and computation units, with some constant c = c(d, n).\nProof. The proof will consist of two steps. We start with approximating f by a sum-product combination f1 of local Taylor polynomials and one-dimensional piecewise-linear functions. After that, we will use results of the previous section to approximate f1 by a neural network.\nLet N be a positive integer. Consider a partition of unity formed by a grid of (N + 1)d\nfunctions φm on the domain [0, 1] d: ∑\nm\nφm(x) ≡ 1, x ∈ [0, 1]d.\nHere m = (m1, . . . ,md) ∈ {0, 1, . . . , N}d, and the function φm is defined as the product\nφm(x) = d∏\nk=1\nψ ( 3N ( xk −\nmk N\n)) , (5)\nwhere\nψ(x) =    1, |x| < 1, 0, 2 < |x|, 2− |x|, 1 ≤ |x| ≤ 2\n(see Fig. 3). Note that ‖ψ‖∞ = 1 and ‖φm‖∞ = 1 ∀m (6)\nand\nsuppφm ⊂ { x : ∣∣∣xk −\nmk N ∣∣∣ < 1 N ∀k } . (7)\nFor any m ∈ {0, . . . , N}d, consider the degree-(n− 1) Taylor polynomial for the function f at x = m\nN :\nPm(x) = ∑\nn:|n|<n\nDnf\nn! ∣∣∣∣ x=m\nN\n( x− m\nN\n)n , (8)\nwith the usual conventions n! = ∏d k=1 nk! and (x− mN )n = ∏d\nk=1(xk − mkN )nk . Now define an approximation to f by\nf1 = ∑\nm∈{0,...,N}d φmPm. (9)\nWe bound the approximation error using the Taylor expansion of f :\n|f(x)− f1(x)| = ∣∣∣ ∑\nm\nφm(x)(f(x)− Pm(x)) ∣∣∣\n≤ ∑\nm:|xk− mk N |< 1 N ∀k\n|f(x)− Pm(x)|\n≤ 2d max m:|xk− mk N |< 1 N ∀k |f(x)− Pm(x)| ≤ 2 ddn\nn! ( 1 N )n max n:|n|=n ess sup x∈[0,1]d |Dnf(x)|\n≤ 2 ddn\nn! ( 1 N )n .\nHere in the second step we used the support property (7) and the bound (6), in the third the observation that any x ∈ [0, 1]d belongs to the support of at most 2d functions φm, in the fourth a standard bound for the Taylor remainder, and in the fifth the property ‖f‖Wn,∞([0,1]d) ≤ 1.\nIt follows that if we choose\nN = ⌈( n!\n2ddn 2\n)−1/n⌉ (10)\n(where d·e is the ceiling function), then\n‖f − f1‖∞ ≤\n2 . (11)\nNote that, by (8) the coefficients of the polynomials Pm are uniformly bounded for all f ∈ Fd,n:\nPm(x) = ∑\nn:|n|<n\nam,n\n( x− m\nN\n)n , |am,n| ≤ 1. (12)\nWe have therefore reduced our task to the following: construct a network architecture capable of approximating with uniform error\n2 any function of the form (9), assuming that\nN is given by (10) and the polynomials Pm are of the form (12). Expand f1 as\nf1(x) = ∑\nm∈{0,...,N}d\n∑\nn:|n|<n\nam,nφm(x) ( x− m\nN\n)n . (13)\nThe expansion is a linear combination of not more than dn(N + 1)d terms φm(x)(x− mN )n. Each of these terms is a product of at most d+ n− 1 piece-wise linear univariate factors: d functions ψ(3Nxk − 3mk) (see (5)) and at most n − 1 linear expressions xk − mkN . We can implement an approximation of this product by a neural network with the help of Proposition 3. Specifically, let ×̃ be the approximate multiplication from Proposition 3 for M = d + n\nand some accuracy δ to be chosen later, and consider the approximation of the product φm(x)(x− mN )n obtained by the chained application of ×̃:\nf̃m,n(x) = ×̃ ( ψ(3Nx1 − 3m1), ×̃ ( ψ(3Nx2 − 3m2), . . . , ×̃ ( xk − mkN , . . . ) . . . )) . (14)\nthat Using statement c) of Proposition 3, we see f̃m,n can be implemented by a ReLU network with the depth and the number of weights and computation units not larger than (d+ n)c1 ln(1/δ), for some constant c1 = c1(d, n).\nNow we estimate the error of this approximation. Note that we have |ψ(3Nxk−3mk)| ≤ 1 and |xk − mkN | ≤ 1 for all k and all x ∈ [0, 1]d. By statement a) of Proposition 3, if |a| ≤ 1 and |b| ≤ M , then |×̃(a, b)| ≤ |b| + δ. Repeatedly applying this observation to all approximate multiplications in (14) while assuming δ < 1, we see that the arguments of all these multiplications are bounded by our M (equal to d + n) and the statement a) of Proposition 3 holds for each of them. We then have\n∣∣f̃m,n(x)−φm(x) ( x− m\nN )n∣∣ = ∣∣×̃ ( ψ(3Nx1 − 3m1), ×̃ ( ψ(3Nx2 − 3m2), ×̃ ( ψ(3Nx3 − 3m3), . . . )))\n− ψ(3Nx1 − 3m1)ψ(3Nx2 − 3m2)ψ(3Nx3 − 3m3) . . . ∣∣\n≤ ∣∣×̃ ( ψ(3Nx1 − 3m1), ×̃ ( ψ(3Nx2 − 3m2), ×̃ ( ψ(3Nx3 − 3m3), . . . )))\n− ψ(3Nx1 − 3m1) · ×̃ ( ψ(3Nx2 − 3m2), ×̃ ( ψ(3Nx3 − 3m3), . . . ))∣∣ + |ψ(3Nx1 − 3m1)| · ∣∣×̃ ( ψ(3Nx2 − 3m2), ×̃ ( ψ(3Nx3 − 3m3), . . . )) − ψ(3Nx2 − 3m2) · ×̃ ( ψ(3Nx3 − 3m3), . . .\n)∣∣ + . . .\n≤(d+ n)δ.\n(15)\nMoreover, by statement b) of Proposition 3,\nf̃m,n(x) = φm(x) ( x− m\nN\n)n , x /∈ suppφm. (16)\nNow we define the full approximation by\nf̃ = ∑\nm∈{0,...,N}d\n∑\nn:|n|<n\nam,nf̃m,n. (17)\nWe estimate the approximation error of f̃ :\n|f̃(x)− f1(x)| = ∣∣∣∣\n∑\nm∈{0,...,N}d\n∑\nn:|n|<n\nam,n ( f̃m,n(x)− φm(x) ( x− m\nN )n) ∣∣∣∣\n= ∣∣∣∣ ∑\nm:x∈suppφm\n∑\nn:|n|<n\nam,n ( f̃m,n(x)− φm(x) ( x− m\nN )n) ∣∣∣∣\n≤ 2d max m:x∈suppφm\n∑\nn:|n|<n\n∣∣∣f̃m,n(x)− φm(x) ( x− m\nN\n)n∣∣∣\n≤ 2ddn(d+ n)δ,\nwhere in the first step we use expansion (13), in the second the identity (16), in the third the bound |am,n| ≤ 1 and the fact that x ∈ suppφm for at most 2d functions φm, and in the fourth the bound (15). It follows that if we choose\nδ = 2d+1dn(d+ n) , (18)\nthen ‖f̃ − f1‖∞ ≤ 2 and hence, by (11),\n‖f̃ − f‖∞ ≤ ‖f̃ − f1‖∞ + ‖f1 − f‖∞ ≤\n2 + 2 ≤ .\nOn the other hand, note that by (17), f̃ can be implemented by a network consisting of\nparallel subnetworks that compute each of f̃m,n; the final output is obtained by weighting the outputs of the subnetworks with the weights am,n. The architecture of the full network does not depend on f ; only the weights am,n do. As already shown, each of these subnetworks has not more than c1 ln(1/δ) layers, weights and computation units, with some constant c1 = c1(d, n). There are not more than d n(N + 1)d such subnetworks. Therefore, the full network for f̃ has not more than c1 ln(1/δ) + 1 layers and d n(N + 1)d(c1 ln(1/δ) + 1) weights and computation units. With δ given by (18) and N given by (10), we obtain the claimed complexity bounds."
    }, {
      "heading" : "3.3 Faster approximations using adaptive network architectures",
      "text" : "Theorem 1 provides an upper bound for the approximation complexity in the case when the same network architecture is used to approximate all functions in Fd,n. We can consider an alternative, “adaptive architecture” scenario where not only the weights, but also the architecture is adjusted to the approximated function. We expect, of course, that this would decrease the complexity of the resulting architectures, in general (at the price of needing to find the appropriate architecture). In this section we show that we can indeed obtain better upper bounds in this scenario.\nFor simplicity, we will only consider the case d = n = 1. Then, Wn,∞([0, 1]d) is the space of Lipschitz functions on the segment [0, 1]. The set F1,1 consists of functions f having both ‖f‖∞ and the Lipschitz constant bounded by 1. Theorem 1 provides an upper bound O( ln(1/ ) ) for the number of weights and computation units, but in this special case there is in fact a better bound O(1 ) obtained simply by piece-wise interpolation.\nNamely, given f ∈ F1,1 and > 0, set T = d1 e and let f̃ be the piece-wise interpolation of f with T + 1 uniformly spaced breakpoints ( t\nT )Tt=0 (i.e., f̃( t T ) = f( t T ), t = 0, . . . , T ). The\nfunction f̃ is also Lipschitz with constant 1 and hence ‖f − f̃‖∞ ≤ 1T ≤ (since for any x ∈ [0, 1] we can find t such that |x − t\nT | ≤ 1 2T and then |f(x) − f̃(x)| ≤ |f(x) − f( t T )| +\n|f̃( t T )− f̃(x)| ≤ 2 · 1 2T = 1 T\n). At the same time, the function f̃ can be expressed in terms of the ReLU function σ by\nf̃(x) = b+ T−1∑\nt=0\nwtσ ( x− t\nT\n)\nwith some coefficients b and (wt) T−1 t=0 . This expression can be viewed as a special case of the depth-3 ReLU network with O(1 ) weights and computation units.\nWe show now how the bound O(1 ) can be improved by using adaptive architectures.\nTheorem 2. For any f ∈ F1,1 and ∈ (0, 12), there exists a depth-6 ReLU network η (with architecture depending on f) that provides an -approximation of f while having not more than c\nln(1/ ) weights, connections and computation units. Here c is an absolute constant.\nProof. We first explain the idea of the proof. We start with interpolating f by a piece-wise linear function, but not on the length scale – instead, we do it on a coarser length scale m , with some m = m( ) > 1. We then create a “cache” of auxiliary subnetworks that we use to fill in the details and go down to the scale , in each of the m -subintervals. This allows us to reduce the amount of computations for small because the complexity of the cache only depends on m. The assignment of cached subnetworks to the subintervals is encoded in the network architecture and depends on the function f . We optimize m by balancing the complexity of the cache with that of the initial coarse approximation. This leads to m ∼ ln(1/ ) and hence to the reduction of the total complexity of the network by a factor ∼ ln(1/ ) compared to the simple piece-wise linear approximation on the scale . This construction is inspired by a similar argument used to prove the O(2n/n) upper bound for the complexity of Boolean circuits implementing n-ary functions Shannon [1949].\nThe proof becomes simpler if, in addition to the ReLU function σ, we are allowed to use the activation function\nρ(x) = { x, x ∈ [0, 1), 0, x /∈ [0, 1) (19)\nin our neural network. Since ρ is discontinuous, we cannot just use Proposition 1 to replace ρ-units by σ-units. We will first prove the analog of the claimed result for the model including ρ-units, and then we will show how to construct a purely ReLU nework.\nLemma 1. For any f ∈ F1,1 and ∈ (0, 12), there exists a depth-5 network including σunits and ρ-units, that provides an -approximation of f while having not more than c\nln(1/ )\nweights, where c is an absolute constant.\nProof. Given f ∈ F1,1, we will construct an approximation f̃ to f in the form\nf̃ = f̃1 + f̃2.\nHere, f̃1 is the piece-wise linear interpolation of f with the breakpoints { tT }Tt=0, for some positive integer T to be chosen later. Since f is Lipschitz with constant 1, f̃1 is also Lipschitz with constant 1. We will denote by It the intervals between the breakpoints:\nIt = [ t T , t+ 1 T ) , t = 0, . . . , T − 1.\nWe will now construct f̃2 as an approximation to the difference\nf2 = f − f̃1. (20)\nNote that f2 vanishes at the endpoints of the intervals It:\nf2 ( t T ) = 0, t = 0, . . . , T, (21)\nand f2 is Lipschitz with constant 2:\n|f2(x1)− f2(x2)| ≤ 2|x1 − x2|, (22)\nsince f and f̃1 are Lipschitz with constant 1. To define f̃2, we first construct a set Γ of cached functions. Let m be a positive integer to be chosen later. Let Γ be the set of piecewise linear functions γ : [0, 1] → R with the breakpoints { r\nm }mr=0 and the properties\nγ(0) = γ(1) = 0\nand\nγ ( r m ) − γ (r − 1 m ) ∈ { − 2 m , 0, 2 m } , r = 1, . . . ,m.\nNote that the size |Γ| of Γ is not larger than 3m. If g : [0, 1] → R is any Lipschitz function with constant 2 and g(0) = g(1) = 0, then g can be approximated by some γ ∈ Γ with error not larger than 2 m : namely, take γ( r m\n) = 2 m bg( r m )/ 2 m c.\nMoreover, if f2 is defined by (20), then, using (21), (22), on each interval It the function f2 can be approximated with error not larger than 2 Tm\nby a properly rescaled function γ ∈ Γ. Namely, for each t = 0, . . . , T − 1 we can define the function g by g(y) = Tf2( t+yT ). Then it is Lipschitz with constant 2 and g(0) = g(1) = 0, so we can find γt ∈ Γ such that\nsup y∈[0,1)\n∣∣∣Tf2 (t+ y\nT\n) − γt(y) ∣∣∣ ≤ 2 m .\nThis can be equivalently written as\nsup x∈It\n∣∣∣f2(x)− 1\nT γt(Tx− t) ∣∣∣ ≤ 2 Tm .\nNote that the obtained assignment t 7→ γt is not injective, in general (T will be much larger than |Γ|).\nWe can then define f̃2 on the whole [0, 1) by\nf̃2(x) = 1\nT γt(Tx− t), x ∈ It, t = 0, . . . , T − 1. (23)\nThis f̃2 approximates f2 with error 2 Tm on [0, 1):\nsup x∈[0,1)\n|f2(x)− f̃2(x)| ≤ 2\nTm , (24)\nand hence, by (20), for the full approximation f̃ = f̃1 + f̃2 we will also have\nsup x∈[0,1) |f(x)− f̃(x)| ≤ 2 Tm . (25)\nNote that the approximation f̃2 has properties analogous to (21), (22):\nf̃2 ( t T ) = 0, t = 0, . . . , T, (26)\n|f̃2(x1)− f̃2(x2)| ≤ 2|x1 − x2|, (27) in particular, f̃2 is continuous on [0, 1).\nWe will now rewrite f̃2 in a different form interpretable as a computation by a neural network. Specifically, using our additional activation function ρ given by (19), we can express\nf̃2 as\nf̃2(x) = 1\nT\n∑\nγ∈Γ\nγ ( ∑\nt:γt=γ\nρ(Tx− t) ) . (28)\nIndeed, given x ∈ [0, 1), observe that all the terms in the inner sum vanish except for the one corresponding to the t determined by the condition x ∈ It. For this particular t we have ρ(Tx− t) = Tx− t. Since γ(0) = 0, we conclude that (28) agrees with (23).\nLet us also expand γ ∈ Γ over the basis of shifted ReLU functions:\nγ(x) = m−1∑\nr=0\ncγ,rσ ( x− r\nm\n) , x ∈ [0, 1].\nSubstituting this expansion in (28), we finally obtain\nf̃2(x) = 1\nT\n∑\nγ∈Γ\nm−1∑\nr=0\ncγ,rσ ( ∑\nt:γt=γ\nρ(Tx− t)− r m\n) . (29)\nNow consider the implementation of f̃ by a neural nework. The term f̃1 can clearly be implemented by a depth-3 ReLU network using O(T ) connections and computation units.\nThe term f̃2 can be implemented by a depth-5 network with ρ- and σ-units as follows (we denote a computation unit by Q with a superscript indexing the layer and a subscript indexing the unit within the layer).\n1. The first layer contains the single input unit Q(1).\n2. The second layer contains T units (Q (2) t ) T t=1 computing Q (2) t = ρ(TQ (1) − t). 3. The third layer contains |Γ| units (Q(3)γ )γ∈Γ computing Q(3)γ = σ( ∑\nt:γt=γ Q (2) t ). This is\nequivalent to Q (3) γ = ∑ t:γt=γ Q (2) t , because Q (2) t ≥ 0.\n4. The fourth layer contains m|Γ| units (Q(4)γ,r) γ∈Γ r=0,...,m−1 computing Q (4) γ,r = σ(Q (3) γ − rm). 5. The final layer consists of a single output unit Q(5) = ∑ γ∈Γ ∑m−1 r=0 cγ,r T Q (4) γ,r.\nExamining this network, we see that the total number of connections and units in it is O(T + m|Γ|) and hence is O(T + m3m). This also holds for the full network implementing f̃ = f̃1 + f̃2, since the term f̃1 requires even fewer layers, connections and units. The output units of the subnetworks for f̃1 and f̃2 can be merged into the output unit for f̃1 + f̃2, so the depth of the full network is the maximum of the depths of the networks implementing f̃1 and f̃2, i.e., is 5 (see Fig. 4).\nNow, given ∈ (0, 1 2 ), take m = d1 2 log3(1/ )e and T = d 2m e. Then, by (25), the approximation error maxx∈[0,1] |f(x)− f̃(x)| ≤ 2Tm ≤ , while T + m3m = O( 1 ln(1/ )), which implies the claimed complexity bound.\nWe show now how to modify the constructed network so as to remove ρ-units. We only need to modify the f̃2 part of the network. We will show that for any δ > 0 we can replace f̃2 with a function f̃3,δ (defined below) that\na) obeys the following analog of approximation bound (24):\nsup x∈[0,1]\n|f2(x)− f̃3,δ(x)| ≤ 8δ\nT +\n2\nTm , (30)\nb) and is implementable by a depth-6 ReLU network having complexity c(T +m3m) with an absolute constant c independent of δ.\nSince δ can be taken arbitrarily small, the Theorem then follows by arguing as in Lemma 1, only with f̃2 replaced by f̃3,δ.\nAs a first step, we approximate ρ by a continuous piece-wise linear function ρδ, with a small δ > 0:\nρ(y) =    y, y ∈ [0, 1− δ), 1−δ δ\n(1− y), y ∈ [1− δ, 1), 0, y /∈ [0, 1).\nLet f̃2,δ be defined as f̃2 in (29), but with ρ replaced by ρδ:\nf̃2,δ(x) = 1\nT\n∑\nγ∈Γ\nm−1∑\nr=0\ncγ,rσ ( ∑\nt:γt=γ\nρδ(Tx− t)− r\nm\n) .\nSince ρδ is a continuous piece-wise linear function with three breakpoints, we can express it via the ReLU function, and hence implement f̃2,δ by a purely ReLU network, as in Proposition 1, and the complexity of the implementation does not depend on δ. However, replacing ρ with ρδ affects the function f̃2 on the intervals ( t−δ T , t T ], t = 1, . . . , T , introducing there a large error (of magnitude O( 1 T )). But recall that both f2 and f̃2 vanish at the points t T , t = 0, . . . , T, by (21), (26). We can then largely remove this newly introduced error by simply suppressing f̃2,δ near the points t T\n. Precisely, consider the continuous piece-wise linear function\nφδ(y) =    0, y /∈ [0, 1− δ), y δ , y ∈ [0, δ),\n1, y ∈ [δ, 1− 2δ), 1−δ−y δ , y ∈ [1− 2δ, 1− δ)\nand the full comb-like filtering function\nΦδ(x) = T−1∑\nt=0\nφδ(Tx− t).\nNote that Φδ is continuous piece-wise linear with 4T breakpoints, and 0 ≤ Φδ(x) ≤ 1. We then define our final modification of f̃2 as\nf̃3,δ(x) = σ ( f̃2,δ(x) + 2Φδ(x)− 1 ) − σ ( 2Φδ(x)− 1 ) . (31)\nLemma 2. The function f̃3,δ obeys the bound (30).\nProof. Given x ∈ [0, 1), let t ∈ {0, . . . , T − 1} and y ∈ [0, 1) be determined from the representation x = t+y\nT (i.e., y is the relative position of x in the respective interval It).\nConsider several possibilities for y:\n1. y ∈ [1− δ, 1]. In this case Φδ(x) = 0. Note that\nsup x∈[0,1]\n|f̃2,δ(x)| ≤ 1, (32)\nbecause, by construction, supx∈[0,1] |f̃2,δ(x)| ≤ supx∈[0,1] |f̃2(x)|, and supx∈[0,1] |f̃2(x)| ≤ 1 by (26), (27). It follows that both terms in (31) vanish, i.e., f̃3,δ(x) = 0. But, since f2 is Lipschitz with constant 2 by (22) and f2( t+1 T\n) = 0, we have |f2(x)| ≤ |f2(x)−f2( t+1T )| ≤ 2|y−1| T ≤ 2δ T . This implies |f2(x)− f̃3,δ(x)| ≤ 2δT .\n2. y ∈ [δ, 1 − 2δ]. In this case Φδ(x) = 1 and f̃2,δ(x) = f̃2(x). Using (32), we find that f̃3,δ(x) = f̃2,δ(x) = f̃2(x). It follows that |f2(x)− f̃3,δ(x)| = |f2(x)− f̃2(x)| ≤ 2Tm .\n3. y ∈ [0, δ]∪ [1−2δ, 1−δ]. In this case f̃2,δ(x) = f̃2(x). Since σ is Lipschitz with constant 1, |f̃3,δ(x)| ≤ |f̃2,δ(x)| = |f̃2(x)|. Both f2 and f̃2 are Lipschitz with constant 2 (by (22), (27)) and vanish at t\nT and t+1 T (by (21), (26)). It follows that\n|f2(x)− f̃3,δ(x)| ≤ |f2(x)|+ |f̃2(x)| ≤ 2 { 2|x− t T |, y ∈ [0, δ]\n2|x− t+1 T |, y ∈ [1− 2δ, 1− δ] ≤\n8δ T .\nIt remains to verify the complexity property b) of the function f̃3,δ. As already mentioned, f̃2,δ can be implemented by a depth-5 purely ReLU network with not more than c(T +m3 m) weights, connections and computation units, where c is an absolute constant independent of δ. The function Φδ can be implemented by a shallow, depth-3 network with O(T ) units and connection. Then, computation of f̃3,δ can be implemented by a network including two subnetworks for computing f̃2,δ and Ψδ, and an additional layer containing two σ-units as written in (31). We thus obtain 6 layers in the resulting full network and, choosing T and m in the same way as in Lemma 1, obtain the bound c\nln(1/ ) for the number of its connections,\nweights, and computation units."
    }, {
      "heading" : "4 Lower bounds",
      "text" : ""
    }, {
      "heading" : "4.1 Continuous nonlinear widths",
      "text" : "The method of continuous nonlinear widths (DeVore et al. [1989]) is a very general approach to the analysis of parameterized nonlinear approximations, based on the assumption of continuous selection of their parameters. We are interested in the following lower bound for the complexity of approximations in Wn,∞([0, 1]d).\nTheorem 3 (DeVore et al. [1989], Theorem 4.2). Fix d, n. Let W be a positive integer and η : RW → C([0, 1]d) be any mapping between the space RW and the space C([0, 1]d). Suppose that there is a continuous map M : Fd,n → RW such that ‖f − η(M(f))‖∞ ≤ for all f ∈ Fd,n. Then W ≥ c −d/n, with some constant c depending only on n.\nWe apply this theorem by taking η to be some ReLU network architecture, and RW the corresponding weight space. It follows that if a ReLU network architecture is capable of expressing any function from Fd,n with error , then, under the hypothesis of continuous weight selection, the network must have at least c −d/n weights. The number of connections is then lower bounded by c\n2 −d/n (since the number of weights is not larger than the sum of\nthe number of computation units and the number of connections, and there are at least as many connections as units).\nThe hypothesis of continuous weight selection is crucial in Theorem 3. By examining our proof of the counterpart upper bound O( −d/n ln(1/ )) in Theorem 1, the weights are selected there in a continuous manner, so this upper bound asymptotically lies above c −d/n in agreement with Theorem 3. We remark, however, that the optimal choice of the network weights (minimizing the error) is known to be discontinuous in general, even for shallow networks (Kainen et al. [1999]).\nWe also compare the bounds of Theorems 3 and 2. In the case d = n = 1, Theorem 3 provides a lower bound c for the number of weights and connections. On the other hand, in the adaptive architecture scenario, Theorem 2 provides the upper bound c ln(1/ )\nfor the number of weights, connections and computation units. The fact that this latter bound is asymptotically below the bound of Theorem 3 reflects the extra expressiveness associated with variable network architecture."
    }, {
      "heading" : "4.2 Bounds based on VC-dimension",
      "text" : "In this section we consider the setup where the same network architecture is used to approximate all functions f ∈ Fd,n, but the dependence of the weights on f is not assumed to be necessarily continuous. In this setup, some lower bounds on the network complexity can be obtained as a consequence of existing upper bounds on VC-dimension of networks with piece-wise polynomial activation functions and Boolean outputs (Anthony and Bartlett [2009]). In the next theorem, part a) is a more general but weaker bound, while part b) is a stronger bound assuming a constrained growth of the network depth.\nTheorem 4. Fix d, n.\na) For any ∈ (0, 1), a ReLU network architecture capable of approximating any function f ∈ Fd,n with error must have at least c −d/(2n) weights, with some constant c = c(d, n) > 0.\nb) Let p ≥ 0, c1 > 0 be some constants. For any ∈ (0, 12), if a ReLU network architecture of depth L ≤ c1 lnp(1/ ) is capable of approximating any function f ∈ Fd,n with error\n, then the network must have at least c2 −d/n ln−2p−1(1/ ) weights, with some constant\nc2 = c2(d, n, p, c1) > 0. 1\nProof. Recall that given a class H of Boolean functions on [0, 1]d, the VC-dimension of H is defined as the size of the largest shattered subset S ⊂ [0, 1]d, i.e. the largest subset on which H can compute any dichotomy (see, e.g., Anthony and Bartlett [2009], Section 3.3). We are interested in the case when H is the family of functions obtained by applying thresholds 1(x > a) to a ReLU network with fixed architecture but variable weights. In this case Theorem 8.7 of Anthony and Bartlett [2009] implies that\nVCdim(H) ≤ c3W 2, (33)\nand Theorem 8.8 implies that\nVCdim(H) ≤ c3L2W lnW, (34)\nwhere W is the number of weights, L is the network depth, and c3 is an absolute constant. Given a positive integer N to be chosen later, choose S as a set of Nd points x1, . . . ,xNd in the cube [0, 1]d such that the distance between any two of them is not less than 1 N\n. Given any assignment of values y1, . . . , yNd ∈ R, we can construct a smooth function f satisfying f(xm) = ym for all m by setting\nf(x) = Nd∑\nm=1\nymφ(N(x− xm)), (35)\nwith some C∞ function φ : Rd → R such that φ(0) = 1 and φ(x) = 0 if |x| > 1 2 .\nLet us obtain a condition ensuring that such f ∈ Fd,n. For any multi-index n,\nmax x |Dnf(x)| = N |n|max m |ym|max x |Dnφ(x)|,\nso if max m |ym| ≤ c4N−n, (36) with the constant c4 = (maxn:|n|≤n maxx |Dnφ(x)|)−1, then f ∈ Fd,n. Now set\n= c4 3 N−n. (37)\nSuppose that there is a ReLU network architecture η that can approximate, by adjusting its weights, any f ∈ Fd,n with error less than . Denote by η(x,w) the output of the network for the input vector x and the vector of weights w.\nConsider any assignment z of Boolean values z1, . . . , zNd ∈ {0, 1}. Set\nym = zmc4N −n, m = 1, . . . , Nd,\nand let f be given by (35) (see Fig. 5); then (36) holds and hence f ∈ Fd,n. By assumption, 1The author thanks Matus Telgarsky for suggesting this part of the theorem.\nthere is then a vector of weights, w = wz, such that for all m we have |η(xm,wz)− ym| ≤ , and in particular\nη(xm,wz) { ≥ c4N−n − > c4N−n/2, if zm = 1, ≤ < c4N−n/2, if zm = 0,\nso the thresholded network η1 = 1(η > c4N −n/2) has outputs\nη1(xm,wz) = zm, m = 1, . . . , N d.\nSince the Boolean values zm were arbitrary, we conclude that the subset S is shattered and hence VCdim(η1) ≥ Nd. Expressing N through with (37), we obtain\nVCdim(η1) ≥ (3 c4 )−d/n . (38)\nTo establish part a) of the Theorem, we apply bound (33) to the network η1:\nVCdim(η1) ≤ c3W 2, (39)\nwhere W is the number of weights in η1, which is the same as in η if we do not count the threshold parameter. Combining (38) with (39), we obtain the desired lower bound W ≥ c −d/(2n) with c = (c4/3)d/(2n)c−1/23 . To establish part b) of the Theorem, we use bound (34) and the hypothesis L ≤ c1 ln p(1/ ): VCdim(η1) ≤ c3c21 ln2p(1/ )W lnW. (40) Combining (38) with (40), we obtain\nW lnW ≥ 1 c3c21 (3 c4 )−d/n ln−2p(1/ ). (41)\nTrying a W of the form Wc2 = c2 −d/n ln−2p−1(1/ ) with a constant c2, we get\nWc2 lnWc2 = c2 −d/n ln−2p−1(1/ ) (d n ln(1/ ) + ln c2 − (2p+ 1) ln ln(1/ ) )\n= ( c2 d\nn + o(1)\n) −d/n ln−2p(1/ ).\nComparing this with (41), we see that if we choose c2 < (c4/3) d/nn/(dc3c 2 1), then for sufficiently small we have W lnW ≥ Wc2 lnWc2 and hence W ≥ Wc2 , as claimed. We can ensure that W ≥ Wc2 for all ∈ (0, 12) by further decreasing c2.\nWe remark that the constrained depth hypothesis of part b) is satisfied, with p = 1, by the architecture used for the upper bound in Theorem 1. The bound stated in part b) of Theorem 4 matches the upper bound of Theorem 1 and the lower bound of Theorem 3 up to a power of ln(1/ )."
    }, {
      "heading" : "4.3 Adaptive network architectures",
      "text" : "Our goal in this section is to obtain a lower bound for the approximation complexity in the scenario where the network architecture may depend on the approximated function. This lower bound is thus a counterpart to the upper bound of Section 3.3.\nTo state this result we define the complexity N (f, ) of approximating the function f with error as the minimal number of hidden computation units in a ReLU network that provides such an approximation.\nTheorem 5. For any d, n, there exists f ∈ Wn,∞([0, 1]d) such that N (f, ) is not o( −d/(9n)) as → 0.\nThe proof relies on the following lemma.\nLemma 3. Fix d, n. For any sufficiently small > 0 there exists f ∈ Fd,n such that N (f , ) ≥ c1 −d/(8n), with some constant c1 = c1(d, n) > 0.\nProof. Observe that all the networks with not more than m hidden computation units can be embedded in the single “enveloping” network that has m hidden layers, each consisting of m units, and that includes all the connections between units not in the same layer (see Fig. 6a). The number of weights in this enveloping network is O(m4). On the other hand, Theorem 4a) states that at least c −d/(2n) weights are needed for an architecture capable of -approximating any function in Fd,n. It follows that there is a function f ∈ Fd,n that cannot be -approximated by networks with fewer than c1 −d/(8n) computation units.\nBefore proceeding to the proof of Theorem 5, note that N (f, ) is a monotone decreasing function of with a few obvious properties:\nN (af, |a| ) = N (f, ), for any a ∈ R \\ {0} (42)\n(follows by multiplying the weights of the output unit of the approximating network by a constant); N (f ± g, + ‖g‖∞) ≤ N (f, ) (43) (follows by approximating f ± g by an approximation of f);\nN (f1 ± f2, 1 + 2) ≤ N (f1, 1) +N (f2, 2) (44)\n(follows by combining approximating networks for f1 and f2 as in Fig. 6b).\nProof of Theorem 5. The claim of Theorem 5 is similar to the claim of Lemma 3, but is about a single function f satisfying a slightly weaker complexity bound at multiple values of → 0. We will assume that Theorem 5 is false, i.e.,\nN (f, ) = o( −d/(9n)) (45)\nfor all f ∈ Wn,∞([0, 1]d), and we will reach contradiction by presenting f violating this assumption. Specifically, we construct this f as\nf = ∞∑\nk=1\nakfk, (46)\nwith some ak ∈ R, fk ∈ Fd,n, and we will make sure that\nN (f, k) ≥ −d/(9n)k (47)\nfor a sequence of k → 0. We determine ak, fk, k sequentially. Suppose we have already found {as, fs, s}k−1s=1 ; let us describe how we define ak, fk, k.\nFirst, we set\nak = min s=1,...,k−1 s 2k−s . (48)\nIn particular, this ensures that ak ≤ 121−k, so that the function f defined by the series (46) will be in Wn,∞([0, 1]d), because ‖fk‖Wn,∞([0,1]d) ≤ 1.\nNext, using Lemma 3 and Eq. (42), observe that if k is sufficiently small, then we can find fk ∈ Fd,n such that\nN ( akfk, 3 k ) = N ( fk,\n3 k ak\n) ≥ c1 (3 k ak )−d/(8n) ≥ 2 −d/(9n)k . (49)\nIn addition, by assumption (45), if k is small enough then\nN ( k−1∑\ns=1\nasfs, k ) ≤ −d/(9n)k . (50)\nLet us choose k and fk so that both (49) and (50) hold. Obviously, we can also make sure that k → 0 as k →∞.\nLet us check that the above choice of {ak, fk, k}∞k=1 ensures that inequality (47) holds for all k:\nN ( ∞∑\ns=1\nasfs, k\n) ≥ N ( k∑\ns=1\nasfs, k + ∥∥∥ ∞∑\ns=k+1\nasfs ∥∥∥ ∞ )\n≥ N ( k∑\ns=1\nasfs, k + ∞∑\ns=k+1\nas\n)\n≥ N ( k∑\ns=1\nasfs, 2 k\n)\n≥ N (akfk, 3 k)−N ( k−1∑\ns=1\nasfs, k\n)\n≥ −d/(9n).\nHere in the first step we use inequality (43), in the second the monotonicity of N (f, ), in the third the monotonicity of N (f, ) and the setting (48), in the fourth the inequality (44), and in the fifth the conditions (49) and (50)."
    }, {
      "heading" : "4.4 Slow approximation of smooth functions by shallow networks",
      "text" : "In this section we show that, in contrast to deep ReLU networks, shallow ReLU networks relatively inefficiently approximate sufficiently smooth (C2) nonlinear functions. We remark\nthat Liang and Srikant 2016 prove a similar result assuming global convexity instead of smoothness and nonlinearity.\nTheorem 6. Let f ∈ C2([0, 1]d) be a nonlinear function (i.e., not of the form f(x1, . . . , xd) ≡ a0 + ∑d k=1 akxk on the whole [0, 1]\nd). Then, for any fixed L, a depth-L ReLU network approximating f with error ∈ (0, 1) must have at least c −1/(2(L−2)) weights and computation units, with some constant c = c(f, L) > 0.\nProof. Since f ∈ C2([0, 1]d and f is nonlinear, we can find x0 ∈ [0, 1]d and v ∈ Rd such that x0 + xv ∈ [0, 1]d for all x ∈ [−1, 1] and the function f1 : x 7→ f(x0 + xv) is strictly convex or concave on [−1, 1]. Suppose without loss of generality that it is strictly convex:\nmin x∈[−1,1]\nf ′′1 (x) = c1 > 0. (51)\nSuppose that f̃ is an -approximation of function f , and let f̃ be implemented by a ReLU network η of depth L. Let f̃1 : x 7→ f̃(x0 +xv). Then f̃1 also approximates f1 with error not larger than . Moreover, since f̃1 is obtained from f̃ by a linear substitution x = x0 + xv, f̃1 can be implemented by a ReLU network η1 of the same depth L and with the number of units and weights not larger than in η (we can obtain η1 from η by replacing the input layer in η with a single unit, accordingly modifying the input connections, and adjusting the weights associated with these connections). It is thus sufficient to establish the claimed bounds for η1.\nBy construction, f̃1 is a continuous piece-wise linear function of x. Denote by M the number of linear pieces in f̃1. We will use the following counting lemma. Lemma 4. M ≤ (2U)L−2, where U is the number of computation units in η1.\nProof. This bound, up to minor details, is proved in Lemma 2.1 of Telgarsky [2015]. Precisely, Telgarsky’s lemma states that if a network has a single input, connections only between neighboring layers, at most m units in a layer, and a piece-wise linear activation function with t pieces, then the number of linear pieces in the output of the network is not greater than (tm)L. By examining the proof of the lemma we see that it will remain valid for networks with connections not necessarily between neighboring layers, if we replace m by U in the expression (tm)L. Moreover, we can slightly strengthen the bound by noting that in the present paper the input and output units are counted as separate layers, only units of layers 3 to L have multiple incoming connections, and the activation function is applied only in layers 2 to L − 1. By following Telgarsky’s arguments, this gives the slightly more accurate bound (tU)L−2 (i.e., with the power L − 2 instead of L). It remains to note that the ReLU activation function corresponds to t = 2.\nLemma 4 implies that there is an interval [a, b] ⊂ [−1, 1] of length not less than 2(2U)−(L−2) on which the function f̃1 is linear. Let g = f1 − f̃1. Then, by the approximation accuracy assumption, supx∈[a,b] |g(x)| ≤ , while by (51) and by the linearity of f̃1\non [a, b], maxx∈[a,b] g ′′(x) ≥ c1 > 0. It follows that max(g(a), g(b)) ≥ g(a+b2 ) + c12 ( b−a2 )2 and hence\n≥ 1 2\n( max(g(a), g(b))− g(a+b 2 ) ) ≥ c1\n4 (b− a 2 )2 ≥ c1 4 (2U)−2(L−2),\nwhich implies the claimed bound U ≥ 1 2 ( 4 c1 )−1/(2(L−2)). Since there are at least as many weights as computation units in a network, a similar bound holds for the number of weights."
    }, {
      "heading" : "5 Discussion",
      "text" : "We discuss some implications of the obtained bounds.\nDeep vs. shallow ReLU approximations of smooth functions. Our results clearly show that deep ReLU networks more efficiently express smooth functions than shallow ReLU networks. By Theorem 1, functions from the Sobolev space Wn,∞([0, 1]d) can be -approximated by ReLU networks with depth O(ln(1/ )) and the number of computation units O( −d/n ln(1/ )). In contrast, by Theorem 6, a nonlinear function from C2([0, 1]d) cannot be -approximated by a ReLU network of fixed depth L with the number of units less than c −1/(2(L−2)). In particular, it follows that in terms of the required number of computation units, unbounded-depth approximations of functions from Wn,∞([0, 1]d) are asymptotically strictly more efficient than approximations with a fixed depth L at least when\nd n <\n1\n2(L− 2)\n(assuming also n > 2, so that Wn,∞([0, 1]d) ⊂ C2([0, 1]d)). The efficiency of depth is even more pronounced for very smooth functions such as polynomials, which can be implemented by deep networks using only O(ln(1/ )) units (cf. Propositions 2 and 3 and the proof of Theorem 1). Liang and Srikant describe in Liang and Srikant [2016] some conditions on the approximated function (resembling conditions of local analyticity) under which complexity of deep -approximation is O(lnc(1/ )) with a constant power c.\nContinuous model selection vs. function-dependent network architectures. When approximating a function by a neural network, one can either view the network architecture as fixed and only tune the weights, or optimize the architecture as well. Moreover, when tuning the weights, one can either require them to continuously depend on the approximated function or not. We naturally expect that more freedom in the choice of the approximation should lead to higher expressiveness.\nOur bounds confirm this expectation to a certain extent. Specifically, the complexity of -approximation of functions from the unit ball F1,1 in W1,∞([0, 1]) is lower bounded by c in the scenario with a fixed architecture and continuously selected weights (see Theorem 3). On the other hand, we show in Theorem 2 that this complexity is upper bounded by O( 1\nln(1/ ) )\nif we are allowed to adjust the network architecture. This bound is achieved by finite-depth (depth-6) ReLU networks using the idea of reused subnetworks familiar from the theory of Boolean circuits Shannon [1949].\nIn the case of fixed architecture, we have not established any evidence of complexity improvement for unconstrained weight selection compared to continuous weight selection. We remark however that, already for approximations with depth-3 networks, the optimal weights are known to discontinuously depend, in general, on the approximated function (Kainen et al. [1999]). On the other hand, part b) of Theorem 4 shows that if the network depth scales as O(lnp(1/ )), discontinuous weight selection cannot improve the continuouscase complexity more than by a factor being some power of ln(1/ ).\nUpper vs. lower complexity bounds. We indicate the gaps between respective upper and lower bounds in the three scenarios mentioned above: fixed architectures with continuous selection of weights, fixed architectures with unconstrained selection of weights, or adaptive architectures.\nFor fixed architectures with continuous selection the lower bound c −d/n is provided by Proposition 3, and the upper bound O( −d/n ln(1/ )) by Theorem 1, so these bounds are tight up to a factor O(ln(1/ )).\nIn the case of fixed architecture but unconstrained selection, part b) of Theorem 4 gives a lower bound c −d/n ln−2p−1(1/ ) under assumption that the depth is constrained by O(lnp(1/ )). This is only different by a factor of O(ln2p+2(1/ )) from the upper bound of Theorem 1. Without this depth constraint we only have the significantly weaker bound c −d/(2n) (part a) of Theorem 4).\nIn the case of adaptive architectures, there is a big gap between our upper and lower bounds. The upper bound O( 1\nln(1/ ) ) is given by Theorem 2 for d = n = 1. The lower\nbound, proved for general d, n in Theorem 5, only states that there are f ∈ Wn,∞([0, 1]d) for which the complexity is not o( −d/(9n)).\nReLU vs. smooth activation functions. A popular general-purpose method of approximation is shallow (depth-3) networks with smooth activation functions (e.g., logistic sigmoid). Upper and lower approximation complexity bounds for these networks (Mhaskar [1996], Maiorov and Meir [2000]) show that complexity scales as ∼ −d/n up to some ln(1/ ) factors. Comparing this with our bounds in Theorems 1,2,4, it appears that deep ReLU networks are roughly (up to ln(1/ ) factors) as expressive as shallow networks with smooth activation functions.\nConclusion. We have established several upper and lower bounds for the expressive power of deep ReLU networks in the context of approximation in Sobolev spaces. We should note, however, that this setting may not quite reflect typical real world applications, which usually possess symmetries and hierarchical and other structural properties substantially narrowing the actually interesting classes of approximated functions (LeCun et al. [2015]). Some recent publications introduce and study expressive power of deep networks in frameworks bridging\nthis gap, in particular, graph-based hierarchical approximations are studied in Mhaskar et al. [2016], Mhaskar and Poggio [2016] and convolutional arithmetic circuits in Cohen et al. [2015]. Theoretical analysis of expressiveness of deep networks taking into account such properties of real data seems to be an important and promising direction of future research."
    }, {
      "heading" : "Acknowledgments",
      "text" : "The author thanks Matus Telgarsky and the anonymous referees for multiple helpful comments on the preliminary versions of the paper. The research was funded by Skolkovo Institute of Science and Technology."
    } ],
    "references" : [ {
      "title" : "Neural network learning: Theoretical foundations",
      "author" : [ "Martin Anthony", "Peter L Bartlett" ],
      "venue" : "Cambridge university press,",
      "citeRegEx" : "Anthony and Bartlett.,? \\Q2009\\E",
      "shortCiteRegEx" : "Anthony and Bartlett.",
      "year" : 2009
    }, {
      "title" : "Almost linear VC-dimension bounds for piecewise polynomial networks",
      "author" : [ "Peter L Bartlett", "Vitaly Maiorov", "Ron Meir" ],
      "venue" : "Neural computation,",
      "citeRegEx" : "Bartlett et al\\.,? \\Q1998\\E",
      "shortCiteRegEx" : "Bartlett et al\\.",
      "year" : 1998
    }, {
      "title" : "On the complexity of neural network classifiers: A comparison between shallow and deep architectures",
      "author" : [ "Monica Bianchini", "Franco Scarselli" ],
      "venue" : "IEEE transactions on neural networks and learning systems,",
      "citeRegEx" : "Bianchini and Scarselli.,? \\Q2014\\E",
      "shortCiteRegEx" : "Bianchini and Scarselli.",
      "year" : 2014
    }, {
      "title" : "Why deep neural networks",
      "author" : [ "Nadav Cohen", "Or Sharir", "Amnon Shashua" ],
      "venue" : "arXiv preprint arXiv:1509.05009,",
      "citeRegEx" : "Cohen et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Cohen et al\\.",
      "year" : 2015
    }, {
      "title" : "The Solovay-Kitaev algorithm",
      "author" : [ "CM Dawson", "MA Nielsen" ],
      "venue" : "Quantum Information and Computation,",
      "citeRegEx" : "Dawson and Nielsen.,? \\Q2006\\E",
      "shortCiteRegEx" : "Dawson and Nielsen.",
      "year" : 2006
    }, {
      "title" : "Shallow vs. deep sum-product networks",
      "author" : [ "Olivier Delalleau", "Yoshua Bengio" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Delalleau and Bengio.,? \\Q2011\\E",
      "shortCiteRegEx" : "Delalleau and Bengio.",
      "year" : 2011
    }, {
      "title" : "Optimal nonlinear approximation",
      "author" : [ "Ronald A DeVore", "Ralph Howard", "Charles Micchelli" ],
      "venue" : "Manuscripta mathematica,",
      "citeRegEx" : "DeVore et al\\.,? \\Q1989\\E",
      "shortCiteRegEx" : "DeVore et al\\.",
      "year" : 1989
    }, {
      "title" : "Bounding the Vapnik-Chervonenkis dimension of concept classes parameterized by real numbers",
      "author" : [ "Paul W Goldberg", "Mark R Jerrum" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Goldberg and Jerrum.,? \\Q1995\\E",
      "shortCiteRegEx" : "Goldberg and Jerrum.",
      "year" : 1995
    }, {
      "title" : "Approximation by neural networks is not",
      "author" : [ "Paul C Kainen", "Věra Kůrková", "Andrew Vogt" ],
      "venue" : "continuous. Neurocomputing,",
      "citeRegEx" : "Kainen et al\\.,? \\Q1999\\E",
      "shortCiteRegEx" : "Kainen et al\\.",
      "year" : 1999
    }, {
      "title" : "Efficient distribution-free learning of probabilistic concepts",
      "author" : [ "Michael J Kearns", "Robert E Schapire" ],
      "venue" : "In Foundations of Computer Science,",
      "citeRegEx" : "Kearns and Schapire.,? \\Q1990\\E",
      "shortCiteRegEx" : "Kearns and Schapire.",
      "year" : 1990
    }, {
      "title" : "Classical and Quantum Computation",
      "author" : [ "A. Yu. Kitaev", "A.H. Shen", "M.N. Vyalyi" ],
      "venue" : "American Mathematical Society,",
      "citeRegEx" : "Kitaev et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Kitaev et al\\.",
      "year" : 2002
    }, {
      "title" : "Why deep neural networks",
      "author" : [ "Shiyu Liang", "R. Srikant" ],
      "venue" : "arXiv preprint arXiv:1610.04161,",
      "citeRegEx" : "Liang and Srikant.,? \\Q2016\\E",
      "shortCiteRegEx" : "Liang and Srikant.",
      "year" : 2016
    }, {
      "title" : "On the near optimality of the stochastic approximation of smooth functions by neural networks",
      "author" : [ "VE Maiorov", "Ron Meir" ],
      "venue" : "Advances in Computational Mathematics,",
      "citeRegEx" : "Maiorov and Meir.,? \\Q2000\\E",
      "shortCiteRegEx" : "Maiorov and Meir.",
      "year" : 2000
    }, {
      "title" : "Neural networks for optimal approximation of smooth and analytic functions",
      "author" : [ "HN Mhaskar" ],
      "venue" : "Neural Computation,",
      "citeRegEx" : "Mhaskar.,? \\Q1996\\E",
      "shortCiteRegEx" : "Mhaskar.",
      "year" : 1996
    }, {
      "title" : "Deep vs. shallow networks: An approximation theory perspective",
      "author" : [ "Hrushikesh Mhaskar", "Tomaso Poggio" ],
      "venue" : "arXiv preprint arXiv:1608.03287,",
      "citeRegEx" : "Mhaskar and Poggio.,? \\Q2016\\E",
      "shortCiteRegEx" : "Mhaskar and Poggio.",
      "year" : 2016
    }, {
      "title" : "Learning real and boolean functions: When is deep better than shallow",
      "author" : [ "Hrushikesh Mhaskar", "Qianli Liao", "Tomaso Poggio" ],
      "venue" : "arXiv preprint arXiv:1603.00988,",
      "citeRegEx" : "Mhaskar et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Mhaskar et al\\.",
      "year" : 2016
    }, {
      "title" : "On the number of linear regions of deep neural networks",
      "author" : [ "Guido F Montufar", "Razvan Pascanu", "Kyunghyun Cho", "Yoshua Bengio" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "Montufar et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Montufar et al\\.",
      "year" : 2014
    }, {
      "title" : "Approximation theory of the MLP model in neural networks",
      "author" : [ "Allan Pinkus" ],
      "venue" : "Acta Numerica,",
      "citeRegEx" : "Pinkus.,? \\Q1999\\E",
      "shortCiteRegEx" : "Pinkus.",
      "year" : 1999
    }, {
      "title" : "On the expressive power of deep neural networks",
      "author" : [ "Maithra Raghu", "Ben Poole", "Jon Kleinberg", "Surya Ganguli", "Jascha Sohl-Dickstein" ],
      "venue" : "arXiv preprint arXiv:1606.05336,",
      "citeRegEx" : "Raghu et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Raghu et al\\.",
      "year" : 2016
    }, {
      "title" : "Tight Bounds for the VC-Dimension of Piecewise Polynomial Networks",
      "author" : [ "Akito Sakurai" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Sakurai.,? \\Q1999\\E",
      "shortCiteRegEx" : "Sakurai.",
      "year" : 1999
    }, {
      "title" : "Deep learning in neural networks: An overview",
      "author" : [ "Jürgen Schmidhuber" ],
      "venue" : "Neural Networks,",
      "citeRegEx" : "Schmidhuber.,? \\Q2015\\E",
      "shortCiteRegEx" : "Schmidhuber.",
      "year" : 2015
    }, {
      "title" : "The synthesis of two-terminal switching circuits",
      "author" : [ "Claude Shannon" ],
      "venue" : "Bell Labs Technical Journal,",
      "citeRegEx" : "Shannon.,? \\Q1949\\E",
      "shortCiteRegEx" : "Shannon.",
      "year" : 1949
    }, {
      "title" : "Representation benefits of deep feedforward networks",
      "author" : [ "Matus Telgarsky" ],
      "venue" : "arXiv preprint arXiv:1509.08101,",
      "citeRegEx" : "Telgarsky.,? \\Q2015\\E",
      "shortCiteRegEx" : "Telgarsky.",
      "year" : 2015
    }, {
      "title" : "Benefits of depth in neural networks",
      "author" : [ "Matus Telgarsky" ],
      "venue" : "arXiv preprint arXiv:1602.04485,",
      "citeRegEx" : "Telgarsky.,? \\Q2016\\E",
      "shortCiteRegEx" : "Telgarsky.",
      "year" : 2016
    }, {
      "title" : "On the uniform convergence of relative frequencies of events to their probabilities",
      "author" : [ "Vladimir N Vapnik", "A Ya Chervonenkis" ],
      "venue" : "In Measures of Complexity,",
      "citeRegEx" : "Vapnik and Chervonenkis.,? \\Q2015\\E",
      "shortCiteRegEx" : "Vapnik and Chervonenkis.",
      "year" : 2015
    }, {
      "title" : "Lower bounds for approximation by nonlinear manifolds",
      "author" : [ "Hugh E Warren" ],
      "venue" : "Transactions of the American Mathematical Society,",
      "citeRegEx" : "Warren.,? \\Q1968\\E",
      "shortCiteRegEx" : "Warren.",
      "year" : 1968
    } ],
    "referenceMentions" : [ {
      "referenceID" : 14,
      "context" : "Recently, multiple successful applications of deep neural networks to pattern recognition problems (Schmidhuber [2015], LeCun et al.",
      "startOffset" : 100,
      "endOffset" : 119
    }, {
      "referenceID" : 14,
      "context" : "Recently, multiple successful applications of deep neural networks to pattern recognition problems (Schmidhuber [2015], LeCun et al. [2015]) have revived active interest in theoretical properties of such networks, in particular their expressive power.",
      "startOffset" : 100,
      "endOffset" : 140
    }, {
      "referenceID" : 3,
      "context" : ", Delalleau and Bengio [2011], Raghu et al.",
      "startOffset" : 2,
      "endOffset" : 30
    }, {
      "referenceID" : 3,
      "context" : ", Delalleau and Bengio [2011], Raghu et al. [2016], Montufar et al.",
      "startOffset" : 2,
      "endOffset" : 51
    }, {
      "referenceID" : 3,
      "context" : ", Delalleau and Bengio [2011], Raghu et al. [2016], Montufar et al. [2014], Bianchini and Scarselli [2014], Telgarsky [2015]).",
      "startOffset" : 2,
      "endOffset" : 75
    }, {
      "referenceID" : 2,
      "context" : "[2014], Bianchini and Scarselli [2014], Telgarsky [2015]).",
      "startOffset" : 8,
      "endOffset" : 39
    }, {
      "referenceID" : 2,
      "context" : "[2014], Bianchini and Scarselli [2014], Telgarsky [2015]).",
      "startOffset" : 8,
      "endOffset" : 57
    }, {
      "referenceID" : 2,
      "context" : "[2014], Bianchini and Scarselli [2014], Telgarsky [2015]). In contrast to a shallow network, a deep one can be viewed as a long sequence of non-commutative transformations, which is a natural setting for high expressiveness (cf. the well-known Solovay-Kitaev theorem on fast approximation of arbitrary quantum operations by sequences of non-commutative gates, see Kitaev et al. [2002], Dawson and Nielsen [2006]).",
      "startOffset" : 8,
      "endOffset" : 385
    }, {
      "referenceID" : 2,
      "context" : "[2014], Bianchini and Scarselli [2014], Telgarsky [2015]). In contrast to a shallow network, a deep one can be viewed as a long sequence of non-commutative transformations, which is a natural setting for high expressiveness (cf. the well-known Solovay-Kitaev theorem on fast approximation of arbitrary quantum operations by sequences of non-commutative gates, see Kitaev et al. [2002], Dawson and Nielsen [2006]).",
      "startOffset" : 8,
      "endOffset" : 412
    }, {
      "referenceID" : 0,
      "context" : "Bianchini and Scarselli 2014 give bounds for Betti numbers characterizing topological properties of functions represented by networks. Telgarsky 2015, 2016 provides specific examples of classification problems where deep networks are provably more efficient than shallow ones. In the context of classification problems, a general and standard approach to characterizing expressiveness is based on the notion of the Vapnik-Chervonenkis dimension (Vapnik and Chervonenkis [2015]).",
      "startOffset" : 0,
      "endOffset" : 477
    }, {
      "referenceID" : 0,
      "context" : "There exist several bounds for VC-dimension of deep networks with piece-wise polynomial activation functions that go back to geometric techniques of Goldberg and Jerrum 1995 and earlier results of Warren 1968; see Bartlett et al. [1998], Sakurai [1999] and the book Anthony and Bartlett [2009].",
      "startOffset" : 214,
      "endOffset" : 237
    }, {
      "referenceID" : 0,
      "context" : "There exist several bounds for VC-dimension of deep networks with piece-wise polynomial activation functions that go back to geometric techniques of Goldberg and Jerrum 1995 and earlier results of Warren 1968; see Bartlett et al. [1998], Sakurai [1999] and the book Anthony and Bartlett [2009].",
      "startOffset" : 214,
      "endOffset" : 253
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]).",
      "startOffset" : 36,
      "endOffset" : 64
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]).",
      "startOffset" : 36,
      "endOffset" : 190
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]).",
      "startOffset" : 36,
      "endOffset" : 219
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]). A very general approach to expressiveness in the context of approximation is the method of nonlinear widths by DeVore et al. 1989 that concerns approximation of a family of functions under assumption of a continuous dependence of the model on the approximated function. In this paper we examine the problem of shallow-vs-deep expressiveness from the perspective of approximation theory and general spaces of functions having derivatives up to certain order (Sobolev-type spaces). In this framework, the problem of expressiveness is very well studied in the case of shallow networks with a single hidden layer, where it is known, in particular, that to approximate a C-function on a d-dimensional set with infinitesimal error one needs a network of size about −d/n, assuming a smooth activation function (see, e.g., Mhaskar [1996], Pinkus [1999] for a number of related rigorous upper and lower bounds and further qualifications of this result).",
      "startOffset" : 36,
      "endOffset" : 1051
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]). A very general approach to expressiveness in the context of approximation is the method of nonlinear widths by DeVore et al. 1989 that concerns approximation of a family of functions under assumption of a continuous dependence of the model on the approximated function. In this paper we examine the problem of shallow-vs-deep expressiveness from the perspective of approximation theory and general spaces of functions having derivatives up to certain order (Sobolev-type spaces). In this framework, the problem of expressiveness is very well studied in the case of shallow networks with a single hidden layer, where it is known, in particular, that to approximate a C-function on a d-dimensional set with infinitesimal error one needs a network of size about −d/n, assuming a smooth activation function (see, e.g., Mhaskar [1996], Pinkus [1999] for a number of related rigorous upper and lower bounds and further qualifications of this result).",
      "startOffset" : 36,
      "endOffset" : 1066
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]). A very general approach to expressiveness in the context of approximation is the method of nonlinear widths by DeVore et al. 1989 that concerns approximation of a family of functions under assumption of a continuous dependence of the model on the approximated function. In this paper we examine the problem of shallow-vs-deep expressiveness from the perspective of approximation theory and general spaces of functions having derivatives up to certain order (Sobolev-type spaces). In this framework, the problem of expressiveness is very well studied in the case of shallow networks with a single hidden layer, where it is known, in particular, that to approximate a C-function on a d-dimensional set with infinitesimal error one needs a network of size about −d/n, assuming a smooth activation function (see, e.g., Mhaskar [1996], Pinkus [1999] for a number of related rigorous upper and lower bounds and further qualifications of this result). Much less seems to be known about deep networks in this setting, though Mhaskar et al. 2016, 2016 have recently introduced functional spaces constructed using deep dependency graphs and obtained expressiveness bounds for related deep networks. We will focus our attention on networks with the ReLU activation function σ(x) = max(0, x), which, despite its utter simplicity, seems to be the most popular choice in practical applications LeCun et al. [2015]. We will consider L∞-error of approximation of functions belonging to the Sobolev spacesWn,∞([0, 1]) (without any assumptions of hierarchical structure).",
      "startOffset" : 36,
      "endOffset" : 1621
    }, {
      "referenceID" : 0,
      "context" : "[1998], Sakurai [1999] and the book Anthony and Bartlett [2009]. There is a related concept, the fat-shattering dimension, for real-valued approximation problems (Kearns and Schapire [1990], Anthony and Bartlett [2009]). A very general approach to expressiveness in the context of approximation is the method of nonlinear widths by DeVore et al. 1989 that concerns approximation of a family of functions under assumption of a continuous dependence of the model on the approximated function. In this paper we examine the problem of shallow-vs-deep expressiveness from the perspective of approximation theory and general spaces of functions having derivatives up to certain order (Sobolev-type spaces). In this framework, the problem of expressiveness is very well studied in the case of shallow networks with a single hidden layer, where it is known, in particular, that to approximate a C-function on a d-dimensional set with infinitesimal error one needs a network of size about −d/n, assuming a smooth activation function (see, e.g., Mhaskar [1996], Pinkus [1999] for a number of related rigorous upper and lower bounds and further qualifications of this result). Much less seems to be known about deep networks in this setting, though Mhaskar et al. 2016, 2016 have recently introduced functional spaces constructed using deep dependency graphs and obtained expressiveness bounds for related deep networks. We will focus our attention on networks with the ReLU activation function σ(x) = max(0, x), which, despite its utter simplicity, seems to be the most popular choice in practical applications LeCun et al. [2015]. We will consider L∞-error of approximation of functions belonging to the Sobolev spacesWn,∞([0, 1]) (without any assumptions of hierarchical structure). We will often consider families of approximations, as the approximated function runs over the unit ball Fd,n in Wn,∞([0, 1]). In such cases we will distinguish scenarios of fixed and adaptive network architectures. Our goal is to obtain lower and upper bounds on the expressiveness of deep and shallow networks in different scenarios. We measure complexity of networks in a conventional way, by counting the number of their weights and computation units (cf. Anthony and Bartlett [2009]).",
      "startOffset" : 36,
      "endOffset" : 2262
    }, {
      "referenceID" : 11,
      "context" : "The arXiv preprint of the first version of the present work appeared almost simultaneously with the work of Liang and Srikant Liang and Srikant [2016] containing results partly overlapping with our results in Subsections 3.",
      "startOffset" : 108,
      "endOffset" : 151
    }, {
      "referenceID" : 0,
      "context" : "The depth of the network, the number of units and the total number of weights are standard measures of network complexity (Anthony and Bartlett [2009]).",
      "startOffset" : 123,
      "endOffset" : 151
    }, {
      "referenceID" : 22,
      "context" : "Our construction uses the “sawtooth” function that has previously appeared in the paper Telgarsky [2015]. Proposition 2.",
      "startOffset" : 88,
      "endOffset" : 105
    }, {
      "referenceID" : 21,
      "context" : "This construction is inspired by a similar argument used to prove the O(2/n) upper bound for the complexity of Boolean circuits implementing n-ary functions Shannon [1949]. The proof becomes simpler if, in addition to the ReLU function σ, we are allowed to use the activation function",
      "startOffset" : 157,
      "endOffset" : 172
    }, {
      "referenceID" : 6,
      "context" : "The method of continuous nonlinear widths (DeVore et al. [1989]) is a very general approach to the analysis of parameterized nonlinear approximations, based on the assumption of continuous selection of their parameters.",
      "startOffset" : 43,
      "endOffset" : 64
    }, {
      "referenceID" : 6,
      "context" : "Theorem 3 (DeVore et al. [1989], Theorem 4.",
      "startOffset" : 11,
      "endOffset" : 32
    }, {
      "referenceID" : 6,
      "context" : "Theorem 3 (DeVore et al. [1989], Theorem 4.2). Fix d, n. Let W be a positive integer and η : R → C([0, 1]) be any mapping between the space R and the space C([0, 1]). Suppose that there is a continuous map M : Fd,n → R such that ‖f − η(M(f))‖∞ ≤ for all f ∈ Fd,n. Then W ≥ c −d/n, with some constant c depending only on n. We apply this theorem by taking η to be some ReLU network architecture, and R the corresponding weight space. It follows that if a ReLU network architecture is capable of expressing any function from Fd,n with error , then, under the hypothesis of continuous weight selection, the network must have at least c −d/n weights. The number of connections is then lower bounded by c 2 −d/n (since the number of weights is not larger than the sum of the number of computation units and the number of connections, and there are at least as many connections as units). The hypothesis of continuous weight selection is crucial in Theorem 3. By examining our proof of the counterpart upper bound O( −d/n ln(1/ )) in Theorem 1, the weights are selected there in a continuous manner, so this upper bound asymptotically lies above c −d/n in agreement with Theorem 3. We remark, however, that the optimal choice of the network weights (minimizing the error) is known to be discontinuous in general, even for shallow networks (Kainen et al. [1999]).",
      "startOffset" : 11,
      "endOffset" : 1355
    }, {
      "referenceID" : 0,
      "context" : "In this setup, some lower bounds on the network complexity can be obtained as a consequence of existing upper bounds on VC-dimension of networks with piece-wise polynomial activation functions and Boolean outputs (Anthony and Bartlett [2009]).",
      "startOffset" : 214,
      "endOffset" : 242
    }, {
      "referenceID" : 0,
      "context" : ", Anthony and Bartlett [2009], Section 3.",
      "startOffset" : 2,
      "endOffset" : 30
    }, {
      "referenceID" : 0,
      "context" : ", Anthony and Bartlett [2009], Section 3.3). We are interested in the case when H is the family of functions obtained by applying thresholds 1(x > a) to a ReLU network with fixed architecture but variable weights. In this case Theorem 8.7 of Anthony and Bartlett [2009] implies that VCdim(H) ≤ c3W , (33)",
      "startOffset" : 2,
      "endOffset" : 270
    }, {
      "referenceID" : 22,
      "context" : "1 of Telgarsky [2015]. Precisely, Telgarsky’s lemma states that if a network has a single input, connections only between neighboring layers, at most m units in a layer, and a piece-wise linear activation function with t pieces, then the number of linear pieces in the output of the network is not greater than (tm).",
      "startOffset" : 5,
      "endOffset" : 22
    }, {
      "referenceID" : 11,
      "context" : "Liang and Srikant describe in Liang and Srikant [2016] some conditions on the approximated function (resembling conditions of local analyticity) under which complexity of deep -approximation is O(ln(1/ )) with a constant power c.",
      "startOffset" : 0,
      "endOffset" : 55
    }, {
      "referenceID" : 20,
      "context" : "This bound is achieved by finite-depth (depth-6) ReLU networks using the idea of reused subnetworks familiar from the theory of Boolean circuits Shannon [1949]. In the case of fixed architecture, we have not established any evidence of complexity improvement for unconstrained weight selection compared to continuous weight selection.",
      "startOffset" : 145,
      "endOffset" : 160
    }, {
      "referenceID" : 8,
      "context" : "We remark however that, already for approximations with depth-3 networks, the optimal weights are known to discontinuously depend, in general, on the approximated function (Kainen et al. [1999]).",
      "startOffset" : 173,
      "endOffset" : 194
    }, {
      "referenceID" : 12,
      "context" : "Upper and lower approximation complexity bounds for these networks (Mhaskar [1996], Maiorov and Meir [2000]) show that complexity scales as ∼ −d/n up to some ln(1/ ) factors.",
      "startOffset" : 68,
      "endOffset" : 83
    }, {
      "referenceID" : 12,
      "context" : "Upper and lower approximation complexity bounds for these networks (Mhaskar [1996], Maiorov and Meir [2000]) show that complexity scales as ∼ −d/n up to some ln(1/ ) factors.",
      "startOffset" : 84,
      "endOffset" : 108
    }, {
      "referenceID" : 12,
      "context" : "this gap, in particular, graph-based hierarchical approximations are studied in Mhaskar et al. [2016], Mhaskar and Poggio [2016] and convolutional arithmetic circuits in Cohen et al.",
      "startOffset" : 80,
      "endOffset" : 102
    }, {
      "referenceID" : 12,
      "context" : "this gap, in particular, graph-based hierarchical approximations are studied in Mhaskar et al. [2016], Mhaskar and Poggio [2016] and convolutional arithmetic circuits in Cohen et al.",
      "startOffset" : 80,
      "endOffset" : 129
    }, {
      "referenceID" : 3,
      "context" : "[2016], Mhaskar and Poggio [2016] and convolutional arithmetic circuits in Cohen et al. [2015]. Theoretical analysis of expressiveness of deep networks taking into account such properties of real data seems to be an important and promising direction of future research.",
      "startOffset" : 75,
      "endOffset" : 95
    } ],
    "year" : 2017,
    "abstractText" : "We study expressive power of shallow and deep neural networks with piece-wise linear activation functions. We establish new rigorous upper and lower bounds for the network complexity in the setting of approximations in Sobolev spaces. In particular, we prove that deep ReLU networks more efficiently approximate smooth functions than shallow networks. In the case of approximations of 1D Lipschitz functions we describe adaptive depth-6 network architectures more efficient than the standard shallow architecture.",
    "creator" : "LaTeX with hyperref package"
  }
}