{
  "name" : "1707.06756.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "An Infinite Hidden Markov Model With Similarity-Biased Transitions",
    "authors" : [ "Colin Reimer Dawson", "Chaofan Huang", "Clayton T. Morrison" ],
    "emails" : [ "<cdawson@oberlin.edu>." ],
    "sections" : [ {
      "heading" : "1. Introduction and Background",
      "text" : "The hierarchical Dirichlet process hidden Markov model (HDP-HMM) (Beal et al., 2001; Teh et al., 2006) is a Bayesian model for time series data that generalizes the conventional hidden Markov Model to allow a countably infinite state space. The hierarchical structure ensures that, despite the infinite state space, a common set of destination states will be reachable with positive probability from each source state. The HDP-HMM can be characterized by the following generative process.\nEach state, indexed by j, has parameters, θj , drawn from a base measure, H . A top-level sequence of state\n1 Oberlin College, Oberlin, OH, USA 2The University of Arizona, Tucson, AZ, USA. Correspondence to: Colin Reimer Dawson <cdawson@oberlin.edu>. Code: http://colindawson.net/hdp-hmm-lt.\nProceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the author(s).\nweights, β = (β1, β2, . . . ), is drawn by iteratively breaking a “stick” off of the remaining weight according to a Beta (1, γ) distribution. The parameter γ > 0 is known as the concentration parameter and governs how quickly the weights tend to decay, with large γ corresponding to slow decay, and hence more weights needed before a given cumulative weight is reached. This stick-breaking process is denoted by GEM (Ewens, 1990; Sethuraman, 1994) for Griffiths, Engen and McCloskey. We thus have a discrete probability measure, G0, with weights βj at locations θj , j = 1, 2, . . . , defined by\nθj i.i.d.∼ H β ∼ GEM(γ). (1)\nG0 drawn in this way is a Dirichlet Process (DP) random measure with concentration γ and base measure H .\nThe actual transition distribution, πj , from state j, is drawn from another DP with concentration α and base measure G0:\nπj i.i.d.∼ DP(αG0) j = 0, 1, 2, . . . (2)\nwhere π0 represents the initial distribution. The hidden state sequence, z1, z2, . . . zT is then generated according to z1 |π0 ∼ Cat(π0), and\nzt | zt−1,πzt−1 ∼ Cat(πzt−1) t = 1, 2, . . . , T (3)\nFinally, the emission distribution for state j is a function of θj , so that observation yt is drawn according to\nyt | zt, θzt ∼ F (θzt) (4)\nA shortcoming of the HDP prior on the transition matrix is that it does not use the fact that the source and destination states are the same set: that is, each πj has a special element which corresponds to a self-transition. In the HDPHMM, however, self-transitions are no more likely a priori than transitions to any other state. The Sticky HDP-HMM (Fox et al., 2008) addresses this issue by adding an extra mass κ at location j to the base measure of the DP that generates πj . That is, (2) is replaced by\nπj ∼ DP(αG0 + κδθj ). (5)\nAn alternative approach that treats self-transitions as special is the HDP Hidden Semi-Markov Model (HDPHSMM; Johnson & Willsky (2013)), wherein state duration distributions are modeled separately, and ordinary selftransitions are ruled out. However, while both of these\nar X\niv :1\n70 7.\n06 75\n6v 1\n[ st\nat .M\nL ]\n2 1\nJu l 2\n01 7\nmodels have the ability to privilege self-transitions, they contain no notion of similarity for pairs of states that are not identical: in both cases, when the transition matrix is integrated out, the prior probability of transitioning to state j′ depends only on the top-level stick weight associated with state j′, and not on the identity or parameters of the previous state j.\nThe two main contributions of this paper are (1) a generalization of the HDP-HMM, which we call the HDP-HMM with local transitions (HDP-HMM-LT) that allows for a geometric structure to be defined on the latent state space, so that “nearby” states are a priori more likely to have transitions between them, and (2) a simple Gibbs sampling algorithm for this model. The “LT” property is introduced by elementwise rescaling and then renormalizing of the HDP transition matrix. Two versions of the similarity structure are illustrated: in one case, two states are similar to the extent that their emission distributions are similar. In another, the similarity structure is inferred separately. In both cases, we give augmented data representations that restore conditional conjugacy and thus allow a simple Gibbs sampling algorithm to be used for inference.\nA rescaling and renormalization approach similar to the one used in the HDP-HMM-LT is used by Paisley et al. (2012) to define their Discrete Infinite Logistic Normal (DILN) model, an instance of a correlated random measure (Ranganath & Blei, 2016), in the setting of topic modeling. There, however, the contexts and the mixture components (topics) are distinct sets, and there is no notion of temporal dependence. Zhu et al. (2016) developed an HMM based directly on the DILN model1. Both Paisley et al. and Zhu et al. employ variational approximations, whereas we present a Gibbs sampler, which converges asymptotically to the true posterior. We discuss additional differences between our model and the DILN-HMM in Sec. 2.2.\nOne class of application in which it is useful to incorporate a notion of locality occurs when the latent state sequence consists of several parallel chains, so that the global state changes incrementally, but where these increments are not independent across chains. Factorial HMMs (Ghahramani et al., 1997) are commonly used in this setting, but this ignores dependence among chains, and hence may do poorly when some combinations of states are much more probable than suggested by the chain-wise dynamics.\nAnother setting where the LT property is useful is when there is a notion of state geometry that licenses syllogisms: e.g., if A frequently leads to B and C and B frequently leads to D and E, then it may be sensible to infer that A and C may lead to D and E as well. This property is arguably\n1We thank an anonymous ICML reviewer for bringing this paper to our attention.\npresent in musical harmony, where consecutive chords are often (near-)neighbors in the “circle of fifths”, and small steps along the circle are more common than large ones.\nThe paper is structured as follows: In section 2 we define the model. In section 3, we develop a Gibbs sampling algorithm based on an augmented data representation, which we call the Markov Jump Process with Failed Transitions (MJP-FT). In section 4 we test two versions of the model: one on a speaker diarization task in which the speakers are inter-dependent, and another on a fourpart chorale corpus, demonstrating performance improvements over state-of-the-art models when “local transitions” are more common in the data. Using sythetic data from an HDP-HMM, we show that the LT variant can learn not to use its similarity bias when the data does not support it. Finally, in section 5, we conclude and discuss the relationships between the HDP-HMM-LT and existing HMM variants. Code and additional details are available at http://colindawson.net/hdp-hmm-lt/"
    }, {
      "heading" : "2. An HDP-HMM With Local Transitions",
      "text" : "We wish to add to the transition model the concept of a transition to a “nearby” state, where transitions between states j and j′ are more likely a priori to the extent that they are “nearby” in some similarity space. In order to accomplish this, we first consider an alternative construction of the transition distributions, based on the Normalized Gamma Process representation of the DP (Ishwaran & Zarepour, 2002; Ferguson, 1973)."
    }, {
      "heading" : "2.1. A Normalized Gamma Process representation of the HDP-HMM",
      "text" : "The Dirichlet Process is an instance of a normalized completely random measure (Kingman, 1967; Ferguson, 1973), that can be defined as G = ∑∞ k=1 π̃kδθk , where\nπk ind.∼ Gamma(αβk, 1) T = ∞∑ k=1 πk π̃k = πk T , (6)\nδθ is a measure assigning 1 to sets if they contain θ and 0 otherwise, and subject to the constraint that ∑ k≥1 βk = 1 and 0 < α <∞. It has been shown (Ferguson, 1973; Paisley et al., 2012; Favaro et al., 2013) that the normalization constant T is positive and finite almost surely, and thatG is distributed as a DP with base measure G0 = ∑∞ k=1 βkδθk . If we draw β = (β1, β2, . . . ) from the GEM(γ) stickbreaking process, draw an i.i.d. sequence of θk from a base measure H , and then draw an i.i.d. sequence of random measures, {Gj}, j = 1, 2, . . . , from the above process, this defines a Hierarchical Dirichlet Process (HDP). If each Gj is associated with the hidden states of an HMM, π is the infinite matrix where entry πjj′ is the j′th mass associated\nwith the jth random measure, and Tj is the sum of row j, then we obtain the prior for the HDP-HMM, where\np(zt | zt−1,π) = π̃zt−1zt = πjj′/Tj (7)"
    }, {
      "heading" : "2.2. Promoting “Local” Transitions",
      "text" : "In the HDP prior, the rows of the transition matrix are conditionally independent. We wish to relax this assumption, to incorporate possible prior knowledge that certain pairs of states are “nearby” in some sense and thus more likely than others to produce large transition weights between them (in both directions); that is, transitions are likely to be “local”. We accomplish this by associating each latent state j with a location `j in some space Ω, introducing a “similarity function” φ : Ω × Ω → (0, 1], and scaling each element πjj′ by φjj′ = φ(`j , `j′). For example, we might wish to define a (possibly asymmetric) divergence function d : Ω× Ω→ [0,∞) and set φ(`j , `j) = exp{−d(`j , `j′)} so that transitions are less likely the farther apart two states are. By setting φ ≡ 1, we obtain the standard HDP-HMM. The DILN-HMM (Zhu et al., 2016), employs a similar rescaling of transition probabilities via an exponentiated Gaussian Process, following (Paisley et al., 2012), but the scaling function must be positive semi-definite, and in particular symmetric, whereas in the HDP-HMM-LT, φ need only take values in (0, 1]. Moreover, the DILN-HMM does not allow the scales to be tied to other state parameters, and hence encode an independent notion of similarity.\nLetting ` = (`1, `2, . . . ), we can replace (6) for j ≥ 1 by\nπjj′ |β, ` ∼ Gamma(αβj′ , 1), Tj = ∞∑ j′=1 πjj′φjj′\nπ̃jj′ = πjj′φjj′/Tj , p(zt | zt−1,π, `) = π̃zt−1zt .\n(8)\nSince the φjj′ are positive and bounded above by 1, 0 < πj1φj1 ≤ Tj ≤ ∑ j′ πjj′ <∞ (9)\nalmost surely, where the last inequality carries over from the original HDP. The prior means of the unnormalized transition distributions, πj are then proportional (for each j) to αβφj where φj = (φj1, φj2, . . . ).\nThe distribution of the latent state sequence z given π and ` is now\np(z |π, `) = T∏ t=1 πzt−1ztφzt−1ztT −nzt−1· zt−1\n= ∞∏ j=1 T−1j ∞∏ j′=1 π njj′ jj′ φ njj′ jj′\n(10)\nwhere njj′ = ∑T t=1 I(zt−1 = j, zt = j\n′) is the number of transitions from state j to state j′ in the sequence z\nand nj· = ∑ j′ njj′ is the total number of visits to state j. Since Tj is a sum over products of πjj′ and φjj′ terms, the posterior for π is no longer a DP. However, conditional conjugacy can be restored by a data-augmentation process with a natural interpretation, which is described next."
    }, {
      "heading" : "2.3. The HDP-HMM-LT as the Marginalization of a Markov Jump Process with “Failed” Transitions",
      "text" : "In this section, we define a stochastic process that we call the Markov Jump Process with Failed Transitions (MJP-FT), from which we obtain the HDP-HMM-LT by marginalizing over some of the variables. By reinstating these auxiliary variables, we obtain a simple Gibbs sampling algorithm over the full MJP-FT, which can be used to sample from the marginal posterior of the variables used by the HDP-HMM-LT.\nLet β, π, ` and Tj , j = 1, 2, . . . be defined as in the last section. Consider a continuous-time Markov Process over the states j = 1, 2, . . . , and suppose that if the process makes a jump to state zt at time τt, the next jump, which is to state zt+1, occurs at time τt + ũt, where ũt ∼ Exp( ∑ j′ πjj′), and p(zt+1 = j\n′ | zt = j) ∝ πjj′ , independent of ũt. Note that in this formulation, unlike in standard formulations of Markov Jump Processes, we are assuming that self-jumps are possible.\nIf we only observe the jump sequence z and not the holding times ũt, this is an ordinary Markov chain with transition matrix row-proportional to π. If we do not observe the jumps directly, but instead an observation is generated once per jump from a distribution that depends on the state being jumped to, then we have an ordinary HMM whose transition matrix is obtained by normalizing π; that is, we have the HDP-HMM.\nWe modify this process as follows. Suppose each jump attempt from state j to state j′ has probability (1 − φjj′) of failing, in which case no transition occurs and no observation is generated. Assuming independent failures, the rates of successful and failed jumps from j to j′ are πjj′φjj′ and πjj′(1 − φjj′), respectively. The probability that the first successful jump is to state j′ (that is, that zt+1 = j′) is proportional to the rate of successful jump attempts to j′, which is πjj′φjj′ . Conditioned on zt, the holding time, ũt, is independent of zt+1 and is distributed as Exp(Tzt). We denote the total time spent in state j by uj = ∑ t:zt=j\nũt, where, as the sum of i.i.d. Exponentials,\nuj | z,π,θ ind.∼ Gamma(nj·, Tj) (11)\nDuring this period there will be qjj′ failed attempts to jump to state j′, where qjj′ ∼ Poisson(ujπjj′(1− φjj′)) are independent. This data augmentation bears some conceptual similarity to the Geometrically distributed ρ auxiliary variables introduced to the HDP-HSMM (Johnson & Willsky,\n2013) to restore conditional conjugacy. However, there are key differences: first, ρ measure how many steps the chain would have remained in state j under Markovian dynamics, whereas our u represents putative continuous holding times between each transition, and second ρ allows for the restoration of a zeroed out entry in each row, whereas u allows us to work with unnormalized π entries, avoiding the need to restore zeroed out entries in the HSMM-LT\nIncorporating u = {uj} and Q = {qjj′} as augmented data simplifies the likelihood for π, yielding\np(z,u,Q |π) = p(z |π)p(u | z,π)p(Q |u,π) (12)\nwhere dependence on ` has been omitted for conciseness. After grouping terms and omitting terms that do not depend on π, this proportional (as a function of π) to∏\nj ∏ j′ π njj′+qjj′ jj′ φ njj′ jj′ (1− φjj′) qjj′ e−πjj′uj (13)\nConveniently, the Tj have canceled, and the exponential terms involving πjj′ and φjj′ in the Gamma and Poisson distributions of uj and qjj′ combine to cause φjj′ to vanish.\nAdditional details and derivations for this data augmentation are in Appendix A."
    }, {
      "heading" : "2.4. Sticky and Semi-Markov Generalizations",
      "text" : "We note that the local transition property of the HDPHMM-LT can be combined with the Sticky property of the Sticky HDP-HMM (Fox et al., 2008), or the nongeometric duration distributions of the HDP-HSMM (Johnson & Willsky, 2013), to add additional prior weight on self-transitions. In the former case, no changes to inference are needed; one can simply add the the extra mass κ to the shape parameter of the Gamma prior on the πjj , and employ the same auxiliary variable method used by Fox et al. to distinguish “Sticky” from “regular” self-transitions. For the semi-Markov case, we can fix the diagonal elements of π to zero, and allow Dt observations to be emitted i.i.d. according to a state-specific duration distribution, and sample the latent state sequence using a suitable semi-Markov message passing algorithm (Johnson & Willsky, 2013). Inference for the φ matrix is not affected, since the diagonal elements are assumed to be 1. Unlike in the original representation of the HDP-HSMM, no further dataaugmentation is needed, as the (continuous) durations u already account for the normalization of the π."
    }, {
      "heading" : "2.5. Obtaining the Factorial HMM as a Limiting Case",
      "text" : "One setting in which a local transition property is desirable is the case where the latent states encode multiple hidden features at time t as a vector of categories. Such problems are often modeled using factorial HMMs (Ghahramani\net al., 1997). In fact, the HDP-HMM-LT yields the factorial HMM in the limit as α, γ →∞, fixing each row of π to be uniform with probability 1, so the dynamics are controlled entirely by φ. If A(d) is the transition matrix for chain d, then setting φ(`j , `j′) = exp−d(`j , `j′) with asymmetric “divergences” d(`j , `j′) = − ∑ d log(A (d) `jd,`j′d\n) yields the factorial transition model."
    }, {
      "heading" : "2.6. An Infinite Factorial HDP-HMM-LT",
      "text" : "Nonparametric extensions of the factorial HMM, such as the infinite factorial hidden Markov Model (Gael et al., 2009) and the infinite factorial dynamic model (Valera et al., 2015), have been developed in recent years by making use of the Indian Buffet Process (Ghahramani & Griffiths, 2005) as a state prior. It would be conceptually straightforward to combine the IBP state prior with the similarity bias of the LT model, provided the chosen similarity function is uniformly bounded above on the space of infinite length binary vectors (for example, take φ(u, v) to be the exponentiated negative Hamming distance between u and v). Since the number of differences between two draws from the IBP is finite with probability 1, this yields a reasonable similarity metric."
    }, {
      "heading" : "3. Inference",
      "text" : "We develop a Gibbs sampling algorithm based on the MJPFT representation described in Sec. A, augmenting the data with the duration variables u, the failed jump attempt count matrix, Q, as well as additional auxiliary variables which we will define below. In this representation the transition matrix is not represented directly, but is a deterministic function of the unscaled transition “rate” matrix, π, and the similarity matrix, φ. The full set of variables is partitioned into blocks: {γ, α, β,π}, {z,u,Q,Λ}, {θ, `}, and {ξ}, where Λ represents a set of auxiliary variables that will be introduced below, θ represents the emission parameters (which may be further blocked depending on the specific choice of model), and ξ represents additional parameters such as any free parameters of the similarity function, φ, and any hyperparameters of the emission distribution."
    }, {
      "heading" : "3.1. Sampling Transition Parameters and Hyperparameters",
      "text" : "The joint posterior over γ, α, β and π given the augmented data D = (z,u,Q,Λ) will factor as\np(γ,α,β,π | D) = p(γ | D)p(α | D)p(β | γ,D)p(π |α, β,D) (14)\nWe describe these four factors in reverse order. For additional details, see Appendix B.\nSampling π Having used data augmentation to simplify the likelihood for π to the factored conjugate form in (40), the individual πjj′ are a posteriori independent Gamma(αβj′ + njj′ + qjj′ , 1 + uj) distributed.\nSampling β To enable joint sampling of z, we employ a weak limit approximation to the HDP (Johnson & Willsky, 2013), approximating the stick-breaking process for β using a finite Dirichlet distribution with a J components, where J is larger than we expect to need. Due to the product-of-Gammas form, we can integrate out π analytically to obtain the marginal likelihood:\np(β | γ) = Γ(γ/J) J\nΓ(γ) ∏ j β γ J−1 j (15)\np(D |β, α) ∝ J∏ j=1 (1 + uj) −α ∏ j′ Γ(αβj′ + njj′ + qjj′) Γ(αβj′)\nwhere we have used the fact that the βj sum to 1 to pull out terms of the form (1 + uj)−αβj′ from the inner product in the likelihood. Following Teh et al. (2006), we can introduce auxiliary variables M = {mjj′}, with\np(mjj′ |βj′ , α,D) ind∝ snjj′+qjj′ ,mjj′α mjj′β mjj′ j′ (16)\nfor integer mjj′ ranging between 0 and njj′ + qjj′ , where sn,m is an unsigned Stirling number of the first kind. The normalizing constant in this distribution cancels the ratio of Gamma functions in the β likelihood, so, letting m·j′ = ∑ jmjj′ and m·· = ∑ j′ m·j′ , the posterior for (the truncated) β is a Dirichlet whose jth mass parameter is γJ +m·j .\nSampling Concentration Parameters Incorporating M into D, we can integrate out β to obtain\np(D |α, γ) ∝ αm··e− ∑ j′′ log(1+uj′′ )α\nΓ(γ) Γ(γ +m··) × ∏ j Γ( γJ +m·j) Γ( γJ )\n(17)\nAssuming that α and γ have Gamma priors with shape and rate parameters aα, bα and aγ , bγ , then\nα | D ∼ Gamma(aα +m··, bα + ∑ j log(1 + uj)). (18)\nTo simplify the likelihood for γ, we can introduce a final set of auxiliary variables, r = (r1, . . . , rJ), rj′ ∈ {0, . . . ,m·j′} and w ∈ (0, 1) with the following distributions:\np(rj′ = r |m·j′ , γ) ∝ s(m·j′ , r) ( γ J )r (19) p(w |m··γ) ∝ wγ−1(1− w)m··−1 (20)\nThe normalizing constants are ratios of Gamma functions, which cancel those in (17), so that\nγ | D, r, w ∼ Gamma(aγ + r·, bγ − log(w)) (21)"
    }, {
      "heading" : "3.2. Sampling z and the auxiliary variables",
      "text" : "We sample the hidden state sequence, z, jointly with the auxiliary variables, which consist of u, Q, M, r and w. The joint conditional distribution of these variables is defined directly by the generative model:\np(D) = p(z)p(u | z)p(Q |u)p(M | z,Q)p(r |M)p(w |M)\nSince we are conditioning on the transition matrix, we can sample the entire sequence z jointly with the forwardbackward algorithm, as in an ordinary HMM. Since we are sampling the labels jointly, this step requiresO(TJ2) computation per iteration, which is the bottleneck of the inference algorithm for reasonably large T or J (other updates are constant in T or in J). Having done this, we can sample u, Q, M, r andw from their forward distributions. It is also possible to employ a variant on beam sampling (Van Gael et al., 2008) to speed up each iteration, at the cost of slower mixing, but we did not use this variant here."
    }, {
      "heading" : "3.3. Sampling state and emission parameters",
      "text" : "Depending on the application, the locations ` may or may not depend on the emission parameters, θ. If not, sampling θ conditional on z is unchanged from the HDP-HMM. There is no general-purpose method for sampling `, or for sampling θ in the dependent case, due to the dependence on the form of φ and on the emission model, but specific instances are illustrated in the experiments below."
    }, {
      "heading" : "4. Experiments",
      "text" : "The parameter space for the hidden states, the associated prior H on θ, and the similarity function φ, is applicationspecific; we consider here two cases. The first is a speakerdiarization task, where each state consists of a finite Ddimensional binary vector whose entries indicate which speakers are currently speaking. In this experiment, the state vectors both determine the pairwise similarities and partially determine the emission distributions via a linearGaussian model. In the second experiment, the data consists of Bach chorales, and the latent states can be thought of as harmonic contexts. There, the components of the states that govern similarities are modeled as independent of the emission distributions, which are categorical distributions over four-voice chords."
    }, {
      "heading" : "4.1. Cocktail Party",
      "text" : "The Data The data was constructed using audio signals collected from the PASCAL 1st Speech Separation Chal-\nlenge2. The underlying signal consisted ofD = 16 speaker channels recorded at each of T = 2000 time steps, with the resulting T × D signal matrix, denoted by θ∗, mapped to K = 12 microphone channels via a weight matrix, W. The 16 speakers were grouped into 4 conversational groups of 4, where speakers within a conversation took turns speaking (see Fig. 2). In such a task, there are naively 2D possible states (here, 65536). However, due to the conversational grouping, if at most one speaker in a conversation is speaking at any given time, the state space is constrained, with only ∏ c(sc + 1) states possible, where sc is the number of speakers in conversation c (in this case sc ≡ 4, for a total of 625 possible states).\nEach “turn” within a conversation consisted of a single sentence (average duration ∼ 3s) and turn orders within a conversation were randomly generated, with random pauses distributed as N (1/4s, (1/4s)2) inserted between sentences. Every time a speaker has a turn, the sentence is drawn randomly from the 500 sentences uttered by that speaker in the data. The conversations continued for 40s, and the signal was down-sampled to length 2000. The ’on’ portions of each speaker’s signal were normalized to have amplitudes with mean 1 and standard deviation 0.5. An additional column of 1s was added to the speaker signal matrix, θ∗, representing background noise. The resulting signal matrix, denoted θ∗, was thus 2000× 17 and the weight matrix, W, was 17× 12. Following Gael et al. (2009) and Valera et al. (2015), the weights were drawn independently from a Unif(0, 1) distribution, and independentN (0, 0.32) noise was added to each entry of the observation matrix.\nThe Model The latent states, θj , are the D-dimensional binary vectors whose dth entry indicates whether or not speaker d is speaking. The locations `j are identified with the binary vectors, `j := θj . We use a Laplacian similarity function on Hamming distance, d0, so that φjj′ := exp(−λd0(`j , `j′)), λ ≥ 0. The emission model is linearGaussian as in the data, with (D + 1) ×K weight matrix W, and T × (D + 1) signal matrix θ∗ whose tth row is θt := (1,θzt), so that yt | z ∼ N (WTθ ∗ t ,Σ). For the experiments discussed here, we assume that Σ is independent of j, but this assumption is easily relaxed if appropriate.\nFor finite-length binary vector states, the set of possible states is finite, and so it may seem that a nonparametric model is unnecessary. However, if D is reasonably large, likely most of the 2D possible states are vanishingly unlikely (and the number of observations may well be less than 2D), and so we would like to encourage the selection of a sparse set of states. Moreover, there could be more than one state with the same emission parameters, but with different transition dynamics. Next we describe the addi-\n2 http://laslab.org/SpeechSeparationChallenge/\ntional inference steps needed for this version of the model.\nSampling θ / ` Since θj and `j are identified, influencing both the transition matrix and the emission distributions, both the state sequence z and the observation matrix Y are used in the update. We put independent Beta-Bernoulli priors on each coordinate of θ, and Gibbs sample each coordinate θjd conditioned on all the others and the coordinatewise prior means, {µd}, which we sample in turn conditioned on θ. Details are in Appendix C.\nSampling λ The λ parameter of the similarity function governs the connection between ` and φ. Substituting the definition of φ into (40) yields\np(z,Q | `, λ) ∝ ∏ j ∏ j′ e−λdjj′njj′ (1− e−λdjj′ )qjj′ (22)\nWe put an Exp(bλ) prior on λ, which yields a posterior density\np(λ | z,Q, `) ∝ e−(bλ+ ∑ j ∑ j′ djj′njj′ )λ (23)\n× ∏ j ∏ j′ (1− e−λdjj′ )qjj′\nThis density is log-concave, and so we use Adaptive Rejection Sampling (Gilks & Wild, 1992) to sample from it.\nSampling W and Σ Conditioned on Y and θ∗, W and Σ can be sampled as in Bayesian linear regression. If each column of W has a multivariate Normal prior, then the columns are a posteriori independent multivariate Normals. For the experiments reported here, we fix W to its ground truth value so that θ∗ can be compared directly with the ground truth signal matrix, and we constrain Σ to be diagonal, with Inverse Gamma priors on the variances, resulting in conjugate updates.\nResults We attempted to infer the binary speaker matrices using five models: (1) a binary-state Factorial HMM (Ghahramani et al., 1997), where individual binary speaker sequences are modeled as independent, (2) an ordinary HDP-HMM without local transitions (Teh et al., 2006), where the latent states are binary vectors, (3) a Sticky HDPHMM (Fox et al., 2008), (4) our HDP-HMM-LT model, and (5) a model that combines the Sticky and LT properties3. For all models, all concentration and noise precision parameters are given Gamma(0.1, 0.1) priors. For the Sticky models, the ratio κα+κ is given a Unif(0, 1) prior. We evaluated the models at each iteration using both the\n3We attempted to add a comparison to the DILN-HMM (Zhu et al., 2016) as well, but code could not be obtained, and the paper did not provide enough detail to reproduce their inference algorithm.\nHamming distance between inferred and ground truth state matrices and F1 score. We also plot the inferred decay rate λ, and the number of states used by the LT and Sticky-LT models. The results for the five models are in Fig. 1. In Fig. 2, we plot the ground truth state matrix against the average state matrix, η∗, averaged over runs and post-burn-in iterations.\nThe LT and Sticky-LT models outperform the others, while the regular Sticky model exhibits only a small advantage over the vanilla HDP-HMM. Both converge on a nonnegligible λ value of about 1.6 (see Fig. 1), suggesting that the local transition structure explains the data well. The LT models also use more states than the non-LT models, perhaps owing to the fact that the weaker transition prior of the non-LT model is more likely to explain nearby similar observations as a single persisting state, whereas the LT model places a higher probability on transitioning to a new state with a similar latent vector."
    }, {
      "heading" : "4.2. Synthetic Data Without Local Transitions",
      "text" : "We generated data directly from the ordinary HDP-HMM used in the cocktail experiment as a sanity check, to examine the performance of the LT model in the absence of a similarity bias. The results are in Fig. 3. When the λ parameter is large, the LT model has worse performance than the non-LT model on this data; however, the λ parameter settles near zero as the model learns that local transitions are not more probable. When λ = 0, the HDP-HMM-LT is an ordinary HDP-HMM. The LT model does not make entirely the same inferences as the non-LT model, however; in particular, the α concentration parameter is larger. To some\nextent, α and λ trade off: sparsity of the transition matrix can be achieved either by beginning with a sparse rate matrix prior to rescaling (α small), or by beginning with a less sparse rate matrix which becomes sparser through rescaling (larger α and non-zero λ)."
    }, {
      "heading" : "4.3. Bach Chorales",
      "text" : "To test a version of the HDP-HMM-LT model in which the components of the latent state governing similarity are unrelated to the emission distributions, we used our model to do unsupervised “grammar” learning from a corpus of Bach chorales. The data was a corpus of 217 four-voice major key chorales by J.S. Bach from music214, 200 of which were randomly selected as a training set, with the other 17 used as a test set to evaluate surprisal (marginal log likelihood per observation) by the trained models. All chorales were transposed to C-major, and each distinct four-voice chord (with voices ordered) was encoded as a single integer. In total there were 3307 distinct chord types and 20401 chord tokens in the 217 chorales, with 3165 types and 18818 tokens in the 200 training chorales, and 143 chord types that were unique to the test set.\nModifications to Model and Inference Since the chords were encoded as integers, the emission distribution for each state is Cat(θj). We use a symmetric Dirichlet prior for each θj , resulting in conjugate updates to θ conditioned on the latent state sequence, z.\n4 http://web.mit.edu/music21\nIn this experiment, the locations, `j , are independent of the θj , withN (0, I) priors. We use a Gaussian similarity function, φjj := exp{−λd2(`j , `j′)2} where d2 is Euclidean distance. Since the latent states are continuous, we use a Hamiltonian Monte Carlo (HMC) update (Duane et al., 1987; Neal et al., 2011) to update the `j simultaneously, conditioned on z and π (see Appendix D for details).\nResults We ran 5 Gibbs chains for 10,000 iterations each using the HDP-HMM-LT, Sticky-HDP-HMM-LT, HDPHMM and Sticky-HDP-HMM models on the 200 training chorales, which were modeled as conditionally independent of one another. We evaluated the marginal log likelihood on the 17 test chorales (integrating out z) at every 50th iteration. The training and test log likelihoods are in Fig. 4. Although the LT model does not achieve as close a fit to the training data, its generalization performance is better, suggesting that the vanilla HDP-HMM is overfitting. This is perhaps counterintuitive, since the LT model is more flexible, and might be expected to be more prone to overfitting. However, the similarity bias induces greater information sharing across parameters, as in a hierarchical model: instead of each entry of the transition matrix being informed mainly by transitions directly involving the corresponding states, it is informed to some extent by all transitions, as they all inform the similarity structure."
    }, {
      "heading" : "5. Discussion",
      "text" : "We have defined a new probabilistic model, the Hierarchical Dirichlet Process Hidden Markov Model with Local Transitions (HDP-HMM-LT), which generalizes the\nHDP-HMM by allowing state space geometry to be represented via a similarity kernel, making transitions between “nearby” pairs of states (“local” transitions), more likely a priori. By introducing an augmented data representation, which we call the Markov Jump Process with Failed Transitions (MJP-FT), we obtain a Gibbs sampling algorithm that simplifies inference in both the LT and ordinary HDPHMM. When multiple latent chains are interdependent, as in speaker diarization, the HDP-HMM-LT model combines the HDP-HMM’s capacity to discover a small set of joint states with the Factorial HMM’s ability to encode the property that most transitions involve a small number of chains. The HDP-HMM-LT outperforms both, as well as outperforming the Sticky-HDP-HMM, on a speaker diarization task in which speakers form conversational groups. Despite the addition of the similarity kernel, the HDP-HMM-LT is able to suppress its local transition prior when the data does not support it, achieving identical performance to the HDPHMM on data generated directly from the latter.\nThe local transition property is particularly clear when transitions occur at different times for different latent features, as with binary vector-valued states in the cocktail party setting, but the model can be used with any state space equipped with a suitable similarity kernel. Similarities need not be defined in terms of emission parameters; state “locations” can be represented and inferred separately, which we demonstrate using Bach chorale data. There, the LT model achieves better predictive performance on a held-out test set, while the ordinary HDP-HMM overfits the training set: the LT property here acts to encourage a concise harmonic representation where chord contexts are arranged in bidirectional functional relationships.\nWe focused on fixed-dimension binary vectors for the cocktail party and synthetic data experiments, but it would be straightforward to add the LT property to a model with nonparametric latent states, such as the iFHMM (Gael et al., 2009) and the infinite factorial dynamic model (Valera et al., 2015), both of which use the Indian Buffet Process (IBP) (Ghahramani & Griffiths, 2005) as a state prior. The\nsimilarity function used here could be employed without changes: since only finitely many coordinates are non-zero in the IBP, the distance between any two states is finite."
    }, {
      "heading" : "ACKNOWLEDGMENTS",
      "text" : "This work was funded in part by DARPA grant W911NF14-1-0395 under the Big Mechanism Program and DARPA grant W911NF-16-1-0567 under the Communicating with Computers Program."
    }, {
      "heading" : "A. Details of the Markov Jump Process with Failed Transitions Representation",
      "text" : "We can gain stronger intuition, as well as simplify posterior inference, by re-casting the HDP-HMM-LT as a continuous time Markov Jump Process where some of the attempts to jump from one state to another fail, and where the failure probability increases as a function of the “distance” between the states.\nLet φ be defined as in the last section, and let β, θ and π be defined as in the Normalized Gamma Process representation of the ordinary HDP-HMM. That is,\nβ ∼ GEM(γ) (24)\nθj i.i.d∼ H (25)\nπjj′ |β,θ ∼ Gamma(αβj′ , 1) (26)\nNow suppose that when the process is in state j, jumps to state j′ are made at rate πjj′ . This defines a continuous-time Markov Process where the off-diagonal elements of the transition rate matrix are the off diagonal elements of π. In addition, self-jumps are allowed, and occur with rate πjj . If we only observe the jumps and not the durations between jumps, this is an ordinary Markov chain, whose transition matrix is obtained by appropriately normalizing π. If we do not observe the jumps themselves, but instead an observation is generated once per jump from a distribution that depends on the state being jumped to, then we have an ordinary HMM.\nWe modify this process as follows. Suppose that each jump attempt from state j to state j′ has a chance of failing, which is an increasing function of the “distance” between the states. In particular, let the success probability be φjj′ (recall that we assumed above that 0 ≤ φjj′ ≤ 1 for all j, j′). Then, the rate of successful jumps from j to j′ is πjj′φjj′ , and the corresponding rate of unsuccessful jump attempts is πjj′(1 − φjj′). To see this, denote by Njj′ the total number of jump attempts to j′ in a unit interval of time spent in state j. Since we are assuming the process is Markovian, the total number of attempts is Poisson(πjj′) distributed. Conditioned on Njj′ , njj′ will be successful, where\nnjj′ |Njj′ ∼ Binom(Njj′ , φjj′) (27)\nIt is easy to show (and well known) that the marginal distribution of njj′ is Poisson(πjj′φjj′), and the marginal distribution of q̃jj′ := Njj′ − njj′ is Poisson(πjj′(1 − φjj′)). The rate of successful jumps from state j overall is then Tj :=∑ j′ πjj′φjj′ .\nLet t index jumps, so that zt indicates the tth state visited by the process (couting self-jumps as a new time step). Given that the process is in state j at discretized time t− 1 (that is, zt−1 = j), it is a standard property of Markov Processes that the probability that the first successful jump is to state j′ (that is, zt = j′) is proportional to the rate of successful attempts to j′, which is πjj′φjj′ .\nLet ũt indicate the time elapsed between the tth and and t−1th successful jump (where we assume that the first observation occurs when the first successful jump from a distinguished initial state is made). We have\nũt | zt−1 ∼ Exp(Tzt−1) (28)\nwhere ũt is independent of zt.\nDuring this period, there will be q̃j′t unsuccessful attempts to jump to state j′, where\nq̃j′t | zt−1 ∼ Poisson(ũtπzt−1j′(1− φzt−1j′)) (29)\nDefine the following additional variables\nTj = {t | zt−1 = j} (30) qjj′ = ∑ t∈Tj q̃j′t (31)\nuj = ∑ t∈Tj ũt (32)\nand let Q = (qjj′)j,j′≥1 be the matrix of unsuccessful jump attempt counts, and u = (uj)j≥1 be the vector of the total times spent in each state.\nSince each of the ũt with t ∈ Tj are i.i.d. Exp(Tj), we get the marginal distribution\nuj | z,π,φ ind∼ Gamma(nj·, Tj) (33)\nby the standard property that sums of i.i.d. Exponential distributions has a Gamma distribution with shape equal to the number of variates in the sum, and rate equal to the rate of the individual exponentials. Moreover, since the q̃j′t with t ∈ Tj are Poisson distributed, the total number of failed attempts in the total duration uj is\nqjj′ ind∼ Poisson(ujπjj′(1− φjj′)). (34)\nThus if we marginalize out the individual ũt and q̃j′t, we have a joint distribution over z, u, and Q, conditioned on the transition rate matrix π and the success probability matrix φ, which is\np(z,u,Q |π,φ) = ( T∏ t=1 p(zt | zt−1) )∏ j p(uj | z,π,φ) ∏ j′ p(qjj′ |ujπjj′ , φjj′) (35)\n= (∏ t πzt−1ztφzt−1zt Tzt−1 )∏ j T nj· j Γ(nj·) u nj·−1 j e −Tjuj (36)\n× ∏ j′ e−ujπjj′ (1−φjj′ )u qjj′ j π qjj′ jj′ (1− φjj′) qjj′ (qjj′ !) −1 (37)\n= ∏ j Γ(nj·) −1u nj·+qj·−1 j (38)\n× ∏ j′ π njj′+qjj′ jj′ φ njj′ jj′ (1− φjj′) qjj′ e−πjj′φjj′uje−πjj′ (1−φjj′ )uj (qjj′ !) −1 (39)\n= ∏ j Γ(nj·) −1u nj·+qj·−1 j ∏ j′ π njj′+qjj′ jj′ φ njj′ jj′ (1− φjj′) qjj′ e−πjj′uj (qjj′ !) −1 (40)\nSetting aside terms that do not depend on π, we get the conditional likelihood function used in sampling π: p(z,u,Q |π,φ) ∝ ∏ j ∏ j′ π njj′+qjj′ jj′ e −πjj′uj (41)\nwhich, combined with the independent Gamma priors on π yields conditionally independent Gamma posteriors:\nπjj′ | z,u,Q,β, α ind.∼ Gamma(αβj′ + njj′ + qjj′ , 1 + uj) (42)\nB. Inference details for hyperparameters of the rescaled HDP B.1. Sampling π, β, α and γ\nThe joint conditional over γ, α, β and π given the augmented data D = (z,u,Q,M, r, w) factors as\np(γ, α, β, π | D) = p(γ | D)p(α | D)p(β | γ,D)p(π |α, β,D) (43)\nWe will derive these four factors in reverse order.\nSampling π The entries in π are conditionally independent given α and β, so we have the prior p(π |β, α) = ∏ j ∏ j′ Γ(αβj′) −1π αβj′−1 jj′ exp(−πjj′), (44)\nand the likelihood given {z,u,Q} given by (40). Combining these, we have p(π, z,u,Q |β, α,φ) = ∏ j u nj·+qj·−1 j ∏ j′ Γ(αβj′) −1π αβj′+njj′+qjj′−1 jj′ (45)\n× e−(1+uj)πjj′φnjj′jj′ (1− φjj′) qjj′ (qjj′ !) −1 (46)\nConditioning on everything except π, we get p(π |Q,u, z,β, α) ∝ ∏ j ∏ j′ π αβj′+njj′+qjj′−1 jj′ exp(−(1 + uj)πjj′) (47)\nand thus we see that the πjj′ are conditionally independent given u, z and Q, and distributed according to\nπjj′ |njj′ , qjj′ , βj′ , α ind∼ Gamma(αβj′ + njj′ + qjj′ , 1 + uj) (48)\nSampling β Consider the conditional distribution of β having integrated out π. The prior density of β is\np(β | γ) = Γ(γ) Γ( γJ ) J ∏ j β γ J−1 j (49)\nAfter integrating out π in (45), we have\np(z,u,Q |β, α, γ,φ) = J∏ j=1 u−1j J∏ j′=1 unjj′+qjj′−1(1 + uj) −(αβj′+njj′+qjj′ ) (50)\n× Γ(αβj ′ + njj′ + qjj′) Γ(αβj′) φ njj′ jj′ (1− φjj′) qjj′ (qjj′ !) −1 (51)\n= J∏ j=1 Γ(nj·) −1u−1j (1 + uj) −α ( uj 1 + uj )nj·+qj· (52)\n× J∏\nj′=1\nΓ(αβj′ + njj′ + qjj′)\nΓ(αβj′) φ njj′ jj′ (1− φjj′) qjj′ (qjj′ !) −1 (53)\nwhere we have used the fact that the βj sum to 1. Therefore\np(β | z,u,Q, α, γ) ∝ J∏ j=1 β γ J−1 j J∏ j′=1 Γ(αβj′ + njj′ + qjj′) Γ(αβj′) . (54)\nFollowing (Teh et al., 2006), we can write the ratios of Gamma functions as polynomials in βj , as\np(β | z,u,Q, α, γ) ∝ J∏ j=1 β γ J−1 j J∏ j′=1 njj′∑ mjj′=1 s(njj′ + qjj′ ,mjj′)(αβj′) mjj′ (55)\nwhere s(m,n) is an unsigned Stirling number of the first kind, which is used to represent the number of permutations of n elements such that there are m distinct cycles.\nThis admits an augmented data representation, where we introduce a random matrix M = (mjj′)1≤j,j′≤J , whose entries are conditionally independent given β, Q and z, with\np(mjj′ = m |βj′ , α, njj′ , qjj′) = s(njj′ + qjj′ ,m)α mβmj′∑njj′+qjj′ m′=0 s(njj′ + qjj′ ,m ′)αm′βm ′ j′\n(56)\nfor integer m ranging between 0 and njj′ + qjj′ . Note that s(n, 0) = 0 if n > 0, s(0, 0) = 1, s(0,m) = 0 if m > 0, and we have the recurrence relation s(n + 1,m) = ns(n,m) + s(n,m − 1), and so we could compute each of these coefficients explicitly; however, it is typically simpler and more computationally efficient to sample from this distribution by simulating the number of occupied tables in a Chinese Restaurant Process with n customers, than it is to enumerate its probabilities.\nFor each mjj′ we simply draw njj′ assignments of customers to tables according to the Chinese Restaurant Process and set mjj′ to be the number of distinct tables realized; that is, assign the first customer to a table, setting mjj′ to 1, and then, after n customers are assigned, assign the n+ 1th customer to a new table with probability αβj′/(n+αβj′), in which case we increment mjj′ , and to an existing table with probability n/(n+ α), in which case we do not increment mjj′ .\nThen, we have joint distribution\np(β,M | z,u,Q, α, γ) ∝ J∏ j=1 β γ J−1 j J∏ j′=1 s(njj′ + qjj′ ,mjj′)α mjj′β mjj′ j′ (57)\nwhich yields (55) when marginalized over M. Again discarding constants in β and regrouping yields\np(β |M, z, u, θ, α, γ) ∝ J∏\nj′=1\nβ γ J+m·j′−1 j′ (58)\nwhich is Dirichlet: β |M,γ ∼ Dirichlet( γ\nJ +m·1, . . . ,\nγ J +m·J) (59)\nSampling α and γ Assume that α and γ have Gamma priors, parameterized by shape, a and rate, b:\np(α) = baαα\nΓ(aα) αaα−1 exp(−bαα) (60)\np(γ) = b aγ γ\nΓ(aγ) γaγ−1 exp(−bγγ) (61)\nHaving integrated out π, we have\np(β, z,u,Q,M |α, γ,φ) = Γ(γ) Γ( γJ ) J αm·· J∏ j=1 β γ J+m·j−1 j Γ(nj·) −1u−1j (1 + uj) −α ( uj 1 + uj )nj·+qj· (62)\n× J∏\nj′=1\ns(njj′ + qjj′ ,mjj′)φ njj′ jj′ (1− φjj′) qjj′ (qjj′ !) −1 (63)\nWe can also integrate out β, to yield\np(z,u,Q,M |α, γ,φ) = αm··e− ∑ j′′ log(1+uj′′ )α Γ(γ)\nΓ(γ +m··) (64)\n× ∏ j Γ( γJ +m·j) Γ( γJ )Γ(nj·) u−1j ( uj 1 + uj )nj·+qj· (65) × J∏\nj′=1\ns(njj′ + qjj′ ,mjj′)φ njj′ jj′ (1− φjj′) qjj′ (qjj′ !) −1 (66)\ndemonstrating that α and γ are independent given φ and the augmented data, with\np(α | z,u,Q,M) ∝ αaα+m·· exp(−(bα + ∑ j log(1 + uj))α) (67)\nand\np(γ | z,u,Q,M) ∝ γaγ−1 exp(−bγγ) Γ(γ)\n∏J j=1 Γ( γ J +m·j)\nΓ( γJ ) JΓ(γ +m··)\n(68)\nSo we see that α | z,u,Q,M ∼ Gamma(aα +m··, bα + ∑ j log(1 + uj)) (69)\nTo sample γ, we introduce a new set of auxiliary variables, r = (r1, . . . , rJ) and w with the following distributions:\np(rj′ = r |m·j′ , γ) = Γ( γJ )\nΓ( γJ +m·j′) s(m·j′ , r)\n( γ J )r r = 1, . . . ,m·j (70)\np(w |m··γ) = Γ(γ +m··)\nΓ(γ)Γ(m··) wγ−1(1− w)m··−1 w ∈ (0, 1) (71)\nso that\np(γ, r, w |M) ∝ γaγ−1 exp(−bγγ)wγ−1(1− w)m··−1 J∏\nj′=1\ns(m·j′ , rj′) ( γ J )rj′ (72)\nand\np(γ | r, w) ∝ γaγ+r·−1 exp(−(bγ − log(w))γ), (73)\nwhich is to say γ | r, w, z,u,Q,M ∼ Gamma(aγ + r·, bγ − log(w)) (74)"
    }, {
      "heading" : "C. Derivation of η update in the Cocktail Party and Synthetic Data Experiments",
      "text" : "In principle, η can have any distribution over binary vectors, but we will suppose for simplicity that it can be factored into D independent coordinate-wise Bernoulli variates. Let µd be the Bernoulli parameter for the dth coordinate.\nThe similarity function φjj′ is the Laplacian kernel:\nφjj′ = Φ(ηj ,ηj′) = exp(−λdjj′) (75)\nwhere djj′d = ∣∣ηjd − ηj′d∣∣ is Hamming distance in the dth coordinate, djj′ := ∑Dd=1 djj′ is the total Hamming distance between ηj and ηj′ , and λ ≥ 0 (if λ = 0, the φjj′ are identically 1, and so do not have any influence, reducing the model to an ordinary HDP-HMM).\nLet\nφjj′−d = exp(−λ(djj′ − djj′d)) (76)\nso that φjj′ = φjj′−de−λdjj′d .\nSince the matrix φ is assumed to be symmetric, we have\np(z,Q | ηjd = 1,η \\ ηjd) p(z,Q | ηjd = 0,η \\ ηjd) ∝ ∏ j′ 6=j e−λ(njj′+nj′j)|1−θj′d|(1− φjj′−de−λ|1−θj′d|)qjj′+qj′j e−λ(njj′+nj′j)|θj′d|(1− φjj′−de−λ|θj′d|)qjj′+qj′j (77)\n= e−λ(cjd0−cjd1) ∏ j′ 6=j ( 1− φjj′−de−λ 1− φjj′−d )(−1)θj′d (qjj′+qj′j) (78)\nwhere cjd0 and cjd1 are the number of successful jumps to or from state j, to or from states with a 0 or 1, respectively, in position d. That is, cjd0 = ∑\n{j′ | θj′d=0}\nnjj′ + nj′j cjd1 = ∑\n{j′ | θj′d=1}\nnjj′ + nj′j (79)\nTherefore, we can Gibbs sample ηjd from its conditional posterior Bernoulli distribution given the rest of η, where we compute the Bernoulli parameter via the log-odds\nlog ( p(ηjd = 1 |Y, z,Q,η \\ ηjd) p(ηjd = 0 |Y, z,Q,η \\ ηjd) ) = log ( p(ηjd = 1)p(z,Q | ηjd = 1,η \\ ηjd)p(Y | z, ηjd = 1,η \\ ηjd) p(ηjd = 0)p(z,Q | ηjd = 0,η \\ ηjd)p(Y | z, ηjd = 0,η \\ ηjd) ) (80)\n= log\n( µd\n1− µd\n) + (cjd1 − cjd0)λ+ ∑ j′ 6=j (−1)θj′d(qjj′ + qj′j) log ( 1− φ(−d)jj′ e−λ 1− φ(−d)jj′ ) (81)\n+ ∑\n{t | zt=j}\nlog ( f(yt; ηjd = 1,ηj \\ ηjd) f(yt; ηjd = 0,ηj \\ ηjd) ) (82)\nSuppose also that the observed data Y consists of a T × K matrix, where the tth row yt = (yt1, . . . , ytK)T is a Kdimensional feature vector associated with time t, and let W be a D × K weight matrix with kth column wk, such that\nf(yt;ηj) = g(yt; W Tηj) (83)\nfor a suitable parametric function g. We assume for simplicity that g factors as\ng(yt; W Tηj) = K∏ k=1 gk(ytk; wk · ηj) (84)\nDefine xtk = wk · θzt , and x (−d) tk = w −d k · θ−dzt , where θ −d j and w −d k are θj and wk, respectively, with the dth coordinate removed. Then\nlog ( f(yt; ηjd = 1,ηj \\ ηjd) f(yt; ηjd = 0,ηj \\ ηjd) ) = K∑ k=1 log ( gk(ytk;x (−d) tk + wdk) gk(ytk;x (−d) tk ) ) . (85)\nIf gk(y;x) is a Normal density with mean x and unit variance, then\nlog\n( gk(ytk;x (−d) tk + wdk)\ngk(ytk;x (−d) tk )\n) = −wdk(ytk − x(−d)tk + 1\n2 wdk) (86)"
    }, {
      "heading" : "D. Derivation of HMC update for ` in the Bach Chorale Experiment",
      "text" : "We have a set of states with parameters `j , j = 1, . . . , J . In the previous version of the model, `j was a binary state vector on which both the similarities φjj′ and the emission distribution Fj depended. Here, we define the latent locations `j = (`j1, `jD) to be locations in RD, independent of the emission distributions, so that during inference they are informed solely by the transitions.\nWe set\nφjj′(`j , `j′) = exp\n( −λ\n2 d2jj′ ) where djj′ is the Euclidean distance between `j and `j′ ; that is,\nd2jj′ = ∑ d (`jd − `j′d)2\nSince now `j are continuous locations, we use Hamlitonian Monte Carlo (Duane et al., 1987; Neal et al., 2011) to sample them jointly. HMC is a variation on Metropolis-Hastings algorithm which is designed to more efficiently explore a highdimensional continuous distribution by adopting a proposal distribution which incorporates an auxiliary “momentum” variable to make it more likely that proposals will go in useful directions and improve mixing compared to naive movement.\nTo do Hamiltonian Monte Carlo to sample from the conditional posterior of ` given z and Q, we need to compute the gradient of the log posterior, which is just the sum of the gradient of the log prior and the gradient of the log likelihood.\nAssume independent and isotropic Gaussian priors on each `j , so we have\np(`j) ∝ exp ( −h`\n2 ∑ d `2jd\n) ,\nwhere h` is the prior precision which does not depend on d.\nThen the log prior density, up to an additive constant c, is\nlog p(`j) = c− h` 2 ∑ d `2jd\nThe relevant log likelihood is the log of the probability of the z and Q variables given the φjj′ . In particular, we have\nL := p(z,Q |φ) ∝ ∏ j ∏ j′ φ njj′ jj′ (1− φjj′) qjj′\nso that logL = ∑ j ∑ j′ (njj′ log(φjj′) + qjj′ log(1− φjj′))\nThe j, d coordinate of the gradient of the log prior is simply −h``jd.\nTo get the j, d coordinate of the gradient of the log likelihood, we can apply the chain rule to terms as is convenient. In particular,\n∂L ∂`jd = ∑ j ∑ j′ njj′ ∂ log(φjj′) ∂d2jj′ ∂d2jj′ ∂`jd + ∑ j ∑ j′ qjj′ ∂ log(1− φjj′) ∂(1− φjj′) ∂(1− φjj′) ∂d2jj′ ∂d2jj′ ∂`jd\nWe have the following components:\n∂ log(φjj′) ∂d2jj′ = −λ 2\n∂d2jj′ ∂`jd = 2djj′dI(j 6= j′)\n∂ log(1− φjj′) ∂(1− φjj′) = 1\n1− φjj′ ∂(1− φjj′) ∂d2jj′ = λ 2 φjj′\nwhich yields\n∂L\n∂`jd = −λ ∑ j ∑ j′ njj′djj′dI(j 6= j′) + λ ∑ j ∑ j′ qjj′djj′d φjj′ 1− φjj′ I(j 6= j)\n= −λ ∑\n(j,j′):j 6=j′ djj′d\n( njj′ − qjj′ φjj′\n1− φjj′\n)"
    } ],
    "references" : [ {
      "title" : "The infinite hidden Markov model",
      "author" : [ "Beal", "Matthew J", "Ghahramani", "Zoubin", "Rasmussen", "Carl E" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "Beal et al\\.,? \\Q2001\\E",
      "shortCiteRegEx" : "Beal et al\\.",
      "year" : 2001
    }, {
      "title" : "Hybrid monte carlo",
      "author" : [ "Duane", "Simon", "Kennedy", "Anthony D", "Pendleton", "Brian J", "Roweth", "Duncan" ],
      "venue" : "Physics letters B,",
      "citeRegEx" : "Duane et al\\.,? \\Q1987\\E",
      "shortCiteRegEx" : "Duane et al\\.",
      "year" : 1987
    }, {
      "title" : "Population genetics theory – the past and the future",
      "author" : [ "Ewens", "Warren John" ],
      "venue" : "In Mathematical and Statistical Developments of Evolutionary Theory,",
      "citeRegEx" : "Ewens and John.,? \\Q1990\\E",
      "shortCiteRegEx" : "Ewens and John.",
      "year" : 1990
    }, {
      "title" : "MCMC for normalized random measure mixture models",
      "author" : [ "Favaro", "Stefano", "Teh", "Yee Whye" ],
      "venue" : "Statistical Science,",
      "citeRegEx" : "Favaro et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Favaro et al\\.",
      "year" : 2013
    }, {
      "title" : "A Bayesian analysis of some nonparametric problems",
      "author" : [ "Ferguson", "Thomas S" ],
      "venue" : "The annals of statistics,",
      "citeRegEx" : "Ferguson and S.,? \\Q1973\\E",
      "shortCiteRegEx" : "Ferguson and S.",
      "year" : 1973
    }, {
      "title" : "An HDP-HMM for systems with state persistence",
      "author" : [ "Fox", "Emily B", "Sudderth", "Erik B", "Jordan", "Michael I", "Willsky", "Alan S" ],
      "venue" : "In Proceedings of the 25th international conference on Machine learning,",
      "citeRegEx" : "Fox et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Fox et al\\.",
      "year" : 2008
    }, {
      "title" : "The infinite factorial hidden Markov model",
      "author" : [ "Gael", "Jurgen V", "Teh", "Yee W", "Ghahramani", "Zoubin" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Gael et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Gael et al\\.",
      "year" : 2009
    }, {
      "title" : "Infinite latent feature models and the Indian buffet process",
      "author" : [ "Ghahramani", "Zoubin", "Griffiths", "Thomas L" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "Ghahramani et al\\.,? \\Q2005\\E",
      "shortCiteRegEx" : "Ghahramani et al\\.",
      "year" : 2005
    }, {
      "title" : "Factorial hidden Markov models",
      "author" : [ "Ghahramani", "Zoubin", "Jordan", "Michael I", "Smyth", "Padhraic" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "Ghahramani et al\\.,? \\Q1997\\E",
      "shortCiteRegEx" : "Ghahramani et al\\.",
      "year" : 1997
    }, {
      "title" : "Adaptive rejection sampling for Gibbs sampling",
      "author" : [ "Gilks", "Walter R", "Wild", "Pascal" ],
      "venue" : "Applied Statistics,",
      "citeRegEx" : "Gilks et al\\.,? \\Q1992\\E",
      "shortCiteRegEx" : "Gilks et al\\.",
      "year" : 1992
    }, {
      "title" : "Exact and approximate sum representations for the Dirichlet process",
      "author" : [ "Ishwaran", "Hemant", "Zarepour", "Mahmoud" ],
      "venue" : "Canadian Journal of Statistics,",
      "citeRegEx" : "Ishwaran et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Ishwaran et al\\.",
      "year" : 2002
    }, {
      "title" : "Bayesian nonparametric hidden semi-Markov models",
      "author" : [ "Johnson", "Matthew J", "Willsky", "Alan S" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "Johnson et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Johnson et al\\.",
      "year" : 2013
    }, {
      "title" : "Completely random measures",
      "author" : [ "Kingman", "John" ],
      "venue" : "Pacific Journal of Mathematics,",
      "citeRegEx" : "Kingman and John.,? \\Q1967\\E",
      "shortCiteRegEx" : "Kingman and John.",
      "year" : 1967
    }, {
      "title" : "MCMC using Hamiltonian dynamics",
      "author" : [ "Neal", "Radford M" ],
      "venue" : "Handbook of Markov Chain Monte Carlo,",
      "citeRegEx" : "Neal and M,? \\Q2011\\E",
      "shortCiteRegEx" : "Neal and M",
      "year" : 2011
    }, {
      "title" : "The discrete infinite logistic normal distribution",
      "author" : [ "Paisley", "John", "Wang", "Chong", "Blei", "David M" ],
      "venue" : "Bayesian Analysis,",
      "citeRegEx" : "Paisley et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Paisley et al\\.",
      "year" : 2012
    }, {
      "title" : "Correlated random measures",
      "author" : [ "Ranganath", "Rajesh", "Blei", "David M" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "Ranganath et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Ranganath et al\\.",
      "year" : 2016
    }, {
      "title" : "A constructive definition of Dirichlet processes",
      "author" : [ "Sethuraman", "Jayaram" ],
      "venue" : "Statistica Sinica,",
      "citeRegEx" : "Sethuraman and Jayaram.,? \\Q1994\\E",
      "shortCiteRegEx" : "Sethuraman and Jayaram.",
      "year" : 1994
    }, {
      "title" : "Hierarchical Dirichlet processes",
      "author" : [ "Teh", "Yee Whye", "Jordan", "Michael I", "Beal", "Matthew J", "Blei", "David M" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "Teh et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Teh et al\\.",
      "year" : 2006
    }, {
      "title" : "Infinite factorial dynamical model",
      "author" : [ "Valera", "Isabel", "Ruiz", "Francisco", "Svensson", "Lennart", "Perez-Cruz", "Fernando" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Valera et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Valera et al\\.",
      "year" : 2015
    }, {
      "title" : "Beam sampling for the infinite hidden Markov model",
      "author" : [ "Van Gael", "Jurgen", "Saatci", "Yunus", "Teh", "Yee Whye", "Ghahramani", "Zoubin" ],
      "venue" : "In Proceedings of the 25th International Conference on Machine Learning,",
      "citeRegEx" : "Gael et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Gael et al\\.",
      "year" : 2008
    }, {
      "title" : "Hidden Markov models with discrete infinite logistic normal distribution priors",
      "author" : [ "Zhu", "Hao", "Hu", "Jinsong", "Leung", "Henry" ],
      "venue" : "In Information Fusion (FUSION),",
      "citeRegEx" : "Zhu et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Zhu et al\\.",
      "year" : 2016
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Introduction and Background The hierarchical Dirichlet process hidden Markov model (HDP-HMM) (Beal et al., 2001; Teh et al., 2006) is a Bayesian model for time series data that generalizes the conventional hidden Markov Model to allow a countably infinite state space.",
      "startOffset" : 93,
      "endOffset" : 130
    }, {
      "referenceID" : 17,
      "context" : "Introduction and Background The hierarchical Dirichlet process hidden Markov model (HDP-HMM) (Beal et al., 2001; Teh et al., 2006) is a Bayesian model for time series data that generalizes the conventional hidden Markov Model to allow a countably infinite state space.",
      "startOffset" : 93,
      "endOffset" : 130
    }, {
      "referenceID" : 5,
      "context" : "The Sticky HDP-HMM (Fox et al., 2008) addresses this issue by adding an extra mass κ at location j to the base measure of the DP that generates πj .",
      "startOffset" : 19,
      "endOffset" : 37
    }, {
      "referenceID" : 5,
      "context" : "The Sticky HDP-HMM (Fox et al., 2008) addresses this issue by adding an extra mass κ at location j to the base measure of the DP that generates πj . That is, (2) is replaced by πj ∼ DP(αG0 + κδθj ). (5) An alternative approach that treats self-transitions as special is the HDP Hidden Semi-Markov Model (HDPHSMM; Johnson & Willsky (2013)), wherein state duration distributions are modeled separately, and ordinary selftransitions are ruled out.",
      "startOffset" : 20,
      "endOffset" : 338
    }, {
      "referenceID" : 8,
      "context" : "Factorial HMMs (Ghahramani et al., 1997) are commonly used in this setting, but this ignores dependence among chains, and hence may do poorly when some combinations of states are much more probable than suggested by the chain-wise dynamics.",
      "startOffset" : 15,
      "endOffset" : 40
    }, {
      "referenceID" : 12,
      "context" : "A rescaling and renormalization approach similar to the one used in the HDP-HMM-LT is used by Paisley et al. (2012) to define their Discrete Infinite Logistic Normal (DILN) model, an instance of a correlated random measure (Ranganath & Blei, 2016), in the setting of topic modeling.",
      "startOffset" : 94,
      "endOffset" : 116
    }, {
      "referenceID" : 12,
      "context" : "A rescaling and renormalization approach similar to the one used in the HDP-HMM-LT is used by Paisley et al. (2012) to define their Discrete Infinite Logistic Normal (DILN) model, an instance of a correlated random measure (Ranganath & Blei, 2016), in the setting of topic modeling. There, however, the contexts and the mixture components (topics) are distinct sets, and there is no notion of temporal dependence. Zhu et al. (2016) developed an HMM based directly on the DILN model1.",
      "startOffset" : 94,
      "endOffset" : 432
    }, {
      "referenceID" : 14,
      "context" : "It has been shown (Ferguson, 1973; Paisley et al., 2012; Favaro et al., 2013) that the normalization constant T is positive and finite almost surely, and thatG is distributed as a DP with base measure G0 = ∑∞ k=1 βkδθk .",
      "startOffset" : 18,
      "endOffset" : 77
    }, {
      "referenceID" : 3,
      "context" : "It has been shown (Ferguson, 1973; Paisley et al., 2012; Favaro et al., 2013) that the normalization constant T is positive and finite almost surely, and thatG is distributed as a DP with base measure G0 = ∑∞ k=1 βkδθk .",
      "startOffset" : 18,
      "endOffset" : 77
    }, {
      "referenceID" : 20,
      "context" : "The DILN-HMM (Zhu et al., 2016), employs a similar rescaling of transition probabilities via an exponentiated Gaussian Process, following (Paisley et al.",
      "startOffset" : 13,
      "endOffset" : 31
    }, {
      "referenceID" : 14,
      "context" : ", 2016), employs a similar rescaling of transition probabilities via an exponentiated Gaussian Process, following (Paisley et al., 2012), but the scaling function must be positive semi-definite, and in particular symmetric, whereas in the HDP-HMM-LT, φ need only take values in (0, 1].",
      "startOffset" : 114,
      "endOffset" : 136
    }, {
      "referenceID" : 5,
      "context" : "Sticky and Semi-Markov Generalizations We note that the local transition property of the HDPHMM-LT can be combined with the Sticky property of the Sticky HDP-HMM (Fox et al., 2008), or the nongeometric duration distributions of the HDP-HSMM (Johnson & Willsky, 2013), to add additional prior weight on self-transitions.",
      "startOffset" : 162,
      "endOffset" : 180
    }, {
      "referenceID" : 8,
      "context" : "Such problems are often modeled using factorial HMMs (Ghahramani et al., 1997).",
      "startOffset" : 53,
      "endOffset" : 78
    }, {
      "referenceID" : 6,
      "context" : "An Infinite Factorial HDP-HMM-LT Nonparametric extensions of the factorial HMM, such as the infinite factorial hidden Markov Model (Gael et al., 2009) and the infinite factorial dynamic model (Valera et al.",
      "startOffset" : 131,
      "endOffset" : 150
    }, {
      "referenceID" : 18,
      "context" : ", 2009) and the infinite factorial dynamic model (Valera et al., 2015), have been developed in recent years by making use of the Indian Buffet Process (Ghahramani & Griffiths, 2005) as a state prior.",
      "startOffset" : 49,
      "endOffset" : 70
    }, {
      "referenceID" : 17,
      "context" : "Following Teh et al. (2006), we can introduce auxiliary variables M = {mjj′}, with p(mjj′ |βj′ , α,D) ind ∝ snjj′+qjj′ ,mjj′α jj′β mjj′ j′ (16) for integer mjj′ ranging between 0 and njj′ + qjj′ , where sn,m is an unsigned Stirling number of the first kind.",
      "startOffset" : 10,
      "endOffset" : 28
    }, {
      "referenceID" : 6,
      "context" : "Following Gael et al. (2009) and Valera et al.",
      "startOffset" : 10,
      "endOffset" : 29
    }, {
      "referenceID" : 6,
      "context" : "Following Gael et al. (2009) and Valera et al. (2015), the weights were drawn independently from a Unif(0, 1) distribution, and independentN (0, 0.",
      "startOffset" : 10,
      "endOffset" : 54
    }, {
      "referenceID" : 8,
      "context" : "Results We attempted to infer the binary speaker matrices using five models: (1) a binary-state Factorial HMM (Ghahramani et al., 1997), where individual binary speaker sequences are modeled as independent, (2) an ordinary HDP-HMM without local transitions (Teh et al.",
      "startOffset" : 110,
      "endOffset" : 135
    }, {
      "referenceID" : 17,
      "context" : ", 1997), where individual binary speaker sequences are modeled as independent, (2) an ordinary HDP-HMM without local transitions (Teh et al., 2006), where the latent states are binary vectors, (3) a Sticky HDPHMM (Fox et al.",
      "startOffset" : 129,
      "endOffset" : 147
    }, {
      "referenceID" : 5,
      "context" : ", 2006), where the latent states are binary vectors, (3) a Sticky HDPHMM (Fox et al., 2008), (4) our HDP-HMM-LT model, and (5) a model that combines the Sticky and LT properties3.",
      "startOffset" : 73,
      "endOffset" : 91
    }, {
      "referenceID" : 20,
      "context" : "We evaluated the models at each iteration using both the We attempted to add a comparison to the DILN-HMM (Zhu et al., 2016) as well, but code could not be obtained, and the paper did not provide enough detail to reproduce their inference algorithm.",
      "startOffset" : 106,
      "endOffset" : 124
    }, {
      "referenceID" : 1,
      "context" : "Since the latent states are continuous, we use a Hamiltonian Monte Carlo (HMC) update (Duane et al., 1987; Neal et al., 2011) to update the `j simultaneously, conditioned on z and π (see Appendix D for details).",
      "startOffset" : 86,
      "endOffset" : 125
    }, {
      "referenceID" : 6,
      "context" : "We focused on fixed-dimension binary vectors for the cocktail party and synthetic data experiments, but it would be straightforward to add the LT property to a model with nonparametric latent states, such as the iFHMM (Gael et al., 2009) and the infinite factorial dynamic model (Valera et al.",
      "startOffset" : 218,
      "endOffset" : 237
    }, {
      "referenceID" : 18,
      "context" : ", 2009) and the infinite factorial dynamic model (Valera et al., 2015), both of which use the Indian Buffet Process (IBP) (Ghahramani & Griffiths, 2005) as a state prior.",
      "startOffset" : 49,
      "endOffset" : 70
    } ],
    "year" : 2017,
    "abstractText" : "We describe a generalization of the Hierarchical Dirichlet Process Hidden Markov Model (HDPHMM) which is able to encode prior information that state transitions are more likely between “nearby” states. This is accomplished by defining a similarity function on the state space and scaling transition probabilities by pairwise similarities, thereby inducing correlations among the transition distributions. We present an augmented data representation of the model as a Markov Jump Process in which: (1) some jump attempts fail, and (2) the probability of success is proportional to the similarity between the source and destination states. This augmentation restores conditional conjugacy and admits a simple Gibbs sampler. We evaluate the model and inference method on a speaker diarization task and a “harmonic parsing” task using fourpart chorale data, as well as on several synthetic datasets, achieving favorable comparisons to existing models.",
    "creator" : "LaTeX with hyperref package"
  }
}