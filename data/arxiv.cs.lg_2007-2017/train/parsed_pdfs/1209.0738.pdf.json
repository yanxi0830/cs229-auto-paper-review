{
  "name" : "1209.0738.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Sparse coding for multitask and transfer learning",
    "authors" : [ "Andreas Maurer" ],
    "emails" : [ "AM@ANDREAS-MAURER.EU", "M.PONTIL@CS.UCL.AC.UK", "BERNARDINO.PAREDES.09@UCL.AC.UK" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n20 9.\n07 38\nv3 [\ncs .L\nG ]\n1 6"
    }, {
      "heading" : "1. Introduction",
      "text" : "The last decade has witnessed many efforts of the machine learning community to exploit assumptions of sparsity in the design of algorithms. A central development in this respect is the Lasso (Tibshirani, 1996), which estimates a linear predictor in a high dimensional space under a regularizing ℓ1-penalty. Theoretical results guarantee a good performance of this method under the assumption that the vector corresponding to the underlying predictor is sparse, or at least has a small ℓ1-norm, see e.g. (Bühlmann & van de Geer, 2011) and references therein.\nIn this work we consider the case where the predictors are\nProceedings of the 30 th International Conference on Machine Learning, Atlanta, Georgia, USA, 2013. JMLR: W&CP volume 28. Copyright 2013 by the author(s).\nlinear combinations of the atoms of a dictionary of linear functions on a high or infinite dimensional space, and we assume that we are free to choose the dictionary. We will show that a principled choice is possible, if there are many learning problems, or “tasks”, and there exists a dictionary allowing sparse, or nearly sparse representations of all or most of the underlying predictors. In such a case we can exploit the larger quantity of available data to estimate the “good” dictionary and still reap the benefits of the Lasso for the individual tasks. This paper gives theoretical and experimental justification of this claim, both in the domain of multitask learning, where the new representation is applied to the tasks from which it was generated, and in the domain of learning to learn, where the dictionary is applied to new tasks of the same environment.\nOur work combines ideas from sparse coding (Olshausen & Field, 1996), multitask learning (Ando & Zhang, 2005; Argyriou, Evgeniou, Pontil, 2008; Argyriou, Maurer, Pontil, 2008; Ben-David & Schuller, 2003; Caruana, 1997; Evgeniou, Micchelli, Pontil, 2005; Maurer, 2009) and learning to learn (Baxter, 2000; Thrun & Pratt, 1998). There is a vast literature on these subjects and the list of papers provided here is necessarily incomplete. Learning to learn (also called inductive bias learning or transfer learning) has been proposed by Baxter (2000) and an error analysis is provided therein, showing that a common representation which performs well on the training tasks will also generalize to new tasks obtained from the same “environment”. The precursors of the analysis presented here are (Maurer & Pontil, 2010) and (Maurer, 2009). The first paper provides a bound on the reconstruction error of sparse coding and may be seen as a special case of the ideas presented here when the sample size is infinite. The second paper provides a learning to learn analysis of the multitask feature learning method in (Argyriou, Evgeniou, Pontil, 2008).\nWe note that a method similar to the one presented in this paper has been recently proposed within the multitask learning setting (Kumar & Daumé III, 2012). Here we highlight the connection between sparse coding and multitask learning and present a probabilistic analysis which complements well with the practical insights in the above work. We also address the different problem of learning to learn, demonstrating the utility of our approach in this setting by means of both learning bounds and numerical experiments. A further novelty of our approach is that it applies to a Hilbert spaces setting, thereby providing the possibility of learning nonlinear predictors using reproducing kernel Hilbert spaces.\nThe paper is organized in the following manner. In Section 2, we set up our notation and introduce the learning problem. In Section 3, we present our learning bounds for multitask learning and learning to learn. In Section 4 we report on numerical experiments. Section 5 contains concluding remarks."
    }, {
      "heading" : "2. Method",
      "text" : "In this section, we turn to a technical exposition of the proposed method, introducing some necessary notation on the way.\nLet H be a finite or infinite dimensional Hilbert space with inner product 〈·, ·〉, norm ‖·‖, and fix an integer K . We study the problem\nmin D∈DK\n1\nT\nT ∑\nt=1\nmin γ∈Cα\n1\nm\nm ∑\ni=1\nℓ (〈Dγ, xti〉 , yti) , (1)\nwhere\n• DK is the set of K-dimensional dictionaries (or simply dictionaries), which means that every D ∈ DK is a linear map D : RK → H , such that ‖Dek‖ ≤ 1 for every one of the canonical basis vectors ek of RK . The number K can be regarded as one of the regularization parameters of our method.\n• Cα is the set of code vectors γ in RK satisfying ‖γ‖1 ≤ α. The ℓ1-norm constraint implements the assumption of sparsity and α is the other regularization parameter. Different sets Cα could be readily used in our method, such as those associated with ℓp-norms.\n• Z = ((xti, yti) : 1 ≤ i ≤ m, 1 ≤ t ≤ T ) is a dataset on which our algorithm operates. Each xti ∈ H represents an input vector, and yti is a corresponding real valued label. We also write Z = (X,Y) = (z1, . . . , zT ) = ((x1,y1) , . . . , (xT ,yT )) with xt = (xt1, . . . , xtm) and yt = (yt1, . . . , ytm). The index t identifies a learning task, and zt are the corresponding\ntraining points, so the algorithm operates on T tasks, each of which is represented by m example pairs.\n• ℓ is a loss function where ℓ (y, y′) measures the loss incurred by predicting y when the true label is y′. We assume that ℓ has values in [0, 1] and has Lipschitz constant L in the first argument for all values of the second argument.\nThe minimum in (1) is zero if the data is generated according to a noise-less model which postulates that there is a “true” dictionary D∗ ∈ DK∗ with K∗ atoms and vectors γ∗1, . . . , γ ∗ T satisfying ‖γ∗t ‖1 ≤ α∗, such that an input x ∈ H generates the label y = 〈D∗γ∗t , x〉 in the context of task t. If K ≥ K∗ and α ≥ α∗ then the minimum in (1) is zero. In Section 4, we will present experiments with such a generative model, when noise is added to the labels, that is y = 〈D∗γ∗t , x〉+ ζ with ζ ∼ N (0, σ), the standard normal distribution.\nThe method (1) should output a minimizing D (Z) ∈ DK as well as a minimizing γ1 (Z) , . . . , γT (Z) corresponding to the different tasks. Our implementation, described in Section 4.1, does not guarantee exact minimization, because of the non-convexity of the problem. Below predictors are always linear, specified by a vector w ∈ H , predicting the label 〈w, x〉 for an input x ∈ H , and a learning algorithm is a rule which assigns a predictor A (z) to a given data set z = ((xi, yi) : 1 ≤ i ≤ m) ∈ (H × R)m."
    }, {
      "heading" : "3. Learning bounds",
      "text" : "In this section, we present learning bounds for method (1), both in the multitask learning and learning to learn settings, and discuss the special case of sparse coding."
    }, {
      "heading" : "3.1. Multitask learning",
      "text" : "Let µ1, . . . , µT be probability measures on H × R. We interpret µt (x, y) as the probability of observing the input/output pair (x, y) in the context of task t. For each of these tasks an i.i.d. training sample zt = ((xti, yti) : 1 ≤ i ≤ m) is drawn from (µt)m and the ensemble Z ∼ ∏Tt=1 µmt is input to algorithm (1). Upon returning of a minimizingD (Z) and γ1 (Z) , . . . , γT (Z), we will use the predictorD (Z) γt (Z) on the t-th task. The average over all tasks of the expected error incurred by these predictors is\n1\nT\nT ∑\nt=1\nE(x,y)∼µ t [ℓ (〈D (Z) γt (Z) , x〉 , y)] .\nWe compare this task-average risk to the minimal analogous risk obtainable by any dictionary D ∈ DK and any set of vectors γ1, . . . , γT ∈ Cα. Our first result is a bound on the excess risk.\nTheorem 1. Let δ > 0 and let µ1, . . . , µT be probability measures on H × R. With probability at least 1 − δ in the draw of Z ∼ ∏Tt=1 µmt we have\n1\nT\nT ∑\nt=1\nE(x,y)∼µ t [ℓ (〈D (Z) γt (Z) , x〉 , y)]\n− inf D∈DK\n1\nT\nT ∑\nt=1\ninf γ∈Cα\nE(x,y)∼µ t [ℓ (〈Dγ, x〉 , y)]\n≤ Lα √ 2S1 (X) (K + 12)\nmT\n+ Lα\n√\n8S∞ (X) ln (2K)\nm +\n√\n8 ln 4/δ\nmT ,\nwhere S1 (X) = 1T ∑T t=1 tr ( Σ̂ (xt) ) and S∞ (X) =\n1 T ∑T t=1 λmax\n( Σ̂ (xt) ) . Here Σ̂ (xt) is the empirical co-\nvariance of the input data for the t-th task, tr (·) denotes the trace and λmax(·) the largest eigenvalue.\nWe state several implications of this theorem.\n1. The quantity S1 (X) appearing in the bound is just the average square norm of the input data points, while S∞ (X) is roughly the average inverse of the observed dimension of the data for each task. Suppose that H = Rd and that the data-distribution is uniform on the surface of the unit ball. Then S1 (X) = 1 and for m ≪ d it follows from Levy’s isoperimetric inequality (see e.g. (Ledoux & Talagrand, 1991)) that S∞ (X) ≈ 1/m, so the corresponding term behaves like √ lnK/m. If the minimum in (1) is small and\nT is large enough for this term to become dominant then there is a significant advantage of the method over learning the tasks independently. If the data is essentially low dimensional, then S∞ (X) will be large, and in the extreme case, if the data is one-dimensional for all tasks then S∞ (X) = S1 (X) and our bound will always be worse by a factor of lnK than standard bounds for independent single task learning as in (Bartlett & Mendelson, 2002). This makes sense, because for low dimensional data there can be little advantage to multitask learning.\n2. In the regime T < K the bound is dominated by the term of order √ S1 (X)K/mT > √\nS1 (X) /m. This is easy to understand, because the dictionary atoms Dek can be chosen independently, separately for each task, so we could at best recover the usual bound for linear models and there is no benefit from multitask learning.\n3. Consider the noiseless generative model mentioned in Section 2. If K ≥ K∗ and α ≥ α∗ then the min-\nimum in (1) is zero. In the bound the overestimation of K∗ can be compensated by a proportional increase in the number of tasks considered and an only very minor increase of the sample size m, namely m → (lnK∗/ lnK)m.\n4. Suppose that we concatenate two sets of tasks. If the tasks are generated by the model described in Section 2 then the resulting set of tasks is also generated by such a model, obtained by concatenating the lists of atoms of the two true dictionaries D∗1 and D ∗ 2 to ob-\ntain the new dictionary D∗ of length K∗ = K∗1 +K ∗ 2 and taking the union of the set of generating vectors {\nγ∗1t }T t=1 and { γ∗2t }T t=1 , extending them to RK ∗ 1+K ∗ 2 so that the supports of the first group are disjoint from the supports of the second group. If T1 = T2, K∗1 = K ∗ 2 and we train with the correct parameters, then the excess risk for the total task set increases only by the order of 1/ √ m, independent of K , despite the fact that the tasks in the second group are in no way related to those in the first group. Our method has the property of finding the right clusters of mutually related tasks.\n5. Consider the alternative method of subspace learning (SL) where Cα is replaced by an euclidean ball of radius α. With similar methods one can prove a bound for SL where, apart from slightly different constants,√ lnK above is replaced by K . SL will be success-\nful and outperform the proposed method, whenever K can be chosen small, with K < m and the vector γ∗t utilize the entire span of the dictionary. For large values of K , a correspondingly large number of tasks and sparse γ∗t the proposed method will be superior.\nThe proof of Theorem 1, which is given in Section B.1 of the supplementary appendix, uses standard methods of empirical process theory, but also employs a concentration result related to Talagrand’s convex distance inequality to obtain the crucial dependence on S∞ (X). At the end of Section B.1 we sketch applications of the proof method to other regularization schemes, such as the one presented in (Kumar & Daumé III, 2012), in which the Frobenius norm on the dictionary D is used in place of the ℓ2/ℓ∞-norm employed here and the ℓ1/ℓ1 norm on the coefficient matrix [γ1, . . . , γT ] is used in place of the ℓ1/ℓ∞."
    }, {
      "heading" : "3.2. Learning to learn",
      "text" : "There is no absolute way to assess the quality of a learning algorithm. Algorithms may perform well on one kind of task, but poorly on another kind. It is important that an algorithm performs well on those tasks which it is likely to be applied to. To formalize this, Baxter (2000) introduced the notion of an environment, which is a probability mea-\nsure E on the set of tasks. Thus E (τ) is the probability of encountering the task τ in the environment E , and µτ (x, y) is the probability of finding the pair (x, y) in the context of the task τ .\nGiven E , the transfer risk (or simply risk) of a learning algorithm A is defined as follows. We draw a task from the environment, τ ∼ E , which fixes a corresponding distribution µτ on H×R. Then we draw a training sample z ∼ µmτ and use the algorithm to compute the predictor A (z). Finally we measure the performance of this predictor on test points (x, y) ∼ µτ . The corresponding definition of the transfer risk of A reads as\nRE (A) = Eτ∼EEz∼µm τ E(x,y)∼µ τ [ℓ (〈A (z) , x〉 , y)] (2)\nwhich is simply the expected loss incurred by the use of the algorithm A on tasks drawn from the environment E . For any given dictionary D ∈ DK we consider the learning algorithm AD, which for z ∈ Zm computes the predictor\nAD (z) = D arg min γ∈Cα\n1\nm\nm ∑\ni=1\nℓ (〈Dγ, xi〉 , yi) . (3)\nEquivalently, we can regard AD as the Lasso operating on data preprocessed by the linear map D⊤, the adjoint of D.\nWe can make a single observation of the environment E in the following way: one first draws a task τ ∼ E . This task and the corresponding distribution µτ are then observed by drawing an i.i.d. sample z from µτ , that is z ∼ µmτ . For simplicity the sample size m will be fixed. Such an observation corresponds to the draw of a sample z from a probability distribution ρE on (H × R)m which is defined by\nρE (z) := Eτ∼E [(µτ ) m (z)] . (4)\nTo estimate an environment a large number T of independent observations is needed, corresponding to a vector Z = (z1, . . . , zT ) ∈ ((H × R)m)T drawn i.i.d. from ρE , that is Z ∼ (ρE)T . We now propose to solve the problem (1) with the data Z, ignore the resulting γi (Z), but retain the dictionary D (Z) and use the algorithm AD(Z) on future tasks drawn from the same environment. The performance of this method can be quantified as the transfer risk RE ( AD(Z) )\nas defined in equation (2) and again we are interested in comparing this to the risk of an ideal solution based on complete knowledge of the environment. For any fixed dictionary D and task τ the best we can do is to choose γ ∈ C so as to minimize E(x,y)∼µ τ [ℓ (〈Dγ, x〉 , y)], so the best is to choose D so as to minimize the average of this over τ ∼ E . The quantity\nRopt = min D∈DK Eτ∼E min γ∈Cα\nE(x,y)∼µ τ ℓ [(〈Dγ, x〉 , y)]\nthus describes the optimal performance achievable under the given constraint. Our second result is\nTheorem 2. With probability at least 1 − δ in the multisample Z = (X,Y) ∼ ρTE we have\nRE ( AD(Z) ) −Ropt ≤ LαK √ 2πS1 (X)\nT\n+4Lα\n√\nS∞ (E) (2 + lnK) m +\n√\n8 ln 4/δ\nT ,\nwhere S1 (X) is as in Theorem 1 and S∞ (E) := Eτ∼EE(x,y)∼µm\nτ λmax\n( Σ̂ (x) ) .\nWe discuss some implications of the above theorem. 1.\n1. The interpretation of S∞ (E) is analogous to that of S∞ (X) in the bound for Theorem 1. The same applies to Remark 6 following Theorem 1.\n2. In the regime T ≤ K2 the result does not imply any useful behaviour. On the other and, if T ≫ K2 the dominant term in the bound is of order √ S∞ (E) /m.\n3. There is an important difference with the multitask learning bound, namely in Theorem 2 we have √ T\nin the denominator of the first term of the excess risk, and not √ mT as in Theorem 1. This is because in the setting of learning to learn there is always a possibility of being misled by the draw of the training tasks. This possibility can only decrease as T increases – increasing m does not help.\nThe proof of Theorem 2 is given in Section B.2 of the supplementary appendix and follows the method outlined in (Maurer, 2009): one first bounds the estimation error for the expected empirical risk on future tasks, and then combines this with a bound of the expected true risk by said expected empirical risk. The term K/ √ T may be an artefact of our method of proof and the conjecture that it can be replaced by √ K/T seems plausible."
    }, {
      "heading" : "3.3. Connection to sparse coding",
      "text" : "We discuss a special case of Theorem 2 in the limit m → ∞, showing that it subsumes the sparse coding result in (Maurer & Pontil, 2010). To this end, we assume the noiseless generative model yti = 〈wt, xti〉 described in Section 2, that is µ(x, y) = p(x)δ(y, 〈w, x〉), where p is the uniform distribution on the sphere in Rd (i.e. the Haar measure). In this case the environment of tasks is fully specified by a measure ρ on the unit ball in Rd from which a task w ∈ Rd is drawn and the measure µ is identified with the vector w. Note that we do not assume that these tasks are obtained as sparse combinations of some dictionary. Under\nthe above assumptions and choosing ℓ to be the square loss, we have that E(x,y)∼µ t ℓ(〈w, x〉, y) = ‖wt − w‖2. Consequently, in the limit of m → ∞ method (1) reduces to a constrained version of sparse coding (Olshausen & Field, 1996), namely\nmin D∈DK\n1\nT\nT ∑\nt=1\nmin γ∈Cα\n‖Dγ − wt‖2.\nIn turn, the transfer error of a dictionary D is given by the quantity R(D) := minγ∈Cα ‖Dγ − w‖2 and Ropt = minD∈DK Ew∼ρminγ∈Cα ‖Dγ − w‖2. Given the constraints D ∈ DK , γ ∈ Cα and ‖x‖ ≤ 1, the square loss ℓ (y, y′) = (y − y′)2, evaluated at y = 〈Dγ, x〉, can be restricted to the interval y ∈ [−α, α], where it has the Lipschitz constant 2 (1 + α) for any y′ ∈ [−1, 1], as is easily verified. Since S1(X) = 1 and S∞ (E) < ∞, the bound in Theorem 2 becomes\nR(D)−Ropt ≤ 2α(1 + α)K √ 2π\nT + 8\n√\nln 4/δ\nT (5)\nin the limit m → ∞. The typical choice for α is α ≤ 1, which ensures that ‖Dγ‖ ≤ 1. In this case inequality (5) provides an improvement over the sparse coding bound in (Maurer & Pontil, 2010) (cf. Theorem 2 and Section 2.4 therein), which contains an additional term of the order of √\n(lnT )/T and the same leading term in K as in (5) but with slightly worse constant (14 instead of 4 √ 2π). The connection of our method to sparse coding is experimentally demonstrated in Section 4.4 and illustrated in Figure 6."
    }, {
      "heading" : "4. Experiments",
      "text" : "In this section, we present experiments on a synthetic and two real datasets. The aim of the experiments is to study the statistical performance of the proposed method, in both settings of multitask learning and learning to learn. We compare our method, denoted as Sparse Coding Multi Task Learning (SC-MTL), with independent ridge regression (RR) as a base line and multitask feature learning (MTFL) (Argyriou, Evgeniou, Pontil, 2008) and GO-MTL (Kumar & Daumé III, 2012). We also report on sensitivity analysis of the proposed method versus different number of parameters involved."
    }, {
      "heading" : "4.1. Optimization algorithm",
      "text" : "We solve problem (1) by alternating minimization over the dictionary matrix D and the code vectors γ. The techniques we use are very similar to standard methods for sparse coding and dictionary learning, see e.g. (Jenatton et al., 2011) and references therein for more information. Briefly, assuming that the loss function ℓ is\nconvex and has Lipschitz continuous gradient, either minimization problem is convex and can be solved efficiently by proximal gradient methods, see e.g. (Beck & Teboulle, 2009; Combettes & Wajs, 2006). The key ingredient in each step is the computation of the proximity operator, which in either problem has a closed form expression."
    }, {
      "heading" : "4.2. Toy experiment",
      "text" : "We generated a synthetic environment of tasks as follows. We choose a d×K matrix D by sampling its columns independently from the uniform distribution on the unit sphere in Rd. Once D is created, a generic task in the environment is given by w = Dγ, where γ is an s-sparse vector obtained as follows. First, we generate a set J ⊆ {1, . . . ,K} of cardinality s, whose elements (indices) are sampled uniformly without replacement from the set {1, . . . ,K}. We then set γj = 0 if j /∈ J and otherwise sample γj ∼ N (0, 0.1). Finally, we normalize γ so that it has ℓ1-norm equal to some prescribed value α. Using the above procedure we generated T tasks wt = Dγt, t = 1, . . . , T . Further, for each task t we generated a training set zt = {(xti, yti)}mi=1, sampling xti i.i.d. from the uniform distribution on the unit sphere in Rd. We then set yti = 〈wt, xti〉 + ξti, with ξti ∼ N (0, σ2), where σ is the variance of the noise. This procedure also defines the generation of new tasks in the transfer learning experiments below.\nThe above model depends on seven parameters: the number K and the dimension d of the atoms, the sparsity s and the ℓ1-norm α of the codes, the noise level σ, the sample size per task m and the number of training tasks T . In all experiments we report both the multitask learning (MTL) and learning to learn (LTL) performance of the methods. For MTL, we measure performance by the estimation error 1/T\n∑T t=1 ‖wt − ŵt‖2, where ŵ1, . . . , ŵT\nare the estimated task vectors (in the case of SC-MTL, ŵt = D(Z)γ(Z)t – see the discussion in Section 2. For LTL, we use the same quantity but with a new set of tasks generated by the environment (in the experiment below we generate 100 new tasks). The regularization parameter of each method is chosen by cross validation. Finally, all experiments are repeated 50 times, and the average performance results are reported in the plots below.\nIn the first experiment, we fix K = 10, d = 20, s = 2, α = 10,m = 10, σ = 0.1 and study the statistical performance of the methods as a function of the number of tasks. The results, shown in Figure 1, clearly indicate that the proposed method outperforms the remaining approaches. In this experiment the number of atoms used by dictionarybased approaches, which here we denote by K ′ to avoid confusion with the number of atoms K of the target dictionary, was equal to K = 10. This gives an advantage to both GO-MTL and SC-MTL. We therefore also studied the performance of those methods in dependence on K ′.\nFigure 2, reporting this result, is in qualitative agreement with our theoretical analysis: the performance of SC-MTL is not too sensitive to K ′ if K ′ ≥ K , and the method still outperforms independent RR and MTFL if K ′ = 4K . On the other hand if K ′ < K the performance of the method quickly degrades. In the last experiment we study performance vs. the sparsity ratio s/K . Intuitively we would expect our method to have greater advantage over MTL if s ≪ K . The results, shown in Figure 3, confirm this fact, also indicating that SC-MTL is outperformed by both GO-MTL and MTFL as sparsity becomes less pronounced (s/K > 0.6)."
    }, {
      "heading" : "4.3. Learning to learn optical character recognition",
      "text" : "We have conducted experiments on real data to study the performance of our method in a learning to learn / transfer learning setting. To this end, we employed the NIST dataset1, which is composed of a set of 14× 14 pixels images of handwritten characters (digits and lower and capital case letters, for a total of 52 characters).\nWe considered the following experimental protocol. First, a set of 20 characters are chosen randomly as well as n instances for each character. These are used to learn all possibilities of 1-vs-1 train tasks, which makes T = 190,\n1The NIST dataset is available at http://www.nist.gov/srd/nistsd19.cfm\neach of which having m = 2n instances. The knowledge learned in this stage is employed to learn another set of target tasks. In our approach, the assumption that is made is that some of the components in the dictionary learned from the training tasks, can also be useful for representing the target tasks. In order to create the target tasks, another set of 10 characters are chosen among the remaining set of characters in the dataset, inducing a set of 45 1-vs-1 classification tasks. Since we are interested in the case where the training set size of the target tasks is small, we sample only 3 instances for each character, hence 6 examples per task.\nIn order to tune the hyperparameters of all compared approaches, we have also created another set of 45 validation tasks by following the process previously described, simulating the target set of tasks. Note that there is not overlapping between the digits associated to the train, target and validation tasks.\nWe have run 50 trials of the above process for different values of m and the average multiclass accuracy on the target tasks is reported in Figure 4."
    }, {
      "heading" : "4.4. Sparse coding of images with missing pixels",
      "text" : "In the last experiment we consider a sparse coding problem (Olshausen & Field, 1996) of optical character images, with missing pixels. We employ the Binary Alphadigits dataset2, which is composed of a set of binary 20× 16 images of all digits and capital letters (39 images for each character). In the following experiment only the digits are used. We regard each image as a task, hence the input space is the set of 320 possible pixels indices, while the output space is the real interval [0, 1], representing the gray level. We sample T = 100, 130, 160, 190, 220, 250 images, equally divided among the 10 possible digits. For each of these, a corresponding random set of m = 160 pixel values are sampled (so the set of sample pixels varies\n2Available at http://www.cs.nyu.edu/ roweis/data.html.\nfrom one image to another).\nWe test the performance of the dictionary learned by method (1) in a learning to learn setting, by choosing 100 new images. The regularization parameter for each approach is tuned using cross validation. The results, shown in Figure 5, indicate some advantage of the proposed method over trace norm regularization. A similar trend, not reported here due to space constraints, is obtained in the multitask setting. Ridge regression performed significantly worse and is not shown in the figure. We also show as a reference the performance of sparse coding (SC) applied when all pixels are known.\nWith the aim of analyzing the atoms learned by the algorithm, we have carried out another experiment where we assume that there are 10 underlying atoms (one for each digit). We compare the resultant dictionary to that obtained by sparse coding, where all pixels are known. The results are shown in Figure 6."
    }, {
      "heading" : "5. Summary",
      "text" : "In this paper, we have explored an application of sparse coding, which has been widely used in unsupervised learning and signal processing, to the domains of multitask learning and learning to learn. Our learning bounds provide a justification of this method and offer insights into its advantage over independent task learning and learning dense representation of the tasks. The bounds, which hold in a Hilbert space setting, depend on data dependent quantities which measure the intrinsic dimensionality of the data. Numerical simulations presented here indicate that sparse coding is a promising approach to multitask learning and can lead to significant improvements over competing methods.\nIn the future, it would be valuable to study extensions of our analysis to more general classes of code vectors. For example, we could use code sets Cα which arise from structured sparsity norms, such as the group Lasso, see e.g. (Jenatton et al., 2011; Lounici et al., 2011) or other families of regularizers. A concrete example which comes to mind is to choose K = Qr, Q, r ∈ N and a partition J = {{(q− 1)r+1, . . . , qr} : q = 1, . . . , Q} of the index set {1, . . . ,K} into contiguous index sets of size r. Then using a norm of the type ‖γ‖ = ‖γ‖1 + ∑\nJ∈J ‖γJ‖2 will encourage codes which are sparse and use only few of the groups in J . Using the ball associated with this norm as our set of codes would allow to model sets of tasks which are divided into groups. A further natural extension of our method is nonlinear dictionary learning in which the dictionary columns correspond to functions in a reproducing kernel Hilbert space and the tasks are expressed as sparse linear combinations of such functions."
    }, {
      "heading" : "Acknowledgments",
      "text" : "This work was supported in part by EPSRC Grant EP/H027203/1 and Royal Society International Joint Project Grant 2012/R2."
    }, {
      "heading" : "A. Notation and tools",
      "text" : "Issues of measurability will be ignored throughout, in particular, if F is a class of real valued functions on a domain X and X a random variable with values in X then we will always write E supf∈F f (X) to mean sup {Emaxf∈F0 f (X) : F0 ⊆ F , F0 finite}. In the sequel H denotes a finite or infinite dimensional Hilbert space with inner product 〈·, ·〉 and norm ‖·‖. If T is a bounded linear operator on H its operator norm is written ‖T ‖∞ = sup {‖Tx‖ : ‖x‖ = 1}. Members of H are denoted with lower case italics such as x, v, w, vectors composed of such vectors are in bold lower case, i.e. x = (x1, . . . , xm) or v =(v1, . . . , vn), where m or n are explained in the context.\nLet B be the unit ball in H . An example is a pair z = (x, y) ∈ B × R =: Z , a sample is a vector of such pairs z = (z1, . . . , zm) = ((x1, y1) , . . . , (xm, ym)). Here we also write z = (x,y), with x = (x1, . . . , xm) ∈ Hm and y = (y1, . . . , ym) ∈ Rm. A multisample is a vector Z = (z1, . . . , zT ) composed of samples. We also write Z = (X,Y) with X =(x1, . . . ,xT ).\nFor members of RK we use the greek letters γ or β. Depending on context the inner product and euclidean norm on RK will also be denoted with 〈·, ·〉 and ‖.‖. The ℓ1norm ‖·‖1 on RK is defined by ‖β‖1 = ∑K k=1 |βk|.\nIn the sequel we denote with Cα the set {\nβ ∈ RK : ‖β‖1 ≤ α } , abbreviate C for the ℓ1-unit ball C1. The canonical basis of RK is denoted e1, . . . , eK . Unless otherwise specified the summation over the index i will always run from 1 to m, t will run from 1 to T , and k will run from 1 to K .\nA.1. Covariances\nFor x ∈Hm the empirical covariance operator Σ̂ (x) is specified by\n〈 Σ̂ (x) v, w 〉 = 1\nm\n∑\ni\n〈v, xi〉 〈xi, w〉 , v, w ∈ H .\nThe definition implies the inequality ∑\ni\n〈v, xi〉2 = m 〈 Σ̂ (x) v, v 〉 ≤ m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ ‖v‖2 .\n(6)\nIt also follows that tr ( Σ̂ (x) ) = (1/m) ∑\ni ‖xi‖ 2.\nFor a multisample X ∈ HmT we will consider two quantities defined in terms of the empirical covariances.\nS1 (X) = 1\nT\n∑\nt\n∥ ∥ ∥ Σ̂ (xt) ∥ ∥ ∥\n1 :=\n1\nT\n∑\nt\ntr ( Σ̂ (xt) )\nS∞ (X) = 1\nT\n∑\nt\n∥ ∥ ∥Σ̂ (xt) ∥ ∥ ∥\n∞ :=\n1\nT\n∑\nt\nλmax\n( Σ̂ (xt) )\nwhere λmax is the largest eigenvalue. If all data points xti lie in the unit ball of H then S1 (X) ≤ 1. Of course S1 (X) can also be written as the trace of the total covariance (1/T ) ∑\nt Σ̂ (xt), while S∞ (X) will always be at least as large as the largest eigenvalue of the total covariance. We always have S∞ (X) ≤ S1 (X), with equality only if the data is one-dimensional for all tasks. The quotient S1 (X) /S∞ (X) can be regarded as a crude measure of the effective dimensionality of the data. If the data have a high dimensional distribution for each task then S∞ (X) can be considerably smaller than S1 (X).\nA.2. Concentration inequalities\nLet X be any space. For x ∈ Xn, 1 ≤ k ≤ n and y ∈ X we use xk←y to denote the object obtained from x by replacing the k-th coordinate of x with y. That is\nxk←y = (x1, . . . , xk−1, y, xk+1, . . . , xn) .\nThe concentration inequality in part (i) of the following theorem, known as the bounded difference inequality is given in (McDiarmid, 1998). A proof of inequality (ii) is given in (Maurer, 2006).\nTheorem 3. Let F : Xn → R and define A and B by\nA2 = sup x∈Xn\nn ∑\nk=1\nsup y1,y2∈X\n(F (xk←y1)− F (xk←y2))2\nB2 = sup x∈Xn\nn ∑\nk=1\n(\nF (x)− inf y∈X F (xk←y)\n)2\n.\nLet X = (X1, . . . , Xn) be a vector of independent random variables with values in X , and let X′ be i.i.d. to X. Then for any s > 0\n(i) Pr {F (X) > EF (X′) + s} ≤ e−2s2/A2 ;\n(ii) Pr {F (X) > EF (X′) + s} ≤ e−s2/(2B2).\nA.3. Rademacher and Gaussian averages\nWe will use the term Rademacher variables for any set of independent random variables, uniformly distributed on {−1, 1}, and reserve the symbol σ for Rademacher variables. A set of random variables is called orthogaussian\nif the members are independent N (0, 1)-distributed (standard normal) variables and reserve the letter ζ for standard normal variables. Thus σ1, σ2, . . . , σi, . . . , σ11, . . . , σij etc. will always be independent Rademacher variables and ζ1, ζ2, . . . , ζi, . . . , ζ11, . . . , ζij will always be orthogaussian.\nFor A ⊆ Rn we define the Rademacher and Gaussian averages of A (Ledoux & Talagrand, 1991; Bartlett & Mendelson, 2002) as\nR (A) = Eσ sup (x1,...,xn)∈A\n2\nn\nn ∑\ni=1\nσixi,\nG (A) = Eζ sup (x1,...,xn)∈A\n2\nn\nn ∑\ni=1\nζixi.\nIf F is a class of real valued functions on a space X and x = (x1, . . . , xn) ∈ Xn we write\nF (x) = F (x1, . . . , xn) = {(f (x1) , . . . , f (xn)) : f ∈ F} ⊆ Rn.\nThe empirical Rademacher and Gaussian complexities of F on x are respectively R (F (x)) and G (F (x)). The utility of these concepts for learning theory comes from the following key-result (see (Bartlett & Mendelson, 2002; Koltchinskii & Panchenko, 2002)), stated here in two portions for convenience in the sequel.\nTheorem 4. Let F be a real-valued function class on a space X and µ1, . . . , µm be probability measures on X with product measure µ = ∏\ni µi on Xm. For x ∈ Xm define\nΦ (x) = sup f∈F\n1\nm\nm ∑\ni=1\n(\nEx∼µ i [f (x)]− f (xi)\n)\n.\nThen Ex∼µ [Φ (x)] ≤ Ex∼µR (F (x)).\nProof. For any realization σ = σ1, . . . , σm of the Rademacher variables\nEx∼µ [Φ (x)]\n= Ex∼µ sup f∈F\n1 m Ex′∼µ\nm ∑\ni=1\n(f (x′i)− f (xi))\n≤ Ex,x′∼µ×µ sup f∈F\n1\nm\nm ∑\ni=1\nσi (f (x ′ i)− f (xi)) ,\nbecause of the symmetry of the measure µ × µ (x,x′) =∏i µi × ∏ i µi (x,x ′)under the interchange xi ↔ x′i. Taking the expectation in σ and applying the triangle inequality gives the result.\nTheorem 5. Let F be a [0, 1]-valued function class on a space X , and µ as above. For δ > 0 we have with probability greater than 1 − δ in the sample x ∼ µ that for all f ∈ F\nEx∼µ [f (x)] ≤ 1\nm\nm ∑\ni=1\nf (xi)+Ex∼µR (F (x))+ √ ln (1/δ)\n2m .\nTo prove this we apply the bounded-difference inequality ( part (i) of Theorem 3) to the function Φ of the previous theorem (see e.g. (Bartlett & Mendelson, 2002)). Under the conditions of this result, changing one of the xi will not change R (F (x)) by more than 2, so again by the bounded difference inequality applied to R (F (x)) and a union bound we obtain the data dependent version\nCorollary 6. Let F and µ be as above. For δ > 0 we have with probability greater than 1 − δ in the sample x ∼ µ that for all f ∈ F\nEx∼µ [f (x)] ≤ 1\nm\nm ∑\ni=1\nf (xi)+R (F (x))+ √ 9 ln (2/δ)\n2m .\nTo bound Rademacher averages the following result is very useful (Bartlett & Mendelson, 2002; Ando & Zhang, 2005; Ledoux & Talagrand, 1991)\nLemma 7. Let A ⊆ Rn, and let ψ1, . . . , ψn be real functions such that ψi (s) − ψi (t) ≤ L |s− t|,∀i, and s, t ∈ R. Define ψ (A) = {ψ1 (x1) , . . . , ψn (xn) : (x1, . . . , xn) ∈ A}. Then\nR (ψ (A)) ≤ LR (A) .\nSometimes it is more convenient to work with gaussian averages which can be used instead, by virtue of the next lemma. For a proof see e.g. (Ledoux & Talagrand, 1991) Lemma 8. For A ⊆ Rk we have R (A) ≤ √ π/2 G (A).\nThe next result is known as Slepian’s lemma ((Slepian, 1962), (Ledoux & Talagrand, 1991)).\nTheorem 9. Let Ω and Ξ be mean zero, separable Gaussian processes indexed by a common set S, such that\nE (Ωs1 − Ωs2)2 ≤ E (Ξs1 − Ξs2)2 for all s1, s2 ∈ S.\nThen E sup\ns∈S Ωs ≤ E sup s∈S Ξs."
    }, {
      "heading" : "B. Proofs",
      "text" : "B.1. Multitask learning\nIn this section we prove Theorem 1. It is an immediate consequence of Hoeffding’s inequality and the following uniform bound on the estimation error.\nTheorem 10. Let δ > 0, fix K and let µ1, . . . , µT be probability measures on H ×R. With probability at least 1− δ in the draw of Z ∼ ∏Tt=1 µt we have for all D ∈ DK and all γ ∈ CTα that\n1\nT\nT ∑\nt=1\nE(x,y)∼µ t [ℓ (〈Dγt, x〉 , y)]\n− 1 mT\nT ∑\nt=1\nm ∑\ni=1\nℓ (〈Dγt, xti〉 , yti)\n≤ Lα √ 2S1 (X) (K + 12)\nmT\n+ Lα\n√\n8S∞ (X) ln (2K)\nm +\n√\n9 ln 2/δ\n2mT .\nThe proof of this theorem requires auxiliary results. Fix X ∈ HmT and for γ = (γ1, . . . , γT ) ∈ ( R K )T\ndefine the random variable\nFγ = Fγ (σ) = sup D∈DK\n∑\nt,i\nσti 〈Dγt, xti〉 . (7)\nLemma 11. (i) If γ = (γ1, . . . , γT ) satisfies ‖γt‖ ≤ 1 for all t, then\nEFγ ≤ √ mTK S1 (X).\n(ii) If γ satisfies ‖γt‖1 ≤ 1 for all t, then for any s ≥ 0\nPr {Fγ ≥ E [Fγ ] + s} ≤ exp ( −s2 8mT S∞ (X) ) .\nProof. (i) We observe that\nEFγ = E sup D\n∑\nk\n〈\nDek, ∑\nt,i\nσtiγtkxti\n〉\n≤ sup D\n(\n∑\nk\n‖Dek‖2 )1/2 E\n\n \n∑\nk\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nt,i\nσtiγtkxti\n∥ ∥ ∥ ∥ ∥ ∥\n2 \n \n1/2\n≤ √ K\n\n \n∑\nk\nE\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nt,i\nσtiγtkxti\n∥ ∥ ∥ ∥ ∥ ∥\n2 \n \n1/2\n= √ K\n\n\n∑\nk,t,i\n|γtk|2 ‖xti‖2  \n1/2\n= √ K\n(\n∑\nt\n(\n∑\nk\n|γtk|2 ) ∑\ni\n‖xti‖2 )1/2\n≤ √ K ∑\nt,i\n‖xti‖2 = √ mTK S1 (X).\n(ii) For any configurationσ of the Rademacher variables let D (σ) be the maximizer in the definition of Fγ (σ). Then for any s ∈ {1, . . . , T }, j ∈ {1, . . . ,m} and any σ′ ∈ {−1, 1} to replace σsj we have\nFγ (σ)− Fγ ( σ(sj)←σ′ ) ≤ 2 |〈D (σ) γs, xsj〉| .\nUsing the inequality (6) we then obtain ∑\nsj\n( Fγ (σ)− infσ′∈{−1,1} Fγ ( σ(sj)←σ′ ))2\n≤ 4 ∑\nt,i\n〈D (σ) γt, xti〉2\n≤ 4m ∑\nt\n∥ ∥ ∥ Σ̂ (xt) ∥ ∥ ∥\n∞ ‖D (σ) γt‖2\n≤ 4m ∑\nt\n∥ ∥ ∥Σ̂ (xt) ∥ ∥ ∥\n∞ .\nIn the last inequality we used the fact that for any D ∈ DK we have ‖Dγt‖ ≤ ∑\nk |γtk| ‖Dek‖ ≤ ‖γt‖1 ≤ 1. The conclusion now follows from part (ii) of Theorem 3.\nProposition 12. For every fixed Z = (X,Y) ∈ (H × R)mT we have Eσ supD∈D,γ∈(Cα)T ∑ t,i σitℓ (〈Dγt, xti〉 , yti)\n≤ Lα √ 2mTS1 (X) (K + 12)+LαT √ 8mS∞ (X) ln (2K).\nProof. It suffices to prove the result for α = 1, the general result being a consequence of rescaling. By Lemma 7 and the Lipschitz properties of the loss function ℓ we have\nEσ supD∈DK ,γ∈(C)T , ∑ t,i σitℓ (〈Dγt, xti〉 , yti)\n≤ LEσ sup D∈DK ,γ∈(C)T ,\n∑\nt,i\nσit 〈Dγt, xti〉 . (8)\nSince linear functions on a compact convex set attain their maxima at the extreme points, we have\nE sup D∈DK ,γ∈(C)T ,\nT ∑\nt=1\nm ∑\ni=1\nσit 〈Dγt, xti〉 = E max γ∈ext(C)T Fγ ,\n(9) where Fγ is defined as in (7). Let c = √\nmKTS1 (X). Now for any δ ≥ 0 we have, since Fγ ≥ 0,\nEmax γ∈ext(C)T Fγ = ∫∞ 0 Pr { max γ∈ext(C)T Fγ > s } ds\n≤ c+ δ + ∑\nγ∈(ext(C))T\n∫ ∞\n√ mKTS1(X)+δ\nPr {Fγ > s} ds\n≤ c+ δ + ∑\nγ∈(ext(C))T\n∫ ∞\nδ\nPr {Fγ > EFγ + s} ds\n≤ c+ δ + (2K)T ∫ ∞\nδ\nexp ( −s2 8mTS∞ (X) ) ds\n≤ c+ δ + 4mTS∞ (X) (2K) T\nδ exp ( −δ2 8mTS∞ (X) ) .\nHere the first inequality follows from the fact that probabilities never exceed 1 and a union bound. The second inequality follows from Lemma 11, part (i), since EFk ≤ √\nmKTS1 (X). The third inequality follows from Lemma 11, part (ii), and the fact that the cardinality of ext(C) is 2K , and the last inequality follows from a well known estimate on Gaussian random variables. Setting\nδ =\n√\n8mTS∞ (X) ln ( e (2K) T ) we obtain with some\neasy simplifying estimates\nEmax γ∈ext(C)T Fγ ≤\n√\n2mT (K + 12)S1 (X)\n+T √\n8mS∞ (X) ln (2K),\nwhich together with (8) and (9) gives the result.\nTheorem 10 now follows from Corollary 6.\nIf the set Cα is replaced by any other subset C′ of the ℓ2ball of radius α, a similar proof strategy can be employed. The denominator in the exponent of Lemma 11-(ii) then obtains another factor of √ K. The union bound over the extreme points in ext(C) in the previous proposition can be replaced by a union bound over a cover C′. This leads to the alternative result mentioned in Remark 5 following the statement of Theorem 1.\nAnother modification leads to a bound for the method presented in (Kumar & Daumé III, 2012), where the constraint ‖Dek‖ ≤ 1 is replaced by ‖D‖2 ≤ √ K (here ‖·‖2 is the Frobenius or Hilbert Schmidt norm) and the constraint ‖γt‖1 ≤ α, ∀t is replaced by\n∑ ‖γt‖1 ≤ αT . To explain the modification we set α = 1. Part (i) of Lemma 11 is easily verified. The union bound over (ext (C))T in the previous proposition is replaced by a union bound over the 2TK extreme points of the ℓ1-Ball of radius T in RTK . For part (ii) we use the fact that the concentration result is only needed for γ being an extreme point (so that it involves only a single task) and obtain the bound ∑\nt\n∥ ∥ ∥Σ̂ (xt) ∥ ∥ ∥\n∞ ‖Dγt‖2 ≤ TKS′∞ (X), leading to\nPr {Fγ ≥ E [Fγ ] + s} ≤ exp ( −s2 8mTK S′∞ (X) ) .\nProceeding as above we obtain the excess risk bound\nLα √\n2S1(X)(K+12) mT + Lα\n√\n8KS′ ∞ (X) ln(2KT ) m\n+\n√\n8 ln 4/δ\nmT ,\nto replace the bound in Theorem 1. The factor √ K in the second term seems quite weak, but it must be borne in mind that the constraint ‖D‖2 ≤ √ K is much weaker than ‖Dek‖ ≤ 1, and allows for a smaller approximation error. If we retain ‖Dek‖ ≤ 1 and only modify the γ-constraint to ∑ ‖γt‖1 ≤ αT the √ K in the second term disappears and by comparison to Theorem 1 there is only and additional lnT and the switch from S∞ (X) to S′∞ (X), reflecting the fact that\n∑ ‖γt‖1 ≤ αT is a much weaker constraint than ‖γt‖1 ≤ α, ∀t, so that, again, a smaller minimum in (1) is possible for the modified method.\nB.2. Learning to learn\nIn this section we prove Theorem 2. The basic strategy is as follows. Recall the definition (4) of the measure ρE , which governs the generation of a training sample in the environment E . On a given training sample z ∼ρE the algorithm AD as defined in (3) incurs the empirical risk\nR̂D (z) = min γ∈Cα\n1\nm\nm ∑\ni=1\nℓ (〈Dγ, xi〉 , yi) .\nThe algorithm AD, essentially being the Lasso, has very good estimation properties, so R̂D (z) will be close to the true risk of AD in the corresponding task. This means that we only really need to estimate the expected empirical risk Ez∼ρ\nE R̂D (z) of AD on future tasks. On the other hand the\nminimization problem (1) can be written as\nmin D∈DK\n1\nT\nT ∑\nt=1\nR̂D (zt) with Z =(z1, . . . , zT ) ∼ (ρE)T ,\nwith dictionary D (Z) being the minimizer. If DK is not too large this should be similar to Ez∼ρ\nE R̂D(Z) (z). In the\nsequel we make this precise.\nLemma 13. For v ∈ H with ‖v‖ ≤ 1 and x ∈ Hm let F be the random variable\nF =\n∣ ∣ ∣ ∣ ∣ 〈 v, ∑\ni\nσixi\n〉∣\n∣ ∣ ∣ ∣ .\nThen (i) EF ≤ √m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥ 1/2\n∞ and (ii) for t ≥ 0\nPr {F > EF + s} ≤ exp\n\n\n−s2\n2m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞\n\n .\nProof. (i). Using Jensen’s inequality and (6) we get\nEF ≤\n\nE\n〈\nv, ∑\ni\nσixi\n〉2 \n\n1/2\n=\n(\n∑\ni\n〈v, xi〉2 )1/2 ≤ √ m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ .\n(ii) Let σ be any configuration of the Rademacher variables. For any σ′, σ′′ ∈ {−1, 1} to replace σsj we have\nF ( σ(sj)←σ′ ) − F ( σ(sj)←σ′′ ) ≤ 2 |〈v, xj〉| ,\nso the conclusion follows from the bounded difference inequality, Theorem 3 (i).\nLemma 14. For v1, . . . , vK ∈ H satisfying ‖vk‖ ≤ 1, x ∈ Hm we have\nEmax k\n∣ ∣ ∣ ∣ ∣ 〈 vk, ∑\ni\nσixi\n〉∣\n∣ ∣ ∣ ∣\n≤ √ 2m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞\n( 2 + √ lnK ) .\nProof. Let Fk = |〈vk, ∑ i σixi〉|. Setting c = √\nm ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ and using integration by parts we have for\nδ ≥ 0 Emaxk Fk\n≤ c+ δ + ∫ ∞ √\nm‖Σ̂(x)‖ ∞ +δ\nmax k\nPr {Fk ≥ s} ds\n≤ c+ δ + ∑\nk\n∫ ∞\nδ\nPr {Fk ≥ EFk + s} ds\n≤ c+ δ + ∑\nk\n∫ ∞\nδ\nexp\n\n\n−s2\n2m ∥ ∥ ∥ Σ̂ (x) ∥ ∥ ∥\n∞\n\n ds\n≤ c+ δ + mK\n∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ δ exp\n\n\n−δ2\n2m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞\n\n .\nAbove the first inequality is trivial, the second follows from Lemma 13 (i) and a union bound, the third inequality follows from Lemma 13 (ii) and the last from a well known approximation. The conclusion follows from substitution\nof δ =\n√\n2m ∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ ln (eK).\nProposition 15. Let S∞ (E) := Eτ∼EE(x,y)∼µm\nτ\n∥ ∥ ∥Σ̂ (x) ∥ ∥ ∥\n∞ . With probability at least"
    }, {
      "heading" : "1− δ in the multisample Z ∼ ρTE",
      "text" : "sup D∈DK\nRE (AD)− 1\nT\nT ∑\nt=1\nR̂D (zt) (10)\n≤ LαK √ 2πS1 (X)\nT\n+ 4Lα\n√\nS∞ (E) (2 + lnK) m +\n√\n9 ln 2/δ\n2T .\nProof. Following our strategy we write (abbreviating ρ = ρE )\nsup D∈DK\nRE (AD)− 1\nT\nT ∑\nt=1\nR̂D (zt)\n≤ sup D∈DK Eτ∼EEz∼µm τ\n(11)\n[\nE(x,y)∼µ τ [ℓ (〈AD (z) , x〉 , y)]− R̂D (z)\n]\n+ sup D∈DK\nEz∼ρ [ R̂D (z) ] − 1 T\nT ∑\nt=1\nR̂D (zt)\nand proceed by bounding each of the two terms in turn.\nFor any fixed dictionary D and any measure µ on Z we have\nEz∼µm [ E(x,y)∼µ [ℓ (〈AD (z) , x〉 , y)]− R̂D (z) ]\n≤ Ez∼µm sup γ∈Cα\n[\nE(x,y)∼µ [ℓ (〈Dγ, x〉 , y)]\n− 1 m\nm ∑\ni=1\nℓ (〈Dγ, xi〉 , yi) ]\n≤ 2 m Ez∼µmEσ sup\nγ∈Cα\nm ∑\ni=1\nσiℓ (〈Dγ, xi〉 , yi) [Theorem 4]\n≤ 2L m Ez∼µmEσ sup γ∈Cα ∑\nk\nγk\n〈\nDek,\nm ∑\ni=1\nσixi\n〉\n[Lemma 7]\n≤ 2Lα m Ez∼µmEσ max k\n∣ ∣ ∣ ∣ ∣ 〈 Dek, m ∑\ni=1\nσixi\n〉∣\n∣ ∣ ∣ ∣ [Hölder’s ineq.]\n≤ 2Lα m Ez∼µm\n√\n2mλmax\n( Σ̂ (x) )( 2 + √ lnK ) [Lemma 14 (i)]\n≤ 2Lα\n√ √ √ √ 4Ez∼µmλmax ( Σ̂ (x) ) (2 + lnK)\nm [Jensen’s ineq.].\nThis gives the bound\nEz∼µm [ E(x,y)∼µ [ℓ (〈AD (z) , x〉 , y)] − R̂D (z) ]\n≤ 4Lα\n√ √ √ √ Ez∼µmλmax ( Σ̂ (x) ) (2 + lnK)\nm (12)\nvalid for every measure µ on H × R and every D ∈ DK . Replacing µ by µτ , taking the expectation as τ ∼ E and using Jensen’s inequality bounds the first term on the right hand side of (11) by the second term on the right hand side of (10).\nWe proceed to bound the second term. From Corollary 6 and Lemma 8 we get that with probability at least 1 − δ in Z ∼ (ρE)T\nsupD∈DK Ez∼ρ [ R̂D (z) ] − 1T ∑T t=1 R̂D (zt)\n≤ √ 2π\nT Eζ sup\nD∈DK\nT ∑\nt=1\nζtR̂D (zt) +\n√\n9 ln 2/δ\n2T ,\nwhere ζt is an orthogaussian sequence. Define two Gaussian processes Ω and Ξ indexed by DK as\nΩD = ∑T t=1 ζtR̂D (zt)\nand\nΞD = Lα√ m ∑T t=1 ∑m i=1 ∑K k=1 ζkij 〈Dek, xti〉,\nwhere the ζijk are also orthogaussian. Then for D1, D2 ∈ DK\nE (ΩD1 − ΩD2)2 =\n= T ∑\nt=1\n( R̂D1 (zt)− R̂D2 (zt) )2\n≤ T ∑\nt=1\n(\nsup γ∈Cα\n1\nm\nm ∑\ni=1\nℓ (〈D1γ, xti〉 , yti)\n−ℓ (〈D2γ, xti〉 , yti) )2\n≤ L2 T ∑\nt=1\nsup γ∈Cα\n(\n1\nm\nm ∑\ni=1\n〈 γ, ( D⊤1 −D⊤2 ) xti 〉\n)2\nLipschitz\n≤ L 2\nm\nT ∑\nt=1\nsup γ∈Cα\nm ∑\ni=1\n〈 γ, ( D⊤1 −D⊤2 ) xti 〉2 Jensen\n≤ L 2α2\nm\nT ∑\nt=1\nm ∑\ni=1\n∥ ∥ ( D⊤1 −D⊤2 ) xti ∥ ∥ 2 (Cauchy-Schwarz)\n= L2α2\nm\nT ∑\nt=1\nm ∑\ni=1\nK ∑\nk=1\n(〈D1ek, xti〉 − 〈D2ek, xti〉)2\n= E (ΞD1 − ΞD2)2 .\nSo by Slepian’s Lemma\nE supD∈DK ∑T t=1 ζjR̂D (zt)\n= E sup D∈DK ΩD ≤ E sup D∈D ΞD\n= Lα√ m E sup\nD∈DK\nT ∑\nt=1\nm ∑\ni=1\nK ∑\nk=1\nζkij 〈Dek, xti〉\n= Lα√ m E sup\nD∈DK\nK ∑\nk=1\n〈\nDek, T ∑\nt=1\nm ∑\ni=1\nζkijxti\n〉\n≤ Lα√ m sup D∈DK\n(\n∑\nk\n‖Dek‖2 )1/2\nE\n\n \n∑\nk\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nt,i\nζtkixti\n∥ ∥ ∥ ∥ ∥ ∥\n2 \n \n1/2\n≤ Lα √ K√\nm\n\n \n∑\nk\nE\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nt,i\nζtkixti\n∥ ∥ ∥ ∥ ∥ ∥\n2 \n \n1/2\n≤ Lα √ K√\nm\n\n\n∑\nk\n∑\nt,i\n‖xti‖2  \n1/2\n≤ LαK √\nTS1 (X).\nWe therefore have that with probability at least 1− δ in the draw of the multi sample Z ∼ρT\nsupD∈DK Ez∼ρ [ R̂D (z) ] − 1T ∑T i=1 R̂D (Zt)\n≤ LαK √ 2πS1 (X)\nT +\n√\n9 ln 2/δ\n2T . (13)\nwhich in (11) combines with (12) to give the conclusion.\nProof of Theorem 2. Let Dopt and γτ the minimizers in the definition of Ropt, so that\nRopt = Eτ∼EE(x,y)∼µ τ ℓ [(〈Doptγτ , x〉 , y)] .\nRE ( AD(Z) ) −Ropt can be decomposed as the sum of four terms,\n(\nRE ( AD(Z) ) − 1 T\nT ∑\nt=1\nR̂D(Z) (zt)\n)\n(14)\n+\n(\n1\nT\nT ∑\nt=1\nR̂D(Z) (zt)− 1\nT\nT ∑\nt=1\nR̂Dopt (zt)\n)\n(15)\n+ 1\nT\nT ∑\nt=1\nR̂Dopt (zt)− Ez∼ρR̂Dopt (z) (16)\n+Eτ∼E\n[\nEz∼µm τ R̂Dopt (z)\n−E(x,y)∼µ τ [ℓ (〈Doptγτ , x〉 , y)]\n]\n. (17)\nBy definition of R̂ we have for every τ that\nEz∼µm τ R̂Dopt (z)\n= Ez∼µm τ min γ∈Cα\n1\nm\nm ∑\ni=1\nℓ [(〈Doptγ, xi〉 , yi)]\n≤ Ez∼µm τ\n1\nm\nm ∑\ni=1\nℓ [(〈Doptγτ , xi〉 , yi)]\n= E(x,y)∼µ τ ℓ [(〈Doptγτ , x〉 , y)] .\nThe term (17) above is therefore non-positive. By Hoeffding’s inequality the term (16) is less than √\nln (2/δ) /2T with probability at least 1 − δ/2. The term (15) is nonpositive by the definition of D (Z). Finally we use Proposition 15 to obtain with probability at least 1− δ/2 that\nRE ( AD(Z) ) − 1T ∑T t=1 R̂D(Z) (zt)\n≤ sup D∈DK\nRE (AD)− 1\nT\nT ∑\nt=1\nR̂D (zt)\n≤ LαK √ 2πS1 (X)\nT\n+ 4Lα\n√\nS∞ (E) (2 + lnK) m +\n√\n9 ln 4/δ\n2T .\nCombining these estimates on (14), (15), (16) and (17) in a union bound gives the conclusion."
    } ],
    "references" : [ {
      "title" : "A framework for learning predictive structures from multiple tasks and unlabeled data",
      "author" : [ "R.K. Ando", "T. Zhang" ],
      "venue" : "J. of Machine Learning Research,",
      "citeRegEx" : "Ando and Zhang,? \\Q2005\\E",
      "shortCiteRegEx" : "Ando and Zhang",
      "year" : 2005
    }, {
      "title" : "Convex multitask feature learning",
      "author" : [ "A. Argyriou", "T. Evgeniou", "M. Pontil" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Argyriou et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Argyriou et al\\.",
      "year" : 2008
    }, {
      "title" : "An algorithm for transfer learning in a heterogeneous environment",
      "author" : [ "A. Argyriou", "A. Maurer", "M. Pontil" ],
      "venue" : "Proc. European Conf. Machine Learning,",
      "citeRegEx" : "Argyriou et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Argyriou et al\\.",
      "year" : 2008
    }, {
      "title" : "A model for inductive bias learning",
      "author" : [ "J. Baxter" ],
      "venue" : "J. of Artificial Intelligence Research,",
      "citeRegEx" : "Baxter,? \\Q2000\\E",
      "shortCiteRegEx" : "Baxter",
      "year" : 2000
    }, {
      "title" : "A fast iterative shrinkagethresholding algorithm for linear inverse problems",
      "author" : [ "A. Beck", "M. Teboulle" ],
      "venue" : "SIAM Journal of Imaging Sciences,",
      "citeRegEx" : "Beck and Teboulle,? \\Q2009\\E",
      "shortCiteRegEx" : "Beck and Teboulle",
      "year" : 2009
    }, {
      "title" : "Exploiting task relatedness for multiple task learning",
      "author" : [ "S. Ben-David", "R. Schuller" ],
      "venue" : "Proceedings of Computational Learning Theory (COLT),",
      "citeRegEx" : "Ben.David and Schuller,? \\Q2003\\E",
      "shortCiteRegEx" : "Ben.David and Schuller",
      "year" : 2003
    }, {
      "title" : "Statistics for HighDimensional Data: Methods, Theory and Applications",
      "author" : [ "P. Bühlmann", "S. van de Geer" ],
      "venue" : null,
      "citeRegEx" : "Bühlmann and Geer,? \\Q2011\\E",
      "shortCiteRegEx" : "Bühlmann and Geer",
      "year" : 2011
    }, {
      "title" : "Multi-task learning",
      "author" : [ "R. Caruana" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Caruana,? \\Q1997\\E",
      "shortCiteRegEx" : "Caruana",
      "year" : 1997
    }, {
      "title" : "Signal recovery by proximal forward-backward splitting",
      "author" : [ "P.L. Combettes", "V.R. Wajs" ],
      "venue" : "Multiscale Modeling and Simulation,",
      "citeRegEx" : "Combettes and Wajs,? \\Q2006\\E",
      "shortCiteRegEx" : "Combettes and Wajs",
      "year" : 2006
    }, {
      "title" : "Learning multiple tasks with kernel methods",
      "author" : [ "T. Evgeniou", "C.A. Micchelli", "M. Pontil" ],
      "venue" : "J. of Machine Learning Research,",
      "citeRegEx" : "Evgeniou et al\\.,? \\Q2005\\E",
      "shortCiteRegEx" : "Evgeniou et al\\.",
      "year" : 2005
    }, {
      "title" : "Proximal methods for hierarchical sparse coding",
      "author" : [ "R. Jenatton", "J. Mairal", "G. Obozinski", "F. Bach" ],
      "venue" : "J. of Machine Learning Research,",
      "citeRegEx" : "Jenatton et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Jenatton et al\\.",
      "year" : 2011
    }, {
      "title" : "Empirical margin distributions and bounding the generalization error of combined classifiers",
      "author" : [ "V. Koltchinskii", "D. Panchenko" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "Koltchinskii and Panchenko,? \\Q2002\\E",
      "shortCiteRegEx" : "Koltchinskii and Panchenko",
      "year" : 2002
    }, {
      "title" : "Learning task grouping and overlap in multitask learning",
      "author" : [ "A. Kumar", "H. Daumé III" ],
      "venue" : "International Conference on Machine Learning (ICML),",
      "citeRegEx" : "Kumar and III,? \\Q2012\\E",
      "shortCiteRegEx" : "Kumar and III",
      "year" : 2012
    }, {
      "title" : "Oracle inequalities and optimal inference under group sparsity",
      "author" : [ "K. Lounici", "M. Pontil", "A.B. Tsybakov", "S. van de Geer" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "Lounici et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Lounici et al\\.",
      "year" : 2011
    }, {
      "title" : "Concentration inequalities for functions of independent variables",
      "author" : [ "A. Maurer" ],
      "venue" : "Random Structures and Algorithms,",
      "citeRegEx" : "Maurer,? \\Q2006\\E",
      "shortCiteRegEx" : "Maurer",
      "year" : 2006
    }, {
      "title" : "Transfer bounds for linear feature learning",
      "author" : [ "A. Maurer" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Maurer,? \\Q2009\\E",
      "shortCiteRegEx" : "Maurer",
      "year" : 2009
    }, {
      "title" : "K-dimensional coding schemes in Hilbert spaces",
      "author" : [ "A. Maurer", "M. Pontil" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Maurer and Pontil,? \\Q2010\\E",
      "shortCiteRegEx" : "Maurer and Pontil",
      "year" : 2010
    }, {
      "title" : "Probabilistic Methods of Algorithmic Discrete Mathematics",
      "author" : [ "C. McDiarmid" ],
      "venue" : null,
      "citeRegEx" : "McDiarmid,? \\Q1998\\E",
      "shortCiteRegEx" : "McDiarmid",
      "year" : 1998
    }, {
      "title" : "Emergence of simple-cell receptive field properties by learning a sparse code for natural images",
      "author" : [ "B.A. Olshausen", "D.J. Field" ],
      "venue" : null,
      "citeRegEx" : "Olshausen and Field,? \\Q1996\\E",
      "shortCiteRegEx" : "Olshausen and Field",
      "year" : 1996
    }, {
      "title" : "The one-sided barrier problem for gaussian noise",
      "author" : [ "D. Slepian" ],
      "venue" : "Bell System Tech. J.,",
      "citeRegEx" : "Slepian,? \\Q1962\\E",
      "shortCiteRegEx" : "Slepian",
      "year" : 1962
    }, {
      "title" : "Regression shrinkage and selection via the lasso",
      "author" : [ "R. Tibshirani" ],
      "venue" : "J. R. Statist. Soc. B,",
      "citeRegEx" : "Tibshirani,? \\Q1996\\E",
      "shortCiteRegEx" : "Tibshirani",
      "year" : 1996
    } ],
    "referenceMentions" : [ {
      "referenceID" : 20,
      "context" : "A central development in this respect is the Lasso (Tibshirani, 1996), which estimates a linear predictor in a high dimensional space under a regularizing l1-penalty.",
      "startOffset" : 51,
      "endOffset" : 69
    }, {
      "referenceID" : 7,
      "context" : "Our work combines ideas from sparse coding (Olshausen & Field, 1996), multitask learning (Ando & Zhang, 2005; Argyriou, Evgeniou, Pontil, 2008; Argyriou, Maurer, Pontil, 2008; Ben-David & Schuller, 2003; Caruana, 1997; Evgeniou, Micchelli, Pontil, 2005; Maurer, 2009) and learning to learn (Baxter, 2000; Thrun & Pratt, 1998).",
      "startOffset" : 89,
      "endOffset" : 267
    }, {
      "referenceID" : 15,
      "context" : "Our work combines ideas from sparse coding (Olshausen & Field, 1996), multitask learning (Ando & Zhang, 2005; Argyriou, Evgeniou, Pontil, 2008; Argyriou, Maurer, Pontil, 2008; Ben-David & Schuller, 2003; Caruana, 1997; Evgeniou, Micchelli, Pontil, 2005; Maurer, 2009) and learning to learn (Baxter, 2000; Thrun & Pratt, 1998).",
      "startOffset" : 89,
      "endOffset" : 267
    }, {
      "referenceID" : 3,
      "context" : "Our work combines ideas from sparse coding (Olshausen & Field, 1996), multitask learning (Ando & Zhang, 2005; Argyriou, Evgeniou, Pontil, 2008; Argyriou, Maurer, Pontil, 2008; Ben-David & Schuller, 2003; Caruana, 1997; Evgeniou, Micchelli, Pontil, 2005; Maurer, 2009) and learning to learn (Baxter, 2000; Thrun & Pratt, 1998).",
      "startOffset" : 290,
      "endOffset" : 325
    }, {
      "referenceID" : 15,
      "context" : "The precursors of the analysis presented here are (Maurer & Pontil, 2010) and (Maurer, 2009).",
      "startOffset" : 78,
      "endOffset" : 92
    }, {
      "referenceID" : 3,
      "context" : "Our work combines ideas from sparse coding (Olshausen & Field, 1996), multitask learning (Ando & Zhang, 2005; Argyriou, Evgeniou, Pontil, 2008; Argyriou, Maurer, Pontil, 2008; Ben-David & Schuller, 2003; Caruana, 1997; Evgeniou, Micchelli, Pontil, 2005; Maurer, 2009) and learning to learn (Baxter, 2000; Thrun & Pratt, 1998). There is a vast literature on these subjects and the list of papers provided here is necessarily incomplete. Learning to learn (also called inductive bias learning or transfer learning) has been proposed by Baxter (2000) and an error analysis is provided therein, showing that a common representation which performs well on the training tasks will also generalize to new tasks obtained from the same “environment”.",
      "startOffset" : 291,
      "endOffset" : 548
    }, {
      "referenceID" : 3,
      "context" : "To formalize this, Baxter (2000) introduced the notion of an environment, which is a probability mea-",
      "startOffset" : 19,
      "endOffset" : 33
    }, {
      "referenceID" : 15,
      "context" : "2 of the supplementary appendix and follows the method outlined in (Maurer, 2009): one first bounds the estimation error for the expected empirical risk on future tasks, and then combines this with a bound of the expected true risk by said expected empirical risk.",
      "startOffset" : 67,
      "endOffset" : 81
    }, {
      "referenceID" : 10,
      "context" : "(Jenatton et al., 2011) and references therein for more information.",
      "startOffset" : 0,
      "endOffset" : 23
    }, {
      "referenceID" : 10,
      "context" : "(Jenatton et al., 2011; Lounici et al., 2011) or other families of regularizers.",
      "startOffset" : 0,
      "endOffset" : 45
    }, {
      "referenceID" : 13,
      "context" : "(Jenatton et al., 2011; Lounici et al., 2011) or other families of regularizers.",
      "startOffset" : 0,
      "endOffset" : 45
    }, {
      "referenceID" : 17,
      "context" : "The concentration inequality in part (i) of the following theorem, known as the bounded difference inequality is given in (McDiarmid, 1998).",
      "startOffset" : 122,
      "endOffset" : 139
    }, {
      "referenceID" : 14,
      "context" : "A proof of inequality (ii) is given in (Maurer, 2006).",
      "startOffset" : 39,
      "endOffset" : 53
    }, {
      "referenceID" : 19,
      "context" : "The next result is known as Slepian’s lemma ((Slepian, 1962), (Ledoux & Talagrand, 1991)).",
      "startOffset" : 45,
      "endOffset" : 60
    } ],
    "year" : 2014,
    "abstractText" : "We investigate the use of sparse coding and dictionary learning in the context of multitask and transfer learning. The central assumption of our learning method is that the tasks parameters are well approximated by sparse linear combinations of the atoms of a dictionary on a high or infinite dimensional space. This assumption, together with the large quantity of available data in the multitask and transfer learning settings, allows a principled choice of the dictionary. We provide bounds on the generalization error of this approach, for both settings. Numerical experiments on one synthetic and two real datasets show the advantage of our method over single task learning, a previous method based on orthogonal and dense representation of the tasks and a related method learning task grouping.",
    "creator" : "LaTeX with hyperref package"
  }
}