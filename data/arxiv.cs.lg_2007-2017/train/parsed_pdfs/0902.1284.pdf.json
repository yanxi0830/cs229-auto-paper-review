{
  "name" : "0902.1284.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Multi-Label Prediction via Compressed Sensing",
    "authors" : [ "Daniel Hsu" ],
    "emails" : [ "djhsu@cs.ucsd.edu", "sham@tti-c.org", "jl@hunch.net", "tongz@rci.rutgers.edu" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :0\n90 2.\n12 84\nv1 [\ncs .L\nG ]"
    }, {
      "heading" : "1. Introduction",
      "text" : "Suppose we have a large database of images, and we want to learn to predict which objects are in any given one. A standard approach to this task is to collect a sample of these images x along with corresponding labels y = (y1, . . . , yd) ∈ {0, 1}d, where yi = 1 if and only if object i is pictured in x, and then feed the labeled sample to a multi-label learning algorithm. Here, d is the total number of objects depicted in the entire database. When d is very large (e.g. 103, 104), the simple one-against-all approach of learning a sin-\nPreliminary work. Under review by the International Conference on Machine Learning (ICML). Do not distribute.\ngle predictor for each object i = 1, . . . , d can become prohibitively expensive at both training and test time.\nOur motivation for the present work comes from the observation that although the output (label) space may be very high dimensional, the actual labels are often sparse. That is, in each image, only a small number of objects may be present and there may only be a small amount of ambiguity in what they are. In this work, we consider how this sparsity in the output space, or output sparsity, eases the burden of multilabel learning.\nExploiting output sparsity. A subtle but critical point that distinguishes output sparsity from more common notions of sparsity (say, in feature or weight vectors) is that we are interested in sparsity in E[y|x] rather than y. In general, E[y|x] may be sparse while the actual outcome y may not (e.g. if there is much unbiased noise); and, vice versa, y may be sparse with probability one but E[y|x] may have full support. Conventional linear algebra suggests that we must predict d parameters in order to find the value of E[y|x] for each x. A crucial observation – central to the area of compressed sensing (Donoho, 2006) – is that methods exist to recover E[y|x] from just O(k log d) measurements when E[y|x] is k-sparse. This is the basis of our approach.\nOur contributions. We show how to apply algorithms for compressed sensing to the output coding approach (Dietterich & Bakiri, 1995). At a high level, the output coding approach creates a collection of subproblems of the form “Is the label in this subset or its complement?”, solves these problems, and then uses their solution to predict the final label.\nOur application of compressed sensing is distinct from its more conventional uses for data dimension reduction. Although we do employ a sensing matrix to compress training data, we ultimately are not interested in recovering data explicitly compressed this way. Rather, we learn to predict compressed label vectors, then use sparse reconstruction algorithms to recover uncompressed labels from these predictions. Thus we are interested in reconstruction accuracy of predictions, averaged over the data distribution.\nThe main contributions of this work are:\n1. A formal application of compressed sensing to prediction problems with output sparsity.\n2. An efficient output coding method, in which the number of required predictions is only logarithmic in the number of labels d, making it applicable to very large-scale problems.\n3. Robustness guarantees, in the form of regret transform bounds (in general) and a further detailed analysis for the linear prediction setting.\nPrior work. The idea of output coding was introduced in (Dietterich & Bakiri, 1995) and shown to be useful experimentally. Relative to this work, we expand the scope of the approach to multi-label prediction and provide bounds on regret and error which guide the design of codes.\nThe loss based decoding approach (Allwein et al., 2000) suggests decoding so as to minimize loss. However, it does not provide significant guidance in the choice of encoding technique, or the feedback between encoding and decoding which we analyze here.\nThe output coding approach is inconsistent when classifiers are used and the underlying problems being encoded are noisy. This is proved and analyzed in (Langford & Beygelzimer, 2005), where it is shown that using a Hadamard code creates a robust consistent predictor when reduced to binary regression. The approaches here require exponentially (in d) fewer predictors. The robustness guarantees here are weaker by a constant factor for the single label case, but stronger for the multi-label case. The multi-label case wasn’t specifically analyzed for PECOC, instead the arbitrary cost-sensitive case was analyzed. Carefully tuning the SECOC algorithm there gives a k2 dependence in the regret bound, which is functionally worse than the bounds here.\nOur algorithms rely on several compressed sensing approaches, which we detail where used."
    }, {
      "heading" : "2. Preliminaries",
      "text" : "Let X be an arbitrary input space and Y ⊂ Rd be a ddimensional output (label) space. We assume the data source is defined by a fixed but unknown distribution over X×Y. Our goal is to learn a predictor F : X → Y with low expected ℓ22-error\nEx‖F (x)− E[y|x]‖22 (the sum of mean-squared-errors over all labels) using a random i.i.d. sample of n data {(xi, yi)}ni=1. We focus on the regime in which the output space is very high-dimensional (d very large), but for any given x ∈ X , the expected value E[y|x] of the corresponding label y ∈ Y has only a few non-zero entries. A vector is k-sparse if it has at most k non-zero entries."
    }, {
      "heading" : "3. Learning and Prediction",
      "text" : ""
    }, {
      "heading" : "3.1. Learning Compressed Labels",
      "text" : "Let A : Rd → Rm be a linear compression function, where m ≤ d (but hopefully m ≪ d). We use A to compress (i.e. reduce the dimension of) the labels Y, and learn a predictor H : X → A(Y) of these compressed labels. Since A is linear, we simply represent A ∈ Rm×d as a matrix. Specifically, given a sample {(xi, yi)}ni=1, we form a compressed sample {(xi, Ayi)}ni=1 and then learn a predictor H of E[Ay|x] = AE[y|x] with the objective of minimizing the ℓ22-error\nEx‖H(x)− E[Ay|x]‖22."
    }, {
      "heading" : "3.2. Prediction",
      "text" : "To obtain a predictor F of E[y|x], we compose the predictor H of E[Ay|x] (learned using the compressed sample) with a reconstruction algorithm R : Rm → Rd. The algorithm Rmaps predictions of compressed labels Ay ∈ AY to predictions of labels y ∈ Y in the original output space.\nRecent developments in the area of compressed sensing have produced a spate of algorithms R with strong performance guarantees when the compression function A satisfies certain properties. We abstract out the relevant aspects of these guarantees in the following definition.\nDefinition. An algorithm R is a valid reconstruction algorithm for a family of compression functions {Ak ⊂⋃\nm≥1 R m×d : k ∈ N} and sparsity error sperr : N × R d → R, if there exists a function f : N → N and constants C1, C2 ∈ R such that: on input k ∈ N, A ∈\nAlgorithm 1 Training algorithm\nparameters sparsity level k, regression learning algorithm L, compression function A ∈ Rm×d input training data S ⊂ X × Rd for i = 1, . . . ,m do hi ← L({(x, (Ay)i) : (x, y) ∈ S})\nend for\noutput regressors H = [h1, . . . , hm]\nAk with m rows, and h ∈ Rm, the algorithm R(k,A, h) returns an f(k)-sparse vector ŷ satisfying\n‖ŷ − y‖22 ≤ C1 · ‖h−Ay‖22 + C2 · sperr(k, y)\nfor all y ∈ Rd. The function f is the output sparsity of R and the constants C1 and C2 are the regret factors.\nLoosely put, a reconstruction algorithm should be agnostic about the sparsity of the original signal (sperr(k,E[y|x])), as well as the “measurement noise” (the prediction error ‖H(x)− E[Ay|x]‖2). We make a few additional remarks on the definition.\n1. The minimum number of rows of matrices A ∈ Ak may in general depend on k (as well as the ambient dimension d). In the next section, we show how to construct such A with close to the optimal number of rows.\n2. The sparsity error sperr(k, y) should measure how poorly y ∈ Rd is approximated by a k-sparse vector.\n3. A reasonable output sparsity f(k) for sparsity level k should not be much more than k, e.g. f(k) = O(k).\nConcrete examples of valid reconstruction algorithms (along with the associated Ak, sperr, etc.) are given in the next section."
    }, {
      "heading" : "4. Algorithms",
      "text" : "Our prescribed recipe is summarized in Algorithms 1 and 2. We give some examples of compression functions and reconstruction algorithms in the following subsections."
    }, {
      "heading" : "4.1. Compression Functions",
      "text" : "Several valid reconstruction algorithms are known for compression matrices that satisfy a restricted isometry property.\nAlgorithm 2 Prediction algorithm\nparameters sparsity level k, compression function A ∈ Ak, valid reconstruction algorithm R for Ak, input regressors H = [h1, . . . , hm], test point x ∈ X output ŷ = ~R(k,A, [h1(x), . . . , hm(x)])\nAlgorithm 3 Prediction algorithm with R = OMP\nparameters sparsity level k, compression function A = [a1| . . . |ad] ∈ Ak, input regressors H = [h1, . . . , hm], test point x ∈ X b ← [h1(x), . . . , hm(x)]⊤ ŷ ← ~0, J ← ∅, r ← b for i = 1, . . . , 2k do j∗ ← argmaxj |r⊤aj | J ← J ∪ {j∗} ŷJ ← (AJ )†b (least-squares restricted to J) ŷJc ← ~0 r ← b−Aŷ\nend for output ŷ\nDefinition. A matrix A ∈ Rm×d satisfies the (k, δ)restricted isometry property ((k, δ)-RIP), δ ∈ (0, 1), if\n(1− δ)‖x‖22 ≤ ‖Ax‖22 ≤ (1 + δ)‖x‖22 for all k-sparse x ∈ Rd.\nWhile some explicit constructions of (k, δ)-RIP matrices are known (e.g. (DeVore, 2007)), the best guarantees are obtained when the matrix is chosen randomly from an appropriate distribution, such as one of the following (Mendelson et al., 2008; Rudelson & Vershynin, 2006).\n• All entries i.i.d. Gaussian N(0, 1/m), with m = O(k log(d/k)).\n• All entries i.i.d. Bernoulli B(1/2, 1/2) over {±1/√m}, with m = O(k log(d/k)).\n• Random subset of rows from the d× d Hadamard matrix over {±1/√m}, with m = O(k log5 d).\nThe hidden constants in the big-O notation depend inversely on δ and the probability of success.\nA striking feature of these constructions is the very mild dependence of m on the ambient dimension d. This translates to a significant savings in the number of learning problems one has to solve after employing our reduction.\nSome reconstruction algorithms require a stronger guarantee of bounded coherence µ(A) ≤ O(1/k),\nwhere µ(A) defined as\nµ(A) = max 1≤i<j≤d\n|(A⊤A)i,j |/ √ |(A⊤A)i,i||(A⊤A)j,j |\nIt is easy to check that the Gaussian, Bernoulli, and Hadamard-based random matrices given above have coherence bounded by O( √ (log d)/m) with high probability. Thus, one can take m = O(k2 log d) to guarantee 1/k coherence. This is a factor k worse than what was needed for (k, δ)-RIP, but the dependence on d is still small."
    }, {
      "heading" : "4.2. Reconstruction Algorithms",
      "text" : "In Table 1, we give some examples of valid reconstruction algorithms. These algorithms are valid for the Ak listed in the table, and sparsity error\nsperr(k, y) = ‖y − y(1:k)‖22 + 1\nk ‖y − y(1:k)‖21\nwhere y(1:k) is the best k-sparse approximation of y (i.e. the vector with just the k largest (in magnitude) coefficients of y).\nThe following theorem relates reconstruction quality to approximate sparse regression, giving a sufficient condition for an algorithm to be valid for RIP matrices. Theorem 1. Let Ak = {(k + f(k), δ)-RIP matrices} for some function f : N → N, and let A ∈ Ak have m rows. If for any h ∈ Rm, a reconstruction algorithm R returns an f(k)-sparse solution ŷ = R(k,A, h) satisfying\n‖Aŷ − h‖22 ≤ inf y∈Rd C‖Ay(1:k) − h‖22,\nthen it is a valid reconstruction algorithm for Ak and sperr given above, with output sparsity f and regret factors C1 = 2(1 − δ)−1(1 + √ C)2 and C2 = 4(1 −\nδ)−2(2 + √ C)2.\nWe defer all proofs to the appendices.\nIterative and greedy algorithms. Orthogonal Matching Pursuit (OMP) (Mallat & Zhang, 1993), FoBa (Zhang, 2008), and CoSaMP (Needell & Tropp, 2007) are examples of iterative or greedy reconstruction algorithms. OMP is a greedy forward selection method that repeatedly selects a new column of A to use in fitting h (see Algorithm 3). FoBa is similar, except it also incorporates backward steps to un-select columns that are later discovered to be unnecessary. CoSaMP is also similar to OMP, but instead selects larger sets of columns in each iteration.\nThe validity of FoBa and CoSaMP are apparent from the cited references. For OMP, we give the following guarantee.\nTheorem 2. If µ(A) ≤ 0.1/k, then after f(k) = 2k steps of OMP, the algorithm returns ŷ satisfying\n‖Aŷ − h‖22 ≤ 23‖Ay(1:k) − h‖22 (∀y ∈ Rd).\nℓ1 algorithms. Basis Pursuit (BP) (Candès et al., 2006) and its variants are based on finding the minimum ℓ1-norm solution to a linear system. While the basic form of BP is ill-suited for our application (it requires the user to supply the amount of measurement error ‖Ay− h‖2), its more advanced path-following or multi-stage variants may be valid. We use the popular LARS/Lasso algorithm (Efron et al., 2004) in our experiments."
    }, {
      "heading" : "5. Analysis",
      "text" : ""
    }, {
      "heading" : "5.1. Regret Analysis",
      "text" : "We now state our main regret transform bound, which follows immediately from the definition of a valid reconstruction algorithm and linearity of expectation.\nTheorem 3 (Regret Transform). Let R be a valid reconstruction algorithm for {Ak : k ∈ N} and sperr : N × Rd → R. Then there exists some constants C1 and C2 such that the following holds. Pick any k ∈ N, A ∈ Ak with m rows, and H : X → Rm. Let F : X → Rd be the composition of R(k,A, ·) and H, i.e. F (x) = R(k,A,H(x)). Then\nEx‖F (x)− E[y|x]‖22 ≤ C1 · Ex‖H(x)− E[Ay|x]‖22 + C2 · sperr(k,E[y|x]).\nIn order compare regret bound in Theorem 3 with the bounds afforded by Sensitive Error Correcting Output Codes (SECOC) (Langford & Beygelzimer, 2005), we need to relate Ex‖H(x)−E[Ay|x]‖22 to the average scaled mean-squared-error over all induced regression problems, where error is scaled by the maximum difference Li = maxy(Ay)i−miny(Ay)i between induced labels:\nr̄ = 1\nm\nm∑\ni=1\nEx\n( H(x)i − E[(Ay)i|x]\nLi\n)2 .\nIn these terms, SECOC can be tuned to yield\nEx‖F (x)− E[y|x]‖22 ≤ 4k2 · r̄\nfor general k.\nFor now, ignore the sparsity error. Let A ∈ Rm×d with N(0, 1/m) entries, where m = O(k log d). One can show that with high probability over the choice of A, supy ‖Ay‖∞ = O( √ k log(m)/m), where the supremum is taken over k-sparse vectors y ∈ {0, 1}d (see Lemma 8 in Appendix C). In this event, we have Li = O( √ k log(m)/m), so we have the bound\nC1 · Ex‖H(x)− E[Ay|x]‖22 ≤ O(k logm) · r̄ = O(k log k + k log log d) · r̄.\nThe improved dependence on k is at the cost of larger constants and log log d.\nNow we consider the sparsity error. When m = d (as is the case for SECOC), E[y|x] is allowed to be fully dense (k = d), in which case sperr(k,E[y|x]) = 0. Thus we pay a penalty for inducing just k < d problems unless E[y|x] is truly k-sparse."
    }, {
      "heading" : "5.2. Linear Prediction",
      "text" : "A danger of using generic reductions is that one creates a problem instance that is even harder to solve than the original problem. This is an oft cited issue with using output codes for multi-class problems.\nIn the case of linear prediction, however, the danger is mitigated. As a warm up, suppose there is a perfect linear predictor of E[y|x], i.e. E[y|x] = B⊤x for some B ∈ Rp×d (here X = Rp). Then it is easy to see that H = BA⊤ is a perfect linear predictor of E[Ay|x]: H⊤x = AB⊤x = AE[y|x] = E[Ay|x]. The following theorem generalizes this observation to imperfect linear predictors for certain well-behaved A.\nTheorem 4. Suppose X ⊂ Rp. Let B ∈ Rp×d be a linear function with\nEx ∥∥B⊤x− E[y|x] ∥∥2 2 = ǫ.\nLet A ∈ Rm×d have entries drawn i.i.d. from N(0, 1/m), and let H = BA⊤. Then with high probability (over the choice of A),\nEx‖H⊤x−AE[y|x]‖22 ≤ ( 1 +O(1/ √ m) ) ǫ.\nRemark 5. Similar guarantees can be proven for the Bernoulli-based matrices. Note that d does not appear in the bound. This is in contrast to the expected spectral norm of A, which is 1 +O( √ d/m).\nTheorem 4 implies that the errors of any linear predictor are not magnified much by the compression function. So a good linear predictor for the original problem implies an almost-as-good linear predictor for the induced problem."
    }, {
      "heading" : "6. Experiments",
      "text" : "We conducted an empirical assessment of the proposed reduction on two labeled data sets with large label spaces. These experiments demonstrate the feasibility of the method – a sanity check that the reduction does in fact preserve learnability – and compare different compression and reconstruction options. However, the scale of these experiments, in terms of data size and predictor complexity, is not yet able to show computational savings in terms of wall-clock measurements."
    }, {
      "heading" : "6.1. Data",
      "text" : "Image data.1 The first data set was collected by the ESP Game (von Ahn & Dabbish, 2004), an online game in which players ultimately provide word tags for a diverse set of web images.\nThe set contains nearly 68000 images, with about 22000 unique labels. We retained just the 1000 most frequent labels: the least frequent of these occurs 39 times in the data, and the most frequent occurs about 12000 times. Each image contains about four labels on average. We used half of the data for training and half for testing.\nWe represented each image as a bag-of-features vector in a manner similar to (Marsza lek et al., 2007). Specifically, we identified 1024 representative SURF features points (Bay et al., 2008) from 10 × 10 grayscale patches chosen randomly from the training images; this partitions the space of image patches (represented with SURF features) into Voronoi cells. We then built a histogram for each image, counting the number of patches that fall in each cell.\nText data.2 The second data set was collected by Tsoumakas et al. (2008) from del.icio.us, a social bookmarking service in which users assign descriptive textual tags to web pages.\nThe set contains about 16000 labeled web page and 983 unique labels. The least frequent label occurs 21 times and the most frequent occurs almost 6500 times. Each web page is assigned 19 labels on average. Again, we used half the data for training and half for testing.\n1http://hunch.net/∼learning/ESP-ImageSet.tar.gz 2http://mlkd.csd.auth.gr/multilabel.html\nEach web page is represented as a boolean bag-ofwords vector, with the vocabulary chosen using a combination of frequency thresholding and χ2 feature ranking. See (Tsoumakas et al., 2008) for details.\nEach binary label vector (for both data sets) has ones in the coordinates corresponding to the labels assigned to the data point."
    }, {
      "heading" : "6.2. Output Sparsity",
      "text" : "We first performed a bit of exploratory data analysis to get a sense of how sparse the target in our data is. We computed the least-squares linear regressor B̂ ∈ Rp×d on the training data (without any output coding) and predicted the label probabilities p̂(x) = B̂⊤x on the test data (clipping values to the range [0, 1]). Using p̂(x) as a surrogate for the actual target E[y|x], we examined the relative ℓ22 error of p̂ and its best k-sparse\napproximation ǫ(k, p̂(x)) = ∑d\ni=k+1 p̂(i)(x) 2/‖p̂(x)‖22,\nwhere p̂(1)(x) ≥ . . . ≥ p̂(d)(x). Examining Exǫ(k, p̂(x)) as a function of k, we saw that in both the image and text data, the fall-off with k is eventually super-polynomial, but we are interested in the behavior for small k where it appears polynomial k−r for some r. Around k = 10, we estimated an exponent of 0.50 for the image data and 0.55 for the text data. This is somewhat below the standard of what is considered sparse (e.g. vectors with small ℓ1-norm show k−1 decay). Thus, we expect the reconstruction algorithms will have to contend with the sparsity error of the target."
    }, {
      "heading" : "6.3. Procedure",
      "text" : "We used least-squares linear regression as our base learning algorithm, with no regularization on the image data and with ridge regularization with the text data (λ = 0.01) for numerical stability reasons. We did not attempt any parameter tuning.\nThe compression functions we used were generated by selecting m random rows of the 1024×1024 Hadamard matrix, for m ∈ {100, 200, 300, 400}. We also experimented with Gaussian matrices, but these uniformly yielded worse results.\nWe tested the greedy reconstruction algorithms described earlier (OMP, FoBa, and CoSaMP) as well as a path-following version of Lasso based on LARS (Efron et al., 2004). Each algorithm was used to recover a ksparse label vector ŷk from the predicted compressed label H(x), for k = 1, . . . , 10. We measured the ℓ22 distance ‖ŷk−y‖22 of the prediction to the true test label y. In addition, we measured the precision of the predicted\nsupport at various values of k using the 10-sparse label prediction. That is, we ordered the coefficients of each 10-sparse label prediction ŷ10 by magnitude, and measured the precision of predicting the first k coordinates | supp(ŷ10(1:k)) ∩ supp(y)|/k. Actually, for k ≥ 6, we used ŷ2k instead of ŷ10.\nWe used correlation decoding (CD) as a baseline method, as it is a standard decoding method for ECOC approaches. CD predicts using the top k coordinates in A⊤H(x), ordered by magnitude. For mean-squarederror comparisons, we used the least-squares approximation of H(x) using these k columns of A. In contrast to the other algorithms, CD does not enjoy the robustness guarantees required by our reduction."
    }, {
      "heading" : "6.4. Results",
      "text" : "As expected, the performance of the reduction, using any reconstruction algorithm, improves as the number of induced subproblems m is increased (see Figures 1 and 2; at m = 300, 400, the precision-at-k is nearly the same as one-against-all, i.e. m = 1024). When m is small and A 6∈ AK , the reconstruction algorithm cannot reliably choose k ≥ K coordinates, so its performance may degrade after this point by over-fitting. But when the compression function A is in AK for a sufficiently large K, then the squared-error decreases as the output sparsity k increases up to K. Note the fact that precision-at-k decreases as k increases is expected, as fewer data will have at least k correct labels.\nAll of the reconstruction algorithms at least match or out-performed the baseline on the mean-squared-error criterion, except when m = 100. When A has few rows, (1) A ∈ AK only for very small K, and (2) many of its columns will have significant correlation. In this case, when choosing k > K columns, it is better to choose correlated columns to avoid over-fitting. Both OMP and FoBa explicitly avoid this and thus do not fare well; but CoSaMP, Lasso, and CD do allow selecting correlated columns and thus perform better in this regime.\nThe results for precision-at-k are similar to that of mean-squared-error, except that choosing correlated columns does not necessarily help in the small m regime. This is because the extra correlated columns need not correspond to accurate label coordinates.\nIn summary, the experiments demonstrate the feasibility and robustness of our reduction method for two natural multi-label prediction tasks. They show that predictions of relatively few compressed labels are sufficient to recover an accurate sparse label vector, and as our theory suggests, the robustness of the recon-\nstruction algorithms is a key factor in their success."
    }, {
      "heading" : "A. Proof of Theorem 1",
      "text" : "Without loss of generality, assume |y1| ≥ . . . ≥ |yd|. Let ℓ = k + f(k) and ∆ = y − y(1:k). We decompose ∆ as ∆ = ∑ i≥0 yJi , where Ji = {k + iℓ + 1, . . . , k + (i + 1)ℓ}. Hölder’s inequality implies ‖yJi‖22 ≤ ‖yJi‖∞‖yJi‖1 ≤ ‖yJi‖∞‖yJi−1‖1, and for i ≥ 1, we have ‖yJi−1‖1 ≥ ℓ‖yJi‖∞ by definition. Therefore ‖yJi‖22 ≤ ‖yJi−1‖21/ℓ for i ≥ 1. Now exploiting the RIP guarantee for A and the above inequality, we have\n‖A∆‖2 ≤ ∑\ni≥0\n‖AyJi‖2 ≤ √ 1 + δ ∑\ni≥0\n‖yJi‖2\n= √ 1 + δ[‖yJ0‖2 + ∑\ni≥1\n‖yJi‖2]\n≤ √ 1 + δ[‖yJ0‖2 + ∑\ni≥0\n‖yJi‖1/ √ ℓ]\n≤ √ 1 + δ[‖∆‖2 + ‖∆‖1/ √ ℓ].\nTherefore ‖Ay(1:k) − h‖2 ≤ ‖Ay − h‖2 + ‖A∆‖2 ≤ ‖Ay − h‖2 + √ 1 + δ[‖∆‖2 + ‖∆‖1/ √ ℓ]. Hence\n‖ŷ − y‖2 ≤ ‖ŷ − y(1:k)‖2 + ‖∆‖2 ≤(1− δ)−1/2‖A(ŷ − y(1:k))‖2 + ‖∆‖2 ≤(1− δ)−1/2[‖Aŷ − h‖2 + ‖Ay(1:k) − h‖2] + ‖∆‖2 ≤(1− δ)−1/2[(1 + √ C)‖Ay(1:k) − h‖2] + ‖∆‖2 ≤(1− δ)−1/2(1 + √ C)‖Ay − h‖2\n+ ((1 − δ)−1(2 + √ C))[‖∆‖1/ √ ℓ+ ‖∆‖2].\nTo conclude, we square both sides and repeatedly simplify with the fact (x+ y)2 ≤ 2x2 + 2y2."
    }, {
      "heading" : "B. Proof of Theorem 2",
      "text" : "Without loss of generality, we assume that [ATA]i,i = 1 (this can be achieved by normalizing the columns of A) and the support of y(1:k) is {1 . . . k}. Let aj be the j-th column of A.\nWe consider three solution vectors:\n1. y: the k-sparse solution we want to compare to.\n2. y′: the ≤ (2k − 1)-sparse solution obtained by running OMP starting from y, with the property that the amount of progress (reduction in squared-error) to be made by another iteration is small: at most ‖h − Ay‖22/k. Since y′ is obtained by starting with y, it can only have smaller squared-error.\n3. ŷi: the actual solution returned by OMP up to the point at which it chooses a column j 6∈ supp(y′). When this happens, we have the guarantee that |a⊤j (h−Aŷi)| ≥ |a⊤ℓ (h−Aŷi)| for all ℓ ∈ supp(y′).\nLet ∆ = ŷi − y′. The goal is to bound ‖A∆‖22 in terms of ‖h − Ay′‖22 and |a⊤j (h − Ay′)|2. A key step is in bounding |a⊤j A∆|, which uses the fact that j 6∈ supp(∆) ⊆ supp(y′) and that the coherence of A is bounded µ(A) ≤ 0.1/k.\nProof of Theorem 2. Consider running k iterations of OMP starting at the solution y(0) = y(1:k), denoting the intermediate solutions by y(1), . . . , y(k). Let r(i) = h−Ay(t) be the residual after step i, ai be the additional column of A included in y(i), and ρi be the reduction in squared-error ρi = ‖h−Ay(i−1)‖22 −‖h− Ay(i)‖22 = ‖r(i−1)‖22 − ‖r(i)‖22 from the previous step. We want to bound ρi from below. To this end, consider the progress made by using ỹ(i) = y(i−1) + αiai instead of y(i), where αi = (a ⊤ i r (i−1)):\n‖r(i−1)‖22 − ‖h−Aỹ(i)‖22 =‖r(i−1)‖22 − ‖h− (A(y(i−1) + αiai))‖22 =‖r(i−1)‖22 − ‖r(i−1) − αiai‖22 =‖r(i−1)‖22 − (‖r(i−1)‖22 − 2αia⊤i r(i−1) + α2i ) =(a⊤i r (i−1))2.\nSince y(i) is the least-squares fit of h using the same columns of A as ỹ(i), its reduction in error can only be greater. Hence ρi ≥ (a⊤i r(i−1))2, and thus\n∑k i=1 ρi ≥∑k\ni=1(a ⊤ i r\n(i−1))2. The total reduction in error ∑t\ni=1 ρi is at most ‖r(0)‖22, so there must be some i∗ for which (a⊤i∗r (i∗−1))2 ≤ ‖r(0)‖22/k, i.e.\n(a⊤i∗(h−Ay(i ∗−1)))2 ≤ ‖h−Ay(1:k)‖22/k\n(else we have the contradiction ‖h − Ay(1:k)‖22 ≥∑ i ρi ≥ ∑ i(a ⊤ i r\n(i))2 > ‖h − Ay(1:k)‖22). Let y′ = y(i ∗−1) be the solution prior to this step, and let ai∗ be the selected column. It is clear that ‖h− Ay′‖22 ≤ ‖h − Ay(1:k)‖22 (the error could only have improved).\nWithout loss of generality, let the support of y′ be (a subset of) {1 . . .2k}. Now consider the actual execution of OMP (not starting from y(1:k)). We will compare the solution returned after 2k steps to the y′ defined above.\nLet i + 1 be the first time that OMP selects a column j not in {1 . . . 2k} (if this never happens, then ‖h − Aŷ‖22 ≤ ‖h − Ay(1:k)‖22 and we’re done). Then i ≤ 2k, and we only need to bound the error ‖h−Aŷi‖22 after time i where ŷi is the current OMP solution with support in {1 . . .2k}, since any later yi will have smaller error.\nLet ∆ = ŷi − y′, ri = h−Aŷi, and r = h−Ay′. Then\n‖A∆‖22 = r⊤A∆+ (A∆− r)⊤A∆ = r⊤A∆− (ri)⊤A∆ ≤ ‖r‖2‖A∆‖2 + |(ri)⊤A∆|\nby Cauchy-Schwarz. Using the fact x ≤ b√x + c ⇒ x ≤ (4/3)(b2 + c) (which in turn can be checked using the quadratic formula and the fact 2xy ≤ x2+y2), the above inequality implies\n‖A∆‖22 ≤ 4\n3\n( ‖r‖22 + |(ri)⊤A∆| ) . (1)\nThe selection criterion of OMP implies that if it choose a column j > 2k at time i, then\n|a⊤j ri| ≥ |a⊤ℓ ri| (∀ℓ ≤ 2k). (2)\nNote that since ∆ has support {1 . . .2k}, A∆ = A(1:2k)∆ where A(1:2k) is the matrix A with zeros in all but the first 2k columns. Therefore,\n|(ri)⊤A∆| = |(ri)⊤A(1:2k)∆| ≤‖(ri)⊤A(1:2k)‖∞‖∆‖1 (Cauchy-Schwarz) ≤|a⊤j ri|‖∆‖1 (ineq. (2)) ≤ ( |a⊤j r|+ |a⊤j A∆| ) ‖∆‖1 (triangle ineq.) ≤ ( |a⊤j r|+ ‖a⊤j A(1:2k)‖∞‖∆‖1 ) ‖∆‖1 (Cauchy-Sch.) ≤|a⊤j r|‖∆‖1 + µ(A)‖∆‖21. (defn. coherence)\nTherefore, continuing from ineq. (1), we have\n3 4 ‖A∆‖22 ≤ ‖r‖22 + |a⊤j r|‖∆‖1 + µ(A)‖∆‖21. (3)\nNow we relate ‖∆‖21 to ‖A∆‖22. Since µ(A) ≤ 1/10k and ∆ is 2k-sparse, Lemma 6 (below) implies that ‖A∆‖22 ≥ (1−0.2)‖∆‖22. By Cauchy-Schwarz, we have\n‖∆‖21 ≤ 2.5k‖A∆‖22. (4)\nCombining ineq. (4) with ineq. (3) gives (3/4)‖A∆‖22 ≤ ‖r‖22 + |a⊤j r|‖∆‖1 + µ(A)‖∆‖21 ≤ ‖r‖22 + |a⊤j r|‖∆‖1 + (1/4)‖A∆‖21, which rearranges to become\n1 2 ‖A∆‖22 ≤ ‖r‖22 + |a⊤j r|‖∆‖1. (5)\nThe second term on the right side can be bounded using the fact xy ≤ (x2 + y2)/2:\n|a⊤j r|‖∆‖1 ≤ 5k\n2 |a⊤j r|2 + ‖∆‖21 10k\n≤ 5k 2 |a⊤j r|2 + 1 4 ‖A∆‖22, (ineq. (4))\nwhereupon\n1 4 ‖A∆‖22 ≤ ‖r‖22 + 2.5k|a⊤j r|2. (6)\nFinally, we have |a⊤j r| ≤ |a⊤i∗r|, where i∗ ≤ 2k was defined as the next column that OMP would select when the current solution is y′ (i.e. when the residual is r = h − Ay′). Since |a⊤i∗r| ≤ ‖h− Ay(1:k)‖22/k, and also ‖r‖22 = ‖h−Ay′‖22 ≤ ‖h−Ay(1:k)‖22, we conclude from ineq. (6) that ‖A∆‖22 ≤ 14‖h−Ay(1:k)‖22, so\n‖h−Aŷi‖ ≤ ‖A∆‖2 + ‖h−Ay′‖2 (triangle ineq.) ≤ √ 14‖h−Ay(1:k)‖2 + ‖h−Ay′‖2\n≤ (1 + √ 14)‖h−Ay(1:k)‖2.\nSquaring both sides gives the conclusion.\nLemma 6. (Donoho et al., 2006) If y ∈ Rd is k-sparse and µ(A) ≤ δ/(k − 1), then ‖Ay‖22 ≥ (1 − δ)‖y‖22."
    }, {
      "heading" : "C. Output Range of Induced Regression Problems",
      "text" : "Lemma 8 implies that the output range of the regression problems induced by our reduction is bounded by O( √ k log(m)/m). Its proof is an easy consequence of the following concentration theorem.\nLemma 7 (Eq. (2.35) in (Ledoux, 2001)). Let γ be the standard D-dimensional Gaussian distribution N(0, ID). Then, for every C-Lipschitz function F : R D → R and every r ≥ 0,\nγ({F ≥ EF + r}) ≤ e−r2/2C2 .\nTo apply Lemma 7 to functions of matrices, the function should be Lipschitz with respect to the Frobenius norm ‖ · ‖F . Lemma 8. Let Θ ∈ Rm×d, where Θi,j are i.i.d. standard Gaussian random variables, and let Y = {y ∈ {0, 1}d : ‖y‖0 ≤ k}. Then supy∈Y ‖Θy‖∞ ≤ O( √ k lnm+ √ k ln(1/δ)) with probability at least 1−δ.\nProof. Let f(Θ) = supy∈Y ‖Θy‖∞. For J ⊆ {1, . . . , d} = [d], denote by ΘJ the matrix Θ with zeros in all columns except those indicated by J . First, note that for any Θ,Θ′ ∈ Rm×d, we have f(Θ) − f(Θ′) ≤ supy∈Y ‖(Θ−Θ′)y‖∞ ≤ supJ⊂[d]:|J|=k ‖ΘJ − Θ′J‖∞ ≤ √ k‖Θ − Θ′‖2 ≤ √ k‖Θ − Θ′‖F , so f is√\nk-Lipschitz (‖ · ‖∞ is the induced matrix p-norm with p = ∞). Next, to compute Ef(Θ), we use the fact that supy∈Y ‖Θy‖∞ = √ kmaxi=1,...,m |Zi|, where Z1, . . . , Zm are i.i.d. N(0, 1). By Jensen’s inequality, Emaxi |Zi| ≤ √ Emaxi Z2i . Now consider exp(tEmaxi Z 2 i ) for some t > 0. Again by Jensen’s, this is at most Emaxi e tZ2 i ≤ ∑i EetZ 2 i = m/ √ 1− 2t, using the moment generating function of χ2 random variables. So, we have Emaxi Z 2 i ≤ ln(m/ √ 1− 2t)/t, which is at most (2.1) lnm+ 4 for t = 0.49. Applying Lemma 7 concludes the proof."
    }, {
      "heading" : "D. Proof of Theorem 4",
      "text" : "We make use of the following Chernoff bound for sums of χ2 random variables (since the square of standard normal random variables are χ2-distributed with one degree of freedom), a proof of which can be found in the Appendix A of (Dasgupta, 2000).\nLemma 9. Fix any λ1 ≥ . . . ≥ λD > 0, and let X1, . . . , XD be i.i.d. random variables following the χ 2 distribution with one degree of freedom. Then\nPr\n[ D∑\ni=1\nλiXi > (1 + t)\nD∑\ni=1\nλi\n] ≤ exp ( −Dt 2\n24 · λ λ1\n)\nfor any 0 < t < 1, where λ = (λ1 + . . .+ λD)/D.\nProof of Theorem 4. Write A = (1/ √ m)[θ1| · · · |θm]⊤, where each θi is an independent d-dimensional Gaussian random vector N(0, Id). Define vx = B\n⊤x − E[y|x] so Ex‖vx‖22 = ǫ, and assume without loss of generality that vx has full d-dimensional support. Our goal is to show that with high probability, Ex‖Avx‖22 ≤ (1 + O(1/ √ m))ǫ. Using this definition and linearity of expectation, we have Ex‖Avx‖22 = (1/m)Ex ∑m i=1(θ ⊤ i vx) 2 = (1/m) ∑m i=1 θ ⊤ i (Exvxv ⊤ x )θi. Since N(0, Id) is rotationally invariant and Exvxv ⊤ x is symmetric and positive definite, we can assume Exvxv ⊤ x is diagonal with eigenvalues λ1 ≥\n. . . ≥ λd > 0. Then (1/m) ∑m i=1 θ ⊤ i (Exvxv ⊤ x )θi =\n(1/m) ∑m\ni=1 ∑d j=1 λjθ 2 ij . Each θ 2 ij is a χ 2 random\nvariable with one degree of freedom, so Eθ2ij = 1. Thus, the expected value of the previous sum is∑d\nj=1 trace(Exvxv ⊤ x ) = Ex trace(vxv ⊤ x ) = Ex‖vx‖22. Now applying Lemma 9, with D = md variables and λ = (λ1 + . . .+ λd)/d, we have Pr[(1/m) ∑ i,j λjθ 2 ij >\n(1 + t)ǫ] ≤ exp(−(mdt2/24)(λ/λ1)) ≤ exp(−mt2/24) (using the fact λ1 ≤ dλ). This bound is δ when t = √ (24/m) ln(1/δ)."
    } ],
    "references" : [ {
      "title" : "Reducing multiclass to binary: A unifying approach for margin classifiers",
      "author" : [ "E. Allwein", "R. Schapire", "Y. Singer" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Allwein et al\\.,? \\Q2000\\E",
      "shortCiteRegEx" : "Allwein et al\\.",
      "year" : 2000
    }, {
      "title" : "SURF: Speeded up robust features",
      "author" : [ "H. Bay", "A. Ess", "T. Tuytelaars", "L.V. Gool" ],
      "venue" : "Computer Vision and Image Understanding,",
      "citeRegEx" : "Bay et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Bay et al\\.",
      "year" : 2008
    }, {
      "title" : "Stable signal recovery from incomplete and inaccurate measurements",
      "author" : [ "E. Candès", "J. Romberg", "T. Tao" ],
      "venue" : "Comm. Pure Appl. Math.,",
      "citeRegEx" : "Candès et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Candès et al\\.",
      "year" : 2006
    }, {
      "title" : "Learning probability distributions. Doctoral dissertation, University of California",
      "author" : [ "S. Dasgupta" ],
      "venue" : null,
      "citeRegEx" : "Dasgupta,? \\Q2000\\E",
      "shortCiteRegEx" : "Dasgupta",
      "year" : 2000
    }, {
      "title" : "Deterministic constructions of compressed sensing matrices",
      "author" : [ "R. DeVore" ],
      "venue" : "J. of Complexity,",
      "citeRegEx" : "DeVore,? \\Q2007\\E",
      "shortCiteRegEx" : "DeVore",
      "year" : 2007
    }, {
      "title" : "Solving multiclass learning problems via error-correcting output codes",
      "author" : [ "T. Dietterich", "G. Bakiri" ],
      "venue" : "Journal of Artificial Intelligence Research,",
      "citeRegEx" : "Dietterich and Bakiri,? \\Q1995\\E",
      "shortCiteRegEx" : "Dietterich and Bakiri",
      "year" : 1995
    }, {
      "title" : "Compressed sensing",
      "author" : [ "D. Donoho" ],
      "venue" : "IEEE Trans. Info. Theory,",
      "citeRegEx" : "Donoho,? \\Q2006\\E",
      "shortCiteRegEx" : "Donoho",
      "year" : 2006
    }, {
      "title" : "Stable recovery of sparse overcomplete representations in the presence of noise",
      "author" : [ "D. Donoho", "M. Elad", "V. Temlyakov" ],
      "venue" : "IEEE Trans. Info. Theory,",
      "citeRegEx" : "Donoho et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Donoho et al\\.",
      "year" : 2006
    }, {
      "title" : "Least angle regression",
      "author" : [ "B. Efron", "T. Hastie", "I. Johnstone", "R. Tibshirani" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "Efron et al\\.,? \\Q2004\\E",
      "shortCiteRegEx" : "Efron et al\\.",
      "year" : 2004
    }, {
      "title" : "Sensitive error correcting output codes",
      "author" : [ "J. Langford", "A. Beygelzimer" ],
      "venue" : "Proc. Conference on Learning Theory",
      "citeRegEx" : "Langford and Beygelzimer,? \\Q2005\\E",
      "shortCiteRegEx" : "Langford and Beygelzimer",
      "year" : 2005
    }, {
      "title" : "The concentration of measure phenomenon",
      "author" : [ "M. Ledoux" ],
      "venue" : null,
      "citeRegEx" : "Ledoux,? \\Q2001\\E",
      "shortCiteRegEx" : "Ledoux",
      "year" : 2001
    }, {
      "title" : "Matching pursuits with time-frequency dictionaries",
      "author" : [ "S. Mallat", "Z. Zhang" ],
      "venue" : "IEEE Transactions on Signal Processing,",
      "citeRegEx" : "Mallat and Zhang,? \\Q1993\\E",
      "shortCiteRegEx" : "Mallat and Zhang",
      "year" : 1993
    }, {
      "title" : "Learning object representations for visual object class recognition",
      "author" : [ "M. lek", "C. Schmid", "H. Harzallah", "J. van de Weijer" ],
      "venue" : "Visual Recognition Challange Workshop,",
      "citeRegEx" : "lek et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "lek et al\\.",
      "year" : 2007
    }, {
      "title" : "Uniform uncertainty principle for Bernoulli and subgaussian ensembles",
      "author" : [ "S. Mendelson", "A. Pajor", "N. Tomczak-Jaegermann" ],
      "venue" : "Constructive Approximation,",
      "citeRegEx" : "Mendelson et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Mendelson et al\\.",
      "year" : 2008
    }, {
      "title" : "CoSaMP: Iterative signal recovery from incomplete and inaccurate samples",
      "author" : [ "D. Needell", "J. Tropp" ],
      "venue" : "Applied and Computational Harmonic Analysis",
      "citeRegEx" : "Needell and Tropp,? \\Q2007\\E",
      "shortCiteRegEx" : "Needell and Tropp",
      "year" : 2007
    }, {
      "title" : "Sparse reconstruction by convex relaxation: Fourier and Gaussian measurements",
      "author" : [ "M. Rudelson", "R. Vershynin" ],
      "venue" : "Proc. Conference on Information Sciences and Systems",
      "citeRegEx" : "Rudelson and Vershynin,? \\Q2006\\E",
      "shortCiteRegEx" : "Rudelson and Vershynin",
      "year" : 2006
    }, {
      "title" : "Effective and efficient multilabel classification in domains with large number of labels",
      "author" : [ "G. Tsoumakas", "I. Katakis", "I. Vlahavas" ],
      "venue" : "Proc. ECML/PKDD 2008 Workshop on Mining Multidimensional Data",
      "citeRegEx" : "Tsoumakas et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Tsoumakas et al\\.",
      "year" : 2008
    }, {
      "title" : "Labeling images with a computer game",
      "author" : [ "L. von Ahn", "L. Dabbish" ],
      "venue" : "Proc. ACM Conference on Human Factors in Computing Systems",
      "citeRegEx" : "Ahn and Dabbish,? \\Q2004\\E",
      "shortCiteRegEx" : "Ahn and Dabbish",
      "year" : 2004
    }, {
      "title" : "Adaptive forward-backward greedy algorithm for sparse learning with linear models",
      "author" : [ "T. Zhang" ],
      "venue" : "Proc. Neural Information Processing Systems",
      "citeRegEx" : "Zhang,? \\Q2008\\E",
      "shortCiteRegEx" : "Zhang",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 6,
      "context" : "A crucial observation – central to the area of compressed sensing (Donoho, 2006) – is that methods exist to recover E[y|x] from just O(k log d) measurements when E[y|x] is k-sparse.",
      "startOffset" : 66,
      "endOffset" : 80
    }, {
      "referenceID" : 0,
      "context" : "The loss based decoding approach (Allwein et al., 2000) suggests decoding so as to minimize loss.",
      "startOffset" : 33,
      "endOffset" : 55
    }, {
      "referenceID" : 4,
      "context" : "(DeVore, 2007)), the best guarantees are obtained when the matrix is chosen randomly from an appropriate distribution, such as one of the following (Mendelson et al.",
      "startOffset" : 0,
      "endOffset" : 14
    }, {
      "referenceID" : 13,
      "context" : "(DeVore, 2007)), the best guarantees are obtained when the matrix is chosen randomly from an appropriate distribution, such as one of the following (Mendelson et al., 2008; Rudelson & Vershynin, 2006).",
      "startOffset" : 148,
      "endOffset" : 200
    }, {
      "referenceID" : 18,
      "context" : "Orthogonal Matching Pursuit (OMP) (Mallat & Zhang, 1993), FoBa (Zhang, 2008), and CoSaMP (Needell & Tropp, 2007) are examples of iterative or greedy reconstruction algorithms.",
      "startOffset" : 63,
      "endOffset" : 76
    }, {
      "referenceID" : 2,
      "context" : "Basis Pursuit (BP) (Candès et al., 2006) and its variants are based on finding the minimum l1-norm solution to a linear system.",
      "startOffset" : 19,
      "endOffset" : 40
    }, {
      "referenceID" : 8,
      "context" : "We use the popular LARS/Lasso algorithm (Efron et al., 2004) in our experiments.",
      "startOffset" : 40,
      "endOffset" : 60
    }, {
      "referenceID" : 1,
      "context" : "Specifically, we identified 1024 representative SURF features points (Bay et al., 2008) from 10 × 10 grayscale patches chosen randomly from the training images; this partitions the space of image patches (represented with SURF features) into Voronoi cells.",
      "startOffset" : 69,
      "endOffset" : 87
    }, {
      "referenceID" : 1,
      "context" : "Specifically, we identified 1024 representative SURF features points (Bay et al., 2008) from 10 × 10 grayscale patches chosen randomly from the training images; this partitions the space of image patches (represented with SURF features) into Voronoi cells. We then built a histogram for each image, counting the number of patches that fall in each cell. Text data. The second data set was collected by Tsoumakas et al. (2008) from del.",
      "startOffset" : 70,
      "endOffset" : 426
    }, {
      "referenceID" : 16,
      "context" : "See (Tsoumakas et al., 2008) for details.",
      "startOffset" : 4,
      "endOffset" : 28
    }, {
      "referenceID" : 8,
      "context" : "We tested the greedy reconstruction algorithms described earlier (OMP, FoBa, and CoSaMP) as well as a path-following version of Lasso based on LARS (Efron et al., 2004).",
      "startOffset" : 148,
      "endOffset" : 168
    } ],
    "year" : 2017,
    "abstractText" : "We consider multi-label prediction problems with large output spaces under the assumption of output sparsity – that the target vectors have small support. We develop a general theory for a variant of the popular ECOC (error correcting output code) scheme, based on ideas from compressed sensing for exploiting this sparsity. The method can be regarded as a simple reduction from multilabel regression problems to binary regression problems. It is shown that the number of subproblems need only be logarithmic in the total number of label values, making this approach radically more efficient than others. We also state and prove performance guarantees for this method, and test it empirically.",
    "creator" : "dvips(k) 5.95a Copyright 2005 Radical Eye Software"
  }
}