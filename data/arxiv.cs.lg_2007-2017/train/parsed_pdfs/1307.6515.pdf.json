{
  "name" : "1307.6515.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : null,
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n30 7.\n65 15\nv1 [\nst at\n.M L\n] 2\n4 Ju\nl 2 01\n3"
    }, {
      "heading" : "CLUSTER TREES ON MANIFOLDS",
      "text" : ""
    }, {
      "heading" : "By Sivaraman Balakrishnan, Srivatsan Narayanan, Alessandro Rinaldo, Aarti",
      "text" : "Singh and Larry Wasserman\nSchool of Computer Science and Statistics Department Carnegie Mellon University\nIn this paper we investigate the problem of estimating the cluster tree for a density f supported on or near a smooth d-dimensional manifold M isometrically embedded in RD. We analyze a modified version of a k-nearest neighbor based algorithm recently proposed by Chaudhuri and Dasgupta [1]. The main results of this paper show that under mild assumptions on f and M , we obtain rates of convergence that depend on d only but not on the ambient dimension D. We also show that similar (albeit non-algorithmic) results can be obtained for kernel density estimators. We sketch a construction of a sample complexity lower bound instance for a natural class of manifold oblivious clustering algorithms. We further briefly consider the known manifold case and show that in this case a spatially adaptive algorithm achieves better rates.\n1. Introduction. In this paper, we study the problem of estimating the cluster tree of a density when the density is supported on or near a manifold. Let X := {X1, . . . ,Xn} be a sample drawn i.i.d. from a distribution P with density f . The connected components Cf (λ) of the upper level set {x : f(x) ≥ λ} are called density clusters. The collection C = {Cf (λ) : λ ≥ 0} of all such clusters is called the cluster tree and estimating this cluster tree is referred to as density clustering.\nThe density clustering paradigm is attractive for various reasons. One of the main difficulties of clustering is that often the true goals of clustering are not clear and this makes clusters, and clustering as a task seem poorly defined. Density clustering however is estimating a well defined population quantity, making its goal, consistent recovery of the population density clusters, clear. Typically only mild assumptions are made on the density f and this allows extremely general shapes and numbers of clusters at each level. Finally, the cluster tree is an inherently hierarchical object and thus density clustering algorithms typically do not require specification of the “right” level, rather they capture a summary of the density across all levels.\nThe search for a simple, statistically consistent estimator of the cluster tree has a long history. Hartigan [2] showed that the popular single-linkage algorithm is not consistent for a sample from R D, with D > 1. Recently, Chaudhuri and Dasgupta [1] analyzed an algorithm which is both simple and consistent. The algorithm finds the connected components of a sequence of carefully constructed neighborhood graphs. They showed that, as long as the parameters of the algorithm are chosen appropriately, the resulting collection of connected components correctly estimates the cluster tree with high probability.\nIn this paper, we are concerned with the problem of estimating the cluster tree when the density f is supported on or near a low dimensional manifold. The motivation for this work stems from the problem of devising and analyzing clustering algorithms with provable performance that can be used in high dimensional applications. When data live in high dimensions, clustering (as well as other statistical tasks) generally become prohibitively difficult due to the curse of dimensionality,\nwhich demands a very large sample size. In many high dimensional applications however data is not spread uniformly but rather concentrates around a low dimensional set. This so-called manifold hypothesis motivates the study of data generated on or near low dimensional manifolds and the study of procedures that can adapt effectively to the intrinsic dimensionality of this data.\n1.1. Contributions. Here is a brief summary of the main contributions of this paper:\n1. We show that the simple algorithm studied in [1] is consistent and has fast rates of convergence for data on or near a low dimensional manifold M . The algorithm does not require the user to first estimate M (which is a difficult problem). In other words, the algorithm adapts to the (unknown) manifold. 2. We show that the sample complexity for identifying salient clusters is independent of the ambient dimension. 3. We sketch a construction of a sample complexity lower bound instance for a natural class of clustering algorithms that we study in this paper. 4. We show that in the known manifold case a modified spatially adaptive algorithm achieves better rates, similar to the near minimax-optimal rates of [1]. 5. We introduce a framework for studying consistency of clustering when the distribution is not supported on a manifold but rather, is concentrated near a manifold. The generative model in this case is that the data are first sampled from a distribution on a manifold and then noise is added. The original data are latent (unobserved). We show that for certain noise models we can still efficiently recover the cluster tree on the latent samples. 6. We show similar statistical results for the level sets of kernel density estimates for an appropriately chosen bandwidth. Computing the level sets of the kernel density estimate is however a challenging problem that we do not address in this paper. 7. We present some simulations to confirm our theoretical results.\n1.2. Related Work. The idea of using probability density functions for clustering dates back to Wishart [3]. [2] expanded on this idea and formalized the notions of high-density clustering, of the cluster tree and of consistency and fractional consistency of clustering algorithms. In particular, [2] showed that single linkage clustering is consistent when D = 1 but is only fractionally consistent when D > 1. [4] and [5] have also proposed procedures for recovering the cluster tree. None of these procedures however, come with the theoretical guarantees given by [1], which demonstrated that a generalization of Wishart’s algorithm allows one to estimate parts of the cluster tree for distributions with full-dimensional support near-optimally under rather mild assumptions. This paper forms the starting point for our work and is reviewed in more detail in the next section.\nIn the last two decades, much of the research effort involving the use of nonparametric density estimators for clustering has focused on the more specialized problems of optimal estimation of the support of the distribution or of a fixed level set. However, consistency of estimators of a fixed level set does not imply cluster tree consistency, and extending the techniques and analyses mentioned above to hold simultaneously over a variety of density levels is non-trivial. See, e.g., [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein. Estimating the cluster tree has more recently been considered in [16] which also gives a simple pruning procedure for removing spurious clusters. [17, 18] propose procedures for determining recursively the lowest split in the cluster tree and give conditions for asymptotic consistency with minimal assumptions on the density.\n2. Background and Assumptions. Let P be a distribution supported on an unknown ddimensional manifold M . We assume that the manifold M is a d-dimensional Riemannian manifold without boundary embedded in a compact set X ⊂ RD with d < D. We further assume that the volume of the manifold is bounded from above by a constant, i.e., vold(M) ≤ C. The main regularity condition we impose on M is that its condition number be not too large. The condition number of M is 1/τ , where τ is the largest number such that the open normal bundle about M of radius r is imbedded in RD for every r < τ . The condition number controls the curvature of M and prevents it from being too close to being self-intersecting (see [19] for a detailed treatment).\nThe Euclidean norm is denoted by ‖ · ‖ and vd denotes the volume of the d-dimensional unit ball in R d. B(x, r) denotes the full-dimensional ball of radius r centered at x and BM (x, r) ..= B(x, r)∩M . For Z ⊂ Rd and σ > 0, define Zσ = Z + B(0, σ) and ZM,σ = (Z + B(0, σ)) ∩M . Note that Zσ is full dimensional, while if Z ⊆ M then ZM,σ is d-dimensional.\nLet f be the density of P with respect to the uniform measure on M . For λ ≥ 0, let Cf (λ) be the collection of connected components of the level set {x ∈ X : f(x) ≥ λ} and define the cluster tree of f to be the hierarchy C = {Cf (λ) : λ ≥ 0}. For a fixed λ, any member of Cf (λ) is a cluster. For a cluster C its restriction to the sample X is defined to be C[X] = C ∩X. The restriction of the cluster tree C to X is defined to be C[X] = {C ∩X : C ∈ C}. Informally, this restriction is a dendrogram-like hierarchical partition of X.\nTo give finite sample results, following [1], we define the notion of salient clusters. Our definitions are slight modifications of those in [1] to take into account the manifold assumption.\nDefinition 1. Clusters A and A′ are (σ, ǫ) separated if there exists a nonempty S ⊂ M such that:\n1. Any path along M from A to A′ intersects S. 2. supx∈SM,σ f(x) < (1− ǫ) infx∈AM,σ∪A′M,σ f(x).\nChaudhuri and Dasgupta [1] analyze a robust single linkage (RSL) algorithm (in Figure 1). An RSL algorithm estimates the connected components at a level λ in two stages. In the first stage, the sample is cleaned by thresholding the k-nearest neighbor distance of the sample points at a radius r and then, in the second stage, the cleaned sample is connected at a connection radius R. The connected components of the resulting graph give an estimate of the restriction Cf (λ)[X]. In Section 4 we prove a sample complexity lower bound for the class of RSL algorithms which we now define.\nDefinition 2. The class of RSL algorithms refers to any algorithm that is of the form described in the algorithm in Figure 1 and relying on Euclidean balls, with any choice of k, r and R.\nWe define two notions of consistency for an estimator Ĉ of the cluster tree:\nDefinition 3 (Hartigan consistency). For any sets A, A′ ⊂ X , let An (resp., A′n) denote the smallest cluster of Ĉ containing A ∩X (resp, A′ ∩X). We say Cn is consistent if, whenever A and A′ are different connected components of {x : f(x) ≥ λ} (for some λ > 0), the probability that An is disconnected from A′n approaches 1 as n → ∞.\n1. For each Xi, rk(Xi) := inf{r : B(Xi, r) contains k data points}.\n2. As r grows from 0 to ∞:\n(a) Construct a graph Gr,R with nodes {Xi : rk(Xi) ≤ r} and edges (Xi, Xj) if ‖Xi −Xj‖ ≤ R.\n(b) Let C(r) be the connected components of Gr,R.\n3. Denote Ĉ = {C(r) : r ∈ [0,∞)} and return Ĉ.\nFig 1. Robust Single Linkage (RSL) Algorithm\nDefinition 4 ((σ, ǫ) consistency). For any sets A, A′ ⊂ X such that A and A′ are (σ, ǫ) separated, let An (resp., A ′ n) denote the smallest cluster of Ĉ containing A ∩X (resp, A′ ∩X). We say Cn is consistent if, whenever A and A′ are different connected components of {x : f(x) ≥ λ} (for some λ > 0), the probability that An is disconnected from A ′ n approaches 1 as n → ∞.\nThe notion of (σ, ǫ) consistency is similar that of Hartigan consistency except restricted to (σ, ǫ) separated clusters A and A′, and typically associated with a finite sample of size n. [1] prove the following theorem, establishing finite sample bounds for a particular RSL algorithm. In this theorem there is no manifold and f is a density with respect to the Lebesgue measure on RD.\nTheorem 5. There is a constant C such that the following holds. Suppose that we run the algorithm in Figure 1 with\nR = √ 2r and k = C\n( D log n\nǫ2\n) log2(1/δ)\nthen with probability at least 1− δ, the algorithm output Ĉ is (σ, ǫ) consistent provided\nλ ≥ 1 vD(σ/2)D k n\n( 1 + ǫ\n2\n) .\nThe theorem as stated does not explicitly give a sample complexity bound but it is straightforward to obtain one by plugging in the value for k and solving for n in the inequality that restricts λ to be large enough (as a function of n).\nIn particular, notice that if\nn ≥ O (\nD\nλǫ2vD(σ/2)D log\nD\nλǫ2vD(σ/2)D\n)\nthen we can resolve any pair of (σ, ǫ) clusters at level at least λ. It is important to note that this theorem does not apply to the setting when distributions are supported on a lower dimensional set for at least two reasons: (1) the density f is singular with respect to the Lebesgue measure on X and so the cluster tree is trivial, and (2) the definitions of saliency with respect to X are typically not satisfied when f has a lower dimensional support.\n3. Clustering on Manifolds. In this section we show that the RSL algorithm can be adapted to recover the cluster tree of a distribution supported on a manifold of dimension d < D with the rates depending only on d. In place of the cluster salience parameter σ, our rates involve a new parameter ρ\nρ := min\n( 3σ\n16 , ǫτ 72d , τ 16\n) .\nThe precise reason for this definition of ρ will be clear from the proofs (particularly of Lemma 8) but for now notice that in addition to σ it is dependent on the condition number 1/τ and deteriorates as the condition number increases. Finally, to succinctly present our results we use µ := log n+ d log(1/ρ).\nTheorem 6. There are universal constants C1 and C2 such that the following holds. For any δ > 0, 0 < ǫ < 1/2, run the algorithm in Figure 1 on a sample X drawn from f , where the parameters are set according to the equations\nR = 4ρ and k = C1 log 2(1/δ)(µ/ǫ2).\nThen with probability at least 1−δ, Ĉ is (σ, ǫ) consistent. In particular, the clusters containing A[X] and A′[X], where A and A′ are (σ, ǫ) separated, are internally connected and mutually disconnected in C(r) for r defined by\nvdr dλ =\n1\n1− ǫ/6\n( k\nn +\nC2 log(1/δ)\nn\n√ kµ\n)\nprovided\nλ ≥ 2 vdρd k n .\nBefore we prove this theorem a few remarks are in order:\n1. To obtain an explicit sample complexity, as in Theorem 5, we plug in the value of k and solve for n from the inequality restricting λ. The sample complexity of the RSL algorithm for recovering (σ, ǫ) clusters at level at least λ on a manifold M with condition number at most 1/τ is\nn = O\n( d\nλǫ2vdρd log\nd\nλǫ2vdρd\n)\nwhere ρ = Cmin (σ, ǫτ/d, τ). Ignoring constants that depend on d the main difference between this result and the result of [1] (Theorem 5) is that our results only depend on the manifold dimension d and not the ambient dimension D (typically D ≫ d). There is also a dependence of our result on 1/(ǫτ)d, for ǫτ ≪ σ. In Section 4 we sketch the construction of an instance that suggests that this dependence is not an artifact of our analysis and that the sample complexity of the class of RSL algorithms is at least n ≥ 1/(ǫτ)Ω(d). 2. Another aspect is that our choice of the connection radius R depends on the (typically) unknown ρ, while for comparison, the connection radius in [1] is chosen to be √ 2r. Under\nthe mild assumption that λ ≤ nO(1) (which is satisfied for instance, if the density on M is bounded from above), we show in Section 9.8 that an identical theorem holds for R = 4r. k is the only real tuning parameter of this algorithm whose choice depends on ǫ and an unknown leading constant.\n3. It is easy to see that this theorem also establishes consistency for recovering the entire cluster tree by selecting an appropriate schedule on σn, ǫn and kn that ensures that all clusters are distinguished for n large enough (see [1] for a formal proof).\nOur proofs structurally mirror those in [1]. We begin with a few technical results in 3.1. In Section 3.2 we establish (σ, ǫ) consistency by showing that the clusters are mutually disjoint and internally connected. The main technical challenge is that the curvature of the manifold, modulated by its condition number 1/τ , limits our ability to resolve the density level sets from a finite sample, by limiting the maximum cleaning and connection radii the algorithm can use. In what follows, we carefully analyze this effect and show that somewhat surprisingly, despite this curvature, essentially the same algorithm is able to adapt to the unknown manifold and produce a consistent estimate of the entire cluster tree. Similar manifold adaptivity results have been shown in classification [20] and in non-parametric regression [21, 22].\n3.1. Technical results. In our proof, we use the uniform convergence of the empirical mass of Euclidean balls to their true mass. In the full dimensional setting of [1], this follows from standard VC inequalities. To the best of our knowledge however sharp (ambient dimension independent) inequalities for manifolds are unknown. We get around this obstacle by using the insight that, in order to analyze the RSL algorithms, uniform convergence for Euclidean balls around the sample points and around a fixed minimum s-net N of M (for an appropriately chosen s) suffice to analyze the RSL algorithm.\nRecall, an s-net N ⊆ M is such that every point of M is at a distance at most s from some point in N . Let\nBn,N := { B(z, s) : z ∈ N ∪X, s ≥ 0 }\nbe the collection of balls whose centers are sample or net points. We are ready to state our uniform convergence lemma. The proof is in Section 9.3.\nLemma 7 (Uniform Convergence). Assume k ≥ µ. Then there exists a constant C0 such that the following holds. For every δ > 0, with probability > 1− δ, for all B ∈ Bn,N , we have:\nP (B) ≥ Cδµ n =⇒ Pn(B) > 0\nP (B) ≥ k n + Cδ n\n√ kµ =⇒ Pn(B) ≥ k\nn\nP (B) ≤ k n − Cδ n\n√ kµ =⇒ Pn(B) < k\nn ,\nwhere Cδ := 2C0 log(2/δ), and µ := 1 + log n + log |N | = Cd + log n + d log(1/s). Here Pn(B) = |X ∩B|/n denotes the empirical probability measure of B, and C is a universal constant.\nNext we provide a tight estimate of the volume of a small ball intersected with M . This bounds the distortion of the apparent density due to the curvature of the manifold and is central to many of our arguments. Intuitively, the claim states that the volume is approximately that of a d-dimensional Euclidean ball, provided that its radius is small enough compared to τ . The lower bound is based on Lemma 5.3 of [19] while the upper bound is based on a modification of the main result of [23].\nLemma 8 (Ball volumes). Assume r < τ/2. Define S := B(x, r) ∩M for a point x ∈ M . Then ( 1− r 2\n4τ2\n)d/2 vdr d ≤ vold(S) ≤ vd (\nτ\nτ − 2r1\n)d rd1 ,\nwhere r1 = τ − τ √ 1− 2r/τ . In particular, if r ≤ ǫτ/72d for 0 ≤ ǫ < 1, then\nvdr d(1− ǫ/6) ≤ vold(S) ≤ vdrd(1 + ǫ/6).\n3.2. Separation and Connectedness.\nLemma 9 (Separation). Assume that we pick k, r and R to satisfy the conditions:\nr ≤ ρ R = 4ρ\nvdr d(1− ǫ/6)λ ≥ k\nn + Cδ n\n√ kµ\nvdr d(1 + ǫ/6)λ(1 − ǫ) ≤ k n − Cδ n\n√ kµ.\nThen with probability 1− δ, we have:\n1. All points in Aσ−r and A ′ σ−r are kept, and all points in Sσ−r are removed. 2. The two point sets A ∩X and A′ ∩X are disconnected in Gr,R.\nProof. The proof is analogous to the separation proof of [1] with several modifications. Most importantly, we need to ensure that despite the curvature of the manifold we can still resolve the density well enough to guarantee that we can identify and eliminate points in the region of separation.\nThroughout the proof, we will assume that the good event in Lemma 7 (uniform convergence for Bn,N ) occurs. Since r ≤ ǫτ/72d, by Lemma 8 vol(BM (x, r)) is between vdrd(1 − ǫ/6) and vdr\nd(1+ ǫ/6), for any x ∈ M . So if Xi ∈ A∪A′, then BM (Xi, r) has mass at least vdrd(1− ǫ/6) ·λ. Since this is ≥ kn + Cδ n √ kµ by assumption, this ball contains at least k sample points, and hence Xi is kept.\nOn the other hand, ifXi ∈ Sσ−r, then the set BM (Xi, r) contains mass at most vdrd(1+ǫ/6)·λ(1−ǫ). This is ≤ kn − Cδ n √ kµ. Thus by Lemma 7 BM (Xi, r) contains fewer than k sample points, and hence Xi is removed.\nTo prove the graph is disconnected, we first need a bound on the geodesic distance between two points that are at most R apart in Euclidean distance. Such an estimate follows from Proposition 6.3 in [19] who show that if ‖p− q‖ = R ≤ τ/2, then the geodesic distance\ndM (p, q) ≤ τ − τ √\n1− 2R τ .\nIn particular, if R ≤ τ/4, then dM (p, q) < R ( 1 + 4Rτ ) ≤ 2R. Now, notice that if the graph is connected there must be an edge that connects two points that are at a geodesic distance of at\nleast 2(σ − r). Any path between a point in A and a point in A′ along M must pass through Sσ−r and must have a geodesic length of at least 2(σ − r). This is impossible if the connection radius satisfies 2R < 2(σ − r), which follows by the assumptions on r and R.\nAll the conditions in Lemma 9 can be simultaneously satisfied by setting k := 16C2δ (µ/ǫ 2), and\n(1) vdr d(1− ǫ/6) · λ = k\nn + Cδ n\n√ kµ.\nThe condition on r is satisfied since\nλ ≥ 2 vdρd k n\nand the condition on R is satisfied by its definition.\nLemma 10 (Connectedness). Assume that the parameters k, r and R satisfy the separation conditions (in Lemma 9). Then, with probability at least 1− δ, A[X] is connected in Gr,R.\nProof. Let us show that any two points in A ∩X are connected in Gr,R. Consider y, y′ ∈ A ∩X. Since A is connected, there is a path P between y, y′ lying entirely inside A, i.e., a continuous map P : [0, 1] → A such that P (0) = y and P (1) = y′. We can find a sequence of points y0, . . . , yt ∈ P such that y0 = y, yt = y\n′, and the geodesic distance on M (and hence the Euclidean distance) between yi−1 and yi is at most η, for an arbitrarily small constant η.\nLet N be minimal R/4-net of M . There exist zi ∈ N such that ‖yi − zi‖ ≤ R/4. Since yi ∈ A, we have zi ∈ AM,R/4, and hence the ball BM (zi, R/4) lies completely inside AM,R/2 ⊆ AM,σ−r. In particular, the density inside the ball is at least λ everywhere, and hence the mass inside it is at least\nvd(R/4) d(1− ǫ/6)λ ≥ Cδµ\nn .\nObserve that R ≥ 4r and so this condition is satisfied as a consequence of satisfying Equation 1. Thus Lemma 7 guarantees that the ball BM (zi, R/4) contains at least one sample point, say xi. (Without loss of generality, we may assume x0 = y and xt = y\n′.) Since the ball lies completely in AM,σ−r, the sample point xi is not removed in the cleaning step (Lemma 9).\nFinally, we bound d(xi−1, xi) by considering the sequence of points (xi−1, zi−1, yi−1, yi, zi, xi). The pair (yi−1, yi) are at most s apart and the other successive pairs at most R/4 apart, hence d(xi−1, xi) ≤ 4(R/4) + η = R+ η. The claim follows by letting η → 0.\n4. A lower bound instance for the class of RSL algorithms. Recall that the sample complexity in Theorem 6 scales as\nn = O\n( d\nλǫ2vdρd log\nd\nλǫ2vdρd\n)\nwhere ρ = Cmin (σ, ǫτ/d, τ). For full dimensional densities, [1] showed the information theoretic lower bound\nn = Ω\n( 1\nλǫ2vDσD log\n1\nλǫ2vDσD\n) .\nTheir construction can be straightforwardly modified to a d-dimensional instance on a smooth manifold. Ignoring constants that depend on d, these upper and lower bounds can still differ by a factor of 1/(ǫτ)d, for ǫτ ≪ σ. In this section we provide an informal sketch of a hard instance for the class of RSL algorithms (see Definition 2) that suggests a sample complexity lower bound of n ≥ 1/(ǫτ)Ω(d).\nWe first describe our lower bound instance. The manifold M consists of two disjoint components, C and C ′. The component C in turn contains three parts, which we call ‘top’, ‘middle’, and ‘bottom’ respectively. The middle part, denoted M2, is the portion of the standard d-dimensional unit sphere S d(0, 1) between the planes x1 = + √ 1− 4τ2 and x1 = − √ 1− 4τ2. The top part, denoted M1, is\nthe upper hemisphere of radius 2τ centered at (+ √ 1− 4τ2, 0, 0, . . . , 0). The bottom part, denoted\nM3, is a symmetric hemisphere centered at (− √ 1− 4τ2, 0, 0, . . . , 0). Thus C is obtained by gluing a portion of the unit sphere with two (small) hemispherical caps. C as described does not have a condition number at most 1/τ because of the “corners” at the intersection of M2 and M1 ∪ M3. This can be fixed without affecting the essence of the construction by smoothing this intersection by rolling a ball of radius τ around it (a similar construction is made rigorous in Theorem 6 of [25]). Finally, the component C ′ is a sphere far away from C whose function ensure that f integrates to 1.\nLet P be the distribution on M whose density over C is λ if |x1| > 1/2, and λ(1− ǫ) if |x1| ≤ 1/2, where λ is chosen small enough such that λ vold(C) ≤ 1. The density over C ′ is chosen such that the total mass of the manifold is 1. Now M1 and M3 are (σ, ǫ) separated at level λ for σ = Ω(1). The separator set S is the equator of M2 in the plane x1 = 0.\nWe now provide some intuition for why RSL algorithms will require n ≥ 1/(ǫτ)Ω(d) to succeed on this instance. We focus our discussion on RSL algorithms with k > 2, i.e. on algorithms that do in fact use a cleaning step, ignoring the single linkage algorithm which is known to be inconsistent for full dimensional densities.\nIntuitively, because of the curvature of the described instance, the mass of a sufficiently large Euclidean ball in the separator set is larger than the mass of a corresponding ball in the true clusters. This means that any algorithm that uses large balls cannot reliably clean the sample and this restricts the size of the balls that can be used. Now if points in the regions of high density are to survive then there must be k sample points in the small ball around any point in the true clusters and this gives us a lower bound on the necessary sample size.\nThe RSL algorithms work by counting the number of sample points inside the balls B(x, r) centered at the sample points x, for some radius r. In order for the algorithm to reliably resolve (σ, ǫ) clusters, it should distinguish points in the separator set S ⊂ M2 from those in the level λ clusters M1∪M3. A necessary condition for this is that the mass of a ball B(x, r) for x ∈ Sσ−r should be strictly smaller than the mass inside B(y, r) for y ∈ M1 ∪M3. In Section 9.4, we show that this condition restricts the radius r to be at most O(τ √ ǫ/d).\nNow, consider any sample point x0 in M1 ∪M3 (such an x exists with high probability). Since x0 should not be removed during the cleaning step, the ball B(x0, r) must contain some other sample point (indeed, it must contain at least k− 1 more sample points). By a union bound, this happens with probability at most\n(n− 1)vdrdλ ≤ O(d−d/2nτdǫd/2λ).\nIf we want the algorithm to succeed with probability at least 1/2 (say) then\nn ≥ Ω ( dd/2\nτdλǫd/2\n) .\n5. A modified algorithm for the known manifold case. In this section we consider the case when the manifold is known. In particular, we assume that we have an oracle that given as input a point x ∈ M and a number V returns us a radius rx such that vold(BM (x, rx)) = V . We call the ball B(x, rx) the V -ball around x, and the oracle a V -ball oracle.\nGiven access to the V -ball oracle we show that a modified spatially adaptive RSL algorithm achieves the rate\nn ≥ O (\n1\nλvdρdǫ2 log\n1\nλvdρdǫ2\n)\nwhere ρ ..= min { σ 10 , τ 16 }\nIn particular, ρ no longer depends on ǫτ and for the case of τ fixed (ignoring constants depending on d) the algorithm achieves the near minimax optimal rates of [1], in the manifold setting with d replacing D.\nThe modified algorithm is in Figure 2 and it uses two parameters, k and V , to be specified shortly.\nWe begin with a preliminary lemma which is a straightforward consequence of Lemma 8.\nLemma 11. If V = vdr d, then rl ≤ rx ≤ ru, where\nrl := r\n( 1− 6r\nτ\n) and ru := r ( 1 + 6r\nτ\n) .\nTheorem 12. There are universal constants C1 and C2 such that the following holds. For any δ > 0, 0 < ǫ < 1/2, run the algorithm in Figure 2 on a sample X drawn from f , where the parameters are set according to the equations\nR = 4ru = r\n( 1 + 6r\nτ\n) and k = C1 log 2(1/δ)(µ/ǫ2).\nfor r defined by\nvdr dλ =\nk n + C2 log(1/δ) n\n√ kµ.\nThen with probability at least 1−δ, Ĉ is (σ, ǫ) consistent. In particular, the clusters containing A[X] and A′[X], where A and A′ are (σ, ǫ) separated, are internally connected and mutually disconnected in C(r) provided\nλ ≥ 2 vdρd k n .\nProof. The theorem is a straightforward consequence of the following lemma.\nLemma 13 (Separation and Connectedness). For the parameter choices prescribed in the theorem, provided we satisfy the following\n5ru ≤ σ and R ≤ τ/2\nV λ ≥ k n + Cδ n\n√ kµ\nV λ(1− ǫ) ≤ k n − Cδ n\n√ kµ.\nthe following properties hold w.p. at least 1− δ:\n1. All points in Aσ−ru and A ′ σ−ru are kept, and all points in Sσ−ru are removed. 2. The two point sets A[X] and A′[X] are disconnected in the graph Gr,R. 3. A[X] and A′[X] are internally connected.\nProof. The proof is similar to that of Theorem 6 and we only highlight the differences.\n1. The V -ball around any point x in the manifold has volume exactly V by definition, and hence part (1) is true under the good event described in Lemma 7. In particular notice that using V -balls removes the necessity for estimating the ball volumes. 2. We show part (2) by contradiction. Assume that the graph connects a pair of points from A and A′. Then the connection step guarantees that every edge of the path from A to A′ is of Euclidean distance ≤ R ≤ τ/2, and hence geodesic distance ≤ 2R. Therefore, by part (1), there must be an edge of (geodesic) length 2(σ − ru). This gives us a contradiction, provided 2R ≤ 2(σ − ru). 3. For part (3) note that R = 4ru ≥ 4rx, and hence an R/4-ball around any net point in AM,R/4 contains at least one sample point. The rest of the proof is unchanged.\nAs in the proof of Theorem 6, we set the parameters according to k = C2δ (µ/ǫ 2), and\nvdr dλ =\nk n + Cδ n\n√ kµ.\nBy our assumption on ρ and λ, we can see that r ≤ ρ, and that\nru = r\n( 1 + 6r\nτ\n) ≤ ρ ( 1 + 6ρ\nτ\n) ≤ 2ρ.\nNow, setting R = 4ru, we find that the requirements R ≤ τ/2 and R + r ≤ σ are automatically satisfied. Similarly, the final requirement\nvdr dλ(1− ǫ) ≤ k n − Cδ n\n√ kµ\nis also satisfied because of our choices of r and k.\n6. Cluster tree recovery in the presence of noise. So far we have considered the problem of recovering the cluster tree given samples from a density supported on a lower dimensional manifold. In this section we extend these results to the more general situation when we have noisy samples concentrated near a lower dimensional manifold. Indeed it can be argued that the manifold + noise model is a natural and general model for high-dimensional data.\nIn the noisy setting, it is clear that we can infer the cluster tree of the noisy density in a straightforward way. A stronger requirement would be consistency with respect to the underlying latent sample. Following the literature on manifold estimation ([26, 25]) we consider two main noise models. For both of them, we specify a distribution Q for the noisy sample.\n1. Clutter Noise: We observe data Y1, . . . , Yn from the mixture\nQ := (1− π)U + πP\nwhere 0 < π ≤ 1 and U is a uniform distribution on X .\nDenote the samples drawn from P in this mixture\nX = {X1, . . . ,Xm}.\nThe points drawn from U are called background clutter. In this case, we can show:\nTheorem 14. There are universal constants C1 and C2 such that the following holds. For any δ > 0, 0 < ǫ < 1/2, run the algorithm in Figure 1 on a sample {Y1, . . . , Yn}, with parameters\nR := 4ρ k := C1 log 2(1/δ)(µ/ǫ2).\nThen with probability at least 1−δ, Ĉ is (σ, ǫ) consistent. In particular, the clusters containing A[X] and A′[X] are internally connected and mutually disconnected in C(r) for r defined by\nπvdr dλ =\n1\n1− ǫ/6\n( k\nn +\nC2 log(1/δ)\nn\n√ kµ\n)\nprovided\nλ ≥ max { 2\nvdρd k n , 2v d/D D (1− π)d/D vdǫd/Dπ\n( k\nn\n)1−d/D}\nwhere ρ is now slightly modified (in constants), i.e., ρ := min ( σ 7 , ǫτ 72d , τ 24 ) .\n2. Additive Noise: The data are of the form Yi = Xi+ηi where X1, . . . ,Xn ∼ P ,and η1, . . . , ηn are a sample from any bounded noise distribution Φ, with ηi ∈ B(0, θ). Note that Q is the convolution of P and Φ, Q = P ⋆ Φ.\nTheorem 15. There are universal constants C1 and C2 such that the following holds. For any δ > 0, 0 < ǫ < 1/2, run the algorithm in Figure 1 on the sample {Y1, . . . , Yn} with parameters\nR := 5ρ k := C1 log 2(1/δ)(µ/ǫ2).\nThen with probability at least 1− δ, Ĉ is (σ, ǫ) consistent for θ ≤ ρǫ/24d. In particular, the clusters containing {Yi : Xi ∈ A} and {Yi : Xi ∈ A′} are internally connected and mutually disconnected in C(r) for r defined by\nvdr d(1− ǫ/12)(1 − ǫ/6)λ = k\nn + Cδ n\n√ kµ\nif\nλ ≥ 2 vdρd k n\nand θ ≤ ρǫ/24d, where ρ := min (σ 7 , τ 24 , ǫτ 144d ) .\nThe proofs for both Theorems 14 and 15 appear in Section 9.5. Notice that in each case we receive samples from a full D-dimensional distribution but are still able to achieve rates independent of D because these distributions are concentrated around the lower dimensional M . For the clutter noise case we produce a tree that is consistent for samples drawn from P (which are exactly on M), while in the additive noise case we produce a tree on the observed Yis which is (σ, ǫ) consistent for the latent Xis (for θ small enough). It is worth noting that in the case of clutter noise we can still consistently recover the entire cluster tree. Intuitively, this is because the k-NN distances for points on M are much smaller than for clutter points that are far away from M . As a result the clutter noise only affects a vanishingly low level set of the cluster tree. In the case of additive noise with small variance, it is possible to recover well-separated clusters at ambient dimension independent rates. It is also possible to recover the cluster tree in the presence of general additive noise distributions via deconvolution [27, 26] but we do not pursue this approach here.\n7. Kernel Density Estimators. The results of the previous sections have used k-nearest neighbors based density estimators. However, similar (albeit non-algorithmic) results can be obtained for kernel density estimators.\nFor the full dimensional cases we consider the usual kernel density estimators\nf̂h(x) = 1\nnhD\nn∑\ni=1\nK\n( x−Xi\nh\n) .\nFor the manifold case we consider the following estimator (notice that unlike the usual kernel density estimate it does not integrate to 1),\nf̂h(x) = 1\nnhd\nn∑\ni=1\nK\n( x−Xi\nh\n) .\nIn each case, K : RD → R is a kernel. In each case, there is an associated population quantity that will be useful. In the full dimensional case\nfh(x) = 1\nhD EX∼fK\n( x−X\nh\n)\nand in the manifold case\nfh(x) = 1\nhd EX∼fK\n( x−X\nh\n)\nAs before C(f̂h) denotes the cluster tree of the kernel density estimate.\n7.1. Assumptions and preliminaries. We will make one of the following assumptions on the kernel:\nAssumption 1 (Bounded support).\n[1A] For the case of full-dimensional densities we will assume the kernel has bounded support and integrates to 1, i.e.\n{x : K(x) > 0} ⊆ B(0, 1) and ∫\nx∈RD K(‖x‖) = 1\nFollowing [24], we will further assume that the class of functions\nF = { K ( x− ◦ h ) , x ∈ RD, h > 0 }\nsatisfies, for some positive number A and v\nsup P\nN (Fh, L2(P ), ǫ‖F‖L2(P )) ≤ ( A\nǫ\n)v\nwhere N (T, d, ǫ) denotes the ǫ-covering number of the metric space (T, d), F is the envelope function of F and the supremum is taken over the set of all probability measures on RD. A and v are called the VC characteristics of the kernel.\n[1B] For the case of densities supported on lower-dimensional manifolds we will assume a particular form for the kernel\nK(x) = I(x ≤ 1)\nvd\nObserve that this kernel also satisfies the VC assumption above.\nThe first assumption is quite mild and can be further relaxed to include kernels with an appropriate tail decay, albeit at the cost of more complicated proofs. The second assumption allows us to avoid dealing with integrals over the manifold but can also be similarly relaxed.\nAssumption 2 (Bandwidth regularity: BR(m)). For some c > 0,\nhn ց 0, nhmn | log hn| → ∞ | log hn| log log n → ∞ and hmn ≤ chm2n\nWe will first state two preliminary results showing the uniform consistency of the kernel density estimate.\nThe first Lemma appears in a similar form in [14] (Proposition 9) and is a modification of a result of [24] (Corollary 2.2). The proof is omitted.\nLemma 16 (Full dimensional density). Given n samples from a distribution which has a bounded density f with respect to the Lebesgue measure on RD\n1. For n ≥ n0, where n0 is a constant depending only on the VC characteristics of K, ‖K‖∞, ‖K‖2 and fmax, and fixed h ≤ h0 depending only on ‖K‖∞ and fmax there is a constant C depending on K such that\nP ( ‖f̂h − fh‖∞ ≥ C ′ · C √ fmax log(1/h)\nnhD\n) ≤ ( 1\nh\n)C′\nfor any large enough constant C ′ depending on K and fmax of our choice. 2. For any sequence hn ≤ h0 as before, satisfying Assumption 2, BR(D), for all n ≥ n0 as before\nP ( ‖f̂hn − fhn‖∞ ≥ C ′ · C √ fmax log(1/hn)\nnhDn\n) ≤ ( 1\nh\n)C′\nFor the ball kernel of Assumption 1 a similar result holds for densities supported on a lower dimensional manifold.\nLemma 17 (Manifold case). Given n samples from a distribution supported on a smooth Riemannian manifold M with condition number at most 1/τ with bounded density f with respect to the uniform measure on M\n1. For n ≥ n0, where n0 is a constant depending only on the VC characteristics of K, ‖K‖∞, ‖K‖2 and ‖f‖∞, and fixed h ≤ min( τ8 , h0) where h0 depends only on ‖K‖∞ and ‖f‖∞ there is a constant Cδ depending on δ and n0 such that\nP ( ‖f̂h − fh‖∞ ≥ C ′ · C √ fmax log(1/h)\nnhd\n) ≤ ( 1\nh\n)C′\n2. For any sequence hn ≤ min( τ8 , h0) as before, satisfying Assumption 2, BR(d), for all n ≥ n0 as before\nP ( ‖f̂hn − fhn‖∞ ≥ C ′ · C √ fmax log(1/hn)\nnhdn\n) ≤ ( 1\nh\n)C′\nProof. The proof follows along the lines of those in [14, 24]. The main modification to achieve d rates involves a more careful calculation of the variance.\nTo apply Talagrand’s inequality in the proof of [24] we need to bound\nsup g∈F Varfg\nF is the set of kernel functions with various bandwidths, and centers anywhere on M .\nLet us show how to bound supg∈Fh Varfg for a single bandwidth h.\nVarX∼p\n( K ( x−X\nh\n)) = EX [ K ( x−X\nh\n) − EXK ( x−X\nh\n)]2\n≤ [ EXK 2 ( x−X\nh\n)]\n=\n∫ X∈M K2 ( x−X h ) f(X)dX\n≤ ‖K‖2∞ ∫ I(X ∈ B(x, h))f(X)dX\n≤ hdCd‖K‖2∞‖f‖∞ The last step follows if h ≤ τ8 by the ball volume Lemma 8. Notice that the variance does not depend on x and so the bound holds uniformly over all x on M .\nReplacing this bound on the variance in the proof of [24] we obtain the desired result.\n7.2. Rates of convergence for the cluster tree. Our first result mirrors the main result of [1].\nTheorem 18 (Full dimensional cluster tree). There is a constant Cδ depending on the VC characteristics of the kernel, ‖K‖∞, ‖K‖2, ‖f‖∞ and δ such that the following holds with probability at least 1− δ, C(p̂σ) is (σ, ǫ) consistent for any pair of clusters A, A′ at level at least λ for\nn ≥ Cδ σDλ2ǫ2 log\n( 1\nσ\n)\nNotice, in particular that while for the k-nearest neighbor based algorithm the choice of k depends on ǫ for the kernel density estimate the optimal choice of bandwidth depends on σ. Also notice unlike the result of [1] this result requires the density to be uniformly upper bounded.\nProof. To prove this theorem it suffices to show that the regions A and A′ are internally connected and mutually separated.\nLet us first show that σ-clusters A and A′ (for any λ, ǫ > 0) are connected and separated in C(fσ). Consider any point x ∈ A ∪A′,\nfσ(x) =\n∫\ny∈B(x,σ) K ( y − x h ) f(y)dy ≥ λ ∫ y∈B(x,σ) K ( y − x h ) dy ≥ λ\nSimilarly, we can see that for any point in the separator S, fσ(x) < λ(1−ǫ). In particular, σ-clusters A and A′ are distinguished in C(fσ) at level λ as desired.\nNow, we use Lemma 16. Notice for a constant Cδ\nn ≥ Cδ σDλ2ǫ2 log\n( 1\nσ\n)\nwe have\n‖f̂σ − fσ‖∞ ≤ λǫ\n2\nwith probability 1− δ. Let E1 denote the event {‖f̂σ − fσ‖∞ ≤ λǫ2 }.\nNow, let us consider the cluster tree of f̂σ at level λ− λǫ2 . On E1, for any point x ∈ A∪A′ we know fσ ≥ λ and thus f̂σ ≥ λ− λǫ2 . Similarly for x ∈ S we have f̂σ < λ − λǫ2 . These together show that on E1 A and A′ are distinguished in C(f̂σ) at level λ− λǫ2 . This establishes the theorem.\nTo establish Hartigan consistency we select a schedule hn satisfying Assumption 2. Under mild conditions connected components of any level set at λ, are (σ, ǫ) separated for some σ, ǫ > 0 and are distinguished for n large enough.\nWe can similarly give a manifold version of this result. Define\nρ = min ( σ, τ\n8 , ǫτ 72d\n)\nTheorem 19 (Cluster tree on manifolds). There is a constant Cδ depending on the VC characteristics of the kernel, ‖K‖∞, ‖K‖2, ‖f‖∞ and δ such that the following holds with probability at least 1− δ, for all ǫ ≤ 1/2 C(p̂ρ) is (σ, ǫ) consistent for any pair of clusters A, A′ at level at least λ for\nn ≥ Cδ ρDλ2ǫ2 log\n( 1\nρ\n)\nProof. Let us again consider fρ. For any point x ∈ A ∪A′,\nfρ(x) = 1\nhd EX∼fK\n( x−X\nh\n) = 1\nvdρd\n∫\nX∈BM (x,h) dX ≥ λ\n( 1− ǫ\n6\n)\nwhere the second equality follows from the assumed form of the kernel, and the inequality follows from Lemma 8 under the assumption on ρ. Similarly, for any point in S we have\nfρ(x) < λ (1− ǫ) ( 1 + ǫ\n6\n)\nThe gap between these is at least λǫ/2, and hence A and ′ are distinguished in fρ at level λ(1−ǫ/6).\nThe proof that these clusters are distinguished in f̂ρ follows from an identical argument to the one in the proof of Theorem 18, replacing the use of Lemma 16 with Lemma 17.\n8. Simulations. Figure 3 depicts the results of simulations we performed to test our main theoretical predictions. For Figure 3(B) we sample data from a mixture distribution on a unit d-sphere. The mixture has 10 salient clusters (with a total mixture weight of 0.7) mixed with uniform samples on the sphere with mixture weight 0.3. Finally, we mix samples from this density withD-dimensional clutter noise with π = 0.8. A sample is shown in Figure 3(A) for d = 2,D = 3 and n = 1000. For Figures 3(C)-(H) we simulate data from the lower bound instance described in Section 4.\nIn Figure 3(B), we plot the probability of successfully recovering the 10 clusters in the cluster tree as a function of sample size. The figure confirms that the sample size is independent of the ambient dimension D but (typically) gets worse with the manifold dimension d. In particular, the figure shows that for D = {20, 40, 60, 80, 100} (in the same color) sample complexities are nearly unchanged. Figures 3(C)-(H), shows the effect on sample size of (ǫ, d) for the lower bound instance. Notice, that for a fixed ǫ and n the probability of success decays rapidly with increasing d and that for a fixed d and n the probability of success grows with ǫ, in agreement with our 1/ǫΩ(d) prediction and in contrast to the 1/ǫ2 scaling predicted by [1] for recovering a full-dimensional cluster tree.\n9. Additional proofs. In this section we first prove some technical lemmas before giving full proofs of various claims made in the paper.\n9.1. Volume estimates for small balls on manifolds.\nTheorem 20. If\nr ≤ ǫτ 12d\nfor 0 ≤ ǫ < 1 then vdr d (1− ǫ) ≤ vol(S) ≤ vdrd (1 + ǫ)\nProof. The lower bound follows from [19] (Lemma 5.3) who show that\nLemma 21. For r < τ2\nvol(S) ≥ ( 1− r 2\n4τ2\n)d/2 vdr d\nThe upper bound follows from [23] who shows that\nLemma 22. For r < τ2\nvol(S) ≤ vd ( τ\nτ − 2α\n)d αd\nwhere\nα = τ − τ √\n1− 2r τ\nTo produce the result of the theorem we will need some careful manipulation of these two lemmas. In particular, we need the following estimates\nLemma 23. f(x) = (1− x)1/2 ≥ 1− x\n2 − x2\nif 0 ≤ x ≤ 12 . f(x) = (1 + x)n ≤ 1 + 2nx\nif 0 ≤ x ≤ 12n . f(x) = (1− x)−1 ≤ 1 + 2x\nif 0 ≤ x ≤ 1/2 f(x) = (1− x)n ≥ 1− 2nx\nif 0 ≤ x ≤ 12n\nThe proof of this lemma is straightforward based on approximations via Taylor’s series and we omit them.\nUsing Lemma 23 we have\nα ≤ r ( 1 + 4r\nτ\n)\nif r ≤ τ4 . Now, using this also notice that\nτ τ − 2α ≤ 1\n1− 2rτ ( 1 + 4rτ\n) ≤ 1 + 4r τ\n( 1 + 4r\nτ\n)\nwhere the second inequality follows from Lemma 23 if r ≤ τ/8.\nCombining these we have the following:\nFor all r ≤ τ8 vdr d ( 1− r 2\n4τ2\n)d/2 ≤ vol(S) ≤ vdrd ( 1 + 6r\nτ\n)d\nThe final result now follows another application of Lemma 23 on either side of this inequality.\n9.2. Bound on covering number. We need the following bound on the covering number of a manifold. See [19] (p. 16) for a proof.\nLemma 24. For s ≤ 2τ , the s-covering number of M is at most\nvold(M)\ncosd(arcsin(s/4τ))vd(s/2)d ≤ O\n( vold(M)c d\nvdsd\n)\nfor an absolute constant c. In particular, if vold(M) is bounded above by a constant, the s-covering number of M is at most O(cd/(vds d)).\nProof. We prove only the second claim. For s ≤ 2τ , we have arcsin(s/4τ) ≤ π/6, and hence cos(arcsin(s/4τ)) ≥ √ 3/2. Plugging this in the bound, we get\n|N | ≤ vold(M)(2/ √ 3)d\nvd(s/2)d ,\nwhich gives the claim with c = 4/ √ 3.\n9.3. Uniform convergence. In this subsection, we prove uniform convergence for balls centered on sample and net points (Lemma 7). Consider the family of balls centered at a fixed point z, Bz := { B(z, s) : s ≥ 0 } . This collection has VC dimension 1. Thus with probability 1 − δ′, it holds that for every B ∈ Bz, we have\nmax {P (B)− Pn(B)√\nP (B) , P (B)− Pn(B)√\nPn(B)\n} ≤ 2 √ log(2n) + log(4/δ′)\nn ,\nwhere P (B) is the true mass of B, and Pn(B) = |X ∩ B|/n is its empirical measure. By a union bound over all z ∈ N , setting δ′ := δ/(2|N |), the following holds uniformly for every z ∈ N and every B ∈ Bz with probability 1− δ/2:\nmax {P (B)− Pn(B)√\nP (B) , P (B)− Pn(B)√\nPn(B)\n} ≤ 2 √\nlog(2n) + log(8|N |/δ) n .\nTo provide a similar uniform convergence result for balls centered at a sample point Xi, we consider the (n−1)-subsampleXn−1i ofX obtained by deletingXi from the sample. Let Pn−1i be the empirical probability measure of this subsample:\nPn−1(B) := 1 n− 1 ∑\nj 6=i\nI[Xi ∈ B].\nIt is easy to check that Pn−1 is uniformly close to Pn. In particular, for every set B containing Xi, we have\n(2) Pn−1(B) ≤ Pn(B) ≤ Pn−1(B) + 1\nn .\nNow, with probability at least 1− δ/(2n), for any ball B centered at Xi,\nP (B)− Pn−1(B) ≤ 2 √\nlog(2n− 2) + log 8n/δ n− 1 · √ P (B),\nPn−1(B)− P (B) ≤ 2 √\nlog(2n− 2) + log 8n/δ n− 1 · √ Pn−1(B).\nUsing (2), we get\nP (B)− Pn(B) ≤ 2 √\nlog(2n− 2) + log 8n/δ n− 1 · √ P (B),\nPn(B)− P (B) ≤ 2 √\nlog(2n− 2) + log 8n/δ n− 1 · √ Pn(B) + 1 n .\nBy a union bound over all Xi ∈ X, we get the claimed inequalities for all sample points with probability 1− δ/2.\nPutting together our bounds for balls around sample and net points, with probability at least 1−δ, it holds that for all B ∈ Bn,N , we have\nP (B)− Pn(B) ≤ O (√µ+ log(1/δ)\nn\n) · √ P (B),\nPn(B)− P (B) ≤ O (√µ+ log(1/δ)\nn\n) · √ Pn(B) + 1\nn .\nfor µ = 1 + log n+ log |N | = O(d) + log n+ d log(1/s) (using Lemma 24). The lemma now follows using simple manipulations of these inequalities (see [1] for details).\n9.4. Sketch of the lower bound instance. The following lemma gives an estimate of the volume of the intersection of a small ball with a sphere.\nLemma 25 (Volume of a spherical cap). Suppose Sd is a d-dimensional sphere of radius τ (embedded in Rd+1), and let x ∈ Sd. Then, for small enough r, it holds that\nvold(B(x, r) ∩ Sd) = vdrd ( 1− cd r2\nτ2 +Od ( r4 τ4\n))\nwhere cd := d(d−2) 8(d+2) . Note that c1 < 0, c2 = 0, and cd > 0 for all d ≥ 3.\nIn this section, we prove Lemma 25. The height h of the cap can be easily checked to be equal to h = r2/2τ . Now, the volume of the cap is given by the formula\nvcap = π(d+1)/2τd\nΓ((d+ 1)/2) Iα(d/2, 1/2)\nwhere the parameter α is defined by\nα := 2τh− h2\nτ =\nr2\nτ2 (1− r\n2\n4τ2 ).\nFurther Iα(·, ·) represents the incomplete beta function:\nIα(z, w) = B(α; z, w)\nB(z, w)\n=\n∫ α 0 u\nz−1(1− u)w−1du B(z, w)\n= Γ(z + w)\nΓ(z)Γ(w)\n∫ α\n0 uz−1(1− u)w−1du\nThus,\nvcap = π(d+1)/2τd Γ((d+ 1)/2) · Γ((d+ 1)/2)) Γ(d/2)Γ(1/2)\n· ∫ α\n0 ud/2−1(1− u)−1/2du\n= πd/2τd\nΓ(d/2)\n∫ α\n0 ud/2−1(1− u)−1/2du\n= dvdτ\nd\n2\n∫ α\n0 ud/2−1(1− u)−1/2du.\nSince α → 0 as r → 0, we can approximate the integral by expanding the integrand as a Taylor series around 0:\nvcap = dvdτ\nd\n2\n∫ α\n0 ud/2−1\n( 1 + u/2 +O(u2) ) du\n= dvdτ\nd\n2\n( αd/2\nd/2 +\n1\n2\nαd/2+1\nd/2 + 1 +O(αd/2+2)\n)\n= vdτ dαd/2 ( 1 +\nd\n2(d+ 2) α+O(α2))\n)\nFinally, using α := r 2 τ2 (1− r2 τ2 ), we get\nvcap = vdr d ( 1− r 2\n4τ2\n)d/2 ( 1 +\ndr2\n2(d+ 2)τ2 +O ( r4 τ4\n))\n= vdr d · ( 1− dr 2\n8τ2 +\ndr2\n2(d+ 2)τ2 +Od ( r4 τ4 )) ,\nwhich simplifies to the claimed estimate. We now show that it must be the case that r ≤ O(τ √\nǫ/d). We argued that for the algorithm to reliably resolve the (σ, ǫ) separated clusters M1 and M3, an r-ball around a sample point in Sσ−r must have mass appreciably smaller than those around points in M1. By the previous lemma, the two kinds of balls have volumes\nvdr d ( 1− cd r2\n12 +Od (r4 14 )) = vdr d ( 1− cdr2 +Od(r4) )\nand\nvdr d ( 1− cd r2\n4τ2 +Od ( r4 16τ4 )) = vdr d ( 1− cd r2 4τ2 +Od ( r4 τ4 )) .\nThus we must have\nvdr dvdr d ( 1− cdr2 +Od(r4) ) · λ(1− ǫ) ≤ vdrd ( 1− cd r2\n4τ2 +Od ( r4 τ4 )) · λ.\nThis implies that r2 ≤ O (\n4τ2ǫ (1−4τ2)cd\n) . Hence if τ ≤ 1/4, we have r ≤ τ √ ǫ/cd. Plugging in cd = Ω(d)\ngives us the claim.\n9.5. Clustering with noisy samples.\n9.6. Proof of Theorem 14. As before we begin by showing separation followed by a proof of connectivity. Recall that ρ := min ( σ 7 , ǫτ 72d , τ 24 ) .\nLemma 26 (Separation). Assume that we pick k, r and R to satisfy the conditions:\nr ≤ ρ, R = 4ρ\nπ · vdrd(1− ǫ/6) · λ ≥ k\nn + Cδ n\n√ kµ,\nπ · vdrd(1 + ǫ/6) · λ(1− ǫ) + (1− π) · vDrD ≤ k n − Cδ n\n√ kµ.\nThen with probability 1− δ, it holds that:\n1. All points in AM,σ−r and A ′ M,σ−r are kept, and all points in X \\Mr and Sσ−r are removed.\nHere, Mr is the tubular region around M of width r. 2. The two point sets A[X] and A′[X] are disconnected in the graph Gr,R.\nProof. The proof of the first claim is similar to the noiseless setting, except that the probability mass inside a ball now has contributions from both the manifold and the background clutter. For x ∈ Sσ−r, the probability mass of the ball B(x, r) underQ is at most πvdr\nd(1+ǫ/6)·λ(1−ǫ)+(1−π)vDrD, which is at most kn − Cδ n √ kµ. Thus x is removed during the cleaning step. Similarly, if x /∈ Mr, the ball B(x, r) does not intersect the manifold, and hence its mass is at most (1− π)vDrD. Hence all points outside Mr are removed. Finally, if x ∈ (AM,σ−r ∪ A′M,σ−r) ∩ X, then the mass of the ball BM (x, r) is at least vdr\nd(1 − ǫ/6)λ (ignoring the contribution of the noise). This is at least k n + Cδ n √ kµ, and hence x is kept.\nTo prove the second claim, suppose that sets A∩X and A′ ∩X are connected in Gr,R. Then there exists a sequence of sample points y0, y1, . . . , yt such that y0 ∈ A, yt ∈ A′ and d(yi−1, yi) ≤ R for all 1 ≤ i ≤ t. Let xi be the projection of yi on M , i.e., xi is the point of M closest to yi. We have already showed that each yi lies inside the tube Mr, so d(xi, yi) ≤ r, and hence by triangle inequality, we have d(xi−1, xi) ≤ R+2r ≤ τ/4. Hence, the geodesic distance between xi−1 and xi is < 2(R+ 2r). Now, by an argument analogous to the noiseless setting, there exists a pair (xi−1, xi) which are at a (geodesic) distance at least 2(σ − r). This is a contradiction since our parameter setting implies that 2(σ − r) ≥ 2(R + 2r).\nLemma 27 (Connectedness). Assume that the parameters k, r and R satisfy the separation conditions (in Lemma 26). Then, with probability at least 1− δ, A ∩Y is connected in Gr,R.\nProof. The proof of this lemma is identical to Lemma 10 and is omitted.\nWe now show how to pick the parameters to satisfy the conditions in Lemma 26. Set k := 144C2δ (µ/ǫ 2), and define r by\nπvdr d(1− ǫ/6) · λ = k\nn + Cδ n\n√ kµ.\nIt is easy to check that this setting satisfies all our requirements, provided that the term (1−π)vDrD arising from the clutter noise satisfies the additional constraint\n(1− π)vDrD ≤ (ǫ/2) × πvdrdλ.\nThe definition of r implies that r is upper bounded by (\n2k nλπvd\n)1/d . Thus it suffices to ensure that\n(1− π)vD ( 2k\nnλπvd\n)D/d ≤ (ǫ/2) · 2k\nn =\nkǫ n .\nThis is equivalent to the condition\nλ ≥ 2v d/D D vdǫd/D · (1− π) d/D π · ( k n )1−d/D ,\nwhich is assumed by Theorem 14.\n9.7. Proof of Theorem 15. Let P be a distribution on a manifold M with density f . Let X = (X1, . . . ,Xn) be the latent sample from P , and let Y = (Y1, . . . , Yn) be the observed sample. The only fact that we use about the observed sample is that it is close to the corresponding latent sample point: d(Yi,Xi) ≤ θ, where θ is the noise radius. We show that we can adapt the RSL algorithm to resolve (σ, ǫ) separated clusters (A,A′), provided that θ is sufficiently small compared to both σ and ǫ.\nAgain, we will pick values for k, r,R based on a parameter ρ, defined as ρ := min(σ7 , τ 24 , ǫτ 144d ).\nLemma 28 (Separation). Suppose k, r,R are chosen to satisfy\nθ ≤ r/2 r ≤ ρ R := 5ρ,\nvd(r − 2θ)d(1− ǫ/6) · λ ≥ k\nn + Cδ n\n√ kµ,\nvd(r + 2θ) d(1 + ǫ/6) · λ(1− ǫ) ≤ k n − Cδ n\n√ kµ,\nThen, with probability 1− δ, the following holds uniformly over all (σ, ǫ) separated clusters (A,A′):\n1. If a latent sample point Xi ∈ AM,σ−r+2θ ∪A′M,σ−r+2θ, then the corresponding sample point Yi is kept during the cleaning step. If Xi ∈ SM,σ−r−2θ, then Yi is removed.\n2. The sets {Yi : Xi ∈ A} and {Yi : Xi ∈ A′} are disconnected in the graph Gr,R.\nProof. To prove the first claim, supposeXi ∈ Aσ−r+2θ∪A′σ−r+2θ. Consider the ball BM (Xi, r−2θ). It is completely inside AM,σ ∪ A′M,σ, hence the density f inside it is at least λ. Moreover, if Xj is in BM (Xi, r − 2θ), then by triangle inequality, we have\nd(Yj , Yi) ≤ d(Xj , Yj) + d(Xj ,Xi) + d(Yi,Xi) ≤ r.\nHence the ball B(Xi, r) contains at least k sample points, provided BM (Xi, r−2θ) contains at least k points from X. Finally, the true mass of the set BM (Xi, r − 2θ) is at least\nvd(r − 2θ)d(1− ǫ/6) · λ ≥ k\nn + Cδ n\n√ kµ.\nHence it contains at least k latent sample points, and we are done.\nSimilarly, suppose Xi ∈ Sσ−r−2θ, and consider the ball BM (Xi, r + 2θ). It is completely contained inside SM,σ and hence the density inside the ball is at most λ(1− ǫ). Moreover, if Xj is outside the set, then d(Yj , Yi) ≥ d(Xj ,Xj)− d(Xi, Yi)− d(Xj , Yj) > r. Hence the ball B(Yi, r) contains fewer than k sample points, provided BM (Xi, r+2θ) contains fewer than k points from X. The true mass of the ball BM (Xi, r + 2θ) is at most\nvd(r + 2θ) d(1 + ǫ/6) · λ(1− ǫ) ≤ k n − Cδ n\n√ kµ.\nHence the ball contains fewer than k latent sample points, and we are done.\nWe now prove that the graph Gr,R is disconnected. Suppose not. Then there must exist a sequence of latent sample points x0, x1, . . . , xt ∈ Y and a corresponding sequence of noisy sample points y0, . . . , yt ∈ X such that x0 ∈ A, xt ∈ A′, and d(yi−1, yi) ≤ R. Clearly d(xi−1, xi) ≤ R + 2θ ≤ τ/4. Thus the geodesic distance between xi−1 and xi is less than 2(R + 2θ). However, by the (σ, ǫ) separation condition, we must have a successive pair (xi−1, xi) whose geodesic distance is at least 2(σ−r). This is a contradiction since we have set our parameters such that 2(σ−r) ≥ 2(R+2θ).\nLemma 29 (Connectedness). Assume that the conditions of Lemma 28 are satisfied. Then, with probability at least 1 − δ, the following holds uniformly over all A: if infx∈AM,σ f(x) ≥ λ, then {Yi : Xi ∈ A} is connected in Gr,R.\nProof. The proof is similar to that of Lemma 10, so we indicate only the necessary modifications, omitting the details. We now use a net of radius (R − 2θ)/4, and the condition that R ≥ 4r is replaced by R − 2θ ≥ 4r. Finally, the xi’s defined in the proof are latent sample points, whereas the algorithm observes an arbitrary point yi in a θ-ball around the xi. Thus, the distance between yi−1 and yi is at most\n4 · R− 2θ 4 + d(yi, xi) + d(yi−1, xi−1) ≤ R.\nIn order to satisfy the conditions stated in Lemma 28, we need the assumption that θ is small compared to r. More precisely, we will assume that θ ≤ rǫ/24d. Under this assumption, we can satisfy the above conditions by ensuring that\nvdr d(1− ǫ/12)(1 − ǫ/6) · λ ≥ k\nn + Cδ n\n√ kµ,\nvdr d(1 + ǫ/6)(1 + ǫ/6) · λ(1− ǫ) ≤ k n − Cδ n\n√ kµ\nAs before, we can satisfy these equations by setting k := O(C2δµ/ǫ 2), and r according to\nvdr d(1− ǫ/12)(1 − ǫ/6) · λ = k\nn + Cδ n\n√ kµ.\n9.8. Connection radius for polynomially bounded densities. In this section, we prove that in our algorithm (Figure 1), we can pick the connection radius R to be R := 4r, independent of the other parameters, provided that the density level satisfies λ ≤ nA for some absolute constant A. (Our original setting picked R = 4ρ and r ≤ ρ.)\nMore precisely, we will argue that the parameter µ in the algorithm can be safely replaced by a related parameter µ̃ := 2A log n without affecting the performance of the algorithm. Pick k = O(C2δ µ̃/ǫ 2), and set r,R by the equations\nvdr dλ =\n1\n1− ǫ/6\n( k\nn +\nC2 log(1/δ)\nn\n√ kµ̃ ) ,\nR = 4r.\nThe crucial ingredient in the analysis of our algorithm is the uniform convergence property of balls centered at the sample points and net points (Lemma 7), so we first verify that this statement remains true. Note that by our choice of r, we have\nvdr dλ ≥ k n ≥ 1 n ,\nso that 1/rd ≤ vdnλ ≤ vdnA+1 ≤ nA+1 (since vd < 1 for sufficiently large d). As before, we consider a net N of radius R/4 (i.e., r); by Lemma 24, size of this net is at most cd/rd for some absolute constant c > 0. Thus by Lemma 7, we have the uniform convergence property, provided the parameter µ is replaced by\nlog n+ log |N | = log n+ log(1/rd) +O(1) = (A+ 2) log n+O(1).\nNotice that µ̃ is picked to be a safe upper bound on this quantity, hence the lemma holds when µ is replaced by µ̃.\nFinally, it is easy to check that our choice of parameters satisfies all the conditions given in the separation lemma. Hence the separation and connectedness guarantees (Lemmas 9 and 10), together with their proofs, remain unaffected.\n10. Discussion. In this paper we have shown that simple non-parametric estimators based on k nearest neighbors and kernel density estimates are manifold adaptive estimators of the cluster tree. We have also introduced the problem of cluster tree recovery in the presence of noise. Many open questions remain, particularly regarding the minimax optimal rates of convergence and rates of convergence in the tubular noise case which we hope to address in future work.\nOne of the main advantages of the k nearest neighbors based estimator is its easy computability. In the case of known manifolds we have shown a more general spatially adaptive algorithm achieves better rates and in current work we are trying to understand the extent to which spatially adaptive estimators can help when the manifold is unknown.\nFinally, simple modifications of these simple non-parametric estimators can also be used as estimators of various geometric properties of the level sets of the density. We are currently working on these extensions."
    } ],
    "references" : [ {
      "title" : "Rates of convergence for the cluster",
      "author" : [ "Kamalika Chaudhuri", "Sanjoy Dasgupta" ],
      "venue" : "tree. NIPS,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2010
    }, {
      "title" : "Consistency of single linkage for high-density clusters",
      "author" : [ "J.A. Hartigan" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 1981
    }, {
      "title" : "Mode analysis: a generalization of nearest neighbor which reduces chaining",
      "author" : [ "D. Wishart" ],
      "venue" : "In Proceedings of the Colloquium on Numerical Taxonomy held in the University of St. Andrews,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 1969
    }, {
      "title" : "A generalized single linkage method for estimating the cluster tree of a density",
      "author" : [ "W. Stuetzle", "Nugent. R" ],
      "venue" : "Journal of Computational and Graphical Statistics,",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2010
    }, {
      "title" : "Estimating the cluster tree of a density by analyzing the minimal spanning tree of a sample",
      "author" : [ "Werner Stuetzle" ],
      "venue" : "J. Classification,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2003
    }, {
      "title" : "Measuring mass concentrations and estimating density contour clusters: an excess mass approach",
      "author" : [ "W. Polonik" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 1995
    }, {
      "title" : "On nonparametric estimation of density level",
      "author" : [ "A B Tsybakov" ],
      "venue" : "sets. Ann. Statist.,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 1997
    }, {
      "title" : "Granulometric smoothing",
      "author" : [ "G. Walther" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 1997
    }, {
      "title" : "A plug-in approach to support estimation",
      "author" : [ "Antonio Cuevas", "Ricardo Fraiman" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 1997
    }, {
      "title" : "Rodŕıguez-Casal. Plug-in estimation of general level",
      "author" : [ "Antonio Cuevas", "Wenceslao González-Manteiga", "Alberto" ],
      "venue" : "sets. Aust. N. Z. J. Stat.,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2006
    }, {
      "title" : "Fast rates for plug-in estimators of density level",
      "author" : [ "P. Rigollet", "R. Vert" ],
      "venue" : "sets. Bernoulli,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2009
    }, {
      "title" : "Optimal construction of k-nearest-neighbor graphs for identifying noisy clusters",
      "author" : [ "Markus Maier", "Matthias Hein", "Ulrike von Luxburg" ],
      "venue" : "Theor. Comput. Sci.,",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2009
    }, {
      "title" : "Adaptive {H}ausdorff estimation of density level",
      "author" : [ "Aarti Singh", "Clayton Scott", "Robert Nowak" ],
      "venue" : "sets. Ann. Statist.,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2009
    }, {
      "title" : "Generalized density clustering",
      "author" : [ "Alessandro Rinaldo", "Larry Wasserman" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2010
    }, {
      "title" : "Stability of density-based clustering",
      "author" : [ "Alessandro Rinaldo", "Aarti Singh", "Rebecca Nugent", "Larry Wasserman" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2012
    }, {
      "title" : "Pruning nearest neighbor cluster trees",
      "author" : [ "Samory Kpotufe", "Ulrike von Luxburg" ],
      "venue" : "In ICML,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2011
    }, {
      "title" : "Adaptive density level set clustering",
      "author" : [ "Ingo Steinwart" ],
      "venue" : "Journal of Machine Learning Research - Proceedings Track,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2011
    }, {
      "title" : "Consistency and rates for clustering with dbscan",
      "author" : [ "Bharath K. Sriperumbudur", "Ingo Steinwart" ],
      "venue" : "Journal of Machine Learning Research - Proceedings Track,",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2012
    }, {
      "title" : "Finding the homology of submanifolds with high confidence from random",
      "author" : [ "P Niyogi", "S Smale", "S Weinberger" ],
      "venue" : "Discrete and Computational Geometry,",
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 2008
    }, {
      "title" : "Random projection trees and low dimensional manifolds",
      "author" : [ "Sanjoy Dasgupta", "Yoav Freund" ],
      "venue" : "In STOC,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 2008
    }, {
      "title" : "A tree-based regressor that adapts to intrinsic dimension",
      "author" : [ "Samory Kpotufe", "Sanjoy Dasgupta" ],
      "venue" : "J. Comput. Syst. Sci.,",
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2012
    }, {
      "title" : "Local polynomial regression on unknown manifolds",
      "author" : [ "Peter Bickel", "Bo Li" ],
      "venue" : "In Technical report, Department of Statistics, UC Berkeley,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 2006
    }, {
      "title" : "An upper bound for the volume of geodesic balls in submanifolds of euclidean spaces",
      "author" : [ "Frederic Chazal" ],
      "venue" : "Personal Communication, available at http://geometrica.saclay.inria.fr/team/Fred.Chazal/BallVolumeJan2013.pdf,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2013
    }, {
      "title" : "Rates of strong uniform consistency for multivariate kernel density estimators",
      "author" : [ "Evarist Giné", "Armelle Guillou" ],
      "venue" : "In Annales de l’Institut Henri Poincare (B) Probability and Statistics,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2002
    }, {
      "title" : "Minimax manifold estimation",
      "author" : [ "Christopher R. Genovese", "Marco Perone-Pacifico", "Isabella Verdinelli", "Larry Wasserman" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 2012
    }, {
      "title" : "Minimax rates for homology inference",
      "author" : [ "Sivaraman Balakrishnan", "Alessandro Rinaldo", "Don Sheehy", "Aarti Singh", "Larry Wasserman" ],
      "venue" : null,
      "citeRegEx" : "26",
      "shortCiteRegEx" : "26",
      "year" : 2012
    }, {
      "title" : "Empirical geometry of multivariate data: a deconvolution approach",
      "author" : [ "V.I. Koltchinskii" ],
      "venue" : "Ann. Statist.,",
      "citeRegEx" : "27",
      "shortCiteRegEx" : "27",
      "year" : 2000
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "We analyze a modified version of a k-nearest neighbor based algorithm recently proposed by Chaudhuri and Dasgupta [1].",
      "startOffset" : 114,
      "endOffset" : 117
    }, {
      "referenceID" : 1,
      "context" : "Hartigan [2] showed that the popular single-linkage algorithm is not consistent for a sample from R D, with D > 1.",
      "startOffset" : 9,
      "endOffset" : 12
    }, {
      "referenceID" : 0,
      "context" : "Recently, Chaudhuri and Dasgupta [1] analyzed an algorithm which is both simple and consistent.",
      "startOffset" : 33,
      "endOffset" : 36
    }, {
      "referenceID" : 0,
      "context" : "We show that the simple algorithm studied in [1] is consistent and has fast rates of convergence for data on or near a low dimensional manifold M .",
      "startOffset" : 45,
      "endOffset" : 48
    }, {
      "referenceID" : 0,
      "context" : "We show that in the known manifold case a modified spatially adaptive algorithm achieves better rates, similar to the near minimax-optimal rates of [1].",
      "startOffset" : 148,
      "endOffset" : 151
    }, {
      "referenceID" : 2,
      "context" : "The idea of using probability density functions for clustering dates back to Wishart [3].",
      "startOffset" : 85,
      "endOffset" : 88
    }, {
      "referenceID" : 1,
      "context" : "[2] expanded on this idea and formalized the notions of high-density clustering, of the cluster tree and of consistency and fractional consistency of clustering algorithms.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 1,
      "context" : "In particular, [2] showed that single linkage clustering is consistent when D = 1 but is only fractionally consistent when D > 1.",
      "startOffset" : 15,
      "endOffset" : 18
    }, {
      "referenceID" : 3,
      "context" : "[4] and [5] have also proposed procedures for recovering the cluster tree.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 4,
      "context" : "[4] and [5] have also proposed procedures for recovering the cluster tree.",
      "startOffset" : 8,
      "endOffset" : 11
    }, {
      "referenceID" : 0,
      "context" : "None of these procedures however, come with the theoretical guarantees given by [1], which demonstrated that a generalization of Wishart’s algorithm allows one to estimate parts of the cluster tree for distributions with full-dimensional support near-optimally under rather mild assumptions.",
      "startOffset" : 80,
      "endOffset" : 83
    }, {
      "referenceID" : 5,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 6,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 7,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 8,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 9,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 10,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 11,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 12,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 13,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 14,
      "context" : ", [6, 7, 8, 9, 10, 11, 12, 13, 14, 15], and references therein.",
      "startOffset" : 2,
      "endOffset" : 38
    }, {
      "referenceID" : 15,
      "context" : "Estimating the cluster tree has more recently been considered in [16] which also gives a simple pruning procedure for removing spurious clusters.",
      "startOffset" : 65,
      "endOffset" : 69
    }, {
      "referenceID" : 16,
      "context" : "[17, 18] propose procedures for determining recursively the lowest split in the cluster tree and give conditions for asymptotic consistency with minimal assumptions on the density.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 17,
      "context" : "[17, 18] propose procedures for determining recursively the lowest split in the cluster tree and give conditions for asymptotic consistency with minimal assumptions on the density.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 18,
      "context" : "The condition number controls the curvature of M and prevents it from being too close to being self-intersecting (see [19] for a detailed treatment).",
      "startOffset" : 118,
      "endOffset" : 122
    }, {
      "referenceID" : 0,
      "context" : "To give finite sample results, following [1], we define the notion of salient clusters.",
      "startOffset" : 41,
      "endOffset" : 44
    }, {
      "referenceID" : 0,
      "context" : "Our definitions are slight modifications of those in [1] to take into account the manifold assumption.",
      "startOffset" : 53,
      "endOffset" : 56
    }, {
      "referenceID" : 0,
      "context" : "Chaudhuri and Dasgupta [1] analyze a robust single linkage (RSL) algorithm (in Figure 1).",
      "startOffset" : 23,
      "endOffset" : 26
    }, {
      "referenceID" : 0,
      "context" : "[1] prove the following theorem, establishing finite sample bounds for a particular RSL algorithm.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 0,
      "context" : "Ignoring constants that depend on d the main difference between this result and the result of [1] (Theorem 5) is that our results only depend on the manifold dimension d and not the ambient dimension D (typically D ≫ d).",
      "startOffset" : 94,
      "endOffset" : 97
    }, {
      "referenceID" : 0,
      "context" : "Another aspect is that our choice of the connection radius R depends on the (typically) unknown ρ, while for comparison, the connection radius in [1] is chosen to be √ 2r.",
      "startOffset" : 146,
      "endOffset" : 149
    }, {
      "referenceID" : 0,
      "context" : "It is easy to see that this theorem also establishes consistency for recovering the entire cluster tree by selecting an appropriate schedule on σn, ǫn and kn that ensures that all clusters are distinguished for n large enough (see [1] for a formal proof).",
      "startOffset" : 231,
      "endOffset" : 234
    }, {
      "referenceID" : 0,
      "context" : "Our proofs structurally mirror those in [1].",
      "startOffset" : 40,
      "endOffset" : 43
    }, {
      "referenceID" : 19,
      "context" : "Similar manifold adaptivity results have been shown in classification [20] and in non-parametric regression [21, 22].",
      "startOffset" : 70,
      "endOffset" : 74
    }, {
      "referenceID" : 20,
      "context" : "Similar manifold adaptivity results have been shown in classification [20] and in non-parametric regression [21, 22].",
      "startOffset" : 108,
      "endOffset" : 116
    }, {
      "referenceID" : 21,
      "context" : "Similar manifold adaptivity results have been shown in classification [20] and in non-parametric regression [21, 22].",
      "startOffset" : 108,
      "endOffset" : 116
    }, {
      "referenceID" : 0,
      "context" : "In the full dimensional setting of [1], this follows from standard VC inequalities.",
      "startOffset" : 35,
      "endOffset" : 38
    }, {
      "referenceID" : 18,
      "context" : "3 of [19] while the upper bound is based on a modification of the main result of [23].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 22,
      "context" : "3 of [19] while the upper bound is based on a modification of the main result of [23].",
      "startOffset" : 81,
      "endOffset" : 85
    }, {
      "referenceID" : 0,
      "context" : "The proof is analogous to the separation proof of [1] with several modifications.",
      "startOffset" : 50,
      "endOffset" : 53
    }, {
      "referenceID" : 18,
      "context" : "3 in [19] who show that if ‖p− q‖ = R ≤ τ/2, then the geodesic distance dM (p, q) ≤ τ − τ √ 1− 2R τ .",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 0,
      "context" : ", a continuous map P : [0, 1] → A such that P (0) = y and P (1) = y′.",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 0,
      "context" : "For full dimensional densities, [1] showed the information theoretic lower bound n = Ω ( 1 λǫvDσ log 1 λǫvDσ ) .",
      "startOffset" : 32,
      "endOffset" : 35
    }, {
      "referenceID" : 24,
      "context" : "This can be fixed without affecting the essence of the construction by smoothing this intersection by rolling a ball of radius τ around it (a similar construction is made rigorous in Theorem 6 of [25]).",
      "startOffset" : 196,
      "endOffset" : 200
    }, {
      "referenceID" : 0,
      "context" : "In particular, ρ no longer depends on ǫτ and for the case of τ fixed (ignoring constants depending on d) the algorithm achieves the near minimax optimal rates of [1], in the manifold setting with d replacing D.",
      "startOffset" : 162,
      "endOffset" : 165
    }, {
      "referenceID" : 25,
      "context" : "Following the literature on manifold estimation ([26, 25]) we consider two main noise models.",
      "startOffset" : 49,
      "endOffset" : 57
    }, {
      "referenceID" : 24,
      "context" : "Following the literature on manifold estimation ([26, 25]) we consider two main noise models.",
      "startOffset" : 49,
      "endOffset" : 57
    }, {
      "referenceID" : 26,
      "context" : "It is also possible to recover the cluster tree in the presence of general additive noise distributions via deconvolution [27, 26] but we do not pursue this approach here.",
      "startOffset" : 122,
      "endOffset" : 130
    }, {
      "referenceID" : 25,
      "context" : "It is also possible to recover the cluster tree in the presence of general additive noise distributions via deconvolution [27, 26] but we do not pursue this approach here.",
      "startOffset" : 122,
      "endOffset" : 130
    }, {
      "referenceID" : 23,
      "context" : "Following [24], we will further assume that the class of functions",
      "startOffset" : 10,
      "endOffset" : 14
    }, {
      "referenceID" : 13,
      "context" : "The first Lemma appears in a similar form in [14] (Proposition 9) and is a modification of a result of [24] (Corollary 2.",
      "startOffset" : 45,
      "endOffset" : 49
    }, {
      "referenceID" : 23,
      "context" : "The first Lemma appears in a similar form in [14] (Proposition 9) and is a modification of a result of [24] (Corollary 2.",
      "startOffset" : 103,
      "endOffset" : 107
    }, {
      "referenceID" : 13,
      "context" : "The proof follows along the lines of those in [14, 24].",
      "startOffset" : 46,
      "endOffset" : 54
    }, {
      "referenceID" : 23,
      "context" : "The proof follows along the lines of those in [14, 24].",
      "startOffset" : 46,
      "endOffset" : 54
    }, {
      "referenceID" : 23,
      "context" : "To apply Talagrand’s inequality in the proof of [24] we need to bound",
      "startOffset" : 48,
      "endOffset" : 52
    }, {
      "referenceID" : 23,
      "context" : "Replacing this bound on the variance in the proof of [24] we obtain the desired result.",
      "startOffset" : 53,
      "endOffset" : 57
    }, {
      "referenceID" : 0,
      "context" : "Our first result mirrors the main result of [1].",
      "startOffset" : 44,
      "endOffset" : 47
    }, {
      "referenceID" : 0,
      "context" : "Also notice unlike the result of [1] this result requires the density to be uniformly upper bounded.",
      "startOffset" : 33,
      "endOffset" : 36
    }, {
      "referenceID" : 0,
      "context" : "Notice, that for a fixed ǫ and n the probability of success decays rapidly with increasing d and that for a fixed d and n the probability of success grows with ǫ, in agreement with our 1/ǫΩ(d) prediction and in contrast to the 1/ǫ2 scaling predicted by [1] for recovering a full-dimensional cluster tree.",
      "startOffset" : 253,
      "endOffset" : 256
    }, {
      "referenceID" : 18,
      "context" : "The lower bound follows from [19] (Lemma 5.",
      "startOffset" : 29,
      "endOffset" : 33
    }, {
      "referenceID" : 22,
      "context" : "The upper bound follows from [23] who shows that",
      "startOffset" : 29,
      "endOffset" : 33
    }, {
      "referenceID" : 18,
      "context" : "See [19] (p.",
      "startOffset" : 4,
      "endOffset" : 8
    }, {
      "referenceID" : 0,
      "context" : "The lemma now follows using simple manipulations of these inequalities (see [1] for details).",
      "startOffset" : 76,
      "endOffset" : 79
    } ],
    "year" : 2013,
    "abstractText" : "In this paper we investigate the problem of estimating the cluster tree for a density f supported on or near a smooth d-dimensional manifold M isometrically embedded in R. We analyze a modified version of a k-nearest neighbor based algorithm recently proposed by Chaudhuri and Dasgupta [1]. The main results of this paper show that under mild assumptions on f and M , we obtain rates of convergence that depend on d only but not on the ambient dimension D. We also show that similar (albeit non-algorithmic) results can be obtained for kernel density estimators. We sketch a construction of a sample complexity lower bound instance for a natural class of manifold oblivious clustering algorithms. We further briefly consider the known manifold case and show that in this case a spatially adaptive algorithm achieves better rates.",
    "creator" : "LaTeX with hyperref package"
  }
}