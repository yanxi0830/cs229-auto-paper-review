{
  "name" : "1508.05170.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Adaptive Online Learning",
    "authors" : [ "Dylan J. Foster", "Alexander Rakhlin", "Karthik Sridharan" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "Our framework recovers and improves a wide variety of adaptive bounds including quantile bounds, second-order data-dependent bounds, and small loss bounds. In addition we derive a new type of adaptive bound for online linear optimization based on the spectral norm, as well as a new online PAC-Bayes theorem that holds for countably infinite sets."
    }, {
      "heading" : "1 Introduction",
      "text" : "Some of the recent progress on the theoretical foundations of online learning has been motivated by the parallel developments in the realm of statistical learning. In particular, this motivation has led to martingale extensions of empirical process theory, which were shown to be the “right” notions for online learnability. Two topics, however, have remained elusive thus far: obtaining data-dependent bounds and establishing model selection (or, oracle-type) inequalities for online learning problems. In this paper we develop new techniques for addressing both these topics.\nOracle inequalities and model selection have been topics of intense research in statistics in the last two decades [1, 2, 3]. Given a sequence of modelsM1,M2, . . . whose union isM, one aims to derive a procedure that selects, given an i.i.d. sample of size n, an estimator f̂ from a model Mm̂ that trades off bias and variance. Roughly speaking the desired oracle bound takes the form\nerr(f̂) ≤ inf m { inf f∈Mm err(f) + penn(m)} ,\nwhere penn(m) is a penalty for the model m. Such oracle inequalities are attractive because they can be shown to hold even if the overall modelM is too large. A central idea in the proofs of such statements (and an idea that will appear throughout the present paper) is that penn(m) should be “slightly larger” than the fluctuations of the empirical process for the model m. It is therefore not surprising that concentration inequalities—and particularly Talagrand’s celebrated inequality for the supremum of the empirical process— have played an important role in attaining oracle bounds. In order to select a good model in a data-driven manner, one first establishes non-asymptotic data-dependent bounds on the fluctuations of an empirical process indexed by elements in each model (see the monograph [4]).\nLifting the ideas of oracle inequalities and data-dependent bounds from statistical to online learning is not an obvious task. For one, there is no concentration inequality available, even for the simple case of a\nar X\niv :1\n50 8.\n05 17\n0v 1\n[ cs\n.L G\n] 2\n1 A\nug 2\n01 5\nsequential Rademacher complexity. (For the reader already familiar with this complexity: a change of the value of one Rademacher variable results in a change of the remaining path, and hence an attempt to use a version of a bounded difference inequality grossly fails). Luckily, as we show in this paper, the concentration machinery is not needed and one only requires a one-sided tail inequality. This realization is motivated by the recent work of [5, 6, 7]. At the high level, our approach will be to develop one-sided inequalities for the suprema of certain offset processes [7], with an offset that is chosen to be “slightly larger” than the complexity of the corresponding model. We then show that these offset processes also determine which data-dependent adaptive rates are achievable for a given online learning problem, drawing strong connections to the ideas of statistical learning described earlier."
    }, {
      "heading" : "1.1 Framework",
      "text" : "Let X be the set of observations, D the space of decisions, and Y the set of outcomes. Let ∆(S) denote the set of distributions on a set S. Let ` ∶ D×Y → R be a loss function. The online learning framework is defined by the following process: For t = 1, . . . , n, Nature provides input instance xt ∈ X ; Learner selects prediction distribution qt ∈ ∆(D); Nature provides label yt ∈ Y, while the learner draws prediction ŷt ∼ qt and suffers loss `(ŷt, yt).\nTwo specific scenarios of interest are supervised learning (Y ⊆ R, D ⊆ R) and online linear (or convex) optimization (X = {0} is the singleton set, Y and D are unit balls in dual Banach spaces and `(ŷ, y) = ⟨ŷ, y⟩).\nFor a class F ⊆ DX , we define the learner’s cumulative regret to F as n\n∑ t=1 `(ŷt, yt) − inf f∈F\nn\n∑ t=1 `(f(xt), yt).\nA uniform regret bound Bn is achievable if there exists a randomized algorithm for selecting ŷt such that\nE[ n\n∑ t=1 `(ŷt, yt) − inf f∈F\nn\n∑ t=1 `(f(xt), yt)] ≤ Bn ∀x1∶n, y1∶n, (1)\nwhere a1∶n stands for {a1, . . . , an}. Achievable rates Bn depend on complexity of the function class F . For example, sequential Rademacher complexity of F is one of the tightest achievable uniform rates for a variety of loss functions [8, 7].\nAn adaptive regret bound has the form Bn(f ;x1∶n, y1∶n) and is said to be achievable if there exists a randomized algorithm for selecting ŷt such that\nE[ n\n∑ t=1 `(ŷt, yt) −\nn\n∑ t=1 `(f(xt), yt)] ≤ Bn(f ;x1∶n, y1∶n) ∀x1∶n, y1∶n, ∀f ∈ F . (2)\nWe distinguish three types of adaptive bounds, according to whether Bn(f ;x1∶n, y1∶n) depends only on f , only on (x1∶n, y1∶n), or on both quantities. Whenever Bn depends on f , an adaptive regret can be viewed as an oracle inequality which penalizes each f according to a measure of its complexity (e.g. the complexity of the smallest model to which it belongs). As in statistical learning, an oracle inequality (2) may be proved for certain functions Bn(f ;x1∶n, y1∶n) even if a uniform bound (1) cannot hold for any nontrivial Bn."
    }, {
      "heading" : "1.2 Related Work",
      "text" : "The case when Bn(f ;x1∶n, y1∶n) = Bn(x1∶n, y1∶n) does not depend on f has received most of the attention in the literature. The focus is on bounds that can be tighter for “nice sequences,” yet maintain near-optimal worst-case guarantees. An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.\nThe present paper was partly motivated by the work of [14] who presented an algorithm that competes with all experts simultaneously, but with varied regret with respect to each of them, depending on the quantile of the expert. This is a bound of the type Bn(f) (dependent only on f , where f denotes the quantile we\ncompete against) for the finite experts setting. The work of [15] considers online linear optimization with an unbounded set and provides oracle inequalities with an appropriately chosen function Bn(f).\nFinally, the third category of adaptive bounds are those that depend on both the hypothesis f ∈ F and the data. The bounds that depend on the loss of the best function (so-called “small-loss” bounds, [16, Sec. 2.4], [17, 13]) fall in this category trivially, since one may overbound the loss of the best function by the performance of f . We would like to draw attention to the recent result of [18] who show an adaptive bound in terms of both the loss of comparator and the KL divergence between the comparator and some pre-fixed prior distribution over experts. An MDL-style bound in terms of the variance of the loss of the comparator (under the distribution induced by the algorithm) was recently given in [19].\nOur study was also partly inspired by Cover [20] who characterized necessary and sufficient conditions for achievable bounds in prediction of binary sequences. The methods in [20], however, rely on the structure of the binary prediction problem and do not readily generalize to other settings.\nThe framework we propose recovers the vast majority of known adaptive rates in literature, including variance bounds, quantile bounds, localization-based bounds, and fast rates for small losses. It should be noted that while existing literature on adaptive online learning has focused on simple hypothesis classes such as finite experts and finite-dimensional p-norm balls, our results extend to general hypothesis classes, including large nonparametric ones discussed in [7]."
    }, {
      "heading" : "2 Adaptive Rates and Achievability: General Setup",
      "text" : "The first step in building a general theory for adaptive online learning is to identify what adaptive regret bounds are possible to achieve. Recall that an adaptive regret bound of Bn ∶ F × Xn × Yn → R is said to be achievable if there exists an online learning algorithm that produces predictions/decisions such that (2) holds.\nIn the rest of this work, we use the notation ⟪. . .⟫nt=1 to denote the interleaved application of the operators inside the brackets, repeated over t = 1, . . . , n rounds (see [21]). Achievability of an adaptive rate can be formalized by the following minimax quantity.\nDefinition 1. Given an adaptive rate Bn we define the offset minimax value:\nAn(F ,Bn) ≜ ⟪ sup xt∈X inf qt∈∆(D) sup yt∈Y E ŷt∼qt\n⟫ n t=1 [ n ∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}].\nAn(F ,Bn) quantifies how ∑nt=1 `(ŷt, yt) − inff∈F {∑nt=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)} behaves when the optimal learning algorithm that minimizes this difference is used against Nature trying to maximize it. Directly from this definition,\nAn adaptive rate Bn is achievable if and only if An(F ,Bn) ≤ 0.\nIf Bn is a uniform rate, i.e., Bn(f ;x1∶n, y1∶n) = Bn, achievability reduces to the minimax analysis explored in [8]. The uniform rate Bn is achievable if and only if Bn ≥ Vn(F), where Vn(F) is the minimax value of the online learning game.\nWe now focus on understanding the minimax value An(F ,Bn) for general adaptive rates. We first show that the minimax value is bounded by an offset version of the sequential Rademacher complexity studied in [8]. The symmetrization Lemma 1 below provides us with the first step towards a probabilistic analysis of achievable rates. Before stating the lemma, we need to define the notion of a tree and the notion of sequential Rademacher complexity.\nGiven a set Z, a Z-valued tree z of depth n is a sequence (zt)nt=1 of functions zt ∶ {±1}t−1 → Z. One may view z as a complete binary tree decorated by elements of Z. Let = ( t)nt=1 be a sequence of independent Rademacher random variables. Then (zt( )) may be viewed as a predictable process with respect to the filtration St = σ( 1, . . . , t). For a tree z, the sequential Rademacher complexity of a function class G ⊆ RZ\non z is defined as\nRn(G,z) ≜ E sup g∈G\nn\n∑ t=1 tg(zt( )),\nand we denote Rn(G) ≜ supzRn(G,z). Let z1∶n( ) ≜ (z1( ), . . . ,zn( )) be the labels of the tree z along the path given by .\nLemma 1. For any lower semi-continuous loss `, and any adaptive rate Bn that only depends on outcomes (i.e. Bn(f ;x1∶n, y1∶n) = Bn(y1∶n)), we have that\nAn ≤ sup x,y E [sup f∈F\n{2 n\n∑ t=1 t`(f(xt( )),yt( ))} − Bn(y1∶n( ))] . (3)\nFurther, for any general adaptive rate Bn,\nAn ≤ sup x,y,y′ E [sup f∈F\n{2 n\n∑ t=1 t`(f(xt( )),yt( )) − Bn(f ;x1∶n( ),y′2∶n+1( ))}] . (4)\nFinally, if one considers the supervised learning problem where F ∶ X → R, Y ⊂ R and ` ∶ R×R→ R is a loss that is convex and L-Lipschitz in its first argument, then for any adaptive rate Bn,\nAn ≤ sup x,y E [sup f∈F\n{2L n\n∑ t=1 tf(xt( )) − Bn(f ;x1∶n( ),y1∶n( ))}] . (5)\nThe above lemma tells us that to check whether an adaptive rate is achievable, it is sufficient to check that the corresponding adaptive sequential complexity measures are non-positive. We remark that if the above complexities are bounded by some positive quantity of a smaller order, one can form a new achievable rate B′n by adding the positive quantity to Bn."
    }, {
      "heading" : "3 Probabilistic Tools",
      "text" : "As mentioned in the introduction, our technique rests on certain one-sided probabilistic inequalities. We now state the first building block: a rather straightforward maximal inequality.\nProposition 2. Let I = {1, . . . ,N}, N ≤ ∞, be a set of indices and let (Xi)i∈I be a sequence of random variables satisfying the following tail condition: for any τ > 0,\nP (Xi −Bi > τ) ≤ C1 exp (−τ2/(2σ2i )) +C2 exp (−τsi) (6)\nfor some positive sequence (Bi), nonnegative sequence (σi) and nonnegative sequence (si) of numbers, and for constants C1,C2 ≥ 0. Then for any σ̄ ≤ σ1, s̄ ≥ s1, and\nθi = max{ σi Bi\n√ 2 log(σi/σ̄) + 4 log(i), (Bisi)−1 log (i2(s̄/si))} + 1,\nit holds that\nE sup i∈I\n{Xi −Biθi} ≤ 3C1σ̄ + 2C2(s̄)−1. (7)\nWe remark that Bi need not be the expected value of Xi, as we are not interested in two-sided deviations around the mean.\nOne of the approaches to obtaining oracle-type inequalities is to split a large class into smaller ones according to a “complexity radius” and control a certain stochastic process separately on each subset (also known as the peeling technique). In the applications below, Xi will often stand for the (random) supremum of this process, and Bi will be an upper bound on its typical size. Given deviation bounds for Xi above\nBi, the dilated size Biθi then allows one to pass to maximal inequalities (7) and thus verify achievability in Lemma 1. The same strategy works for obtaining data-dependent bounds, where we first prove tail bounds for the given size of the data-dependent quantity, and then appeal to (7).\nA simple yet powerful example for the control of the supremum of a stochastic process is an inequality due to Pinelis [22] for the norm (which can be written as a supremum over the dual ball) of a martingale in a 2-smooth Banach space. Here we state a version of this result that can be found in [23, Appendix A].\nLemma 3. Let Z be a unit ball in a separable (2,D)-smooth Banach space H. Then for any Z-valued tree z,\nP (∥ n\n∑ t=1 tzt( )∥ ≥ τ) ≤ 2 exp(−\nτ2\n8D2n )\nwhenever n > τ/4D2.\nWhen the class of functions is not linear, we may no longer appeal to the above lemma. Instead, we make use of the following result from [24] that extends Lemma 3 at a price of a poly-logarithmic factor. Before stating the lemma, we briefly define the relevant complexity measures (see [24] for more details). First, a set V of R-valued trees is called an α-cover of G ⊆ RZ on z with respect to `p if\n∀g ∈ G,∀ ∈ {±1}n,∃v ∈ V s.t. n\n∑ t=1 (g(zt( )) − vt( ))p ≤ nαp.\nThe size of the smallest α-cover is denoted by Np(G, α,z), and Np(G, α, n) ≜ supzNp(G, α,z). The set V is an α-cover of G on z with respect to `∞ if\n∀g ∈ G,∀ ∈ {±1},∃v ∈ V s.t. ∣g(zt( )) − vt( )∣ ≤ α ∀t ∈ [n].\nWe let N∞(G, α,z) be the smallest such cover and set N∞(G, α, n) = supzN∞(G, α,z).\nLemma 4 ([24]). Let G ⊆ [−1,1]Z . Suppose Rn(G)/n → 0 with n →∞ and that the following mild assumptions hold: Rn(G) ≥ 1/n, N∞(G,2−1, n) ≥ 4, and there exists a constant Γ such that Γ ≥ ∑∞j=1N∞(G,2−j , n)−1. Then for any θ > √ 12/n, for any Z-valued tree z of depth n,\nP (sup g∈G\n∣ n\n∑ t=1 tg(zt( ))∣ > 8(1 + θ\n√ 8n log3(en2)) ⋅Rn(G))\n≤ P (sup g∈G\n∣ n\n∑ t=1 tg(zt( ))∣ > n inf α>0 {4α + 6θ∫\n1\nα\n√ logN∞(G, δ, n)dδ}) ≤ 2Γe− nθ2 4 .\nThe above lemma yields a one-sided control on the size of the supremum of the sequential Rademacher process, as required for our oracle-type inequalities.\nNext, we turn our attention to an offset Rademacher process, where the supremum is taken over a collection of negative-mean random variables. The behavior of this offset process was shown to govern the optimal rates of convergence for online nonparametric regression [7]. Such a one-sided control of the supremum will be necessary for some of the data-dependent upper bounds we develop.\nLemma 5. Let z be a Z-valued tree of depth n, and let G ⊆ RZ . For any γ ≥ 1/n and α > 0,\nP (sup g∈G\nn\n∑ t=1\n( tg(zt( )) − 2αg2(zt( ))) − logN2(G, γ,z)\nα − 12\n√ 2∫ γ\n1/n\n√ n logN2(G, δ,z)dδ − 1 > τ)\n≤ Γ exp(− τ 2 2σ2 ) + exp(−ατ 2 ) ,\nwhere Γ ≥ ∑log2(2nγ)j=1 N2(G,2−jγ,z)−2 and σ = 12 ∫ γ 1 n\n√ n logN2(G, δ,z)dδ.\nWe observe that the probability of deviation has both subgaussian and subexponential components. Using the above result and Proposition 2 leads to useful bounds on the quantities in Lemma 1 for specific types of adaptive rates. Given a tree z, we obtain a bound on the expected size of the sequential Rademacher process when we subtract off the data-dependent `2-norm of the function on the tree z, adjusted by logarithmic terms.\nCorollary 6. Suppose G ⊆ [−1,1]Z , and let z be any Z-valued tree of depth n. Assume logN2(G, δ, n) ≤ δ−p for some p < 2. Then\nE ⎡⎢⎢⎢⎢⎣ sup g∈G,γ ⎧⎪⎪⎨⎪⎪⎩ n ∑ t=1 tg(zt( )) − 4 ¿ ÁÁÀ2(logn) logN2(G, γ/2,z)( n ∑ t=1 g2(zt( )) + 1) − 24 √ 2 logn∫ γ 1/n √ n logN2(G, δ,z)dδ ⎫⎪⎪⎬⎪⎪⎭ ⎤⎥⎥⎥⎥⎦\nis at most 7 + 2 logn.\nThe next corollary yields slightly faster rates than Corollary 6 when ∣G∣ <∞.\nCorollary 7. Suppose G ⊆ [−1,1]Z with ∣G∣ = N , and let z be any Z-valued tree of depth n. Then\nE ⎡⎢⎢⎢⎢⎣ sup g∈G ⎧⎪⎪⎨⎪⎪⎩ n ∑ t=1 tg(zt( )) − 2 log(logN n ∑ t=1 g2(z( )) + e) ¿ ÁÁÀ32(logN n ∑ t=1 g2(z( )) + e) ⎫⎪⎪⎬⎪⎪⎭ ⎤⎥⎥⎥⎥⎦ ≤ 1."
    }, {
      "heading" : "4 Achievable Bounds",
      "text" : "In this section we use Lemma 1 along with the probabilistic tools from the previous section to obtain an array of achievable adaptive bounds for various online learning problems. We subdivide the section into one subsection for each category of adaptive bound described in Section 1.1."
    }, {
      "heading" : "4.1 Adapting to Data",
      "text" : "Here we consider adaptive rates of the form Bn(x1∶n, y1∶n) or Bn(y1∶n), uniform over f ∈ F . We show the power of the developed tools on the following example.\nExample 4.1 (Online Linear Optimization in Rd). Consider the problem of online linear optimization where F = {f ∈ Rd ∶ ∥f∥2 ≤ 1}, Y = {y ∶ ∥y∥2 ≤ 1}, X = {0}, and `(ŷ, y) = ⟨ŷ, y⟩. The following adaptive rate is achievable:\nBn(y1∶n) = 16 √ d log(n) XXXXXXXXXXXX ( n ∑ t=1 yty ⊺ t ) 1/2XXXXXXXXXXXXσ + 16 √ d log(n),\nwhere ∥⋅∥σ is the spectral norm. Let us deduce this result from Corollary 6. First, observe that\nXXXXXXXXXXXX ( n ∑ t=1 yty ⊺ t ) 1/2XXXXXXXXXXXXσ = sup f ∶∥f∥2≤1 XXXXXXXXXXXX ( n ∑ t=1 yty ⊺ t ) 1/2 f XXXXXXXXXXXX = sup f ∶∥f∥2≤1 ¿ ÁÁÀf⊺ n ∑ t=1 yty ⊺ t f = sup f∈F ¿ ÁÁÀ n ∑ t=1 `2(f, yt).\nThe linear function class F can be covered point-wise at any scale δ with (3/δ)d balls and thus\nN (` ○F ,1/(2n),z) ≤ (6n)d\nfor any Y-valued tree z. We apply Corollary 6 with γ = 1/n (the integral vanishes) to conclude the claimed statement."
    }, {
      "heading" : "4.2 Model Adaptation",
      "text" : "In this subsection we focus on achievable rates for oracle inequalities and model selection, but without dependence on data. The form of the rate is therefore Bn(f). Assume we have a class F = ⋃R≥1F(R), with the property that F(R) ⊆ F(R′) for any R ≤ R′. If we are told by an oracle that regret will be measured with respect to those hypotheses f ∈ F with R(f) ≜ inf{R ∶ f ∈ F(R)} ≤ R∗, then using the minimax algorithm one can guarantee a regret bound of at most the sequential Rademacher complexity Rn(F(R∗)). On the other hand, given the optimality of the sequential Rademacher complexity for online learning problems for commonly encountered losses, we can argue that for any f ∈ F chosen in hindsight, one cannot expect a regret better than order Rn(F(R(f))). In this section we show that simultaneously for all f ∈ F , one can attain an adaptive upper bound of O (Rn(F(R(f))) √ log (Rn(F(R(f)))) log3/2 n). That is, we may predict as if we knew the optimal radius, at the price of a logarithmic factor. This is the price of adaptation.\nCorollary 8. For any class of predictors F with F(1) non-empty, if one considers the supervised learning problem with 1-Lipschitz loss `, the following rate is achievable:\nBn(f) =K1Rn(F(2R(f))) log3/2 n ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Rn(F(2R(f)))Rn(F(1)) ) + log(log(2R(f))) ⎞ ⎟ ⎠\n+K2ΓRn(F(1)) log3/2 n,\nfor absolute constants K1,K2, and Γ defined in Lemma 4.\nIn fact, this statement is true more generally with F(2R(f)) replaced by ` ○F(2R(f)). It is tempting to attempt to prove the above statement with the exponential weights algorithm running as an aggregation procedure over the solutions for each R. In general, this approach will fail for two reasons. First, if function values grow with R, the exponential weights bound will scale linearly with this value. Second, an experts bound yields a n1/2 rate which spoils any faster rates one may obtain using offset Rademacher complexities.\nAs a special case of the above lemma, we obtain an online PAC-Bayesian theorem for infinite classes of experts. However, we postpone this example to the next sub-section where we get a data-dependent version of this result. Neither of these bounds appear to be available in the literature, to the best of our knowledge.\nWe now provide a bound for online linear optimization in 2-smooth Banach spaces that automatically adapts to the norm of the comparator. To prove it, we use the concentration bound from [22] (Lemma 3) within the proof of the above corollary to remove the extra logarithmic factors.\nExample 4.2 (Unconstrained Linear Optimization). Consider linear optimization with Y being the unit ball of some reflexive Banach space with norm ∥⋅∥∗. Let F = D be the dual space and the loss `(ŷ, y) = ⟨ŷ, y⟩ (where we are using ⟨⋅, ⋅⟩ to represent the linear functional in the first argument to the second argument). Define F(R) = {f ∣ ∥f∥ ≤ R} where ∥⋅∥ is the norm dual to ∥⋅∥∗. If the unit ball of Y is (2,D)-smooth, then the following rate is achievable for all f with ∥f∥ ≥ 1:\nB(f) =D √ n(8∥f∥(1 + √ log(2∥f∥) + log log(2∥f∥)) + 12).\nFor the case of a Hilbert space, the above bound was achieved by [15]."
    }, {
      "heading" : "4.3 Adapting to Data and Model Simultaneously",
      "text" : "We now study achievable bounds that perform online model selection in a data-adaptive way. Of specific interest is the example of online optimistic PAC-Bayesian bound which —in contrast to earlier results—does not have dependence on the number of experts, and so holds for countably infinite sets of experts. The bound simultaneously adapts to the loss of the mixture of experts. This example subsumes and improves upon the recent results from [18, 14] and provides an exact analogue to the PAC Bayesian theorem from statistical learning. Further, quantile experts bounds can be easily recovered from the result.\nExample 4.3 (Generalized Predictable Sequences (Supervised Learning)). Consider an online supervised learning problem with a convex 1-Lipschitz loss. Let (Mt)t≥1 be any predictable sequence that the learner can compute at round t based on information provided so far, including xt (One can think of the predictable sequence Mt as a prior guess for the hypothesis we would compare with in hindsight). Then the following adaptive rate is achievable:\nBn(f ;x1∶n) = inf γ {K1\n¿ ÁÁÀlogn ⋅ logN2(F , γ/2, n) ⋅ ( n\n∑ t=1\n(f(xt) −Mt)2 + 1)\n+K2 logn∫ γ\n1/n\n√ n logN2(F , δ, n)dδ + 2 logn + 7},\nfor constants K1 = 4 √ 2,K2 = 24 √\n2 from Corollary 6. The achievability is a direct consequence of Eq. (5) in Lemma 1, followed by Corollary 6 (one can include any predictable sequence in the Rademacher average part because ∑tMt t is zero mean). Particularly, if we assume that the sequential covering of class F grows as logN2(F , , n) ≤ −p for some p < 2, we get that\nBn(f) = Õ ⎛ ⎜⎜ ⎝ ⎛ ⎝\n¿ ÁÁÀ n\n∑ t=1 (f(xt) −Mt)2 + 1 ⎞ ⎠\n1− p2 ( √ n)p/2 ⎞ ⎟⎟ ⎠ .\nAs p gets closer to 0, we get full adaptivity and replace n by ∑nt=1 (f(xt) −Mt) 2 + 1. On the other hand, as p gets closer to 2 (i.e. more complex function classes), we do not adapt and get a uniform bound in terms of n. For p ∈ (0,2), we attain a natural interpolation.\nExample 4.4 (Regret to Fixed Vs Regret to Best (Supervised Learning)). Consider an online supervised learning problem with a convex 1-Lipschitz loss and let ∣F ∣ = N . Let f⋆ ∈ F be a fixed expert chosen in advance. The following bound is achievable:\nBn(f, x1∶n) = 4 log(logN n\n∑ t=1\n(f(xt) − f⋆(xt))2 + e) ¿ ÁÁÀ32(logN n\n∑ t=1\n(f(xt) − f⋆(xt))2 + e) + 2.\nIn particular, against f⋆ we have Bn(f⋆, x1∶n) = O(1),\nand against an arbitrary expert we have\nBn(f, x1∶n) = O( √ n logN(logn + log logN)).\nThis bound follows directly from Eq. (5) in Lemma 1 followed by Corollary 7. This extends the study of [25] to supervised learning and a general class of experts F .\nExample 4.5 (Optimistic PAC-Bayes). Assume that we have a countable set of experts and that the loss for each expert on any round is non-negative and bounded by 1. The function class F is the set of all distributions over these experts, and X = {0}. This setting can be formulated as online linear optimization where the loss of mixture f over experts, given instance y, is ⟨f, y⟩, the expected loss under the mixture. The following adaptive bound is achievable:\nBn(f ; y1∶n) = ¿ ÁÁÀ50 (KL(f ∣π) + log(n)) n\n∑ t=1\nEi∼f ⟨ei, yt⟩2 + 50 (KL(f ∣π) + log(n)) + 10.\nThis adaptive bound is an online PAC-Bayesian bound. The rate adapts not only to the KL divergence of f with fixed prior π but also replaces n with ∑nt=1 Ei∼f ⟨ei, yt⟩ 2 . Note that we have ∑nt=1 Ei∼f ⟨ei, yt⟩ 2 ≤\n∑nt=1 ⟨f, yt⟩, yielding the small-loss type bound described earlier. This is an improvement over the bound in [18] in that the bound is independent of number of experts, and thus holds even for countably infinite sets of experts. The KL term in our bound may be compared to the MDL-style term in the bound of [19]. If we have a large (but finite) number of experts and take the uniform distribution π, the above bound provides an improvement over both [14] and [18] for quantile bounds for experts. Specifically, if we want quantile bounds simultaneously for every quantile then for any given quantile we can use uniform distribution over the top 1/ experts and hence the KL term is replaced by log(1/ ). Evaluating the above bound with a distribution f that places all its weight on any one expert appears to address the open question posed by [13] of obtaining algorithm-independent oracle-type variance bounds for experts.\nThe proof of achievability of the above rate is shown in the appendix because it requires a slight variation on the symmetrization lemma specific to the problem."
    }, {
      "heading" : "5 Relaxations for Adaptive Learning",
      "text" : "To design algorithms for achievable rates, we extend the framework of online relaxations from [26]. A relaxation Reln ∶ ⋃nt=0X t ×Yt → R is admissible for an adaptive rate Bn if Rel satisfies the initial condition\nReln(x1∶n, y1∶n) ≥ − inf f∈F\n{ n\n∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)} (8)\nand the recursive condition\nReln(x1∶t−1, y1∶t−1) ≥ sup xt∈X inf qt∈∆(D) sup yt∈Y Eŷ∼qt[`(ŷt, yt) +Reln(x1∶t, y1∶t)]. (9)\nThe corresponding strategy q̂t = arg minqt∈∆(D) supyt∈Y Eŷ∼qt[`(ŷt, yt) +Reln(x1∶t, y1∶t)] enjoys the adaptive bound\nn\n∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)} ≤ Reln(⋅) ∀x1∶n, y1∶n.\nIt follows immediately that the strategy achieves the rate Bn(f ;x1∶n, y1∶n)+Reln(⋅). Our goal is then to find relaxations for which the strategy is computationally tractable and Reln(⋅) ≤ 0 or at least has smaller order than Bn. Similar to [26], conditional versions of the offset minimax values An yield admissible relaxations, but solving these relaxations may not be computationally tractable.\nExample 5.1 (Online PAC-Bayes). Consider the experts setting described in Example 4.5 and an adaptive bound,\nBn(f) = 3 √ 2nmax{KL(f ∣ π),1} + 4 √ n.\nLet Ri = 2i−1 for i ∈ N and let qRt (y) denote the exponential weights distribution with learning rate √ R/n given losses y1∶t: qR(y1∶t) ∝ Ek∼πek exp(− √ R n ⟨∑ts=1 yt, ek⟩) (wherein ek is the kth standard basis vector). The following is an admissible relaxation achieving Bn:\nReln(y1∶t) = inf λ>0 [ 1 λ log(∑ i exp(−λ[ t ∑ s=1 ⟨qRi(y1∶s−1), ys⟩ + √ nRi])) + 2λ(n − t)].\nTo achieve this strategy we maintain a distribution q⋆t with (q⋆t )i ∝ exp(− 1√n[∑ t−1 s=1⟨qRi(y1∶s−1), ys⟩ − √ nRi]). We predict by drawing i according to q⋆t , then drawing an expert according to q Ri(y1∶t−1).\nThis algorithm can be interpreted as running a “low-level” instance of the exponential weights algorithm for each complexity radius Ri, then combining the predictions of these algorithms with a “high-level” instance. The high-level distribution q⋆t differs slightly from the usual exponential weights distribution in that\nit incorporates a prior whose weight decreases as the complexity radius increases. The prior distribution prevents the strategy from incurring a penalty that depends on the range of values the complexity radii take on, which would happen if the standard exponential weights distribution were used.\nWhile in general the problem of obtaining an efficient adaptive relaxation might be hard, one can ask the question, “If and efficient relaxation RelRn is available for each F(R), can one obtain an adaptive model selection algorithm for all of F?”. To this end for supervised learning problem with convex Lipschitz loss we delineate a meta approach which utilizes existing relaxations for each F(R) to obtain algorithm for general adaptation.\nLemma 9. Let qRt (y1, . . . , yt−1) be the randomized strategy corresponding to RelRn , obtained after observing outcomes y1, . . . , yt−1, and let θ ∶ R → R be nonnegative. The following relaxation is admissible for the rate Bn(R) = RelRn (⋅)θ(RelRn (⋅)):\nAdan(x1∶t, y1∶t) =\nsup x,y,y′ E t+1∶n sup R≥1\n[RelRn (x1∶t, y1∶t) −RelRn (⋅)θ(RelRn (⋅)) + 2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))[`(ŷs(R),ys( ))]].\nPlaying according to the strategy for Adan will guarantee a regret bound of the form Bn(R)+Adan(⋅), and Adan(⋅) can be bounded using proposition 2 when the form of θ is as in that proposition.\nWe remark that the above strategy is not necessarily obtained by running a high-level experts algorithm over the discretized values of R. It is an interesting question to determine the cases when such a strategy is optimal. More generally, whenever the adaptive rate Bn depends on data, it is not possible to obtain the rates we show non-constructively in this paper using some form of exponential weights algorithms using meta-experts as the required weighting over experts would be data dependent (and hence is not a prior over experts). Further, the bounds from exponential-weights-type algorithms are more akin to having subexponential tails in Proposition 2, but for many problems we might have sub-gaussian tails.\nObtaining computationally efficient methods from the proposed framework is an interesting research direction. Proposition 2 provides a useful non-constructive tool to establish achievable adaptive bounds, and a natural question to ask is if one can obtain a constructive counterpart for the proposition."
    }, {
      "heading" : "A Appendix",
      "text" : "Proof of Lemma 1. We first prove Eq. (3) and (4). We start from the definition of An(F). Our proof proceeds “inside out” by starting with the nth term and then working backwards by repeatedly applying the minimax theorem. To this end on similar lines as in [24, 7, 21], we start with the inner most term as,\nsup xn∈X inf qn∈∆(D) sup yn∈Y (Eŷn∼qn [`(ŷn, yn) − inf f∈F\n{ n\n∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}])\n= sup xn∈X inf qn∈∆(D) sup pn∈∆(Y) (Eŷn∼qn yn∼pn\n[ n\n∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}])\n= sup xn∈X sup pn∈∆(Y) inf qn∈∆(D) (Eŷn∼qn yn∼pn\n[ n\n∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}])\n= sup xn∈X sup pn∈∆(Y) inf ŷn∈D\n(Eyn∼pn [ n\n∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}])\n= sup xn∈X sup pn∈∆(Y) (Eyn∼pn [sup f∈F { inf ŷn∈D\nEyn∼pn [ n\n∑ t=1 `(ŷt, yt)] −\nn\n∑ t=1 `(f(xt), yt) − Bn(f ;x1∶n, y1∶n)}]) .\nTo apply the minimax theorem in step 3 above, we note that the term in the round bracket is linear in qn and in pn (as it is an expectation). Hence under mild assumptions on the sets D and Y, the losses, and the adaptive rate Bn, one can apply a generalized version of the minimax theorem to swap suppn and infqn . Compactness of the sets and lower semi-continuity of the losses and Bn are sufficient, but see [24, 21] for milder conditions. Proceeding backward from n to 1 in a similar fashion we end up with\nAn(F) = ⟪ sup xt∈X inf qt∈∆(D) sup yt∈Y E ŷt∼qt\n⟫ n t=1 [ n ∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}]\n= ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 inf ŷt∈D\nEyt∼pt [`(ŷt, yt)] − n\n∑ t=1 `(f(xt), yt) − Bn(f ;x1∶n, y1∶n)}]\n≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\nEy′t∼pt [`(f(xt), y ′ t)] − `(f(xt), yt) − Bn(f ;x1∶n, y1∶n)}]. (10)\nSee [21] for more details of the steps involved in obtaining the above equality. Form this point on we split the proof for Equations 3 and 4. To prove the bound in Equation 3, note that, Bn(f ;x1∶n, y1∶n) = Bn(y1∶n) and so, (this proof is similar in spirit to the one in [7])\nAn(F) ≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\nEy′t∼pt [`(f(xt), y ′ t)] − `(f(xt), yt)} − Bn(y1∶n)]\n= ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\nEy′t∼pt [`(f(xt), y ′ t)] − `(f(xt), yt)} −\n1 2 Bn(y1∶n) − 1 2 Bn(y1∶n)].\nUsing linearity of expectation repeatedly (since Bn is independent of f and xt’s ),\nAn(F) ≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F { n ∑ t=1 Ey′t∼pt [`(f(xt), y ′ t)] − `(f(xt), yt)}\n− 1 2 Bn(y1∶n) − 1 2 Ey′1∶n∼p1∶n [Bn(y ′ 1∶n)] ⎤⎥⎥⎥⎥⎦ .\nBy Jensen’s inequality, we pull out the expectations w.r.t. y′t’s to further upper bound the above quantity by\n⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 `(f(xt), y′t) − `(f(xt), yt)} −\n1 2 Bn(y1∶n) − 1 2 Bn(y′1∶n)]\n= ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 t (`(f(xt), y′t) − `(f(xt), yt))} −\n1 2 Bn(y1∶n) − 1 2 Bn(y′1∶n)]\n≤ ⟪ sup xt∈X sup yt,y′t∈Y\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 t (`(f(xt), y′t) − `(f(xt), yt))} −\n1 2 Bn(y1∶n) − 1 2 Bn(y′1∶n)]\n≤ ⟪ sup xt∈X sup yt∈Y\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 2 t`(f(xt), yt)} − Bn(y1∶n)]\n= sup x,y E [sup f∈F\n{2 n\n∑ t=1 t`(f(xt( )),yt( ))} − Bn(y1∶n( ))] .\nwhere the last but one step is by sub-additivity of supremum and linearity of expectation and last step is by skolemizing the supremum interleaved with average w.r.t. Rademacher random variables in the binary tree format.\nWe now move to proving Eq. (4). We start from Eq. (10):\nAn(F) ≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\nEy′t∼pt [`(f(xt), y ′ t)] − `(f(xt), yt) − Bn(f ;x1∶n, y1∶n)}].\nUsing Jensen’s inequality to pull out the expectations w.r.t. y′t’s, we get\n≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 `(f(xt), y′t) − `(f(xt), yt) − Bn(f ;x1∶n, y1∶n)}]\n≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt sup y′′t ∈Y\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 `(f(xt), y′t) − `(f(xt), yt) − Bn(f ;x1∶n, y′′1∶n)}]\n= ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt E t sup y′′t ∈Y\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 t (`(f(xt), y′t) − `(f(xt), yt)) − Bn(f ;x1∶n, y′′1∶n)}]\n≤ ⟪ sup xt∈X sup yt,y′t∈Y E t sup y′′t ∈Y\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 t (`(f(xt), y′t) − `(f(xt), yt)) − Bn(f ;x1∶n, y′′1∶n)}]\n≤ ⟪ sup xt∈X sup yt∈Y E t sup y′′t ∈Y\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\n2 t`(f(xt), yt) − Bn(f ;x1∶n, y′′1∶n)}]\n= sup x,y,y′ E [sup f∈F\n{2 n\n∑ t=1 t`(f(xt( )),yt( )) − Bn(f ;x1∶n( ),y′2∶n+1( ))}] ,\nwhere in the last step we switch to tree notation, but keep in mind that each y′′t is picked after drawing t, and thus the tree y′ appears with one index shifted.\nFinally, we proceed to prove inequality (5). Here, we employ the convexity assumption `(ŷt, yt) − `(f(xt), yt) ≤ `′(ŷt, yt)(ŷt − f(xt)), where the derivative is with respect to the first argument. As before,\napplying the minimax theorem,\nAn(F) = ⟪ sup xt∈X inf qt∈∆(D) sup yt∈Y E ŷt∼qt\n⟫ n t=1 [ n ∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}]\n= ⟪ sup xt∈X sup pt∈∆(Y) inf ŷt∈D E yt∼pt\n⟫ n t=1 [ n ∑ t=1 `(ŷt, yt) − inf f∈F { n ∑ t=1 `(f(xt), yt) + Bn(f ;x1∶n, y1∶n)}]\n≤ ⟪ sup xt∈X sup pt∈∆(Y) inf ŷt∈D E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 `′(ŷt, yt)(ŷt − f(xt)) − Bn(f ;x1∶n, y1∶n)}].\nWe may now pick ŷt = ŷ∗t (pt) ≜ arg minŷ Eyt∼pt [`(ŷt, yt)]. By convexity (and assuming the loss allows swapping of derivative and expectation), Eyt∼pt [`′(ŷt, yt)] = 0. This (sub)optimal strategy yields an upper bound of\n⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\n(`′(ŷ∗t , yt) −Ey′t∼pt [` ′(ŷ∗t , y′t)]) (ŷ∗t − f(xt)) − Bn(f ;x1∶n, y1∶n)}].\nSince (`′(ŷ∗t , yt) −Ey′t∼pt [` ′(ŷ∗t , y′t)]) ŷ∗t is independent of f and has expected value of 0, the above quantity is equal to\n⟪ sup xt∈X sup pt∈∆(Y) E yt∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\n(Ey′t∼pt [` ′(ŷ∗t , y′t)] − `′(ŷ∗t , yt)) f(xt) − Bn(f ;x1∶n, y1∶n)}]\n≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt\n⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1\n(`′(ŷ∗t , y′t) − `′(ŷ∗t , yt)) f(xt) − Bn(f ;x1∶n, y1∶n)}]\n= ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 t (`′(ŷ∗t , y′t) − `′(ŷ∗t , yt)) f(xt) − Bn(f ;x1∶n, y1∶n)}].\nReplacing (`′(ŷ∗t , y′t) − `′(ŷ∗t , yt)) by 2Lst for st ∈ [−1,1] and taking supremum over st we get,\n≤ ⟪ sup xt∈X sup pt∈∆(Y) E yt,y′t∼pt sup st∈[−1,1]\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 2L tstf(xt) − Bn(f ;x1∶n, y1∶n)}]\n≤ ⟪ sup xt∈X sup yt sup st∈[−1,1]\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 2L tstf(xt) − Bn(f ;x1∶n, y1∶n)}].\nSince the suprema over st are achieved at {±1} by convexity, the last expression is equal to\n⟪ sup xt∈X sup yt sup st∈{−1,1}\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 2L tstf(xt) − Bn(f ;x1∶n, y1∶n)}]\n= ⟪ sup xt∈X sup yt\nE t⟫ n\nt=1 [sup f∈F\n{ n\n∑ t=1 2L tf(xt) − Bn(f ;x1∶n, y1∶n)}]\n= sup x,y E [sup f∈F\n{ n\n∑ t=1 2L tf(xt( )) − Bn(f ;x1∶n( ),y1∶n( ))}] .\nIn the last but one step we removed st, since for any function Ψ, and any s ∈ {±1}, E [Ψ(s )] = 12 (Ψ(s) +Ψ(−s)) = 1 2 (Ψ(1) +Ψ(−1)) = E [Ψ( )].\nProof of Proposition 2. Define Zi = [Xi −Biθi]+. As long as θi ≥ 1, for any strictly positive τ we have the tail behavior\nP (Zi ≥ t) = P (Xi −Biθi ≥ τ) ≤ C1 exp(− (Bi(θi − 1) + τ)2\n2σ2i ) +C2 exp (−(Bi(θi − 1) + τ)si) .\nNote that for any positive sequence (δi)i∈I with δ = ∑i∈I δi,\nE [sup i∈I {Xi −Biθi}] ≤ E [sup i∈I Zi] ≤∑ i∈I E [Zi] ≤ δ +∑ i∈I ∫\n∞\nδi P (Zi ≥ τ)dτ.\nThe sum of the integrals above is equal to\n∑ i∈I ∫\n∞\nδi P (Xi −Biθi ≥ τ)dτ\n≤ C1∑ i∈I ∫\n∞\n0 exp(−(Bi(θi − 1) + τ)\n2\n2σ2i )dt +C2∑ i∈I ∫\n∞\n0 exp (− (Bi(θi − 1) + τ) si)dτ\n≤ C1∑ i∈I exp(−1 2 (Bi σi\n) 2 (θi − 1)2)∫ ∞ 0 e − τ2 2σ2 i dτ +C2∑ i∈I exp (−Bisi (θi − 1))∫ ∞ 0 e−τsidτ\n≤ √ π\n2 C1∑ i∈I σi exp(−\n1 2 (Bi σi\n) 2\n(θi − 1)2) +C2∑ i∈I s−1i exp (−Bisi (θi − 1))\n≤ π 2√π 6 √ 2 C1σ̄ + π2 6 C2(s̄)−1,\nwhere the last step is obtained by plugging in\nθi = max{ σi Bi\n√ 2 log(σi/σ̄) + 4 log(i), (Bisi)−1 log (i2(s̄/si))} + 1\nand using as an upper bound σi Bi\n√ 2 log(i2σi/σ̄)+1 for θi in the sub-gaussian part and (Bisi)−1 log (i2s̄/si)+1\nfor θi in the sub-exponential part. Since δ can be chosen arbitrarily small, we may over-bound the above constant and obtain the result.\nProof of Lemma 5. Fix γ > 0. For j ≥ 0, let Vj be a minimal sequential cover of G on z at scale βj = 2−jγ and with respect to empirical `2 norm. Let v\nj[g, ] be an element guaranteed to be βj-close to f at the j-th level, for the given . Choose N = log2(2γn), so that βNn ≤ 1. Let us use the shorthand N2(γ) ≜ N2(G, γ,z).\nFor any ∈ {±1}n and g ∈ G, n\n∑ t=1 tg(zt( )) − 2αg(zt( ))2\ncan be written as n\n∑ t=1\n( t(g(zt( )) − v0t [g, ]( ))) + n\n∑ t=1 ( tv0t [g, ]( ) − 2αg(zt( ))2)\n≤ n\n∑ t=1\n( t(g(zt( )) − v0t [g, ]( ))) + n\n∑ t=1 ( tv0t [g, ]( ) − αv0t [g, ]( )2)\n= n\n∑ t=1\n( t(g(zt( )) − vNt [g, ]( )) + n\n∑ t=1\nN\n∑ k=1\nt (vkt [g, ]( ) − vk−1t [g, ]( )) + n\n∑ t=1 ( tv0t [g, ]( ) − αv0t [g, ]( )2) .\nBy Cauchy-Schwartz, the first term is upper bounded by nβN ≤ 1. The second term above is upper bounded by\nN\n∑ k=1\nn\n∑ t=1 t (vkt [g, ]( ) − vk−1t [g, ]( )) ≤\nN\n∑ k=1 sup wk∈Wk\nn\n∑ t=1 tw k t ( ),\nwhere Wk is a set of differences of trees for levels k and k − 1 (see [24, Proof of Theorem 3]). Finally, the third term is controlled by\nn\n∑ t=1 ( tv0t [g, ]( ) − αv0t [g, ]( )2) ≤ sup v∈V0\nn\n∑ t=1 ( tvt( ) − αv2t ( )) .\nThe probability in the statement of the Lemma can now be upper bounded by\nP ⎛ ⎝ N ∑ k=1 sup wk∈Wk n ∑ t=1 tw k t ( ) + sup v∈V0 n ∑ t=1 ( tvt( ) − αv2t ( )) − logN2(γ) α − 12 √ 2∫ γ 1/n √ n logN2(δ)dδ > τ ⎞ ⎠ .\nIn view of √\n72 N\n∑ k=1\nβk √ n logN2(βk) ≤ 12 √ 2∫ γ\n1/n\n√ n logN2(δ)dδ\nthis probability can be further upper bounded by\nP ( N\n∑ k=1 sup wk∈Wk\nn\n∑ t=1 tw k t ( ) + sup v∈V0\nn\n∑ t=1\n( tvt( ) − αv2t ( )) − logN2(γ) α − √ 72 N ∑ k=1 βk √ n logN2(βk) > τ) .\nDefine a distribution p on {1, . . . ,N} by\npk = βk\n√ n logN2(βk)\n∑Nk=1 βj √ n logN2(βj) .\nThen the above probability can be upper bounded by\nP (∃k ∈ [N] s.t. sup wk∈Wk\nn\n∑ t=1 tw k t ( ) −\n√ 72βk √ n logN2(βk) >\nτpk 2\n∨ sup v∈V0\nn\n∑ t=1\n( tvt( ) − αv2t ( )) − logN2(γ) α > τ 2 )\n≤ N\n∑ k=1 P ( sup wk∈Wk\nn\n∑ t=1 tw k t ( ) −\n√ 72βk √ n logN2(βk) >\nτpk 2 )\n+ P (sup v∈V0\nn\n∑ t=1\n( tvt( ) − αv2t ( )) − logN2(γ) α > τ 2 ) .\nThe second term can be upper bounded using Chernoff method by\n∑ v∈V0\nP ( n\n∑ t=1\n( tvt( ) − αv2t ( )) − logN2(γ) α > τ 2 ) ≤ N2(γ) exp(− ατ 2 − logN2(γ)) ≤ exp(− ατ 2 )\nwhile the first sum of probabilities can be upper bounded by\nN\n∑ k=1 ∑ wk∈Wk\nP ⎛ ⎝ n ∑ t=1 tw k t ( ) − √ 72βk √ n logN2(βk) >\nτβk √ n logN2(βk)\n2∑Nk=1 βk √ n logN2(βk)\n⎞ ⎠ . (11)\nFor any k, the tail probability above is controlled by Hoeffding-Azuma inequality as\nP ⎛ ⎜ ⎝ n ∑ t=1 tw k t ( ) > βk √ n logN2(βk) ⎛ ⎝ 6 √ 2 + τ 2∑Nk=1 βk √ n logN2(βk) ⎞ ⎠ 2⎞ ⎟ ⎠\n≤ exp ⎛ ⎜ ⎝ − 1 18 logN2(βk) ⎛ ⎝ 6 √ 2 + τ 2∑Nk=1 βk √ n logN2(βk) ⎞ ⎠ 2⎞ ⎟ ⎠\n≤ exp (−4 logN2(βk)) exp ⎛ ⎜⎜ ⎝ − τ 2 18 (2∑Nk=1 βk √ n logN2(βk)) 2 ⎞ ⎟⎟ ⎠ ,\nbecause 1 n ∑ n t=1 w k t ( )2 ≤ 3β2k for any by triangle inequality (see [24]). Then the double sum in (11) is upper bounded by\nΓ exp ⎛ ⎜⎜ ⎝ − τ 2 18 (2∑Nk=1 βk √ n logN2(βk)) 2 ⎞ ⎟⎟ ⎠ ,\nwhere Γ ≥ ∑Nk=1N2(βk)−2. This upper bound can be further relaxed to\nΓ exp ⎛ ⎜⎜ ⎝ − τ 2 2 (12 ∫ γ 1/n √ n logN2(δ)dδ) 2 ⎞ ⎟⎟ ⎠ .\nSince N = log2(2γn), we may take\nΓ = log2(2γn) ∑ k=1 N2(γ2−k)−2.\nProof of Corollary 6. Let us write N2(γ) ≜ N2(G, γ,z). Observe that\n2 ¿ ÁÁÀ2(logn) (logN2(γ/2))( n\n∑ t=1 g2(zt( )) + 1) = inf α {(logn) (logN2(γ/2)) α + 2α( n ∑ t=1 g2(zt( )) + 1)}\nand, furthermore, the optimal α is ¿ ÁÁÀ(logn) (logN2(γ/2))\n2(∑nt=1 g2(zt( )) + 1)\nwhich is a number between d` = √ (logn)(logN2(γ/2)) 2(n+1) and du = √ (logn) (logN2(γ/2)) as long as N2(γ/2) > 1. With this, we get\nsup g∈G\nγ∈[n−1,1]\nn\n∑ t=1 tg(zt( )) − ⎛ ⎜ ⎝ 4\n¿ ÁÁÀ2(logn) (logN2(γ/2))( n\n∑ t=1\ng2(zt( )) + 1) + 24 √ 2 logn∫ γ\n1/n\n√ n logN2(δ)dδ + 2 logn ⎞ ⎟ ⎠\n≤ sup g∈G\nγ∈[n−1,1],α∈[d`,du]\nn\n∑ t=1\ntg(zt( )) − 2(logn) (logN2(γ/2))\nα − 4α\nn\n∑ t=1\ng2(zt( )) − 24 √ 2 logn∫ γ\n1/n\n√ n logN2(δ)dδ − 2 logn.\n(12)\nThe case of γ ∈ [1/n,2/n) will be considered separately. Let us assume γ ≥ 2/n. We now discretize both α and γ by defining αi = 2−(i−1)du and γj = 2jn−1, i, j ≥ 1. We go to an upper bound by mapping each α to αi or αi/2, depending on the direction of the sign. Similarly, we map γ to either γi or 2γi. The upper bound becomes\nmax i,j sup g∈G\nn\n∑ t=1\n( tg(zt( )) − 2αig2(zt( ))) − (2 logn) ( logN2(γj)\nαi + 12\n√ 2∫ γj\n1/n\n√ n logN2(δ)dδ + 1) .\nGiven the doubling nature of αi and γj , the indices i, j are upper bounded by O(logn). Now define a collection of random variables indexed by (i, j)\nXi,j = sup g∈G\nn\n∑ t=1 tg(zt( )) − 2αig2(zt( ))\nand constants\nBi,j = logN2(γj)\nαi + 12\n√ 2∫ γj\n1/n\n√ n logN2(δ)dδ + 1.\nLemma 5 establishes that\nP (Xi,j −Bi,j > τ) ≤ Γ exp(− τ2 2σ2j ) + exp(−αiτ 2 )\nwhere σj = 12 √\n2 ∫ γj 1 n\n√ n logN2(δ)dδ and Γ as specified in Lemma 5. Whenever δ-entropy grows as δ−p,\nσj ≤ 12 √ 2 √ n, ensuring log(σj/σ1) ≤ log(n). Further, we can take 1 ≤ Γ ≤ log(2n).\nProposition 2 is used with a sequence of random variables, but we can easily put the pairs (i, j) into a vector of size at most log2(n)2. Observe that si = αi/2, (Bi,jsi)−1 ≤ 2, σj/Bi,j ≤ 1, s1/si ≤ √ 2(n + 1). Then, by taking σ̄ = min{1/Γ, σ1} and s̄ = s1,\nθki,j = max{ σj\nBi,j\n√ 2 log(σj/σ̄) + 4 log(ki,j), (Bi,jsi)−1 log (k2i,j(s̄/si))} + 1\n≤ max{ √ 2 log(n) + 2 log(log(2n)) + 4 log(ki,j),2 log (k2i,j √ 2(n + 1))} + 1\nwhere ki,j = (logn) ⋅ (i − 1) + j. This choice of the multiplier ensures\nEmax i,j\n{Xi,j − θki,jBi,j} ≤ 3Γσ̄ + 4α−11 ≤ 7\nand θi,j is shown to be upper bounded by 2 logn. Hence\nE ⎡⎢⎢⎢⎢⎣ sup g∈G,γ n ∑ t=1 tg(zt( )) − 4 ¿ ÁÁÀ2(logn) logN2(γ/2)( n ∑ t=1 g2(zt( )) + 1) − 24 √ 2 logn∫ γ 1/n √ n logN2(δ)dδ ⎤⎥⎥⎥⎥⎦ ≤ 7 + 2 logn.\nNow, consider the case γ ∈ [1/n,2/n). We upper bound (12) by\nmax i sup g∈G\nn\n∑ t=1\n( tg(zt( )) − 2αig2(zt( ))) − (2 logn)( logN2(1/n)\nαi + 1) ,\nwhich is controlled by setting γ = 1/n in Lemma 5. This case is completed by invoking Proposition 2 as before.\nProof of Corollary 7. Assume N > e and let C > 0. We first note that\ninf α>0 ⎧⎪⎪⎪⎨⎪⎪⎪⎩ C log ( √ C logN α ) logN α + α( n ∑ t=1 g2(zt( )) + e logN ) ⎫⎪⎪⎪⎬⎪⎪⎪⎭ ≤ 2 log(logN n ∑ t=1 g2(z( )) + e) ¿ ÁÁÀC(logN n ∑ t=1 g2(z( )) + e)\nwith the inequality obtained using\nα⋆ = √\nC logN\n∑nt=1 g2(z( )) + e/ logN ,\nwhich is a number between d` ≜ √ C logN n+e/logN and du ≜ √ C e logN . Subsequently,\nsup g∈G\nn\n∑ t=1 tg(zt( )) − 2 log(logN\nn\n∑ t=1 g2(z( )) + e)\n¿ ÁÁÀC(logN n\n∑ t=1 g2(z( )) + e)\n≤ sup g∈G\nα∈[d`,du]\n[ n\n∑ t=1 tg(zt( )) − α\nn\n∑ t=1 g2(zt( )) −\nC logN\nα log(\n√ C logN\nα )].\nLet L = ⌈log2( √ n logN e\n+ 1) + 1⌉. We discretize the range of α by defining αi = du2−(i−1) for i ∈ [L]. The following upper bound holds:\nsup g∈G i∈[L]\n[ n\n∑ t=1 tg(zt( )) − αi 2\nn\n∑ t=1 g2(zt( )) −\nC logN\nαi log(\n√ C logN\nαi )].\nDefine a collection of random variables indexed by i ∈ [L] with\nXi = sup g∈G\n[ n\n∑ t=1 tg(zt( )) − αi 2\nn\n∑ t=1 g2(zt( ))]\nand let Bi = 4 logNαi . Applying Lemma 5 with γ = 1/n establishes\nP (Xi −Bi > τ) ≤ exp(− αiτ\n8 ).\nWe now set si = αi/8 and s̄ = s1, and apply Proposition 2, yielding\nE{Xi −Biθi} ≤ 16\n√ e\nC .\nIt remains to relate this quantity to the rate we are trying to achieve. Note that our bound on P (Xi−Bi > τ) has a pure exponential tail, so we only need to consider θi = (Bisi)−1 log(i2(s̄/si)) + 1. Taking C ≥ 32 and observing that (Bisi)−1 ≤ 2, we obtain\nθi = (Bisi)−1 log(i2(s̄/si)) + 1 ≤ 2 log(i2(s̄/si)) + 1 = 2 log(i22i−1) + 1 ≤ 2 log (i22i)\n≤ C 4\nlog( √ C logN\nαi ).\nFinally, we have\nsup g∈G i∈[L]\n[ n\n∑ t=1 tg(zt( )) − αi 2\nn\n∑ t=1 g2(zt( )) −\n32 logN\nαi log(\n√ 32 logN\nαi )] ≤ E{Xi −Biθi} ≤\n√ e\n2 ≤ 1.\nProof of Corollary 8. We prove the corollary for convex Lipschitz loss where we remove the loss function using the symmetrization lemma shown earlier. However even if we consider non-convex classes, the loss is readily removed in the step in the proof below where we apply Lemma 4 where the Lipchitz constant is removed when we move to covering numbers. However this is a well known technique and to make the proof simpler we simply assume convexity of loss as well. Our starting point to proving the bounds is Lemma 1, Eq. (4). To show achievability it suffices to show that\nE ⎡⎢⎢⎢⎢⎢⎣ sup f∈F n ∑ t=1 tf(xt( )) −K1Rn(F(2R(f))) log3/2 n ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Rn(F(2R(f))) Rn(F(R(1))) ) + log(log(2R(f))) ⎞ ⎟ ⎠ ⎤⎥⎥⎥⎥⎥⎦ ≤K2ΓRn(F(1)) log3/2 n\nwhere Γ is the constant that will be inherited from Lemma 4. Define Ri = 2i and note that since the\nRademacher complexity of the class F(R) is non-decreasing with R,\nsup f∈F\nn\n∑ t=1 tf(xt( )) −K1Rn(F(2R(f))) log3/2 n ⎛ ⎜ ⎝ 1 +\n¿ ÁÁÀlog(Rn(F(2R(f)))\nRn(F(1)) ) + log(log(2R(f))) ⎞ ⎟ ⎠\n= sup R≥1 sup f∈F(R)\nn\n∑ t=1 tf(xt( )) −K1Rn(F(2R)) log3/2 n ⎛ ⎜ ⎝ 1 +\n¿ ÁÁÀlog(Rn(F(2R))\nRn(F(1)) ) + log(log(2R)) ⎞ ⎟ ⎠\n≤ max i∈N sup f∈F(Ri)\nn\n∑ t=1 tf(xt( )) −K1Rn(F(Ri)) log3/2 n ⎛ ⎜ ⎝ 1 +\n¿ ÁÁÀlog(Rn(F(Ri))\nRn(F(1)) ) + log(log(Ri)) ⎞ ⎟ ⎠ . (13)\nDenote a shorthand Cn = √\n96 log3(en2) and Din = Rn(F(Ri)). Now note that by Lemma 4 we have that for every i and every θ > 1,\nP ⎛ ⎝ sup f∈F(Ri) ∣ n ∑ t=1 tf(xt( ))∣ > 8 (1 + θCn) ⋅Din) ⎞ ⎠ ≤ 2Γe−3θ 2 .\nLet Xi = supf∈F(Ri) ∣∑ n t=1 tf(xt( ))∣ and let Bi = 8 (1 +Cn) ⋅Din. In this case rewriting the above one sided tail bound appropriately (with θ = 1 + τ/(8CnDin)) we see that for any τ > 0,\nP (Xi −Bi > τ) ≤ 2Γ e3 exp(− τ\n2\n28 log3(en2)R2n(F(Ri)) ) .\nThis establishes one-sided subgaussian tail behavior. Now applying Proposition 2 and setting θi as suggested by the proposition we conclude that\nE ⎡⎢⎢⎢⎢⎢⎣ max i∈N sup f∈F(Ri) n ∑ t=1 tf(xt( ) −K1Rn(F(Ri)) log3/2 n ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Rn(F(Ri))Rn(F(1)) ) + log(log(Ri)) ⎞ ⎟ ⎠ ⎤⎥⎥⎥⎥⎥⎦ ≤K2ΓRn(F(1)) log3/2 n.\nThis concludes the proof by appealing to Eq. (13).\nProof of Achievability for Example 4.2.\nLemma 10. The following bound is achievable in the setting of Example 4.2:\nB(f) =D √ n(8∥f∥(1 + √ log(2∥f∥) + log log(2∥f∥)) + 12).\nThis proof specializes the proof of Corollary 8 to the regime where Lemma 3 applies. Recall our parameterization of F : F(R) = {f ∈ F ∶ ∥f∥ ≤ R}. It was shown in [26] that Cn(F(R)) ≜\n2RD √ n is an upper bound for Rn(F(R)). We consider the rate\nBn(f) = 2Cn(F(2R(f))) ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Cn(F(2R(f)))Cn(F(1)) ) + log log2(2R(f)) ⎞ ⎟ ⎠ .\nWe begin by applying Lemma 1 (5), yielding\nAn ≤ sup y E sup f ⎡⎢⎢⎢⎢⎢⎣ 2 n ∑ t=1 t⟨f,yt( )⟩ − 2Cn(F(2R(f))) ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Cn(F(2R(f)))Cn(F(1)) ) + log log2(2R(f)) ⎞ ⎟ ⎠ ⎤⎥⎥⎥⎥⎥⎦ .\nWe now discretize the range of R via Ri = 2i. By analogy with the proof of Corollary 8 we get the upper bound,\nsup y E sup i∈N ⎡⎢⎢⎢⎢⎢⎣ sup f∈F(Ri) 2 n ∑ t=1 t⟨f,yt( )⟩ − 2Cn(F(Ri)) ⎛ ⎜ ⎝ 1 + ¿ ÁÁÀlog(Cn(F(Ri))Cn(F(1)) ) + log log2(Ri) ⎞ ⎟ ⎠ ⎤⎥⎥⎥⎥⎥⎦\n= sup y E sup i∈N\n[2Ri∥ n\n∑ t=1 tyt( )∥ ⋆ − 4D\n√ nRi √ log(Ri) + log(i)].\nFix a Y-valued tree y and define a set of random variables Xi = 2Ri∥∑nt=1 tyt( )∥⋆. Let Bi = 2D √ nRi. Lemma 3 shows that\nP (Xi −Bi ≥ τ) ≤ 2 exp(− τ2\n8D2R2in ).\nSo we have σi = 2DRi √ n, and it will be sufficient to set σ̄ = 2D√n. Since our tail bound is purely sub-\ngaussian, we apply Proposition 2 with θi = σiBi √ 2 log(σi/σ̄) + 4 log(i) + 1, yielding the following bound:\nsup y E sup i∈N\n[2Ri∥ n\n∑ t=1 tyt( )∥ ⋆ − 4D\n√ nRi √ log(Ri) + log(i)] ≤ 12D √ n.\nProof of Achievability for Example 4.5. Unfortunately, the general symmetrization proof in Lemma 1 does not suffice for this problem. In what follows we use a more specialized symmetrization technique to prove the lemma.\nLemma 11. For any countable class of experts, when we consider F to be the class of all distributions over the set of experts, the following adaptive bound is achievable:\nBn(f ; y1∶n) = ¿ ÁÁÀ50 (KL(f ∣π) + log(n)) n\n∑ t=1 ⟨f, yt⟩ + 50 (KL(f ∣π) + log(n)) + 1.\nTo show that the rate is achievable we need to show that An ≤ 0. Since each ŷt is a distribution over experts and we are in the linear setting, we do not need to randomize in the definition of the minimax value. Let us use the shorthand C(f) = KL(f ∣π) + log(n), and take constants K1,K2 to be determined later. Define\nAn = ⟪ inf ŷt∈∆ sup yt∈Y\n⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ n ∑ t=1 ⟨ŷt, yt⟩ − inf f∈∆ ⎧⎪⎪⎨⎪⎪⎩ n ∑ t=1 ⟨f, yt⟩ + ¿ ÁÁÀKC(f) n ∑ t=1 Ei∼f ⟨ei, yt⟩2 + √ K′C(f) ⎫⎪⎪⎬⎪⎪⎭ ⎤⎥⎥⎥⎥⎦ .\nUsing repeated minimax swap, this expression is equal to\n⟪ sup pt∈∆(Y) inf ŷt∈∆\n⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ n ∑ t=1 ⟨ŷt, yt⟩ − inf f∈∆ ⎧⎪⎪⎨⎪⎪⎩ n ∑ t=1 ⟨f, yt⟩ + ¿ ÁÁÀKC(f) n ∑ t=1 Ei∼f ⟨ei, yt⟩2 + √ K′C(f) ⎫⎪⎪⎬⎪⎪⎭ ⎤⎥⎥⎥⎥⎦\n= ⟪ sup pt∈∆(Y)\nEyt∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ n ∑ t=1 inf ŷt∈∆ Eyt∼pt [⟨ŷt, yt⟩] − inf f∈∆ ⎧⎪⎪⎨⎪⎪⎩ n ∑ t=1 ⟨f, yt⟩ + ¿ ÁÁÀKC(f) n ∑ t=1 Ei∼f ⟨ei, yt⟩2 + √ K′C(f) ⎫⎪⎪⎬⎪⎪⎭ ⎤⎥⎥⎥⎥⎦ .\nBy sub-additivity of square-root, we pass to an upper bound\n⟪sup pt\nEyt∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F n ∑ t=1 inf ŷt∈∆ Eyt∼pt [⟨ŷt, yt⟩] − Eei∼f [⟨ei, yt⟩] − ¿ ÁÁÀC(f)(K n ∑ t=1 Ei∼f [⟨ei, yt⟩2] +K′C(f)) ⎤⎥⎥⎥⎥⎦ .\nWe now split the square root according to the formula √ ab = infα>0 {a/2α + αb/2} and note the range of the optimal value:\n1√ n ≤ α∗ =\n¿ ÁÁÀ C(f)\n(K∑nt=1 Ei∼f [⟨ei, yt⟩ 2] +K′C(f)) ≤ 1√ K′ . (14)\nLet us discretize the interval by setting αi = 1√ K′ 2−(i−1) for i = 1, . . . ,N and note that we only need to take N = O(log(n)) elements. Write I = {α1, . . . , αN}. Observe that\n√ ab = inf\nα>0 {a/2α + αb/2} ≥ min α∈I {a/4α + αb/2} .\nFor the rest of the proof, the maximum over α is taken within the set I. We have\nAn ≤ ⟪sup pt\nEyt∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈∆,α n ∑ t=1 inf ŷt∈∆(F) Eyt [⟨ŷt, yt⟩] − Eei∼f [⟨ei, yt⟩] − α 2 (K n ∑ t=1 Ei∼f [⟨ei, yt⟩2] +K′C(f)) − C(f) 4α ⎤⎥⎥⎥⎥⎦ .\n(15)\nDropping some negative terms, we upper bound the last expression by\n⟪sup pt\nEyt∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F,α n ∑ t=1 ⟨f,E [y′t] − yt⟩ − Kα 2 n ∑ t=1 Ei∼f [⟨ei, yt⟩2] − C(f) 4α ⎤⎥⎥⎥⎥⎦ .\nAdding and subtracting α 4 ∑ n t=1 Ey′t [Ei∼f [⟨ei, y ′ t⟩ 2]],\n≤ ⟪sup pt\nEyt∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F,α n ∑ t=1 ⟨f,E [y′t] − yt⟩ − Kα 4 n ∑ t=1 Ei∼f [⟨ei, yt⟩2] − Kα 4 n ∑ t=1 Ey′t [Ei∼f [⟨ei, y ′ t⟩ 2]]\n+ Kα 4 ( n ∑ t=1 Ey′t [Ei∼f [⟨ei, y ′ t⟩ 2]] − Ei∼f [⟨ei, yt⟩2]) − C(f) 4α ⎤⎥⎥⎥⎥⎦ .\nUsing Jensen’s inequality to pull out expectations, we obtain an upper bound,\n⟪sup pt\nEyt,y′t∼pt⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F,α n ∑ t=1 ⟨f, y′t − yt⟩ − Kα 4 n ∑ t=1 Ei∼f [⟨ei, yt⟩2] − Kα 4 n ∑ t=1 Ei∼f [⟨ei, y′t⟩ 2]\n+ Kα 4 ( n ∑ t=1 Ei∼f [⟨ei, y′t⟩ 2] − Ei∼f [⟨ei, yt⟩2]) − C(f) 4α ⎤⎥⎥⎥⎥⎦ .\nNext, we introduce Rademacher random variables:\n⟪sup pt\nEyt,y′t∼ptE t⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F,α n ∑ t=1 t(⟨f, y′t − yt⟩ + Kα 4 (Ei∼f [⟨ei, y′t⟩ 2] − Ei∼f [⟨ei, yt⟩2]))\n− Kα 4\nn\n∑ t=1\nEi∼f [⟨ei, yt⟩2] − Kα\n4\nn\n∑ t=1\nEi∼f [⟨ei, y′t⟩ 2] − C(f)\n4α ⎤⎥⎥⎥⎥⎦\n≤ ⟪sup yt\nE t⟫ n\nt=1 ⎡⎢⎢⎢⎢⎣ sup f∈F,α n ∑ t=1 t(2⟨f, yt⟩ + Kα 2 Ei∼f [⟨ei, yt⟩2]) − Kα 2 n ∑ t=1 Ei∼f [⟨ei, yt⟩2] − C(f) 4α ⎤⎥⎥⎥⎥⎦ .\nMoving to the tree notation, we get\nsup y E [ sup f∈F,α\nn\n∑ t=1\nt(2⟨f,yt( )⟩ + Kα\n2 Ei∼f [⟨ei,yt( )⟩2]) −\nKα\n2\nn\n∑ t=1\nEi∼f [⟨ei,yt( )⟩2] − KL(f ∣π) 4α − log(n) 4α ] .\nNote that the convex conjugate of KL(f∥π) is given by Ψ∗(X) = 1 α log (Ee∼π [exp (α⟨e,X⟩)]) and we express the last quantity as\nsup y E [max α\n1\n4α log(Ei∼π [exp(\nn\n∑ t=1\nt(8α⟨ei,yt( )⟩ + 2Kα2⟨ei,yt( )⟩2) − 2Kα2 (⟨ei,yt( )⟩)2)]) − log(n)\n4α ] .\nDefine Xα = 14α log (Ei∼π [exp (∑ n t=1 t(8α⟨ei,yt( )⟩ + 2Kα2⟨ei,yt( )⟩ 2) − 2Kα2 (⟨ei,yt( )⟩)2)]). Our goal is to bound E [maxα{Xα − log(n)/4α}]. Now notice that\nP (Xα > t) ≤ inf λ E [eλXα−λt]\n= inf λ ⎧⎪⎪⎨⎪⎪⎩ E ⎡⎢⎢⎢⎢⎣ (Ei∼π [exp( n ∑ t=1 t(8α⟨ei,yt( )⟩ + 2Kα2⟨ei,yt( )⟩2) − 2Kα2⟨ei,yt( )⟩2)]) λ 4α ⎤⎥⎥⎥⎥⎦ exp(−λt) ⎫⎪⎪⎬⎪⎪⎭ ≤ E [Ei∼π [exp( n\n∑ t=1 t(8α⟨ei,yt( )⟩ + 2Kα2⟨ei,yt( )⟩2) − 2Kα2⟨ei,yt( )⟩2)]] exp(−4αt)\n≤ E [Ei∼π [exp( n\n∑ t=1\n(8α⟨ei,yt( )⟩ + 2Kα2⟨ei,yt( )⟩2) 2 − 2Kα2⟨ei,yt( )⟩2)]] exp(−4αt)\n≤ E [Ei∼π [exp( n\n∑ t=1\n4α(4 +Kα)2⟨ei,yt( )⟩2 − 2Kα2⟨ei,yt( )⟩2)]] exp(−4αt).\nThe above term is upper bounded by exp(−4αt) as soon as 4α2(4 +Kα)2 ≤ 2Kα2, which happens when\n0 < α ≤ ( √ K/2 − 4)/K. (16)\nIn view of (14), we know that α ≤ 1√ K′ . Thus, to ensure (16), it is sufficient to take K = 50 and K ′ = 502. Other choices lead to a different balance of constants. We thus have\nP (Xα > t) ≤ exp (−4αt) .\nNow that we have the tail bound, we appeal to Proposition 2. Setting si = 4αi and Bi = 1/4αi, we obtain that\nE [ max i=1,...,N\n{Xαi − log(n)\n4α }] ≤ 10."
    }, {
      "heading" : "B Relaxations and Algorithms",
      "text" : "Proof of Admissibility for Example 5.1.\nLemma 12. The following bound is achievable in the setting given in example 5.1:\nBn(f) = 3 √ 2nmax{KL(f ∣ π),1} + 4 √ n. (17)\nFollowing the analysis style of Corollary 8, we directly consider an upper bound based on KL(f ∣ π) but instead use a complexity-radius-based upper bound with the KL divergence controlling the complexity radius: F(R) = {f ∶ KL(f ∣ π) ≤ R}. Concretely, we move from (17) to the bound\nBn(i) = 3 √ nRi + 4 √ n\nfor Ri = 2i−1 with i ∈ N. To keep the analysis as tidy as possible, we will study the achievability of Bn(i) = D √ Rin, setting D and including additive constants only when we reach a point in the analysis where it becomes necessary to do so. The relaxation we consider is thus\nReln(y1∶t) = inf λ>0 [ 1 λ log(∑ i exp(−λ[ t ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ(n − t)].\nInitial Condition: This inequality follows from Lemma 13 and an application of the softmax function as an upper bound on the supremum over i:\n− inf i ⎡⎢⎢⎢⎣ inf f∈F(Ri) n ∑ t=1 `(f, yt) + Bn(i) ⎤⎥⎥⎥⎦\n= sup i\n[− t\n∑ s=1\n⟨qRis (y1∶s−1), ys⟩ + 2 √ nRi − Bn(i)]\n≤ inf λ>0\n1 λ log(∑\ni\nexp(−λ[ t\n∑ s=1\n⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)]))\n= Reln(y1∶n).\nAdmissibility Condition: Define a strategy q⋆t via\n(q⋆t )i = exp(−λ⋆t [∑t−1s=1⟨qRis (y1∶s−1), ys⟩ − 2\n√ nRi + Bn(i)])\n∑j exp(−λ⋆t [∑t−1s=1⟨q Rj s (y1∶s−1), ys⟩ − 2 √ nRj + Bn(Rj)]) ,\nwhere we have set\nλ⋆t = arg min λ>0 [ 1 λ log(∑ i exp(−λ[ t−1 ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ(n − t + 1)].\nWe proceed to demonstrate admissibility:\ninf qt sup yt\n[⟨qt, yt⟩ +Reln(y1∶t)]\n= inf qt sup yt [⟨qt, yt⟩ + inf λ>0 [ 1 λ log(∑ i exp(−λ[ t ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ(n − t)]].\nWe now plug in q⋆t and λ ⋆ t as described above:\n≤ sup yt [ 1 λ⋆t log(exp(λ⋆tEi∼q⋆t ⟨q Ri t (y1∶t−1), yt⟩)) + 1 λ⋆t log(Ei∼q⋆t exp(−λ ⋆ t ⟨qRit (y1∶t−1), yt⟩))\n+ 1 λ⋆t log(∑ i exp(−λ⋆t [ t−1 ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ⋆t (n − t)].\nWe combine the first two terms in the expression and apply Jensen’s inequality to arrive at an upper bound:\n≤ sup yt [ 1 λ⋆t log(Ei,i′∼q⋆t exp(λ ⋆ t ⟨qRit (y1∶t−1) − q Ri′ t (y1∶t−1), yt⟩))\n+ 1 λ⋆t log(∑ i exp(−λ⋆t [ t−1 ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ⋆t (n − t)].\nThe first term is now bounded using sub-gaussianity.\n≤ 1 λ⋆t log(∑ i exp(−λ⋆t [ t−1 ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ⋆t (n − t + 1)\n= inf λ>0 [ 1 λ log(∑ i exp(−λ[ t−1 ∑ s=1 ⟨qRis (y1∶s−1), ys⟩ − 2 √ nRi + Bn(i)])) + 2λ(n − t + 1)] = Reln(y1∶t−1).\nHaving shown that Reln is an admissible relaxation, it remains to show that the relaxation’s final value,\nReln(⋅) = inf λ>0 [ 1 λ log(∑ i\nexp(λ[2 √ nRi −D √ nRi])) + 2λn]\nis not too large. Setting D = 3,\n= inf λ>0 [ 1 λ log(∑ i\nexp(−λ √ nRi)) + 2λn].\nThe complexity radius Ri is discretized such that Ri −Ri−1 ≥ 1, yielding\n≤ inf λ>0 [ 1 λ\nlog(exp(−λ √ n) + ∞ ∑ i=2 (Ri −Ri−1) exp(−λ √ nRi)) + 2λn]\n≤ inf λ>0 [ 1 λ log(exp(−λ √ n) + ∫ ∞ 1 exp(−λ √ nR)dR) + 2λn].\nThe integral is a routine calculation.\n∫ ∞\n1 exp(−λ\n√ nR)dR = −2 1\nλ2n exp(−λ\n√ nR)[λ √ nR + 1]∣\n∞\n1\n.\nFinally, set λ = 1/√n yielding\nReln(⋅) ≤ 4 √ n.\nNote that instead of setting λt = λ⋆t as described above, we could have set λt = 1/ √ n and achieved the same regret bound.\nLemma 13. Consider the experts setting from Example 4.5, but with hypothesis class F(R) = {f ∶ KL(f ∣ π) ≤ R}. The following inequality holds:\n− inf f∈F(R)\nn\n∑ t=1\n⟨yt, f⟩ ≤ − n\n∑ t=1\n⟨yt, qR(y1∶t−1)⟩ + 2 √ Rn.\nProof. Our strategy is to move to an upper bound based on the Kullback-Leibler divergence and exploit convex duality:\n− inf f∈F(R)\nn\n∑ t=1 ⟨yt, f⟩\n≤ − inf f∈F(R)\n{ n\n∑ t=1 ⟨yt, f⟩ + αKL(f ∣ π)} + αR\n≤ − inf f∈F\n{ n\n∑ t=1 ⟨yt, f⟩ + αKL(f ∣ π)} + αR.\nWe use Ψ⋆ to denote the Fenchel conjugate of KL(⋅ ∣ π):\n= αΨ⋆(− 1 α\nn\n∑ t=1 yt)Ψ + αR.\nThe function KL(⋅ ∣ π) is 1-strongly convex, which implies that Ψ∗ is 1-strongly smooth. We peel off one term at a time:\nαΨ⋆(− 1 α\nn\n∑ t=1 yt) ≤ αΨ⋆(−\n1\nα n−1 ∑ t=1 yt) + ⟨−yn,∇Ψ⋆(− 1 α n−1 ∑ t=1 yt)⟩ + 1 α .\nThis obtains the following upper bound:\n− n\n∑ t=1\n⟨yt,∇Ψ⋆(− 1\nα t−1 ∑ s=1 ys)⟩ + KCn α + αR.\nSetting α = √ n/R and noting that ∇Ψ⋆(− √ R n ∑ t−1 s=1 ys) = qR(y1∶t−1) yields the result.\nProof of Lemma 9. Recall the form of the Adan relaxation, where we have abbreviated Rel R n to R R:\nAdan(y1∶t) = sup y,y′ E sup R\n[RR(y1∶t) −RRθ(RR) + 2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))].\nInitial Condition: This directly follows from the fact that RR satisfy the initial condition:\nAdan(y1∶n) = sup R [RR(y1∶n) −RRθ(RR)]\n≥ sup R ⎡⎢⎢⎢⎣ − inf f∈F(R) n ∑ t=1 `(f, yt) −RRθ(RR) ⎤⎥⎥⎥⎦\n= − inf R inf f∈F(R)\n[ n\n∑ t=1 `(f, yt) +RRθ(RR)].\nTherefore, playing the strategy corresponding to Adan yields an adaptive regret bound of the form Bn(R) = RelRn (⋅)θ(RelRn (⋅)) +Adan(⋅).\nAdmissibility Condition: We obtain the following equalities using the same minimax swap technique as in the Lemma 1 proof:\ninf qt sup yt\nEŷt∼qt[`(ŷt, yt) +Adan(y1∶t)]\n= inf qt sup yt Eŷt∼qt sup y,y′ E sup R\n[`(ŷt, yt) +RR(y1∶t) −RRθ(RR) + 2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))]\n= sup pt Eyt∼pt sup y,y′ E sup R [inf ŷt\nEy′t∼pt`(ŷt, y ′ t) +RR(y1∶t) −RRθ(RR) + 2\nn\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))].\nNote that inf ŷt Ey′t∼pt`(ŷt, y ′ t) = inf qt∈∆(D) Eŷt∼qtEy′t∼pt`(ŷt, y ′ t),\nand we may replace the infimizing distribution with the randomized strategy qRt corresponding to Rel R n . The fact that this strategy depends on y1∶t−1 is left implicit. This yields an upper bound,\nsup pt Eyt∼pt sup y,y′ E sup R\n[Ey′t∼ptEŷt∼qRt `(ŷt, y ′ t) +RR(y1∶t) −RRθ(RR) + 2\nn\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))],\nwhich we can write by adding and subtracting Eŷt∼qRt `(ŷt, yt) as\nsup pt Eyt∼pt sup y,y′ E sup R\n[Ey′t∼ptEŷt∼qRt `(ŷt, y ′ t) −Eŷt∼qRt `(ŷt, yt) +Eŷt∼qRt `(ŷt, yt) +R R(y1∶t) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))] .\nNow, using the fact that RR are admissible,\n≤ sup pt Eyt∼pt sup y,y′ E sup R\n[Ey′t∼ptEŷt∼qRt `(ŷt, y ′ t) −Eŷt∼qRt `(ŷt, yt) +R R(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))] .\nBy Jensen’s inequality, we upper bound the last expression by\nsup pt Eyt,y′t∼pt sup y,y′ E sup R\n[Eŷt∼qRt `(ŷt, y ′ t) −Eŷt∼qRt `(ŷt, yt) +R R(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t,y′t+1∶s−1( ))`(ŷs,ys( ))] .\nWe now replace each choice yt in the last sum by a worst-case choice y ′′ t :\n≤ sup pt Eyt,y′t∼pt sup y′′t sup y,y′ E sup R\n[Eŷt∼qRt `(ŷt, y ′ t) −Eŷt∼qRt `(ŷt, yt) +R R(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t−1,y′′t ,y′t+1∶s−1( ))`(ŷs,ys( ))] .\nWe then introduce t since yt, y ′ t can be renamed. The last expression is equal to\nsup pt Eyt,y′t∼ptE t sup y′′t sup y,y′ E sup R\n[Eŷt∼qRt [ t(`(ŷt, y ′ t) − `(ŷt, yt))] +RR(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t−1,y′′t ,y′t+1∶s−1( ))`(ŷs,ys( ))] .\nBy splitting into two terms we arrive at an upper bound of\nsup pt Eyt∼ptE t sup y′′t sup y,y′ E sup R [2 tEŷt∼qRt [`(ŷt, yt)] +R R(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t−1,y′′t ,y′t+1∶s−1( ))`(ŷs,ys( ))]\n= sup yt E t sup y′′t sup y,y′ E sup R [2 tEŷt∼qRt [`(ŷt, yt)] +R R(y1∶t−1) −RRθ(RR)\n+2 n\n∑ s=t+1 sEŷs∼qRs (y1∶t−1,y′′t ,y′t+1∶s−1( ))`(ŷs,ys( ))]\n= Adan(y1∶t−1)."
    } ],
    "references" : [ {
      "title" : "Minimum contrast estimators on sieves: exponential bounds and rates of convergence",
      "author" : [ "Lucien Birgé", "Pascal Massart" ],
      "venue" : null,
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 1998
    }, {
      "title" : "Adaptive model selection using empirical complexities",
      "author" : [ "Gábor Lugosi", "Andrew B Nobel" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 1999
    }, {
      "title" : "Model selection and error estimation",
      "author" : [ "Peter L. Bartlett", "Stéphane Boucheron", "Gábor Lugosi" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2002
    }, {
      "title" : "Concentration inequalities and model selection, volume",
      "author" : [ "Pascal Massart" ],
      "venue" : null,
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2007
    }, {
      "title" : "Learning without Concentration",
      "author" : [ "Shahar Mendelson" ],
      "venue" : "In Conference on Learning Theory,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2014
    }, {
      "title" : "Learning with square loss: Localization through offset rademacher complexity",
      "author" : [ "Tengyuan Liang", "Alexander Rakhlin", "Karthik Sridharan" ],
      "venue" : "Proceedings of The 28th Conference on Learning Theory,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2015
    }, {
      "title" : "Online nonparametric regression",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan" ],
      "venue" : "Proceedings of The 27th Conference on Learning Theory,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2014
    }, {
      "title" : "Online learning: Random averages, combinatorial parameters, and learnability",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan", "Ambuj Tewari" ],
      "venue" : "In Advances in Neural Information Processing Systems",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2010
    }, {
      "title" : "Extracting certainty from uncertainty: Regret bounded by variation in costs",
      "author" : [ "Elad Hazan", "Satyen Kale" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2010
    }, {
      "title" : "Online optimization with gradual variations",
      "author" : [ "Chao-Kai Chiang", "Tianbao Yang", "Chia-Jung Lee", "Mehrdad Mahdavi", "Chi-Jen Lu", "Rong Jin", "Shenghuo Zhu" ],
      "venue" : "In COLT,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2012
    }, {
      "title" : "Online learning with predictable sequences",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan" ],
      "venue" : "In Proceedings of the 26th Annual Conference on Learning Theory (COLT),",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2013
    }, {
      "title" : "Adaptive subgradient methods for online learning and stochastic optimization",
      "author" : [ "John Duchi", "Elad Hazan", "Yoram Singer" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2011
    }, {
      "title" : "Improved second-order bounds for prediction with expert advice",
      "author" : [ "Nicolo Cesa-Bianchi", "Yishay Mansour", "Gilles Stoltz" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2007
    }, {
      "title" : "A parameter-free hedging algorithm",
      "author" : [ "Kamalika Chaudhuri", "Yoav Freund", "Daniel J Hsu" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2009
    }, {
      "title" : "Unconstrained online linear learning in hilbert spaces: Minimax algorithms and normal approximations",
      "author" : [ "H. Brendan McMahan", "Francesco Orabona" ],
      "venue" : "Proceedings of The 27th Conference on Learning Theory,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2014
    }, {
      "title" : "Prediction, Learning, and Games",
      "author" : [ "Nicolo Cesa-Bianchi", "Gábor Lugosi" ],
      "venue" : null,
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2006
    }, {
      "title" : "Smoothness, low noise and fast rates",
      "author" : [ "Nathan Srebro", "Karthik Sridharan", "Ambuj Tewari" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2010
    }, {
      "title" : "Achieving all with no parameters: Adaptive normalhedge",
      "author" : [ "Haipeng Luo", "Robert E. Schapire" ],
      "venue" : "CoRR, abs/1502.05934,",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2015
    }, {
      "title" : "Second-order quantile methods for experts and combinatorial games",
      "author" : [ "Wouter M. Koolen", "Tim van Erven" ],
      "venue" : "In Proceedings of the 28th Annual Conference on Learning Theory (COLT),",
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 2015
    }, {
      "title" : "Behavior of sequential predictors of binary sequences. In in Trans. 4th Prague Conference on Information Theory, Statistical Decision Functions, Random Processes, pages 263–272",
      "author" : [ "Thomas M. Cover" ],
      "venue" : "Publishing House of the Czechoslovak Academy of Sciences,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 1967
    }, {
      "title" : "Statistical learning theory and sequential prediction",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan" ],
      "venue" : null,
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2012
    }, {
      "title" : "Optimum bounds for the distributions of martingales in banach spaces",
      "author" : [ "Iosif Pinelis" ],
      "venue" : "The Annals of Probability, 22(4):1679–1706,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 1994
    }, {
      "title" : "Online learning: Beyond regret",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan", "Ambuj Tewari" ],
      "venue" : "arXiv preprint arXiv:1011.3168,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2010
    }, {
      "title" : "Sequential complexities and uniform martingale laws of large numbers",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan", "Ambuj Tewari" ],
      "venue" : "Probability Theory and Related Fields,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2014
    }, {
      "title" : "Regret to the best vs. regret to the average",
      "author" : [ "Eyal Even-Dar", "Michael Kearns", "Yishay Mansour", "Jennifer Wortman" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Oracle inequalities and model selection have been topics of intense research in statistics in the last two decades [1, 2, 3].",
      "startOffset" : 115,
      "endOffset" : 124
    }, {
      "referenceID" : 1,
      "context" : "Oracle inequalities and model selection have been topics of intense research in statistics in the last two decades [1, 2, 3].",
      "startOffset" : 115,
      "endOffset" : 124
    }, {
      "referenceID" : 2,
      "context" : "Oracle inequalities and model selection have been topics of intense research in statistics in the last two decades [1, 2, 3].",
      "startOffset" : 115,
      "endOffset" : 124
    }, {
      "referenceID" : 3,
      "context" : "In order to select a good model in a data-driven manner, one first establishes non-asymptotic data-dependent bounds on the fluctuations of an empirical process indexed by elements in each model (see the monograph [4]).",
      "startOffset" : 213,
      "endOffset" : 216
    }, {
      "referenceID" : 4,
      "context" : "This realization is motivated by the recent work of [5, 6, 7].",
      "startOffset" : 52,
      "endOffset" : 61
    }, {
      "referenceID" : 5,
      "context" : "This realization is motivated by the recent work of [5, 6, 7].",
      "startOffset" : 52,
      "endOffset" : 61
    }, {
      "referenceID" : 6,
      "context" : "This realization is motivated by the recent work of [5, 6, 7].",
      "startOffset" : 52,
      "endOffset" : 61
    }, {
      "referenceID" : 6,
      "context" : "At the high level, our approach will be to develop one-sided inequalities for the suprema of certain offset processes [7], with an offset that is chosen to be “slightly larger” than the complexity of the corresponding model.",
      "startOffset" : 118,
      "endOffset" : 121
    }, {
      "referenceID" : 7,
      "context" : "For example, sequential Rademacher complexity of F is one of the tightest achievable uniform rates for a variety of loss functions [8, 7].",
      "startOffset" : 131,
      "endOffset" : 137
    }, {
      "referenceID" : 6,
      "context" : "For example, sequential Rademacher complexity of F is one of the tightest achievable uniform rates for a variety of loss functions [8, 7].",
      "startOffset" : 131,
      "endOffset" : 137
    }, {
      "referenceID" : 8,
      "context" : "An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.",
      "startOffset" : 42,
      "endOffset" : 57
    }, {
      "referenceID" : 9,
      "context" : "An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.",
      "startOffset" : 42,
      "endOffset" : 57
    }, {
      "referenceID" : 10,
      "context" : "An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.",
      "startOffset" : 42,
      "endOffset" : 57
    }, {
      "referenceID" : 11,
      "context" : "An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.",
      "startOffset" : 42,
      "endOffset" : 57
    }, {
      "referenceID" : 12,
      "context" : "An incomplete list of prior work includes [9, 10, 11, 12], couched in the setting of online linear/convex optimization, and [13] in the experts setting.",
      "startOffset" : 124,
      "endOffset" : 128
    }, {
      "referenceID" : 13,
      "context" : "The present paper was partly motivated by the work of [14] who presented an algorithm that competes with all experts simultaneously, but with varied regret with respect to each of them, depending on the quantile of the expert.",
      "startOffset" : 54,
      "endOffset" : 58
    }, {
      "referenceID" : 14,
      "context" : "The work of [15] considers online linear optimization with an unbounded set and provides oracle inequalities with an appropriately chosen function Bn(f).",
      "startOffset" : 12,
      "endOffset" : 16
    }, {
      "referenceID" : 16,
      "context" : "4], [17, 13]) fall in this category trivially, since one may overbound the loss of the best function by the performance of f .",
      "startOffset" : 4,
      "endOffset" : 12
    }, {
      "referenceID" : 12,
      "context" : "4], [17, 13]) fall in this category trivially, since one may overbound the loss of the best function by the performance of f .",
      "startOffset" : 4,
      "endOffset" : 12
    }, {
      "referenceID" : 17,
      "context" : "We would like to draw attention to the recent result of [18] who show an adaptive bound in terms of both the loss of comparator and the KL divergence between the comparator and some pre-fixed prior distribution over experts.",
      "startOffset" : 56,
      "endOffset" : 60
    }, {
      "referenceID" : 18,
      "context" : "An MDL-style bound in terms of the variance of the loss of the comparator (under the distribution induced by the algorithm) was recently given in [19].",
      "startOffset" : 146,
      "endOffset" : 150
    }, {
      "referenceID" : 19,
      "context" : "Our study was also partly inspired by Cover [20] who characterized necessary and sufficient conditions for achievable bounds in prediction of binary sequences.",
      "startOffset" : 44,
      "endOffset" : 48
    }, {
      "referenceID" : 19,
      "context" : "The methods in [20], however, rely on the structure of the binary prediction problem and do not readily generalize to other settings.",
      "startOffset" : 15,
      "endOffset" : 19
    }, {
      "referenceID" : 6,
      "context" : "It should be noted that while existing literature on adaptive online learning has focused on simple hypothesis classes such as finite experts and finite-dimensional p-norm balls, our results extend to general hypothesis classes, including large nonparametric ones discussed in [7].",
      "startOffset" : 277,
      "endOffset" : 280
    }, {
      "referenceID" : 20,
      "context" : ", n rounds (see [21]).",
      "startOffset" : 16,
      "endOffset" : 20
    }, {
      "referenceID" : 7,
      "context" : ", Bn(f ;x1∶n, y1∶n) = Bn, achievability reduces to the minimax analysis explored in [8].",
      "startOffset" : 84,
      "endOffset" : 87
    }, {
      "referenceID" : 7,
      "context" : "We first show that the minimax value is bounded by an offset version of the sequential Rademacher complexity studied in [8].",
      "startOffset" : 120,
      "endOffset" : 123
    }, {
      "referenceID" : 21,
      "context" : "A simple yet powerful example for the control of the supremum of a stochastic process is an inequality due to Pinelis [22] for the norm (which can be written as a supremum over the dual ball) of a martingale in a 2-smooth Banach space.",
      "startOffset" : 118,
      "endOffset" : 122
    }, {
      "referenceID" : 23,
      "context" : "Instead, we make use of the following result from [24] that extends Lemma 3 at a price of a poly-logarithmic factor.",
      "startOffset" : 50,
      "endOffset" : 54
    }, {
      "referenceID" : 23,
      "context" : "Before stating the lemma, we briefly define the relevant complexity measures (see [24] for more details).",
      "startOffset" : 82,
      "endOffset" : 86
    }, {
      "referenceID" : 23,
      "context" : "Lemma 4 ([24]).",
      "startOffset" : 9,
      "endOffset" : 13
    }, {
      "referenceID" : 6,
      "context" : "The behavior of this offset process was shown to govern the optimal rates of convergence for online nonparametric regression [7].",
      "startOffset" : 125,
      "endOffset" : 128
    }, {
      "referenceID" : 21,
      "context" : "To prove it, we use the concentration bound from [22] (Lemma 3) within the proof of the above corollary to remove the extra logarithmic factors.",
      "startOffset" : 49,
      "endOffset" : 53
    }, {
      "referenceID" : 14,
      "context" : "For the case of a Hilbert space, the above bound was achieved by [15].",
      "startOffset" : 65,
      "endOffset" : 69
    }, {
      "referenceID" : 17,
      "context" : "This example subsumes and improves upon the recent results from [18, 14] and provides an exact analogue to the PAC Bayesian theorem from statistical learning.",
      "startOffset" : 64,
      "endOffset" : 72
    }, {
      "referenceID" : 13,
      "context" : "This example subsumes and improves upon the recent results from [18, 14] and provides an exact analogue to the PAC Bayesian theorem from statistical learning.",
      "startOffset" : 64,
      "endOffset" : 72
    }, {
      "referenceID" : 24,
      "context" : "This extends the study of [25] to supervised learning and a general class of experts F .",
      "startOffset" : 26,
      "endOffset" : 30
    }, {
      "referenceID" : 17,
      "context" : "This is an improvement over the bound in [18] in that the bound is independent of number of experts, and thus holds even for countably infinite sets of experts.",
      "startOffset" : 41,
      "endOffset" : 45
    }, {
      "referenceID" : 18,
      "context" : "The KL term in our bound may be compared to the MDL-style term in the bound of [19].",
      "startOffset" : 79,
      "endOffset" : 83
    }, {
      "referenceID" : 13,
      "context" : "If we have a large (but finite) number of experts and take the uniform distribution π, the above bound provides an improvement over both [14] and [18] for quantile bounds for experts.",
      "startOffset" : 137,
      "endOffset" : 141
    }, {
      "referenceID" : 17,
      "context" : "If we have a large (but finite) number of experts and take the uniform distribution π, the above bound provides an improvement over both [14] and [18] for quantile bounds for experts.",
      "startOffset" : 146,
      "endOffset" : 150
    }, {
      "referenceID" : 12,
      "context" : "Evaluating the above bound with a distribution f that places all its weight on any one expert appears to address the open question posed by [13] of obtaining algorithm-independent oracle-type variance bounds for experts.",
      "startOffset" : 140,
      "endOffset" : 144
    }, {
      "referenceID" : 0,
      "context" : "[1] Lucien Birgé, Pascal Massart, et al.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 1,
      "context" : "[2] Gábor Lugosi and Andrew B Nobel.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 2,
      "context" : "[3] Peter L.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 3,
      "context" : "[4] Pascal Massart.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 4,
      "context" : "[5] Shahar Mendelson.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 5,
      "context" : "[6] Tengyuan Liang, Alexander Rakhlin, and Karthik Sridharan.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 6,
      "context" : "[7] Alexander Rakhlin and Karthik Sridharan.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 7,
      "context" : "[8] Alexander Rakhlin, Karthik Sridharan, and Ambuj Tewari.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 8,
      "context" : "[9] Elad Hazan and Satyen Kale.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 9,
      "context" : "[10] Chao-Kai Chiang, Tianbao Yang, Chia-Jung Lee, Mehrdad Mahdavi, Chi-Jen Lu, Rong Jin, and Shenghuo Zhu.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 10,
      "context" : "[11] Alexander Rakhlin and Karthik Sridharan.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 11,
      "context" : "[12] John Duchi, Elad Hazan, and Yoram Singer.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 12,
      "context" : "[13] Nicolo Cesa-Bianchi, Yishay Mansour, and Gilles Stoltz.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 13,
      "context" : "[14] Kamalika Chaudhuri, Yoav Freund, and Daniel J Hsu.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 14,
      "context" : "[15] H.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 15,
      "context" : "[16] Nicolo Cesa-Bianchi and Gábor Lugosi.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 16,
      "context" : "[17] Nathan Srebro, Karthik Sridharan, and Ambuj Tewari.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 17,
      "context" : "[18] Haipeng Luo and Robert E.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 18,
      "context" : "[19] Wouter M.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 19,
      "context" : "[20] Thomas M.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 20,
      "context" : "[21] Alexander Rakhlin and Karthik Sridharan.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 21,
      "context" : "[22] Iosif Pinelis.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 22,
      "context" : "[23] Alexander Rakhlin, Karthik Sridharan, and Ambuj Tewari.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 23,
      "context" : "[24] Alexander Rakhlin, Karthik Sridharan, and Ambuj Tewari.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 24,
      "context" : "[25] Eyal Even-Dar, Michael Kearns, Yishay Mansour, and Jennifer Wortman.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 23,
      "context" : "To this end on similar lines as in [24, 7, 21], we start with the inner most term as,",
      "startOffset" : 35,
      "endOffset" : 46
    }, {
      "referenceID" : 6,
      "context" : "To this end on similar lines as in [24, 7, 21], we start with the inner most term as,",
      "startOffset" : 35,
      "endOffset" : 46
    }, {
      "referenceID" : 20,
      "context" : "To this end on similar lines as in [24, 7, 21], we start with the inner most term as,",
      "startOffset" : 35,
      "endOffset" : 46
    }, {
      "referenceID" : 23,
      "context" : "Compactness of the sets and lower semi-continuity of the losses and Bn are sufficient, but see [24, 21] for milder conditions.",
      "startOffset" : 95,
      "endOffset" : 103
    }, {
      "referenceID" : 20,
      "context" : "Compactness of the sets and lower semi-continuity of the losses and Bn are sufficient, but see [24, 21] for milder conditions.",
      "startOffset" : 95,
      "endOffset" : 103
    }, {
      "referenceID" : 20,
      "context" : "See [21] for more details of the steps involved in obtaining the above equality.",
      "startOffset" : 4,
      "endOffset" : 8
    }, {
      "referenceID" : 6,
      "context" : "To prove the bound in Equation 3, note that, Bn(f ;x1∶n, y1∶n) = Bn(y1∶n) and so, (this proof is similar in spirit to the one in [7])",
      "startOffset" : 129,
      "endOffset" : 132
    }, {
      "referenceID" : 23,
      "context" : "because 1 n ∑ n t=1 w k t ( ) ≤ 3β k for any by triangle inequality (see [24]).",
      "startOffset" : 73,
      "endOffset" : 77
    } ],
    "year" : 2015,
    "abstractText" : "We propose a general framework for studying adaptive regret bounds in the online learning framework, including model selection bounds and data-dependent bounds. Given a dataor model-dependent bound we ask, “Does there exist some algorithm achieving this bound?” We show that modifications to recently introduced sequential complexity measures can be used to answer this question by providing sufficient conditions under which adaptive rates can be achieved. In particular each adaptive rate induces a set of so-called offset complexity measures, and obtaining small upper bounds on these quantities is sufficient to demonstrate achievability. A cornerstone of our analysis technique is the use of one-sided tail inequalities to bound suprema of offset random processes. Our framework recovers and improves a wide variety of adaptive bounds including quantile bounds, second-order data-dependent bounds, and small loss bounds. In addition we derive a new type of adaptive bound for online linear optimization based on the spectral norm, as well as a new online PAC-Bayes theorem that holds for countably infinite sets.",
    "creator" : "LaTeX with hyperref package"
  }
}