{
  "name" : "1409.0768.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "A Novel Semi-Supervised Algorithm for Rare Prescription Side Effect Discovery",
    "authors" : [ "Jenna Reps", "Jonathan M. Garibaldi", "Uwe Aickelin", "Daniele Soria", "Jack E. Gibson", "Richard B. Hubbard" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "Drugs are frequently prescribed to patients with the aim of improving each patient’s medical state, but an unfortunate consequence of most prescription drugs is the occurrence of undesirable side effects. Side effects that occur in more than one in a thousand patients are likely to be signalled efficiently by current drug surveillance methods, however, these same methods may take decades before generating signals for rarer side effects, risking medical morbidity or mortality in patients prescribed the drug while the rare side effect is undiscovered. In this paper we propose a novel computational meta-analysis framework for signalling rare side effects that integrates existing methods, knowledge from the web, metric learning and semi-supervised clustering. The novel framework was able to signal many known rare and serious side effects for the selection of drugs investigated, such as tendon rupture when prescribed Ciprofloxacin or Levofloxacin, renal failure with Naproxen and depression associated with Rimonabant. Furthermore, for the majority of the drug investigated it generated signals for rare side effects at a more stringent signalling threshold than existing methods and shows the potential to become a fundamental part of post marketing surveillance to detect rare side effects.\nIndex Terms\nAdverse Drug Reaction, THIN, Semi-Supervised Clustering, MUTARA, Observed Expected Ratio\nSeptember 3, 2014 DRAFT\n2 A Novel Semi-Supervised Algorithm for Rare\nPrescription Side Effect Discovery\nI. INTRODUCTION\nNegative side effects caused by prescribed medication currently present a huge burden for the healthcare service in terms of causing both patient morbidity or mortality and costing large sums of money [1] [2] [3]. Investigations have shown that the rate of unwanted side effects has been increasing annually [4] [5]. Possible reasons for this are an increase in the number of annual prescriptions due to an aging population or an increase in polypharmacy, when numerous drugs are prescribed at the same time [6]. Although it is common for a patient to develop side effects due to prescribed medication there is currently no efficient means of identifying all the side effects of a drug. When the side effect is detrimental to the patient’s quality of life, it is often referred to as an Adverse Drug Event (ADE) and when the drug causing the ADE is known, it is termed an Adverse Drug Reaction (ADR). A study conducted in the UK between November 2001 to April 2002 indicated that 6.5% of admissions to hospital were due to ADRs, with the mortality rate for an ADR patient of 2.3% [7]. Interestingly, it was found that over 70% of these ADRs were potentially avoidable. A more recent study in Brazil suggests ADRs may be the cause of an even higher proportion of hospital admissions for the elderly as it showed that ADRs were the cause of hospitalisation for over 50% of elderly patients [8]. It also highlighted that a significant factor for developing an ADR was polypharmacy [8], when patients are prescribed multiple drugs.\nSome obvious ADRs can be discovered during the experimental stages of a drug’s development, but the occurrence of an ADR can depend on a magnitude of factors and it is impossible to investigate all the possible situations that may occur when the drug is taken. For example, testing for ADRs that result from polypharmacy would require clinical trials with millions of people to be able to investigate all the different drug combinations and this is not possible. Due to the limitations of clinical trials, rare ADRs, including fatal ones, are in most circumstances not discovered before a drug is marketed [9] [10]. As a consequence, after a drug is approved and available to patients, possible ADRs are investigated during the whole lifetime of a drug by a process known as post-marketing drug surveillance.\nPost-marketing surveillance (such as doctors being vigilant and noticing possible drug and illness associations) can identify common ADRs and in general the more common the ADR is, the fewer the number of patients that need to be prescribed the drug before it is discovered. However, ADRs that\nSeptember 3, 2014 DRAFT\n3 occur for drugs that are rarely prescribed or rare ADRs may go unnoticed by medical practitioners and may cause morbidity or mortality in patients that could have been prevented with more efficient drug surveillance methods. For example, it took 23 years before there was sufficient evidence that the drug Tamoxifen used to treat breast cancer caused endometrial cancer in about 1 in 6000 patients [11] [12].\nCurrent methods to discover rare ADRs often involve using a Spontaneous Reporting System (SRS) database that contains a collection of voluntary suspected drug and ADR reports, such as the database containing information from the UK yellow card scheme. The algorithms that signal ADRs by mining SRS databases calculate a measure of how disproportionally more often the medical event is reported with a specific drug of interest compared with any drug. The frequently implemented measures of disproportionality involve using standard epidemiology measures [13], estimating the information component using a neural network approach [14] or calculating a modified version of the relative risk by applying a Bayesian model [15]. SRS databases combine reports of possible ADRs from a large population enabling the identification of possible ADR signals more efficiently, but they are known to suffer from underreporting [16] and this causes a lag in the time it takes to confidently signal a potential ADR. The under-reporting may also prevent the detection of rare ADRs, as these ADRs may never be suspected and therefore never be reported to an SRS database.\nA potential new way to detect the rare ADRs that cannot be identified by doctors or by current methods applied to SRS databases is to use The Health Improvement Network (THIN) database (www.thinuk.co.uk), an Electronic Healthcare Database (EHD) containing complete UK General Practice records for registered patients. The THIN database contains all medical events (such as illnesses, laboratory results, signs and symptoms or administrative events) that a doctor is informed of for a patient as well as their complete prescription histories. Therefore, any rare ADRs that are serious enough to be reported to a doctor are more likely to be detected at an earlier point in time by applying a suitable data mining method on the THIN database rather than mining the SRS databases.\nExisting methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22]. As EHDs do not contain links between drugs and suspected ADRs these are often inferred by investigating medical events that occur within some time period around a drug, but many of these medical events are linked to the cause of taking the drug and these ‘therapeutically related’ medical events present a major issue with the majority of the existing methods. It has been demonstrated that these existing methods are currently not suitable for signalling rare ADRs [23]. However, it is the rare\nSeptember 3, 2014 DRAFT\n4 ADRs that are unlikely to be detected by mining SRS databases, due to under-reporting, so developing an algorithm that can signal rare ADRs using the THIN database would be beneficial.\nIn this paper we develop a novel computational meta-analysis framework that integrates the existing methods (MUTARA, HUNT, OE ratio, see section III-A) and uses information obtained from the internet to efficiently and accurately identify rare ADRs that occur immediately or shortly after a drug is prescribed. The framework uses the dependency measures obtained from some of the existing electronic healthcare based methods and novel values of interest as attributes for each medical event that occurs within a 30 day period after the drug of interest is prescribed for any patient. After the attributes are generated for each medical event we label some of the medical events by extracting information from the internet informing us of the indicator events and known ADRs for the drug of interest. The unlabelled medical events then have labels assigned by applying metric learning and semi-supervised clustering. Finally using the labels we develop a novel filter that removes medical events labelled as indicator events and then return the remaining medical events ordered by how often they occurred unpredictably within 30 days after the drug being investigated multiplied by weights based on their assigned labels.\nThe continuation of this paper is as follows, section II contains the background information on the THIN database and section III describes the problem formulation. This is followed by the description of the novel methodology we developed that is able to identify rare ADRs in section IV. Section V contains the results of comparing our novel algorithm with a section of existing methods for the detection of known rare ADRs and the discussion of these results is contained in section VI. The paper finishes with the conclusion and future work suggestions in section VII."
    }, {
      "heading" : "II. THIN DATABASE",
      "text" : "The THIN database contains complete medical and prescription records for registered patients at participating general practices within the UK. The medical information is recorded into the THIN database by Read Codes that correspond to illnesses, so each Read Code is paired with the illness description.\nEach Read Code is five elements long and the Read Codes have a tree structure. A level one Read Code has ‘.’ as it’s second element and corresponds to a very general description of an illness, for example ‘A....’ is a level one Read Code that corresponds to ‘Infections’. A level two Read Code has ‘.’ for it’s third element but not for it’s second element, an example is ‘A1...’ corresponding to ‘Tuberculosis’. A level two Read Code is the child of the level one Read Code with a matching first element, so ‘A1...’ is the child of ‘A....’ (or A....’ is the parent of ‘A1...’) and a child Read Code corresponds to a more specific\nSeptember 3, 2014 DRAFT\n5\nversion of it’s parent’s illness. Fig (1) shows examples of different branches of the Read Code tree with the illness becoming more specific as the Read Code level increases.\nEach drug is recorded into the THIN database by a drugcode (sometimes called the multilexeid) that is paired to the generic name. The drugcode consists of nine numbers and does not have a structure we use but the drugcode does specify the way the drug is ingested and the dosage. Each entry also includes the date that a Read Code or drugcode is recorded but does not contain the time. In this paper we used a subset of the THIN database containing records from 495 general practices. The subset contained approximately four million patients, over 358 million prescription entries and over 233 million medical event entries.\nPatients can register at a new practice at any point over their lifetime and it has been shown that statistical studies using the THIN database will be biased if records from the first year after registration for a patient are included in the study [24]. The reason for this is that newly registered patients will need to inform their new doctor of any chronic illnesses they have, but these illnesses will be recorded on the day they inform the doctor of them rather than the actual day they were discovered. To prevent bias in this study we do not include the first year of a patient’s medical records since registration. We also ignore the last 30 days of prescription records for each patient to reduce potential under reporting that may occur by including patients with less than 30 days of medical records after the first prescription of a drug.\nSeptember 3, 2014 DRAFT\n6"
    }, {
      "heading" : "III. PROBLEM FORMULATION",
      "text" : "The focus of this paper is to develop a method for detecting rare ADRs that occur shortly after prescription, so we can restrict our attention to the medical events that occur around the time of the drug prescription. In this paper we consider the natural numbers N to include 0 and use the interval [a...b] to be the interval of natural numbers from a to b ({n ∈ N : a ≤ n ≤ b}).\nIf we let M denote the set of Read Codes, D denote the set of drugcodes and Ω denote the set of patients in the THIN database then the sequence of Read Codes or the sequence of drugcodes for a patient can be represented as two discrete functions. The discrete function representing a patient’s Read Code sequence is a mapping fM : N × Ω → P(M); fM (t, ω) → eω,t where t is the age in days of the patient ω and eω,t is the set of Read Codes that are recorded into the THIN database for patient ω when they are t days old. Similarly, the discrete function representing a patient’s drugcode sequence is fD : N × Ω → P(D); fD(t, ω) → dω,t where dω,t is the set of drugcodes recorded in THIN for the patient ω when they are t days old.\nSeptember 3, 2014 DRAFT\n7 Using the example THIN database entries shown in Table I, we have,\nM = {A123., B21., C1..., C11.., C12.., C121., D25.., F1..., F12..}\nD = {979596759, 969686881, 912314611}\nΩ = {jj3, aa2, bb8}\n(1)\nThe set of Read Codes that patient jj3 has recorded when he is 9999, 10000 and 10002 days old are fM (9999, jj3) = {A123.}, fM (10000, jj3) = {F1..., C1...} and fM (10002, jj3) = {} = ∅ respectively. The reason fM (10002, jj3) = {} = ∅ is that patient jj3 does not have a Read Code recorded when he is 10002 days old. Similarly, the set of drugcodes that patient jj3 has recorded when he is 10000 and 10002 days old are fD(10000, jj3) = {979596759} and fD(10002, jj3) = {} = ∅ respectively.\nThe set consisting of every age in days where patient ω has a drugcode recorded into the THIN\ndatabase is,\nAD(ω) = {t|fD(t, ω) 6= ∅} (2)\nThe set of all drugs that are prescribed for patient ω is the finite union of the set of drugcodes recorded\ndaily for the patient while they are active in the THIN database, ∪fD(t, ω) t∈AD(ω) , so to determine the age that patient ω is first prescribed the drug of interest d∗ ∈ D we first find the set of ages that the patient was prescribed the drug,\nα(ω, d∗) = {t ∈ AD(ω)|d∗ ∈ fD(t, ω)} (3)\nand then define a new function α1 : Ω×D → N ∪ {−1} :\nα1(ω, d∗) =  min(α(ω, d∗)) if d∗ ∈ ∪ t∈AD(ω) fD(t, ω) −1 else (4)\nthat finds the minimum age that the patient is prescribed the drug or returns −1 if the patient has never been prescribed the drug. The set of patient’s ages where the drug is prescribed for the first time in 13 months is determined by the function α̂ : Ω×D → P(N ∪ {−1}),\nα̂(ω, d∗) = {t ∈ α(ω, d∗)|(t− s∗) ≥ 386, s∗ = argmin s∈α(ω,d∗)\ns<t\n(t− s)} ∪ α1(ω, d∗) (5)\nIf a patient is not prescribed the drug then the function returns −1 otherwise it returns the set of ages in days that the patient took the drug and had a minimum of 386 days between previously taking the drug.\nFor the example entries in Table I, the set of ages in days that patient jj3 is prescribed any drugs is AD(jj3) = {10000, 20000, 20001} and the set of ages in days that the patient is prescribed the\nSeptember 3, 2014 DRAFT\n8 specific drugs 979596759 and 969686881 is α(jj3, 979596759) = {10000} and α(jj3, 969686881) = {20000, 20001} respectively. The minimum age that patient jj3 is prescribed 969686881 is α1(jj3, 969686881) = 20000 but as the patient aa2 is never prescribed the drug 969686881, α1(aa2, 969686881) = −1. The patient aa2 is prescribed the drug 912314611 four times (α(aa2, 912314611) = {15001, 15031, 15061, 25304}) with the first prescription occurring at 15001 days old (α1(aa2, 912314611) = 15001) but the drug was then repeated monthly two times and then the patient had a 10243 day break before being prescribed the drug for the final time, therefore the set of ages in days that patient aa2 is prescribed drug 912314611 for the first time in 13 months is α̂(aa2, 912314611) = {15001, 25304} as the instances when the drug was repeated after 30 days are not included.\nIn the continuation of this paper we will use α̂(ω, d∗)k to refer to the kth time patient ω is prescribed drug d∗ for the first time in 13 months, so α̂(ω, d∗)1 < α̂(ω, d∗)2 < ... < α̂(ω, d∗)n−1 < α̂(ω, d∗)n, where n is the total number of times patient ω is prescribed drug d∗ for the first time in 13 months (n = |α̂(ω, d∗)|). Following on with our example, α̂(aa2, 912314611)1 = 15001 and α̂(aa2, 912314611)2 = 25304.\nThis then enables us to define a interval of interest around each time the patient is prescribed a drug\nfor the first time in 13 months, for each K ≤ |α̂(ω, d∗)|,\nT (ω, d∗, t1, t2)K = [(α̂(ω, d∗)K + t1)...(α̂(ω, d∗)K + t2)] if α̂(ω, d∗)K 6= −1∅ else (6) Equation (6) is defining a time interval centred around the Kth time drug d∗ is prescribed for the first time in 13 months for patient ω determine by the integers t1 and t2. For example, if we wanted to investigate the 30 days after a prescription we would use t1 = 1 and t2 = 30 and the time period around the first prescriptions in 13 months of drug 912314611 for patient aa2 would be T (aa2, 912314611, 1, 30)1 = [(α̂(aa2, 912314611)1+1)...(α̂(aa2, 912314611)1+30)] = [(15001+1)...(15001+30)] = [(15002)...(15031)] and T (aa2, 912314611, 1, 30)2 = [(α̂(aa2, 912314611)2 + 1)...(α̂(aa2, 912314611)2 + 30)] = [(25304 + 1)...(25304 + 30)] = [(25305)...(25334)]. If the patient is never prescribed the drug then the time period of interest is the empty set, for example T (aa2, 979596759, 1, 30)1 = ∅.\nAs the function fM (t, ω) returns a set of Read Codes that are recorded into the THIN database for patient ω when they are t days old, we can find the set of ages in days that ω has any Read Code recorded,\nAM (ω) = {t|fM (t, ω) 6= ∅} (7)\nSeptember 3, 2014 DRAFT\n9 and the finite union over each t ∈ AM (ω), ∪fM (t, ω) t∈AM (ω) , is the set of all Read Codes that are recorded into the THIN database for the patient ω. It follows that ∪fM (t, ω) t∈T (ω,d∗,t1,t2)K is the set of all Read Codes that are recorded into the THIN database for the patient ω during the period of interest determined by t1 and t2 around the Kth prescription of drug d∗. The function h : M ×D × Ω× Z2 → {0, 1},\nh(ei, d∗, ω, t1, t2) = 1{ei ∈ ∪ t∈T (ω,d∗,t1,t2)1 fM (t, ω)} (8)\nis one if the patient ω has the Read Code ei recorded within the time period of interest around the first prescription of drug d∗ and zero otherwise. To determine the number of times the drug d∗ is prescribed to patient ω for the first time in 13 months and the Read Code ei is recorded within the time period of interest we define another function ĥ : M ×D × Ω× Z2 → N,\nĥ(ei, d∗, ω, t1, t2) = ∑\nK≤|α̂(ω,d∗)|\n1{ei ∈ ∪ t∈T (ω,d∗,t1,t2)K fM (t, ω)} (9)\nThe total number of patients in the THIN database that have Read Code ei recorded within the time\nperiod of interest centred around the first prescription of drug d∗ is then,∑ ω∈Ω h(ei, d∗, ω, t1, t2) (10)\nand the total number of first times prescriptions of drug d∗ in 13 months where the Read Code ei is\nrecorded within the time period centred around the prescription determined by t1 and t2 is,∑ ω∈Ω ĥ(ei, d∗, ω, t1, t2) (11)"
    }, {
      "heading" : "A. Existing Algorithms",
      "text" : "The observed to expected (OE) ratio [17] calculates the information component (IC) that looks at the disproportionality between how often a Read Code is recorded within some time period after the first prescription in 13 months of the drug of interest compared to how often it is recorded within the same time period after the first prescription in 13 months of any drug but also adds a bias lowering the IC value if the Read Code or drug is rare.\nThe function used to test if a set of medical events is empty is, Ĥ : P(M)→ {0, 1},\nĤ[B] = 0 if B = ∅1 else (12)\nSeptember 3, 2014 DRAFT\n10\nusing the above function, we define the following values, nd∗ei(t1, t2) = ∑ ω∈Ω ĥ(ei, d∗, ω, t1, t2)\nn•ei(t1, t2) = ∑ d∈D ∑ ω∈Ω ĥ(ei, d, ω, t1, t2) nd∗•(t1, t2) = ∑ ω∈Ω |α̂(ω,d∗)|∑ K=1 Ĥ[M ∩ ( ∪fM (t, ω) t∈T (ω,d∗,t1,t2)K )] n••(t1, t2) = ∑ d∈D ∑ ω∈Ω |α̂(ω,d)|∑ K=1 Ĥ[M ∩ ∪fM (t, ω) t∈T (ω,d,t1,t2)K ]\n(13)\nWhere nd∗ei(0, 30) is the number of times that event ei occurs in the month after a first prescriptions in 13 months of drug d∗, n.ei(0, 30) is the number of times that event ei occurs in the month after a first prescriptions in 13 months of any drug, nd∗.(0, 30) is the number of times a drug d∗ is prescribed for the first time in 13 months and has any follow up in the month after the prescription and n..(0, 30) is the number of times any drug is prescribed for the first time in 13 months and has any follow up in the month after the prescription.\nThe expected number of first time prescriptions of drug d∗ in 13 months that have the Read Code ei occur within the time period defined by t1 and t2 if the Read Code occurs independently of the drug is,\nEd∗ei(t1, t2) = nd∗•(t1, t2)n•ei(t1, t2)\nn••(t1, t2) (14)\nand the IC(t1, t2, ei, d∗) value calculates how many first prescription in 13 months of drug d∗ have the Read Code ei occurring between t1 and t2 days after divided by the expected value if the Read Code and drug occur independently,\nIC(t1, t2, ei, d∗) = log2( nd∗ei(t1, t2) + 1/2\nEd∗ei(t1, t2) + 1/2 ) (15)\nThe value of a half added to both the numerator and denominator in the IC(t1, t2, ei, d∗) value calculation creates a bias that causes the IC(t1, t2, ei, d∗) value to tend to zero when the Read Code or drug occurs rarely.\nThe IC∆ is a measure that compares the IC(0, 30, ei, d∗) corresponding to the time period of a month after the first prescription in 13 months compared to the IC(−810,−630, ei, d∗) corresponding to a time period between 27 and 21 months prior to the prescription.\nIC∆(ei, d∗) = log2( nd∗ei(0, 30) + 1/2\nE∗d∗ei(0, 30) + 1/2 ) (16)\nSeptember 3, 2014 DRAFT\n11\nwhere,\nE∗d∗,ei(0, 30) = nd∗ei(−810,−630)Ed∗ei(0, 30)\nEd∗ei(−810,−630)\nWhen investigating possible ADRs for drug d∗ the authors use a filter to remove any Read Codes ei if the IC(−30,−1, ei, d∗) > IC(0, 30, ei, d∗) or IC(0, 0, ei, d∗) > IC(0, 30, ei, d∗), these correspond to the IC value the month prior to the prescription being higher than the month after prescription, or the IC value on the day of prescription being higher than a month after. In this paper we will use the IC∆(ei, d∗) as described above as an attribute for each possible drug and Read Code combination and use the Heaviside step function H : R→ {0, 1},\nH[n] = 0 if n ≤ 01 if n > 0 to define the filter functions,\nζ1(ei, d∗) =H[IC(−30,−1, ei, d∗)− IC(0, 30, ei, d∗)] ζ2(ei, d∗) =H[IC(0, 0, ei, d∗)− IC(0, 30, ei, d∗)] (17)\nas two addition binary attributes.\nThe algorithm Mining Unexpected Temporary Association Rules given the Antecedent (MUTARA) [21] applies a case control approach that estimates the background rate that the Read Code is recorded into the THIN database by finding out how many patients who have not been prescribed the drug of interest have the Read Code recorded during a random time interval. MUTARA aims to find Unexpected Temporary Association Rules (UTARs) by investigating how many patients have a specific Read Code unexpectedly recorded within a period of interest centred on the first prescriptions of the drug being studied. The algorithm Highlighting UTARs Negating TARs (HUNT) [22] was developed by the same authors as MUTARA and applies a similar method but is less prone to ranking therapeutic failure Read Codes (Read Codes linked to the cause of taking the drug) above Read Codes corresponding to ADRs.\nMUTARA and HUNT both investigate the Read Codes that occur during the month after the drug being studied is first prescribed to a patient or the union of the month after the first and second prescriptions of the drug if it is repeated within a month of the first prescription. Previously we defined α(ω, d∗) to be the ages in days that patient ω is prescribed the drug d∗ and α1(ω, d∗)) to be the age in days that patient ω is first prescribed the drug d∗, so the set α(ω, d∗) \\ α1(ω, d∗) contains the ages that patient ω is prescribed drug d∗ except the age when they are first prescribe the drug. Using this we define a new function that returns the patient’s age in days for the second time a drug is prescribed for a patient if\nSeptember 3, 2014 DRAFT\n12\nthis is within a month of the first prescription or the patient’s age in days for the first time the drug is prescribed if the second prescription is not within a month of the first.\nα2(ω, d∗) = min{s ∈ α(ω, d∗) \\ α1(ω, d∗)} if ∃t ∈ α(ω, d∗) \\ α1(ω, d∗) s.t |t− α1(ω, d∗)| < 30α1(ω, d∗) else (18)\nMUTARA uses patients that have not been prescribed the drug (so α1(ω, d∗) = −1) to estimate the background rate that the Read Code is prescribed into the THIN database. For each patient that has never been prescribed the drug d∗, a random time interval is chosen within the age that the patient first has any Read Code recorded and the age that a Read Code is last recorded, min(AM (ω)) and max(AM (ω)) respectively, where we defined AM (ω) previously to be the set of ages that patient ω has a Read Code recorded into the THIN database. If a patient has never had a Read Code recorded into the THIN database (AM (ω) = ∅) or only had Read Codes recorded for the short period of time (max(AM (ω)) − min(AM (ω)) < |t2 − t1|) then the patient is not used in this study as they are not an active patient and may bias results. The time interval of length |t2 − t1| is chosen uniformly within [min(AM (ω))...max(AM (ω))].\nPutting this all together, the time interval of interest around the first prescription of drug d∗ for patients prescribed the drug or the time interval chosen at random for patients who have never been prescribed the drug used by MUTARA is,\nTM (ω, d∗, t1, t2) = [(α1(ω, d∗) + t1)...(α2(ω, d∗) + t2)] if α1(ω, d∗) 6= −1[(min(AM (ω)) + r)...(min(AM (ω)) + r + |t2 − t1|)] else (19) where,\nr ∼ U(0,max(AM (ω))−min(AM (ω))− |t2 − t1|) (20)\nFor patients who are prescribed the drug d∗ a filter is applied to ignore any ‘expected’ Read Codes that are recorded within the time interval of interest after the first prescription of the drug. A Read Code is ‘expected’ for the patient during the time interval of interest after the drug is prescribe if the patient also had the Read Code recorded within t3 ∈ N days prior to drug being prescribed. We define this time interval prior to the prescription as,\nTfilt(ω, d∗, t3) = [(α1(ω, d∗)− t3)...(α1(ω, d∗)− 1)] if α1(ω, d∗) 6= −1∅ else (21)\nSeptember 3, 2014 DRAFT\n13\nWe then find how many patients have each Read Code recorded ‘unexpectedly’ during the time interval\nof interest after the drug by,\nh∗(ei, d∗, ω, t1, t2, t3) = 1{ei ∈ ∪fM (t, ω) t∈TM (ω,d∗,t1,t2) }(1− 1{ei ∈ ∪fM (t, ω) t∈Tfilt(ω,d∗,t3) }) (22)\nThe Heaviside step function applied to α1(ω, d∗) returns 1 if patient ω has been prescribed the drug d∗, as in that case α1(ω, d∗) > 0 or returns 0 if patient ω has never been prescribed the drug d∗. MUTARA then calculates the unexpected-leverage as,\nuL(ei, d∗) =\n∑ ω∈Ω [h\n∗(ei, d∗, ω, t1, t2, t3)×H[α1(ω, d∗)]] |Ω|\n− (∑ ω∈ΩH[α1(ω, d∗)]\n|Ω|\n)(∑ ω∈Ω h ∗(ei, d∗, ω, t1, t2, t3)\n|Ω| ) (23)\nwhere the fraction of patients in the database who have the drug multiplied by the fraction of patients who have the Read Code recorded during their interval of interest is subtracted from the fraction of patients in the database who have the Read Code recorded within a month of the first time the drug is prescribed (or up to a month after the second prescription if the drug is repeated within a month).\nHUNT calculates a similar value to the unexpected-leverage known as the leverage that does not include\na filter to remove ’expected’ Read codes based on a patient’s history,\nh∗∗(ei, d∗, ω, t1, t2) = 1{ei ∈ ∪ t∈TM (ω,d∗,t1,t2) fM (t, ω)} (24)\nand\nL(ei, d∗) =\n∑ ω∈Ω [h\n∗∗(ei, d∗, ω, , t1, t2)×H[α1(ω, d∗)]] |Ω|\n− (∑ ω∈ΩH[α1(ω, d∗)]\n|Ω|\n)(∑ ω∈Ω h ∗∗(ei, d∗, ω, , t1, t2)\n|Ω| ) (25)\nHUNT then ranks the Read Codes in descending order of the leverage to attain the leverage rank and in descending order of the unexpected-leverage to attain the unexpected-leverage rank and then calculates the rank ratio between the leverage rank and unexpected-leverage rank. Finally, HUNT returns the Read codes in descending order of this rank ratio."
    }, {
      "heading" : "B. Novel Algorithm Attributes",
      "text" : "The attributes of interest for detecting ADRs are how many patients have the Read Code recorded a\nmonth prior to the first prescription compared with how many patients have it recorded a month after,\nABratio30(ei, d∗) =\n∑ ω∈Ω h(ei, d∗, ω, 1, 30)∑\nω∈Ω h(ei, d∗, ω,−30,−1) (26)\nSeptember 3, 2014 DRAFT\n14\na similar attribute considers the ratio between the number of patients who have the Read Code recorded\na year after compared to a year before,\nABratio365(ei, d∗) =\n∑ ω∈Ω h(ei, d∗, ω, 1, 365)∑\nω∈Ω h(ei, d∗, ω,−365,−1) (27)\nAs the THIN database does not record the time that a Read Code or drugcode is recorded, Read Codes that are recorded on the same day as the drugcode could correspond to a serious ADR that occurs immediately or an indicator, this is why the day of prescription is not included in the above ABratios and instead is used as another attribute,\nDOP (ei, d∗) =\n∑ ω∈Ω h(ei, d∗, ω, 0, 0)∑\nω∈Ω h(ei, d∗, ω,−365,−1) (28)\nIn previous methods there has been a patient level filter that removes medical events from a patient’s sequence that occur 30 days after the drug if the patient also had the medical event shortly prior to the drug [20]. The justification for this is, if a patient had an illness shortly before the drug then having the illness repeated after the drug is unlikely to be an ADR. This inspires the third attribute that is based on the number of patients who have the Read Code recorded in the month after and also have it recorded during the month prior to the first prescription,\nexpect(ei, d∗) =\n∑ ω∈Ω [h(ei, d∗, ω, 1, 30)× h(ei, d∗, ω,−30,−1)]∑\nω∈Ω h(ei, d∗, ω, 1, 30) (29)\nThe final attributes of interest make use of the Read Code tree structure. When a patient first has an illness it is likely that not much detail is known, so a low level Read Code will probably be recorded into the THIN database, over time more information may be discovered about a patient’s illness possibly due to laboratory results and this may then result in a more specified higher level Read Code being entered (a child of the original less detailed Read Code). As a consequence, it is common for higher level Read Codes related to the cause of taking the drug to only be recorded after the drug, so to help distinguish between these and ADRs we calculate the Read Code after and before ratio when only considering the first two or three elements of a Read Code. For example, considering the first three elements of the Read Code, the Read Code A11ab becomes A11 and the ABratiolev3 is the number of patients that have a Read Code starting with A11 within the month after the first prescription of the drug divided by the number of patients that have a Read Code starting with A11 within the month prior to the first prescription of the drug. Similarly, the ABratiolev2 for a Read Code is the number of patients who have a Read Code with the same first two elements within a month after the first prescription divided by the number of patients who have a Read Code with the same first two elements within a month prior to the prescription.\nSeptember 3, 2014 DRAFT\n15\nTo calculate these attributes we first define an equivalence relationship, ei n∼ ej if the first n elements of the Read Codes of ei and ej are the same. The number of patients who have Read Codes equivalent to ei recorded a month after the first prescription of d∗ is,∑ ω∈Ω H[ ∑ e n∼ei h(e, d∗, ω, 1, 30)] similary, the number of patients who have Read Codes equivalent to ei recorded during the month prior to the prescription is, ∑ ω∈Ω H[ ∑ e n∼ei h(e, d∗, ω,−30,−1)] It follows that the ABratiolev3 and ABratiolev2 are calculated by,\nABratiolev3(ei, d∗) =\n∑ ω∈ΩH[ ∑ e\n3∼ei h(e, d∗, ω, 1, 30)]∑ ω∈ΩH[ ∑\ne 3∼ei\nh(e, d∗, ω,−30,−1)] (30)\nABratiolev3(ei, d∗) =\n∑ ω∈ΩH[ ∑ e\n2∼ei h(e, d∗, ω, 1, 30)]∑ ω∈ΩH[ ∑\ne 2∼ei\nh(e, d∗, ω,−30,−1)] (31)"
    }, {
      "heading" : "IV. DRESS ALGORITHM",
      "text" : "The Detecting Rare Events Semi-Supervised (DRESS) algorithm comprises of five steps, see Fig (2). The DRESS algorithm requires the user to input the drug of interest (d∗) and returns a ranked list of Read Codes in descending order of how likely they are to be ADRs. Tentative ADR signals can then be determined by the DRESS algorithm by considering the top k ranked Read codes to be signalled as ADRs. The value of k will determine the filtering threshold and in this paper we consider the top 100 ranked Read Codes to be signalled by the algorithms.\nSeptember 3, 2014 DRAFT\n16"
    }, {
      "heading" : "A. Step 1",
      "text" : "The first step of the DRESS algorithm is the generation of attributes for any Read Code that could be an ADR. This is accomplished by initially finding the set of all the Read Codes that are recorded within a month of the first prescription of d∗ for any patient, we denote this set of Read Codes by G. Then, for every Read Code ei ∈ G the DRESS algorithm generates the attributes ABratio30(ei, d∗), ABratio365(ei, d∗), DOP (ei, d∗), expect(ei, d∗), ABratiolev3(ei, d∗), ABratiolev2(ei, d∗) (Eq’s (26)- (31)) and the OE ratio values the IC∆(ei, d∗), ζ1(ei, d∗) and ζ2(ei, d∗) (Eq’s (16)-(17)). The data point for each ei ∈ G is denoted by xi ∈ R9 and is a vector corresponding to the attribute values. The set of data points is denoted by X = {x1,x2, ...,xn}, where the cardinality of the set G is n (|G| = n)."
    }, {
      "heading" : "B. Step 2",
      "text" : "As we are applying a semi-supervised approach, we need labels for some of the Read Codes. We have decided to have three different labels for each Read Code, one label representing Read Codes that are ADRs (known ADR), another label representing Read Codes that cause the drug to be taken by the patients (indicator) and the final label representing Read Codes that are not linked to the drug but just occur by chance (noise). The reason for choosing three labels is because there is information available to enable us to determine the labels for a sufficient number of Read Codes when using three labels.\nWe determined the Read Codes that are labelled as noise by using the hierarchal structure of the Read Code tree. We determined branches that are not related to immediately occurring ADRs by manually investigating the Read Code tree and found the set of irrelevant Read Codes, Mirrel. Examples of Read Codes in Mirrel that cannot correspond to immediately occurring ADRs are those related to cancer, occupations or family history. Fig (3) illustrates the Read Code tree and the Read Code branches considered to be noise are shaded in, whereas the Read Code branches that are possible ADRs are unshaded. Using the set Mirrel, the DRESS algorithm labels any Read Code ei ∈ G ∩Mirrel as noise.\nTo determine the labels of some of the Read Codes corresponding to known ADRs or indicators we mined data from the internet. The Read Codes labelled as indicators are found by first extracting the strings listed as indicators on the netdoctor website [25], then finding the set of Read Codes with descriptions containing any one of these strings and finally validating these are indicators by ignoring indicator Read Codes that do not have an ABratio30 < 1. The Read Codes labelled as known ADRs are found similarly, by first extracting the strings listed as side effects on the netdoctor website, then finding the set of Read Codes with descriptions containing any one of these strings and validating these by ignoring any Read Codes that do not have an ABratio30 ≥ 1.5. In addition to the Read Codes\nSeptember 3, 2014 DRAFT\n17\ncorresponding to the netdoctor listed side effects, Read Codes with a description containing the drug name and the term ‘adverse’ are also labelled as known ADRs."
    }, {
      "heading" : "C. Step 3",
      "text" : "After labelling some of the Read Codes we then applied the metric learning algorithm detailed in [26]. Letting S denote the set of all index pairs for Read Codes with the same label (e.g. if Read Codes corresponding to the data points x1 and x2 are both labelled as noise then (1, 2) ∈ S), D denote the set of all index pairs for Read Codes with a different label (e.g. if the Read code corresponding to data point x1 is labelled as noise but the Read code corresponding to the data point x5 is labelled as an indicator then (1, 5) ∈ D) and the inner product of two d× n real valued matrices, X,Y ∈ Rd×n, is denoted by 〈X,Y 〉 :=Tr(XTY ), where Tr(A) means the trace of the matrix A. The cone of positive semidefinite matrices is denoted by Sd+.\nGiven a pair of Read Code data points xi and xj generated in step 1, we calculate the matrix Xij = (xi − xj)(xi − xj)T . If τ = (i, j) is an index pair, then Xτ ≡ Xij . The matrix XS is defined by XS =∑ (i,j)∈S Xij and ∼ Xτ = X −1/2 S XτX −1/2 S . The authors calculated that ∇fµ(S µ t ) = ∑ τ∈D e −〈 ∼ Xτ ,S〉/µ ∼ Xτ∑\nτ∈D e −〈 ∼ Xτ ,S〉/µ\n.\nInput :\n• smoothing parameter µ > 0 (e.g., 10−5) • tolerance value tol (e.g., 10−5) • step sized {αt ∈ (0, 1) : t ∈ N}\nOutput: d× d matrix Sµt ∈ Sd+ Initialization: Sµ1 ∈ Sd+ with Tr(S µ 1 )= 1 for t = 1, 2, 3, ... do Zµt =argmax{fµ(S µ t ) + 〈Z,∇fµ(S µ t )〉 : Z ∈ Sd+, Tr(Z)=1 }, that is, Z µ t = νν T where ν is the\nmaximal eigenvector of the matrix ∇fµ(Sµt ) Sµt+1 = (1− αt)S µ t + αtZ µ t if |fµ(Sµt+1)− fµ(S µ t )| < tol then break\nend Algorithm 1: The distance metric learning algorithm from [26]\nWhen applied in the DRESS algorithm, the distance metric algorithm described in algorithm 1 finds a mapping from the space consisting of the attribute values found in step 1 to a different space that minimises the distance between two Read Codes with the same label and maximises the distance between\nSeptember 3, 2014 DRAFT\n18\ntwo Read Codes with different labels. The mapping is, f : R9 → R9; f(xi) = xiTSµt , where S µ t is the 9× 9 learned distance metric matrix,"
    }, {
      "heading" : "D. Step 4",
      "text" : "The constrained K-means algorithm [27] is applied to the Read Codes on their corresponding transformed data points determined by the distance metric learning algorithm above. The constrained Kmeans algorithm is a semi-supervised algorithm that fixes the class of the labelled Read Codes and uses these labelled Read Codes to calculate the initial cluster centres then iteratively assigns the non-fixed Read Codes into the cluster with the closest mean, with the means iteratively being recalculated until convergence.\nWhen the DRESS algorithm is implemented, the set of data points input into the Constrained Kmeans algorithm is the set {f(x1), f(x2), ..., f(xn)}, the value of K input is 3 and the initial seeds are S1 = {xi : xi is labelled as a known ADR}, S2 = {xi : xi is labelled as an indicator} and S3 = {xi : xi is labelled as noise}. Input : Set of data points X = {x1,x2, ...,xn}, xi ∈ Rd, number of clusters K, the set\nS = ∪Kl=1Sl of initial seeds.\nOutput: Disjoint K partitioning {Xl}kl=1 of X such that the KMeans objective function is\noptimised.\nInitialization: µ(0)h ← 1 |Sh| ∑ x∈Sh x, for h = 1, ...,K; t← 0 repeat For x ∈ S, if x ∈ Sh assign x to the cluster h (i.e., set Xt+1h ). For x 6∈ S, assign x to the\ncluster h∗ (i.e., set Xt+1h∗ ), for h ∗ = argmin h ‖x− µ(t)h ‖ 2 µ (t+1) h ←\n1 |X(t+1)h | ∑ x∈X(t+1)h x\nt← (t+ 1) until convergence; Algorithm 2: The Constrained K-means algorithm developed in [27] Read Codes in the same cluster as the Read Codes that were originally labelled as known ADRs are referred to as being in the ADR cluster, Read Codes in the same cluster as the Read Codes that were originally labelled as indicators are referred to as being in the indicator cluster and Read Codes in the same cluster as the Read Codes that were originally labelled as noise are referred to as being in the noise cluster.\nSeptember 3, 2014 DRAFT\n19"
    }, {
      "heading" : "E. Step 5",
      "text" : "The last step involved applying two additional filters and then used the Read Code attributes and clustering to order the Read Codes by how likely they are to be ADRs. The first filter removed all the Read Codes (ei’s) that were in the indicator cluster or where (1−expect(ei, d∗))×ABratio30(ei, d∗) < 1 . The second filter is a filter that we have developed for post processing with any algorithm that detects ADRs by mining the THIN database. This filter removes all the Read Codes that are irrelevant for ADR detection such as Read Codes corresponding to administrative events. Finally Read Codes were ordered in descending order of (1 − expect(ei, d∗)) × ABratio30(ei, d∗) × 1β , where β = 1 for Read Codes in the ADR cluster and β = 3 for Read Codes in the noise cluster.\nIn summary, the DRESS algorithm uses the semi-supervised clustering to filter Read Codes that have attributes that make them unlikely to be ADRs and then orders the remaining Read Codes by how often they occurred unexpectedly after the first prescription of the drug being investigated but also adds a weight so that Read Codes that have attributes similar to known ADRs are ranked higher."
    }, {
      "heading" : "V. RESULTS",
      "text" : "We applied the DRESS algorithm to a range of drugs, some of which have been withdrawn from the market due to serious ADRs. Table II shows the rank that each data mining algorithm assigns for a known rare and serious drug and ADR pair. The table also states the cause for taking the drug (the indication), the year the drug was withdrawn and approximately how commonly the ADR occurs for patients prescribed the drug. In some cases the rare and serious ADR being investigated was listed as an ADR on the netdoctor website and to prevent any bias in the results for the DRESS algorithm, any labels for the Read Codes corresponding to the ADR being investigated were removed at the end of step 2, prior to the semi-supervised steps. So the Read Codes corresponding to the ADR being investigated were always unlabelled in the DRESS algorithm.\nThe DRESS algorithm had an average rank over the drug and ADR pairs of 143.75 and had the highest rank compared to all the other algorithms for 12 of the 16 drug and ADR pairs investigated. It was able to return a rank under 100 for 56.25% of the ADRs and all the ADRs had a rank below 500. In comparison the other methods had an average rank of 344.69, 791 and 2385.73 for the OE ratio, HUNT and MUTARA respectively. The OE ratio only returned a rank under 100 for 25% of the ADRs and only 6.25% of ADRs ranked by MUTARA and HUNT had a rank under 100.\nSeptember 3, 2014 DRAFT\n20\nTA B\nL E\nII :\nT he\nR ea\nd C\nod e\nra nk\ns th\nat se\nri ou\ns an\nd ra\nre A\nD R\ns ar\ne gi\nve n\nby th\ne di\nff er\nen t\nm et\nho ds\nfo r\na ra\nng e\nof dr\nug an\nd kn\now n\nra re\nA D\nR\npa ir\ns. If\nth e\nal go\nri th\nm di\nd no\nt re\ntu rn\na ra\nnk fo\nr th\ne R\nea d\nC od\ne co\nrr es\npo nd\nin g\nto th\ne A\nD R\n,t he\nn th\nis is\nre pr\nes en\nte d\nby ‘-\n’.\nD ru\ng In\ndi ca\ntio n\nA D\nR W\nith dr\naw n\nIn ci\nde nc\ne D\nR E\nSS O\nE ra\ntio H\nU N\nT M\nU TA\nR A\nR of\nec ox\nib A\ncu te\npa in\nIn fe\nri or\nm yo\nca rd\nia l\nin fa\nrc tio\nn 20\n04 0.\n79 -1\n.2 4%\n[2 8]\n83 30\n2 19\n6 12\n12\nR of\nec ox\nib A\ncu te\npa in\nH ea\nrt fa\nilu re\n20 04\n0. 79\n-1 .2\n4% [2\n8] 12\n1 80\n5 50\n4 56\n2\nR im\non ab\nan t\nO be\nsi ty\nD ep\nre ss\ned m\noo d\n20 08\n0. 6%\n[2 9]\n16 32\n15 68\nR im\non ab\nan t\nO be\nsi ty\nD ep\nre ss\niv e\ndi so\nrd er\nN E\nC 20\n08 3\n% [3\n0] 23\n18 0\n29 5\n11 57\nE na\nla pr\nil H\nyp er\nte ns\nio n/\nH ea\nrt fa\nilu re\nA cu\nte pa\nnc re\nat iti\ns -\nra re\n[3 1]\n[3 2]\n53 70\n0 41\n6 20\n81\nN ap\nro xe\nn Pa\nin /in\nfla m\nm at\nio n\nA cu\nte re\nna l\nfa ilu\nre -\nra re\n[3 3]\n20 15\n9 13\n8 13\n13\nN ap\nro xe\nn Pa\nin /in\nfla m\nm at\nio n\nJa un\ndi ce\n- ra\nre [3\n4] 52\n77 4\n33 94\n41 90\nN ap\nro xe\nn Pa\nin /in\nfla m\nm at\nio n\nH ep\nat iti\ns un\nsp ec\nifi ed\n- ra\nre [3\n4] 24\n1 35\n85 2\n35 02\nN ap\nro xe\nn Pa\nin /in\nfla m\nm at\nio n\nSu ic\nid e\nan d\nse lfi\nnfl ic\nte d\nin ju\nry -\nra re\n[3 5]\n10 4\n22 3\n24 2\n18 08\nN if\ned ip\nin e\nH yp\ner te\nns io\nn/ A\nng in\na W\nei gh\nt in\ncr ea\nsi ng\n- ≤\n1% [3\n6] 36\n2 29\n15 17\n14 92\nN if\ned ip\nin e\nH yp\ner te\nns io\nn/ A\nng in\na Fe\nel s\nho t/f\nev er\nis h\n- ≤\n2% [3\n6] 31\n4 42\n8 19\n72 74\n80\nC ip\nro flo\nxa ci\nn B\nac te\nri al\nin fe\nct io\nns N\non tr\nau m\nat ic\nru pt\nur e\nof A\nch ill\nes te\nnd on\n- ra\nre [3\n7] 13\n42 12\n73 55\n06\nL ev\nofl ox\nac in\nB ac\nte ri\nal in\nfe ct\nio ns\nR up\ntu re\nA ch\nill es\nte nd\non -\nra re\n[3 7]\n76 29\n6 -\n-\nL ev\nofl ox\nac in\nB ac\nte ri\nal in\nfe ct\nio ns\nN on\ntr au\nm at\nic ru\npt ur\ne of\nA ch\nill es\nte nd\non -\nra re\n[3 7]\n29 8\n27 9\n32 0\n11 89\nR ifa\nm pi\nci n\nTu be\nrc ul\nos is\n/in fe\nct io\nns T\nhr om\nbo cy\nto pe\nni a\nN O\nS -\nra re\n[3 8]\n75 41\n8 26\n5 10\n03\nM et\nfo rm\nin Ty\npe 2\ndi ab\net es\nL ac\ntic ac\nid os\nis -\n0. 00\n5 %\n[3 9]\n- -\n- -\nM et\nfo rm\nin Ty\npe 2\ndi ab\net es\nA ci\ndo si\ns -\n0. 00\n5 %\n[3 9]\n44 9\n81 3\n46 6\n32 23\nSeptember 3, 2014 DRAFT\n21"
    }, {
      "heading" : "VI. DISCUSSION",
      "text" : "The existing methods for detecting ADRs using EHDs do not currently definitively detect ADRs, but rather, they can be considered to generate tentative ADR signals for the top k ranked medical events in their returned list. This is effectively filtering out all the medical events that are unlikely to be ADRs or the medical events without sufficient evidence (number of patients experiencing the event after the drug) of being an ADR. The medical events with a rank greater than k are ignored and the medical events with a rank less than k (the signalled medical events) are investigated further to confirm if they are true ADRs. Therefore, for an unknown ADR to be detected by these existing methods it needs to be signalled by being ranked in the top k medical events returned and the closer that the rank is to the value 1, the more likely it will be investigated further, even when low values of k are used. The results of this paper show that the existing methods are not able to rank the known rare and serious ADRs highly, so they would be unlikely to signal these for further investigation, but the DRESS algorithm was able to rank over 50% of these rare ADRs within the top 100 and would most likely signal these for further investigation. This implies that the DRESS algorithm is more suitable than existing methods for detecting rare ADRs and has the potential to discover many unknown rare ADRs.\nThe DRESS algorithm was unable to rank ‘Naproxen and Hepatitis’ and ‘Nifedipine and weight increase’ higher than the OE ratio, one reason for this is that the DRESS algorithm does not perform as well for medical events that have a high background rate as medical events that are common will have a greater number of patients experiencing the medical event in the month before the prescription and if the ADR is rare only one or two patients extra will have the medical event in the month after the prescription, so the ABratio will be close to one, but on the other hand, the OE ratio performs better for medical events with a high background rate as the bias in the IC calculation will have less impact. It might be better to have two ADR clusters, one for the medical events that occur at a low background rate and another for the medical events that occur at a high background rate, but this may cause issue if there is not a sufficient number of Read Codes corresponding to known side effects, as if there are only a few Read Codes for the known side effects there may only be one to two labelled Read Codes in each cluster and this will be deleterious for the semi-supervised methods.\nIt may be argued that the DRESS algorithm can only be applied after many ADRs are known and this may prevent it efficiently detecting rare ADRs, but rare ADRs that occur less than 1 in 1000 patients generally need three of more ADR cases before there is satisfactory evidence to confirm the ADR and this requires thousands of patients having the drug. DRESS can be implemented after a few hundred patients\nSeptember 3, 2014 DRAFT\n22\nhave taken a drug as the obvious side effects will be known, so the constraint of requiring known ADRs will not reduce the efficiency of DRESS. It is worth noting that the current implementation of DRESS will not be as effective if a drug is generally safe and does not have many side effects, but this is not common and DRESS could be modified to use the positive effects of the drug as labelled medical events as the positive effects and side effects have similar attribute values as both should increase after the drug is taken.\nThe DRESS algorithm still highly ranks medical events related to the cause of the drug and removing these medical events would greatly improve the ability to detect rare ADRs with DRESS. The expect attribute has limitations as it only indicates if the patient had a repeat of a medical event and does not make use of the medical event relations within the THIN database to determine if a medical event is expected based on related medical events. For example, if a patient has ‘a cold’ then they are likely to experience ‘a cough’ if the illness progresses, but the expect attribute only says ‘a cough’ is expected if the patient has had ‘a cough’ shortly before and not if a predecessor medical event has occurred before. To reduce the rank of medical events related to the cause of the drug a new attribute that uses sequential patterns to determine the expectedness of each medical event that occurs after the description could be used."
    }, {
      "heading" : "VII. CONCLUSION",
      "text" : "In this paper we have described a novel methodology to detect rare ADRs that incorporates some existing methods (Observe Expected ratio, MUTARA and HUNT), information retrieval from the web, metric learning and semi-supervised clustering. The results suggest this methodology is able to detect rare and serious ADRs for the range of drugs chosen in the investigation and has the potential to help detect many currently unknown ADRs. The method is not able to remove all medical events related to the cause of taking the drug and future work should aim to prevent generating signals for these medical events by adding an additional attribute to the clustering that determines the expectedness of each medical event based on sequential patterns that can be mined from the whole database. Further work could also investigate different metric learning and semi-supervised clustering techniques."
    } ],
    "references" : [ {
      "title" : "and J",
      "author" : [ "S. Gautier", "H. Bachelet", "R. Bordet" ],
      "venue" : "Caron, “The cost of adverse drug reactions,” Exoert Opin Pharmacother, vol. 4(3), pp. 319–26",
      "citeRegEx" : "1",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "and N",
      "author" : [ "K. Patal", "M. Kedia", "D. Bajpai", "S. Mehta", "N. Kshirsagar" ],
      "venue" : "Gogtay, “Evaluation of the prevalence and economic burden of adverse drug reactions presenting to the medical emergency department of a tertiary referral centre:a prospective study,” BMC Clinical Pharmacology, vol. 7:8",
      "citeRegEx" : "2",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "and M",
      "author" : [ "E.C. Davies", "C.F. Green", "S. Taylor", "P.R. Williamson", "D.R. Mottram" ],
      "venue" : "Pirmohamed, “Adverse drug reactions in hostpitals in-patients: A prospectve analysis of 3695 patient-episodes,” [PL]o[S] ONE, vol. 4(2), p. e4439.doi:10.1371/journal.pone.0004439",
      "citeRegEx" : "3",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "N",
      "author" : [ "K.A. Hartholt" ],
      "venue" : "van der Velde, C. W. N. Looman, M. J. M. Panneman, and E. F. van Beeck, “Adverse drug reactions related hostpital admissions in persons aged 60 years and over, thenetherlans, 1981-2007: Less rapid increase, different drugs,” PLoS ONE, vol. 5(11), p. e13977. doi:10.1371/journal.pone.0013977",
      "citeRegEx" : "4",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "Adverse drug reaction deaths reported in united sates vital statistics",
      "author" : [ "G. Shepherd", "P. Mohorn", "K. Yacoub", "D. May" ],
      "venue" : "1999-2006,” Ann Pharmacother, vol. 46(2), pp. 169–75",
      "citeRegEx" : "5",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "and D",
      "author" : [ "T.M. Betteridge", "C.M. Frampton" ],
      "venue" : "L. Jardine, “Polypharmacy - we make it worse! a cross-sectional study from an acute admissions unit,” Internal Medicine Journal, vol. 42(2), pp. 208–211",
      "citeRegEx" : "6",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Adverse drug reactions as cause of admission to hospital: prospective analysis",
      "author" : [ "M. Pirmohamed" ],
      "venue" : "patients,” BMJ,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2004
    }, {
      "title" : "and P",
      "author" : [ "F.R. Varallo", "M.F.R. Lima", "J.C.F. Galduroz" ],
      "venue" : "C. Mastroianni, “Adverse drug reactions as cause of hospital admission of elderly people: a pilot study,” Latin American Journal of Pharmacy, vol. 30(2), pp. 347–353",
      "citeRegEx" : "8",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "and S",
      "author" : [ "J.A. Berlin", "S.C. Glasser" ],
      "venue" : "S. Ellenberg, “Adverse event detection in drug development: Recommendations and obligations beyond phase 3,” Am J Public Health, vol. 98(8), pp. 1336–1371",
      "citeRegEx" : "9",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "and I",
      "author" : [ "B. Seruga", "L. Sterling", "L. Wang" ],
      "venue" : "F. Tannock, “Reporting of serious adverse drug reactions of targeted anticancer agents in pivotal phass iii clinical trials,” JCO, vol. 29(2), pp. 174–185",
      "citeRegEx" : "10",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "and F",
      "author" : [ "L. Bergman", "M.L. Beelen", "M.P. Gallee", "H. Hollema", "J. Benraadt" ],
      "venue" : "E. van Leeuwen, “Risk and prognosis of endometrial cancer after tamoxifen from breath cancer. comprehensive cancer centers’ ALERT group. assessment of liver and endometrical cancer risk following tamoxifen.” Lancet, vol. 356(9233), pp. 881–887",
      "citeRegEx" : "11",
      "shortCiteRegEx" : null,
      "year" : 2000
    }, {
      "title" : "and C",
      "author" : [ "L.A. Ladewski", "S.M. Belknap", "J.R. Nebeker", "O. Sartor", "E.A. Lyons", "T.C. Kuzel", "M.S. Tallman", "D.W. Raisch", "A.R. Auerbach", "G.T. Schumock", "H.C. Kwaan" ],
      "venue" : "L. Bennett, “Dissemination of information on potentially fatal adverse drug reactions for cancer drugs from 2000 to 2002: First results from the research on adverse drug events and reports project,” J Clin Oncol, vol. 21, pp. 3859–3866",
      "citeRegEx" : "12",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "and S",
      "author" : [ "S.J.W. Evans", "P.C. Waller" ],
      "venue" : "Davis, “Use of proportional reporting ratios (PRRs) for signal generation from spontaneous adverse drug reaction reports,” Pharmacoepidemiology and Drug Safety, vol. 10(6), pp. 483–486",
      "citeRegEx" : "13",
      "shortCiteRegEx" : null,
      "year" : 2001
    }, {
      "title" : "and R",
      "author" : [ "A. Bate", "M. Lindquist", "I.R. Edwards", "S. Olsson", "R. Orre", "A. Lansner" ],
      "venue" : "M. D. Freitas, “A bayesian neural network method for adverse drug reaction signal generation,” European Journal of Clinical Pharmacol, vol. 54, pp. 315–321",
      "citeRegEx" : "14",
      "shortCiteRegEx" : null,
      "year" : 1998
    }, {
      "title" : "Bayesian data mining in large frequency tables, with an application to the fda spontaneous reporting system,",
      "author" : [ "W. DuMouchel" ],
      "venue" : "American Statistician,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 1999
    }, {
      "title" : "Under-reporting of adverse drug reactions: A systematic review,",
      "author" : [ "L. Hazell", "S.A.W. Shakir" ],
      "venue" : "Drug Safety,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2006
    }, {
      "title" : "Temportal pattern deiscovery in longitudinal electronic patients records,",
      "author" : [ "G.M. Noren", "J. Hopstadius", "A. Bate", "K. Star", "I.R. Edwards" ],
      "venue" : "Data Mining and Knowledge Discovery,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2010
    }, {
      "title" : "Methods for drug safety signal detection in longitudinal observational databases: LGPS and LEOPARD,",
      "author" : [ "M.J. Schuemie" ],
      "venue" : "PDS, vol",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2011
    }, {
      "title" : "and A",
      "author" : [ "I. Zorych", "D. Madigan", "P. Ryan" ],
      "venue" : "Bate, “Disproportionality methods for pharmacovigilance in longitudinal observational databases.” Stat Methods Med Res, vol. 0(0), pp. 1–18",
      "citeRegEx" : "19",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "and C",
      "author" : [ "H. Jin", "J. Chen", "C. Kelman", "H. He", "D. McAullay" ],
      "venue" : "M. O’Keefe, “Mining unexpected associations for signalling potential adverse drug reactions from administrative health databases,” PAKDD, pp. 867–876",
      "citeRegEx" : "20",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "and C",
      "author" : [ "H.W. Jin", "J. Chen", "H. He", "C. Kelman", "D. McAullay" ],
      "venue" : "M. Okeefe, “Signaling potential adverse drug reactions from administrative health databases,” IEEE Transactions on knowledge and data engineering, vol. 22(6), pp. 839–853",
      "citeRegEx" : "21",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "H",
      "author" : [ "Y. Ji" ],
      "venue" : "Y. anf John Tran, P. Dews, A. Mansour, and R. M. Massanari, “A method for mining infrequent causal associations and its application in finding adverse drug reaction signal pairs,” IEEE Transactions on knowledge and data engineering",
      "citeRegEx" : "22",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Comparing data-mining algorithms developed for longitudinal observational databases.",
      "author" : [ "J. Reps", "J.M. Garibaldi", "U. Aickelin", "D. Soria", "J.E. Gibson", "R.B. Hubbard" ],
      "venue" : "Computational Intelligence (UKCI),",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2012
    }, {
      "title" : "and B",
      "author" : [ "J.D. Lewis", "W.B. Bilker", "R.B. Weinstein" ],
      "venue" : "L. Strom, “The relationship between time since registration and measured incidence rates in the general practice research database,” Pharmacoepidemiol Drug Saf, vol. 14(7), pp. 443–451",
      "citeRegEx" : "24",
      "shortCiteRegEx" : null,
      "year" : 2005
    }, {
      "title" : "Distance metric learning with eigenvalue optimization,",
      "author" : [ "Y. Ying", "P. Li" ],
      "venue" : "JMLR, vol",
      "citeRegEx" : "26",
      "shortCiteRegEx" : "26",
      "year" : 2012
    }, {
      "title" : "and R",
      "author" : [ "S. Basu", "A. Banerjee" ],
      "venue" : "Mooney, “Semi-supervised clustering by seeding,” Proceedings of the 19th International Conference on Machine Learning ",
      "citeRegEx" : "27",
      "shortCiteRegEx" : null,
      "year" : 2002
    }, {
      "title" : "S",
      "author" : [ "D.J. Graham", "D. Campen", "R. Hui", "M. Spence", "C. Cheetham", "G. Levy" ],
      "venue" : "S, and W. A. Ray, “Risk of acute myocardial infarction and sudden cardiac death in patients treated with cyclo-oxygenase 2 selective and nonselective nonsteroidal anti-inflammatory drugs: nested case control study,” Lancet, vol. 365(9458), pp. 475–81",
      "citeRegEx" : "28",
      "shortCiteRegEx" : null,
      "year" : 2005
    }, {
      "title" : "and L",
      "author" : [ "J.P. Desprs", "A. Golay" ],
      "venue" : "S. L, “Effects of rimonabant on metabolic risk factors in overweight patients with dyslipidemia.” N Engl J Med, vol. 353(20), pp. 2121–2134",
      "citeRegEx" : "29",
      "shortCiteRegEx" : null,
      "year" : 2005
    }, {
      "title" : "and A",
      "author" : [ "R. Christensen", "P.K. Kristensen", "E.M. Bartels", "H. Bliddal" ],
      "venue" : "Astrup, “Efficacy and safety of the weight-loss drug rimonabant: a meta-analysis of randomised trials,” Lancet, vol. 370(9600), pp. 1706–1713",
      "citeRegEx" : "30",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "and G",
      "author" : [ "A. Carnovale", "P. Esposito", "P. Bassano", "L. Russo" ],
      "venue" : "Uomo, “Enalapril-induced acute recurrent pancreatitis,” Digestive and Liver Disease, vol. 35(1), pp. 55–57",
      "citeRegEx" : "31",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Drug-induced pancreatitis: Incidence",
      "author" : [ "A.R. Balani", "J.H. Grendell" ],
      "venue" : "management and prevention,” Drug Safety, vol. 31(10), pp. 823–837",
      "citeRegEx" : "32",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "Renal adverse effects of nonsteroidal anti-inflammatory drugs.",
      "author" : [ "S. Harirforoosh", "F. Jamali" ],
      "venue" : "Expert Opin Drug Saf,",
      "citeRegEx" : "33",
      "shortCiteRegEx" : "33",
      "year" : 2009
    }, {
      "title" : "and C",
      "author" : [ "S. Ali", "J.D. Pimentel" ],
      "venue" : "Ma, “Naproxen-induced liver injury.” Hepatobiliary Pancreat Dis Int, vol. 10(5), pp. 552–556",
      "citeRegEx" : "34",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Nsaid-related psychiatric adverse events: Who is at risk?” Drugs",
      "author" : [ "G. Onder", "F. Pellicciotti", "G. Gambassi", "R. Bernabei" ],
      "venue" : "vol. 64(23), pp. 2619–2627",
      "citeRegEx" : "35",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "Fluoroquinolones and risk of achilles tendon disorders: case-control",
      "author" : [ "P.D. van der Linden", "M.C.J.M. Sturkenboom", "R.M.C. Herings", "H.G.M. Leufkens", "B.H.C. Stricker" ],
      "venue" : "study,” BMJ,",
      "citeRegEx" : "37",
      "shortCiteRegEx" : "37",
      "year" : 2002
    }, {
      "title" : "Thrombocytopenia – a rare but potentially serious side effect of initial daily and interrupted use of rifampicin,",
      "author" : [ "C.H. Lee", "C.J. Lee" ],
      "venue" : "CHEST, vol",
      "citeRegEx" : "38",
      "shortCiteRegEx" : "38",
      "year" : 1989
    }, {
      "title" : "Metformin-associated lactic acidosis: a rare or very rare clinical entity?” Diabetic Medicine",
      "author" : [ "N.N. Chan", "H.P.S. Brian", "M.D. Feher" ],
      "venue" : "vol. 16(4), pp. 273–281",
      "citeRegEx" : "39",
      "shortCiteRegEx" : null,
      "year" : 1999
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "INTRODUCTION Negative side effects caused by prescribed medication currently present a huge burden for the healthcare service in terms of causing both patient morbidity or mortality and costing large sums of money [1] [2] [3].",
      "startOffset" : 214,
      "endOffset" : 217
    }, {
      "referenceID" : 1,
      "context" : "INTRODUCTION Negative side effects caused by prescribed medication currently present a huge burden for the healthcare service in terms of causing both patient morbidity or mortality and costing large sums of money [1] [2] [3].",
      "startOffset" : 218,
      "endOffset" : 221
    }, {
      "referenceID" : 2,
      "context" : "INTRODUCTION Negative side effects caused by prescribed medication currently present a huge burden for the healthcare service in terms of causing both patient morbidity or mortality and costing large sums of money [1] [2] [3].",
      "startOffset" : 222,
      "endOffset" : 225
    }, {
      "referenceID" : 3,
      "context" : "Investigations have shown that the rate of unwanted side effects has been increasing annually [4] [5].",
      "startOffset" : 94,
      "endOffset" : 97
    }, {
      "referenceID" : 4,
      "context" : "Investigations have shown that the rate of unwanted side effects has been increasing annually [4] [5].",
      "startOffset" : 98,
      "endOffset" : 101
    }, {
      "referenceID" : 5,
      "context" : "Possible reasons for this are an increase in the number of annual prescriptions due to an aging population or an increase in polypharmacy, when numerous drugs are prescribed at the same time [6].",
      "startOffset" : 191,
      "endOffset" : 194
    }, {
      "referenceID" : 6,
      "context" : "3% [7].",
      "startOffset" : 3,
      "endOffset" : 6
    }, {
      "referenceID" : 7,
      "context" : "A more recent study in Brazil suggests ADRs may be the cause of an even higher proportion of hospital admissions for the elderly as it showed that ADRs were the cause of hospitalisation for over 50% of elderly patients [8].",
      "startOffset" : 219,
      "endOffset" : 222
    }, {
      "referenceID" : 7,
      "context" : "It also highlighted that a significant factor for developing an ADR was polypharmacy [8], when patients are prescribed multiple drugs.",
      "startOffset" : 85,
      "endOffset" : 88
    }, {
      "referenceID" : 8,
      "context" : "Due to the limitations of clinical trials, rare ADRs, including fatal ones, are in most circumstances not discovered before a drug is marketed [9] [10].",
      "startOffset" : 143,
      "endOffset" : 146
    }, {
      "referenceID" : 9,
      "context" : "Due to the limitations of clinical trials, rare ADRs, including fatal ones, are in most circumstances not discovered before a drug is marketed [9] [10].",
      "startOffset" : 147,
      "endOffset" : 151
    }, {
      "referenceID" : 10,
      "context" : "For example, it took 23 years before there was sufficient evidence that the drug Tamoxifen used to treat breast cancer caused endometrial cancer in about 1 in 6000 patients [11] [12].",
      "startOffset" : 173,
      "endOffset" : 177
    }, {
      "referenceID" : 11,
      "context" : "For example, it took 23 years before there was sufficient evidence that the drug Tamoxifen used to treat breast cancer caused endometrial cancer in about 1 in 6000 patients [11] [12].",
      "startOffset" : 178,
      "endOffset" : 182
    }, {
      "referenceID" : 12,
      "context" : "The frequently implemented measures of disproportionality involve using standard epidemiology measures [13], estimating the information component using a neural network approach [14] or calculating a modified version of the relative risk by applying a Bayesian model [15].",
      "startOffset" : 103,
      "endOffset" : 107
    }, {
      "referenceID" : 13,
      "context" : "The frequently implemented measures of disproportionality involve using standard epidemiology measures [13], estimating the information component using a neural network approach [14] or calculating a modified version of the relative risk by applying a Bayesian model [15].",
      "startOffset" : 178,
      "endOffset" : 182
    }, {
      "referenceID" : 14,
      "context" : "The frequently implemented measures of disproportionality involve using standard epidemiology measures [13], estimating the information component using a neural network approach [14] or calculating a modified version of the relative risk by applying a Bayesian model [15].",
      "startOffset" : 267,
      "endOffset" : 271
    }, {
      "referenceID" : 15,
      "context" : "SRS databases combine reports of possible ADRs from a large population enabling the identification of possible ADR signals more efficiently, but they are known to suffer from underreporting [16] and this causes a lag in the time it takes to confidently signal a potential ADR.",
      "startOffset" : 190,
      "endOffset" : 194
    }, {
      "referenceID" : 16,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 264,
      "endOffset" : 268
    }, {
      "referenceID" : 17,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 269,
      "endOffset" : 273
    }, {
      "referenceID" : 18,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 274,
      "endOffset" : 278
    }, {
      "referenceID" : 19,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 314,
      "endOffset" : 318
    }, {
      "referenceID" : 20,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 319,
      "endOffset" : 323
    }, {
      "referenceID" : 21,
      "context" : "Existing methods developed for the EHDs are often disproportionality based methods (methods that contrast how often the event of interest occurs after the specified drug relative to how often the event of interest occurs after any drug) similar to the SRS methods [17] [18] [19] or association rule mining methods [20] [21] [22].",
      "startOffset" : 324,
      "endOffset" : 328
    }, {
      "referenceID" : 22,
      "context" : "It has been demonstrated that these existing methods are currently not suitable for signalling rare ADRs [23].",
      "startOffset" : 105,
      "endOffset" : 109
    }, {
      "referenceID" : 23,
      "context" : "Patients can register at a new practice at any point over their lifetime and it has been shown that statistical studies using the THIN database will be biased if records from the first year after registration for a patient are included in the study [24].",
      "startOffset" : 249,
      "endOffset" : 253
    }, {
      "referenceID" : 16,
      "context" : "Existing Algorithms The observed to expected (OE) ratio [17] calculates the information component (IC) that looks at the disproportionality between how often a Read Code is recorded within some time period after the first prescription in 13 months of the drug of interest compared to how often it is recorded within the same time period after the first prescription in 13 months of any drug but also adds a bias lowering the IC value if the Read Code or drug is rare.",
      "startOffset" : 56,
      "endOffset" : 60
    }, {
      "referenceID" : 20,
      "context" : "The algorithm Mining Unexpected Temporary Association Rules given the Antecedent (MUTARA) [21] applies a case control approach that estimates the background rate that the Read Code is recorded into the THIN database by finding out how many patients who have not been prescribed the drug of interest have the Read Code recorded during a random time interval.",
      "startOffset" : 90,
      "endOffset" : 94
    }, {
      "referenceID" : 21,
      "context" : "The algorithm Highlighting UTARs Negating TARs (HUNT) [22] was developed by the same authors as MUTARA and applies a similar method but is less prone to ranking therapeutic failure Read Codes (Read Codes linked to the cause of taking the drug) above Read Codes corresponding to ADRs.",
      "startOffset" : 54,
      "endOffset" : 58
    }, {
      "referenceID" : 19,
      "context" : "In previous methods there has been a patient level filter that removes medical events from a patient’s sequence that occur 30 days after the drug if the patient also had the medical event shortly prior to the drug [20].",
      "startOffset" : 214,
      "endOffset" : 218
    }, {
      "referenceID" : 24,
      "context" : "Step 3 After labelling some of the Read Codes we then applied the metric learning algorithm detailed in [26].",
      "startOffset" : 104,
      "endOffset" : 108
    }, {
      "referenceID" : 24,
      "context" : "do Z t =argmax{fμ(S μ t ) + 〈Z,∇fμ(S μ t )〉 : Z ∈ Sd +, Tr(Z)=1 }, that is, Z μ t = νν T where ν is the maximal eigenvector of the matrix ∇fμ(S t ) S t+1 = (1− αt)S μ t + αtZ μ t if |fμ(S t+1)− fμ(S μ t )| < tol then break end Algorithm 1: The distance metric learning algorithm from [26]",
      "startOffset" : 284,
      "endOffset" : 288
    }, {
      "referenceID" : 25,
      "context" : "Step 4 The constrained K-means algorithm [27] is applied to the Read Codes on their corresponding transformed data points determined by the distance metric learning algorithm above.",
      "startOffset" : 41,
      "endOffset" : 45
    }, {
      "referenceID" : 25,
      "context" : "μ (t+1) h ← 1 |X h | ∑ x∈X h x t← (t+ 1) until convergence; Algorithm 2: The Constrained K-means algorithm developed in [27] Read Codes in the same cluster as the Read Codes that were originally labelled as known ADRs are referred to as being in the ADR cluster, Read Codes in the same cluster as the Read Codes that were originally labelled as indicators are referred to as being in the indicator cluster and Read Codes in the same cluster as the Read Codes that were originally labelled as noise are referred to as being in the noise cluster.",
      "startOffset" : 120,
      "endOffset" : 124
    }, {
      "referenceID" : 1,
      "context" : "2 4% [2 8] 83 30 2 19 6 12 12",
      "startOffset" : 5,
      "endOffset" : 10
    }, {
      "referenceID" : 7,
      "context" : "2 4% [2 8] 83 30 2 19 6 12 12",
      "startOffset" : 5,
      "endOffset" : 10
    }, {
      "referenceID" : 1,
      "context" : "2 4% [2 8] 12 1 80 5 50 4 56 2",
      "startOffset" : 5,
      "endOffset" : 10
    }, {
      "referenceID" : 7,
      "context" : "2 4% [2 8] 12 1 80 5 50 4 56 2",
      "startOffset" : 5,
      "endOffset" : 10
    }, {
      "referenceID" : 1,
      "context" : "6% [2 9] 16 32 15 68",
      "startOffset" : 3,
      "endOffset" : 8
    }, {
      "referenceID" : 8,
      "context" : "6% [2 9] 16 32 15 68",
      "startOffset" : 3,
      "endOffset" : 8
    }, {
      "referenceID" : 2,
      "context" : "R im on ab an t O be si ty D ep re ss iv e di so rd er N E C 20 08 3 % [3 0] 23 18 0 29 5 11 57",
      "startOffset" : 71,
      "endOffset" : 76
    }, {
      "referenceID" : 2,
      "context" : "E na la pr il H yp er te ns io n/ H ea rt fa ilu re A cu te pa nc re at iti s ra re [3 1] [3 2] 53 70 0 41 6 20 81",
      "startOffset" : 84,
      "endOffset" : 89
    }, {
      "referenceID" : 0,
      "context" : "E na la pr il H yp er te ns io n/ H ea rt fa ilu re A cu te pa nc re at iti s ra re [3 1] [3 2] 53 70 0 41 6 20 81",
      "startOffset" : 84,
      "endOffset" : 89
    }, {
      "referenceID" : 2,
      "context" : "E na la pr il H yp er te ns io n/ H ea rt fa ilu re A cu te pa nc re at iti s ra re [3 1] [3 2] 53 70 0 41 6 20 81",
      "startOffset" : 90,
      "endOffset" : 95
    }, {
      "referenceID" : 1,
      "context" : "E na la pr il H yp er te ns io n/ H ea rt fa ilu re A cu te pa nc re at iti s ra re [3 1] [3 2] 53 70 0 41 6 20 81",
      "startOffset" : 90,
      "endOffset" : 95
    }, {
      "referenceID" : 2,
      "context" : "N ap ro xe n Pa in /in fla m m at io n A cu te re na l fa ilu re ra re [3 3] 20 15 9 13 8 13 13",
      "startOffset" : 71,
      "endOffset" : 76
    }, {
      "referenceID" : 2,
      "context" : "N ap ro xe n Pa in /in fla m m at io n A cu te re na l fa ilu re ra re [3 3] 20 15 9 13 8 13 13",
      "startOffset" : 71,
      "endOffset" : 76
    }, {
      "referenceID" : 2,
      "context" : "N ap ro xe n Pa in /in fla m m at io n Ja un di ce ra re [3 4] 52 77 4 33 94 41 90",
      "startOffset" : 57,
      "endOffset" : 62
    }, {
      "referenceID" : 3,
      "context" : "N ap ro xe n Pa in /in fla m m at io n Ja un di ce ra re [3 4] 52 77 4 33 94 41 90",
      "startOffset" : 57,
      "endOffset" : 62
    }, {
      "referenceID" : 2,
      "context" : "N ap ro xe n Pa in /in fla m m at io n H ep at iti s un sp ec ifi ed ra re [3 4] 24 1 35 85 2 35 02",
      "startOffset" : 75,
      "endOffset" : 80
    }, {
      "referenceID" : 3,
      "context" : "N ap ro xe n Pa in /in fla m m at io n H ep at iti s un sp ec ifi ed ra re [3 4] 24 1 35 85 2 35 02",
      "startOffset" : 75,
      "endOffset" : 80
    }, {
      "referenceID" : 2,
      "context" : "N ap ro xe n Pa in /in fla m m at io n Su ic id e an d se lfi nfl ic te d in ju ry ra re [3 5] 10 4 22 3 24 2 18 08",
      "startOffset" : 89,
      "endOffset" : 94
    }, {
      "referenceID" : 4,
      "context" : "N ap ro xe n Pa in /in fla m m at io n Su ic id e an d se lfi nfl ic te d in ju ry ra re [3 5] 10 4 22 3 24 2 18 08",
      "startOffset" : 89,
      "endOffset" : 94
    }, {
      "referenceID" : 2,
      "context" : "N if ed ip in e H yp er te ns io n/ A ng in a W ei gh t in cr ea si ng ≤ 1% [3 6] 36 2 29 15 17 14 92",
      "startOffset" : 76,
      "endOffset" : 81
    }, {
      "referenceID" : 5,
      "context" : "N if ed ip in e H yp er te ns io n/ A ng in a W ei gh t in cr ea si ng ≤ 1% [3 6] 36 2 29 15 17 14 92",
      "startOffset" : 76,
      "endOffset" : 81
    }, {
      "referenceID" : 2,
      "context" : "N if ed ip in e H yp er te ns io n/ A ng in a Fe el s ho t/f ev er is h ≤ 2% [3 6] 31 4 42 8 19 72 74 80",
      "startOffset" : 77,
      "endOffset" : 82
    }, {
      "referenceID" : 5,
      "context" : "N if ed ip in e H yp er te ns io n/ A ng in a Fe el s ho t/f ev er is h ≤ 2% [3 6] 31 4 42 8 19 72 74 80",
      "startOffset" : 77,
      "endOffset" : 82
    }, {
      "referenceID" : 2,
      "context" : "C ip ro flo xa ci n B ac te ri al in fe ct io ns N on tr au m at ic ru pt ur e of A ch ill es te nd on ra re [3 7] 13 42 12 73 55 06",
      "startOffset" : 109,
      "endOffset" : 114
    }, {
      "referenceID" : 6,
      "context" : "C ip ro flo xa ci n B ac te ri al in fe ct io ns N on tr au m at ic ru pt ur e of A ch ill es te nd on ra re [3 7] 13 42 12 73 55 06",
      "startOffset" : 109,
      "endOffset" : 114
    }, {
      "referenceID" : 2,
      "context" : "L ev ofl ox ac in B ac te ri al in fe ct io ns R up tu re A ch ill es te nd on ra re [3 7] 76 29 6 -",
      "startOffset" : 85,
      "endOffset" : 90
    }, {
      "referenceID" : 6,
      "context" : "L ev ofl ox ac in B ac te ri al in fe ct io ns R up tu re A ch ill es te nd on ra re [3 7] 76 29 6 -",
      "startOffset" : 85,
      "endOffset" : 90
    }, {
      "referenceID" : 2,
      "context" : "L ev ofl ox ac in B ac te ri al in fe ct io ns N on tr au m at ic ru pt ur e of A ch ill es te nd on ra re [3 7] 29 8 27 9 32 0 11 89",
      "startOffset" : 107,
      "endOffset" : 112
    }, {
      "referenceID" : 6,
      "context" : "L ev ofl ox ac in B ac te ri al in fe ct io ns N on tr au m at ic ru pt ur e of A ch ill es te nd on ra re [3 7] 29 8 27 9 32 0 11 89",
      "startOffset" : 107,
      "endOffset" : 112
    }, {
      "referenceID" : 2,
      "context" : "R ifa m pi ci n Tu be rc ul os is /in fe ct io ns T hr om bo cy to pe ni a N O S ra re [3 8] 75 41 8 26 5 10 03",
      "startOffset" : 87,
      "endOffset" : 92
    }, {
      "referenceID" : 7,
      "context" : "R ifa m pi ci n Tu be rc ul os is /in fe ct io ns T hr om bo cy to pe ni a N O S ra re [3 8] 75 41 8 26 5 10 03",
      "startOffset" : 87,
      "endOffset" : 92
    }, {
      "referenceID" : 2,
      "context" : "00 5 % [3 9] -",
      "startOffset" : 7,
      "endOffset" : 12
    }, {
      "referenceID" : 8,
      "context" : "00 5 % [3 9] -",
      "startOffset" : 7,
      "endOffset" : 12
    }, {
      "referenceID" : 2,
      "context" : "00 5 % [3 9] 44 9 81 3 46 6 32 23",
      "startOffset" : 7,
      "endOffset" : 12
    }, {
      "referenceID" : 8,
      "context" : "00 5 % [3 9] 44 9 81 3 46 6 32 23",
      "startOffset" : 7,
      "endOffset" : 12
    } ],
    "year" : 2014,
    "abstractText" : "Drugs are frequently prescribed to patients with the aim of improving each patient’s medical state, but an unfortunate consequence of most prescription drugs is the occurrence of undesirable side effects. Side effects that occur in more than one in a thousand patients are likely to be signalled efficiently by current drug surveillance methods, however, these same methods may take decades before generating signals for rarer side effects, risking medical morbidity or mortality in patients prescribed the drug while the rare side effect is undiscovered. In this paper we propose a novel computational meta-analysis framework for signalling rare side effects that integrates existing methods, knowledge from the web, metric learning and semi-supervised clustering. The novel framework was able to signal many known rare and serious side effects for the selection of drugs investigated, such as tendon rupture when prescribed Ciprofloxacin or Levofloxacin, renal failure with Naproxen and depression associated with Rimonabant. Furthermore, for the majority of the drug investigated it generated signals for rare side effects at a more stringent signalling threshold than existing methods and shows the potential to become a fundamental part of post marketing surveillance to detect rare side effects.",
    "creator" : "LaTeX with hyperref package"
  }
}