{
  "name" : "1304.5575.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Inverse Density as an Inverse Problem: the Fredholm Equation Approach",
    "authors" : [ "Qichao Que", "Mikhail Belkin" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "In this paper we address the problem of estimating the ratio q p\nOur approach is based on reformulating the problem of estimating q p\nas an inverse problem in terms of an integral operator corresponding to a kernel, and thus reducing it to an integral equation, known as the Fredholm problem of the first kind. This formulation, combined with the techniques of regularization and kernel methods, leads to a principled kernel-based framework for constructing algorithms and for analyzing them theoretically.\nThe resulting family of algorithms (FIRE, for Fredholm Inverse Regularized Estimator) is flexible, simple and easy to implement.\nWe provide detailed theoretical analysis including concentration bounds and convergence rates for the Gaussian kernel in the case of densities defined on Rd, compact domains in Rd and smooth d-dimensional sub-manifolds of the Euclidean space.\nWe also show experimental results including applications to classification and semi-supervised learning within the covariate shift framework and demonstrate some encouraging experimental comparisons. We also show how the parameters of our algorithms can be chosen in a completely unsupervised manner."
    }, {
      "heading" : "1 Introduction",
      "text" : "Density estimation is one of the best-studied and most useful problems in statistical inference. The question is to estimate the probability density function p(x) from a sample x1, . . . , xn. There is a rich literature on the subject (e.g., see the review [11]), particularly, dealing with a class of non-parametric kernel estimators going back to the work of Parzen [20].\nIn this paper we address the related problem of estimating the ratio of two functions, q(x)p(x) where p is given by a sample and q(x) is either a known function or another probability density function given by a sample. We note that estimating such ratio is necessary when one attempts to integrate a function with respect to one density, given its values on a sample obtained from another distribution. This is typical when the process generating the data is different from the averaging problem we wish to address. To give a very simple practical example of such a situation, consider a cleaning robot equipped with a dirt sensor. We would like to know how well the robot performs cleaning, however, the probability density of the robot location p(x) depends on the program and is clearly not uniform. To obtain the cleaning quality, we need to average the sensor readings with respect to the uniform density over the floor rather than the location distribution, which requires estimating the inverse 1p (here q(x) it the constant function 1).\nAn important class of applications for density ratios relates to various Markov Chain Monte Carlo (MCMC) integration techniques used in various applications, in particular, in many tasks of Bayesian inference. It is often hard to sample directly from the desirable probability distribution but it may be possible to construct an approximation which is easier to sample from. The class of techniques related to the importance sampling (see, e.g., [16]) deals with this problem by using a ratio of two densities (which is typically assumed to be known in that literature).\nar X\niv :1\n30 4.\n55 75\nv2 [\ncs .L\nG ]\n2 5\nA pr\n2 01\n3\nRecently there have been a significant amount of work on estimating the density ratio (also known as te importance function) from sampled data, e.g., [8, 13, 10, 28, 3]. Many of these papers consider this problem in the context of covariate shift assumption [24] or the so-called selection bias [36]. Our Fredholm Inverse Regularized Estimator (FIRE) framework introduces a very general and flexible approach to this problem which leads to more efficient algorithms design, provides very competitive experimental results and makes possible theoretical analysis in terms of the sample complexity and convergence rates.\nWe will provide a more detailed discussion of these and other related papers and connections to our work in Section 2, where we also discuss how the Kernel Mean Matching algorithm [8, 10] can be viewed within our framework.\nThe approach taken in our paper is based on reformulating the density ratio estimation as an integral equation, known as the Fredholm equation of the first kind (in the classical one-dimensional case), and solving it using the tools of regularization and Reproducing Kernel Hilbert Spaces. That allows us to develop simple and flexible algorithms for density ratio estimation within the popular kernel learning framework. In addition the integral operator approach separates estimation and regularization problems, thus allowing us to address certain settings where the existing methods are not applicable. The connection to the classical operator theory setting makes it easier to apply the standard tools of spectral analysis to obtain theoretical results.\nWe will now briefly outline the main idea of this paper. We start with the following simple equality underlying the importance sampling method:\nEq(h) =\n∫ h(x)q(x)dx = ∫ h(x) q(x)\np(x) p(x)dx = Ep\n( h(x) q(x)\np(x)\n) (1)\nBy replacing the function h(x) with a kernel k(x, y), we obtain\nKp q\np (x) :=\n∫ k(x, y) q(y)\np(y) p(y)dy =\n∫ k(x, y)q(y)dy := Kq1(x). (2)\nThinking of the function q(x)p(x) as an unknown quantity and assuming that the right hand side is known this becomes an integral equation (known as the Fredholm equation of the first type). Note that the right-hand side can be estimated given a sample from q while the operator on the left can be estimated using a sample from p.\nTo push this idea further, suppose kt(x, y) is a “local” kernel, (e.g., the Gaussian, kt(x, y) = 1 (2πt)d/2 e− ‖x−y‖2 2t ) such that ∫ Rd kt(x, y)dx = 1. Convolution with such a kernel is close to the δ-function, i.e., ∫ Rd kt(x, y)f(x)dx = f(y) +O(t). Thus we get another (approximate) integral equality:\nKt,p q\np (y) := ∫ Rd kt(x, y) q(x) p(x) p(x)dx ≈ q(y). (3)\nIt becomes an integral equation for q(x)p(x) , assuming that q is known or can be approximated.\nWe address these inverse problems by formulating them within the classical framework1 of TiknonovPhilips regularization with the penalty term corresponding to the norm of the function in the Reproducing Kernel Hilbert Space H with kernel kH used in many machine learning algorithms.\n[Type I]: q\np ≈ arg min f∈H ‖Kpf −Kq1‖2L2,p + λ‖f‖ 2 H [Type II]:\nq p ≈ arg min f∈H ‖Kt,pf − q‖2L2,p + λ‖f‖ 2 H\nImportantly, given a sample x1, . . . , xn from p, the integral operator Kpf applied to a function f can be approximated by the corresponding discrete sum Kpf(x) ≈ 1n ∑ i f(xi)K(xi, x), while L2,p norm is approximated by an average: ‖f‖2L2,p ≈ 1 n ∑ i f(xi)\n2. Of course, the same holds for a sample from q. Thus, we see that the Type I formulation is useful when q is a density and samples from both p and q are available, while the Type II is useful, when the values of q (which does not have to be a density function at all2) are known at the data points sampled from p.\nSince all of these involve only function evaluations at the sample points, by an application of the usual representer theorem for Reproducing Kernel Hilbert Spaces, both Type I and II formulations lead to simple, explicit and easily implementable algorithms, representing the solution of the optimization problem as linear combinations of the kernels over the points of the sample ∑ i αikH(xi, x) (see Section 3). We call the resulting algorithms FIRE for Fredholm Inverse Regularized Estimator.\n1In fact our formulation is quite close to the original formulation of Tikhonov. 2This could be important in various sampling procedures, for example, when the normalizing coefficients are hard to estimate.\nSome remarks would be useful at this point. Remark 1: Other norms and loss functions. Norms and loss functions other that L2,p can also be used in our setting as long as they can be approximated from a sample using function evaluations.\n• Perhaps, the most interesting is the norm L2,q norm available in the Type I setting, when a sample from the probability distribution q is available. In fact, given a sample from both p and q we can use the combined empirical norm γL2,p + (1− γ)L2,q. Optimization using those norms leads to some interesting looking kernel algorithms described in Section 3. We note that the solution is still a linear combination of kernel functions on centered on the sample from p and can still be written explicitly.\n• In the Type I formulation, if the kernels k(x, y) and kH(x, y) coincide, it is possible to use the RKHS norm ‖ · ‖H instead of L2,p. This formulation (see Section 3) also yields an explicit formula and is related to the Kernel Mean Matching algorithm [10] (see the discussion in Section 2), although with a different optimization procedure. We note that the solution in our framework has a natural out-of-sample extension, which becomes important for proper parameter selection.\n• Other norms/loss functions, e.g., L1,p, L1,q, -insensitive loss from the SVM regression, etc., can also be used in our framework as long as they can be approximated from a sample using function evaluations. We note that some of these may have advantages in terms of the sparsity of the resulting solution. On the other hand, a standard advantage of using the square norm is the ease of cross-validation with respect to the parameter λ.\nRemark 2: Other regularization methods. Several regularization methods other than TikhonovPhilips regularization are available. We will briefly discuss the spectral cut-off regularization and its potential advantages in Section 3. We note that other methods, such as early stopping (e.g., [34, 1]) can be used and may have computational advantages. Remark 3. We note that an intermediate “Type 1.5” formulation is also available. Specifically, for two ”δ-kernels” K and K ′, we have Kp qp ≈ K ′ q1, thus using two different kernels in the Type I formulation\nq p ≈ arg min f∈H ‖Kpf −K′q1‖2L2,p + λ‖f‖ 2 H (4)\nThe ability to use kernels with different bandwidth for p and q may be potentially important in practice, especially when the samples from p and q have very different cardinality. The resulting algorithms for this setting are described in in Section 3. Of course, the previous two remarks apply to this setting as well.\nSince we are dealing with a classical inverse problem for integral operators, our formulation allows for theoretical analysis using the methods of spectral theory. In Section 4 we prove concentration and error bounds as well as convergence rates for our algorithms when data are sampled from a distribution defined in Rd, a domain in Rd with boundary or a compact d-dimensional sub-manifold of a Euclidean space RN for the case of the Gaussian kernel.\nIt is interesting to note that unlike the usual density estimation problem the width of the kernel does not need to go to zero for convergence. However, it is necessary if we want a polynomial convergence rate. This is related to the exponential decay of eigenvalues for the Gaussian kernel.\nFinally, in Section 6 we discuss the experimental results on several data sets comparing our method FIRE with the available alternatives, Kernel Mean Matching (KMM) [10] and LSIF [13] as well as the base-line thresholded inverse kernel density estimator3 (TIKDE) and importance sampling (when available).\nWe summarize the contributions of the paper as follows:\n1. We provide a formulation of estimating the density ratio (importance function) as a classical inverse problem, known as the Fredholm equation, establishing a connections to the methods of classical analysis. The underlying idea is to “linearize” the properties of the density by studying an associated integral operator.\n2. To solve the resulting inverse problems we apply regularization with an RKHS norm penalty. This provides a flexible and principled framework, with a variety of different norms and regularization techniques available. It separates the underlying inverse problem from the necessary regularization and leads to a family of very simple and direct algorithms within the kernel learning framework in machine learning. We call the resulting algorithms FIRE for Fredholm Inverse Regularized Estimator.\n3Obtained by dividing the standard kernel density estimator for q by a thresholded kernel density estimator for p Interestingly, despite its simplicity it performs quite well in many settings.\n3. Using the techniques of spectral analysis and concentration, we provide a detailed theoretical analysis for the case of the Gaussian kernel, for Euclidean case as well as distributions supported on a submanifold. We prove error bounds and as well as the convergence rates (as far as we know, it is the first convergence rate analysis for density ratio estimation). We also comment on other kernels and potential extensions of our analysis.\n4. We evaluate and compare our methods on several real-world and artificial different data sets and in several settings and demonstrate strong performance and better computational efficiency compared to the alternatives. We also propose a completely unsupervised technique for cross-validating the parameters of our algorithm and demonstrate its usefulness, thus addressing in our setting one of the most thorny issues in unsupervised/semi-supervised learning.\n5. Finally, our framework allows us to address several different settings related to a number of problems in areas from covariate shift classification in transfer learning to importance sampling in MCMC to geometry estimation and numerical integration. Some of these connections are explored in this paper and some we hope to address in the future work."
    }, {
      "heading" : "2 Related work",
      "text" : "The problem of density estimation has a long history in classical statistical literature and a rich variety of methods are available [11]. However, as far as we know the problem of estimating the inverse density or density ratio from a sample has not been studied extensively until quite recently. Some of the related older work includes density estimation for inverse problems [7] and the literature on deconvolution, e.g., [4].\nIn the last few years the problem of density ratio estimation has received significant attention due in part to the increased interest in transfer learning [19] and, in particular to the form of transfer learning known as covariate shift [24]. To give a brief summary, given the feature space X and the label space Y , two probability distributions p and q on X×Y satisfy the covariate assumption if for all x, y, p(y|x) = q(y|x). It is easy to see that training a classifier to minimize the error for q, given a sample from p requires estimating the ratio of the marginal distributions qX(x)pX(x) . Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10]. KMM is based on the observation that Eq(Φ(x)) = Ep( q pΦ(x)), where Φ is the feature map corresponding to an RKHS H. It is rewritten as an optimization problem\nq(x) p(x) = arg min β∈L2,β(x)>0,Ep(β)=1 ‖Eq(Φ(x))− Ep(β(x)Φ(x))‖H (5)\nThe quantity on the right can be estimated given a sample from p and a sample from q and the minimization becomes a quadratic optimization problem over the values of β at the points sampled from p. Writing down the feature map explicitly, i.e., recalling that Φ(x) = KH(x, ·), we see that the equality Eq(Φ(x)) = Ep( q pΦ(x)) is equivalent to the integral equation Eq. 2 considered as an identity in the Hilbert space H. Thus the problem of KMM can be viewed within our setting Type I (see the Remark 2 in the introduction), with a RKHS norm but a different optimization algorithm.\nHowever, while the KMM optimization problem in Eq. 5 uses the RKHS norm, the weight function β itself is not in the RKHS. Thus, unlike most other algorithms in the RKHS framework (in particular, FIRE), the empirical optimization problem resulting from Eq. 5 does not have a natural out-of-sample extension4.\nAlso, since there is no regularizing term, the problem is less stable (see Section 6 for some experimental comparisons) and the theoretical analysis is harder (however, see [8] and the recent paper [35] for some nice theoretical analysis of KMM in certain settings).\nAnother related recent algorithm is Least Squares Importance Sampling (LSIF) [13], which attempts to estimate the density ratio by choosing a parametric linear family of functions and choosing a function from this family to minimize the L2,p distance to the density ratio. A similar setting with the Kullback-Leibler distance (KLIEP) was proposed in [29]. This has an advantage of a natural out-of-sample extension property. We note that our method for unsupervised parameter selection in Section 6 is related to their ideas. However, in our case the set of test functions does not need to form a good basis since no approximation is required.\nWe note that our methods are closely related to a large body of work on kernel methods in machine learning and statistical estimation (e.g., [26, 22, 21]). Many of these algorithms can be interpreted as inverse problems, e.g., [5, 25] in the Tikhonov regularization or other regularization frameworks. In particular,\n4In particular, this becomes an issue for model selection, see Section 6.\nwe note interesting methods for density estimation proposed in [31] and estimating the support of density through spectral regularization in [6], as well as robust density estimation using RKHS formulations [14] and conditional density [9].\nWe also note the connections of the methods in this paper to properties of density-dependent operators in classification and clustering [33, 23]. There are also connections to geometry and density-dependent norms for semi-supervised learning, e.g., [2].\nFinally, the setting in this paper is connected to the large literature on integral equations [15]. In particular, we note [32], which analyzes the classical Fredholm problem using regularization for noisy data."
    }, {
      "heading" : "3 Settings and Algorithms",
      "text" : ""
    }, {
      "heading" : "3.1 Some preliminaries",
      "text" : "We start by introducing some objects and function spaces important for our development. As usual, the space of square-integrable functions with respect to a measure ρ, is defined as follows:\nL2,ρ =\n{ f : ∫ Ω |f(x)|2dρ <∞ } .\nThis is a Hilbert space with the inner product defined in the usual way by 〈f, g〉2,ρ = ∫\nΩ f(x)g(x)dρ.\nGiven a function of two variables k(x, y) (a kernel), we define the operator Kρ: Kρf(y) := ∫\nΩ\nk(x, y)f(x)dρ(x).\nWe will use the notation Kt,ρ to explicitly refer to the parameter of the kernel function kt(x, y), when it is a δ-family.\nIf the function k(x, y) is symmetric and positive definite, then there is a corresponding Reproducing Kernel Hilbert space (RKHS) H. We recall the key property of the kernel kH: for any f ∈ H, 〈f, kH(x, ·)〉H = f(x). The direct consequence of this is the Representer Theorem, which allows us to write solutions to various optimization problems over H in terms of linear combinations of kernels supported on sample points (see [26] for an in-depth discussion or the RKHS theory and the issues related to learning).\nIt is important to note that in some of our algorithms the RKHS kernel kH will be different from the kernel of the integral operator k.\nGiven a sample x1, . . . , xn from p, one can approximate the L2,p norm of a function 5 f by ‖f‖22,p ≈\n1 n ∑ i |f(xi)|2. Similarly, the integral operator Kpf(x) ≈ 1 n ∑ i k(xi, x)f(xi). These approximate equalities can be made precise by using appropriate concentration inequalities."
    }, {
      "heading" : "3.2 The FIRE Algorithms",
      "text" : "As discussed in the introduction, the starting point for our development is the integral equality\n[Type I]: Kp q\np (x) = ∫ Ω k(x, y) q(y) p(y) p(y)dy = Kq1(x). (6)\nNotice that in Type I, the kernel is not necessary to be in δ-family. For example, it could be linear kernel. Thus, we omit the t in the kernel for the Type I case.\nMoreover, if the kernel kt(x, y) is a Gaussian, which we will analyze in detail, or another δ-family and for f sufficiently smooth Kt,qf(x) ≈ f(x)p(x) + o(1) and hence\n[Type II]: Kt,p q\np (x) = ∫ Ω kt(x, y) q(y) p(y) p(y)dy = q(x) + o(1). (7)\nIn fact, for the Gaussian kernel, the o(1) term is of the order t. Since it is important that the kernel kt is in the δ-family with bandwidth t, so we keep t in the notation in this case.\nAssuming that either Kq1 or q are known (for simplicity we will refer to these settings as Type I and Type II, respectively) these Eqs. 6,7 become integral equations for pq , known as the Fredholm equations of the first kind.\nTo address the problem of estimating pq we need to obtain an approximation to the solution which (a) can be obtained computationally from sampled data, (b) is stable with respect to sampling and other\n5f needs to be in a function class where point evaluations are defined.\nperturbation of the input function6 and, preferably, (c) can be analyzed using the standard machinery of functional analysis.\nTo provide a framework for solving these inverse problems we apply the classical techniques of regularization combined with the RKHS norm popular in machine learning. In particular a simple formulation of Eq.6 in terms of Tikhonov regularization with the L2,p norm is as follows:\n[Type I]: f Iλ = arg min f∈H ‖Kpf −Kq1‖22,p + λ‖f‖2H (8)\nHere H is an appropriate Reproducing Kernel Hilbert Space. Similarly Eq. 7 can be written as\n[Type II]: f IIλ = arg min f∈H ‖Kt,pf − q‖22,p + λ‖f‖2H (9)\nWe will now discuss the empirical versions of these equations and the resulting algorithms in different settings and for different norms."
    }, {
      "heading" : "3.3 Algorithms for the Type I setting.",
      "text" : "Given an iid sample from p, zp = {x1, x2, . . . , xn} and an iid sample from q, zq = {x′1, x′2, . . . , x′m} (we will denote the combined sample by z) we can approximate the integral operators Kp and Kq by\nKzpf(x) = 1\nn ∑ xi∈zp k(xi, x)f(xi) and Kzqf(x) = 1 m ∑ x′i∈zq k(x′i, x)f(x ′ i). (10)\nThus the empirical version of Eq. 8 becomes\nf Iλ,z = arg min f∈H\n1\nn ∑ xi∈zp ((Kzpf)(xi)− (Kzq1)(xi))2 + λ‖f‖2H (11)\nWe observe that the first term of the optimization problem involves only evaluations of the function f at the points of the sample zp.\nThus, using the Representer Theorem and the standard matrix algebra manipulation we obtain the following solution:\nf Iλ,z(x) = ∑ xi∈zp kH(xi, x)vi and v = ( K2p,pKH + nλI )−1 Kp,pKp,q1zq . (12)\nwhere the kernel matrices are defined as follows: (Kp,p)ij = 1 nk(xi, xj), (KH)ij = kH(xi, xj) for xi, xj ∈ zp and Kp,q is defined as (Kp,q)ij = 1 mk(xi, x ′ j) for xi ∈ zp and x′j ∈ zq.\nTo compute the whole regularization path for all λ’s, or computing the inverse for every λ, we can use the following formula for v:\nv = Q(Λ + nλI)−1Q−1Kp,pKp,q1zq ,\nwhere K2p,pKH = QΛQ −1 is a diagonalization7 of K2p,pKH (i.e., Λ is diagonal).\nWhen KH and Kp,p are obtained using the same kernel function k, i.e. 1 nKH = Kp,p, the expression\nsimplifies:\nv = 1\nn\n( K3p,p + λI )−1 Kp,pKp,q1zq .\nIn that case (or, more, generally, if they commute) the diagonalization is obtained by computing the eigendecomposition of Kp,p = QΛQ\nT , where Q is an orthogonal matrix. Then the solution could be computed using the following formula:\nf Iλ,z(x) = 1\nn ∑ xi∈zp k(xi, x)vi and v = Q ( Λ3 + λI )−1 ΛQTKp,q1zq .\nSimilarly to many other algorithms based on the square loss function, this formulation allows us to efficiently compute the solution for many values of the parameter λ simultaneously, which is very useful for cross-validation.\n6Especially in Eq. 7, where the identity has an error term depending on t. 7Strictly speaking, an arbitrary matrix can only be reduced to the Jordan canonical form, but an arbitrarily small pertur-\nbation of any matrix can be diagonalized over the complex numbers."
    }, {
      "heading" : "3.3.1 Algorithms for γL2,p + (1− γ)L2,q norm.",
      "text" : "Depending on the setting, we may want to minimize the error of the estimate over the probability distribution p, q or over some linear combination of these. A significant potential benefit of using a linear combination is that both samples can be used at the same time in the loss function. First we state the continuous version of the problem:\nf*λ = arg min f∈H γ‖Kpf −Kq1‖22,p + (1− γ)‖Kpf −Kq1‖22,q + λ‖f‖2H (13)\nGiven a sample from p, zp = {x1, x2, . . . , xn} and a sample from q, zq = {x′1, x′2, . . . , x′m} we obtain an empirical version of the Eq. 13:\nf∗λ,z(x) = arg min f∈H\nγ\nn ∑ xi∈zp ( (Kzpf)(xi)− (Kzq1)(xi) )2 + 1− γ m ∑ x′i∈zq ( (Kzpf)(x′i)− (Kzq1)(x′i) )2 + λ‖f‖2H\nUsing the Representer Theorem we can derive: f∗λ,z(x) = ∑ xi∈zp vikH(xi, x) v = (K + nλI) −1 K11zq\nwhere\nK =\n( γ\nn (Kp,p) 2 + 1− γ m KTq,pKq,p\n) KH and K1 = ( γ\nn Kp,pKp,q + 1− γ m KTq,pKq,q ) Here (Kp,p)ij = 1 nk(xi, xj), (KH)ij = kH(xi, xj) for xi, xj ∈ zp. Kp,q and Kq,p are defined as (Kp,q)ij =\n1 mk(xi, x ′ j) and (Kq,p)ji = 1 nk(x ′ j , xi) for xi ∈ zp,x′j ∈ zq.\nWe see that despite the loss function combining both samples, the solution is still a summation of kernels over the points in the sample from p."
    }, {
      "heading" : "3.3.2 Algorithms for the RKHS norm.",
      "text" : "In addition to using the RKHS norm for regularization norm, we can also use it as a loss function:\nf*λ = arg min f∈H ‖Kpf −Kq1‖2H′ + λ‖f‖2H (14)\nHere the Hilbert space H′ must correspond to the kernel K and can potentially be different from the space H used for regularization. Note that this formulation is only applicable in the Type I setting since it requires the function q to belong to the RKHS H′.\nGiven two samples zp, zq, it is straightforward to write down the empirical version of this problem, leading to the following formula:\nf∗λ,z(x) = ∑ xi∈zp vikH(xi, x) v = (Kp,pKH + nλI) −1 Kp,q1zq . (15)\nThe result is somewhat similar to our Type I formulation with the L2,p norm. We note the connection between this formulation of using the RKHS norm as a loss function and the KMM algorithm [10]. The Eq. 15 can be viewed as a regularized version of KMM (with a different optimization procedure), when the kernels K and KH are the same.\nInterestingly a somewhat similar formula arises in [13] as unconstrained LSIF, with a different functional basis (kernels centered at the points of the sample zq) and in a setting not directly related to RKHS inference."
    }, {
      "heading" : "3.4 Algorithms for the Type II and 1.5 settings.",
      "text" : "In the Type II setting we assume that we have a sample z = {x1, x2, . . . , xn} drawn from p and that we know the function values q(xi) at the points of the sample.\nReplacing the norm and the integral operator with their empirical versions, we obtain the following optimization problem:\nf IIλ,z = arg min f∈H\n1\nn ∑ xi∈z (Kt,zf(xi)− q(xi))2 + λ‖f‖2H (16)\nRecall that Kt,z is the empirical version of Kt,p defined by\nKt,zf(x) = 1\nn ∑ xi∈z kt(xi, x)f(xi)\nAs before, using the Representer Theorem we obtain an analytical formula for the solution: f IIλ,z(x) = ∑ xi∈z kH(xi, x)vi where v = ( K2KH + nλI )−1 Kq. (17)\nwhere the kernel matrix K is defined by Kij = 1 nkt(xi, xj), (KH)ij = kH(xi, xj) and qi = q(xi)."
    }, {
      "heading" : "3.4.1 Type 1.5: The setting and the algorithm.",
      "text" : "This case (see Eq. 4) is intermediate between Type I and Type II. The setting is the same as in Type I, in that we are given two samples zp from p and zq from q. But similarly to Type II, we use the fact that Kp qp ≈ K ′ q1 when Kp and K′q are different δ-function-like kernels (e.g., two Gaussians of different bandwidth). The algorithm is similar to that for Type I with the difference that the kernel matrix K ′q,q is computed using the kernel k′(x, y): (K ′q,q)ij = 1 mk ′(xi, x ′ j).\nf1.5λ,z(x) = ∑ xi∈zp kH(xi, x)vi and v = ( K2p,pKH + nλI )−1 Kp,pK ′ q,q1zq ."
    }, {
      "heading" : "3.5 Spectral Cutoff Regularization",
      "text" : "In this section we briefly discuss an alternative form of regularization, based on thresholding the spectrum of the kernel matrix. It also leads to simple algorithms comparable to those for Tikhonov regularization and may have certain computational advantages.\nSince Kp is a compact self-adjoint operator on L2,p, its eigenfunctions {u0, u1, . . . } form a complete orthogonal basis for L2,p. An alternative method of regularization is the so-called spectral cutoff where the problem is restricted to the subspace spanned by the top few eigenfunctions of Kp Thus the regularization problems become\nf I,specλ = arg min f∈Hk ‖Kpf −Kq1‖22,p\nf II,specλ = arg min f∈Ht,k ‖Kt,pf − q‖22,p\nwhere Hk and Ht,k is the finite dimensional subspace of L2,p spanned by the eigenvectors of Kp and Kt,p corresponding to the k largest eigenvalues.\nWithout going into detail, it can be seen that the corresponding empirical optimization problems are\nf I,specλ,z = arg min f∈Hk,z\n1\nn ∑ xi∈zp (Kzpf(xi)−Kt,zq1(xi))2 (18)\nf II,specλ,z = arg min f∈Ht,k,z\n1\nn ∑ xi∈z (Kt,zpf(xi)− q(xi))2 (19)\nwhere the span of eigenvectors of the kernel matrix K is taken instead of the eigenfunctions of Kp or Kt,p. For this algorithm, we assume KH and K1 use the same kernel. Then the solution to the empirical regularization problems given in Eqs. 18,19 are respectively\nf I,specλ,z (x) = 1\nn ∑ xi∈zp k(xi, x)vi\nv = QkΛ −2 k Q T kK21zq\n(20)\nf II,specλ,z (x) = 1\nn ∑ xi∈z kt(xi, x)vi\nv = QkΛ −2 k Q T k q\n(21)\nwhere K1 = QΛQ T is the eigendecomposition of K1 with orthogonal matrix Q and diagonal matrix Λ, and Qk and Λk is the submatrices of Q and Λ corresponding to the k largest eigenvalues of the kernel matrix K1 and the remaining objects are defined in the previous subsection.\nWe note that spectral regularization can be faster computationally as it requires to compute only the top few eigenvectors of the kernel matrix. There are several efficient algorithms for computing eigendecomposition when only the first k eigenvalues are needed. Thus spectral regularization can be more computationally efficient than the Tikhonov regularization which potentially requires a full eigen-decomposition or matrix multiplication."
    }, {
      "heading" : "3.6 Comparison of type I and type II settings.",
      "text" : "While at first glance the type II, setting may appear to be more restrictive than type I, there are a number of important differences in their applicability.\n1. In Type II setting q does not have to be a density function (i.e., non-negative and integrate to one).\n2. Eq. 11 of the Type I setting cannot be easily solved in the absence of a sample zq from q, since estimating Kq requires either sampling from q (if it is a density) or estimating the integral in some other way, which may be difficult in high dimension but perhaps of interest in certain low-dimensional application domains.\n3. There are a number of problems (e.g., many problems involving MCMC) where q(x) is known explicitly (possibly up to a multiplicative constant), while sampling from q is expensive or even impossible computationally [17].\n4. Unlike Eq. 8, Eq. 9 has an error term depending on the kernel, which is essentially the difference between the kernel and the δ-function. For example, in the important case of the Gaussian kernel, the error is of the order O(t), where t is the variance.\n5. While a number of different norms are available in the Type I setting, only the L2,p norm is available for Type II."
    }, {
      "heading" : "4 Theoretical analysis: bounds and convergence rates for Gaus-",
      "text" : "sian Kernels\nIn this section, we state our main results on bounds and convergence rates for our algorithm based on Tikhonov regularization with a Gaussian kernel. We consider both Type I and Type II settings for the Euclidean and manifold cases and make a remark on the Euclidean domains with boundary.\nTo simplify the theoretical development the integral operator and the RKHS H will correspond to the same Gaussian kernel kt(x, y). Most of the proofs will be given in the next Section 5. We note that two Gaussian kernels with different bandwidth parameters can be analyzed using only minor modifications to our arguments."
    }, {
      "heading" : "4.1 Assumptions",
      "text" : "Before proceeding to the main results, we will state the assumptions on the density functions p and q and the basic setting for our theorems:\n1. The set Ω where the density function p is defined could be one of the following: (1) the whole Rd; (2) a compact smooth Riemannian sub-manifold M of d-dimension in Rn. In both cases, we need 0 < p(x) < Γ for any x ∈ Ω. The function q should satisfy q ∈ L2,p and needs to be bounded from above. We will also make some remarks about a compact domain in Rd with boundary.\n2. We also require q(x)p(x) ∈ W 2 2 (Ω) and q ∈ W 22 (Ω), where W 22 (Ω) is the Sobolev space of functions on Ω\n(e.g., [30]). Certain properties of W 22 (Ω) will be discussed later in the proof.\nIt will be important for us that H is isometric to L2,p under the map K1/2p : L2,p → H, that is, ‖f‖H = ‖K−1/2p f‖L2,p for any f ∈ H. Here the integral operator Kp uses the RKHS kernel corresponding to H."
    }, {
      "heading" : "4.2 Main Theorems",
      "text" : ""
    }, {
      "heading" : "4.2.1 Type I setting",
      "text" : "We will provide theoretical results for our setting Type I, where both the operator and the regularization\nkernel are Gaussian kt(x, y) = 1 (2πt)d/2 e− ‖x−y‖2 2t with the same bandwidth parameter t.\nTheorem 1. Let p and q be two density functions on Ω and q be another density over Ω satisfying the assumption in Sec. 4.1. Given n points, zp = {x1, x2, . . . , xn}, i.i.d. sampled from p and m points, zq = {x′1, x′2, . . . , x′m}, i.i.d. sampled from q, and for small enough t, for the solution to the optimization problem in (11), with confidence at least 1− 2e−τ , we have\n(1) If the domain Ω is Rd,∥∥∥∥f Iλ,z − qp ∥∥∥∥\n2,p\n≤C1 ( t\n− log λ\n) s 2\n+ C2λ 1−α 2 (Approximating Error)\n+ C3\n√ τ\nλtd/2 ( 1√ m + 1 λ1/6 √ n ) (Sampling Error),\n(22)\nwhere C1, C2, C3 are constants independent of t, λ. (2) If the domain Ω is a compact manifold without boundary of d dimension,∥∥∥∥f Iλ,z − qp ∥∥∥∥ 2,p ≤C1t+ C2λ1/2 (Approximating Error)\n+ C3\n√ τ\nλtd/2 ( 1√ m + 1 λ1/6 √ n ) (Sampling Error),\n(23)\nwhere C1, C2, C3 are constants independent of t, λ.\nProof. See Section 5.\nRemark 1: convergence for fixed t. For the Euclidean case in Eq. 22, with fixed kernel width t, the error will converge to 0, as λ → 0 given sufficiently many data points. However the required number of points is exponential in 1λ . This is related to the fact the eigen-values of the operator Kp decay exponentially fast, when the kernel is Gaussian. On the other hand choosing both t and λ as a function of n leads to a much better polynomial rate given below. Remark 2. A minor modification of the proof provides the following simpler version of Eq. 22:∥∥∥∥f Iλ,z − qp ∥∥∥∥ 2,p ≤ C1t s 2 + C2λ 1 2 + C3 √ τ λtd/2 ( 1√ m + 1 λ1/6 √ n ) (24)\nAs a consequence we obtain the following corollary establishing the convergence rates:\nCorollary 2. Assuming m > λ1/3n, with confidence at least 1− 2e−τ , we have the following: (1) If Ω = Rd, ∥∥∥∥f Iλ,z − qp ∥∥∥∥2\n2,p\n= O (√ τn− s 3.5s+d ) (2) If Ω is a d-dimensional sub-manifold of a Euclidean space,∥∥∥∥f Iλ,z − qp ∥∥∥∥2 2,p = O (√ τn− 1 3.5+d/2 )\nProof. For the Euclidean space, set t = n − 110.5 3 s+d , λ = n − s10.5 3 s+d and apply Theorem 1 (Eq. 24 for the Euclidean case). For the sub-manifold case set t = n− 1 7+d , λ = n− 2 7+d ."
    }, {
      "heading" : "4.2.2 Type II setting",
      "text" : "In this section we provide an analysis for the Type II setting and also make a remark about the error analysis for the compact domains in Rd.\nRecall that in Type II setting we have a set of points sampled from p and assume that the values of q on those points are known. Note, that q does not have to be a density function.\nTheorem 3. Let p be a density function on Ω and q be a function satisfying the assumptions in Sec. 4.1. Given n points z = {x1, x2, . . . , xn} sampled i.i.d. from p, and for sufficiently small t, for the solution to the optimization problem in (16), with confidence at least 1− 2e−τ , we have\n(1) If the domain Ω is Rd,∥∥∥∥f IIλ,z − qp ∥∥∥∥\n2,p\n≤C1 ( t\n− log λ\n) s 2\n+ C2λ 1−α 2 + C3λ − 13 ‖Kt,q1− q‖2,p + C4 √ τ\nλ3/2td/2 √ n , (25)\nwhere C1, C2, C3, C4 are constants independent of t, λ. Moreover, ‖Kt,q1− q‖2,p = O(t).\n(2) If Ω is a d-dimensional sub-manifold of a Euclidean space,∥∥∥∥f IIλ,z − qp ∥∥∥∥\n2,p\n≤C1t+ C2λ1/2 + C3λ− 1 3 ‖Kt,q1− q‖2,p + C4\n√ τ\nλ3/2td/2 √ n , (26)\nwhere C1, C2, C3, C4 are constants independent of t, λ. Moreover, ‖Kt,q1− q‖2,p = O(t 1−ε) for any ε > 0.\nRemark. It can be shown that if Ω is a compact subset with sufficiently smooth boundary in Rd, we have the same bound with (1) except for ‖Kt,q1− q‖2,p = O(t 1 4−ε) for any any ε > 0.\nAs before, we obtain the rates as a corollary:\nCorollary 4. With confidence at least 1− 2e−τ , we have: (1) If Ω = Rd, ∥∥∥∥f IIλ,z − qp ∥∥∥∥2\n2,p\n= O (√ τn − 1 4+ 5 6 d ) (2) If Ω is a d-dimensional sub-manifold of a Euclidean space, than for any 0 < ε < 1∥∥∥∥f IIλ,z − qp ∥∥∥∥2 2,p = O (√ τn − 1−ε 4−4ε+5 6 d )\nProof. For the case of Rd, set t = n− 1 4.8+d , λ = n − 1 4+ 5 6 d . For case of sub-manifold case, set t = n− 1−ε 4.8−4.8ε+d , λ = n − 1−ε 4−4ε+5 6 d . Apply Theorem 3."
    }, {
      "heading" : "5 Proofs of Theorems",
      "text" : "In this section, we provide a proof for the our main Theorem 1 for setting I. The proof for the Theorem 3 for the setting type II is along similar lines and can be found in the appendix."
    }, {
      "heading" : "5.1 Basics about RKHS",
      "text" : "Since Kt,ρ is a self-adjoint operator, its eigenfunctions {u0,t, u1,t, . . . } form a complete orthogonal basis for L2,ρ. Denote the eigenvalues of Kt,ρ by {σ0,t, σ0,t, . . . }. The norm of Kt,ρ, ‖Kt,ρ‖L2,ρ→L2,ρ ≤ maxi σi,t < c for a constant c. We know that Ht is isometric to L2,ρ under the map K1/2t,ρ : L2,ρ → Ht, i.e. ‖f‖Ht = ‖K−1/2t,ρ f‖L2,ρ for any f ∈ Ht, and this is the definition we use for the norm ‖ · ‖Ht of Ht. This also implies that ‖K−1/2t,ρ f‖L2,ρ <∞ for any f ∈ Ht. And Kt,ρ is defined using the spectrum of Kt,ρ,\nKt,ρf = ∑ i σi,ρ〈f, ui,t〉ui,t"
    }, {
      "heading" : "5.2 Proof of Theorem 1",
      "text" : "Proof. Recall the definition of f Iλ and f I λ,z in Eq. 8 and Eq. 11. By the triangle inequality, we have∥∥∥∥qp − f Iλ,z ∥∥∥∥ 2,p ≤ ∥∥∥∥qp − f Iλ ∥∥∥∥ 2,p + ∥∥f Iλ − f Iλ,z∥∥2,p .\n=(Approximation Error) + (Sampling Error)\n(27)\nThe approximation error ∥∥∥f Iλ − qp∥∥∥\n2,p is a measure of the distance between qp and the optimal approximation given by algorithm (8) given infinite number of data. The sampling error term ∥∥∥f Iλ − f Iλ,z∥∥∥\n2,p the difference\nbetween f Iλ and f I λ,z, depending on the data points.\nAs typical in these types of estimates our proof consists of two parts: bounding the approximating error,∥∥∥f Iλ − qp∥∥∥ 2,p in Lemma 7 and providing a concentration bound for ∥∥∥f Iλ,z − f Iλ∥∥∥ 2,p in Lemma 8. The theorem follows immediately by putting these two results together."
    }, {
      "heading" : "5.2.1 Bound for Approximation Error",
      "text" : "First of all, let present two lemmas that are useful for bounding the approximation error.\nLemma 5. Let λ > 0. If function f ∈W 22 (Rd) and p(x) > 0 for any x ∈ Rd, then\narg min g∈L2,p (∥∥∥f −K1/2t,p g∥∥∥2 2,p + λ‖g‖22,p ) ≤ D1ts + λD2 ‖f‖22 . (28)\nfor constants D1, D2.\nProof. See Appendix A.\nLemma 6. Let λ > 0. If function f ∈W 22 (M) defined on a compact Riemann sub-manifold of d-dimension in a Euclidean space, then\narg min g∈L2,p (∥∥∥f −K1/2t,p g∥∥∥2 2,p + λ‖g‖22,p ) ≤ D1 ‖f‖2,p t 2 + λD2 ‖f‖22,p . (29)\nfor constants D1, D2.\nProof. See Appendix B\nNow we can present the lemma that gives the bound of the approximation error in the following lemma.\nLemma 7. Let p, q be two density functions of probability measure over a domain X satisfying the assumptions in 4.1. The solution to the optimization problem in (8), f Iλ, satisfies the following inequality,\n(1) when the domain X is Rd,∥∥∥∥f Iλ − qp ∥∥∥∥\n2,p\n≤ C1 ( t\nlog( 1λ )\n)s/2 + C2λ 1/2\nfor constants C1, C2 which are independent of λ and t. (2) when the domain X is a compact Riemannian sub-manifold M of d dimension in RN ,∥∥∥∥f Iλ − qp ∥∥∥∥ 2,p ≤ C1t+ C2λ1/2\nfor constants C1, C2 which are independent of λ and t.\nProof. Recall the equation (8). By functional calculus, we have analytical formula for f Iλ as follows,\nf Iλ = ∑ i σ2i,t σ3i,t + λ 〈Kt,q1, ui,t〉2ui,t = ( K3t,p + λI )−1K2t,pKt,q1 = (K3t,p + λI)−1K3t,p qp . The last equation is because\nKt,q1 = Kt,p q\np .\nThus the approximating error is∥∥∥∥f Iλ − qp ∥∥∥∥\n2,p\n= ∥∥∥∥(K3t,p + λI)−1K3t,p qp − qp ∥∥∥∥\n2,p\n(30)\nNotice that ( K3t,p + λI )−1K3t,p qp in (30) can also be rewritten as ( K3t,p + λI )−1K3t,p qp = arg ming∈L2,p ∥∥∥∥qp −K3/2t,p g ∥∥∥∥2 2,p + λ‖g‖22,p\nThus, ∥∥∥∥(K3t,p + λI)−1K3t,p qp − qp ∥∥∥∥2\n2,p\n≤ min g∈L2,p ∥∥∥∥qp −K3/2t,p g ∥∥∥∥2\n2,p\n+ λ‖g‖22,p (31)\nThe minimum of the above optimization problem can always be bounded by any specific g ∈ L2,p. And we will expend the above formula such that we can take advantages of Lemma 5 and 6. To this end, we define an operator\ng∗λ = T (f, λ) = arg min g∈L2,p ∥∥∥f −K1/2t,p g∥∥∥2 2,p + λ‖g‖22,p\nBy functional calculus, it is not hard to see that g∗λ = (Kt,p + λI) −1Kt,pf . If f ∈ W 22 , so is g∗λ, this is because Kt,p is an integral operator with Gaussian kernel and Gaussian kernel is in W s2 for any s > 0. Also, we should have ‖g∗λ‖2,p ≤ ‖f‖2,p, because ‖(Kt,p + λI)−1Kt,p‖L2,p→L2,p ≤ 1.\nNow let g∗1 = T ( q p , λ ) , g∗2 = T (g∗1 , λ) , g∗3 = T (g∗2 , λ). We have g∗1 , g∗2 is also in W 22 and ‖g∗2‖2,p ≤\n‖g∗1‖2,p ≤ ‖ q p‖2,p. Now we could expend (31),\nmin g∈K2,p ∥∥∥∥qp −K3/2t,p g ∥∥∥∥2\n2,p\n+ λ‖g‖22,p ≤ ∥∥∥∥qp −K3/2t,p g∗3 ∥∥∥∥2 2,p + λ‖g∗3‖22,p\n= ∥∥∥∥qp −K1/2t,p g1 +K1/2t,p g1 −Kt,pg2 +Kt,pg1 −K3/2t,p g3 ∥∥∥∥2\n2,p\n+ λ‖g∗3‖22,p\nBy inequality (a+ b+ c)2 ≤ 3(a2 + b2 + c3), we have\nmin g∈K2,p ∥∥∥∥qp −K3/2t,p g ∥∥∥∥2\n2,p\n+ λ‖g‖22,p\n≤3 (∥∥∥∥1p −K1/2t,p g∗1 ∥∥∥∥2\n2,p\n+ λ‖g∗1‖22,p\n) + 3 (∥∥∥K1/2t,p (g∗1 −K1/2t,p g∗2)∥∥∥2 2,p + λ‖g∗2‖22,p )\n+ 3 (∥∥∥Kt,p (g∗2 −K1/2t,p g∗3)∥∥∥2 2,p + λ‖g∗3‖22,p )\n≤3 (∥∥∥∥qp −K1/2t,p g∗1 ∥∥∥∥2\n2,p\n+ λ‖g∗1‖22,p\n) + 3c1/2 (∥∥∥g∗1 −K1/2t,p g∗2∥∥∥2 2,p + λ‖g∗2‖22,p )\n+ 3c (∥∥∥g∗2 −K1/2t,p g∗3∥∥∥2 2,p + λ‖g∗3‖22,p )\nThe last inequality is because ‖Kt,p‖L2→L2 < c for constant c > 1. Up to now, the proof is valid for both cases in the theorem. And we can apply Lemma 5 and 6 to get the bounds for both cases. By Lemma 5, for the densities p, q over Rd, we have∥∥∥∥(K3t,p + λI)−1K3t,p qp − qp ∥∥∥∥2 2,p ≤ min g∈K2,p ∥∥∥∥1p −K3/2t,p g ∥∥∥∥2 2,p + λ‖g‖22,p ≤ 9cD1 ∥∥∥∥qp ∥∥∥∥2 2,p ( t log( 1λ ) )s + 9cD2λ 1−α ∥∥∥∥qp ∥∥∥∥2 2,p\n(32)\nRecall (30), we have∥∥∥∥f Iλ − qp ∥∥∥∥\n2,p\n≤ √ 9cD1 ∥∥∥∥qp ∥∥∥∥2\n2,p\nts + 9cD2λ ∥∥∥∥qp ∥∥∥∥2\n2,p\n≤ C1 ( t\nlog( 1λ )\n)s/2 + C2λ (1−α)/2 (33)\nwhere C1 = 3 √ cD1 ∥∥∥ qp∥∥∥ 2,p , C2 = 3 √ cD2 ∥∥∥ qp∥∥∥ 2,p .\nApplying Lemma 6, we will have the result for manifold case,∥∥∥∥f Iλ − qp ∥∥∥∥\n2,p\n≤ √ 9cD1 ∥∥∥∥qp ∥∥∥∥2\n2,p\nt2 + 9cD2λ ∥∥∥∥qp ∥∥∥∥2\n2,p ≤C1t+ C2λ1/2 (34)\nwhere C1 = 3 √ cD1 ∥∥∥ qp∥∥∥ 2,p , C2 = 3 √ cD2 ∥∥∥ qp∥∥∥ 2,p ."
    }, {
      "heading" : "5.2.2 Bound for Sampling Error",
      "text" : "In the next lemma, we will give concentration of the sampling error, ‖f Iλ − f Iλ,z‖2,p. Lemma 8. Let p be a density of a probability measure over a domain X and q another density function. They satisfy the assumptions in 4.1. Consider f Iλ and f I λ,z defined in (8) and (11), with confidence at least\n1− 2e−τ , we have ∥∥f Iλ − f Iλ,z∥∥2,p ≤ C3(κt√τλ√m + kt √ τ λ7/6 √ n ) where κt = supx∈Ω kt(x, x) = 1 (2πt)d/2\nProof. Recall that, f Iλ = arg min\nf∈Ht ‖Kt,pf −Kt,q1‖22,p + λ‖f‖2Ht\nand\nf Iλ,z = arg min f∈Ht,z\n1\nn ∑ xpi∈zp ( (Kzpf)(x p i )− (Kzq1)(x p i ) )2 + λ‖f‖2Ht\nUsing functional calculus, we will get the explicit formula for f Iλ and f I λ,z as follows, f Iλ = ( K3p + λI )−1K2pKq1 and\nf Iλ,z = ( K3zp + λI )−1 K2zpKzq1.\nThen the bound for sampling error is to bound the above two objects. Let f̃ = ( K3zp + λI )−1 K2pKq1. We\nhave f Iλ − f Iλ,z = f Iλ − f̃ + f̃ − f Iλ,z. For f Iλ − f̃ , using the fact that ( K3p + λI ) f Iλ = K2pKq1, we have\nf Iλ − f̃ =f Iλ − ( K3zp + λI )−1 ( K3p + λI ) f Iλ\n= ( K3zp + λI )−1 ( K3zp −K 3 p ) f Iλ\nAnd\nf̃ − f Iλ,z = ( K3zp + λI )−1 K2pKq1− ( K3zp + λI )−1 K2zpKzq1\n= ( K3zp + λI )−1 ( K2pKq −K2zpKzq ) 1\nNotice that we have K3zp − K 3 p and K2zpKzq − K 2 pKq in the identity we get. For these two objects, it is\nnot hard to verify the following identities,\nK3zp −K 3 p = ( Kzp −Kp )3 +Kp ( Kzp −Kp )2 + ( Kzp −Kp ) Kp ( Kzp −Kp ) + ( Kzp −Kp )2Kp +K2p ( Kzp −Kp ) +Kp ( Kzp −Kp ) Kp + ( Kzp −Kp ) K2p.\nAnd\nK2zpKzq −K 2 pKq = ( Kzp −Kp )2 (Kzq −Kq)+Kp (Kzp −Kp) (Kzq −Kq)+ (Kzp −Kp)Kp (Kzq −Kq) +K2p ( Kzq −Kq ) + ( Kzp −Kp\n)2Kq +Kp (Kzp −Kp)Kq + (Kzp −Kp)KpKq. Thus, in these two identities, the only two random variables are Kzp − Kp and Kzq − Kq. By results\nabout concentration of Kzp and Kzq , we have with probability 1− 2e−τ ,\n‖Kzp −Kp‖H→H ≤ κt √ τ√ n , ‖Kzq −Kq‖H→H ≤ κt √ τ√ m ,\n∥∥Kzq1−Kq1∥∥H ≤ κt √ 2τ√ m\n(35)\nAnd we know that for a large enough constant c which is independent of t and λ, ‖Kp‖H→H < c, ‖Kq‖H→H < c, ∥∥∥∥(K3zp + λI)−1∥∥∥∥\nH→H ≤ 1 λ , ‖Kq1‖H < c\nand\n‖f Iλ‖2H = ∑ i σ5i (σ3i + λ) 2 〈 q p , ui 〉2 ≤ ( sup σ>0\nσ5\n(σ3 + λ)2 )∑ i 〈 q p , ui 〉2 ≤ c2 1 λ1/3 ∥∥∥∥qp ∥∥∥∥2 2,p\nthus, ‖f Iλ‖H ≤ cλ1/6 ∥∥∥ qp∥∥∥\n2,p . Notice that ∥∥∥(Kzp −Kp)2∥∥∥H ≤ ∥∥Kzp −Kp∥∥2H and ∥∥∥(Kzp −Kp)3∥∥∥H ≤ ∥∥Kzp −Kp∥∥3H, both of this could\nbe of smaller order compared with ∥∥Kzp −Kp∥∥H. For simplicity we hide the term including them in the final bound without changing the dominant order. We could also hide the terms with the product of any two the random variables in Eq. 40, which is of prior order compared to the term with only one random variable. Now let us put everything together,\n‖f Iλ − f Iλ,z‖2,p ≤ c1/2‖f Iλ − f Iλ,z‖Ht ≤c1/2 ( c3κt √ τ\nλ7/6 √ n ∥∥∥∥qp ∥∥∥∥\n2,p\n+ c2κt √ τ\nλ √ m\n)\n≤C3 ( κt √ τ\nλ √ m\n+ κt √ τ\nλ7/6 √ n\n)\nwhere C3 = c 5/2 max ( c ∥∥∥ qp∥∥∥\n2,p , 1\n) ."
    }, {
      "heading" : "6 Experiments",
      "text" : "In this section we explore the empirical performance of our methods under various settings. We will primarily concentrate on our setting Type II and use the same Gaussian kernel for the integral operator and the regularization term to simplify model selection.\nThis section is organized as follows. In Subsection 6.1 we describe a completely unsupervised procedure for parameter selection, which will be used throughout the experimental section. In Subsection 6.2 we briefly describe the data sets and the re-sampling procedures we use. In Subsection 6.3 we provide a comparison between our methods using different norms and other methods based on the expected performance under our evaluation criteria. In Subsection 6.4 we provide a number of experiments comparing our method to different methods on several different data sets for classification and regression tasks. Finally in Subsection 6.5 we study performance of different kernels in both Type-I and Type-II setting using two simulated data sets."
    }, {
      "heading" : "6.1 Experimental Setting and Model Selection",
      "text" : "The setting: In our experiments, we have a set of a data set Xp = {xpi , i = 1, 2, . . . , n} and another set of instances Xq = {xqj , j = 1, 2, . . . ,m}. The goal is to estimate q p under the assumption that X\np is sampled from p and Xq is sampled from q.\nWe note that our algorithms typically has two parameters, which need to be selected, the kernel width t and the regularization parameter λ. In general choosing parameters in a unsupervised or semi-supervised setting is a hard problem as it may be difficult to validate the resulting classifier/estimator. However, certain features of our setting allow us to construct an adequate unsupervised proxy for the performance of the algorithm. Now we construct a performance measure for the quality of the estimator. Performance Measure. We describe a set of performance measures to use for parameter selection.\nFor a given function u, we have the following importance sampling equality (Eq. 1): Eq(u(x)) = Ep ( u(x) q(x)\np(x)\n) .\nIf f(x) is an approximation of the true ratio qp , using the samples from X p and Xq respectively, we will have the following approximation to the above equation:\n1\nn n∑ i=1 u(xpi )f(x p i ) ≈ 1 m m∑ j=1 u(xqj).\nTherefore, after obtaining an estimate f of the ratio, we can validate it by using a set of test functions U = {u1, u2, . . . , uF } using the following performance measure:\nJ(f ;Xp, Xq, U) = 1\nF F∑ l=1  n∑ i=1 ul(x p i )f(x p i )− m∑ j=1 ul(x q j) 2 (36) where U = {u1, u2, . . . , uF } is a collection of function chosen as criterion. Using this performance measure allows various cross-validation procedures to be sued for parameter selection.\nWe note that this way of measuring the error is related to the LSIF [13] and KLIEP [29], algorithms. However, there a similar measure is used to construct an approximation to the ratio fracqp using functions u1, . . . , uF as a basis. In our setting, to choose parameters, we can use validations sets (such as linear functions) which are poorly suited as a basis for approximating the density ratio. Choice of validation function sets for parameter selection. In principle, any set of (sufficiently wellbehaved) functions can be used as a validation set. From a practical point of view we would like functions to be simple to compute and readily available for different data sets.\nIn the our experiments, we will use the following two families of functions for parameter tuning:\n(1) Sets of random linear functions u(x) = βTx where β ∼ N(0, Id).\n(2) Sets of random half-space indicator functions, u(x) = 1βT x>0 where β ∼ N(0, Id).\nRemark 1: We have also tried (a) coordinates functions, (b) random combination of kernel functions, and (c) random combination of kernel functions with thresholding. In our experience the coordinate functions are not rich enough for adequate parameter tuning. On the other hand, using the kernel functions significantly increases the complexity of the procedure (due to the necessity of choosing the kernel width and other parameters) without increasing the performance significantly. Remark 2: Note that for linear functions, the cardinality of the set should not exceed the dimension of the space due to linear dependence. Remark 3: It appears that linear functions work well for regression tasks, while half-spaces are well-suited for classification.\nProcedures for parameter selection. We optimize the performance using cross-validation by splitting the data set in two parts Xp,train and Xq,train used for training and Xp,cv and Xq,cv used for validation, and repeating this process five times to find the optimal values of parameters8.\nFor the two parameters which need to be tuned, the kernel width t and the regularization parameter λ, we specify a parameter grid as follows. The range for kernel width t is (t0, 2t0, . . . , 2\n9t0), where t0 is the average distance of the 10 nearest neighbors, and regularization parameter λ is (1e− 5, 1e− 6, . . . , 1e− 10)."
    }, {
      "heading" : "6.2 Data sets and Resampling",
      "text" : "In our experiments, several data sets are considered: Bank8FM, CPUsmall and Kin8nm for regression; and USPS and 20 news groups for classification.\nFor each data set, we assume they are i.i.d. sampled from a distribution denoted by p. We draw the first 500 or 1000 points from the original data set as Xp. To obtain Xq, we apply a resampling scheme on the remaining points of the original data set. Two ways of resampling, using the features of the data and using the label information, are used (along the lines similar to those proposed in [8]).\nSpecifically, given a set of data points with labels {(x1, y1), (x2, y2), . . . , (xn, yn)} we resample as follows:\n• Resampling using feature information (labels yi are not used). We subsample the data points so that the probability Pi of selecting the instance i, is defined by the following (sigmoid) function:\nPi = e(a〈xi,e1〉−b)/σv\n1 + e(a〈xi,e1〉−b)/σv\nwhere a, b are the resampling parameters, e1 is the first principal component, and σv is the standard deviation of the projection to e1. Note that in this resampling scheme, the probability of taking one point is only conditioned on the feature information xi. This resampling method will be denoted by PCA(a, b).\n8We note that this procedure cannot be used with KMM as it has no out-of-sample extension. Therefore in subsection 6.3 we do not compare our method with KMM since there is no obvious way to extend the results to the validation data set.\n• Resampling using label information. The probability of selecting the i’th instance, denoted by Pi, is defined by\nPi = { 1 y1 ∈ Lq 0 Otherwise.\nwhere yi ∈ L = {1, 2, . . . , k} and Lq is a subset of the complete label set L. We apply this for binary problems obtained by aggregating different classes in the multi-class setting."
    }, {
      "heading" : "6.3 Testing the FIRE algorithm",
      "text" : "In first experiment, we test our method for selecting the parameters, which is described in Section 6.1, by focusing on the the error J(f ;Xp, Xq, U) in Eq. 36 for different function classes U . We use different families of functions for tuning parameters and validation. This measure is important because in practice the functions we are interested may not be in the collection we chosen for validation. To avoid confusion, we denote the function for cross validation by f cv and the function for measuring error by f err.\nWe use the CPUsmall and USPS hand-written digits data sets. For each of them, we generate two data sets Xp and Xq using the resampling method, PCA(a, σv), describe in Section 6.2. We compare FIRE with several methods including TIKDE, LSIF. Figure 1 gives an illustration of the procedure and usage of data for the experiments. And the results are shown in Table 1 and 2. The numbers in the table are the average errors defined in Eq. 36 on held-out set Xerr over 5 trials, using different criterion functions f cv(Columns) and error-measuring functions f err(Row). N is the number of random function we are using for the cross-validation.\nFor the error-measuring functions, we have several choices as follows:\n(1) Linear: Sets of Random linear functions f(x) = βTx where β ∼ N(0, Id).\n(2) Half-space: Sets of random half-space indicator functions, f(x) = 1βT x>0 where β ∼ N(0, Id).\n(3) Kernel: Sets of random linear combination of kernel functions centered at the training data, f(x) = γTK where γ ∼ N(0, Id) and Kij = k(xi, xj) where xi are points from the data set.\n(4) K-indicator: Sets of random kernel indicator functions centered at the training data, f = 1γTK>0 where γ ∼ N(0, Id) and Kij = k(xi, xj) where xi are points from the data set.\n(5) Coord: Sets of coordinate functions."
    }, {
      "heading" : "6.4 Supervised Learning: Regression and Classification",
      "text" : "In our experiments, we compare our method FIRE with several methods under the setting of supervised learning, i.e. regression and classification. More specifically, we consider the situation part or all of the training set Xp are labeled and all of Xq are unlabeled. In the following experiments, we will estimate the density ratio function using 1000 points in Xp and use the labeled data from Xp to build a regression function or classifier on Xq."
    }, {
      "heading" : "6.4.1 Regression",
      "text" : "Given data sets (Xp, Y p) where Xp is for independent variable, and Y p is for dependent variable, and a test data set Xq with a different distribution, the regression problem is to obtain a function a predictor on Xq. To make the comparison between unweighted regression method and different weighting schemes, we use the simplest regression method, the least square linear regression. With this method, the regression function is of the form\nf(x, β) = βtx,\nwhere β = (XWXT )+XWY and (·)+ denotes the pseudo-inverse of a matrix. Here W is a diagonal matrix with the estimated density ratio on the diagonal. These are estimated using FIRE and other density ratio estimation methods for comparison. The results on 3 regression data sets are shown in Table 5, 3 and 4."
    }, {
      "heading" : "6.4.2 Classification",
      "text" : "Similarly to the case of regression the density ratio can also be used for building a classifier such as SVM. Given a set of labeled data, {(x1, y1),(x2, y2), . . . , (xn, yn)} and xi ∼ q, we building a linear classifier f by\nthe weighted linear SVM algorithm as follows:\nf = arg min β∈Rd\nC\nn n∑ i=1 wi(β Txi − yi)+ + ‖β‖22\nThe weights wi’s are obtained by various density ratios estimation algorithms using two data sets X p and Xq. Note that estimating the density ratios using Xp and Xq is completely independent of the label information. We also explore the performance of these weighted SVM as the number of labeled points used for training classifier changes. In the experiments, we first estimate the density ratios on the whole Xp with the parameters selected by cross validation. Then we subsample a portion of Xp and use their labels to train the classifier. And the performance of the classifier in terms of prediction error is estimated using all the points in Xq. The results on USPS hand-written digits and 20 news groups are shown in Table 6, 7, 8 and 9."
    }, {
      "heading" : "6.5 Simulated Examples",
      "text" : ""
    }, {
      "heading" : "6.5.1 Simulated Dataset 1.",
      "text" : "We use a simple example, where the two densities are known, to demonstrate the properties of our methods and how the number of data points influences the performance.\nFor this experiment, we suppose p = 0.5N(−2, 12)+0.5N(2, 0.52) and q = N(0, 0.52) and fix |Xq| = 2000, and vary |Xp| from 50 to 1000. We compare our method with the other two methods for the same problem: TIKDE and KMM. For all the methods we consider in this experiment, we will choose the optimal parameter based on the empirical L2 norm of the difference between the estimated ratio and the true ratio, which is supposed to be known in this toy example. Figure 2 gives the reader an intuition about how the estimated ratios behave for different methods.\nAnd Figure 3 shows how different methods perform when |Xp| varies from 50 to 1000 and |Xq| is fixed\nto be 2000. The boxplot is also a good way to illustrate the stability of the methods over 50 independent repetitions."
    }, {
      "heading" : "6.5.2 Simulated Dataset 2.",
      "text" : "In the second simulated example, we will test our method for various kernels and different norms as the cost function. More specifically, we suppose p = N(0, 0.52) and q = Unif([−1, 1]). We will use this example to explore the power of our methods with different kernels. Three settings are considered in this experiments: (1)Different kernels kh for the RKHS. We use polynomial kernels of degree 1, 5 and 20, exponential kernel and Gaussian kernel; (2) Type-I setting and Type-II setting; (3) Different norm for the cost function in the algorithm, i.e. ‖ · ‖2,p and ‖ · ‖2,q. In this example, ‖ · ‖2,p focuses on the region close 0, but still has penalty outside interval [−1, 1]; ‖ · ‖2,p has uniform penalty on [−1, 1] and has no penalty at all outside the interval.\nIn all settings, we fix the convolution kernel to be Gaussian, kt. When the RKHS kernel is exponential and Gaussian, we also need to decide their width. For simplicity, we just fix their width to be 20t, where t is the width of the convolution kernel kt. For setting Type-I, we will set |Xp| = 500 and |Xq| = 500; for Type-II setting, we only specify |Xp| = 500. The results are shown in Figure 4."
    }, {
      "heading" : "Acknowledgements",
      "text" : "We are grateful to Yusu Wang for many valuable discussions and suggestions. We also thank Lorenzo Rosasco for very useful discussions and Christoph Lampert for pointing us to important related papers.\nWe thank the Austrian Institute of Technology (ISTA) and Herbert Edelsbrunner’s research group for their hospitality during writing of the paper.\nThe work was partially supported by the NSF Grants IIS 0643916 and IIS 1117707."
    }, {
      "heading" : "A Proof for Lemma 5",
      "text" : "Proof. RKHS is unique for a given domain and kernel, so is independent of the measure used to define the L2,ρ. Thus for any g ∈ L2,p, there should be h ∈ L2 such that L1/2t,p g = L 1/2 t h and\n‖g‖2,p = ‖ L1/2t,p g‖Ht = ‖ L 1/2 t h‖Ht = ‖h‖2.\nSince this is true for arbitrary g ∈ L2,p, we have\nmin g∈L2,p ∥∥∥f − L1/2t,p g∥∥∥2 2,p + λ′‖g‖22,p = min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2,p + λ′‖h‖22\nBecause ‖ · ‖2,p ≤ Γ‖ · ‖2,\nmin h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2,p + λ′‖h‖22 ≤ Γ2 ( min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2 + λ′ Γ2 ‖h‖22 ) (37)\nTo bound\nmin h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2 + λ′ Γ2 ‖h‖22\nWe need the Fourier transform F : L2(Rd)→ L2(Rd), defined as\nf̂(ξ) = ∫ Rd e−iξxf(x)dx.\nLt on Rd is the heat operator, thus L1/2t = L t2 . And\nLtf(x) = ∫ Rd kt(x, y)f(y)dy = (kt ∗ f)(x),\nSo, F ( Ltf) = k̂tf̂ . Note that F is an isometry. Thus it is the same to transform the (37) using Fourier transform. Then we have\nmin ĥ∈L2\n∥∥∥f̂ − k̂ t 2 ĥ ∥∥∥2 2 + λ′ Γ2 ‖ĥ‖22\nwhere k̂t(ξ) = e −‖ξ‖2t 2 . And let\nf̃(ξ) =\n{ f̂(ξ) if ‖ξ‖2 < 4α log( 1 λ′ )\nt\n0 Otherwise.\nand h̃ = ( k̂ t\n2\n)−1 f̃ . It is obvious that ‖h̃‖22 ≤ 1λ′α ‖f̂‖ 2 2 = 1 λ′α ‖f‖\n2 2. And∥∥∥f̂ − k̂ t 2 h̃ ∥∥∥2 2 = ∥∥∥f̂ − f̃∥∥∥2 2\nNow we recall the definition of Sobolev space using Fourier transform, which states that f̂(ξ) = 1 (1+‖ξ‖2)s/2 û(ξ) for some û ∈ L2. Thus, ∥∥∥f̂ − f̃∥∥∥2 2 = (∫ ‖ξ‖2< 4α log( 1 λ′ )\nt\n1\n(1 + ‖ξ‖2)s/2 û(ξ)dξ )2 ≤ ∫ ‖ξ‖2< 4α log( 1 λ′ )\nt\n( 1\n(1 + ‖ξ‖2)s/2 û(ξ)\n)2 dξ ≤ t s\n4αs ( log( 1λ′ ) )s ‖û‖22 Thus, we have\nmin ĥ∈L2\n∥∥∥f̂ − k̂ t 2 ĥ ∥∥∥2 2 + λ′ Γ2 ‖ĥ‖22 ≤ ∥∥∥f̂ − k̂ t 2 h̃ ∥∥∥2 2 + λ′ Γ2 ‖h̃‖22 ≤\nts 4αs ( log( 1λ′ ) )s ‖û‖22 + λ′1−αΓ2 ‖f‖22 Let D1 = Γ2‖û‖22 4αs and D2 = 1, we have the lemma."
    }, {
      "heading" : "B Proof for Lemma 6",
      "text" : "For the compact manifold case, we also need to have similar lemma as the above one. However, the definition of Fourier transform is obscure, thus we need to consider alternative way to get the same bound. We can use the Laplace-Beltrami operator on the compact manifold. It has discrete spectrum and satisfies the Weyl’s Law, see Chapter 8 in [30], about the spectrum of the Laplace-Beltrami operator ∆, which is discrete if the manifold is compact. It states the following: the number of eigenvalues of Laplacian operator over a bounded domain with Neumann Bounday condition that are less or equal than x, denoted by N(x), satisfies\nlim x→∞\nN(x)\nxd/2 = C\nfor a constant C depending on the dimensionality and volume of the domain. This implies there exists M such that for any i > M ,\nc1i 2/d ≤ ηi ≤ c2i2/d.\nAlso, we can redefine the Sobolev space on a compact manifold using Laplace-Beltrami operator. W s2 = {f ∈ L2 : ∥∥∥∆s/2f∥∥∥\n2 <∞}.\nAnd this definition of W s2 is equivalent to common definition of Sobolev space using differentiation, see [27] for the details for this equivalence.\nFirst we need the following lemma. Lemma 9. Suppose f ∈W s2 and Nt = ( 1 t )α , then we have∑\ni>Nt\n〈f, vi〉22 ≤ Ct2αs/d\nwhere vi is the eigenfunctions of Laplacian operator ∆ and C is a constant independent of t.\nProof. First let proof that ∞∑ i=0 〈f, vi〉22 i 2s/d <∞.\nUsing the implication of Weyl’s Law, we have for i > M , i2s/d ≤ η s i\nc1 . Thus,\n∞∑ i=0 〈f, vi〉22 i 2s/d = ∞∑ i≤M 〈f, vi〉22 i 2s/d + ∞∑ i>M 〈f, vi〉22 i 2s/d\n≤ ∞∑ i≤M 〈f, vi〉22 i 2s/d + ∞∑ i>M 〈f, vi〉22 ηsi c1\n≤ ∞∑ i≤M 〈f, vi〉22 i 2s/d + 1 c1 ∥∥∥∆s/2f∥∥∥2 2 <∞\nLet ∑∞ i=0 〈f, vi〉 2 2 i 2s/d = C. For Nt = ( 1 t )α . We have\nN 2s/d t ∑ i>Nt 〈f, vi〉22 < ∑ i>Nt 〈f, vi〉22 i 2s/d ≤ C.\nThus, ∑ i>Nt 〈f, vi〉22 < C N 2s/d t = Ct2αs/d.\nNow we can give the proof for Lemma 6.\nProof. RKHS is unique for a given domain and kernel, so is independent of the measure used to define the L2,ρ. Thus for any g ∈ L2,p, there should be h ∈ L2 such that L1/2t,p g = L 1/2 t h and\n‖g‖2,p = ‖ L1/2t,p g‖Ht = ‖ L 1/2 t h‖Ht = ‖h‖2.\nSince this is true for arbitrary g ∈ L2,p, we have\nmin g∈L2,p ∥∥∥f − L1/2t,p g∥∥∥2 2,p + λ′‖g‖22,p = min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2,p + λ′‖h‖22\nBecause ‖ · ‖2,p ≤ Γ‖ · ‖2,\nmin h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2,p + λ′‖h‖22 ≤ Γ2 ( min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2 + λ′ Γ2 ‖h‖22 ) Now, let\nh∗λ′ = arg min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2 + λ′‖h‖22\nExpend f using the eigenfunctions v0, v1, . . . of ∆, we have\nf = ∞∑ i=0 〈f, vi〉2 vi\nDenote the eigenvalues of ∆ as η0, η1, . . . , the heat operator defined as Ht = e −∆t having eigenvalues as e−η0t, e−η1t, . . . . Recall the Weyl’s law, we have there exists M such that for any i > M , c1i 2/d ≤ ηi ≤ c2i2/d. When t is small enough, we will have Nt = 1 td/2 > M . Since we order ηi in non-decreasing order, for any i < Nt, we have ηi ≤ ηNt ≤ c2N 2/d t = c2/t, also e\n−ηit > e−c2 . Now denote PN be the operator that projects function f ∈ L2 to the subspace spanned by first N eigenfunctions of ∆. Thus\nPNtf = ∑ i≤Nt 〈f, vi〉2 vi\nwhere vi is the eigenfunction of ∆. And let\nĥ = H −1/2 t PNtf = Nt∑ i=0 e ηit 2 〈f, vi〉2 vi\nThus, we have\narg min h∈L2 ∥∥∥f − L1/2t h∥∥∥2 2 + λ′‖h‖22 ≤ ∥∥∥f − L1/2t ĥ∥∥∥2 2 + λ′‖ĥ‖22\n= ∥∥∥∥∥∥ ∑ i>Nt 〈f, vi〉2 vi + ∑ i≤Nt 〈f, vi〉2 vi − L 1/2 t ĥ ∥∥∥∥∥∥ 2\n2\n+ λ′‖ĥ‖22\n≤ ∥∥∥∥∥∑ i>Nt 〈f, vi〉2 vi ∥∥∥∥∥ 2 + ∥∥∥H1/2H−1/2PNtf − L1/2t H−1/2PNtf∥∥∥ 2 2 + λ′ Nt∑ i=1 eηit 〈 f, vti 〉2 2\n(38)\nNow let us proceed by bound the above formula. By Lemma 9 with Nt = 1 td/2 and s = 2, we have\n∞∑ i=Nt+1 〈f, vi〉22 ≤ Ct 2\nAlso, for i < Nt, e ηit ≤ ec2 , thus ‖H−1/2PNtf‖2 ≤ ec2/2 ‖PNtf‖2 ≤ ec2/2 ‖f‖2. Recall we have ‖H 1/2 t −\nL 1/2 t ‖L2→L2 ≤ C ′tfor a constant C ′. Thus, we have∥∥∥H1/2H−1/2PNtf − L1/2t H−1/2PNtf∥∥∥\n2 ≤ C ′ec2/2 ‖f‖2 t\nFor the third term in (38), we have\nλ′ Nt∑ i=1 eηit 〈f, vi〉22 ≤ λ ′ec2 Nt∑ i=1 〈f, vi〉22 ≤ λ ′ec2 ‖f‖22\nHence, ∥∥∥f − L1/2t,p g∗λ′∥∥∥2 2,p + λ′‖g∗λ′‖22,p ≤ Γ2 ( Cts + C ′ec2/2 ‖f‖2 t )2 + λ′ec2 ‖f‖22\nWhen t is small enough, t2 ≤ t, letting D1 = Γ2(C + C ′ec2/2), D2 = ec2 , we prove the lemma."
    }, {
      "heading" : "C Proof for Theorems in 4.2.2",
      "text" : "In the second case, since we do not have samples from q, we replace Kt,q,zq by q. Consider corresponding f IIλ ,\nf IIλ =(K3t,p + λI)−1K2t,pq = (K3t,p + λI)−1K2t,p ( q −Kt,p q\np +Kt,p\nq\np ) =(K3t,p + λI)−1K2t,p ( q −Kt,p q\np\n) + (K3t,p + λI)−1K3t,p q\np Thus, we need to bound the extra term (K3t,p+λI)−1K2t,p ( q −Kt,p qp ) . Let d = q−Kt,p qp and ‖d‖2,p = δt,\nwe have ∥∥( L3t,p + λI)−1 L2t,pd∥∥2,p = ( ∞∑ i=1 ( σ2i 〈ui, d〉2,p σ3i + λ )2) 12 ≤ max σ>0 ( 1 σ + λσ2 ) δt ≤ δt( 2 1 3 + 2− 2 3 ) λ 1 3 ≤ λ− 13 δt\nThe bound for δt is given in the following lemma.\nLemma 10. Suppose p, q are two density function of probability measures of the domain Ω and satisfying the assumptions we gave in section 4.1. We have the following: (1) When Ω is Rd and q ∈W 22 (R2), we have∥∥∥∥Kt,p qp − q ∥∥∥∥ 2,p = O(t)\n(2) When Omega is a manifold M without boundary of d dimension and q ∈W 22 (M), we have∥∥∥∥Kt,p qp − q ∥∥∥∥\n2,p\n= O(t1−ε)\nfor any 0 < ε < 1.\nProof. By definition of Kt,p, we have\nKt,p q\np − q = ∫ Rd kt(x, y) q(y) p(y) p(y)dy − q(x) = ∫ Rd kt(x, y)(q(y)− q(x))dy = (Kt − I)q\nBy results in [?], we have (Kt−I)q = t∆q+ o(t) when q is twice differentiable. Due to q ∈W 22 (Rd), we have ‖∆q‖2 <∞. Thus, we have\n‖Kt,p q\np − q‖2,p ≤ Γ‖Kt,p\nq p − q‖2 = Γ‖t∆q + o(t)‖2 ≤ Γt‖∆q‖2 + o(t) = O(t).\nFor manifold case, we have (Kt −D)q = t∆q + o(t), where Df = ∫ M kt(x, y)dyf(x). Thus,\n(Kt − I)q = (Kt −D)q + (D − I)q.\nFor the first term, we have the same rate with Rd. Now we proceed by bounding the second term. ‖(D − I)q‖2 = ∥∥∥∥(∫\nM kt(·, y)dy − 1\n) q(·) ∥∥∥∥\n2\n≤ ∥∥∥∥∫ M kt(·, y)dy − 1 ∥∥∥∥ 2 ‖q‖2\nWe know that ‖q‖2 <∞. Let Bt(x) = {y ∈ M : ‖x − y‖2 < t 1 2−ε} and Rt(x) is the projection of Bt(x) on the TxM. In the following proof, we need to use change of variables to converting integral over a manifold to the integral over the tangent space at a specific point. For two points x, y ∈ M, let y′ = πx(y) be the projection of y in the tangent space Tx of M at x. Let Jπx |y denote the Jacobian of the map πx at point y ∈ M and Jπ−1x ∣∣∣ y′ is the inverse. For y sufficiently close to x, we have\n‖x− y‖ = ‖x− y′‖+O(‖x− y′‖3)∣∣∣Jπx |y − 1∣∣∣ = O(‖x− y‖2)∣∣∣∣Jπ−1x ∣∣∣y′ − 1 ∣∣∣∣ = O(‖x− y′‖2).\nThus, it is true that the points in Rt(x) are still no further than 2t 1 2−ε, when t is small enough. Since kt has exponential decay, the integral ∫ Bt(x) kt(y, ·)dy is of order O(e−t −ε ), and so is ∫ Rt(x) kt(y ′, ·)dy′. Thus, for any point x ∈M, ∣∣∣∣∫ M kt(x, ·)dx− 1\n∣∣∣∣ =\n∣∣∣∣∣ ∫ Bt(x) kt(y, ·)dy − 1 +O(e−t −ε ) ∣∣∣∣∣ =\n∣∣∣∣∣ ∫ Bt(x) kt(y, ·)dy − ∫ TxM kt(y ′, ·)dy′ +O(e−t −ε ) ∣∣∣∣∣ =\n∣∣∣∣∣ ∫ R(x) kt(y ′, ·)Jπ−1 |y′dy′ − ∫ R(x) kt(x, ·)dx+O(e−t −ε ) ∣∣∣∣∣ =\n∣∣∣∣∣ ∫ R(x) kt(x, ·)(Jπ−1 |x − 1)dx+O(e−t −ε ) ∣∣∣∣∣ =O(t1−2ε)\n∫ R(x) kt(x, ·)dx+O(e−t −ε )\n=O(t1−2ε) (∫ TxM kt(x, ·)dx+O(e−t −ε ) ) +O(e−t −ε )\n=O(t1−2ε) ( 1 +O(e−t −ε ) ) +O(e−t −ε )\n=O(t1−2ε)\nAbusing the notation of ε, we have ‖ ∫ M kt(·, y)dy − 1‖2 ≤ O(t 1−ε) where 0 < ε < 1.\nFor the concentration of ‖f IIλ − f IIλ,z‖2,p, we will consider their close formulas\nf IIλ = ( K3p + λI )−1K2pq f IIλ,z = ( K3zp + λI )−1 K2zpq\n(39)\nBy the similar argument to that in Lemma 8, we will have the following lemma gives the concentration bound.\nLemma 11. Let p be a density of a probability measure over a domain X and q another density function. They satisfy the assumptions in 4.1. Consider f IIλ and f II λ,z defined in Eq. 39, with confidence at least 1−2e−τ ,\nwe have ∥∥f IIλ − f IIλ,z∥∥2,p ≤ C4( κt√τλ3/2√n + κt √ τ λ √ n ) where κt = supx∈Ω kt(x, x) = 1 (2πt)d/2\nProof. Let f̃ = ( K3zp + λI )−1 K2pq. We have f IIλ − f IIλ,z = f IIλ − f̃ + f̃ − f IIλ,z. For f IIλ − f̃ , using the fact that(\nK3p + λI ) f IIλ = K2pq, we have\nf IIλ − f̃ =f IIλ − ( K3zp + λI )−1 ( K3p + λI ) f IIλ\n= ( K3zp + λI )−1 ( K3zp −K 3 p ) f IIλ\nAnd\nf̃ − f IIλ,z = ( K3zp + λI )−1 K2pq − ( K3zp + λI )−1 K2zpq\n= ( K3zp + λI )−1 ( K2p −K2zp ) q\nNotice that we have K3zp −K 3 p and K2zp −K 2 p in the identity we get. For these two objects, it is not hard\nto verify the following identities,\nK3zp −K 3 p = ( Kzp −Kp )3 +Kp ( Kzp −Kp )2 + ( Kzp −Kp ) Kp ( Kzp −Kp ) + ( Kzp −Kp )2Kp +K2p ( Kzp −Kp ) +Kp ( Kzp −Kp ) Kp + ( Kzp −Kp ) K2p.\nAnd\nK2zp −K 2 p = ( Kzp −Kp )2 +Kp ( Kzp −Kp ) + ( Kzp −Kp ) Kp\nThus, in these two identities, the only two random variables are Kzp−Kp. By results about concentration of Kzp and Kzq , we have with probability 1− 2e−τ ,\n‖Kzp −Kp‖H→H ≤ κt √ τ√ n ,\n∥∥Kzpq −Kpq∥∥H ≤ κt‖q‖∞ √ 2τ√ n\n(40)\nAnd we know that for a large enough constant c which is independent of t and λ, ‖Kp‖H→H < c, ∥∥∥∥(K3zp + λI)−1∥∥∥∥\nH→H ≤ 1 λ , ‖Kpq‖H < c‖q‖2,p\nand\n‖f IIλ ‖2H = ∑ i σ3i (σ3i + λ) 2 〈q, ui〉2 ≤ ( sup σ>0\nσ3\n(σ3 + λ)2 )∑ i 〈q, ui〉2 ≤ c2 λ ‖q‖22,p\nthus, ‖f IIλ ‖H ≤ cλ1/2 ‖q‖2,p. Notice that ∥∥∥(Kzp −Kp)2∥∥∥H ≤ ∥∥Kzp −Kp∥∥2H and ∥∥∥(Kzp −Kp)3∥∥∥H ≤ ∥∥Kzp −Kp∥∥3H, both of this could be of smaller order compared with\n∥∥Kzp −Kp∥∥H. For simplicity we hide the term including them in the final bound without changing the dominant order. We could also hide the terms with the product of any two the random variables in Eq. 40, which is of prior order compared to the term with only one random variable. Now let us put everything together,\n‖f IIλ − f IIλ,z‖2,p ≤ c1/2‖f IIλ − f IIλ,z‖Ht ≤c1/2 ( c3κt √ τ\nλ3/2 √ n ‖q‖2,p +\nc2κt √ τ\nλ √ n ‖q‖∞ ) ≤C4 ( κt √ τ\nλ3/2 √ n\n+ κt √ τ\nλ √ n ) where C4 = c 5/2 max ( c ‖q‖2,p , ‖q‖∞ ) .\nGiven the above lemmas, the main theorem for the second case follows."
    } ],
    "references" : [ {
      "title" : "On regularization algorithms in learning theory",
      "author" : [ "Frank Bauer", "Sergei Pereverzev", "Lorenzo Rosasco" ],
      "venue" : "Journal of complexity,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2007
    }, {
      "title" : "Manifold regularization: A geometric framework for learning from labeled and unlabeled examples",
      "author" : [ "Mikhail Belkin", "Partha Niyogi", "Vikas Sindhwani" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2006
    }, {
      "title" : "Discriminative learning for differing training and test distributions",
      "author" : [ "Steffen Bickel", "Michael Brückner", "Tobias Scheffer" ],
      "venue" : "In Proceedings of the 24th international conference on Machine learning,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2007
    }, {
      "title" : "Optimal rates of convergence for deconvolving a density",
      "author" : [ "Raymond J Carroll", "Peter Hall" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 1988
    }, {
      "title" : "Learning from examples as an inverse problem",
      "author" : [ "Ernesto De Vito", "Lorenzo Rosasco", "Andrea Caponnetto", "Umberto De Giovannini", "Francesca Odone" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2006
    }, {
      "title" : "Spectral regularization for support estimation",
      "author" : [ "Ernesto De Vito", "Lorenzo Rosasco", "Alessandro Toigo" ],
      "venue" : "Advances in Neural Information Processing Systems, NIPS Foundation,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2010
    }, {
      "title" : "Maximum smoothed likelihood density estimation for inverse problems",
      "author" : [ "P. Eggermont", "V. LaRicca" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 1995
    }, {
      "title" : "Covariate shift by kernel mean matching",
      "author" : [ "Arthur Gretton", "Alex Smola", "Jiayuan Huang", "Marcel Schmittfull", "Karsten Borgwardt", "Bernhard Schölkopf" ],
      "venue" : "Dataset shift in machine learning,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2009
    }, {
      "title" : "Conditional mean embeddings as regressors",
      "author" : [ "S Grünewälder", "G Lever", "L Baldassarre", "S Patterson", "A Gretton", "M Pontil" ],
      "venue" : "In Proceedings of the 29th International Conference on Machine Learning, ICML 2012,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2012
    }, {
      "title" : "Correcting sample selection bias by unlabeled data",
      "author" : [ "Jiayuan Huang", "Alexander J. Smola", "Arthur Gretton", "Karsten M. Borgwardt", "Bernhard Schölkopf" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2006
    }, {
      "title" : "Review papers: Recent developments in nonparametric density estimation",
      "author" : [ "Alan Julian Izenman" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 1991
    }, {
      "title" : "A least-squares approach to direct importance estimation",
      "author" : [ "Takafumi Kanamori", "Shohei Hido", "Masashi Sugiyama" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2009
    }, {
      "title" : "Robust kernel density estimation",
      "author" : [ "Joo Seuk Kim", "Clayton Scott" ],
      "venue" : "In Acoustics, Speech and Signal Processing,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2008
    }, {
      "title" : "Linear integral equations, volume 82",
      "author" : [ "Rainer Kress" ],
      "venue" : null,
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 1999
    }, {
      "title" : "Metropolized independent sampling with comparisons to rejection sampling and importance sampling",
      "author" : [ "Jun Liu" ],
      "venue" : "Statistics and Computing,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 1996
    }, {
      "title" : "Annealed importance sampling",
      "author" : [ "Radford M Neal" ],
      "venue" : "Statistics and Computing,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2001
    }, {
      "title" : "Estimating divergence functionals and the likelihood ratio by penalized convex risk minimization",
      "author" : [ "XuanLong Nguyen", "Martin J Wainwright", "Michael I Jordan" ],
      "venue" : "Advances in neural information processing systems,",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2008
    }, {
      "title" : "A survey on transfer learning",
      "author" : [ "Sinno Jialin Pan", "Qiang Yang" ],
      "venue" : "Knowledge and Data Engineering, IEEE Transactions on,",
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 2010
    }, {
      "title" : "On estimation of a probability density function and mode",
      "author" : [ "E. Parzen" ],
      "venue" : "The Annals of Mathematical Statistics,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 1962
    }, {
      "title" : "Learning with kernels: Support vector machines, regularization, optimization, and beyond",
      "author" : [ "Bernhard Schölkopf", "Alexander J Smola" ],
      "venue" : "MIT press,",
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2001
    }, {
      "title" : "Kernel methods for pattern analysis",
      "author" : [ "John Shawe-Taylor", "Nello Cristianini" ],
      "venue" : "Cambridge university press,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 2004
    }, {
      "title" : "Data spectroscopy: Eigenspaces of convolution operators and clustering",
      "author" : [ "Tao Shi", "Mikhail Belkin", "Bin Yu" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2009
    }, {
      "title" : "Improving predictive inference under covariate shift by weighting the loglikelihood function",
      "author" : [ "Hidetoshi Shimodaira" ],
      "venue" : "Journal of Statistical Planning and Inference,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2000
    }, {
      "title" : "On a kernel-based method for pattern recognition, regression, approximation, and operator inversion",
      "author" : [ "Alex J Smola", "Bernhard Schölkopf" ],
      "venue" : null,
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 1998
    }, {
      "title" : "Support vector machines",
      "author" : [ "Ingo Steinwart", "Andreas Christmann" ],
      "venue" : null,
      "citeRegEx" : "26",
      "shortCiteRegEx" : "26",
      "year" : 2008
    }, {
      "title" : "Analysis of the laplacian on the complete riemannian manifold",
      "author" : [ "R.S. Strichartz" ],
      "venue" : "Journal of Functional Analysis,",
      "citeRegEx" : "27",
      "shortCiteRegEx" : "27",
      "year" : 1983
    }, {
      "title" : "Covariate shift adaptation by importance weighted cross validation",
      "author" : [ "Masashi Sugiyama", "Matthias Krauledat", "Klaus-Robert Müller" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "28",
      "shortCiteRegEx" : "28",
      "year" : 2007
    }, {
      "title" : "Direct importance estimation with model selection and its application to covariate shift adaptation",
      "author" : [ "Masashi Sugiyama", "Shinichi Nakajima", "Hisashi Kashima", "Paul Von Buenau", "Motoaki Kawanabe" ],
      "venue" : "Advances in Neural Information Processing Systems,",
      "citeRegEx" : "29",
      "shortCiteRegEx" : "29",
      "year" : 2008
    }, {
      "title" : "Partial Differential Equation",
      "author" : [ "M.E. Taylor" ],
      "venue" : null,
      "citeRegEx" : "30",
      "shortCiteRegEx" : "30",
      "year" : 1997
    }, {
      "title" : "Support vector method for multivariate density estimation",
      "author" : [ "Vladimir Vapnik", "Sayan Mukherjee" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "31",
      "shortCiteRegEx" : "31",
      "year" : 1999
    }, {
      "title" : "Practical approximate solutions to linear operator equations when the data are noisy",
      "author" : [ "Grace Wahba" ],
      "venue" : "SIAM Journal on Numerical Analysis,",
      "citeRegEx" : "32",
      "shortCiteRegEx" : "32",
      "year" : 1977
    }, {
      "title" : "The effect of the input density distribution on kernel-based classifiers",
      "author" : [ "Christopher Williams", "Matthias Seeger" ],
      "venue" : "In Proceedings of the 17th International Conference on Machine Learning. Citeseer,",
      "citeRegEx" : "33",
      "shortCiteRegEx" : "33",
      "year" : 2000
    }, {
      "title" : "On early stopping in gradient descent learning",
      "author" : [ "Yuan Yao", "Lorenzo Rosasco", "Andrea Caponnetto" ],
      "venue" : "Constructive Approximation,",
      "citeRegEx" : "34",
      "shortCiteRegEx" : "34",
      "year" : 2007
    }, {
      "title" : "Analysis of kernel mean matching under covariate shift",
      "author" : [ "Yaoliang Yu", "Csaba Szepesvári" ],
      "venue" : "In ICML,",
      "citeRegEx" : "35",
      "shortCiteRegEx" : "35",
      "year" : 2012
    } ],
    "referenceMentions" : [ {
      "referenceID" : 10,
      "context" : ", see the review [11]), particularly, dealing with a class of non-parametric kernel estimators going back to the work of Parzen [20].",
      "startOffset" : 17,
      "endOffset" : 21
    }, {
      "referenceID" : 18,
      "context" : ", see the review [11]), particularly, dealing with a class of non-parametric kernel estimators going back to the work of Parzen [20].",
      "startOffset" : 128,
      "endOffset" : 132
    }, {
      "referenceID" : 14,
      "context" : ", [16]) deals with this problem by using a ratio of two densities (which is typically assumed to be known in that literature).",
      "startOffset" : 2,
      "endOffset" : 6
    }, {
      "referenceID" : 7,
      "context" : ", [8, 13, 10, 28, 3].",
      "startOffset" : 2,
      "endOffset" : 20
    }, {
      "referenceID" : 11,
      "context" : ", [8, 13, 10, 28, 3].",
      "startOffset" : 2,
      "endOffset" : 20
    }, {
      "referenceID" : 9,
      "context" : ", [8, 13, 10, 28, 3].",
      "startOffset" : 2,
      "endOffset" : 20
    }, {
      "referenceID" : 26,
      "context" : ", [8, 13, 10, 28, 3].",
      "startOffset" : 2,
      "endOffset" : 20
    }, {
      "referenceID" : 2,
      "context" : ", [8, 13, 10, 28, 3].",
      "startOffset" : 2,
      "endOffset" : 20
    }, {
      "referenceID" : 22,
      "context" : "Many of these papers consider this problem in the context of covariate shift assumption [24] or the so-called selection bias [36].",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 7,
      "context" : "We will provide a more detailed discussion of these and other related papers and connections to our work in Section 2, where we also discuss how the Kernel Mean Matching algorithm [8, 10] can be viewed within our framework.",
      "startOffset" : 180,
      "endOffset" : 187
    }, {
      "referenceID" : 9,
      "context" : "We will provide a more detailed discussion of these and other related papers and connections to our work in Section 2, where we also discuss how the Kernel Mean Matching algorithm [8, 10] can be viewed within our framework.",
      "startOffset" : 180,
      "endOffset" : 187
    }, {
      "referenceID" : 9,
      "context" : "This formulation (see Section 3) also yields an explicit formula and is related to the Kernel Mean Matching algorithm [10] (see the discussion in Section 2), although with a different optimization procedure.",
      "startOffset" : 118,
      "endOffset" : 122
    }, {
      "referenceID" : 32,
      "context" : ", [34, 1]) can be used and may have computational advantages.",
      "startOffset" : 2,
      "endOffset" : 9
    }, {
      "referenceID" : 0,
      "context" : ", [34, 1]) can be used and may have computational advantages.",
      "startOffset" : 2,
      "endOffset" : 9
    }, {
      "referenceID" : 9,
      "context" : "Finally, in Section 6 we discuss the experimental results on several data sets comparing our method FIRE with the available alternatives, Kernel Mean Matching (KMM) [10] and LSIF [13] as well as the base-line thresholded inverse kernel density estimator (TIKDE) and importance sampling (when available).",
      "startOffset" : 165,
      "endOffset" : 169
    }, {
      "referenceID" : 11,
      "context" : "Finally, in Section 6 we discuss the experimental results on several data sets comparing our method FIRE with the available alternatives, Kernel Mean Matching (KMM) [10] and LSIF [13] as well as the base-line thresholded inverse kernel density estimator (TIKDE) and importance sampling (when available).",
      "startOffset" : 179,
      "endOffset" : 183
    }, {
      "referenceID" : 10,
      "context" : "The problem of density estimation has a long history in classical statistical literature and a rich variety of methods are available [11].",
      "startOffset" : 133,
      "endOffset" : 137
    }, {
      "referenceID" : 6,
      "context" : "Some of the related older work includes density estimation for inverse problems [7] and the literature on deconvolution, e.",
      "startOffset" : 80,
      "endOffset" : 83
    }, {
      "referenceID" : 3,
      "context" : ", [4].",
      "startOffset" : 2,
      "endOffset" : 5
    }, {
      "referenceID" : 17,
      "context" : "In the last few years the problem of density ratio estimation has received significant attention due in part to the increased interest in transfer learning [19] and, in particular to the form of transfer learning known as covariate shift [24].",
      "startOffset" : 156,
      "endOffset" : 160
    }, {
      "referenceID" : 22,
      "context" : "In the last few years the problem of density ratio estimation has received significant attention due in part to the increased interest in transfer learning [19] and, in particular to the form of transfer learning known as covariate shift [24].",
      "startOffset" : 238,
      "endOffset" : 242
    }, {
      "referenceID" : 2,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 7,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 11,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 26,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 9,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 27,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 16,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 106,
      "endOffset" : 140
    }, {
      "referenceID" : 9,
      "context" : "Some of the work on covariate shift, ratio density estimation and other closely related settings includes [36, 3, 8, 13, 28, 10, 29, 12, 18] The algorithm most closely related to our approach is Kernel Mean Matching (KMM) [10].",
      "startOffset" : 222,
      "endOffset" : 226
    }, {
      "referenceID" : 7,
      "context" : "Also, since there is no regularizing term, the problem is less stable (see Section 6 for some experimental comparisons) and the theoretical analysis is harder (however, see [8] and the recent paper [35] for some nice theoretical analysis of KMM in certain settings).",
      "startOffset" : 173,
      "endOffset" : 176
    }, {
      "referenceID" : 33,
      "context" : "Also, since there is no regularizing term, the problem is less stable (see Section 6 for some experimental comparisons) and the theoretical analysis is harder (however, see [8] and the recent paper [35] for some nice theoretical analysis of KMM in certain settings).",
      "startOffset" : 198,
      "endOffset" : 202
    }, {
      "referenceID" : 11,
      "context" : "Another related recent algorithm is Least Squares Importance Sampling (LSIF) [13], which attempts to estimate the density ratio by choosing a parametric linear family of functions and choosing a function from this family to minimize the L2,p distance to the density ratio.",
      "startOffset" : 77,
      "endOffset" : 81
    }, {
      "referenceID" : 27,
      "context" : "A similar setting with the Kullback-Leibler distance (KLIEP) was proposed in [29].",
      "startOffset" : 77,
      "endOffset" : 81
    }, {
      "referenceID" : 24,
      "context" : ", [26, 22, 21]).",
      "startOffset" : 2,
      "endOffset" : 14
    }, {
      "referenceID" : 20,
      "context" : ", [26, 22, 21]).",
      "startOffset" : 2,
      "endOffset" : 14
    }, {
      "referenceID" : 19,
      "context" : ", [26, 22, 21]).",
      "startOffset" : 2,
      "endOffset" : 14
    }, {
      "referenceID" : 4,
      "context" : ", [5, 25] in the Tikhonov regularization or other regularization frameworks.",
      "startOffset" : 2,
      "endOffset" : 9
    }, {
      "referenceID" : 23,
      "context" : ", [5, 25] in the Tikhonov regularization or other regularization frameworks.",
      "startOffset" : 2,
      "endOffset" : 9
    }, {
      "referenceID" : 29,
      "context" : "we note interesting methods for density estimation proposed in [31] and estimating the support of density through spectral regularization in [6], as well as robust density estimation using RKHS formulations [14] and conditional density [9].",
      "startOffset" : 63,
      "endOffset" : 67
    }, {
      "referenceID" : 5,
      "context" : "we note interesting methods for density estimation proposed in [31] and estimating the support of density through spectral regularization in [6], as well as robust density estimation using RKHS formulations [14] and conditional density [9].",
      "startOffset" : 141,
      "endOffset" : 144
    }, {
      "referenceID" : 12,
      "context" : "we note interesting methods for density estimation proposed in [31] and estimating the support of density through spectral regularization in [6], as well as robust density estimation using RKHS formulations [14] and conditional density [9].",
      "startOffset" : 207,
      "endOffset" : 211
    }, {
      "referenceID" : 8,
      "context" : "we note interesting methods for density estimation proposed in [31] and estimating the support of density through spectral regularization in [6], as well as robust density estimation using RKHS formulations [14] and conditional density [9].",
      "startOffset" : 236,
      "endOffset" : 239
    }, {
      "referenceID" : 31,
      "context" : "We also note the connections of the methods in this paper to properties of density-dependent operators in classification and clustering [33, 23].",
      "startOffset" : 136,
      "endOffset" : 144
    }, {
      "referenceID" : 21,
      "context" : "We also note the connections of the methods in this paper to properties of density-dependent operators in classification and clustering [33, 23].",
      "startOffset" : 136,
      "endOffset" : 144
    }, {
      "referenceID" : 1,
      "context" : ", [2].",
      "startOffset" : 2,
      "endOffset" : 5
    }, {
      "referenceID" : 13,
      "context" : "Finally, the setting in this paper is connected to the large literature on integral equations [15].",
      "startOffset" : 94,
      "endOffset" : 98
    }, {
      "referenceID" : 30,
      "context" : "In particular, we note [32], which analyzes the classical Fredholm problem using regularization for noisy data.",
      "startOffset" : 23,
      "endOffset" : 27
    }, {
      "referenceID" : 24,
      "context" : "The direct consequence of this is the Representer Theorem, which allows us to write solutions to various optimization problems over H in terms of linear combinations of kernels supported on sample points (see [26] for an in-depth discussion or the RKHS theory and the issues related to learning).",
      "startOffset" : 209,
      "endOffset" : 213
    }, {
      "referenceID" : 9,
      "context" : "We note the connection between this formulation of using the RKHS norm as a loss function and the KMM algorithm [10].",
      "startOffset" : 112,
      "endOffset" : 116
    }, {
      "referenceID" : 11,
      "context" : "Interestingly a somewhat similar formula arises in [13] as unconstrained LSIF, with a different functional basis (kernels centered at the points of the sample zq) and in a setting not directly related to RKHS inference.",
      "startOffset" : 51,
      "endOffset" : 55
    }, {
      "referenceID" : 15,
      "context" : ", many problems involving MCMC) where q(x) is known explicitly (possibly up to a multiplicative constant), while sampling from q is expensive or even impossible computationally [17].",
      "startOffset" : 177,
      "endOffset" : 181
    }, {
      "referenceID" : 28,
      "context" : ", [30]).",
      "startOffset" : 2,
      "endOffset" : 6
    }, {
      "referenceID" : 11,
      "context" : "We note that this way of measuring the error is related to the LSIF [13] and KLIEP [29], algorithms.",
      "startOffset" : 68,
      "endOffset" : 72
    }, {
      "referenceID" : 27,
      "context" : "We note that this way of measuring the error is related to the LSIF [13] and KLIEP [29], algorithms.",
      "startOffset" : 83,
      "endOffset" : 87
    }, {
      "referenceID" : 7,
      "context" : "Two ways of resampling, using the features of the data and using the label information, are used (along the lines similar to those proposed in [8]).",
      "startOffset" : 143,
      "endOffset" : 146
    } ],
    "year" : 2013,
    "abstractText" : "In this paper we address the problem of estimating the ratio q p where p is a density function and q is another density, or, more generally an arbitrary function. Knowing or approximating this ratio is needed in various problems of inference and integration, in particular, when one needs to average a function with respect to one probability distribution, given a sample from another. It is often referred as importance sampling in statistical inference and is also closely related to the problem of covariate shift in transfer learning as well as to various MCMC methods. It may also be useful for separating the underlying geometry of a space, say a manifold, from the density function defined on it. Our approach is based on reformulating the problem of estimating q p as an inverse problem in terms of an integral operator corresponding to a kernel, and thus reducing it to an integral equation, known as the Fredholm problem of the first kind. This formulation, combined with the techniques of regularization and kernel methods, leads to a principled kernel-based framework for constructing algorithms and for analyzing them theoretically. The resulting family of algorithms (FIRE, for Fredholm Inverse Regularized Estimator) is flexible, simple and easy to implement. We provide detailed theoretical analysis including concentration bounds and convergence rates for the Gaussian kernel in the case of densities defined on R, compact domains in R and smooth d-dimensional sub-manifolds of the Euclidean space. We also show experimental results including applications to classification and semi-supervised learning within the covariate shift framework and demonstrate some encouraging experimental comparisons. We also show how the parameters of our algorithms can be chosen in a completely unsupervised manner.",
    "creator" : "LaTeX with hyperref package"
  }
}