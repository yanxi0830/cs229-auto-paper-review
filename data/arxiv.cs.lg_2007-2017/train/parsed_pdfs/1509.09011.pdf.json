{
  "name" : "1509.09011.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Regret Lower Bound and Optimal Algorithm in Finite Stochastic Partial Monitoring",
    "authors" : [ "Junpei Komiyama", "Junya Honda" ],
    "emails" : [ "junpei@komiyama.info", "honda@stat.t.u-tokyo.ac.jp", "nakagawa@dl.itc.u-tokyo.ac.jp" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 9.\n09 01\n1v 1\n[ st\nat .M\nL ]\nPartial monitoring is a general model for sequential learning with limited feedback formalized as a game between two players. In this game, the learner chooses an action and at the same time the opponent chooses an outcome, then the learner suffers a loss and receives a feedback signal. The goal of the learner is to minimize the total loss. In this paper, we study partial monitoring with finite actions and stochastic outcomes. We derive a logarithmic distribution-dependent regret lower bound that defines the hardness of the problem. Inspired by the DMED algorithm (Honda and Takemura, 2010) for the multi-armed bandit problem, we propose PM-DMED, an algorithm that minimizes the distribution-dependent regret. PM-DMED significantly outperforms state-of-the-art algorithms in numerical experiments. To show the optimality of PM-DMED with respect to the regret bound, we slightly modify the algorithm by introducing a hinge function (PMDMED-Hinge). Then, we derive an asymptotically optimal regret upper bound of PM-DMED-Hinge that matches the lower bound."
    }, {
      "heading" : "1 Introduction",
      "text" : "Partial monitoring is a general framework for sequential decision making problems with imperfect feedback. Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.\nPartial monitoring is formalized as a repeated game played by two players called a learner and an opponent. At each round, the learner chooses an action, and at the same time the opponent chooses an outcome. Then, the learner observes a feedback signal from a given set of symbols and suffers some loss, both of which are deterministic functions of the selected action and outcome.\nThe goal of the learner is to find the optimal action that minimizes his/her cumulative loss. Alternatively, we can define the regret as the difference between the cumulative losses of the learner and the single optimal action, and minimization of the loss is equivalent to minimization of the regret. A learner with a small regret balances exploration (acquisition of information about the strategy of the opponent) and exploitation (utilization of information). The rate of regret indicates how fast the learner adapts to the problem: a linear regret indicates the inability of the learner to find the optimal action, whereas a sublinear regret indicates that the learner can approach the optimal action given sufficiently large time steps.\nThe study of partial monitoring is classified into two settings with respect to the assumption on the outcomes. On one hand, in the stochastic setting, the opponent chooses an outcome distribution before the game starts, and an outcome at each round is an i.i.d. sample from the distribution. On the other hand, in the adversarial setting, the opponent chooses the outcomes to maximize the regret of the learner. In this paper, we study the former setting."
    }, {
      "heading" : "1.1 Related work",
      "text" : "The paper by Piccolboni and Schindelhauer [8] is one of the first to study the regret of the finite partial monitoring problem. They proposed the FeedExp3 algorithm, which attains O(T 3/4) minimax regret on some problems. This bound was later improved by Cesa-Bianchi et al. [9] to O(T 2/3), who also showed an instance in which the bound is optimal. Since then, most literature on partial monitoring has dealt with the minimax regret, which is the worst-case regret over all possible opponent’s strategies. Bartók et al. [10] classified the partial monitoring problems into four categories in terms of the minimax regret: a trivial problem with zero regret, an easy problem with Θ̃( √ T ) regret1, a hard problem with Θ(T 2/3) regret, and a hopeless problem with Θ(T ) regret. This shows that the class of the partial monitoring problems is not limited to the bandit sort but also includes larger classes of problems, such as dynamic pricing. Since then, several algorithms with a Õ( √ T ) regret bound for easy problems have been proposed [11, 12, 13]. Among them, the Bayes-update Partial Monitoring (BPM) algorithm [13] is state-of-the-art in the sense of empirical performance.\nDistribution-dependent and minimax regret: we focus on the distribution-dependent regret that depends on the strategy of the opponent. While the minimax regret in partial monitoring has been extensively studied, little has been known on distribution-dependent regret in partial monitoring. To the authors’ knowledge, the only paper focusing on the distribution-dependent regret in finite discrete partial monitoring is the one by Bartók et al. [11], which derivedO(logT ) distribution-dependent regret for easy problems. In contrast to this situation, much more interest in the distribution-dependent regret has been shown in the field of multi-armed bandit problems. Upper confidence bound (UCB), the most well-known algorithm for the multi-armed bandits, has a distribution-dependent regret bound [2, 14], and algorithms that minimize the distribution-dependent regret (e.g., KL-UCB) has been shown to perform better than ones that minimize the minimax regret (e.g., MOSS), even in instances in which the distributions are hard to distinguish (e.g., Scenario 2 in Garivier et al. [15]). Therefore, in the field of partial monitoring, we can expect that an algorithm that minimizes the distribution-dependent regret would perform better than the existing ones.\nContribution: the contributions of this paper lie in the following three aspects. First, we derive the regret lower bound: in some special classes of partial monitoring (e.g., multi-armed bandits), an O(logT ) regret lower bound is known to be achievable. In this paper, we further extend this lower bound to obtain a regret lower bound for general partial monitoring problems. Second, we propose an algorithm called Partial Monitoring DMED (PM-DMED). We also introduce a slightly modified version of this algorithm (PM-DMED-Hinge) and derive its regret bound. PM-DMED-Hinge is the first algorithm with a logarithmic regret bound for hard problems. Moreover, for both easy and hard problems, it is the first algorithm with the optimal constant factor on the leading logarithmic term. Third, performances of PM-DMED and existing algorithms are compared in numerical experiments. Here, the partial monitoring problems consisted of three specific instances of varying difficulty. In all instances, PM-DMED significantly outperformed the existing methods when a number of rounds is large. The regret of PM-DMED on these problems quickly approached the theoretical lower bound."
    }, {
      "heading" : "2 Problem Setup",
      "text" : "This paper studies the finite stochastic partial monitoring problem with N actions, M outcomes, and A symbols. An instance of the partial monitoring game is defined by a loss matrix L = (li,j) ∈ R\nN×M and a feedback matrix H = (hi,j) ∈ [A]N×M , where [A] = {1, 2, . . . , A}. At the beginning, the learner is informed of L and H . At each round t = 1, 2, . . . , T , a learner selects an action i(t) ∈ [N ], and at the same time an opponent selects an outcome j(t) ∈ [M ]. The learner\n1Note that Θ̃ ignores a polylog factor.\nsuffers loss li(t),j(t), which he/she cannot observe: the only information the learner receives is the signal hi(t),j(t) ∈ [A]. We consider a stochastic opponent whose strategy for selecting outcomes is governed by the opponent’s strategy p∗ ∈ PM , where PM is a set of probability distributions over an M -ary outcome. The outcome j(t) of each round is an i.i.d. sample from p∗.\nThe goal of the learner is to minimize the cumulative loss over T rounds. Let the optimal action be the one that minimizes the loss in expectation, that is, i∗ = arg mini∈[N ] L ⊤ i p\n∗, where Li is the i-th row of L. Assume that i∗ is unique. Without loss of generality, we can assume that i∗ = 1. Let ∆i = (Li−L1)⊤p∗ ∈ [0,∞) and Ni(t) be the number of rounds before the t-th in which action i is selected. The performance of the algorithm is measured by the (pseudo) regret,\nRegret(T ) =\nT∑\nt=1\n∆i(t) = ∑\ni∈[N ]\n∆iNi(T + 1),\nwhich is the difference between the expected loss of the learner and the optimal action 1. It is easy to see that minimizing the loss is\nequivalent to minimizing the regret. The expectation of the regret measures the performance of an algorithm that the learner uses.\nFor each action i ∈ [N ], let Ci be the set of opponent strategies for which action i is optimal: Ci = {q ∈ PM : ∀j 6=i(Li − Lj)⊤q ≤ 0}.\nWe call Ci the optimality cell of action i. Each optimality cell is a convex closed polytope. Furthermore, we call the set of optimality cells {C1, . . . , CN} the cell decomposition as shown in Figure 1. Let Cci = PM \\ Ci be the set of strategies with which action i is not optimal. The signal matrix Si ∈ {0, 1}A×M of action i is defined as (Si)k,j = 1[hi,j = k], where 1[X ] = 1 if X is true and 0 otherwise. The signal matrix defined here is slightly different from the one in the previous papers (e.g., Bartók et al. [10]) in which the number of rows of Si is the number of the different symbols in the i-th row of H . The advantage in using the definition here is that, Sip\n∗ ∈ RA is a probability distribution over symbols that the algorithm observes when it selects an action i. Examples of signal matrices are shown in Section 5. An instance of partial monitoring is globally observable if for all pairs i, j of actions, Li − Lj ∈ ⊕k∈[N ]ImS⊤k . In this paper, we exclusively deal with globally observable instances: in view of the minimax regret, this includes trivial, easy, and hard problems."
    }, {
      "heading" : "3 Regret Lower Bound",
      "text" : "A good algorithm should work well against any opponent’s strategy. We extend this idea by introducing the notion of strong consistency: a partial monitoring algorithm is strongly consistent if it satisfies E[Regret(T )] = o(T a) for any a > 0 and p ∈ PM given L and H . In the context of the multi-armed bandit problem, Lai and Robbins [2] derived the regret lower bound of a strongly consistent algorithm: an algorithm must select each arm i until its number of draws Ni(t) satisfies log t . Ni(t)d(θi‖θ1), where d(θi‖θ1) is the KL divergence between the two one-parameter distributions from which the rewards of action i and the optimal action are generated. Analogously, in the partial monitoring problem, we can define the minimum number of observations.\nLemma 1. For sufficiently large T , a strongly consistent algorithm satisfies:\n∀q∈Cc1 ∑\ni∈[N ]\nE[Ni(T )]D(p ∗ i ‖Siq) ≥ logT − o(logT ),\nwhere p∗i = Sip ∗ and D(p‖q) = ∑i(p)i log ((p)i/(q)i) is the KL divergence between two discrete distributions, in which we define 0 log 0/0 = 0.\nLemma 1 can be interpreted as follows: for each round t, consistency requires the algorithm to make sure that the possible risk that action i 6= 1 is optimal is smaller than 1/t. Large deviation principle [16] states that, the probability that an opponent with strategy q behaves like p∗ is\nroughly exp (−∑iNi(t)D(p∗i ‖Siq)). Therefore, we need to continue exploration of the actions until ∑ iNi(t)D(p ∗ i ‖Siq) ∼ log t holds for any q ∈ Cc1 to reduce the risk to exp (− log t) = 1/t.\nThe proof of Lemma 1 is in Appendix B in the supplementary material. Based on the technique used in Lai and Robbins [2], the proof considers a modified game in which another action i 6= 1 is optimal. The difficulty in proving the lower bound in partial monitoring lies in that, the feedback structure can be quite complex: for example, to confirm the superiority of action 1 over 2, one might need to use the feedback from action 3 /∈ {1, 2}. Still, we can derive the lower bound by utilizing the consistency of the algorithm in the original and modified games.\nWe next derive a lower bound on the regret based on Lemma 1. Note that, the expectation of the regret can be expressed as E[Regret(T )] = ∑ i6=1 E[Ni(t)](Li − L1)⊤p∗. Let\nRj({pi}) = { {ri}i6=j ∈ [0,∞)N−1 : inf\nq∈cl(Ccj ):pj=Sjq\n∑\ni\nriD(pi‖Siq) ≥ 1 } ,\nwhere cl(·) denotes a closure. Moreover, let\nC∗j (p, {pi}) = inf ri∈Rj({pi})\n∑\ni6=j\nri(Li − Lj)⊤p ,\nthe optimal solution of which is\nR∗j (p, {pi}) = { {ri}i6=j ∈ Rj({pi}) : ∑\ni6=j\nri(Li − Lj)⊤p = C∗j (p, {pi}) } .\nThe value C∗1 (p ∗, {p∗i }) logT is the possible minimum regret for observations such that the minimum divergence of p∗ from any q ∈ Cc1 is larger than log T . Using Lemma 1 yields the following regret lower bound:\nTheorem 2. The regret of a strongly consistent algorithm is lower bounded as:\nE[Regret(T )] ≥ C∗1 (p∗, {p∗i }) logT − o(logT ).\nFrom this theorem, we can naturally measure the harshness of the instance byC∗1 (p ∗, {p∗i }), whereas the past studies (e.g., Vanchinathan et al. [13]) ambiguously define the harshness as the closeness to the boundary of the cells. Furthermore, we show in Lemma 5 in the Appendix that C∗1 (p\n∗, {p∗i }) = O(N/‖p∗ − Cc1‖2M ): the regret bound has at most quadratic dependence on ‖p∗ − Cc1‖M , which is defined in Appendix D as the closeness of p∗ to the boundary of the optimal cell."
    }, {
      "heading" : "4 PM-DMED Algorithm",
      "text" : "In this section, we describe the partial monitoring deterministic minimum empirical divergence (PMDMED) algorithm, which is inspired by DMED [17] for solving the multi-armed bandit problem. Let p̂i(t) ∈ [0, 1]A be the empirical distribution of the symbols under the selection of action i. Namely, the k-th element of p̂i(t) is ( ∑t−1 t′=1 1[i(t ′) = i∩hi(t′),j(t′) = k])/( ∑t−1 t′=1 1[i(t ′) = i]). We sometimes omit t from p̂i when it is clear from the context. Let the empirical divergence of q ∈ PM be ∑ i∈[N ] Ni(t)D(p̂i(t)‖Siq), the exponential of which can be considered as a likelihood that q is the opponent’s strategy.\nThe main routine of PM-DMED is in Algorithm 1. At each loop, the actions in the current list ZC are selected once. The list for the actions in the next loop ZN is determined by the subroutine in Algorithm 2. The subroutine checks whether the empirical divergence of each point q ∈ Cc1 is larger than log t or not (Eq. (3)). If it is large enough, it exploits the current information by selecting î(t), the optimal action based on the estimation p̂(t) that minimizes the empirical divergence. Otherwise, it selects the actions with the number of observations below the minimum requirement for making the empirical divergence of each suboptimal point q ∈ Cc1 larger than log t. Unlike the N -armed bandit problem in which a reward is associated with an action, in the partial monitoring problem, actions, outcomes, and feedback signals can be intricately related. Therefore, we need to solve a non-trivial optimization to run PM-DMED. Later in Section 5, we discuss a practical implementation of the optimization.\nAlgorithm 1 Main routine of PM-DMED and PM-DMED-Hinge\n1: Initialization: select each action once. 2: ZC , ZR ← [N ], ZN ← ∅. 3: while t ≤ T do 4: for i(t) ∈ ZC in an arbitrarily fixed order do 5: Select i(t), and receive feedback. 6: ZR ← ZR \\ {i(t)}. 7: Add actions to ZN in accordance with{\nAlgorithm 2 (PM-DMED) Algorithm 3 (PM-DMED-Hinge) .\n8: t ← t+ 1. 9: end for\n10: ZC , ZR ← ZN , ZN ← ∅. 11: end while\nAlgorithm 2 PM-DMED subroutine for adding actions to ZN (without duplication).\n1: Parameter: c > 0. 2: Compute an arbitrary p̂(t) such that\np̂(t)∈ arg min q\n∑\ni\nNi(t)D(p̂i(t)‖Siq) (1)\nand let î(t) = arg mini L ⊤ i p̂(t).\n3: If î(t) /∈ ZR then put î(t) into ZN . 4: If there are actions i /∈ ZR such that\nNi(t) < c √ log t (2)\nthen put them into ZN . 5: If\n{Ni(t)/ log t}i6=î(t) /∈ Rî(t)({p̂i(t)}) (3) then compute some\n{r∗i }i6=î(t) ∈ R∗î(t)(p̂(t), {p̂i(t)}) (4)\nand put all actions i such that i /∈ ZR and r∗i > Ni(t)/ log t into ZN .\nNecessity of √ logT exploration: PM-DMED tries to observe each action to some extent (Eq. (2)), which is necessary for the following reason: consider a four-state game characterized by\nL =  \n0 1 1 0 10 1 0 0 10 0 1 0 11 11 11 11\n  , H =  \n1 1 1 1 1 2 2 3 1 2 2 3 1 1 2 2\n  , and p∗ = (0.1, 0.2, 0.3, 0.4)⊤.\nThe optimal action here is action 1, which does not yield any useful information. By using action 2, one receives three kinds of symbols from which one can estimate (p∗)1, (p∗)2 + (p∗)3, and (p∗)4, where (p∗)j is the j-th component of p∗. From this, an algorithm can find that (p∗)1 is not very small and thus the expected loss of actions 2 and 3 is larger than that of action 1. Since the feedback of actions 2 and 3 are the same, one may also use action 3 in the same manner. However, the loss per observation is 1.2 and 1.3 for actions 2 and 3, respectively, and thus it is better to use action 2. This difference comes from the fact that (p∗)2 = 0.2 < 0.3 = (p∗)3. Since an algorithm does not know p∗ beforehand, it needs to observe action 4, the only source for distinguishing (p∗)2 from (p∗)3. Yet, an optimal algorithm cannot select it more than Ω(logT ) times because it affects the O(logT ) factor in the regret. In fact, O((logT )a) observations of action 4 with some a > 0 are sufficient to be convinced that (p∗)2 < (p∗)3 with probability 1 − o(1/T poly(a)). For this reason, PM-DMED selects each action √ log t times."
    }, {
      "heading" : "5 Experiment",
      "text" : "Following Bartók et al. [11], we compared the performances of algorithms in three different games: the four-state game (Section 4), a three-state game and dynamic pricing. Experiments on the N - armed bandit game was also done, and the result is shown in Appendix C.1.\nThe three-state game, which is classified as easy in terms of the minimax regret, is characterized by:\nL = ( 1 1 0 0 1 1 1 0 1 ) and H = ( 1 2 2 2 1 2 2 2 1 ) .\nThe signal matrices of this game are,\nS1 = ( 1 0 0 0 1 1 ) , S2 = ( 0 1 0 1 0 1 ) , and S3 = ( 0 0 1 1 1 0 ) .\nDynamic pricing, which is classified as hard in terms of the minimax regret, is a game that models a repeated auction between a seller (learner) and a buyer (opponent). At each round, the seller sets a price for a product, and at the same time, the buyer secretly sets a maximum price he is willing to pay. The signal is “buy” or “no-buy”, and the seller’s loss is either a given constant (no-buy) or the difference between the buyer’s and the seller’s prices (buy). The loss and feedback matrices are:\nL =   0 1 . . . N − 1 c 0 . . . N − 2 ... . . . . . .\n... c . . . c 0\n  and H =   2 2 . . . 2 1 2 . . . 2 ... . . . . . .\n... 1 . . . 1 2\n  ,\nwhere signals 1 and 2 correspond to no-buy and buy. The signal matrix of action i is\nSi = ( i−1︷ ︸︸ ︷ 1 . . . 1 0 . . . 0 M−i+1︷ ︸︸ ︷ 0 . . . 0 1 . . . 1 ) .\nFollowing Bartók et al. [11], we set N = 5,M = 5, and c = 2.\nIn our experiments with the three-state game and dynamic pricing, we tested three settings regarding the harshness of the opponent: at the beginning of a simulation, we sampled 1,000 points uniformly at random from PM , then sorted them by C∗1 (p∗, {p∗i }). We chose the top 10%, 50%, and 90% harshest ones as the opponent’s strategy in the harsh, intermediate, and benign settings, respectively.\nWe compared Random, FeedExp3 [8], CBP [11] with α = 1.01, BPM-LEAST, BPM-TS [13], and PM-DMED with c = 1. Random is a naive algorithm that selects an action uniformly random. FeedExp3 requires a matrix G such that H⊤G = L⊤, and thus one cannot apply it to the four-state game. CBP is an algorithm of logarithmic regret for easy games. The parameters η and f(t) of CBP were set in accordance with Theorem 1 in their paper. BPM-LEAST is a Bayesian algorithm with Õ( √ T ) regret for easy games, and BPM-TS is a heuristic of state-of-the-art performance. The priors of two BPMs were set to be uninformative to avoid a misspecification, as recommended in their paper.\nAlgorithm 3 PM-DMED-Hinge subroutine for adding actions to ZN (without duplication).\n1: Parameters: c > 0, f(n) = bn−1/2 for b > 0, α(t) = a/(log log t) for a > 0. 2: Compute arbitrary p̂(t) which satisfies\np̂(t) ∈ arg min q\n∑\ni\nNi(t)(D(p̂i(t)‖Siq)− f(Ni(t)))+ (5)\nand let î(t) = arg mini L ⊤ i p̂(t).\n3: If î(t) /∈ ZR then put î(t) into ZN . 4: If\np̂(t) /∈ Cî(t),α(t) (6) or there exists an action i such that\nD(p̂i(t)‖Sip̂(t)) > f(Ni(t)) (7) then put all actions i /∈ ZR into ZN .\n5: If there are actions i such that Ni(t) < c √ log t (8)\nthen put the actions not in ZR into ZN . 6: If\n{Ni(t)/ log t}i6=î(t) /∈ Rî(t)({p̂i(t), f(Ni(t))}) (9) then compute some\n{r∗i }i6=î(t) ∈ R∗î(t)(p̂(t), {p̂i(t), f(Ni(t))}) (10)\nand put all actions such that i /∈ ZR and r∗i > Ni(t)/ log t into ZN . If such r∗i is infeasible then put all action i /∈ ZR into ZN .\nThe computation of p̂(t) in (1) and the evaluation of the condition in (3) involve convex optimizations, which were done with Ipopt [18]. Moreover, obtaining {r∗i } in (4) is classified as a linear semi-infinite programming (LSIP) problem, a linear programming (LP) with finitely many variables and infinitely many constraints. Following the optimization of BPM-LEAST [13], we resorted to a finite sample approximation and used the Gurobi LP solver [19] in computing {r∗i }: at each round, we sampled 1,000 points from PM , and relaxed the constraints on the samples. To speed up the computation, we skipped these optimizations in most rounds with large t and used the result of the last computation. The computation of the coefficient C∗1 (p\n∗, {p∗i }) of the regret lower bound (Theorem 2) is also an LSIP, which was approximated by 100,000 sample points from Cc1. The experimental results are shown in Figure 2. In the four-state game and the other two games with an easy or intermediate opponent, PM-DMED outperforms the other algorithms when the number of rounds is large. In particular, in the dynamic pricing game with an intermediate opponent, the regret of PM-DMED at T = 106 is ten times smaller than those of the other algorithms. Even in the harsh setting in which the minimax regret matters, PM-DMED has some advantage over all algorithms except for BPM-TS. With sufficiently large T , the slope of an optimal algorithm should converge to LB. In all games and settings, the slope of PM-DMED converges to LB, which is empirical evidence of the optimality of PM-DMED."
    }, {
      "heading" : "6 Theoretical Analysis",
      "text" : "Section 5 shows that the empirical performance of PM-DMED is very close to the regret lower bound in Theorem 2. Although the authors conjecture that PM-DMED is optimal, it is hard to analyze PM-DMED. The technically hardest part arises from the case in which the divergence of each action is small but not yet fully converged. To circumvent this difficulty, we can introduce a discount factor. Let\nRj({pi, δi})= { {ri}i6=j ∈ [0,∞)N−1 : inf\nq∈cl(Ccj ):D(pj‖Sjq)≤δj\n∑\ni\nri(D(pi‖Siq)−δi)+ ≥ 1 } , (11)\nwhere (X)+ = max(X, 0). Note that Rj({pi, δi}) in (11) is a natural generalization of Rj({pi}) in Section 4 in the sense that Rj({pi, 0}) = Rj({pi}). Event {Ni(t)/ log t}i6=1 ∈ R1({p̂i(t), δi}) means that the number of observations {Ni(t)} is enough to ensure that the “{δi}-discounted” empirical divergence of each q ∈ Cc1 is larger than log t. Analogous to Rj({pi, δi}), we define\nC∗j (p, {pi, δi}) = inf {ri}i6=j∈Rj({pi,δi}))\n∑\ni6=j\nri(Lj − Li)⊤p\nand its optimal solution by\nR∗j (p, {pi, δi}) = { {ri}i6=j ∈ Rj({pi, δi}) : ∑\ni6=j\nri(Lj − Li)⊤p = C∗j (p, {pi, δi}) } .\nWe also define Ci,α = {p ∈ PM : L⊤i p + α ≤ minj 6=i L⊤j p}, the optimal region of action i with margin. PM-DMED-Hinge shares the main routine of Algorithm 1 with PM-DMED and lists the next actions by Algorithm 3. Unlike PM-DMED, it (i) discounts f(Ni(t)) from the empirical divergenceD(p̂i(t)‖Siq). Moreover, (ii) when p̂(t) is close to the cell boundary, it encourages more exploration to identify the cell it belongs to by Eq. (6).\nTheorem 3. Assume the following regularity conditions hold for p∗. (1) R∗1(p, {pi, δi}) is unique at p = p∗, pi = Sip∗, δi = 0. Moreover, (2) for Sδ = {q : D(p∗1‖S1q) ≤ δ}, it holds that cl(int(Cc1) ∩ Sδ) = cl(cl(Cc1) ∩ Sδ) for all δ ≥ 0 in some neighborhood of δ = 0, where cl(·) and int(·) denote the closure and the interior, respectively. Then,\nE[Regret(T )] ≤ C∗1 (p∗, {p∗i }) logT + o(logT ) .\nWe prove this theorem in Appendix D. Recall that R∗1(p, {p̂i(t), δi}) is the set of optimal solutions of an LSIP. In this problem, KKT conditions and the duality theorem apply as in the case of finite constraints; thus, we can check whether Condition 1 holds or not for each p∗ (see, e.g., Ito et al. [20] and references therein). Condition 2 holds in most cases, and an example of an exceptional case is shown in Appendix A.\nTheorem 3 states that PM-DMED-Hinge has a regret upper bound that matches the lower bound of Theorem 2.\nCorollary 4. (Optimality in the N -armed bandit problem) In the N -armed Bernoulli bandit problem, the regularity conditions in Theorem 3 always hold. Moreover, the coefficient of the leading logarithmic term in the regret bound of the partial monitoring problem is equal to the bound given in Lai and Robbins [2]. Namely, C∗1 (p ∗, {p∗i }) = ∑N\ni6=1(∆i/d(µi‖µ1)), where d(p‖q) = p log (p/q) + (1− p) log ((1 − p)/(1− q)) is the KL-divergence between Bernoulli distributions. Corollary 4, which is proven in Appendix C, states that PM-DMED-Hinge attains the optimal regret of the N -armed bandit if we run it on an N -armed bandit game represented as partial monitoring.\nAsymptotic analysis: it is Theorem 6 where we lose the finite-time property. This theorem shows the continuity of the optimal solution set R∗1(p, {pi, δi}) of C∗j (p, {pj}), which does not mention how close R∗1(p, {pi, δi}) is to R∗1(p∗, {p∗i , 0}) if max{‖p−p∗‖M ,maxi ‖pi−p∗i ‖M ,maxi δi} ≤ δ for given δ. To obtain an explicit bound, we need sensitivity analysis, the theory of the robustness of the optimal value and the solution for small deviations of its parameters (see e.g., Fiacco [21]). In particular, the optimal solution of partial monitoring involves an infinite number of constraints, which makes the analysis quite hard. For this reason, we will not perform a finite-time analysis. Note that, the N -armed bandit problem is a special instance in which we can avoid solving the above optimization and a finite-time optimal bound is known.\nNecessity of the discount factor: we are not sure whether discount factor f(n) in PM-DMEDHinge is necessary or not. We also empirically tested PM-DMED-Hinge: although it is better than the other algorithms in many settings, such as dynamic pricing with an intermediate opponent, it is far worse than PM-DMED. We found that our implementation, which uses the Ipopt nonlinear optimization solver, was sometimes inaccurate at optimizing (5): there were some cases in which the true p∗ satisfies ∀i∈[N ]D(p̂i(t)‖Sip∗) − f(Ni(t)) = 0, while the solution p̂(t) we obtained had non-zero hinge values. In this case, the algorithm lists all actions from (7), which degrades performance. Determining whether the discount factor is essential or not is our future work."
    }, {
      "heading" : "Acknowledgements",
      "text" : "The authors gratefully acknowledge the advice of Kentaro Minami and sincerely thank the anonymous reviewers for their useful comments. This work was supported in part by JSPS KAKENHI Grant Number 15J09850 and 26106506."
    }, {
      "heading" : "A Case in which Condition 2 Does Not Hold",
      "text" : "Figure 3 is an example that Theorem 3 does not cover. The dotted line is {q : p∗1 = S1q}, which (accidentally) coincides with a line that makes the convex polytope of Cc1. In this case, Condition 2 does not hold because int(Cc1) ∩ S0 = ∅ whereas cl(Cc1) ∩ S0 6= ∅ (two starred points), which means that a slight modification of p∗ changes the set of cells that intersects with the dotted line discontinuously. We exclude these unusual cases for the ease of analysis.\nThe authors consider that it is quite hard to give the optimal regret bound without such regularity conditions. In fact, many regularity conditions are assumed in Graves and Lai [22], where another generalization of the bandit problem is considered and the regret lower bound is expressed in terms of LSIP. In this paper, the regularity conditions are much simplified by the continuity argument in Theorem 6 but it remains an open problem to fully remove them."
    }, {
      "heading" : "B Proof: Regret Lower Bound",
      "text" : "In this section, we prove Lemma 1 and Theorem 2.\nProof of Lemma 1. The technique here is mostly inspired from Theorem 1 in Lai and Robbins [2]. The use of a √ T term is inspired from Kaufmann et al. [23]. Let p′ ∈ int(Cc1) and i′ 6= 1 be the optimal action under the opponent’s strategy p′. We consider a modified partial monitoring game with its opponent’s strategy is p′.\nNotation: Let X̂mi ∈ [A] is the signal of the m-th observation of action i. Let\nK̂Li(n) =\nn∑\nm=1\nlog\n( (Sip\n∗)X̂mi (Sip′)X̂mi\n) ,\nand K̂L = ∑\ni∈[N ] K̂Li(Ni(T )). Let P ′ and E′ be the probability and the expectation with respect\nto the modified game, respectively. Then, for any event E ,\nP ′[E ] = E [ 1[E ] exp ( −K̂L )] (12)\nholds. Now, let us define the following events:\nD1 =    ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) < (1− ǫ) logT,Ni′(T ) < √ T    ,\nD2 = { K̂L ≤ ( 1− ǫ\n2\n) logT } ,\nD12 = D1 ∩ D2, D1\\2 = D1 ∩ Dc2.\nFirst step (Pr[D12] = o(1)): from (12), P ′[D12] ≥ E [ 1[D12] exp ( − ( 1− ǫ\n2\n) logT )] = T−(1−ǫ/2)Pr[D12].\nBy using this we have\nPr[D12] ≤ T (1−ǫ/2)P′[D12] ≤ T (1−ǫ/2)P′ [ Ni′(T ) < √ T ]\n= T (1−ǫ/2)P′ [ T −Ni′(T ) > T − √ T ]\n≤ T (1−ǫ/2)E ′[T −Ni′(T )] T − √ T\n(by the Markov inequality). (13)\nSince this algorithm is strongly consistent, E′[T −Ni′(T )] → o(T a) for any a > 0. Therefore, the RHS of the last line of (13) is o(T a−ǫ/2), which, by choosing sufficiently small a, converges to zero as T → ∞. In summary, Pr[D12] = o(1). Second step (Pr[D1\\2] = o(1)): we have Pr[D1\\2]\n= Pr\n  ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) < (1 − ǫ) logT,Ni′(T ) < √ T , ∑\ni∈[N ]\nK̂Li(Ni(T )) > ( 1− ǫ\n2\n) logT   .\nNote that\nmax 1≤n≤N K̂Li(n) = max 1≤n≤N\nn∑\nm=1\nlog\n( (Sip\n∗)X̂mi (Sip′)X̂mi\n) ,\nis the maximum of the sum of positive-mean random variables, and thus converges to is average (c.f., Lemma 10.5 in [24]). Namely,\nlim N→∞ max 1≤n≤N\nK̂Li(n)\nN → D(Sip∗‖Sip′)\nalmost surely. Therefore,\nlim T→∞\nmax{Ni(T )}∈NN , ∑ i∈[N ] Ni(T )D(Sip ∗‖Sip′)<(1−ǫ) log T ∑ i∈[N ] K̂Li(Ni(T ))\nlogT → 1− ǫ\nalmost surely. By using this fact and 1− ǫ/2 > 1− ǫ, we have\nPr   max {Ni(T )}∈NN , ∑ i∈[N ] Ni(T )D(Sip ∗‖Sip′)<(1−ǫ) log T ∑\ni∈[N ]\nK̂Li(Ni(T )) > ( 1− ǫ\n2\n) logT   = o(1).\nIn summary, we obtain Pr [ D1\\2 ] = o(1).\nLast step: we here have\nD1 =    ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) < (1− ǫ) logT    ∩ { Ni′(T ) < √ T }\n⊇    ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) + (1 − ǫ) logT√ T Ni′(T ) < (1− ǫ) logT    ,\nwhere we used the fact that {A < C} ∩ {B < C} ⊇ {A+ B < C} for A,B > 0 in the last line. Note that, by using the result of the previous steps, Pr[D1] = Pr[D12]+Pr[D1\\2] = o(1). By using the complementary of this fact,\nPr\n  ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) + (1 − ǫ) logT√ T Ni′(T ) ≥ (1− ǫ) logT\n  ≥ Pr[Dc1] = 1− o(1).\nUsing the Markov inequality yields\nE\n  ∑\ni∈[N ]\nNi(T )D(Sip ∗‖Sip′) + (1 − ǫ) logT√ T Ni′(T )\n  ≥ (1− ǫ)(1 − o(1)) logT. (14)\nBecause E[Ni′ (T )] is subpolynomial as a function of T due to the consistency, the second term in LHS of (14) is o(1) and thus negligible. Lemma 1 follows from the fact that (14) holds for sufficiently small ǫ and arbitrary p′ ∈ int(Cc1).\nProof of Theorem 2. Assume that there exists δ > 0 and a sequence T1 < T2 < T3 < · · · such that for all t E[Regret(Tt)] < (1 − δ)C∗1 (p∗, {p∗i }) logTt , that is,\n∑\ni6=1\nE[Ni(Tt)]\n(1− δ) log Tt (Li − L1)⊤p∗ < C∗1 (p∗, {p∗i }) .\nFrom the definition of C∗1 , there exists q ′ t ∈ {q ∈ cl(Cc1) : p∗1 = Sjq} =: S such that\n∑\ni6=1\nE[Ni(Tt)]\n(1− δ) logTt D(p∗i ‖Siq′t) < 1 .\nSince S is compact, there exists a subsequence t0 < t1 < · · · such that limu→∞ q′tu = q′ for some q′ ∈ S. Therefore from the lower semicontinuity of the divergence we obtain\n1 ≥ ∑\ni6=1\nlim inf u→∞\nE[Ni(Tt)]\n(1− δ) logTt D(pi‖Siq′tu)\n≥ ∑\ni6=1\nlim inf t→∞\nE[Ni(Tt)]\n(1− δ) logTt D(pi‖Siq′)\n= ∑\ni\nlim inf t→∞\nE[Ni(Tt)]\n(1− δ) logTt D(pi‖Siq′) ,\nwhich contradicts Lemma 1.\nC The N-armed Bandit Problem as Partial Monitoring\nIn Section 6, we have introduced PM-DMED-Hinge, an asymptotically optimal algorithm for partial monitoring. In this appendix, we prove that this algorithm also has an optimal regret bound of the N -armed bandit problem when we run it on an N -armed bandit game represented as an instance of partial monitoring.\nIn the N -armed bandit problem, the learner selects one of N actions (arms) and receives a corresponding reward. This problem can be considered as a special case of partial monitoring in which the learner directly observes the loss matrix. For example, three-armed Bernoulli bandit can be represented by the following loss and feedback matrices, and the strategy:\nL = H = ( 2 1 2 1 2 1 2 1 2 2 1 1 2 2 1 1 2 2 2 2 1 1 1 1 ) , and p∗ =   (1− µ1)(1− µ2)(1− µ3) µ1(1− µ2)(1− µ3) (1− µ1)µ2(1− µ3) µ1µ2(1− µ3) (1− µ1)(1 − µ2)µ3\nµ1(1− µ2)µ3 (1− µ1)µ2µ3\nµ1µ2µ3\n  , (15)\nwhere µ1, µ2, and µ3 are the expected rewards of the actions. Signals 1 and 2 correspond to the rewards of 1 and 0 generated by the selected arm, respectively. More generally, N -armed Bernoulli\nbandit is represented as an instance of partial monitoring in which the loss and feedback matrices are the same N × 2N matrix\nli,j = hi,j = 1[(j − 1 mod 2i) < 2i−1] + 1, where mod denotes the modulo operation. This problem is associated with N parameters µ1, µ2, . . . , µN that correspond to the expected rewards of the actions. For the ease of analysis, we assume {µi} are in (0, 1) and different from each other. Without loss of generality, we assume 1 > µ1 > µ2 > · · · > µN > 0, and thus action 1 is the optimal action. The opponent’s strategy is\np∗j = ∏\ni∈[N ]\n(µi + (1− 2µi)1[(j − 1 mod 2i) < 2i−1]) .\nNote that µi = (Sip∗)1.\nProof of Corollary 4. In the following, we prove that the regularity conditions in Theorem 3 are always satisfied in the case of the N -armed bandit. During the proof we also show that C∗1 (p\n∗, {p∗i }) is equal to the optimal constant factor of Lai and Robbins [2].\nBecause signal 1 corresponds to the reward of 1, we can define µ̂i(q) = (Siq)1, and thus\nCi = {q ∈ PM : ∀i′ 6=i µ̂i(q) ≥ µ̂i′ (q)}. First, we show the uniqueness of R∗1(p, {pi, δi}) at p = p∗, {pi} = Sip∗, δi = 0. It is easy to check\nD(p∗i ‖Siq) = d(µ̂i(p∗)‖µ̂i(q)) = d(µi‖µ̂i(q)), where d(a‖b) is the KL divergence between two Bernoulli distributions with parameters a and b. Then\nR1({p∗i }) = { {ri}i6=1 ∈ [0,∞)N−1 : inf\nq∈cl(Cc1):p ∗ i =S1q\n∑\ni\nriD(p ∗ i ‖Siq) ≥ 1\n}\n= { {ri}i6=1 ∈ [0,∞)N−1 : inf\nq∈cl(Cc1):µ1=µ̂1(q)\n∑\ni\nriD(p ∗ i ‖Siq) ≥ 1\n}\n= { {ri}i6=1 : ri ≥\n1\nd(µi‖µ1)\n} , (16)\nwhere the last inequality follows from the fact that\n{q ∈ cl(Cc1) : µ̂1(q) = µ1} = {q ∈ PM : µ̂1(q) = µ1, ∃i6=1µ̂i(q) ≥ µ1}. By Eq. (16), the regret minimizing solution is\nC∗1 (p ∗, {p∗i }) =\n∑\ni6=1\n∆i d(µi‖µ1) ,\nand\nR∗1(p∗, {p∗i }) = { {ri}i6=1 : ri =\n1\nd(µi‖µ1)\n} ,\nwhich is unique.\nSecond, we show that cl(int(Cc1) ∩ Sδ) = cl(cl(Cc1) ∩ Sδ) for sufficiently small δ ≥ 0. Note that, cl(Cc1) ∩ Sδ = {q ∈ PM : ∃i′ 6=1 µ̂1(q) ≤ µ̂i′(q), d(µ1‖µ̂1(q)) ≤ δ}\nand int(Cc1) ∩ Sδ = {q ∈ PM : ∃i′ 6=1 µ̂1(q) < µ̂i′(q), d(µ1‖µ̂1(q)) ≤ δ}.\nTo prove cl(Cc1) ∩ Sδ ⊂ cl(int(Cc1) ∩ Sδ), (17)\nit suffices to show that, an open ball centered at any position in\n{q ∈ PM : ∃i′ 6=1 µ̂1(q) = µ̂i′(q), d(µ1‖µ̂1(q)) ≤ δ} ⊃ (cl(Cc1) ∩ Sδ) \\ (int(Cc1) ∩ Sδ)\ncontains a point in int(Cc1) ∩ Sδ. This holds because we can make a slight move towards the direction of increasing µ̂i′ : we can always find q′ in an open ball centered at q such that µ̂i′(q\n′) > µ̂i′ (q) and µ̂1(q′) = µ̂1(q) because of (i) the fact that there always exists q ∈ PM such that {q ∈ PM , ∀i∈[N ]µ̂i(q) = µi} for arbitrary {µi} ∈ (0, 1)N and (ii) the continuity of the µ̂i operator. Therefore, any open ball centered at q ∈ cl(Cc1) ∩ Sδ contains an element of int(Cc1) ∩ Sδ, by which we obtain (17). By using (17), we have\ncl(cl(Cc1) ∩ Sδ) ⊂ cl(cl(int(Cc1) ∩ Sδ)) = cl(int(Cc1) ∩ Sδ), (18) where we used the fact that cl(cl(X)) = cl(X). Combining (18) with the fact that cl(cl(Cc1)∩Sδ) ⊃ cl(int(Cc1) ∩ Sδ) yields cl(cl(Cc1) ∩ Sδ) = cl(int(Cc1) ∩ Sδ). Therefore, in the N -armed Bernoulli bandit problem, the regularity conditions are always satisfied and C∗1 (p\n∗, {p∗i }) matches the optimal coefficient of the logarithmic regret bound. From Theorem 3, if we run PM-DMED-Hinge in this game, its expected regret is asymptotically optimal in view of the N -armed bandit problem.\nC.1 Experiment\nWe also assessed the performance of PM-DMED and other algorithms in solving the three-armed Bernoulli bandit game defined by (15) with parameters µ1 = 0.4, µ2 = 0.3, and µ3 = 0.2. The settings of the algorithms are the same as that of the main paper. The results of simulations are shown in Figure 4. LB-Theory is the regret lower bound of Lai and Robbins [2], that is, ∑ i6=1 ∆i log t d(µi‖µ1)\n. The slope of PM-DMED quickly approaches that of LB-Theory, which is empirical evidence that PM-DMED has optimal performance in N -armed bandits."
    }, {
      "heading" : "D Optimality of PM-DMED-Hinge",
      "text" : "In this appendix we prove Theorem 3. First we define distances among distributions. For distributions pi, p′i ∈ PA of symbols we use the total variation distance\n‖pi − p′i‖ = 1\n2\nA∑\na=1\n|(pi)a − (p′i)a| .\nFor distributions p, p′ ∈ PM of outcomes, we identify p with the set {p′ : ∀i, Sip = Sip′} and define\n‖p− p′‖M = max i ‖Sip− Sip′‖.\nFor Q ⊂ PM we define ‖p−Q‖M = inf\np′∈Q ‖p− p′‖M .\nIn the following, we use Pinsker’s inequality given below many times.\nD(pi‖qi) ≥ 2‖pi − qi‖2 .\nLet\nρi,L = sup λ>0\n1 λ min x∈Ci,λ ‖x− Cci ‖M ,\nνi,L = sup λ>0\n1 λ max x∈Cci,λ ‖x− Cci ‖M .\nNote that these two constants are positive from the global observability.\nD.1 Properties of regret lower bound\nIn this section, we give Lemma 5 and Theorem 6 that are about the functions C∗j (p, {pi, δi}) and R∗j (p, {pi, δi}). In the following, we always consider these functions on p ∈ PM , pi ∈ {Sip : supp(p) ⊂ supp(p∗)} and δi ≥ 0, where supp(·) denotes the support of the distribution. We define\nLmax = max i′,j′ li′,j′ .\nLemma 5. Let p ∈ Cj,α and {pi, δi} be satisfying ‖pi − Sip‖ ≤ αρj,L/2 and δi ≤ (αρj,L)2/4 for all i. Then\nC∗j (p, {pi, δi}) ≤ 4NLmax (αρj,L)2 . (19)\nFurtheremore, Rj({pi, δi}) is nonempty and\nR∗j (p, {pi, δi}) ⊂ [ 0,\n4NLmax (ρj,L)2α3\n]N−1 .\nProof of Lemma 5. Since ‖p− Cc1‖M ≥ αρj,L, there exists i = i(q) for any q ∈ Cc1 such that ‖Siq − Sip‖ ≥ αρj,L .\nFor this i we have\nD(pi‖Siq)− δi ≥ 2‖pi − Siq‖2 − δi ≥ 2(‖Siq − Sip‖ − ‖pi − Sip‖)2+ − δi ≥ (αρj,L)2/2− δi ≥ (αρj,L)2/4 .\nThus, by letting ri = 4/(αρj,Lα)2 for all i 6= j we have {ri}i6=j ∈ Rj({pi, δi}) ,\nwhich implies (19). On the other hand it holds for any {r∗i }i6=j ∈ R∗j (p, {pi, δi}) from p ∈ Cj,α that\nC∗j (p, {pi, δi}) = ∑\ni6=j\nr∗i L ⊤ i p ≥ max i6=j r∗i α\nand therefore we have\nmax i6=j r∗i ≤ 4NLmax (ρj,L)2α3 .\nTheorem 6. Assume that the regularity conditions in Theorem 3 hold. Then the point-to-set map R∗1(p, {pi, δi}) is (i) nonempty near p = p∗, pi = Sip∗, δi = 0 and (ii) continuous at p = p∗, pi = Sip ∗, δi = 0.\nSee Hogan [25] for definitions of terms such as continuity of point-to-set maps.\nProof of Theorem 6. Define\nR̄1({pi, δi}) =   {ri}i6=1 ∈ [0, ξ] N−1 : inf q∈cl(Cc1):D(p1‖S1q)≤δ1 ∑\ni6=1\nri(D(pi‖Siq)− δi)+ ≥ 1   \nfor\nξ = 4NLmax\n(ρ1,L)2(maxi6=1 L⊤i p ∗ − L⊤1 p∗)3\n.\nNote that p∗ ∈ C1,α for α ≤ maxi6=1 L⊤i p∗ − L⊤1 p∗. From Lemma 5, near p = p∗, pi = Sip∗, δi = 0,\nR̄1({pi, δi}) ⊃ R∗1(p, {pi, δi}) and\nC∗1 (p, {pi, δi}) = inf {ri}i6=1∈R̄1({pi,δi})\n∑\ni6=1\nri(Li − L1)⊤p\nhold. Since the function ∑\ni\nri(D(pi‖Siq)− δi)+\nis continuous in {ri}, R̄1({pi, δi}) is a closed set and therefore R∗1(p, {pi, δi}) is nonempty near p = p∗, pi = Sip ∗, δi = 0.\nFrom the continuity of D(pi‖Siq) at any q such that D(pi‖Siq) < ∞, we have\ninf q∈cl(Cc1)∩Sδ1\n∑\ni6=1\nri(D(pi‖Siq)− δi)+ = inf q∈cl(cl(Cc1)∩Sδ1 )\n∑\ni6=1\nri(D(pi‖Siq)− δi)+\n= inf q∈cl(int(Cc1)∩Sδ1)\n∑\ni6=1\nri(D(pi‖Siq)− δi)+\n= inf q∈int(Cc1)∩Sδ1\n∑\ni6=1\nri(D(pi‖Siq)− δi)+ .\nThus, we have\nR̄1({pi, δi}) = { {ri}i6=1 ∈ [0, ξ]N−1 : inf\nq∈int(Cc1):D(p1‖S1q)≤δ1\n∑\ni\nri(D(pi‖Siq)− δi)+ ≥ 1 } .\n(20)\nSince the objective function ∑\ni6=j ri(Li − Lj)⊤p is continuous in {ri} and p, and (20) is compact, now it suffices to show that (20) is continuous in {pi, δi} at {Sip∗, 0} to prove the theorem from [25, Corollary 8.1].\nFirst we show that R̄1({pi, δi}) is closed at {Sip∗, 0}. Consider {r(m)i }i6=1 ∈ R̄1({p (m) i , δ (m) i }) for a sequence {p(m)i , δ (m) i }i which converges to {Sip∗, 0}i as m → ∞. We show that {ri}i6=1 ∈ R̄1({Sip∗, 0}) if r(m)i → ri as m → ∞.\nTake an arbitrary q ∈ int(Cc1) such that D(S1p∗‖S1q) = 0. Since ‖S1p∗ − p(m)1 ‖ → 0 and p1 ∈ {S1p : supp(p) ⊂ supp(p∗)}, there exists p̃(m) such that p(m)1 = S1p̃(m) and ‖p∗ − p̃(m)‖M → 0.\nThus, from q ∈ int(Cc1), it holds for sufficiently large m that q(m) = q − p∗ + p̃(m) ∈ int(Cc1). For this q(m) we have\nD(p (m) 1 ‖S1q(m)) ≤ D(S1p̃(m)‖S1(q − p∗ + p̃(m))) = 0 ≤ δ1 .\nthat is, q(m) ∈ int(Cc1) ∩ Sδ1 . Therefore for sufficiently large m we have ∑\ni\nr (m) i (D(pi‖Siq(m))− δ (m) i )+ ≥ 0 .\nand, letting m → ∞, ∑\ni\nriD(pi‖Siq) ≥ 0 .\nThis means that {ri}i6=1 ∈ R̄1({pi, δi}), that is, R̄1({pi, δi}) is closed at {Sip∗, 0}. Next we show that R̄1({pi, δi}) is open at {Sip∗, 0}. Consider {ri}i6=1 ∈ R̄1({Sip∗, 0}) and a sequence {p(m)i , δ (m) i }i which converges to {Sip∗, 0}i as m → ∞. We show that there exists a sequence {r(m)i }i6=1 ∈ R̄1({p (m) i , δ (m) i }) such that r (m) i → ri.\nConsider the optimal value function\nv({p(m)i , δ (m) i }) = inf\nq∈cl(Cc1)∩Sδ1\n∑\ni\nri(D(p (m) i ‖Siq)− δ (m) i )+ . (21)\nSince the feasible region of (21) is closed at pi = Sip∗, δi = 0 and the objective function of (21) is lower semicontinuous in q, {pi, δi} we see that v({p(m)i , δ (m) i }) is lower semicontinuous from [25, Theorem 2]. Therefore, for any ǫ > 0 there exists m0 > 0 such that for all m ≥ m0\nv({p(m)i , δ (m) i }) ≥ (1 − ǫ)v({Sip∗, 0}) ≥ 1\nsince v({Sip∗, 0}) ≥ 1 from ri ∈ R̄1({Sip∗, 0}). Thus, by letting r(m)i := ri/(1− ǫ) we have\ninf v∈cl(Cc1)∩Sδ1\n∑\ni\nr (m) i (D(p (m) i ‖Siq(m))− δ (m) i )+ ≥ 1 ,\nthat is, {r(m)i }i6=1 ∈ R̄1({p (m) i , δ (m) i }).\nD.2 Regret analysis of PM-DMED-Hinge\nLet p̂i,n ∈ [0, 1]A be the empirical distribution of the symbols from the action i when the action i is selected n times. Then we have p̂i(t) = p̂i,Ni(t). Let Pi,ni(u) = Pr[D(p̂i,ni‖Sip∗) ≥ u]. Then, from the large deviation bound on discrete distributions (Theorem 11.2.1 in Cover and Thomas [26]), we have\nPi,ni(u) ≤ (ni + 1)Ae−niu . (22)\nWe also define\nH({pi, ni}) = {i ⊂ [N ] : D(pi‖Sip∗)− f(ni) > 0}.\nFor\n0 < δ ≤ ‖p∗ − Cc1‖2M/8 (23)\ndefine events\nA(t) = {p̂(t) ∈ C1} A′(t) = {p̂(t) ∈ C1,α(t)} B(t) = ⋂\ni\n{‖p̂i(t)− Sip∗‖ ≤ √ δ}\nC(t) = {î(t) /∈ H({p̂i(t), Ni(t)}), H({p̂i(t), Ni(t)}) 6= ∅}\n= { D(p̂î(t)(t)‖Sî(t)p∗) ≤ f(Nî(t)(t)), ⋃\ni\n{D(p̂i(t)‖Sip∗) > f(Ni(t))} }\nD(t) = ⋂\ni\n{D(p̂i(t)‖Sip̂(t)) ≤ f(Ni(t))}\nE(t) = { max\ni f(Ni(t)) ≤ min\n{ 2δ, (ρ1,Lα(t)) 2/4 } , (24)\nmin i\nNi(t) ≥ max{c √ log t, (log logT )1/3}, 2ν1,Lα(t) ≤ ‖p∗ − Cc1‖M } ,\nwhere we write {T , U} instead of {T ∩ U} for events T and U .\nProof of theorem 3. Since A′(t) ⊂ A(t), the whole sample space is covered by {A′(t),B(t)} ∪ {A′(t),Bc(t)} ∪ {A(t), (A′(t))c} ∪ {Ac(t), C(t)} ∪ {Ac(t), Cc(t)} ⊂ {A′(t),B(t),D(t), E(t)} ∪ {A′(t),Bc(t),D(t), E(t)} ∪ {A(t), (A′(t))c,D(t), E(t)} ∪ {Ac(t), C(t)}\n∪ {Ac(t), Cc(t),D(t), E(t)} ∪ Dc(t) ∪ Ec(t) . (25)\nLet Ji(t) denote the event that action i is newly added into the list LN at the t-th round and J ′i(t) ⊂ Ji(t) denote the event that Ji(t) occurred by Step 6 of Algorithm 3. Note that if {A′(t), D(t), E(t)} occurred then Ji(t) is equivalent to J ′i(t). Combining this fact with (25) we can bound the regret as\nRegret(T ) ≤ ∑\ni6=1\n∆i\nT∑\nt=1\n1 [Ji(t)] +N\n≤ ∑\ni6=1\n∆i\nT∑\nt=1\n( 1 [J ′i(t),A′(t), B(t), D(t), E(t)] + 1 [J ′i(t),A(t), Bc(t), D(t), E(t)]\n+ 1 [Ji(t),A(t), (A′(t))c,D(t), E(t)] + 1 [Ji(t),Ac(t), Cc(t),D(t), E(t)] + 1 [Ji(t),Dc(t) ∪ Ec(t)] ) +  ∑\ni6=1\n∆i\n  T∑\nt=1\n1 [Ac(t), C(t)] +N .\nThe following Lemmas 7–13 bound the expectation of each term and complete the proof.\nLemma 7. Let {r∗i }i6=1 be the unique member of R∗j (p∗, {Sip∗, 0}). Then there exists ǫδ > 0 such that limδ→0 ǫδ = 0 and for all i 6= 1\nT∑\nt=1\n1 [J ′i(t), A′(t), B(t), D(t), E(t)] ≤ (1 + ǫδ)r∗i logT + 1 .\nLemma 8.\nE\n[ T∑\nt=1\n1 [J ′i(t), A′(t), Bc(t), D(t), E(t)] ] = o(logT ) .\nLemma 9.\nE\n[ T∑\nt=1\n1 [Ac(t), C(t)] ] = O(1) .\nLemma 10.\nE\n[ T∑\nt=1\n1 [Ji(t), A(t), (A′(t))c, D(t), E(t)] ] = O(1) .\nLemma 11.\nE\n[ T∑\nt=1\n1 [Ji(t), Ac(t), Cc(t), D(t), E(t)] ] = O(1) .\nLemma 12.\nE\n[ T∑\nt=1\n1 [Ji(t), Dc(t)] ] = O(1) .\nLemma 13.\nT∑\nt=1\n1 [Ji(t), Ec(t)] = o(logT ) .\nProof of Lemma 7. From D(t) we have ∑\ni\nNi(t)(D(p̂i(t)‖Sip̂(t))− f(Ni(t)))+ = 0 . (26)\nHere assume that ‖p̂(t)− p∗‖M > 2 √ δ. Then\nmax i D(p̂i(t)‖Sip̂(t)) ≥ 2max i ‖p̂i(t)− Sip̂(t)‖2 (by Pinsker’s inequality)\n≥ 2max i (‖Sip∗ − Sip̂(t)‖ − ‖Sip∗ − p̂i(t)‖)2+ ≥ 2max\ni (‖Sip∗ − Sip̂(t)‖ −\n√ δ)2+ (by definition of B(t))\n> 2δ\n≥ f(Ni(t)) , (by definition of E(t))\nwhich contradicts (26) and we obtain ‖p̂(t) − p∗‖M ≤ 2 √ δ. Furthermore, from B(t) and E(t) we have ⋂\ni\n{‖p̂i(t)− Sip∗‖ ≤ √ δ} and ⋂\ni\n{f(Ni(t)) ≤ 2δ} ,\nrespectively. Since R∗1(p, {pi, δi}) is continuous at p = p∗, pi = Sip∗, δi = 0 from Theorem 6, ri ≤ (1 + ǫδ)r∗i for all {ri}i6=1 ∈ R∗î(t)(p̂(t), {p̂i(t), f(Ni(t))}) where r ∗ i is the unique member of R∗1(p∗, {Sip∗, 0}) and we used the fact that A′(t) implies î(t) = 1. We complete the proof by\nT∑\nt=1\n1 [J ′i(t), A′(t), B(t), D(t), E(t)]\n= T∑\nn=1\n1\n[ T⋃\nt=1\n{J ′i(t), A′(t), B(t), D(t), E(t), Ni(t) = n} ]\n≤ T∑\nn=1\n1\n[ T⋃\nt=1\n{n/ log t ≤ (1 + ǫδ)r∗i } ]\n≤ (1 + ǫδ)r∗i logT + 1 .\nProof of Lemma 8. First, we obtain from D(t) and E(t) that f(Ni(t)) ≤ (ρ1,Lα(t))2/4 and\n‖p̂i(t)− Sip̂(t)‖ ≤ √ D(p̂i(t)‖Sip̂(t))/2\n≤ √ f(Ni(t))/2 ≤ ρ1,Lα(t)/ √ 8 .\nTherefore, from Lemma 5, it holds for any {r∗i }i6=1 ∈ R∗j (p̂(t), {p̂i(t), f(Ni(t))}) that\nr∗i ≤ 4NLmax\n(ρ1,L)2(α(t))3\n≤ 4NLmax (ρ1,L)2(α(T ))3 .\nNow we have\nE\n[ ∞∑\nt=1\n1 [J ′i(t), A′(t), Bc(t), D(t), E(t)] ]\n≤ E [ ∞∑\nt=1\n1\n[ Ni(t)\nlogT < 4NLmax (ρ1,L)2(α(T ))3\n, Bc(t), E(t) ]]\n≤ ( 4NLmax logT\n(ρ1,L)2(α(T ))3 + 1\n) Pr [ T⋃\nt=1\n{Bc(t), E(t)} ] . (27)\nHere, note that\nBc(t) ⊂ ⋃\ni\n{‖p̂i(t)− Sip∗‖ ≥ √ δ}\n⊂ ⋃\ni\n{D(p̂i(t)‖Sip∗) ≥ 2δ} .\nSince Ni(t) ≥ (log logT )1/3 holds under event E(t), we can bound the probability in (27) as\nPr\n[ T⋃\nt=1\n{Bc(t), E(t)} ]\n≤ ∑\ni\n∞∑\nni=(log log T )1/3\nPr[D(p̂i,ni‖Sip∗) ≥ 2δ]\n≤ N ∞∑\nn=(log log T )1/3\n(n+ 1)Ae−2nδ (by (22))\n= e−Θ((log log T ) 1/3)\nand combining this with (27) we have\nE\n[ ∞∑\nt=1\n1 [J ′i(t), A′(t), Bc(t), D(t), E(t)] ]\n≤ O ( (logT )(log logT )3 ) e−Θ((log log T ) 1/3)\n= o(logT ) .\nProof of Lemma 9. Let G ∈ 2[N ] \\ ∅ and {ni}i∈G ∈ N|G| be arbitrary. Consider the case that ∑\ni∈G\nni(D(p̂i,ni‖Sip∗)− f(ni))+ < x . (28)\nfor some x > 0. Then under events t ≥ ex, ⋂i∈G{Ni(t) = ni}, Ac(t), C(t) and H({p̂i(t), f(ni)}) = G we have\nmin p∈Cc\nî(t) :D(p̂î(t)(t)‖Sî(t)p)≤f(Nî(t)(t))\n∑\ni\nNi(t)(D(p̂i(t)‖Sip)− f(Ni(t)))+\n≤ ∑\ni\nni(D(p̂i(t)‖Sip∗)− f(ni))+ < x ≤ log t ,\nwhich implies that the condition (9) is satisfied. On the other hand from (10), {r∗i } satisfies ∑\ni∈G\n(r∗i log t)(D(p̂i(t)‖Sip)− f(ni))+ ≥ log t . (29)\nEqs. (28) and (29) imply that there exists at least one i ∈ G such that r∗i log t > Ni(t) = ni. This action is selected within N rounds and therefore Ni(t′) = ni never holds for all t′ ≥ t+N . Thus, under the condition (28) it holds that\n∑\nt\n1 [ Ac(t), C(t), H({p̂i(t), Ni(t)}) = G, ⋂\ni∈G\n{Ni(t) = ni} ] ≤ ex +N .\nBy using this inequality we have\n∞∑\nt=1\n1 [Ac(t), C(t)]\n≤ ∑\nG∈2[N ]\\∅\n∑\n{ni}i∈G∈N|G|\n∞∑\nt=1\n1 [ Ac(t), C(t), H({p̂i(t), Ni(t)}) = G, ⋂\ni∈G\n{Ni(t) = ni} ]\n≤ ∑\nG∈2[N ]\\∅\n∑\n{ni}i∈G∈N|G|\n1\n[⋂\ni∈G\n{D(p̂i,ni‖Sip∗) ≥ f(ni)} ]( exp (∑\ni∈G\nni(D(p̂i,ni‖Sip∗)− f(ni)) ) +N ) .\n(30)\nLet Di = sup\nn {ess supD(p̂i,n‖Sip∗)} = − log min j:(Sip∗)j>0 (Sip ∗)j ,\nwhere (Sip∗)j is the j-th component of Sip∗. Then,\nE\n  ∑\n{ni}i∈G∈N|G|\n1\n[⋂\ni∈G\n{D(p̂i,ni‖Sip∗) ≥ f(ni)} ]( exp (∑\ni∈G\nni(D(p̂i,ni‖Sip∗)− f(ni)) ) +N ) \n≤ ∑\n{ni}i∈G∈N|G|\n(∏\ni∈G\n∫ Di f(ni) eni(ui−f(ni))d(−Pi,ni(ui)) +N ∏\ni∈G\n(ni + 1) Ae−nif(ni) ) .\nThe first integral is bounded as ∫ Di f(ni) eni(ui−f(ni))d(−Pi(ui))\n= [ −eni(ui−f(ni))Pi(ui) ]Di f(ni) +\n∫ Di\nf(ni)\nnie ni(ui−f(ni))Pi(ui)dui (integration by parts)\n≤ (ni + 1)Ae−nif(ni) + ∫ Di f(ni) ni(ni + 1) Ae−nif(ni)dui\n≤ (1 + niDi)(ni + 1)Ae−nif(ni) . (31)\nPutting (30)–(31) together we have\nE\n[ ∞∑\nt=1\n1 [Ac(t), C(t)] ]\n≤ ∑\nG∈2[N ]\\∅\n∑\n{ni}i∈G∈N|G|\n(∏\ni∈G\n(1 + niDi)(ni + 1) Ae−nif(ni) +N\n∏\ni∈G\n(ni + 1) |A|e−nif(ni)\n)\n≤ (N + 1) ∑\nG∈2[N ]\\∅\n∏\ni∈G\n∑\nni∈N\n(1 + niDi)(ni + 1) Ae−nif(ni)\n= O(1) . (\nby nif(ni) = Θ(n 1/2 i )\n)\nProof of Lemma 10. Because A(t), (A′(t))c and E(t) imply ‖p∗ − p̂(t)‖M ≥ sup\np∈Cc1\n{‖p∗ − p‖M − ‖p̂(t)− p‖M}\n≥ sup p∈Cc1 {‖p∗ − Cc1‖M − ‖p̂(t)− p‖M} ≥ ‖p∗ − Cc1‖M − ν1,Lα(t) ≥ ‖p∗ − Cc1‖M/2 ,\n(A′(t))c, D(t) and E(t) imply max\ni D(p̂i(t)‖Sip∗) ≥ 2max i ‖p̂i(t)− Sip∗‖2\n≥ 2max i (‖Sip∗ − Sip̂(t)‖ − ‖p̂i(t)− Sip̂(t)‖)2+\n≥ 2max i\n( ‖Sip∗ − Sip̂(t)‖ − √ f(Ni(t))/4 )2 +\n≥ 2(‖p∗ − Cc1‖M/2− √ δ/2)2+\n≥ ‖p∗ − Cc1‖2M/8 . (by (23)) On the other hand, event {Ji(t), Ac(t), A′(t), minj Nj(t) = n} occurs for at most twice since all actions are put into the list if {Ac(t), A′(t)} occurred. Thus, we have\nE\n[∑\nn\n1 [Ji(t), A(t), (A′(t))c, D(t), E(t)] ]\n≤ 2E [∑\nn\n1\n[⋃\nt\n{A(t), (A′(t))c, D(t), E(t), min j\nNj(t) = n} ]]\n≤ 2 ∑\nn\nPr  max\nj D(p̂j(t)‖Sjp∗) ≥ ‖p∗ − Cc1‖2M/8,\n⋂\nj\n{Nj(t) ≥ n}\n \n≤ 2N ∑\nn\n(n+ 1)Ae−n‖p ∗−Cc1‖ 2 M/8 (by (22))\n= O(1) .\nProof of Lemma 11. Recall that\nCc(t) =   {D(p̂î(t)(t)‖Sî(t)p ∗) > f(Nî(t)(t))} ∪ ⋂\nj\n{D(p̂j(t)‖Sjp∗) ≤ f(Nj(t))}    .\nHere   A c(t), D(t), E(t), ⋂\nj\n{D(p̂j(t)‖Sjp∗) ≤ f(Nj(t))}    (32)\ncannot occur since (32) implies that\n‖p̂(t)− p∗‖M = max j ‖Sj p̂(t)− Sjp∗‖\n≤ max j (‖Sj p̂(t)− p̂j(t)‖+ ‖p̂j(t)− Sjp∗‖)\n≤ max j\n(√ D(p̂j(t)‖Sj p̂(t))/2 + √ D(p̂j(t)‖Sjp∗)/2 )\n≤ √ 2max\nj f(Nj(t)) (by D(t))\n≤ 2 √ δ (by (24)) ≤ ‖p∗ − Cc1‖M/ √ 2 (by (23)) ,\nwhich contradicts p̂(t) ∈ Cc1. On the other hand, 1 [ Ji(n), î(t) = j, D(p̂j(t)‖Sjp∗) > f(Nj(t)), Nj(t) = nj ] occurs for at most\ntwice since î(t) is put into the list under this event. Thus, we have\nE\n[ ∞∑\nt=1\n1 [Ji(t), Ac(t), Cc(t), D(t), E(t)] ] ≤ 2 ∑\nj\n∞∑\nn=1\nPr[D(p̂j, n‖Sjp∗) > f(n)]\n≤ 2 ∑\nj\n∞∑\nn=1\n(n+ 1)Ae−nf(n) (by (22))\n= O(1) .\nProof of Lemma 12. Dc(t) implies\n0 < min p\n∑\nj\nNj(t)(D(p̂j(t)‖Sjp)− f(Nj(t)))+\n≤ ∑\nj\nNj(t)(D(p̂j(t)‖Sjp∗)− f(Nj(t)))+\nand therefore ⋃\nj\n{D(p̂j(t)‖Sjp∗) ≥ f(Nj(t))} .\nNote that {Ji(t), Dc(t), Nj(t) = n} occurs for at most twice because all actions are put into the list if Dc(t) occurred. Thus, we have\nE\n[∑\nn\n1 [Ji(t), Dc(t)] ]\n≤ 2E\n ∑\nj\n∑\nn\n1 [D(p̂j,n‖Sjp∗) ≥ f(n)]\n \n≤ 2 ∑\nj\n∑\nn\n(n+ 1)Ae−nf(n) (by (22))\n= O(1) .\nProof of Lemma 13. First, we have\nEc(t) = { max\ni f(Ni(t)) > min\n{ 2δ, (ρ1,Lα(t)) 2/4 }\n∪ min i\nNi(t) < max{c √ log t, (log logT )1/3} ∪ 2ν1,Lα(t) > ‖p∗ − Cc1‖M\n}\n⊂ { f(min\ni Ni(t)) > min\n{ 2δ, (ρ1,Lα(t)) 2/4 }\n∪ min i\nNi(t) < c √ log t ∪ c √ log t < (log logT )1/3 ∪ 2ν1,Lα(t) > ‖p∗ − Cc1‖M\n}\n⊂ {\nb√ c √ log t\n> min { 2δ, (ρ1,Lα(t)) 2/4 } ∪ min\ni Ni(t) < c\n√ log t\n∪ t < e (log log T ) 2/3 c ∪ 2a/ log log t > ‖p∗ − Cc1‖M/ρ1,L }\n= { t < e b4 16δ4c2 ∪ (log t) 1/4\nlog log t <\nb\na √ cρ1,L ∪ min i\nNi(t) < c √ log t\n∪ t < e (log log T ) 2/3 c ∪ t < ee2aρ1,L/‖p ∗−Cc1‖M } .\nFrom limt→∞(log t)1/4/ log log t = ∞ and e (log log T )2/3 c = o(elog log T ) = o(logT ) we have\nT∑\nt=1\n1 [Ji(t), Ec(t)]\n= ∑\nj\nT∑\nt=1\n1 [ Ji(t), Nj(t) < c √ log t ] + o(logT ) .\nBy (8), event {Ji(t), Nj(t) < c √ log t, Nj(t) = n} occurs for at most twice and therefore\nT∑\nt=1\n1 [Ji(t), Ec(t)]\n≤ 2 ∑\nj\nT∑\nn=1\n1\n[ T⋃\nt=1\n{n < c √ log t} ] + o(logT )\n= o(logT ) ."
    } ],
    "references" : [ {
      "title" : "The weighted majority algorithm",
      "author" : [ "Nick Littlestone", "Manfred K. Warmuth" ],
      "venue" : "Inf. Comput.,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 1994
    }, {
      "title" : "Asymptotically efficient adaptive allocation rules",
      "author" : [ "T.L. Lai", "Herbert Robbins" ],
      "venue" : "Advances in Applied Mathematics,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 1985
    }, {
      "title" : "The value of knowing a demand curve: Bounds on regret for online posted-price auctions",
      "author" : [ "Robert D. Kleinberg", "Frank Thomson Leighton" ],
      "venue" : "In FOCS,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2003
    }, {
      "title" : "Optimal allocation strategies for the dark pool problem",
      "author" : [ "Alekh Agarwal", "Peter L. Bartlett", "Max Dama" ],
      "venue" : "In AISTATS,",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2010
    }, {
      "title" : "Minimizing regret with label efficient prediction",
      "author" : [ "Nicolò Cesa-Bianchi", "Gábor Lugosi", "Gilles Stoltz" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2005
    }, {
      "title" : "Online convex programming and generalized infinitesimal gradient ascent",
      "author" : [ "Martin Zinkevich" ],
      "venue" : "In ICML, pages 928–936,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2003
    }, {
      "title" : "Stochastic linear optimization under bandit feedback",
      "author" : [ "Varsha Dani", "Thomas P. Hayes", "Sham M. Kakade" ],
      "venue" : "In COLT,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2008
    }, {
      "title" : "Discrete prediction games with arbitrary feedback and loss",
      "author" : [ "Antonio Piccolboni", "Christian Schindelhauer" ],
      "venue" : "In COLT,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2001
    }, {
      "title" : "Regret minimization under partial monitoring",
      "author" : [ "Nicolò Cesa-Bianchi", "Gábor Lugosi", "Gilles Stoltz" ],
      "venue" : "Math. Oper. Res.,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2006
    }, {
      "title" : "Minimax regret of finite partial-monitoring games in stochastic environments",
      "author" : [ "Gábor Bartók", "Dávid Pál", "Csaba Szepesvári" ],
      "venue" : "In COLT,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2011
    }, {
      "title" : "An adaptive algorithm for finite stochastic partial monitoring",
      "author" : [ "Gábor Bartók", "Navid Zolghadr", "Csaba Szepesvári" ],
      "venue" : "In ICML,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2012
    }, {
      "title" : "A near-optimal algorithm for finite partial-monitoring games against adversarial opponents",
      "author" : [ "Gábor Bartók" ],
      "venue" : "In COLT,",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2013
    }, {
      "title" : "Efficient partial monitoring with prior information",
      "author" : [ "Hastagiri P. Vanchinathan", "Gábor Bartók", "Andreas Krause" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2014
    }, {
      "title" : "Finite-time Analysis of the Multiarmed Bandit Problem",
      "author" : [ "Peter Auer", "Nicoló Cesa-bianchi", "Paul Fischer" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2002
    }, {
      "title" : "The KL-UCB algorithm for bounded stochastic bandits and beyond",
      "author" : [ "Aurélien Garivier", "Olivier Cappé" ],
      "venue" : "In COLT,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2011
    }, {
      "title" : "Large deviations techniques and applications",
      "author" : [ "Amir Dembo", "Ofer Zeitouni" ],
      "venue" : "Applications of mathematics",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 1998
    }, {
      "title" : "An Asymptotically Optimal Bandit Algorithm for Bounded Support Models",
      "author" : [ "Junya Honda", "Akimichi Takemura" ],
      "venue" : "In COLT,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2010
    }, {
      "title" : "A dual parametrization method for convex semi-infinite programming",
      "author" : [ "S. Ito", "Y. Liu", "K.L. Teo" ],
      "venue" : "Annals of Operations Research,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 2000
    }, {
      "title" : "Introduction to sensitivity and stability analysis in nonlinear programming",
      "author" : [ "Anthony V. Fiacco" ],
      "venue" : null,
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 1983
    }, {
      "title" : "Asymptotically efficient adaptive choice of control laws in controlled Markov chains",
      "author" : [ "T.L. Graves", "T.L. Lai" ],
      "venue" : "SIAM J. Contr. and Opt.,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 1997
    }, {
      "title" : "On the complexity of A/B testing",
      "author" : [ "Emilie Kaufmann", "Olivier Cappé", "Aurélien Garivier" ],
      "venue" : "In COLT,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2014
    }, {
      "title" : "Bandits Games and Clustering Foundations",
      "author" : [ "Sébastien Bubeck" ],
      "venue" : "Theses, Université des Sciences et Technologie de Lille - Lille I,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2010
    }, {
      "title" : "Point-to-set maps in mathematical programming",
      "author" : [ "William W. Hogan" ],
      "venue" : "SIAM Review,",
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 1973
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 66,
      "endOffset" : 69
    }, {
      "referenceID" : 1,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 102,
      "endOffset" : 105
    }, {
      "referenceID" : 2,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 123,
      "endOffset" : 126
    }, {
      "referenceID" : 3,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 150,
      "endOffset" : 153
    }, {
      "referenceID" : 4,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 182,
      "endOffset" : 185
    }, {
      "referenceID" : 5,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 251,
      "endOffset" : 257
    }, {
      "referenceID" : 6,
      "context" : "Many classes of problems, including prediction with expert advice [1], the multi-armed bandit problem [2], dynamic pricing [3], the dark pool problem [4], label efficient prediction [5], and linear and convex optimization with full or bandit feedback [6, 7] can be modeled as an instance of partial monitoring.",
      "startOffset" : 251,
      "endOffset" : 257
    }, {
      "referenceID" : 7,
      "context" : "1 Related work The paper by Piccolboni and Schindelhauer [8] is one of the first to study the regret of the finite partial monitoring problem.",
      "startOffset" : 57,
      "endOffset" : 60
    }, {
      "referenceID" : 8,
      "context" : "[9] to O(T ), who also showed an instance in which the bound is optimal.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 9,
      "context" : "[10] classified the partial monitoring problems into four categories in terms of the minimax regret: a trivial problem with zero regret, an easy problem with Θ̃( √ T ) regret1, a hard problem with Θ(T ) regret, and a hopeless problem with Θ(T ) regret.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 10,
      "context" : "Since then, several algorithms with a Õ( √ T ) regret bound for easy problems have been proposed [11, 12, 13].",
      "startOffset" : 97,
      "endOffset" : 109
    }, {
      "referenceID" : 11,
      "context" : "Since then, several algorithms with a Õ( √ T ) regret bound for easy problems have been proposed [11, 12, 13].",
      "startOffset" : 97,
      "endOffset" : 109
    }, {
      "referenceID" : 12,
      "context" : "Since then, several algorithms with a Õ( √ T ) regret bound for easy problems have been proposed [11, 12, 13].",
      "startOffset" : 97,
      "endOffset" : 109
    }, {
      "referenceID" : 12,
      "context" : "Among them, the Bayes-update Partial Monitoring (BPM) algorithm [13] is state-of-the-art in the sense of empirical performance.",
      "startOffset" : 64,
      "endOffset" : 68
    }, {
      "referenceID" : 10,
      "context" : "[11], which derivedO(logT ) distribution-dependent regret for easy problems.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 1,
      "context" : "Upper confidence bound (UCB), the most well-known algorithm for the multi-armed bandits, has a distribution-dependent regret bound [2, 14], and algorithms that minimize the distribution-dependent regret (e.",
      "startOffset" : 131,
      "endOffset" : 138
    }, {
      "referenceID" : 13,
      "context" : "Upper confidence bound (UCB), the most well-known algorithm for the multi-armed bandits, has a distribution-dependent regret bound [2, 14], and algorithms that minimize the distribution-dependent regret (e.",
      "startOffset" : 131,
      "endOffset" : 138
    }, {
      "referenceID" : 14,
      "context" : "[15]).",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 9,
      "context" : "[10]) in which the number of rows of Si is the number of the different symbols in the i-th row of H .",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 1,
      "context" : "In the context of the multi-armed bandit problem, Lai and Robbins [2] derived the regret lower bound of a strongly consistent algorithm: an algorithm must select each arm i until its number of draws Ni(t) satisfies log t .",
      "startOffset" : 66,
      "endOffset" : 69
    }, {
      "referenceID" : 15,
      "context" : "Large deviation principle [16] states that, the probability that an opponent with strategy q behaves like p is",
      "startOffset" : 26,
      "endOffset" : 30
    }, {
      "referenceID" : 1,
      "context" : "Based on the technique used in Lai and Robbins [2], the proof considers a modified game in which another action i 6= 1 is optimal.",
      "startOffset" : 47,
      "endOffset" : 50
    }, {
      "referenceID" : 12,
      "context" : "[13]) ambiguously define the harshness as the closeness to the boundary of the cells.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 16,
      "context" : "4 PM-DMED Algorithm In this section, we describe the partial monitoring deterministic minimum empirical divergence (PMDMED) algorithm, which is inspired by DMED [17] for solving the multi-armed bandit problem.",
      "startOffset" : 161,
      "endOffset" : 165
    }, {
      "referenceID" : 0,
      "context" : "Let p̂i(t) ∈ [0, 1] be the empirical distribution of the symbols under the selection of action i.",
      "startOffset" : 13,
      "endOffset" : 19
    }, {
      "referenceID" : 10,
      "context" : "[11], we compared the performances of algorithms in three different games: the four-state game (Section 4), a three-state game and dynamic pricing.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 10,
      "context" : "[11], we set N = 5,M = 5, and c = 2.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 7,
      "context" : "We compared Random, FeedExp3 [8], CBP [11] with α = 1.",
      "startOffset" : 29,
      "endOffset" : 32
    }, {
      "referenceID" : 10,
      "context" : "We compared Random, FeedExp3 [8], CBP [11] with α = 1.",
      "startOffset" : 38,
      "endOffset" : 42
    }, {
      "referenceID" : 12,
      "context" : "01, BPM-LEAST, BPM-TS [13], and PM-DMED with c = 1.",
      "startOffset" : 22,
      "endOffset" : 26
    }, {
      "referenceID" : 12,
      "context" : "Following the optimization of BPM-LEAST [13], we resorted to a finite sample approximation and used the Gurobi LP solver [19] in computing {r∗ i }: at each round, we sampled 1,000 points from PM , and relaxed the constraints on the samples.",
      "startOffset" : 40,
      "endOffset" : 44
    }, {
      "referenceID" : 17,
      "context" : "[20] and references therein).",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 1,
      "context" : "Moreover, the coefficient of the leading logarithmic term in the regret bound of the partial monitoring problem is equal to the bound given in Lai and Robbins [2].",
      "startOffset" : 159,
      "endOffset" : 162
    }, {
      "referenceID" : 18,
      "context" : ", Fiacco [21]).",
      "startOffset" : 9,
      "endOffset" : 13
    }, {
      "referenceID" : 0,
      "context" : "References [1] Nick Littlestone and Manfred K.",
      "startOffset" : 11,
      "endOffset" : 14
    }, {
      "referenceID" : 1,
      "context" : "[2] T.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 2,
      "context" : "[3] Robert D.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 3,
      "context" : "[4] Alekh Agarwal, Peter L.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 4,
      "context" : "[5] Nicolò Cesa-Bianchi, Gábor Lugosi, and Gilles Stoltz.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 5,
      "context" : "[6] Martin Zinkevich.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 6,
      "context" : "[7] Varsha Dani, Thomas P.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 7,
      "context" : "[8] Antonio Piccolboni and Christian Schindelhauer.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 8,
      "context" : "[9] Nicolò Cesa-Bianchi, Gábor Lugosi, and Gilles Stoltz.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 9,
      "context" : "[10] Gábor Bartók, Dávid Pál, and Csaba Szepesvári.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 10,
      "context" : "[11] Gábor Bartók, Navid Zolghadr, and Csaba Szepesvári.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 11,
      "context" : "[12] Gábor Bartók.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 12,
      "context" : "[13] Hastagiri P.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 13,
      "context" : "[14] Peter Auer, Nicoló Cesa-bianchi, and Paul Fischer.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 14,
      "context" : "[15] Aurélien Garivier and Olivier Cappé.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 15,
      "context" : "[16] Amir Dembo and Ofer Zeitouni.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 16,
      "context" : "[17] Junya Honda and Akimichi Takemura.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 17,
      "context" : "[20] S.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 18,
      "context" : "[21] Anthony V.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 19,
      "context" : "[22] T.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 20,
      "context" : "[23] Emilie Kaufmann, Olivier Cappé, and Aurélien Garivier.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 21,
      "context" : "[24] Sébastien Bubeck.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 22,
      "context" : "[25] William W.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 19,
      "context" : "In fact, many regularity conditions are assumed in Graves and Lai [22], where another generalization of the bandit problem is considered and the regret lower bound is expressed in terms of LSIP.",
      "startOffset" : 66,
      "endOffset" : 70
    }, {
      "referenceID" : 1,
      "context" : "The technique here is mostly inspired from Theorem 1 in Lai and Robbins [2].",
      "startOffset" : 72,
      "endOffset" : 75
    }, {
      "referenceID" : 20,
      "context" : "[23].",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 21,
      "context" : "5 in [24]).",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 1,
      "context" : "During the proof we also show that C 1 (p , {pi }) is equal to the optimal constant factor of Lai and Robbins [2].",
      "startOffset" : 110,
      "endOffset" : 113
    }, {
      "referenceID" : 1,
      "context" : "LBTheory is the asymptotic regret lower bound of Lai and Robbins [2].",
      "startOffset" : 65,
      "endOffset" : 68
    }, {
      "referenceID" : 1,
      "context" : "LB-Theory is the regret lower bound of Lai and Robbins [2], that is, ∑ i6=1 ∆i log t d(μi‖μ1) .",
      "startOffset" : 55,
      "endOffset" : 58
    }, {
      "referenceID" : 22,
      "context" : "See Hogan [25] for definitions of terms such as continuity of point-to-set maps.",
      "startOffset" : 10,
      "endOffset" : 14
    }, {
      "referenceID" : 0,
      "context" : "2 Regret analysis of PM-DMED-Hinge Let p̂i,n ∈ [0, 1] be the empirical distribution of the symbols from the action i when the action i is selected n times.",
      "startOffset" : 47,
      "endOffset" : 53
    } ],
    "year" : 2015,
    "abstractText" : "Partial monitoring is a general model for sequential learning with limited feedback formalized as a game between two players. In this game, the learner chooses an action and at the same time the opponent chooses an outcome, then the learner suffers a loss and receives a feedback signal. The goal of the learner is to minimize the total loss. In this paper, we study partial monitoring with finite actions and stochastic outcomes. We derive a logarithmic distribution-dependent regret lower bound that defines the hardness of the problem. Inspired by the DMED algorithm (Honda and Takemura, 2010) for the multi-armed bandit problem, we propose PM-DMED, an algorithm that minimizes the distribution-dependent regret. PM-DMED significantly outperforms state-of-the-art algorithms in numerical experiments. To show the optimality of PM-DMED with respect to the regret bound, we slightly modify the algorithm by introducing a hinge function (PMDMED-Hinge). Then, we derive an asymptotically optimal regret upper bound of PM-DMED-Hinge that matches the lower bound.",
    "creator" : "dvips(k) 5.991 Copyright 2011 Radical Eye Software"
  }
}