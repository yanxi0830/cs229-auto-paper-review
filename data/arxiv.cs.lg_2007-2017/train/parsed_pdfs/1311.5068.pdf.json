{
  "name" : "1311.5068.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "GROMOV-HAUSDORFF STABILITY OF LINKAGE-BASED HIERARCHICAL CLUSTERING METHODS",
    "authors" : [ "A. MARTÍNEZ-PÉREZ" ],
    "emails" : [ "alvaro.martinezperez@uclm.es." ],
    "sections" : [ {
      "heading" : null,
      "text" : "on the data set produce small perturbations in the result. This perturbations are measured using the Gromov-Hausdorff metric. We study the problem of\nstability on linkage-based hierarchical clustering methods. We obtain that,\nunder some basic conditions, standard linkage-based methods are semi-stable. This means that they are stable if the input data is close enough to an ul-\ntrametric space. We prove that, apart from exotic examples, introducing any\nunchaining condition in the algorithm always produces unstable methods.\nKeywords: Hierarchical clustering, linkage function, unchaining condition, linkage-based hier-\narchical clustering, stable in the Gromov-Hausdorff sense.\nContents\n1. Introduction 1 2. Background and notation 3 3. Linkage-based hierarchical clustering methods 4 4. Semi-stability of HC methods. 8 5. Stability of HC methods. 16 6. Discussion 24 References 24\n1. Introduction\nClustering techniques are extensively used in data analysis. Given a finite metric space, a clustering method yields a partition of the space. The output of a hierarchical clustering algorithm can be described as a nested family of partitions, as a dendrogram or as an ultrametric space. These procedures are used also in the more general setting where the input is a finite set endowed with a distance function. See [2]. In our work, the input is always a finite metric space.\nOne common type of clustering algorithms are those which are determined by a linkage function. These algorithms are called linkage-based methods and a characterization can be found in [2]. Linkage-based hierarchical clustering algorithms start with singleton clusters. Then, in the recursive formulation, the linkage function is used at every step to determine the minimal distance between clusters, Ri. Then, clusters at distance Ri are merged. The most usual methods of hierarchical clustering such as single linkage, complete linkage and average linkage are linkage-based. Herein, we refer to this type of methods as standard linkage-based methods.\nPartially supported by MTM 2012-30719, alvaro.martinezperez@uclm.es.\n1\nar X\niv :1\n31 1.\n50 68\nv1 [\ncs .L\nG ]\n2 0\nN ov\n2 01\nIn [14] we studied some characteristic chaining effect in hierarchical clustering. For further reference about the chaining effect see also [12]. To deal with it, different strategies have been proposed, see [7], [8] or [16]. We defined an algorithm called α-unchaining single linkage or SL(α) to avoid certain type of chaining effect. The key was to include some property, Pα, so that if a pair blocks does not satisfy it, the blocks are not merged. In this case, Pα is defined so that if the blocks are chained by a single edge (which we may see as an undesired chaining) then they will not satisfy the property and they stay as separated blocks until the next step in the recursive formulation.\nTo treat other undesired chaining effects in the application of a linkage-based algorithm the same strategy can be used. First, characterizing when a pair of blocks should not be merged and then defining some unchaining condition P to prevent it. This can be generalized as well considering hierarchical clustering algorithms determined by some linkage function, `, and some unchaining condition P . We call these algorithms almost-standard linkage-based methods.\nAn important property for a hierarchical clustering method is some kind of stability under small perturbations in the input data. Otherwise, small differences may yield very different dendrograms and the significance of the hierarchical clustering can be compromised. This can be a major problem if the input is a random sample determined by some probability distribution or if the input data is only known up to a certain degree of precision. There are several papers dealing with stability of clustering and hierarchical clustering. Different approaches and different types of algorithms are considered. In [3] there is an interesting analysis on stability for clustering algorithms based on some objective function which is minimized or maximized. Other perspectives can be found in [4], [11] and [15]. In our work we focus on linkage-based algorithms. In [6], Carlson and Memoli use tools from geometric topology to study the stability of single linkage hierarchical clustering. In their paper stability is measured using Gromov-Hausdorff metric, dGH , and the following result is obtained.\nProposition 1.1. [6, Proposition 26] For any two finite metric spaces (X, dX) and (Y, dY )\ndGH(X,Y ) ≥ dGH(TSLU (X, dX),TSLU (Y, dY )). Thus, if single linkage hierarchical clustering is applied to a pair of metric spaces\nwhich are close in the Gromov-Hausdorff metric, then the resultant ultrametric spaces are also close in this metric. Moreover, the Gromov-Hausdorff metric has the advantage that it can be used to measure the distance between any pair of metric spaces, regardless of whether they have the same number of points or not.\nThis work follows the same path. We give explicit definitions to study the stability of hierarchical clustering methods in terms of the Gromov-Hausdorff metric. First we consider the notion of being semi-stable in the Gromov-Hausdorff sense for algorithms that are stable at least when the input data is close enough to an ultrametric space. Then, we define the stronger property of being stable in the Gromov-Hausdorff sense. This definition contains the implicit approach given by Carlson and Memoli so that the condition given in Proposition 1.1 implies that SL is stable in the Gromov-Hausdorff sense.\nOur purpose is to analyse the problem of Gromov-Hausdorff stability in standard and almost-standard linkage-based hierarchical clustering methods. We pay special attention to single linkage, complete linkage, average linkage and α-unchaining\nsingle linkage. However, we try to generalize our results working with arbitrary linkage functions and arbitrary unchaining conditions. Since these definitions are quite unrestricted, we must include several technical properties to avoid exotic cases and make proofs work. Nevertheless, these technical properties are trivially satisfied by the usual hierarchical clustering methods mentioned above and the theorems obtained are, in fact, very general.\nWe prove that every normal faithful standard linkage-based method is semistable. See Theorem 4.15. Therefore, if we know that the data correspond to an ultrametric space and the measures are precise, semi-stability can be good enough to obtain legitimate results and standard linkage-based methods would be adequate.\nNevertheless, in Proposition 5.17 we prove that any unchaining condition introduces some degree of instability in the method. For every admissible almoststandard linkage-based method, there exist two arbitrarily close metric spaces with a pair of blocks each such that for the first pair the unchaining condition is satisfied and for the other one is not. This instability can be stated more precisely if the linkage function is `SL. In this case, if the almost-standard linkage-based method is ordinary and the unchaining condition is minimally bridge-unchaining, then the method is not stable in the Gromov-Hausdorff sense. See Theorem 5.24. In particular, SL(α) is not stable in the Gromov-Hausdorff sense.\nThe structure of the paper is the following: Section 2 recalls the basics on hierarchical clustering and the main notations\nused herein. Section 3 presents the recursive definition of almost-standard linkage-based hi-\nerarchical clustering methods. In section 4 we define the property of being semi-stable in the Gromov-Hausdorff\nsense. We prove that any normal, faithful, standard linkage-based HC method is semi-stable in the Gromov-Hausdorff sense. This includes the classical standard linkage-basedHC methods. We also prove that SL(α) is semi-stable in the GromovHausdorff sense.\nIn section 5 we define the property of being stable in the Gromov-Hausdorff sense. We prove that for every ordinary almost-standard linkage-basedHC method, T(`SL, P ), if P is minimally bridge-unchaining, then T is not stable in the GromovHausdorff sense. In particular, SL(α) is not stable in the Gromov-Hausdorff sense.\nSection 6 includes a short discussion about Gromov-Hausdorff stability.\n2. Background and notation\nA dendrogram over a finite set is a nested family of partitions. This is usually represented as a rooted tree.\nLet P(X) denote the collection of all partitions of a finite set X = {x1, ..., xn}. Then, a dendrogram can also be described as a map θ : [0,∞)→ P(X) such that:\n1. θ(0) = {{x1}, {x2}, ..., {xn}}, 2. there exists T such that θ(t) = X for every t ≥ T , 3. if r ≤ s then θ(r) refines θ(s), 4. for all r there exists ε > 0 such that θ(r) = θ(t) for t ∈ [r, r + ε].\nNotice that conditions 2 and 4 imply that there exist t0 < t1 < ... < tm such that θ(r) = θ(ti−1) for every r ∈ [ti−1, ti), i = 1,m and θ(r) = θ(tm) = {X} for every r ∈ [tm,∞).\nFor any partition {B1, ..., Bk} ∈ P(X), the subsets Bi are called blocks.\nLet D(X) denote the collection of all possible dendrograms over a finite set X. Given some θ ∈ D(X), let us denote θ(t) = {Bt1, ..., Btk(t)}. Therefore, the nested family of partitions is given by the corresponding partitions at t0, ..., tm, this is, {Bti1 , ..., B ti k(ti) } i = 0,m.\nAn ultrametric space is a metric space (X, d) such that d(x, y) ≤ max{d(x, z), d(z, y)} for all x, y, z ∈ X. Given a finite metric space X let U(X) denote the set of all ultrametrics over X.\nThere is a well known equivalence between trees and ultrametrics. See [10] or [13] for a complete exposition of how to build categorical equivalences between them. In particular, this may be translated into an equivalence between dendrograms and ultrametrics:\nThus, a hierarchical clustering method T can be presented as an algorithm whose output is a a dendrogram or an ultrametric space. Let TD(X, d) denote the dendrogram obtained by applying T to a metric space (X, d) and TU (X, d) denote the corresponding ultrametric space.\nLet us define the map η : D(X)→ U(X) as follows: Given a dendrogram θ ∈ D(X), let η(θ) = uθ be such that uθ(x, x′) = min{r ≥\n0 |x, x′ belong to the same block of θ(r)}. Proposition 2.1. [6, Theorem 9] η is a bijection such that η ◦ TD = TU .\nNotation: For any HC method T and any finite metric space (X, d), let us denote TD(X, d) = θX and TU (X, d) = (X,uX). If there is no need to distinguish the metric space we shall just write TD(X, d) = θ and TU = u.\n3. Linkage-based hierarchical clustering methods\nLet us recall the definition of some hierarchical clustering methods. We include here the description of single linkage by its t-connected components and the recursive description of single linkage, complete linkage and average linkage. We recall also the alternative description of these methods, defining the graph G`R, which we used to build our method, SL(α). This process might be useful to define other algorithms better adapted to specific problems.\nAn ε-chain is a finite sequence of points x0, ..., xN that are separated by distances less or equal than ε: |xi − xi+1| < ε. Two points are ε-connected if there is an εchain joining them. Any two points in an ε-connected set can be linked by an ε-chain. An ε-component is a maximal ε-connected subset.\nClearly, given a metric space and any ε > 0, there is a partition of X in its ε-components {Cε1 , ..., Cεk(ε)}.\nLet X be a finite metric set. The single linkage HC is defined by the map θ : [0,∞)→ P(X) such that θ(t) is the partition of X in its t-components.\nLet us recall the following from [1]. For x, y ∈ X and any (standard) clustering C of X, x ∼C y if x and y belong\nto the same cluster in C and x 6∼C y, otherwise. Two (standard) clusterings C = (C1, ..., Ck) of (X, d) and C ′ = (C ′1, ...C ′ k) of (X ′, d′) are isomorphic clusterings, denoted (C, d) ∼= (C ′, d′), if there exists a bijection φ : X → X ′ such that for all x, y ∈ X, d(x, y) = d′(φ(x), φ(y)) and x ∼C y if and only if φ(x) ∼C′ φ(y). Definition 3.1. A linkage function is a function\n` : {(X1, X2, d) | d is a distance function over X1 ∪X2} → R+\nsuch that,\n1. ` is representation independent: For all (X1, X2) and (X ′ 1, X ′ 2), if (X1, X2, d) ∼= (X ′1, X ′ 2, d ′) (i.e., they are clustering-isomorphic), then `(X1, X2, d) = `(X ′ 1, X ′ 2, d ′). 2. ` is monotonic: For all (X1, X2) if d ′ is a distance function over X1 ∪X2\nsuch that for all x ∼{X1,X2} y, d(x, y) = d′(x, y) and for all x 6∼{X1,X2} y, d(x, y) ≤ d′(x, y) then `(X1, X2, d′) ≥ `(X1, X2, d). 3. Any pair of clusters can be made arbitrarily distant: For any pair of data sets (X1, d1), (X2, d2), and any r in the range of `, there exists a distance function d that extends d1 and d2 such that `(X1, X2, d) > r.\nFor technical reasons, let us assume that a linkage function has a countable range. Say, the set of nonnegative algebraic real numbers.\nSome standard choices for ` are:\n• Single linkage: `SL(B,B′) = min(x,x′)∈B×B′ d(x, x′) • Complete linkage: `CL(B,B′) = max(x,x′)∈B×B′ d(x, x′) • Average linkage: `AL(B,B′) = ∑ (x,x′)∈B×B′ d(x,x ′)\n#(B)·#(B′) where #(X) denotes the\ncardinal of the set X.\nIn [6], the authors use a recursive procedure by which they redefine SL HC, average linkage (AL) and complete linkage (CL) hierarchical clustering. We reproduce here, for completeness, their formulation.\nLet (X, d) be a finite metric space where X = {x1, ..., xn} and let L denote a family of linkage functions on X:\nL := {` : C(X)× C(X)→ R+ | ` is bounded and non-negative }\nwhere C(X) denotes the collection of all non-empty subsets of X. Fix some linkage function ` ∈ L. Then, the recursive formulation is as follows\n1. For each R > 0 consider the equivalence relation ∼`,R on blocks of a partition Π ∈ P(X), given by B ∼`,R B′ if and only if there is a sequence of blocks B = B1, ..., Bs = B\n′ in Π with `(Bk, Bk+1) ≤ R for k = 1, ..., s− 1. 2. Consider the sequences R0, R1, R2, ... ∈ [0,∞) and Θ1,Θ2, ... ∈ P(X) given\nby R0 = 0, Θ1 := {x1, ..., xn}, and recursively for i ≥ 1 by Θi+1 = Θi∼`,Ri where Ri := min{`(B,B′) |B,B′ ∈ Θi, B 6= B′} until Θi = {X}.\n3. Finally, let θ` : [0,∞) → P(X) be such that θ`(r) := Θi(r) with i(r) := max{i |Ri ≤ r}.\nIn [14] we proposed the following formulation of the recursive algorithm:\nDefinition 3.2. We say that T is a standard linkage-based hierarchical clustering method if there is some linkage function ` such that TD can be defined recursively as follows:\n1. Let Θ1 := {x1, ..., xn} and R0 = 0. 2. For every i ≥ 1, while Θi 6= {X}, let Ri := min{`(B,B′) |B,B′ ∈ Θi, B 6= B′}. Then, let G`Ri be a graph whose vertices are the blocks of Θi and such that there is an edge joining B and B′ if and only if `(B,B′) ≤ Ri. 3. Consider the equivalence relation B ∼`,R B′ if and only if B,B′ are in the same connected component of G`R. Then, Θi+1 = Θi ∼`,R . 4. Finally, let θ` : [0,∞) → P(X) be such that θ`(r) := Θi(r) with i(r) := max{i |Ri ≤ r}.\nProposition 3.3. TD is a dendrogram.\nProof. It is clear by construction that Θi refines Θi+1 for every i. Now, if r < r ′, i(r) = max{i |Ri ≤ r} and i(r′) = max{i |Ri ≤ r′}, then i(r) ≤ i(r′). Hence, it is immediate to check that θ` is a dendrogram.\nNotice, however, that the sequence (Ri) defined in the algorithm above need not be increasing:\nExample 3.4. Let ` be a linkage function defined as follows:\n`(B1, B2) := `SL(B1, B2)\n](B1) + ](B2) .\nIt is immediate to check that ` is a well defined linkage function. Let X = {0, 2, 5, 7} ⊂ R with the euclidean metric d inherited. If we apply the recursive algorithm above, then R1 = `(0, 2) = `(5, 7) = 1 and Θ1 = {{0, 2}, {5, 7}}. However, R2 = `({0, 2}, {5, 7}) = 34 < R1.\nNotice that θ`(r) = {{0}, {2}, {5}, {7}} for every r < 34 and θ `(r) = {0, 2, 5, 7}\nfor every r ≥ 34 .\nDefinition 3.5. We say that a linkage function is increasing if the sequence (Ri) defined in the recursive construction is increasing.\nProposition 3.6. `SL, `CL and `AL are increasing linkage functions.\nProof. Let ` be `SL, `CL or `AL. First, notice that for any pair of blocks A1, A2, `(A1, A2) only depends of the distance between the points in A1 and A2.\nClaim: Given Ri and Θi, then Ri+1 > Ri. This is immediate for `SL. Let us check the proposition for ` = `CL. Let B1, B2 ∈ Θi+1 and A1, A2 ∈ Θi such that A1 ⊂ B1 and A2 ⊂ B2. Then, `CL(A1, A2) ≤ `CL(A1, B2) ≤ `CL(B1, B2). Since A1, A2 are not merged in Θi+1, Ri < `\nCL(A1, A2) ≤ `CL(B1, B2). Hence, Ri+1 > Ri.\nNow, consider ` = `AL. First notice that if {a1, ..., an} ⊂ R and {b1, ..., bn} ⊂ R with\nM1 = ∑n 1 ai n > R and M2 = ∑m 1 bi m > R\nthen\n(1) M3 =\n∑n 1 ai + ∑m 1 bi\nn+m > R.\nIt suffices to check that (n + m)M3 = nM1 + mM2 ≥ (n + m)M3 and, therefore, M3 > R.\nLet B1, B2 ∈ Θi+1, A1, A2, ..., Ak ∈ Θi such that A1 ∪ · · · ∪ Ak = B1 and C1, ..., Ck′ ∈ Θi with C1 ∪ · · · ∪Ck′ = B2. Clearly, `AL(Ai, Cj) > Ri since they are independent blocks in Θi. Thus, applying (1), ` AL(Ai, B2) > Ri and ` AL(B1, B2) > Ri. Hence, Ri+1 > Ri.\nNotation: Given a metric space (X, d) let\n(2) ∆(X, d) := {d(x, y) |x, y ∈ X} this is, the set of all possible distances between points in (X, d).\nDefinition 3.7. Let P be any condition on the set of pairs of blocks which depends on a parameter R. We say that P is an unchaining condition if for every pair of blocks B,B′ there is some R0 > 0 such that {B1, B2} satisfies P for every R > R0.\nDefinition 3.8. We say that T is an almost-standard linkage-based hierarchical clustering method if there is an unchaining condition P such that TD can be defined as follows.\n1. Let Θ1 := {x1, ..., xn}, Θ0 = ∅ and R0 = 0. 2. For every i ≥ 1, while Θi−1 6= {X}:\na) if Θi 6= Θi−1 let Ri := min{`(B,B′) |B,B′ ∈ Θi, B 6= B′}, b) if Θi = Θi−1 and there exist B,B\n′ ∈ Θi such that `(B,B′) > Ri−1, let Ri := min{`(B,B′) |B,B′ ∈ Θi and `(B,B′) > Ri−1}, c) if Θi = Θi−1 and there are no blocks B,B ′ ∈ Θi such that `(B,B′) >\nRi−1, then let Ri := min{R | there exist B,B′ ∈ Θi such that {B,B′} satisfies P for R}. Then, let G`Ri be a graph whose vertices are the blocks of Θi and such that there is an edge joining two blocks, B and B′, if and only if the following two conditions hold.\ni) `(B,B′) ≤ Ri ii) {B,B′} satisfies condition P for Ri.\n3. Consider the equivalence relation B ∼`,Ri B′ if and only if B,B′ are in the same connected component of G`Ri . Then, Θi+1 = Θi ∼`,Ri . 4. Finally, let θ` : [0,∞) → P(X) be such that θ`(r) := Θi(r) with i(r) := max{i |Ri ≤ r}.\nIn this case, we say that P is the unchaining condition of the method. Hence, an almost-standard linkage-based HC method is defined by a linkage function `, some property P . Let us denote T = T(`;P ).\nRemark 3.9. Notice that step 2 has to deal with some technical difficulties which do no show up in the case of standard linkage-based algorithms. Without conditions b) and c), the algorithm may not finish. However, condition c) may be a problem for practical uses.\nAn alternative procedure to assure that the algorithm will not enter into an infinite loop is to begin by choosing an ordered set containing all possible distances between blocks, R = {R0, ..., Rm} with Ri > Ri−1, making sure that Rm is big enough so that θ(Rm) = X. If the linkage function is `\nSL or `CL this may be easily solved considering R = {R0, ..., Rm} to be the ordered set of distances between the points in the sample (X, d), i.e. R = ∆(X, d). In this case, all possible distances between blocks are contained in ∆(X, d) and the resulting dendrogram will be the same as applying the formal algorithm above. Nevertheless, we believe that for the general statement of almost-standard linkange-based methods is better not to include any election a priori of the sequence (Ri).\nExample 3.10. Notice that TSL = T(` SL, ∅).\nLet us recall here the definition of SL(α) from [14]: Given a finite metric space (X, d), let Ft(X, d) be the Rips (or Vietoris-Rips) complex of (X, d). Let us recall that the Rips complex of a metric space (X, d) is a simplicial complex whose vertices are the points of X and [v1, ..., vk] is a simplex\nof Ft(X, d) if and only if d(vi, vj) ≤ t for every i, j. Given any subset Y ⊂ X, by Ft(Y ) we refer to the subcomplex of Ft(X) defined by the vertices in Y . R = {R0, ..., Rm} = ∆(X, d) with Ri > Ri−1. Clearly, R0 = 0. Let the dendrogram defined by SL(α), θα, be as follows:\n1) Let θα(0) := {{x1}, ..., {xn}} and θα(r) := θα(0) ∀r < R1. Now, given θα[Ri−1, Ri) = θα(Ri−1) = {B1, ..., Bm}, we define recursively θα on the interval [Ri, Ri+1) as follows: 2) LetGRiα be a graph with vertices V(GRiα ) := {B1, ..., Bm} and edges E(GRiα ) := {Bi, Bj} such that the following conditions hold:\ni) min{d(x, y) |x ∈ Bi, y ∈ Bj} ≤ Ri. ii) there is a simplex ∆ ∈ FRi(Bi ∪Bj) such that ∆∩Bi 6= ∅, ∆∩Bj 6= ∅\nand α · dim(∆) ≥ min{dim(FRi(Bi)), dim(FRi(Bj))}. 3) Let us define a relation, ∼Ri,α as follows.\nLet Bi ∼Ri,α Bj if Bi, Bj belong to the same connected component of the graph GRiα . Then, ∼Ri,α induces an equivalence relation. 4) For every r ∈ [Ri, Ri+1), θα(r) := θα(Ri−1)/ ∼Ri,α. Here, the unchaining condition ii) is defined to avoid the chaining effect which\nautomatically merges two blocks when the minimal distance between them is small. See [14].\nExample 3.11. SL(α) is an almost-standard linkage-based hierarchical clustering method: SL(α) = (`SL, Pα) where given Bj , Bk ∈ Θi, {Bj , Bk} satisfies Pα for Ri if there is a simplex ∆ ∈ FRi(Bj ∪ Bk) such that ∆ ∩ Bj 6= ∅, ∆ ∩ Bk 6= ∅ and α · dim(∆) ≥ min{dim(FRi(Bj)), dim(FRi(Bk))}.\n4. Semi-stability of HC methods.\nLet us recall the definition of Gromov-Hausdorff distance from [5]. See also [9]. Let (X, dX) and (Y, dY ) be two metric spaces. A correspondence (between A\nand B) is a subset τ ∈ A×B such that • ∀ a ∈ A, there exists b ∈ B s.t. (a, b) ∈ τ • ∀ b ∈ B, there exists a ∈ A s.t. (a, b) ∈ τ\nLet T (A,B) denote the set of all possible correspondences between A and B. Let ΓX,Y : X × Y ×X × Y → R+ given by\n(x, y, x′, y′) 7→ |dX(x, x′)− dY (y, y′)|. Then, the Gromov-Hausdorff distance between X and Y is:\ndGH(X,Y ) := 1\n2 inf τ∈T (X,Y ) sup (x,y)(x′,y′)∈τ ΓX,Y (x, y, x\n′, y′).\nNotation: Let (M, dGH) denote the set of finite metric spaces with the GromovHausdorff metric and (U , dGH) denote the set of finite ultrametric spaces with the Gromov-Hausdorff metric.\nDefinition 4.1. A HC method T is faithful if for any ultrametric space (U, d), TU (U, d) = (U, d).\nThe following appears as Proposition 4.6 in [14]. We include the proof for completeness.\nProposition 4.2. TSL is faithful.\nProof. By definition, it is clear that uSL(x, y) ≤ d(x, y) for every x, y ∈ X. Let us see that, if (X, d) is an ultrametric space, then uSL(x, y) ≥ d(x, y). uSL(x, y) = inf{t | there exists a t-chain joining x to y}. Suppose uSL(x, y) = t and let x = x0, x1, ..., xn = y a t-chain joining x to y. By the properties of the ultrametric, d(xi−1, xi+1) ≤ max{d(xi−1, xi), d(xi, xi+1)} ≤ t for every 1 ≤ i ≤ n−1. Therefore, d(x, y) ≤ t and uSL(x, y) ≥ d(x, y).\nProposition 4.3. TCL and TAL are faithful.\nProof. Let (X,u) be a finite ultrametric space and ∆(X, d) = {0 = t0 < t1 < · · · < tm}.\nLet us check that TSLD (U, d) = T CL D (U, d) = T AL D (U, d). Therefore, by Proposition\n4.2, TCLU (U, d) = T AL U (U, d) = (U, d).\nLet TSLD (U, d) = θSL, T CL D (U, d) = θCL and T CL D (U, d) = θCL.\nFor t0 = 0, every point of U is a block in θCL(t0) or θAL(t0) and θCL(t0) = θAL(t0) = θSL(t0).\nNow, suppose that θCL(ti−1) = θAL(ti−1) = θSL(ti−1). Then, the blocks are exactly the balls of radius ti−1. Let B,B\n′ ∈ θSL(ti−1). Let x0 ∈ B and y0 ∈ B′ be such that d(x0, y0) = min(x,x′)∈B×B′ d(x, x\n′). Then, d(x0, y0) > ti−1 and, by the properties of the ultrametric, for every pair of points (x, x′) ∈ B × B′, d(x, x′) ≤ max{ti−1, d(x0, y0)} = d(x0, y0). Thus, `CL(B,B′) = max(x,x′)∈B×B′ d(x, x′) ≤ d(x0, y0) and `\nAL(B,B′) ≤ d(x0, y0). Therefore, `CL(B,B′) = `AL(B,B′) = `SL(B,B′) and θCL(ti) = θAL(ti) =\nθSL(ti). Since θCL(tm) = θAL(tm) = θSL(tm) = X, this completes the proof.\nThe following is part of Corollary 8.9 in [14].\nProposition 4.4. SL(α) is faithful\nDefinition 4.5. A HC method T is semi-stable in the Gromov-Hausdorff sense if for any sequence of finite metric spaces ((Xk, dk))k∈N in (M, dGH) such that limk→∞(Xk, dk) = (U, d) ∈ U then limk→∞ TU (Xk, dk) = TU (U, d).\nTherefore, a faithful HC method T is semi-stable in the Gromov-Hausdorff sense if for any sequence of finite metric spaces ((Xk, dk))k∈N in (M, dGH) such that limk→∞(Xk, dk) = (U, d) ∈ U then limk→∞ TU (Xk, dk) = (U, d).\nProposition 4.6. TSL is semi-stable in the Gromov-Hausdorff sense.\nProof. This is an immediate consequence of [6, Proposition 26] (see 1.1).\nRemark 4.7. There exists a sequence of metric spaces ((Xk, dk))k∈N in (M, dGH) and a sequence of ultrametric spaces (Uk, uk) with limk→∞ dGH((Xk, dk), (Uk, uk)) = 0 while limk→∞ dGH(T CL U (Xk, dk), (Uk, uk)) > 0. See example below.\nExample 4.8. Let Xk := {ai}−2≤i≤k ∪ {bi}−2≤i≤k and dk such that: dk(a−2, b−2) = 1. dk(a−1, b−1) = 1 + δk with δk = 1 k+1 .\ndk(a−2, a−1) = 1 2 , dk(b−2, b−1) = 1 2 .\ndk(a0, ai) = 1, for i = −2,−1, dk(b0, bi) = 1, for i = −2,−1, dk(a0, bj) = 1 + δk for j < 0 and dk(aj , b0) = 1 + δk for j < 0.\nLet εk = δk 2 .\ndk(am, ai) = 1 + mεk, for every 1 ≤ m ≤ k, i < m, dk(bm, bi) = 1 + mεk, for every m ≥ 1, i < m, dk(am, bi) = 1 +mεk + δk, for every 1 ≤ m ≤ k, i ≤ m, and dk(bm, ai) = 1 +mεk + δk for every 1 ≤ m ≤ k, i ≤ m.\n1\n1+δ 0\n1 1\n1 1\na-2 b-2\na-1\na0\nb-1\nb0\n(X0,d0)\n1/2 1/2\nLet Uk := {ãi}−2≤i≤k ∪ {b̃i}−2≤i≤k and uk : U × U → R as follows: uk(ãj , b̃j) = 1 for j = −2,−1, 0. uk(ã−2, ã−1) = 1 2 , uk(b̃−2, b̃−1) = 1 2 . uk(ã0, ãi) = 1, for i = −2,−1, uk(b̃0, b̃i) = 1, for i = −2,−1 uk(ãn, ãi) = 1 + nεk, for every n ≥ 1, i < n, uk(b̃n, b̃i) = 1 + nεk, for every n ≥ 1, i < n, uk(ãn, b̃i) = 1 +nεk, for every n ≥ 1, i ≤ n, and uk(b̃n, ãi) = 1 +nεk for every n ≥ 1, i ≤ n.\nLet us see that dGH((Xk, dk), (Uk, uk)) ≤ δk = 1k+1 . It suffices to consider the correspondence τ = {(ai, ãi) | i ≥ −2} ∪ {(bj , b̃j) | j ≥ −2}. Then, for every (x, y), (x′, y′) ∈ τ , |dk(x, x′)− uk(y, y′)| ≤ δk.\nNow, let us see that ukCL(a−2, b−2) = 1 + (k)ε + δk for every k ≥ 1. For t < 12 , θCL(t) = {a−2, ..., ak, b−2, ..., bk}. For 1 2 ≤ t < 1, it is trivial to check that a−2 is merged with a−1 and b−2 is merged with b−1. Therefore, θCL(t) = {{a−2, a−1}, a0, ..., ak, {b−2, b−1}, b0, ..., bk}.\nFor t = 1, notice that `CL(a0, {a−2, a−1}) = 1 = `CL(b0, {b−2, b−1}) while `CL({a−2, a−1}, {b−2, b−1}) = 1 + δk > 1. The rest of maximal distances between blocks are also greater than 1. Thus, for every 1 ≤ t < 1 + εk, θCL(t) = {{a−2, a−1, a0}, a1, ..., ak, {b−2, b−1, b0}, b1, ..., bk}.\nSuppose that for some 1 ≤ m < k and for every 1 + (m− 1)εk ≤ t < 1 +mεk we have that θCL(t) = {{a−2, ..., am−1}, am, ..., ak, {b−2, ..., bm−1}, bm, ..., bk}. Again, `CL(am, {a−2, ..., am−1}}) = 1 + mεk, `CL(bm, {b−2, ..., bm−1}) = 1 + mεk and `CL({a−2, ..., am−1}, {b−2, ..., bm−1}) = 1+mεk+δk. The rest of maximal distances between blocks are also greater than 1+mεk. Therefore, for every 1+mεk ≤ t < 1+ (m+1)εk we have that θCL(t) = {{a−2, ..., am}, am+1, ..., ak, {b−2, ..., bm}, bm+1, ..., bk}.\nThus, ukCL(a−2, b−2) = 1+kε+δk = 1+k 1 2(k+1)+ 1 k+1 > 3 2 while uk(ã−2, b̃−2) = 1.\nNotation: Given two metrics d, d′ defined on a set X, let us denote d ≤ d′ if d(x, x′) ≤ d′(x, x′) ∀x, x′ ∈ X.\nGiven a HC method T = (`, ∅), let us recall the notations: TD(X, d) = θX and TU (X, d) = (X,uX).\nDefinition 4.9. A HC method T = T(`, ∅) is normal if for every metric space, X, and ∀B1, B2 ∈ θX(t), then `(B1, B2) ≤ `CL(B1, B2) and uX ≥ uSL.\nLemma 4.10. uX ≥ uSL if and only if ∀ B ∈ θX(t), B is t-connected.\nProof. If uX ≥ uSL, it is immediate to check that ∀x, y ∈ X, if uX(x, y) ≤ t, uSL(x, y) ≤ t and x, y are in the same t-component.\nLet x, y ∈ X such that uX(x, y) = t. Then, there exist some B ∈ θX(t) such that x, y ∈ B. If ∀ B ∈ θX(t), B is t-connected, then B is contained in some block of θSL(t). Therefore, uSL(x, y) ≤ t.\nLemma 4.11. Let T = T(`, ∅) be such that for every metric space, X, and any t > 0, ∀B1, B2 ∈ θX(t), `(B1, B2) ≤ `CL(B1, B2). Then, ∀ t > 0 and every B1, B2 ∈ θX(t), max{d(x, y) |x ∈ B1, y ∈ B2} > t.\nProof. Let ki := max{kr ≤ t : kr ∈ ∆(X,uX)}. Then, B1, B2 are blocks in θX(t) = θX(ki).\nIf max{d(x, y) |x ∈ B1, y ∈ B2} ≤ t, then `(B1, B2) ≤ `CL(B1, B2) ≤ t. Therefore, B1 ∼`,t B2 which contradicts the fact that B1, B2 are blocks in θX(t).\nHence, max{d(x, y) |x ∈ B1, y ∈ B2} > t.\nLemma 4.12. Let (X, d) be a finite metric space with ∆(X, d) = {ti : 0 ≤ i ≤ n} and (U, u) be an ultrametric space with dGH((X, d), (U, u)) < δ 2 . Let T = T(`, ∅) be a normal HC method. Given x, x′ ∈ X with d(x, x′) = ti, if uX(x, x′) > tj−1 ≥ ti, then tj ≤ tj−1 + 2δ.\nProof. Let B1, B2 ∈ θX(tj−1) with x ∈ B1 and x′ ∈ B2. Let kr ∈ ∆(TU (X, d)) be such that kr−1 ≤ tj−1 < kr. Then, θX(tj−1) = θX(kr−1).\nLet a ∈ B1 and a′ ∈ B2 with d(a, a′) = max{d(x, y) |x ∈ B1, y ∈ B2}. Since B1, B2 are different blocks in θX(tj−1), by Lemma 4.11, d(a, a\n′) > tj−1 ≥ kr−1 and d(a, a′) ≥ tj .\nLet τ be a correspondence such that sup(z,u)(z′,u′)∈τ ΓX,U (z, u, z ′, u′) < δ and let (a, b), (a′, b′), (x, y), (y, y′) ∈ τ . See Figure 3. By Lemma 4.10, every block in θX(tj−1) is tj−1-connected and there exist tj−1-chains in (X, d) from a to x and from a′ to x′. Since d(x, x′) = ti ≤ tj−1, there is a tj−1-chain from a to a′.\nTherefore, since sup(z,u)(z′,u′)∈τ ΓX,U (z, u, z ′, u′) < δ, there is a (tj−1 + δ)-chain from b to b′. By the properties of the ultrametric, this implies that u(b, b′) ≤ tj−1+δ and, therefore, d(a, a′) ≤ tj−1 + 2δ.\nSince uX(x, x ′) ≥ kr, then tj−1 < kr ≤ `(B1, B2) ≤ d(a, a′) < tj−1 + 2δ. In\nparticular, tj < tj−1 + 2δ.\nThe following proposition is a particular case of Theorem 4.15. We include this proposition and the proof of this particular case because we feel that it may help to clarify the proof of the theorem.\nProposition 4.13. Let (U, u) be an ultrametric space such that ∆(U, u) is finite (in particular, if (U, u) is a finite ultrametric space). Let T = (`, ∅) be any normal standard linkage-based HC method. Then, for any sequence of finite metric spaces ((Xk, dk))k∈N in (M, dGH) such that limk→∞(Xk, dk) = (U, d) ∈ U , limk→∞ TU (Xk, dk) = (U, d).\nProof. Let ∆(U, u) = {u0, ..., up} and let 0 < ε < ui−ui−1 for every 1 ≤ i ≤ p. Let δ < 14ε and suppose dGH((Xk, dk), (U, u)) < δ 2 . Then, there is a correspondence τ such that for any (x, y), (x′, y′) ∈ τ , |dk(x, x′)− u(y, y′)| < δ. Let TU (Xk, dk) = (Xk, uk) and TD(Xk, dk) = θk. Claim: u(y, y′) ≤ uk(x, x′) + δ < uk(x, x′) + ε. Let uk(x, x\n′) = kr ∈ ∆(Xk, uk). Then, there exist B0, B1, ..., Bn ∈ θk(kr−1) with x ∈ B0, x′ ∈ Bn and `(Bj−1, Bj) ≤ kr for every 1 ≤ j ≤ n. By Lemma 4.10 each Bj is (kr−1)-connected. Then, there is a kr-chain in (Xk, dk) from x\nθX(tj-1)\nto x′: x = x0, ..., xn = x ′. Let (xj , yj) ∈ R for every 0 ≤ j ≤ n. Then, since |dk(xj−1, xj) − u(yj−1, yj)| < δ, y = y0, ..., yn = y′ is a (kr + δ)-chain in (U, u). Since (U, u) is ultrametric, this implies that u(y, y′) ≤ kr + δ.\nClaim: uk(x, x ′) ≤ u(y, y′) + ε.\nLet (x, y), (x′, y′) ∈ R. Let dk(x, x′) = ti and u(y, y′) = t. We already know that |ti − t| < δ.\nIf uk(x, x ′) ≤ ti, then uk(x, x′) ≤ dk(x, x′) ≤ u(y, y′) + δ and we are done. Suppose uk(x, x ′) = kr ∈ [ti+m−1, ti+m) with m ≥ 1. By Lemma 4.12, for every 1 ≤ k ≤ m, ti+k − ti+k−1 ≤ 2δ. For every i ≤ j < i+m, consider Btj1 , B tj 2 ∈ θk(tj) with x ∈ B tj 1 , x\n′ ∈ Btj2 and let aj ∈ B tj 1 and a ′ j ∈ B tj 2 with dk(aj , a ′ j) = max{dk(x, y) |x ∈ B tj 1 , y ∈ B tj 2 }. The situation is the same from Lemma 4.12, see Figure 3. Let (aj , bj), (a ′ j , b ′ j) ∈ R. Hence, for every i ≤ j < i+m, dk(aj+1, a′j+1)− dk(aj , a′j) ≤ tj + 2δ − tj = 2δ. Therefore, u(bj+1, b ′ j+1)− u(bj , b′j) ≤ 4δ. Since 4δ < ε, it follows that u(bj+1, b′j+1) = u(bj , b′j) for every i ≤ j < i + m. Then, d(ai+m, a′i+m) − d(ai, a′i) ≤ 2δ and uk(x, x′) ≤ ti + 2δ ≤ u(y, y′) + 3δ < u(y, y′) + ε proving the claim.\nIn the previous proposition it is possible to eliminate the condition on the ultrametric space. The main idea of the proof is the same in spite of some technical difficulties.\nLemma 4.14. Let (X, d) be a finite metric space, (U, u) be an ultrametric space and let ε > 0. If dGH((X, d), (U, u)) < ε 2 , then ∆(U, u) has a finite number of distances greater than ε.\nProof. Suppose dGH((Xk, dk), (U, u)) < ε 2 . Then, there is a correspondence τ such that for any (x, y), (x′, y′) ∈ τ , |dk(x, x′) − u(y, y′)| < ε. Since Xk is finite, let Xk = {x1, ..., xn} and let (xi, yi) ∈ τ . Then, {B(yi, ε) | 1 ≤ i ≤ n} defines a finite covering of U . Therefore, by the properties of the ultrametric, ∆(U, u) has a finite number of distances greater than γ.\nTheorem 4.15. Every normal, faithful, standard linkage-based HC method, T = (`, ∅), is semi-stable in the Gromov-Hausdorff sense.\nProof. By Lemma 4.14, since limk→∞(Xk, dk) = (U, u) with Xk finite, ∆≥ε(U, u) = {u(x, y) |x, y ∈ U with u(x, u) ≥ ε} is a finite set for every ε > 0.\nLet ε > 0. Let ∆≥ ε2 (U, u) = {l0, l1, ..., lp} with li < lj for every i < j. Let 0 < δ < 14 min1≤j≤m{lj − lj−1} and suppose also that 0 < δ < ε 12 .\nLet (Xk, dk) be such that dGH((Xk, dk), (U, u)) < δ 2 . Then, since T is faithful, it suffices to check that dGH(TU (Xk, dk), (U, u)) < ε. Let τ be a correspondence such that ∀ (x, y), (x′, y′) ∈ τ , |d(x, x′)−u(y, y′)| < δ. Let TU (Xk, dk) = (Xk, uk) and TD(Xk, dk) = θk. Claim: u(y, y′) ≤ uk(x, x′) + δ < uk(x, x′) + ε. This claim is proved by the same argument used in Proposition 4.13. Let uk(x, x\n′) = kr ∈ ∆(Xk, uk). Then, there exist B0, B1, ..., Bn ∈ θk(kr−1) with x ∈ B0, x′ ∈ Bn and `(Bj−1, Bj) ≤ kr. By Lemma 4.10 Bj is (kr−1)-connected. Then, there is a kr-chain in (Xk, dk) from x to x ′: x = x0, ..., xn = x ′. Let (xj , yj) ∈ τ for every 0 ≤ j ≤ n. Then, since |dk(xj−1, xj) − u(yj−1, yj)| < δ, y = y0, ..., yn = y\n′ is a (kr + δ)-chain in (U, u). Since (U, u) is ultrametric, this implies that u(y, y′) ≤ kr + δ.\nClaim: uk(x, x ′) ≤ u(y, y′) + ε. Let (x, y), (x′, y′) ∈ τ . Let d(x, x′) = ti and u(y, y′) = t. Then, |ti − t| < δ. If uk(x, x\n′) ≤ ti we are done since uk(x, x′) ≤ d(x, x′) ≤ u(y, y′) + δ. Then, suppose uk(x, x\n′) = kr ∈ [ti+m−1, ti+m) with m ≥ 1. By Lemma 4.12, for every 1 ≤ k ≤ m, ti+k − ti+k−1 ≤ 2δ.\nIf ti ≥ ε2 + δ, consider for every i ≤ j < i + m, as in the proof of Lemma 4.12, B tj 1 , B tj 2 ∈ θk(tj) with x ∈ B tj 1 , x ′ ∈ Btj2 and let aj ∈ B tj 1 and a ′ j ∈ B tj 2 with d(aj , a ′ j) = max{d(x, y) |x ∈ B tj 1 , y ∈ B tj 2 }. Let (aj , bj), (a′j , b′j) ∈ τ . Hence, for every i ≤ j < i + m, d(aj+1, a′j+1) − d(aj , a′j) ≤ tj + 2δ − tj = 2δ. Therefore, u(bj+1, b ′ j+1)−u(bj , b′j) ≤ 4δ. Since u(bj , b′j) > tj − δ > ε2 and 4δ < min1≤j≤m{lj − lj−1}, then u(bj+1, b′j+1) = u(bj , b′j) for every j. Thus, d(ai+m, a′i+m)− d(ai, a′i) ≤ u(bi+m, b ′ i+m)− u(bi, b′i) + 2δ = 2δ and uXk(x, x′) ≤ ti + 2δ ≤ u(y, y′) + 3δ proving the claim. Finally, if ti < ε 2 + δ, then, either uXk(x, x\n′) ≤ ε and we are done or, by Lemma 4.12, there is some ti < tk ∈ ( ε2 +δ, ε 2 +3δ). Consider, as above, for every k ≤ j < i+ m the pairs (aj , a ′ j) with d(aj+1, a ′ j+1)−d(aj , a′j) ≤ 2δ, (aj , bj), (a′j , b′j) ∈ τ . Hence, as above, u(bk+m, b ′ k+m) = u(bk, b ′ k) for every j and d(ak+m, a ′ k+m)−d(ak, a′k) ≤ 2δ. Therefore, uXk(x, x ′) ≤ tk + 2δ ≤ ε2 + 5δ < ε proving the claim.\nCorollary 4.16. TCL is semi-stable in the Gromov-Hausdorff sense.\nCorollary 4.17. TAL is semi-stable in the Gromov-Hausdorff sense.\nThe proof of Theorem 4.15 can be adapted to prove that SL(α) is also semistable. First, let us see that the analogue to Lemma 4.12 also works for SL(α).\nLemma 4.18. Let (X, d) be a finite metric space with ∆(X, d) = {t0 < · · · < tn} and (U, u) be an ultrametric space with dGH((X, d), (U, u)) < δ 2 . Let T SL(α) D (X, d) = θα and T SL(α) U (X, d) = uα for any α ≥ 1. Given x, x′ ∈ X with d(x, x′) = ti, if uα(x, x ′) > tj−1 ≥ ti, then tj ≤ tj−1 + 2δ.\nProof. Let B1, B2 ∈ θα(tj−1) with x ∈ B1 and x′ ∈ B2. Let a ∈ B1 and a′ ∈ B2 with d(a, a′) = max{d(x, y) |x ∈ B1, y ∈ B2}. Then, it follows from the construction of θα(tj−1) that d(a, a ′) ≥ tj > tj−1. Suppose that d(a, a′) ≤ tj−1. Then, let Ba, Ba′ two blocks in θα(tj−2) such that a ∈ Ba, a′ ∈ Ba′ . Clearly, `SL(Ba, Ba′) ≤ tj−1 and, since Ba ⊂ B1 and Ba′ ⊂ B2, then d(a, a′) = max{d(x, y) |x ∈ B1, y ∈ B2} ≥ max{d(x, y) |x ∈ Ba, y ∈ Ba′}. Therefore, Ftj−1(Ba ∪ Ba′) has dimension ](Ba ∪ Ba′) − 1 ≥ min{dim(Ftj−1(Ba)), dim(Ftj−1(Ba′))}. Therefore, Ba andBa′ are merged in θα(tj−1) for any α ≥ 1 and a, a′ are contained in the same block in θα(tj−1) which is a contradiction.\nLet τ be a correspondence such that sup(z,u)(z′,u′)∈τ ΓX,U (z, u, z ′, u′) < δ and let (a, b), (a′, b′), (x, y), (y, y′) ∈ τ . See Figure 3. It is immediate to see that every block in θα(tj−1) is tj−1-connected and there exist tj−1-chains in (X, d) from a to x and from a′ to x′. Since d(x, x′) = ti ≤ tj−1, there is a tj−1-chain from a to a′.\nTherefore, there is a (tj−1 + δ)-chain from b to b ′. By the properties of the ultrametric, this implies that u(b, b′) ≤ tj−1 + δ and, hence, d(a, a′) ≤ tj−1 + 2δ. In particular, tj−1 < tj ≤ d(a, a′) ≤ tj−1 + 2δ.\nProposition 4.19. TSL(α) is semi-stable in the Gromov-Hausdorff sense.\nProof. By Lemma 4.14, since limk→∞(Xk, dk) = (U, u) with Xk finite, ∆≥ε(U, u) = {u(x, y) |x, y ∈ U with u(x, u) ≥ ε} is a finite set for every ε > 0.\nLet ε > 0. Let ∆≥ ε2 (U, u) = {l0, l1, ..., lp} with li < lj for every i < j. Let 0 < δ < 14 min1≤j≤m{lj − lj−1} and suppose also that 0 < δ < ε 12 . Let (Xk, dk) be such that dGH((Xk, dk), (U, u)) < δ 2 . Then, since SL(α) is faithful, it suffices to check that dGH(TU (Xk, dk), (U, u)) < ε. Let τ be a correspondence such that ∀ (x, y), (x′, y′) ∈ τ , |d(x, x′)−u(y, y′)| < δ. Let T\nSL(α) U (Xk, dk) = (Xk, uk) and T SL(α) D (Xk, dk) = θk.\nClaim: u(y, y′) ≤ uk(x, x′) + δ < uk(x, x′) + ε. Let uk(x, x\n′) = kr ∈ ∆(Xk, uk). Then, there exist B0, B1, ..., Bn ∈ θk(kr−1) with x ∈ B0, x′ ∈ Bn and `SL(Bj−1, Bj) ≤ kr. By Lemma 4.10 Bj is (kr−1)connected. Then, there is a kr-chain in (Xk, dk) from x to x ′: x = x0, ..., xn = x ′. Let (xj , yj) ∈ τ for every 0 ≤ j ≤ n. Then, since |dk(xj−1, xj) − u(yj−1, yj)| < δ, y = y0, ..., yn = y\n′ is a (kr + δ)-chain in (U, u). Since (U, u) is ultrametric, this implies that u(y, y′) ≤ kr + δ.\nClaim: uk(x, x ′) ≤ u(y, y′) + ε. Let (x, y), (x′, y′) ∈ τ . Let d(x, x′) = ti and u(y, y′) = t. Then, |ti − t| < δ. If uk(x, x\n′) ≤ ti we are done since uk(x, x′) ≤ d(x, x′) ≤ u(y, y′) + δ. Then, suppose uk(x, x\n′) = kr ∈ [ti+m−1, ti+m) with m ≥ 1. By Lemma 4.18, for every 1 ≤ k ≤ m, ti+k − ti+k−1 ≤ 2δ.\nIf ti ≥ ε2 + δ, consider for every i ≤ j < i + m, B tj 1 , B tj 2 ∈ θk(tj) with x ∈ B tj 1 ,\nx′ ∈ Btj2 and let aj ∈ B tj 1 and a ′ j ∈ B tj 2 with d(aj , a ′ j) = max{d(x, y) |x ∈ B tj 1 , y ∈ B tj 2 }. Let (aj , bj), (a′j , b′j) ∈ τ . Hence, for every i ≤ j < i + m, d(aj+1, a′j+1) − d(aj , a ′ j) ≤ tj + 2δ − tj = 2δ. Therefore, u(bj+1, b′j+1) − u(bj , b′j) ≤ 4δ. Since u(bj , b ′ j) > tj − δ > ε2 and 4δ < min1≤j≤m{lj − lj−1}, then u(bj+1, b ′ j+1) = u(bj , b ′ j) for every j. Thus, d(ai+m, a ′ i+m) − d(ai, a′i) ≤ u(bi+m, b′i+m) − u(bi, b′i) + 2δ = 2δ and uXk(x, x ′) ≤ ti + 2δ ≤ u(y, y′) + 3δ proving the claim.\nFinally, if ti < ε 2 + δ, then, either uXk(x, x ′) ≤ ε and we are done or, by Lemma 4.18, there is some ti < tk ∈ ( ε2 +δ, ε 2 +3δ). Consider, as above, for every k ≤ j < i+ m the pairs (aj , a ′ j) with d(aj+1, a ′ j+1)−d(aj , a′j) ≤ 2δ, (aj , bj), (a′j , b′j) ∈ R. Hence, as above, u(bk+m, b ′ k+m) = u(bk, b ′ k) for every j and d(ak+m, a ′ k+m)−d(ak, a′k) ≤ 2δ. Therefore, uXk(x, x ′) ≤ tk + 2δ ≤ ε2 + 5δ < ε proving the claim.\n5. Stability of HC methods.\nDefinition 5.1. A HC method T is stable in the Gromov-Hausdorff sense if\nTU : (M, dGH)→ (U , dGH) is continuous.\nThus, SL HC is stable in the Gromov-Hasudorff sense. Notation: Let H(T, ε) be the set of finite metric spaces, (X, d), such that θX(ε) has exactly two blocks, where θX = TD(X, t). In particular, H(TSL, ε) denotes the set of finite metric spaces with exactly two ε-components.\nNotation: Let I(a1, ..., an) denote the isometry type of the finite metric space defined by the points {p̄0, p̄1, ..., p̄n} where d(p̄i, p̄j) = ai+1 + · · ·+aj for every i < j (this is, the isometry type of the set {0, a1, a1 + a2, ..., a1 + a2 + · · ·+ an} ⊂ R with the euclidean metric). See Figure 4. In particular,\nI(R) = ( {p̄0, p̄1}, ( R 0 0 R )) Example 5.2. TAL and TCL are not stable in the Gromov-Hausdorff sense.\nConsider (X, d) = I(1, 1) and (Y, d′) = I(1, 1 + δ) with δ > 0 arbitrarily small. First, notice that dGH((X, d), (Y, d\n′)) = δ. It is immediate to check that TALU (X) = T CL U (X) = (X,u) with X = {x1, x2, x3}\nand u(xi, xj) = 1 for every i 6= j. Let TALU (Y ) = (Y, u1) and T CL U (Y ) = (Y, u2). Now, Y = {y1, y2, y3}, u1(y1, y2) = 1 and u1(y1, y3) = u1(y2, y3) = 3+2δ\n2 . Also, u2(y1, y2) = 1 and u2(y1, y3) = u2(y2, y3) = 2 + δ.\nThus, it can be seen that dGH(T AL U (X, d),T AL U (Y, d ′)) = 1+2δ4 > 1 4 . Similarly,\ndGH(T CL U (X, d),T CL U (Y, d ′)) = 2+δ2 > 1. Therefore, AL and CL are not stable.\nDefinition 5.3. Let T = T(`;P ) be a HC method. We say that P is nontrivial for ` if there exists some metric space (X, d) such that for TD(X, d) = θ and for some ε > 0, θ(ε) = {B1, B2}, `(B1, B2) = R > ε and {B1, B2} does not satisfy P for R.\nRemark 5.4. For any HC method T = T(`SL;P ), P is nontrivial for `SL if there exists some metric space (X, d) with two ε-components B1, B2, such that `SL(B1, B2) = R > ε and {B1, B2} does not satisfy P for R.\nLet (X, d0) be any metric space and B1, B2 a non-trivial partition of X (this is, X = B1 ∪B2 with B1 ∩B2 = ∅ and B1, B2 6= ∅). Let R > 0 and let\n(3) ΓB1,B2R : [0, 1]→M\nbe defined as follows: ΓB1,B2R (0) = (X, d0), Γ B1,B2 R (1) = I(R) and for every t ∈ (0, 1), Γ(t) = (X, dt) with\ndt(x, y) =\n{ (1− t)d0(x, y) if x, y ∈ B1 or x, y ∈ B2\n(1− t)d0(x, y) + tR if x ∈ B1, y ∈ B2 or y ∈ B1, x ∈ B2\nProposition 5.5. ΓB1,B2R is well defined.\nProof. Let us see that dt is a metric for every t ∈ (0, 1). It suffices to check that the triangle inequality holds for every t ∈ (0, 1). Let x, y, x ∈ X. We know that d(x, z) ≤ d(x, y) + d(x, z).\nIf x, z are in the same block, Bi, then it is trivial to see that dt(x, z) = (1 − t)d(x, z) ≤ (1− t)[d(x, y) + d(y, z)] ≤ dt(x, y) + dt(x, z).\nIf x, z are not in the same block, then dt(x, z) = (1 − t)d(x, z) + tR ≤ (1 − t)[d(x, y) + d(y, z)] + tR = dt(x, y) + dt(x, z).\nHence, triangle inequality holds.\nProposition 5.6. ΓB1,B2R : [0, 1] → (M, dGH) is continuous (with the euclidean metric on [0, 1]).\nProof. First, let us see that ΓB1,B2R is continuous on [0, 1).\nFor any s1, s2 ∈ [0, 1), consider the correspondence defined by the identity: τ = {(x, x) |x ∈ X}. Then, |ds1(x, y)−ds2(x, y)| ≤ |(s2−s1)d(x, y)|+|(s2−s1)R| = |s2 − s1|(d(x, y) +R).\nThen, if |s2 − s1| < γ, dGH((X, ds1), (X, ds2)) ≤ 12 |s2 − s1|(d(x, y) + R) ≤ γ diam(X,d)+R2 . Thus, ∀ δ > 0 and for any γ ≤ 2δ diam(X)+R , if |s2 − s1| < γ, then dGH((X, ds1), (X, ds2)) ≤ δ. To check the continuity of ΓB1,B2R at t = 1 consider the correspondence τ\n′ = {(B1, p̄0)∪ (B2, p̄1)}. Then, if x, y are in the same block Bi, |dt(x, y)−d1(p̄i, p̄i)| = (1−t)d(x, y) ≤ (1−t)diam(X). If x, y are in different blocks, |dt(x, y)−d1(p̄0, p̄1)| = |(1 − t)d(x, y) + tR − R| ≤ (1 − t)[d(x, y) + R] ≤ (1 − t)[diam(X) + R]. Thus, dGH((X, dt), I(R)) ≤ (1 − t)diam(X)+R2 . Hence, for any δ > 0, if 1 − 2δ diam(X)+R < t < 1, then dGH((X, dt), IR) ≤ δ. Therefore, ΓB1,B2R is continuous.\nDefinition 5.7. Let ` be a linkage function. We say that a ` is Γ-regular if given any finite metric space (X, d0) and any non-trivial partition of X, B1, B2, with `(B1, B2) = R, then `R,dt(B1, B2) = R for every t ∈ [0, 1) where `R,dt denotes the linkage function ` when it is applied to a pair of blocks in ΓB1,B2R (t) = (X, dt).\nProposition 5.8. `SL, `CL and `AL are Γ-regular.\nProof. In the case of `SL it is immediate to check that the minimal distance, R, between B1 and B2 is constant on Γ B1,B2 R by construction.\nThe case of `CL is also trivial since the maximal distance, R, between B1 and\nB2 is constant on Γ B1,B2 R by construction. Consider any nontrivial partitionB1, B2 of (X, d0). LetR = ∑ (x,x′)∈B1×B2 d0(x,x ′)\n#(B1)·#(B2) .\nNow, for any t ∈ [0, 1],\n`R,dt(B1, B2) =\n∑ (x,x′)∈B1×B2 dt(x, x ′)\n#(B1) ·#(B2) =\n∑ (x,x′)∈B1×B2 [(1− t)d0(x, x ′) + tR]\n#(B1) ·#(B2) = = (1− t) ∑ (x,x′)∈B1×B2 d0(x, x ′)\n#(B1) ·#(B2) + tR = (1− t)R+ tR = R.\nDefinition 5.9. A linkage function ` is scale preserving if for any space X, any pair of disjoint blocks, A,B ⊂ X, and any pair of metrics, d, d′, on X such that for some α > 0, d′(x, y) = α · d(x, y) ∀x, y ∈ X, then `d′(A,B) = α · `d(A,B).\nRemark 5.10. It is immediate to check that `SL, `CL and `AL are scale preserving.\nLemma 5.11. Let T = T(`, ∅) with ` scale preserving. Let (X, d) be a metric space, α > 0 and let (X, d′) be such that d′(x, y) := α · d(x, y). Let TD(X, d) = θ and TD(X, d ′) = θ′. Then, θ(t) = θ′(α · t).\nProof. In the recursive formulation of T, let us denote by ΘRi the partitions built for θ and by Θ′R′i the partitions built for θ′. Clearly, Θ0 = Θ ′ 0. Suppose that R′i−1 = α · Ri−1 and ΘRi−1 = Θ′R′i−1 = {B1, ..., Bk}. Since ` is scale preserving, it is immediate to check that `d(Bj1 , Bj2) = α · `d′(Bj1 , Bj2) for every 1 ≤ j1, j2 ≤ n. Therefore, R′i = α · Ri and ΘRi = Θ′α·Ri . Thus, by induction on i, it follows that θ(t) = θ′(α · t) ∀ t ≥ 0.\nLemma 5.12. Let T = T(`, ∅), let (X, d) be a metric space and let TD(X, d) = θ. Suppose θ(ε) = {B1, ..., Bn} and let (X, d′) be such that d′(x, y) = d(x, y) if x, y ∈ Bj for any 1 ≤ j ≤ n and d′(x, y) ≥ d(x, y) for every (x, y) ∈ Bi × Bj with i 6= j. Then, if TD(X, d\n′) = θ′, θ′(t) = θ(t) for every t ≤ ε. Proof. Since linkage functions are representation independent and monotonic, for every A,B ⊂ Bj , `d(A,B) = `d′(A,B) and for every (A,B) ⊂ Bi ×Bj , `d(A,B) ≤ `d′(A,B).\nThen, let us apply induction on the construction of the dendrograms. Clearly, R0 = 0 = R ′ 0 and Θ1 = Θ ′ 1. Suppose R ′ 0 = R0, ..., R ′ i−1 = Ri−1 and Θ ′ i = Θi = {C1, ..., Ck}. Then, since θ(ε) = {B1, ..., Bn}, if `d(Cr, Cs) = min{`(C,C ′) |C,C ′ ∈ Θi, C 6= C ′} ≤ ε, C,C ′ are both contained in the same blockBj . Then, `d′(Cr, Cs) = `d(Cr, Cs), R ′ i = Ri and Θ ′ i+1 = Θi+1. Therefore, θ ′(t) = θ(t) for every t ≤ ε.\nDefinition 5.13. Let P be an unchaining condition and ` be a linkage function. We say that P is consistent for ` if the following implication holds.\nLet (X, d) be any metric space and B1, B2 any nontrivial partition of X with `d(B1, B2) = R and such that {B1, B2} does not satisfy P for R in (X, d).\nLet (X, d′) be such that d′(x, y) := d(x, y) for every x, y ∈ B1 and for every x, y ∈ B2, and d′(x, y) > d(x, y) for every x, y ∈ B1 ×B2.\nThen, if `d′(B1, B2) = R ′, B1, B2 does not satisfy P for R ′ in (X, d′).\nLemma 5.14. Let T(`;P ) be an almost-standard linkage-based HC method such that P is nontrivial and consistent for `. Let (X, d) be a metric space such that, for TD(X, d) = θ, θ(ε) = {B1, B2}, `d(B1, B2) = R > ε and {B1, B2} does not satisfy P for R. Suppose that #(X) is the minimal cardinal for which there exists such a metric space. Then, for any metric space (X ′, d′) with #(X ′) < #(X), if TD(X\n′, d′) = θ′ and θ′(ε′) = {B′1, B′2} with `d′(B′1, B′2) = R′, then {B′1, B′2} satisfies P for R′.\nProof. Since #(X) is minimal, if R′ > ε we are done. Let R′ ≤ ε. Suppose that {B′1, B′2} does not satisfy P for R′ and suppose that #(X ′) is also minimal so that there is a pair of blocks which do not satisfy P . By the properties of linkage functions, there is a metric d′′ such that it extends d′ on B′1 and B ′ 2 and such that `d′′(B ′ 1, B ′ 2) = R\n′′ > ε′. Since #(X ′) is minimal, P does not apply in the construction of the dendrogram θ′(t) for t ≤ ε. Therefore, if TD(X\n′, d′′) = θ′′, then by Lemma 5.12, θ′′(ε′) = {B′1, B′2}. Now, since P is consistent for `, {B′1, B′2} does not satisfy P for R′′ > ε′ which contradicts the minimality of #(X).\nDefinition 5.15. We say that an almost-standard linkage-based HC method T(`;P ) is admissible if the following conditions hold:\n• ` is Γ-regular and scale preserving, • P is nontrivial and consistent for `, • TU (I(R)) = I(R).\nRemark 5.16. Let T(`;P ) be an almost-standard linkage-based HC method such that ` is `SL, `CL or `AL. Then, by 5.8 and 5.10, T is admissible if P is nontrivial and consistent for ` and TU (I(R)) = I(R).\nProposition 5.17. Let T = T(`;P ) be any admissible almost-standard linkagebased HC method. Then, there are constants ε,R ∈ R such that for every δ > 0 there exists a pair metric spaces (Z, d), (Z ′, d′) holding the following conditions:\n• θ(ε) = {C1, C2}, where θ = TD(Z, d), • θ′(ε) = {C ′1, C ′2}, where θ′ = TD(Z ′, d′), • `(C1, C2) = `(C ′1, C ′2) = R > ε • dGH((Z, d), (Z ′, d′)) < δ, • {C1, C2} does not satisfy P for R i.e. C1 6∼R C2 • {C ′1, C ′2} satisfies P for R i.e. C ′1 ∼R C ′2\nProof. Since condition P is nontrivial for `, there exists some metric space (X, d0) such that, for TD(X, d0) = θ0, θ0(ε) = {B1, B2}, `(B1, B2) = R > ε and {B1, B2} does not satisfy P for R. Suppose that, given P , #(X) is the minimal cardinal for which there exists a metric space holding these conditions.\nLet Γ := ΓB1,B2R : [0, 1]→M be defined as in (3). As we proved in Proposition 5.6, Γ is a path in M. Now, let us see that Γ is a path in H(T, ε) from (X, d0) to I(R). Since ` is Γ-regular, `R,dt(B1, B2) = R > ε. Let us see that θt(ε) = {B1, B2} for every t ∈ (0, 1). First, notice that since #(X) is minimal, by Lemma 5.14, if we apply the algo-\nrithm on X with any metric, every pair of blocks satisfies P as long as the pair of blocks involved do not include all the points in X.\nLet (X, d′) := (X, (1− t)d0). Since ` is scale preserving, θ′((1− t)r) = θ(r) where θ′ = TD(X, d\n′). In particular, θ′((1− t)ε) = {B1, B2}. Then, let us see that θt(r) = θ\n′(r) for every r ≤ (1− t)ε where θXt = TD(X, dt). Let Θi denote the partitions defined in the construction of θt and Θ ′ i denote the partitions defined in the construction of θ′. Clearly, Θ0 = Θ ′ 0. Suppose Θi−1 = Θ′i−1 = {V1, ..., Vn} with V1 ∪ · · ·Vk = B1 and Vk+1 ∪ · · ·Vn = B2. Let R′i−1 := min{`d′(V, V ′) |V, V ′ ∈ Θ′i, V 6= V ′} and assume R′i−1 ≤ (1− t)ε. Notice that since θ′((1− t)ε) = {B1, B2}, if `d′(V, V ′) = R′i−1, then V, V ′ are in the same block, B1 or B2. Now, since ` is monotonic (by definition), `dt(V, V ′) = `d′(V, V ′) if V, V ′ are in the same block, B1 or B2, and `dt(V, V ′) ≥ `d′(V, V ′) if V ⊂ B1 and V ′ ⊂ B2. Therefore, Ri−1 = R ′ i−1 and Θi = Θ ′ i. Hence, it follows that θt(r) = θ\n′(r) for every r ≤ (1− t)ε. In particular, θt((1− t)ε) = {B1, B2}.\nThus, since `R,dt(B1, B2) = R > ε, θt(ε) = {B1, B2} for every t ∈ (0, 1). Since T is admissible, if TD(IR) = θ1, θ1(t) has two blocks {p̄0}, {p̄1} for every t < R. Then, Γ(t) ∈ H(T, ε) for every t ∈ [0, 1]. Since Γ is a path inH(T, ε), for every γ there exist s1, s2 ∈ [0, 1] with |s2−s1| < γ such that γ(s1) = (X, ds1) has two blocks C1 := B1, C2 := B2 with C1 6∼R C2 and Γ(s2) = (X, ds2) has two blocks C ′ 1 := B1, C ′ 2 := B2 with C ′ 1 ∼R C ′2.\nFinally, as we saw in the proof of Proposition 5.6, taking γ < 2δdiam(X,d)+R ,\ndGH((X, ds1), (X, ds2)) < δ.\nDefinition 5.18. We say that a pair of t-components B1, B2 in (X, d) are (t, R)bridged by a single edge if there exist b1 ∈ B1, b2 ∈ B2 such that d(b1, b2) = R > t and for every (b1, b2) 6= (x, y) ∈ B1 × B2, d(x, y) > R. If the constants t, R are not relevant we say that B1, B2 are bridged by a single edge.\nDefinition 5.19. Given T(`SL, P ), we say that P is bridge-unchaining if there is a metric space (X, d) and a nontrivial partition B1, B2 such that B1, B2 are bridged by a single edge and {B1, B2} does not satisfy {P} for R.\nDefinition 5.20. Given T(`SL, P ), we say that P is minimally bridge-unchaining if:\n• there is a metric space (X, d) and a nontrivial partition B1, B2 such that B1, B2 are bridged by a single edge and {B1, B2} does not satisfy {P} for R, • (X, d) can be chosen so that for every metric space X ′ with #(X ′) < #(X)\nand any nontrivial partition B′1, B ′ 2 of X ′ with `SL(B1, B2) = ε, then {B′1, B′2} satisfies {P} for ε.\nProposition 5.21. For every α ≥ 1, Pα (the unchaining condition of SL(α)) is minimally bridge-unchaining.\nProof. Consider X = B1∪B2 as follows. Let B1 := {x0, ..., xα+1} with d(xi, xj) = 1 for every i 6= j and let B2 := {y0, ..., yα+1} with d(yi, yj) = 1 for every i 6= j. Suppose d(x0, y0) = 2 and d(xi, yj) > 2 for every (i, j) 6= (0, 0).\nIt is immediate to check that B1, B2 are (1, 2)-bridged by a single edge which is (x0, y0).\nNow, F2(X) has a unique simplex, ∆ = [x0, y0], intersecting B1 and B2 and dim(∆) = 1. Nevertheless, dim(F2(B1)) = dim(F2(B2)) = α + 1. Therefore, B1, B2 does not satisfy Pα for 2.\nNotice that #(X) = 2α + 4. Suppose X ′ = B′1 ∪ B′2 such that B′1, B′2 does not satisfy Pα for some R. Then, in particular, min{dim(FR(B1)), dim(FR(B2))} > α. Hence, #(B1),#(B2) > α + 1 and #(X\n′) ≥ #(X). Thus, Pα is minimally bridge unchaining.\nDefinition 5.22. We say that a HC method T(`;P ) is ordinary if TU (I(R)) = I(R), TU (I(δ,R)) = T SL U (I(δ,R)) and TU (I(δ,R, δ)) = T SL U (I(δ,R, δ)) for every δ,R > 0.\nRemark 5.23. For every α ≥ 1, SL(α) is ordinary.\nTheorem 5.24. If T(`SL;P ) is an ordinary almost-standard linkage-based HC method and P is minimally bridge-unchaining, then T is not stable in the GromovHausdorff sense.\nProof. Since P is bridge-unchaining, there exists some metric space (X, d) with two ε-components B1, B2 bridged by a single edge (b1, b2) with b1 ∈ B1, b2 ∈ B2, d(b1, b2) = R > ε and such that {B1, B2} does not satisfy P for R. Suppose that #(X) is the minimal cardinal for which there is such a pair.\nLet R = ti for some 1 ≤ i ≤ n. Then ε ≤ ti−1, B1, B2 ∈ θ(ti−1) and B1 6∼R B2. Since T is ordinary, either B1 or B2 has at least two points. Let us assume that #(B1) > 1. Let δ = min1≤i≤n{ti − ti−1} (in particular, δ ≤ t1 = minx6=x′d(x, x′)). If #(B2) = 1, let Γ: [0, 1] → (M, dGH) be such that Γ(0) = (X, d), Γ(1) = I(δ,R) and for every t ∈ (0, 1), Γ(t) = (X, dt) with\ndt(x, y) =  (1− t)d(x, y) if x, y ∈ B1\\{b1} (1− t)d(x, y) + tδ if x = b1, y ∈ B1\\{b1} or y = b1, x ∈ B1\\{b1} (1− t)d(x, y) + t(R+ δ) if x ∈ B1\\{b1}, y = b2 or y ∈ B1\\{b1}, x = b2 R if x = b1, y = b2 or y = b1, x = b2 If #(B2) > 1, let Γ: [0, 1] → (M, dGH) be such that Γ(0) = (X, d), Γ(1) =\nI(δ,R, δ) and for every t ∈ (0, 1), Γ(t) = (X, dt) with dt(x, y) =\n22 A. MARTÍNEZ-PÉREZ\n=  (1− t)d(x, y) if x, y ∈ B1\\{b1} or x, y ∈ B2\\{b2} (1− t)d(x, y) + tδ if x = b1, y ∈ B1\\{b1} or y = b1, x ∈ B1\\{b1} (1− t)d(x, y) + tδ if x = b2, y ∈ B2\\{b2} or y = b2, x ∈ B2\\{b2} (1− t)d(x, y) + t(R+ δ) if x ∈ B1\\{b1}, y = b2 or y ∈ B1\\{b1}, x = b2 (1− t)d(x, y) + t(R+ δ) if x = b1, y ∈ B2\\{b2} or y = b1, x ∈ B2\\{b2} (1− t)d(x, y) + t(R+ 2δ) if x ∈ B1\\{b1}, y ∈ B2\\{b2} or y ∈ B1\\{b1}, x ∈ B2\\{b2}\nR if x = b1, y = b2 or y = b1, x = b2\nIn either case, let us see that dt is a metric for every t ∈ [0, 1). It suffices to check that the triangle inequality holds for every t ∈ [0, 1).\nFirst, notice that given x, y, z ∈ X, since d is a metric, for every 0 ≤ t ≤ 1,\n(1− t)d(x, z) ≤ (1− t)d(x, y) + (1− t)d(y, z).\nConsider the following cases:\n• If x, z are in the same t-component Bi. Then, if bi 6∈ {x, z}, dt(x, z) = (1 − t)d(x, z) ≤ (1 − t)d(x, y) + (1 −\nt)d(y, z) ≤ dt(x, y) + dt(y, z). If bi ∈ {x, z}, dt(x, z) = (1−t)d(x, z)+tδ ≤ (1−t)d(x, y)+(1−t)d(y, z)+\ntδ = dt(x, y) + dt(y, z). • If x, z are not in the same t-component.\nThen, if {x, z} = {b1, b2}, dt(x, z) = (1− t)d(x, z)+ tR ≤ (1− t)d(x, y)+ (1− t)d(y, z) + tR < dt(x, y) + dt(y, z).\nIf {x, z} ∩ {b1, b2} = bi, i = 1, 2, dt(x, z) = (1 − t)d(x, z) + tR + tδ ≤ (1− t)d(x, y) + (1− t)d(y, z) + tR+ tδ ≤ dt(x, y) + dt(y, z).\nIf {x, z}∩{b1, b2} = ∅ dt(x, z) = (1−t)d(x, z)+tR+2tδ ≤ (1−t)d(x, y)+ (1− t)d(y, z) + tR+ 2tδ ≤ dt(x, y) + dt(y, z).\nClaim 1. Γ is a path in (M, dGH) from (X, d) to I(δ,R) or I(δ,R, δ) respectively. Consider for every t1 < t2 < 1 the correspondence induced by the identity, τ = {(x, x) |x ∈ X}. Then, for every pair of points x, y ∈ X, |dt1(x, y)−dt2(x, y)| ≤ (t2 − t1)[d(x, y) +R+ 2δ]. Hence, Γ is continuous on [0, 1).\nTo check the continuity at t = 1, consider the correspondence τ ′ given by (B1\\{b1}, p̄0) , (b1, p̄1), and (b2, p̄r) if #(B2) = 1 or (B1\\{b1}, p̄0), (b1, p̄1), (p2, p̄2) and (B2\\{b2}, p̄3) if #(B2) > 1.\nThen, given (x, a), (y, b) ∈ τ ′, in every case |dt(x, y)−d1(a, b)| ≤ (1− t)[d(x, y)+ R+ 2δ] and Γ is continuous.\nClaim 2. In either case, Γ(t) ∈ H(T, ε) for every t ∈ [0, 1]. We assumed that #(X) is the minimal cardinal for which there is a pair of blocks bridged by a single edge which does not satisfy P . Since P is minimally bridge-unchaining, this implies that #(X) is the minimal cardinal for which there is a pair of blocks which does not satisfy P . Hence, we may assume that P is always satisfied as long as the blocks involved are not a partition of X. T = TSL.\nNotice that this is the unique step where we need the assumption of being minimally bridge unchaining. Therefore, this theorem can be rewritten asking P to be bridge unchaining and any other condition that allows us to assume that condition P is satisfied in the construction of the dendrogram for every Ri ≤ ε.\nAlso, since δ ≤ t1, it is immediate to check that for every t ∈ (0, 1), dt(x, y) ≤ d(x, y) for every x, y ∈ Br with r = 1, 2. Thus, B1, B2 are ε-connected in (X, dt). Then, if TD(X, dt) = θt, and P is always satisfied for every t ≤ ε, θt(ε) = {B1, B2}.\nClaim 3. For every t ∈ [0, 1) there is no pair of points x ∈ B1, y ∈ B2 with R < dt(x, y) < R + δ. Notice that if R = ti, ti+1 ≥ R + δ and for every x ∈ B1, y ∈ B2, then either x = c1 and y = c2 with dt(x, y) = R, or d(x, y) ≥ ti+1 ≥ R+ δ and dt(x, y) ≥ (1− t)d(x, y) + t(R+ δ) ≥ R+ δ.\nSince T(`SL;P ) is an ordinary HC method, T(I(δ,R)) = TSL(I(δ,R)) and T(I(δ,R, δ)) = TSL(I(δ,R, δ)). Since #(X) is the minimal cardinal for which condition P has an effect, θt(ε) = {B1, B2} for every t ∈ [0, 1). Since Γ is continuous, for any δ1 > 0 there exist s1, s2 ∈ [0, 1] with |s2 − s1| < δ1 such that Γ(s1) = (X, ds1) has two ε-components B1, B2 with B1 6∼R B2 and Γ(s2) = (X, ds2) has two εcomponents B′1, B ′ 2 with B ′ 1 ∼R B′2. If s2 < 1 let B′1 := B1 and B′2 := B2. If s2 = 1 and Γ(1) = I(δ,R) let B ′ 1 := {p̄0, p̄1} and B′2 := {p̄2}. If s2 = 1 and Γ(1) = I(δ,R, δ) let B′1 := {p̄0, p̄1} and B′2 := {p̄2, p̄3}. Let T((X, ds1)) = (X,us1) and T((X, ds2)) = (X,us2). For every x ∈ B1, y ∈ B2, us2(x, y) = R and, since ds(x, y) 6∈ (R,R+ δ) for any s ∈ [0, 1], us1(x, y) ≥ R+ δ. Claim 4. dGH((X,us1), (X,us2)) ≥ δ2 . Suppose there is a correspondence τ ⊂ X ×X such that\n(4) sup (x,y),(x′,y′)∈τ\n|us1(x, x′)− us2(y, y′)| < δ.\nFirst, let us check that if (x, y), (x′, y′) ∈ τ and x, x′ are in the same ε-component of (X, d), then y, y′ are also in the same ε-component of (X, d). Let x = x0, ..., xn =\nx′ be a ε-chain in (X, d). Then, it is a ε-chain in (X, ds1) and, since #(C1) < #(X), condition P does not apply. Hence (B1 is a block in θs1(ε) and) us1(x, x\n′) ≤ ε = ti−1. If y, y ′ are not in the same ε-component, then us1SL(y, y ′), us2SL(y, y\n′) ≥ R = ti. Therefore, |us1(x, x′)− us2(y, y′)| ≥ ti − ti−1 ≥ δ which contradicts (4).\nLet (b1, y)(b2, y ′) ∈ τ . Let us recall that |us1(c1, c2)| = R and |us2(y, y′)| ≥ R+δ since y, y′ are in different ε-components. Hence, |us1(b1, b2)− us2(y, y′)| ≥ δ which contradicts (4).\nHence, sup(x,y),(x′,y′)∈τ |us1(x, x′) − us2(y, y′)| ≥ δ for every correspondence τ , this is, dGH((X,us1), (X,us2)) ≥ δ2 . Since Γ is continuous and s2− s1 is arbitrarily small, then dGH((X, dt1), (X, dt2)) is also arbitrarily small. Therefore, T is not stable.\nFrom Proposition 5.21 and Theorem 5.24,\nCorollary 5.25. SL(α) is not stable in the Gromov-Hausdorff sense.\n6. Discussion\nUsing some kind of metric between metric spaces and how the distance between the input determines the distance between the output is a natural way of measuring stability. One of the advantages of using Gromov-Hausdorff metric is that it allows us to measure the distance between metric spaces which do not have the same number of points and this is necessary to check the stability of a method when the input has no fixed number of points. However, we prove that if the input does not correspond to an ultrametric space, Gromov-Hausdorff stability is a rare property.\nAmong the typical linkage-based methods, only single linkage is stable. If we introduce an unchaining property, then we may say that surely the method is going to be unstable.\nWe believe that almost-standard linkage-based algorithms can be used to treat different problems related with the chaining effect. Stability is, of course, a strongly desirable property for the method. From our results, we conclude that GromovHausdorff metric is not the appropriate metric to measure the stability of an almoststandard linkage-based algorithm. Other possible metrics will be analyzed in future research.\nReferences\n[1] M. Ackerman, S. Ben-David and D. Loker. Characterization of Linkage-based Clustering.\n[2] M. Ackerman and S. Ben-David. Discerning Linkage-Based Algorithms Among Hierarchical\nClustering Methods. International Joint Conference on Artificial Intelligence (IJCAI 2011). [3] S. Ben-David, U. von Luxburg, and D. Pál. A sober look at clustering stability. In Gábor\nLugosi and Hans-Ulrich Simon, editors, COLT, volume 4005 of Lecture Notes in Computer Science, pages 5–19. Springer, (2006).\n[4] O. Bousquet and A. Elisseeff. Stability and generalization. JMLR, 2 (3), (2002) 499–526.\n[5] D. Burago, Y. Burago and S. Ivanov. A course in metric geometry. Graduate Studies in\nMathematics. 33, AMS, Providence, RI, (2001). [6] G. Carlsson and F. Mémoli. Characterization, Stability and Convergence of Hierarchical\nClustering Methods. Journal of Machine Learning Research, 11 (2010) 1425–1470. [7] G. Carlsson and F. Mémoli. Multiparameter Hierarchical Clustering Methods. Preprint. [8] M. Ester, H. Kriegel, J. Sander, X. Xu. A density-based algorithm for Discovering clusters\nin large spatial databases with noise. In Evangelos Simoudis, Jiawei Han, Usama M. Fayyad. Proceedings of the Second International Conference on Knowledge Discovery and Data Mining (KDD-96). AAAI Press. pp.226-231. ISBN 1-57735-004-9.\n[9] M. Gromov. Metric structures for Riemannian and non-Riemannian spaces. Modern\nBirkhäuser Classics. Birkhäuser Boston Inc., Boston, MA, english edition, (2007).\n[10] B. Hughes Trees and ultrametric spaces: a categorical equivalence. Advances in Mathematics, 189, (2004) 148–191.\n[11] S. Kutin and P. Niyogi. Almost-everywhere algorithmic stability and generalization error.\nTechnical report, TR-2002-03, University of of Chicago, (2002). [12] G. N. Lance and W. T. Williams. A general theory of classificatory sorting strategies 1.\nHierarchical systems. Computer Journal, 9 (4) 373–380.\n[13] A. Martinez-Perez, A. and M. A. Morón. Uniformly continuous maps between ends of R-trees. Math. Z., 263, No. 3, (2009) 583–606.\n[14] A. Mart́ınez-Pérez. A density-sensitive hierarchical clustering method. Preprint.\n[15] A. Rakhlin and A. Caponnetto. Stability properties of empirical risk minimization over donsker classes. Technical report, MIT AI Memo 2005-018, (2005).\n[16] D. Wishart. Mode analysis: a generalization of nearest neighbor which reduces chaining effects. In Numerical Taxonomy, pages (1969) 282–311. Academic Press."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2013,
    "abstractText" : "A hierarchical clustering method is stable if small perturbations on the data set produce small perturbations in the result. This perturbations<lb>are measured using the Gromov-Hausdorff metric. We study the problem of stability on linkage-based hierarchical clustering methods. We obtain that, under some basic conditions, standard linkage-based methods are semi-stable.<lb>This means that they are stable if the input data is close enough to an ultrametric space. We prove that, apart from exotic examples, introducing any unchaining condition in the algorithm always produces unstable methods.",
    "creator" : "LaTeX with hyperref package"
  }
}