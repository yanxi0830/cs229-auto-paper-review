{
  "name" : "1406.3781.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "From Stochastic Mixability to Fast Rates",
    "authors" : [ "Nishant A. Mehta", "Robert C. Williamson" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "√ n) or fast (1/n) rates of convergence of the excess risk as a function of the sample size n. There\nexist several results that give sufficient conditions for fast rates in terms of joint properties of `, F , and P, such as the margin condition and the Bernstein condition. In the non-statistical prediction with expert advice setting, there is an analogous slow and fast rate phenomenon, and it is entirely characterized in terms of the mixability of the loss ` (there being no role there for F or P). The notion of stochastic mixability builds a bridge between these two models of learning, reducing to classical mixability in a special case. The present paper presents a direct proof of fast rates for ERM in terms of stochastic mixability of (`,F ,P), and in so doing provides new insight into the fast-rates phenomenon. The proof exploits an old result of Kemperman on the solution to the general moment problem. We also show a partial converse that suggests a characterization of fast rates for ERM in terms of stochastic mixability is possible."
    }, {
      "heading" : "1 Introduction",
      "text" : "Recent years have unveiled central contact points between the areas of statistical and online learning. These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.g. from the work of Audibert (2009), and most recently Van Erven et al.’s (2012) injection of the concept of mixability into the statistical learning space in the form of stochastic mixability. It is this last connection that will be our departure point for this work.\nMixability is a fundamental property of a loss that characterizes when constant regret is possible in the online learning game of prediction with expert advice (Vovk, 1998). Stochastic mixability is a natural adaptation of mixability to the statistical learning setting; in fact, in the special case where the function class consists of all possible functions from the input space to the prediction space, stochastic mixability is equivalent to mixability (Van Erven et al., 2012). Just as Vovk and coworkers (see e.g. (Vovk, 2001; Kalnishkan and Vyugin, 2005)) have developed a rich convex geometric understanding of mixability, stochastic mixability can be understood as a sort of effective convexity.\nIn this work, we study the O( 1n )-fast rate phenomenon in statistical learning from the perspective of stochastic mixability. Our motivation is that stochastic mixability might characterize fast rates in statistical learning. As a first step, Theorem 5 of this paper establishes via a rather direct argument that stochastic mixability implies an exact oracle inequality (i.e. with leading constant 1) with a fast rate for finite function classes, and Theorem 7 extends this result to VC-type classes. This result can be understood as a new chapter in an evolving narrative that started with Lee et al.’s (1998) seminal paper showing fast rates for agnostic learning with squared loss over convex function classes, and that was continued by Mendelson (2008b) who showed that fast rates are possible for p-losses (y, ŷ) 7→ |y − ŷ|p over effectively convex function classes by passing through a Bernstein condition (defined in (12)).\nar X\niv :1\n40 6.\n37 81\nv2 [\ncs .L\nG ]\n2 2\nN ov\n2 01\n4\nWe also show that when stochastic mixability does not hold in a certain sense (see Section 5 for the precise statement), then the risk minimizer is not unique in a bad way. This is precisely the situation at the heart of the works of Mendelson (2008b) and Mendelson and Williamson (2002), which show that having non-unique minimizers is symptomatic of bad geometry of the learning problem. In such situations, there are certain targets (i.e. output conditional distributions) close to the original target under which empirical risk minimization learns at a slow rate, where the guilty target depends on the sample size and the target sequence approaches the original target asymptotically. Even the best known upper bounds have constants that blow up in the case of non-unique minimizers. Thus, whereas stochastic mixability implies fast rates, a sort of converse is also true, where learning is hard in a “neighborhood” of statistical learning problems for which stochastic mixability does not hold. In addition, since a stochastically mixable problem’s function class looks convex from the perspective of risk minimization, and since when stochastic mixability fails the function class looks non-convex from the same perspective (it has multiple well-separated minimizers), stochastic mixability characterizes the effective convexity of the learning problem from the perspective of risk minimization.\nMuch of the recent work in obtaining faster learning rates in agnostic learning has taken place in settings where a Bernstein condition holds, including results based on local Rademacher complexities (Bartlett et al., 2005; Koltchinskii, 2006). The Bernstein condition appears to have first been used by Bartlett and Mendelson (2006) in their analysis of empirical risk minimization; this condition is subtly different from the margin condition of Mammen and Tsybakov (1999) and Tsybakov (2004), which has been used to obtain fast rates for classification problems. Lecué (2011) pinpoints that the difference between the two conditions is that the margin condition applies to the excess loss relative to the best predictor (not necessarily in the model class) whereas the Bernstein condition applies to the excess loss relative to the best predictor in the model class. Our approach in this work is complementary to the approaches of previous works, coming from a different assumption that forms a bridge to the online learning setting. Yet this assumption is related; the Bernstein condition implies stochastic mixability under a bounded losses assumption (Van Erven et al., 2012). Further understanding the connection between the Bernstein condition and stochastic mixability is an ongoing effort. Contributions. The core contribution of this work is to show a new path to the Õ (\n1 n\n) -fast rate in\nstatistical learning. We are not aware of previous results that show fast rates from the stochastic mixability assumption. Secondly, we establish intermediate learning rates that interpolate between the fast and slow rate under a weaker notion of stochastic mixability. Finally, we show that in a certain sense stochastic mixability characterizes the effective convexity of the statistical problem.\nIn the next section we formally define the statistical problem, review stochastic mixability, and explain our high-level approach toward getting fast rates. This approach involves directly appealing to the CramérChernoff method, from which nearly all known concentration inequalities arose in one way or another. In Section 3, we frame the problem of computing a particular moment of a certain excess loss random variable as a general moment problem. We sufficiently bound the optimal value of the moment, which allows for a direct application of the Cramér-Chernoff method. These results easily imply a fast rates bound for finite classes that can be extended to parametric (VC-type) function classes, as shown in Section 4. We describe in Section 5 how stochastic mixability characterizes a certain notion of convexity of the statistical learning problem. In Section 6, we extend the fast rates results to classes that obey a notion we call weak stochastic mixability. Finally, Section 7 concludes this work with connections to related topics in statistical learning theory and a discussion of open problems."
    }, {
      "heading" : "2 Stochastic mixability, Cramér-Chernoff, and ERM",
      "text" : ""
    }, {
      "heading" : "2.1 The Setting",
      "text" : "Let (`,F ,P) be a statistical learning problem with ` : Y × R→ R+ a nonnegative loss, F ⊂ RX a compact function class, and P a probability measure over X × Y for input space X and output/target space Y. Let\nZ be a random variable defined as Z = (X,Y ) ∼ P. We assume for all f ∈ F , `(Y, f(X)) ≤ V almost surely (a.s.) for some constant V .\nA probability measure P operates on functions and loss-composed functions as: P f = E(X,Y )∼P f(X) P `(·, f) = E(X,Y )∼P ` ( Y, f(X) ) .\nSimilarly, an empirical measure Pn associated with an n-sample z, comprising n iid samples (x1, y1), . . . , (xn, yn), operates on functions and loss-composed functions as:\nPn f = 1\nn n∑ j=1 f(xj) Pn `(·, f) = 1 n n∑ j=1 ` ( yj , f(xj) ) .\nLet f∗ be any function for which P `(·, f∗) = inff∈F P `(·, f). For each f ∈ F define the excess risk random variable Zf := ` ( Y, f(X) ) − ` ( Y, f∗(X) ) .\nWe frequently work with the following two subclasses. For any ε > 0, define the subclasses\nF ε := {f ∈ F : PZf ≤ ε} F ε := {f ∈ F : PZf ≥ ε} ."
    }, {
      "heading" : "2.2 Stochastic mixability",
      "text" : "For η > 0, we say that (`,F ,P) is η-stochastically mixable if for all f ∈ F\nlog E exp(−ηZf ) ≤ 0. (1)\nIf η-stochastic mixability holds for some η > 0, then we say that (`,F ,P) is stochastically mixable. Throughout this paper it is assumed that the stochastic mixability condition holds, and we take η∗ to be the largest η such that η-stochastic mixability holds. Condition (1) has a rich history, beginning from the foundational thesis of Li (1999) who studied the special case of η∗ = 1 in density estimation with log loss from the perspective of information geometry. The connections that Li showed between this condition and convexity were strengthened by Grünwald (2011, 2012) and Van Erven et al. (2012)."
    }, {
      "heading" : "2.3 Cramér-Chernoff",
      "text" : "The high-level strategy taken here is to show that with high probability the empirical risk minimization algorithm (ERM) will not select a fixed hypothesis function f with excess risk above an for some constant a > 0. For each hypothesis, this guarantee will flow from the Cramér-Chernoff method (Boucheron et al., 2013) by controlling the cumulant generating function (CGF) of −Zf in a particular way to yield exponential concentration. This control will be possible because the η∗-stochastic mixability condition implies that the CGF of −Zf takes the value 0 at some η ≥ η∗, a fact later exploited by our key tool Theorem 3.\nLet Z be a real-valued random variable. Applying Markov’s inequality to an exponentially transformed random variable yields that, for any η ≥ 0 and t ∈ R\nPr(Z ≥ t) ≤ exp(−ηt+ log E exp(ηZ)); (2)\nthe inequality is non-trivial only if t > EZ and η > 0."
    }, {
      "heading" : "2.4 Analysis of ERM",
      "text" : "We consider the ERM estimator f̂z := arg minf∈F Pn `(·, f). That is, given an n-sample z, ERM selects any f̂z ∈ F minimizing the empirical risk Pn `(·, f). We say ERM is ε-good when f̂z ∈ F ε. In order to show that ERM is ε-good it is sufficient to show that for all f ∈ F \\ F ε we have PZf > 0. The goal is to show that with high probability ERM is ε-good, and we will do this by showing that with high probability uniformly for all f ∈ F \\ F ε we have Pn Zf > t for some slack t > 0 that will come in handy later.\nFor a real-valued random variable X, recall that the cumulant generating function of X is η 7→ ΛX(η) := log E eηX ; we allow ΛX(η) to be infinite for some η > 0.\nTheorem 1 (Cramér-Chernoff Control on ERM). Let a > 0 and select f such that EZf > 0. Let t < EZf . If there exists η > 0 such that Λ−Zf (η) ≤ − an , then\nPr { Pn `(·, f) ≤ Pn `(·, f∗) + t } ≤ exp(−a+ ηt).\nProof. Let Zf,1, . . . , Zf,n be iid copies of Zf , and define the sum Sf,n := ∑n j=1−Zf,j . Since (−t) > E 1 nSf,n, then from (2) we have\nPr  1 n n∑ j=1 Zf,j ≤ t  = Pr( 1 n Sf,n ≥ −t ) ≤ exp (ηt+ log E exp(ηSf,n))\n= exp(ηt) ( E exp(−ηZf ) )n .\nMaking the replacement Λ−Zf (η) = log E exp(−ηZf ) yields\nlog Pr\n( 1\nn Sf,n ≥ −t\n) ≤ ηt+ nΛ−Zf (η).\nBy assumption, Λ−Zf (η) ≤ − an , and so Pr{Pn Zf ≤ t} ≤ exp(−a+ ηt) as desired.\nThis theorem will be applied by showing that for an excess loss random variable Zf taking values in [−1, 1], if for some η > 0 we have E exp(−ηZf ) = 1 and if EZf = an for some constant a (that can and must depend on n), then log−Zf (η/2) ≤ − cηa n where c > 0 is a universal constant. This is the nature of the next section. We then extend this result to random variables taking values in [−V, V ]."
    }, {
      "heading" : "3 Semi-infinite linear programming and the general moment prob-",
      "text" : "lem\nThe key subproblem now is to find, for each excess loss random variable Zf with mean a n and Λ−Zf (η) = 0 (for some η ≥ η∗), a pair of constants η0 > 0 and c > 0 for which Λ−Zf (η0) ≤ − can . Theorem 1 would then imply that ERM will prefer f∗ over this particular f with high probability for ca large enough. This subproblem is in fact an instance of the general moment problem, a problem on which Kemperman (1968) has conducted a very nice geometric study. We now describe this problem.\nThe general moment problem. Let P(A) be the space of probability measures over a measurable space A = (A,S). For real-value measurable functions h and (gj)j∈[m] on a measurable space A = (A,S), the general moment problem is\ninf µ∈P(A)\nEX∼µ h(X)\nsubject to EX∼µ gj(X) = yj , j ∈ {1, . . . ,m}. (3)\nLet the vector-valued map g : A → Rm be defined in terms of coordinate functions as (g(x))j = gj(x), and let the vector y ∈ Rm be equal to (y1, . . . , ym).\nLet D∗ ⊂ Rm+1 be the set\nD∗ := { d∗ = (d0, d1, . . . , dm) ∈ Rm+1 : h(x) ≥ d0 + m∑ j=1 djgj(x) for all x ∈ A } . (4)\nTheorem 3 of (Kemperman, 1968) states that if y ∈ int conv g(A), the optimal value of problem (3) equals\nsup { d0 + m∑ j=1 djyj : d ∗ = (d0, d1, . . . , dm) ∈ D∗ } . (5)\nOur instantiation. We choose A = [−1, 1], set m = 2 and define h, (gj)j∈{1,2}, and y ∈ R2 as:\nh(x) = −e(η/2)x, g1(x) = x, g2(x) = eηx, y1 = − a\nn , y2 = 1,\nfor any η > 0, a > 0, and n ∈ N. This yields the following instantiation of the general moment problem:\ninf µ∈P([−1,1])\nEX∼µ−e(η/2)X (6a)\nsubject to EX∼µX = − a\nn (6b)\nEX∼µ e ηX = 1. (6c)\nNote that equation (5) from the general moment problem now instantiates to sup { d0 − a\nn d1 + d2 : d\n∗ = (d0, d1, d2) ∈ D∗ } , (7)\nwith D∗ equal to the set{ d∗ = (d0, d1, d2) ∈ R3 : −e(η/2)x ≥ d0 + d1x+ d2eηx for all x ∈ [−1, 1] } . (8)\nTo apply Theorem 3 of (Kemperman, 1968), we need to ensure the condition y ∈ int conv g([−1, 1]) holds. We first characterize when y ∈ conv g([−1, 1]) holds and handle the int conv g([−1, 1]) version after Theorem 3.\nLemma 2 (Feasible Moments). The point y = ( − an , 1 ) ∈ conv g([−1, 1]) if and only if\na n ≤ e η + e−η − 2 eη − e−η = cosh(η)− 1 sinh(η) . (9)\nProof. Let W denote the convex hull of g([−1, 1]). We need to see if ( − an , 1 ) ∈ W . Note that W is the convex set formed by starting with the graph of x 7→ eηx on the domain [−1, 1], including the line segment connecting this curve’s endpoints (−1, e−η) to (1, eηx), and including all of the points below this line segment but above the aforementioned graph. That is, W is precisely the set\nW := { (x, y) ∈ R2 : eηx ≤ y ≤ e η + e−η\n2 + eη − e−η 2 x, ∀x ∈ [−1, 1]\n} .\nIt remains to check that 1 is sandwiched between the lower and upper bounds at x = − an . Clearly the lower bound holds. Simple algebra shows that the upper bound is equivalent to condition (9).\nNote that if (9) does not hold, then the semi-infinite linear program (6) is infeasible; infeasibility in turn implies that such an excess loss random variable cannot exist. Thus, we need not worry about whether (9) holds; it holds for any excess loss random variable satisfying constraints (6b) and (6c).\nThe following theorem is a key technical result for using stochastic mixability to control the CGF. The proof is long and can be found in Appendix A.\nTheorem 3 (Stochastic Mixability Concentration). Let f be an element of F with Zf taking values in [−1, 1], n ∈ N, EZf = an for some a > 0, and Λ−Zf (η) = 0 for some η > 0. If\na n < eη + e−η − 2 eη − e−η , (10)\nthen\nE e(η/2)(−Zf ) ≤ { 1− 0.18ηan if η ≤ 1 1− 0.21an if η > 1.\nTherefore, E e(η/2)(−Zf ) ≤ 1− 0.18(η ∧ 1)an .\nNote that since log(1− x) ≤ −x when x < 1, we have Λ−Zf (η/2) ≤ − 0.18(η ∧ 1)a\nn . In order to apply Theorem 3, we need (10) to hold, but only (9) is guaranteed to hold. The corner case is if (9) holds with equality. However, observe that one can always approximate the random variable X by a perturbed version X ′ which has nearly identical mean a′ ≈ a and a nearly identical η′ ≈ η for which EX′∼µ′ e\nη′X′ = 1, and yet the inequality in (9) is strict. Later, in the proof of Theorem 5, for any random variable that required perturbation to satisfy the interior condition (10), we implicitly apply the analysis to the perturbed version, show that ERM would not pick the (slightly different) function corresponding to the perturbed version, and use the closeness of the two functions to show that ERM also would not pick the original function.\nWe now present a necessary extension for the case of losses with range [0, V ].\nLemma 4 (Bounded Losses). Let g1(x) = x and y2 = 1 be common settings for the following two problems. The instantiation of problem (3) with A = [−V, V ], h(x) = −e(η/2)x, g2(x) = eηx, and y1 = − an has the same optimal value as the instantiation of problem (3) with A = [−1, 1], h(x) = −e(V η/2)x, g2(x) = e(V η)x, and y1 = −a/Vn .\nProof. Let X be a random variable taking values in [−V, V ] with mean − an and E e ηX = 1, and let Y be a random variable taking values in [−1, 1] with mean −a/Vn and E e (V η)Y = 1. Consider a random variable X̃ that is a 1V -scaled independent copy of X; observe that E X̃ = − a/V n and E e (V η)X̃ = 1. Let the maximal possible value of E e(η/2)X be bX , and let the maximal possible value of E e (V η/2)Y be bY . We claim that bX = bY . Let X be a random variable with a distribution that maximizes E e (η/2)X subject to the previously stated constraints on X. Since X̃ satisfies E e(V η/2)X̃ = bX , setting Y = X̃ shows that in fact bY ≥ bX . A symmetric argument (starting with Y and passing to some Ỹ = V Y ) implies that bX ≥ bY ."
    }, {
      "heading" : "4 Fast rates",
      "text" : "We now show how the above results can be used to obtain an exact oracle inequality with a fast rate. We first present a result for finite classes and then present a result for various parametric classes, including VC-type classes (classes with logarithmic universal metric entropy), VC classes, and classes with polynomial uniform L1-bracketing numbers.\nTheorem 5 (Finite Classes Exact Oracle Inequality). Let (`,F ,P) be η∗-stochastically mixable, where |F| = N , ` is a nonnegative loss, and supf∈F ` ( Y, f(X) ) ≤ V a.s. for a constant V . Then for all n ≥ 1, with probability at least 1− δ\nP `(·, f̂z) ≤ P `(·, f∗) + 6 max\n{ V, 1η∗ }( log 1δ + logN ) n .\nProof. Throughout this proof, let γn = a n where a is a constant that varies throughout the proof. For any a > 0, recall that F γn is the subclass of F for which the excess risk is at least γn. For each η > 0, let F (η) γn ⊂ F γn correspond to those functions in F γn for which η is the largest constant such that E exp(−ηZf ) = 1. Let Fhyper γn ⊂ F γn correspond to functions f in F γn for which limη→∞ E exp(−ηZf ) < 1. Clearly, F γn = (⋃ η∈[η∗,∞) F (η) γn ) ∪ Fhyper γn . The excess loss random variables corresponding to elements f ∈ Fhyper γn are “hyper-concentrated” in the sense that they are infinitely stochastically mixable. However, Lemma 10 shows that for each hyper-concentrated excess loss random variable Zf , there exists another excess loss random variable Z ′f with mean arbitrarily close to that of Zf , with E exp(−ηZ ′f ) = 1 for some arbitrarily large but finite η, and with Z ′f ≤ Zf with probability 1. The last property implies that the empirical risk of Z ′f is no greater than the empirical risk of Zf , and hence for each hyper-concentrated Zf it is sufficient (from the perspective of ERM’s behavior) to study a corresponding Z ′f . From here on out, we implicitly\nmake this replacement in F γn itself, so that we now have F γn = ⋃ η∈[η∗,∞) F (η) γn .\nConsider an arbitrary a > 0. For some fixed η ∈ [η∗,∞) for which |F (η) γn | > 0, consider the subclass F (η) γn . Individually for each such function, we will apply Theorem 1 as follows. From Lemma 4, we have Λ−Zf (η/2) = Λ− 1V Zf (V η/2). From Theorem 3, the latter is at most\n−0.18(V η ∧ 1)(a/V ) n = − 0.18ηa (V η ∨ 1)n .\nHence, Theorem 1 with t = 0 and the η from the Theorem taken to be η/2 implies that the probability of the event Pn `(·, f) ≤ Pn `(·, f∗) is at most\nexp ( −0.18 η\nV η ∨ 1 a\n) .\nApplying the union bound over all of F γn , we conclude that Pr {∃f ∈ F γn : Pn `(·, f) ≤ Pn `(·, f∗)} ≤ N exp ( −η∗ ( 0.18a\nV η∗ ∨ 1\n)) .\nNow, recalling that ERM selects hypotheses purely based on their empirical risk, from inversion it holds that with probability at least 1− δ, ERM will not select any hypothesis whose excess risk is at least\n6 max { V, 1η∗ }( log 1δ + logN ) n .\nBefore presenting the result for VC-type classes, we require some definitions. For a pseudometric space (G, d), for any ε > 0, let N (ε,G, d) be the ε-covering number of (G, d); that is, N (ε,G, d) is the minimal number of balls of radius ε needed to cover G. We will further constrain the cover (the set of centers of the balls) to be a subset of G, so that the cover is a proper cover, thus ensuring that the stochastic mixability assumption transfers to any (proper) cover of F . Note that the “proper” requirement at most doubles the constant K below, as can be seen from an argument of Vidyasagar (2002, Lemma 2.1).\nWe now state a localization-based result that allows us to extend the result for finite classes to VC-type classes. Although the localization result can be obtained by combining standard techniques,1 we could not find this particular result in the literature. Below, an ε-net Fε of a set F is a subset of F such that F is contained in the union of the balls of radius ε with centers in Fε.\nTheorem 6. Let F be a separable function class whose functions have range bounded in [0, V ] and for which, for a constant K ≥ 1, for each u ∈ (0,K] the L2(P) covering numbers are bounded as\nN (u,F , L2(P)) ≤ ( K\nu\n)C . (11)\nSuppose Fε is a minimal ε-net for F in the L2(P) norm, with ε = 1n . Denote by π : F → Fε an L2(P)-metric projection from F to Fε. Then, provided that δ ≤ 12 , the probability that there exists f ∈ F such that\nPn f < Pn(π(f))− V\nn\n( 1080C log(2Kn) + 90 √( log 1\nδ\n) C log(2Kn) + log e\nδ ) is at most δ.\nThe proof is long and distracts from the main point of this paper, and so it is presented in Appendix C. Using Theorem 6 along with much of the proof for the finite classes case, we can prove the following fast rates result for VC-type classes. The proof can be found in Appendix C. Below, we denote the loss-composed version of a function class F as ` ◦ F := {`(·, f) : f ∈ F}.\n1See e.g. the techniques of Massart and Nédélec (2006) and (for Step 3 of our proof of Theorem 11)) equation (3.17) of Koltchinskii (2011).\nTheorem 7 (VC-Type Classes Exact Oracle Inequality). Let (`,F ,P) be η∗-stochastically mixable with ` ◦ F separable, where, for a constant K ≥ 1, for each ε ∈ (0,K] we have N (` ◦ F , L2(P), ε) ≤ ( K ε )C , and\nsupf∈F ` ( Y, f(X) ) ≤ V a.s. for a constant V ≥ 1. Then for all n ≥ 5 and δ ≤ 12 , with probability at least 1− δ\nP `(·, f̂z) ≤ P `(·, f∗) + 1\nn max  8 max { V, 1η∗ }( C log(Kn) + log 2δ ) , 2V ( 1080C log(2Kn) + 90 √( log 2δ ) C log(2Kn) + log 2eδ ) + 1n."
    }, {
      "heading" : "5 Characterizing convexity from the perspective of risk minimiza-",
      "text" : "tion\nIn the following, when we say (`,F ,P) has a unique minimizer we mean that any two minimizers f∗1 , f∗2 of P `(·, f) over F satisfy ` ( Y, f∗1 (X) ) = ` ( Y, f∗2 (X) ) a.s. We say the excess loss class {`(·, f)− `(·, f∗) : f ∈ F} satisfies a (β,B)-Bernstein condition with respect to P for some B > 0 and 0 < β ≤ 1 if, for all f ∈ F :\nP ( `(·, f)− `(·, f∗) )2 ≤ B (P(`(·, f)− `(·, f∗)))β . (12) It already is known that the stochastic mixability condition guarantees that there is a unique minimizer (Van Erven et al., 2012); this is a simple consequence of Jensen’s inequality. This leaves open the question: if stochastic mixability does not hold, are there necessarily non-unique minimizers? We show that in a certain sense this is indeed the case, in bad way: the set of minimizers will be a disconnected set.\nFor any ε > 0, define Gε as the class\nGε := {f∗} ∪ { f ∈ F : ‖f − f∗‖L1(P) ≥ ε } , (13)\nwhere in case there are multiple minimizers in F we arbitrarily select one of them as f∗. Since we assume that F is compact and Gε \\ {f∗} is equal to F minus an open set homeomorphic to the unit L1(P) ball, Gε \\ {f∗} is also compact.\nTheorem 8 (Non-Unique Minimizers). Suppose there exists some ε > 0 such that Gε is not stochastically mixable. Then there are minimizers f∗1 , f ∗ 2 ∈ F of P `(·, f) over F such that it is not the case that ` ( Y, f∗1 (X) ) = ` ( Y, f∗2 (X) ) a.s.\nProof. Select ε > 0 such that Gε is not stochastically mixable. Consider some fixed η > 0. Since Gε is not stochastically mixable and hence not η-stochastically mixable, there exists fη ∈ Gε such that Λ−Zfη (η) > 0.\nWe claim that there exists η′ ∈ (0, η) such that Λ−Zfη (η ′) = 0. If not, then limη↓0\nΛ−Zfη (η)−Λ−Zfη (0)\nη > 0\nand hence Λ′−Zfη (0) > 0, which since Λ ′ −Zfη (0) = E(−Zfη ) implies that EZfη < 0, a contradiction! Hence, indeed ∃η′ ∈ (0, η) such that Λ−Zfη (η ′) = 0. Now, the Feasible Moments Lemma (Lemma 2) implies that EZfη ≤ cosh(η′)−1 sinh(η′) ; for η ′ ≥ 0 the RHS has the tight upper bound η ′ 2 since the derivative of η′ 2 − cosh(η′)−1 sinh(η′) is the nonnegative function 12 tanh 2(η′/2) and ( η′ 2 − cosh(η′)−1 sinh(η′) ) |η′=0 = 0.\nThus, as η → 0 we have EZfη → 0. Since Gε\\{f∗} is compact, we can take a positive decreasing sequence η1, η2, . . . approaching 0, corresponding to a sequence of (fηj )j ⊂ Gε \\ {f∗} with limit point g∗ ∈ Gε \\ {f∗} for which EZg∗ = 0, and so there is a risk minimizer in Gε \\ {f∗}.\nThe implications of having non-unique risk minimizers In the case of non-unique risk minimizers, Mendelson (2008a) showed that for p-losses (y, ŷ) 7→ |y − ŷ|p with p ∈ [2,∞) there is an n-indexed sequence of probability measures (P(n))n approaching the true probability measure as n → ∞ such that, for each n, ERM learns at a slow rate under sample size n when the true distribution is P(n). This behavior is a\nconsequence of the statistical learning problem’s poor geometry: there are multiple minimizers and the set of minimizers is not even connected.\nFurthermore, in this case, the best known fast rate upper bounds (see (Mendelson, 2008b) and (Mendelson and Williamson, 2002)) have a multiplicative constant that approaches ∞ as the target probability measure approaches a probability measure for which there are non-unique minimizers. The reason for the poor upper bounds in this case is that the constant B in the Bernstein condition explodes, and the upper bounds rely upon the Bernstein condition."
    }, {
      "heading" : "6 Weak stochastic mixability",
      "text" : "For some κ ∈ [0, 1], we say (`,F ,P) is (κ, η0)-weakly stochastically mixable if, for every ε > 0, for all f ∈ {f∗} ∪ F ε\nlog E exp(−ηεZf ) ≤ 0, (14)\nwith ηε := η0ε 1−κ. This concept was introduced by Van Erven et al. (2012) without a name.\nSuppose that some fixed function has excess risk a = ε. Then, roughly, with high probability ERM does not make a mistake provided that aηa = 1 n , i.e. when ε · η0ε 1−κ = 1n and hence when ε = (η0n) −1/(2−κ). By modifying the proof of the finite classes result (Theorem 5) to consider all functions in the subclass F γn for γn = (η0n) −1/(2−κ), we have the following corollary of Theorem 5.\nCorollary 9. Let (`,F ,P) be (κ, η0)-weakly stochastically mixable for some κ ∈ [0, 1], where |F| = N , ` is a nonnegative loss, and supf∈F ` ( Y, f(X) ) ≤ V a.s. for a constant V . Then for any n ≥ 1η0V\n(1−κ)/(2−κ), with probability at least 1− δ\nP `(·, f̂z) ≤ P `(·, f∗) + 6 ( log 1δ + logN ) (η0n)1/(2−κ) .\nIt is straightforward to achieve a similar result for VC-type classes, where the ε in the ε-net can still be taken at the resolution 1n , but we need only apply the analysis to the subclass of functions with excess risk at least (η0n) −1/(2−κ)."
    }, {
      "heading" : "7 Discussion",
      "text" : "We have shown that stochastic mixability implies fast rates for VC-type classes, using a direct argument based on the Cramér-Chernoff method and sufficient control of the optimal value of a certain instance of the general moment problem. The approach is amenable to localization in that the analysis separately controls the probability of large deviations for individual elements of F . It was therefore straightforward to extend the result for finite classes to VC-type classes. An important open problem is to extend the results presented here for VC-type classes to results for nonparametric classes with polynomial metric entropy, and moreover, to achieve rates similar to those obtained for these classes under the Bernstein condition.\nThere are still some unanswered questions with regards to the connection between the Bernstein condition and stochastic mixability. Van Erven et al. (2012) showed that for bounded losses the Bernstein condition implies stochastic mixability. Therefore, when starting from a Bernstein condition, Theorem 5 offers a different path to fast rates. An open problem is to settle the question of whether the Bernstein condition and stochastic mixability are equivalent. Previous results (Van Erven et al., 2012) suggest that the stochastic mixability does imply a Bernstein condition, but the proof was non-constructive, and it relied upon a bounded losses assumption. It is well known (and easy to see) that both stochastic mixability and the Bernstein condition hold only if there is a unique minimizer. Theorem 8 shows in a certain sense that if stochastic mixability does not hold, then there cannot be a unique minimizer. Is the same true when the Bernstein condition fails to hold? Regardless of whether stochastic mixability is equivalent to the Bernstein condition, the direct argument presented here and the connection to classical mixability, which\ndoes characterize constant regret in the simpler non-stochastic setting, motivates further study of stochastic mixability.\nFinally, it would be of great interest to discard the bounded losses assumption. Ignoring the dependence of the metric entropy on the maximum possible loss, the upper bound on the loss V enters the final bound through the difficulty of controlling the minimum value of uη(−1) when η is large (see the proof of Theorem 3). From extensive experiments with a grid-approximation linear program, we have observed that the worst (CGF-wise) random variables for fixed negative mean and fixed optimal stochastic mixability constant are those which place very little probability mass at −V and most of the probability mass at a small positive number that scales with the mean. These random variables correspond to functions that with low probability beat f∗ by a large (loss) margin but with high probability have slightly higher loss than f∗. It would be useful to understand if this exotic behavior is a real concern and, if not, find a simple, mild condition on the moments that rules it out."
    }, {
      "heading" : "Acknowledgments",
      "text" : "RCW thanks Tim van Erven for the initial discussions around the Cramér-Chernoff method during his visit to Canberra in 2013 and for his gracious permission to proceed with the present paper without him as an author, and both authors thank him for the further enormously helpful spotting of a serious error in our original proof for fast rates for VC-type classes. This work was supported by the Australian Research Council (NAM and RCW) and NICTA (RCW). NICTA is funded by the Australian Government through the Department of Communications and the Australian Research Council through the ICT Centre of Excellence program."
    }, {
      "heading" : "A Proof of Theorem 3",
      "text" : "Proof of Theorem 3. From Theorem 3 of Kemperman (1968), if the moment values vector ( − an , 1 ) is in int conv g([−1, 1]), the optimal objective value of problem (6) is equal to\nsup { d0 − a\nn d1 + d2 : d\n∗ = (d0, d1, d2) ∈ D∗ } . (15)\nFrom the Feasible Moments Lemma (Lemma 2 in the paper), we see that (10) corresponds to the interior point condition.\nSince we assume the interior point condition is satisfied, any d∗ ∈ D∗ provides a lower bound on the optimal value of (6), and hence after negation provides an upper bound on the problem with same moment constraints and the objective sup E e(η/2)X ; this is precisely what we are after.\nWe therefore focus on picking a good d∗ = (d0, d1, d2) ∈ R3. The inequality condition in (8) is now\n−e(η/2)x ≥ d0 + d1x+ d2eηx for all x ∈ [−1, 1].\nIn particular, this inequality must hold at x = 0, yielding the constraint −1 ≥ d0 + d2. We now change variables to c0 = −d0, c1 = −d1/η,2 and c2 = −d2, yielding the inequality condition\nuη(x) := −e(η/2)x + c0 + c2eηx + ηc1x ≥ 0.\nNow the condition at x = 0 implies that c0 + c2 = 1, and so we make the replacement\nc0 = 1− c2, (16)\nin the definition of uη(x), yielding the inequality\nuη(x) = 1 + c2(e ηx − 1)− e(η/2)x + ηc1x ≥ 0.\nConstraints from the local minimum at 0\nSince uη(0) = 0, we need x = 0 to be a local minimum of u, and so we require both conditions\n(a) u′(0) = 0\n(b) u′′(0) ≥ 0\nto hold since otherwise there exists some small ε > 0 such that either uη(ε) < 0 or uη(−ε) < 0. For (a), we compute\nu′(x) = ηc2e ηx − η\n2 e(η/2)x + ηc1.\nSince we require u′(0) = 0, we pick up the constraint\nη ( c2 − 1\n2 + c1\n) = 0,\nand since η > 0 by assumption, we have\nc1 = 1\n2 − c2. (17)\nThus, we can eliminate c1 from uη(x):\nuη(x) = 1 + c2(e ηx − 1)− e(η/2)x + η\n( 1\n2 − c2\n) x ≥ 0.\nFor (b), it is sufficient to have u′′(0) > 0. Observe that\nu′′(x) = η2c2e ηx − η\n2\n4 e(η/2)x,\nso that u′′(0) = η2 ( c2 − 14 ) , and hence for\nc2 > 1\n4 (18)\nwe have u′′(0) > 0. Thus far, we have picked up the constraints (16), (17), and (18).\n2We scale by η here because we are chasing a certain η-dependent rate.\nThe other minima of uη(x)\nNow, observe that u′(x) has at most two roots, because with the substitution y = e(η/2)x, we have\nu′(x) = ηc2y 2 − η\n2 y + η\n( 1\n2 − c2\n) ,\nwhich is a quadratic equation in y with two roots:\ny = { 1,\n1− 2c2 2c2\n} ⇒ x = { 0, 2\nη log 1− 2c2 2c2\n} .\nNow, since we take c2 > 1 4 and since the second root is negative, we know that u is increasing on [0, 1] (and we already knew that uη(0) = 0). It remains to find conditions on c2 such that uη(−1) ≥ 0 because that implies that uη(x) ≥ 0 for all x ∈ [−1, 0]. We consider the case η ≤ 1 and η > 1 separately.\nIn either case, we need to check the nonnegativity of uη(−1) = 1 + c2(e−η − 1)− e−(η/2) − η ( 1\n2 − c2 ) = (\n1− η 2\n) − e−(η/2) + c2 ( e−η − (1− η) ) .\nCase η ≤ 1: We observe that uη(−1) = 0 when η = 0. Now, we will see what constraints on c2 guarantee that ddηuη(−1) ≥ 0 for η ∈ [0, 1]. We want\nd\ndη uη(−1) = −c2e−η +\n1 2 e−η/2 − 1 2 + c2 ≥ 0\nwhich is equivalent to the condition\nc2 ≥ 1\n2\n( 1− e−η/2\n1− e−η\n) .\nThe RHS is increasing in η, and so we need only consider η = 1, yielding the bound\nc2 ≥ 1\n2\ne− √ e\ne− 1 = 0.3112 . . . ,\nand so if c2 ≥ 0.32, then uη(−1) ≥ 0 as desired.\nCase η > 1: Let c2 = 1 2 − α η for some α ≥ 0. With this substitution, we have\nuη(−1) = 1 + c2(e−η − 1)− e−(η/2) − η ( 1\n2 − c2 ) = 1 + ( 1\n2 − α η\n) (e−η − 1)− e−(η/2) − α\n=\n( 1 + e−η\n2 − e−η/2\n) + α ( −1 + 1\nη\n( 1− e−η )) Since we want the above to be nonnegative for all η > 1, we arrive at the condition\nα ≤ inf η≥1\n{ 1+e−η\n2 − e −η/2\n1− 1η (1− e−η)\n} (19)\nPlotting suggests that the minimum is attained at η = 1, with the value 12 ( √ e − 1)2. We will fix α to\nthis value and verify that( 1 + e−η\n2 − e−η/2\n) + ( 1\n2 ( √ e− 1)2\n)( −1 + 1\nη\n( 1− e−η )) ≥ 0. (20)\nThis is true with equality at η = 0. The derivative of the LHS with respect to η is\n1 2 e−η\n( eη/2 − 1− ( √ e− 1)2(eη − η − 1)\nη2\n) .\nThe derivative is positive at η = 1, so 0 is a candidate minimum. Eventually, ( √ e−1)2(eη−η−1)\nη2 grows more\nquickly than eη/2−1 and surpasses the latter in value. The derivative is therefore negative for all sufficiently large η, and so we need only take the minimum of the LHS of (20) evaluated at η = 1 and the limiting value as η →∞. We have\nlim η→∞\n( 1 + e−η\n2 − e−η/2\n) + ( 1\n2 ( √ e− 1)2\n)( −1 + 1\nη\n( 1− e−η )) = √ e− e\n2 ≥ 0\nHence, (20) indeed holds for α = 12 ( √ e− 1)2. We conclude that uη(−1) ≥ 0 when α ≤ 12 ( √ e− 1)2.\nPutting it all together In the regime η ≤ 1, we have the constraints c2 > 14 and c2 ≥ 1 2 e− √ e e−1 (which exceeds 1 4 ), so we can choose\nc1 = 1\n2 − c2 =\n1 2 − 1 2\ne− √ e\ne− 1 =\n1\n2 √ e− 1 e− 1 = 0.1877 . . . .\nIn the regime η > 1, we have the constraints c2 > 1 4 and α ≤ 1 2 ( √ e − 1)2 ⇒ c2 ≥ 12 − 1 2η ( √ e − 1)2 (which always exceeds 14 for η ≥ 1), so we can choose\nc1 = 1\n2 − c2 =\nα η ≤ ( √ e− 1)2 2η = 0.2104 . . . η .\nThe result follows by observing that in the case of η ≤ 1, the supremum in (15) is lower bounded by −1 + 0.18aηn , and hence the optimal objective value of (6) is lower bounded by the same quantity. Therefore, the problem with the same constraints and the objective supµ∈[−1,1] E e (η/2)X has its optimal objective value upper bounded by 1− 0.18aηn . Repeat the same argument for the case of η > 1."
    }, {
      "heading" : "B Hyper-concentrated excess losses",
      "text" : "Lemma 10. Let Z be a random variable with probability measure P supported on [−V, V ]. Suppose that limη→∞ E exp(−ηZ) < 1 and EZ = µ > 0. Then there is a suitable modification of Z ′ for which Z ′ ≤ Z with probability 1, the mean of Z ′ is arbitrarily close to µ, and E exp(−ηZ ′) = 1 for arbitrarily large η.\nProof. First, observe that Z ≥ 0 a.s. If not, then there must be some finite η > 0 for which E exp(−ηZ) = 1. Now, consider a random variable Z ′ with probability measure Q , a modification of Z (with probability measure P ) constructed in the following way. Define A := [µ, V ] and A− := [−V,−µ]. Then for any > 0 we define Q as\ndQ (z) =  (1− )dP (z) if z ∈ A dP (−z) if z ∈ A−\ndP (z) otherwise.\nAdditionally, we couple P and Qε such that the couple (Z,Z ′) is a coupling of (P,Q ) satisfying\nE(Z,Z′)∼(P,Q ) 1{Z 6=Z′} = min (P ′,Q′ ) E(Z,Z′)∼(P ′,Q′ ) 1Z 6=Z′ ,\nwhere the min is over all couplings of P and Qε. This coupling ensures that Z ′ ≤ Z with probability 1; i.e. Z ′ is dominated by Z. Now,\nE exp(−ηZ ′) = ∫ V −V e−ηzdQ (z)\n= ∫ A− e−ηzdQ (z) + ∫ A e−ηzdQ (z) + ∫ [0,V ]\\A e−ηzdQ (z)\n= ∫ A− e−ηzdP (−z) + (1− ) ∫ A e−ηzdP (z) + ∫ [0,V ]\\A e−ηzdP (z)\n= ∫ A eηzdP (z) + (1− ) ∫ A e−ηzdP (z) + ∫ [0,V ]\\A e−ηzdP (z)\n≥ eµηP (A) + (1− ) ∫ A e−ηzdP (z) + ∫ [0,V ]\\A e−ηzdP (z). (21)\nNow, on the one hand, for any η > 0, the sum of the two right-most terms in (21) is strictly less than 1 by assumption. On the other hand, η → P (A)eµη is exponentially increasing since > 0 and µ > 0 (and hence P (A) > 0 as well) by assumption; thus, the first term in (21) can be made arbitrarily large for large enough by increasing η. Consequently, we can choose > 0 as small as desired and then choose η < ∞ as large as desired such that the mean of Z ′ is arbitrarily close to µ and E exp(−ηZ ′) = 1 respectively."
    }, {
      "heading" : "C Proof of VC-type results",
      "text" : "C.1 Proof of Theorem 6\nThe localization result is a simple consequence of the following theorem.\nTheorem 11 (Local Analysis). Let F ⊂ RX be a separable function class for which:\n• the constant zero function is an element of F ;\n• every function f ∈ F satisfies 0 ≤ f ≤ 1 ;\n• supf∈F ‖f‖L2(P) ≤ ε := 1n .\nFurther assume that for some C ≥ 1, for a constant K ≥ 1, for each u ∈ (0,K] the L2(P) covering numbers of F are bounded as\nN (u,F , L2(P)) ≤ ( K\nu\n)C .\nThen provided that n ≥ 4 and y > 0, with probability at least 1− e−y\nsup f∈F\nPn f ≤ 1\nn\n( 990C log(2Kn) + √ 2y(1 + 3960C log(2Kn)) + 2y\n3 + 1\n) .\nRemarks\n(i) The class F is contained in an L2(P)-ball of radius ε, and if interpreted as a loss class it is assumed that the losses are bounded.\n(ii) Suppose the function class F is constructed by selecting from a larger class an ε-ball in the L2(P) pseudometric around some function f0 from the same larger class and taking for each function the absolute difference with f0. Then the zero function trivially is in F since |f0−f0| is in the class. In this setup, the theorem states that with high probability there is no function in the class whose empirical risk will be “much” smaller/larger than the empirical risk of f0.\nProof of Theorem 11. For the proof, we introduce the random variables Z = supf∈F Pn f and Z̄ = supf∈F (Pn −P)f . The proof is in three steps.\nStep 1: Centering approximation\nIt is easy to see that Z ≤ Z̄ + ε, since\nZ = sup f∈F Pn f = sup f∈F\n(Pn −P)f + P f\n≤ sup f∈F (Pn −P)f + sup f∈F P f\n≤ Z̄ + sup f∈F ‖f0 − f‖L1(P)\n≤ Z̄ + sup f∈F ‖f0 − f‖L2(P)\n≤ Z̄ + ε,\nwhere the penultimate inequality follows from Jensen’s inequality.\nStep 2: Concentration of Z̄ arounds its expectation\nWe will apply Bousquet’s version of Talagrand’s inequality, appearing as equation (18) of (Massart and Nédélec, 2006) and reproduced below for convenience:\nIf G is a countable family of measurable functions such that, for some positive constants v and b, one has, for every g ∈ G, P g2 ≤ v and ‖g‖∞ ≤ b, then, for every positive y, the following inequality holds for W = supg∈G(Pn −P)g:\nPr { W − EW ≥ √ 2(v + 4bEW )y\nn +\n2by\n3n\n} ≤ e−y.\nWe take G to be F itself; since F is separable and hence admits a countable dense subset, the countability assumption in Talagrand’s inequality is not an issue. Observe that for every f ∈ F we have\n• ‖f‖∞ ≤ 1 (from the range constraints on f)\n• P f2 ≤ ‖f‖L2(P) ≤ ε (by the small L2(P)-ball assumption on F) .\nThus, taking b = 1 and v = ε, we have\nPr { Z̄ − E Z̄ ≥ √ 2(ε+ 4 E Z̄)y\nn +\n2y\n3n\n} ≤ e−y. (22)\nIt remains to bound E Z̄. If it can be shown to be Õ( 1n ) then we will have the desired result after taking ε = O( 1n ).\nStep 3: Controlling the size of E Z̄\nControlling E Z̄ can be done through chaining after passing to a symmetrized empirical process. This control is shown in Lemma 12, stated after the current proof, yielding the result\nE Z̄ ≤ 990C log(2Kn) n . (23)\nPutting it all together\nThe desired result follows by plugging (23) into the concentration result (22), incorporating the ε approximation term from Step 1, and setting ε = 1n .\nLemma 12. Take the same conditions as Theorem 11 (Local Analysis Theorem), but instead allow that all f ∈ F need only satisfy 0 ≤ f ≤ V for some V ≥ 1. Then provided that n ≥ 4,\nE sup f∈F\n(Pn −P)f ≤ 990CV log(2Kn)\nn\nProof. To avoid measurability issues, we operate under the assumption that F is countable and in the final step of the proof apply an approximation argument.\nLet 1, . . . , n be iid Rademacher random variables. We write E for the expected value with respect to the random variables 1, . . . , n. That is, if A is a random variable depending only on 1, . . . , n, X1, . . . , Xn, then E A = E [A | X1, . . . , Xn]. Also, let F|X be the coordinate projection of F onto the sample X = (X1, . . . , Xn):\nF|X := { (f(X1), . . . , f(Xn) : f ∈ F } .\nFinally, for a set G ⊂ Rn let D(G) be half of the `2-radius of G, defined as\nD(G) := 1 2 sup g∈G ‖g‖2;\nit makes sense to refer to this as a (half) radius since we will consider D(F) and the zero function is in F . Our life will be made easier if we use the lower bounded quantity D(G)∨σ, for some deterministic σ ≤ 1 to be chosen later.\nThe first step is symmetrization. The second step is based on a chaining argument, the result of which is Corollary 13.2 of Boucheron et al. (2013), restated here3 we state the result in terms of in a specialization to Rademacher processes for convenience:\nLet (T , d) be a finite pseudometric space and (Xt)t∈T be a collection of sub-Gaussian random variables. Then for any t0 ∈ T ,\nE sup t∈T\nXt −Xt0 ≤ 12 ∫ δ/2\n0\n√ logN (u, T , d)du,\nwhere δ = supt∈T d(t, t0).\nBy pushing the cardinality of T to infinity, the above result also applies to countable classes. As noted by Boucheron et al. (2013) in the paragraph concluding the statement of their Corollary 13.2, this result applies to Rademacher processes. In our case, t0 will correspond to the zero function element of F .\n3Boucheron et al. (2013) stated this result in terms of packing numbers, but careful inspection of their proof reveals that the argument works for covering numbers as well. Moreover, other proofs generally use covering numbers.\nDefine P̄n := Pn −P. Now, from symmetrization and the above chaining-based result applied to the resulting Rademacher process, we have\nnE sup f∈F\nP̄n f ≤ 2 E E sup f∈F n∑ j=1 jf(Xj)  ≤ 24 E\n∫ D(F|X )∨σ 0 √ logN (u,F|X , ‖ · ‖2)du\nwhich (since if f|X is the obvious coordinate projection of f ∈ F , then ‖f|X‖2 = √ n‖f‖L2(Pn)) is at most\n24 E ∫ D(F|X )∨σ 0 √ H2 ( u√ n ,F|X ) du\n≤ 24 √ C E ∫ D(F|X )∨σ\n0\n√ log K √ n\nu du,\nwhere H2(u, T ) := supQ logN (u, T , L2(Q)) is the universal metric entropy of T , and in the above display we have H2 ( u√ n ,F|X ) rather than H2(u,F|X) because we work with the L2(Pn)-norm scaled by √ n.\nMaking the substitution t = u/(D(F|X)∨σ), the above is equal to\n24 √ C E (( D(F|X)∨σ ) ∫ 1 0 √ log\nK √ n t ( D(F|X)∨σ\n)dt)\n≤ 24 √ C E (( D(F|X)∨σ )(√ log\nK √ n\nD(F|X)∨σ +\n√ π\n2\n))\n≤ 24 √ C (√ log K √ n\nσ +\n√ π\n2\n)( σ + ED(F|X) ) .\nNow, we focus on ED(F|X). Observe that\nED(F|X) = √ n\n2 E sup f∈F\n√ Pn f2\n=\n√ n\n2 E sup f∈F\n√ P̄n f2 + P f2\n≤ √ n\n2 [ E sup f∈F √ P̄n f2 + sup f∈F √ P f2 ]\n≤ √ n\n2 [√ E sup f∈F P̄n f2 + ε ] .\nwhere the first part of the last step follows from Jensen’s inequality and the second part follows from the small L2(P)-ball assumption on F . The above is at most\n√ V n\n2 [√ E sup f∈F P̄n f + ε ] .\nThus, putting everything together and making the replacement ε = 1n , we have\nE sup f∈F\nP̄n f ≤ 24 √ C\nn\n(√ log K √ n\nσ +\n√ π\n2\n)( σ + √ V n\n2 [√ E sup f∈F P̄n f + 1 n ]) .\nFinding the minimal value of E supf∈F P̄n just amounts to solving a quadratic equation, yielding the solution set\n√ E sup f∈F P̄n f ≤ ψ √ V n 2 + √√√√ψ(σ + √V/n 2 )\nfor ψ = 24 √ C\nn\n(√ log K √ n σ + √ π 2 ) .\nMaking the replacement σ = 1n , squaring, and some coarse bounding yields\nE sup f∈F\nP̄n f ≤ 990CV log(Kn)\nn\nfor n ≥ 4, V ≥ 1, and C ≥ 1. We now present the approximation argument to handle separable F . Since F is separable, it suffices to consider a countable dense subset F ′ ⊂ F ; however, a little more work is required as the covering numbers of F ′ may differ slightly from the covering numbers of F . We now control the covering numbers of F ′ in terms of the covering numbers of F . Observe that if there is an ε-net of F of cardinality N , then there is a (2ε)-net of some F ′ ⊂ F of cardinality N . Hence, if there is an optimal ε-net of F of cardinality N , then an optimal (2ε)-net of F ′ has cardinality at most N . That is, for any probability measure Q on X , for any u > 0 we have N (2u,F ′, L2(Q)) ≤ N (u,F , L2(Q)). Thus, the result for separable F holds by replacing the constant K with 2K.\nWe now prove the localization result.\nProof of Theorem 6. First, so that we can just handle the case of functions with range [0, 1], we (crudely) apply our analysis to the function class after scaling all functions by the factor 1V , and scale the approximation term in the last step by the factor V .4\nFor any f0 ∈ Fε, observe that π−1(f0) is the set of those functions that are covered by f0 in the L2(P)norm. We apply the Local Analysis Theorem (Theorem 11) to each element of the set of localized absolute difference function classes\n{Gf0 : f0 ∈ Fε} ,\nfor Gf0 := { |f0 − f | : f ∈ π−1(f0) } . Consider an arbitrary f0 ∈ Fε and its corresponding class Gf0 . Since\nG̃f0 := { f0 − f : f ∈ π−1(f0) } is isomorphic to a subset of F , and since any ε-net for G̃f0 trivially gives rise to an ε-net for Gf0 by taking the absolute value of each function from the original ε-net, it follows the L2(P) covering numbers of Gf0 are bounded just as in (11).\nTaking the union bound over Fε with Theorem 11 implies that with probability at least 1− δ\nmax f0∈Fε sup f∈π−1(f0)\nPn |f0 − f |\n≤ 1 n\n( 990C log(2Kn) + √ 2 ( log 1\nδ + C log(Kn)\n) (1 + 3960C log(2Kn)) + 2 ( log 1δ + C log(Kn) ) 3 + 1 ) .\nIgnoring the 1n factor, the RHS is at most\n990C log(2Kn) + √ 2 ( log 1\nδ + C log(Kn)\n) (1 + 3960C log(2Kn)) + log e\nδ + C log(Kn),\n4It may be possible to get a weaker dependence on V with a more careful argument that depends on V throughout; in particular, Talagrand’s inequality can handle the parameter V .\nwhich is at most\n991C log(2Kn) + √ 2 log 1\nδ + 2C log(Kn) + 7920\n( log 1\nδ\n) C log(2Kn) + 7920(C log(2Kn))2 + log e\nδ\n≤ 1080C log(2Kn) + √ 2 log 1\nδ + 2C log(Kn) + 7920\n( log 1\nδ\n) C log(2Kn) + log e\nδ\n≤ 1080C log(2Kn) + 90 √( log 1\nδ\n) C log(2Kn) + log e\nδ ,\nwhere the last inequality holds provided that δ is not too large; it suffices to assume δ ≤ 12 .\nFinally, we prove the fast rates exact oracle inequality for VC-type classes.\nC.2 Proof of Theorem 7\nProof of Theorem 7. For convenience, we begin by abusing notation and redefining F as F := `◦F ; the abuse includes f∗ being redefined as `(·, f∗). With these abuses, for any f ∈ F we redefine Zf as Zf := f − f∗.\nNext, we introduce a few subclasses that will be in play. Recall that for any γn > 0, F γn is the subclass of F for which the excess risk is at least γn. Also, for any γn > 0, let F γn,ε be a proper cover of F γn with respect to the L2(Pn) norm, with ε = 1n . For each η > 0 and F γn,ε, let F (η) γn,ε ⊂ F γn,ε correspond to those functions for which η is the largest constant such that E exp(−ηZf ) = 1. After making the same implicit change to F γn,ε for “hyper-concentrated” excess loss random variables (i.e. those Zf for which limη→∞ E exp(−ηZf ) < 1) as was made to F γn in the proof of Theorem 5, we have F γn,ε =⋃ η∈[η∗,∞) F (η) γn,ε.\nLet γn = a n for some constant a > 1 to be fixed later. Consider an arbitrary η ∈ [η ∗,∞) for which |F (η) γn,ε| > 0, and recall that all functions f in this class satisfy EZf ≥ a n . Individually for each such function f , we will apply the Cramér-Chernoff Theorem (Theorem 1) as follows. From the Bounded Losses Lemma (Lemma 4), we have Λ−Zf (η/2) = Λ− 1V Zf (V η/2). From the Stochastic Mixability Concentration Theorem (Theorem 3), the latter is at most\n−0.18(V η ∧ 1)(a/V ) n = − 0.18ηa (V η ∨ 1)n .\nHence, the Cramér-Chernoff Theorem (Theorem 1) with t = a2n and the η from that Theorem taken to be η/2 implies that the probability of the event Pn f ≤ Pn f∗ + a2n is at most\nexp ( −0.18 η\nV η ∨ 1 a+\naη\n4n\n) = exp ( −ηa ( 0.18\nV η ∨ 1 − 1 4n\n)) .\nApplying the union bound over all of F γn,ε, we conclude that\nPr { ∃f ∈ F γn,ε : Pn f ≤ Pn f∗ + a\n2n\n} ≤ ( K\nε\n)C exp ( −η∗a ( 0.18\nV η∗ ∨ 1 − 1 4n\n)) .\nNow, observe that if we consider some fixed failure probability δ2 and invert to obtain the corresponding\na, we have\na = C log Kε + log 2 δ η∗ (\n0.18 V η∗ ∨ 1 − 1 4n\n) = C log Kε + log 2δ η∗ (\n0.18−(V η∗ ∨ 1)/(4n) V η∗ ∨ 1 ) ≤ (V η∗ ∨ 1) ( C log Kε + log 2 δ\n) η∗ ( 0.18− 14n\n) ≤ 8 ( V ∨ ( 1\nη∗\n))( C log K\nε + log\n2\nδ\n) =: λ, (24)\nfor γ (1) n := λ n , where the last inequality holds since n ≥ 5. Note that by instead setting a n = γ (1) n (defined in (24)) the failure probability can only decrease. Thus, for any γn ≥ γ(1)n , we have\nPr { ∃f ∈ F γn,ε : Pn f ≤ Pn f∗ +\nγn 2\n} ≤ δ\n2 .\nNext, we control the behavior of the subclass F γn \\ F γn,ε. From Theorem 6, if δ ≤ 12\nPr { ∃f ∈ F γn : Pn f < Pn π(f)− γ(2)n } ≤ δ\n2 .\nfor γ (2) n = V n\n( 1080C log(2Kn) + 90 √( log 2δ ) C log(2Kn) + log 2eδ ) .\nNow, combining the above two high probability guarantees, with probability at least 1−δ both statements below hold for all f ∈ F γn :\nPn f ≥ Pn π(f)− γ(2)n Pn π(f) ≥ Pn f∗ +\nγn 2 .\nThus, with the same probability, for all f ∈ F γn :\nPn f ≥ Pn f∗ + γn 2 − γ(2)n .\nSetting γn = (γ (1) n ∨ 2γ(2)n )+ 1n , and recalling that ERM selects hypotheses purely based on their empirical risk, we see that with probability at least 1− δ, ERM will not select any hypothesis whose excess risk is at least\n(γ(1)n ∨(2γ(2)n )) + 1\nn ."
    } ],
    "references" : [ {
      "title" : "A stochastic view of optimal regret through minimax duality",
      "author" : [ "Jacob Abernethy", "Alekh Agarwal", "Peter L. Bartlett", "Alexander Rakhlin" ],
      "venue" : "In Proceedings of the 22nd Annual Conference on Learning Theory (COLT",
      "citeRegEx" : "Abernethy et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Abernethy et al\\.",
      "year" : 2009
    }, {
      "title" : "Fast learning rates in statistical inference through aggregation",
      "author" : [ "Jean-Yves Audibert" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Audibert.,? \\Q2009\\E",
      "shortCiteRegEx" : "Audibert.",
      "year" : 2009
    }, {
      "title" : "Empirical minimization",
      "author" : [ "Peter L. Bartlett", "Shahar Mendelson" ],
      "venue" : "Probability Theory and Related Fields,",
      "citeRegEx" : "Bartlett and Mendelson.,? \\Q2006\\E",
      "shortCiteRegEx" : "Bartlett and Mendelson.",
      "year" : 2006
    }, {
      "title" : "Local Rademacher complexities",
      "author" : [ "Peter L. Bartlett", "Olivier Bousquet", "Shahar Mendelson" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Bartlett et al\\.,? \\Q2005\\E",
      "shortCiteRegEx" : "Bartlett et al\\.",
      "year" : 2005
    }, {
      "title" : "Concentration inequalities: A nonasymptotic theory of independence",
      "author" : [ "Stéphane Boucheron", "Gábor Lugosi", "Pascal Massart" ],
      "venue" : null,
      "citeRegEx" : "Boucheron et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Boucheron et al\\.",
      "year" : 2013
    }, {
      "title" : "Safe learning: bridging the gap between Bayes, MDL and statistical learning theory via empirical convexity",
      "author" : [ "Peter Grünwald" ],
      "venue" : "In Proceedings of the 24th International Conference on Learning Theory (COLT",
      "citeRegEx" : "Grünwald.,? \\Q2011\\E",
      "shortCiteRegEx" : "Grünwald.",
      "year" : 2011
    }, {
      "title" : "The safe Bayesian",
      "author" : [ "Peter Grünwald" ],
      "venue" : "In Proceedings of the 23rd International Conference on Algorithmic Learning Theory (ALT",
      "citeRegEx" : "Grünwald.,? \\Q2012\\E",
      "shortCiteRegEx" : "Grünwald.",
      "year" : 2012
    }, {
      "title" : "The weak aggregating algorithm and weak mixability",
      "author" : [ "Yuri Kalnishkan", "Michael V. Vyugin" ],
      "venue" : "In Proceedings of the 18th Annual Conference on Learning Theory (COLT",
      "citeRegEx" : "Kalnishkan and Vyugin.,? \\Q2005\\E",
      "shortCiteRegEx" : "Kalnishkan and Vyugin.",
      "year" : 2005
    }, {
      "title" : "Kemperman. The general moment problem, a geometric approach",
      "author" : [ "H.B. Johannes" ],
      "venue" : "The Annals of Mathematical Statistics,",
      "citeRegEx" : "Johannes,? \\Q1968\\E",
      "shortCiteRegEx" : "Johannes",
      "year" : 1968
    }, {
      "title" : "Interplay between concentration, complexity and geometry in learning theory",
      "author" : [ "Guillaume Lecué" ],
      "venue" : "Ecole dEté de Probabilités de Saint-Flour XXXVIII-2008,",
      "citeRegEx" : "Lecué.,? \\Q2011\\E",
      "shortCiteRegEx" : "Lecué.",
      "year" : 2011
    }, {
      "title" : "Estimation of mixture models",
      "author" : [ "Jonathan Qiang Li" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Li.,? \\Q1974\\E",
      "shortCiteRegEx" : "Li.",
      "year" : 1974
    }, {
      "title" : "Agnostic learning nonconvex function classes",
      "author" : [ "2008b. Shahar Mendelson", "Robert C. Williamson" ],
      "venue" : null,
      "citeRegEx" : "Mendelson and Williamson.,? \\Q2008\\E",
      "shortCiteRegEx" : "Mendelson and Williamson.",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 7,
      "context" : "(Vovk, 2001; Kalnishkan and Vyugin, 2005)) have developed a rich convex geometric understanding of mixability, stochastic mixability can be understood as a sort of effective convexity.",
      "startOffset" : 0,
      "endOffset" : 41
    }, {
      "referenceID" : 0,
      "context" : "These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.",
      "startOffset" : 14,
      "endOffset" : 40
    }, {
      "referenceID" : 0,
      "context" : "These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.g. from the work of Audibert (2009), and most recently Van Erven et al.",
      "startOffset" : 14,
      "endOffset" : 378
    }, {
      "referenceID" : 0,
      "context" : "These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.g. from the work of Audibert (2009), and most recently Van Erven et al.’s (2012) injection of the concept of mixability into the statistical learning space in the form of stochastic mixability.",
      "startOffset" : 14,
      "endOffset" : 423
    }, {
      "referenceID" : 0,
      "context" : "These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.g. from the work of Audibert (2009), and most recently Van Erven et al.’s (2012) injection of the concept of mixability into the statistical learning space in the form of stochastic mixability. It is this last connection that will be our departure point for this work. Mixability is a fundamental property of a loss that characterizes when constant regret is possible in the online learning game of prediction with expert advice (Vovk, 1998). Stochastic mixability is a natural adaptation of mixability to the statistical learning setting; in fact, in the special case where the function class consists of all possible functions from the input space to the prediction space, stochastic mixability is equivalent to mixability (Van Erven et al., 2012). Just as Vovk and coworkers (see e.g. (Vovk, 2001; Kalnishkan and Vyugin, 2005)) have developed a rich convex geometric understanding of mixability, stochastic mixability can be understood as a sort of effective convexity. In this work, we study the O( 1 n )-fast rate phenomenon in statistical learning from the perspective of stochastic mixability. Our motivation is that stochastic mixability might characterize fast rates in statistical learning. As a first step, Theorem 5 of this paper establishes via a rather direct argument that stochastic mixability implies an exact oracle inequality (i.e. with leading constant 1) with a fast rate for finite function classes, and Theorem 7 extends this result to VC-type classes. This result can be understood as a new chapter in an evolving narrative that started with Lee et al.’s (1998) seminal paper showing fast rates for agnostic learning with squared loss over convex function classes, and that was continued by Mendelson (2008b) who showed that fast rates are possible for p-losses (y, ŷ) 7→ |y − ŷ| over effectively convex function classes by passing through a Bernstein condition (defined in (12)).",
      "startOffset" : 14,
      "endOffset" : 1928
    }, {
      "referenceID" : 0,
      "context" : "These include Abernethy et al.’s (2009) unified Bregman-divergence based analysis of online convex optimization and statistical learning, the online-to-batch conversion of the exponentially weighted average forecaster (a special case of the aggregating algorithm for mixable losses) which yields the progressive mixture rule as can be seen e.g. from the work of Audibert (2009), and most recently Van Erven et al.’s (2012) injection of the concept of mixability into the statistical learning space in the form of stochastic mixability. It is this last connection that will be our departure point for this work. Mixability is a fundamental property of a loss that characterizes when constant regret is possible in the online learning game of prediction with expert advice (Vovk, 1998). Stochastic mixability is a natural adaptation of mixability to the statistical learning setting; in fact, in the special case where the function class consists of all possible functions from the input space to the prediction space, stochastic mixability is equivalent to mixability (Van Erven et al., 2012). Just as Vovk and coworkers (see e.g. (Vovk, 2001; Kalnishkan and Vyugin, 2005)) have developed a rich convex geometric understanding of mixability, stochastic mixability can be understood as a sort of effective convexity. In this work, we study the O( 1 n )-fast rate phenomenon in statistical learning from the perspective of stochastic mixability. Our motivation is that stochastic mixability might characterize fast rates in statistical learning. As a first step, Theorem 5 of this paper establishes via a rather direct argument that stochastic mixability implies an exact oracle inequality (i.e. with leading constant 1) with a fast rate for finite function classes, and Theorem 7 extends this result to VC-type classes. This result can be understood as a new chapter in an evolving narrative that started with Lee et al.’s (1998) seminal paper showing fast rates for agnostic learning with squared loss over convex function classes, and that was continued by Mendelson (2008b) who showed that fast rates are possible for p-losses (y, ŷ) 7→ |y − ŷ| over effectively convex function classes by passing through a Bernstein condition (defined in (12)).",
      "startOffset" : 14,
      "endOffset" : 2075
    }, {
      "referenceID" : 3,
      "context" : "Much of the recent work in obtaining faster learning rates in agnostic learning has taken place in settings where a Bernstein condition holds, including results based on local Rademacher complexities (Bartlett et al., 2005; Koltchinskii, 2006).",
      "startOffset" : 200,
      "endOffset" : 243
    }, {
      "referenceID" : 8,
      "context" : "This is precisely the situation at the heart of the works of Mendelson (2008b) and Mendelson and Williamson (2002), which show that having non-unique minimizers is symptomatic of bad geometry of the learning problem.",
      "startOffset" : 83,
      "endOffset" : 115
    }, {
      "referenceID" : 2,
      "context" : "The Bernstein condition appears to have first been used by Bartlett and Mendelson (2006) in their analysis of empirical risk minimization; this condition is subtly different from the margin condition of Mammen and Tsybakov (1999) and Tsybakov (2004), which has been used to obtain fast rates for classification problems.",
      "startOffset" : 59,
      "endOffset" : 89
    }, {
      "referenceID" : 2,
      "context" : "The Bernstein condition appears to have first been used by Bartlett and Mendelson (2006) in their analysis of empirical risk minimization; this condition is subtly different from the margin condition of Mammen and Tsybakov (1999) and Tsybakov (2004), which has been used to obtain fast rates for classification problems.",
      "startOffset" : 59,
      "endOffset" : 230
    }, {
      "referenceID" : 2,
      "context" : "The Bernstein condition appears to have first been used by Bartlett and Mendelson (2006) in their analysis of empirical risk minimization; this condition is subtly different from the margin condition of Mammen and Tsybakov (1999) and Tsybakov (2004), which has been used to obtain fast rates for classification problems.",
      "startOffset" : 59,
      "endOffset" : 250
    }, {
      "referenceID" : 2,
      "context" : "The Bernstein condition appears to have first been used by Bartlett and Mendelson (2006) in their analysis of empirical risk minimization; this condition is subtly different from the margin condition of Mammen and Tsybakov (1999) and Tsybakov (2004), which has been used to obtain fast rates for classification problems. Lecué (2011) pinpoints that the difference between the two conditions is that the margin condition applies to the excess loss relative to the best predictor (not necessarily in the model class) whereas the Bernstein condition applies to the excess loss relative to the best predictor in the model class.",
      "startOffset" : 59,
      "endOffset" : 334
    }, {
      "referenceID" : 8,
      "context" : "Condition (1) has a rich history, beginning from the foundational thesis of Li (1999) who studied the special case of η∗ = 1 in density estimation with log loss from the perspective of information geometry.",
      "startOffset" : 76,
      "endOffset" : 86
    }, {
      "referenceID" : 5,
      "context" : "The connections that Li showed between this condition and convexity were strengthened by Grünwald (2011, 2012) and Van Erven et al. (2012).",
      "startOffset" : 89,
      "endOffset" : 139
    }, {
      "referenceID" : 4,
      "context" : "For each hypothesis, this guarantee will flow from the Cramér-Chernoff method (Boucheron et al., 2013) by controlling the cumulant generating function (CGF) of −Zf in a particular way to yield exponential concentration.",
      "startOffset" : 78,
      "endOffset" : 102
    } ],
    "year" : 2014,
    "abstractText" : "Empirical risk minimization (ERM) is a fundamental learning rule for statistical learning problems where the data is generated according to some unknown distribution P and returns a hypothesis f chosen from a fixed class F with small loss `. In the parametric setting, depending upon (`,F ,P) ERM can have slow (1/ √ n) or fast (1/n) rates of convergence of the excess risk as a function of the sample size n. There exist several results that give sufficient conditions for fast rates in terms of joint properties of `, F , and P, such as the margin condition and the Bernstein condition. In the non-statistical prediction with expert advice setting, there is an analogous slow and fast rate phenomenon, and it is entirely characterized in terms of the mixability of the loss ` (there being no role there for F or P). The notion of stochastic mixability builds a bridge between these two models of learning, reducing to classical mixability in a special case. The present paper presents a direct proof of fast rates for ERM in terms of stochastic mixability of (`,F ,P), and in so doing provides new insight into the fast-rates phenomenon. The proof exploits an old result of Kemperman on the solution to the general moment problem. We also show a partial converse that suggests a characterization of fast rates for ERM in terms of stochastic mixability is possible.",
    "creator" : "LaTeX with hyperref package"
  }
}