{
  "name" : "1605.06796.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Interpretable Distribution Features with Maximum Testing Power",
    "authors" : [ "Wittawat Jitkrittum", "Zoltán Szabó", "Kacper Chwialkowski", "Arthur Gretton" ],
    "emails" : [ "wittawatj@gmail.com", "zoltan.szabo.m@gmail.com", "kacper.chwialkowski@gmail.com", "arthur.gretton@gmail.com" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "We address the problem of discovering features of distinct probability distributions, with which they can most easily be distinguished. The distributions may be in high dimensions, can differ in non-trivial ways (i.e., not simply in their means), and are observed only through i.i.d. samples. One application for such divergence measures is to model criticism, where samples from a trained model are compared with a validation sample: in the univariate case, through the KL divergence (Cinzia Carota and Polson, 1996), or in the multivariate case, by use of the maximum mean discrepancy (MMD) (Lloyd and Ghahramani, 2015). An alternative, interpretable analysis of a multivariate difference in distributions may be obtained by projecting onto a discriminative direction, such that the Wasserstein distance on this projection is maximized (Mueller and Jaakkola, 2015). Note that both recent works require low dimensionality, either explicitly (in the case of Lloyd and Gharamani, the function becomes difficult to plot in more than two dimensions), or implicitly in the case of Mueller and Jaakkola, in that a large difference in distributions must occur in projection along a particular one-dimensional axis. Distances between distributions in high dimensions may be more subtle, however, and it is of interest to find interpretable, distinguishing features of these distributions.\nIn the present paper, we take a hypothesis testing approach to discovering features which best distinguish two multivariate probability measures P and Q, as observed by samples X := {xi}ni=1 drawn independently and identically (i.i.d.) from P , and Y := {yi}ni=1 ⊂ Rd from Q. Nonparametric two-sample tests based on RKHS distances (Eric et al., 2008; Fromont et al., 2012; Gretton et al., 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al., 2012a; Sejdinovic et al., 2013). For this metric, a smooth witness function is computed, such that the amplitude is largest where the probability mass differs most (e.g. Gretton et al., 2012a,\n30th Conference on Neural Information Processing Systems (NIPS 2016), Barcelona, Spain.\nar X\niv :1\n60 5.\n06 79\n6v 2\n[ st\nat .M\nL ]\n2 8\nO ct\nFigure 1). Lloyd and Ghahramani (2015) used this witness function to compare the model output of the Automated Statistician (Lloyd et al., 2014) with a reference sample, yielding a visual indication of where the model fails. In high dimensions, however, the witness function cannot be plotted, and is less helpful. Furthermore, the witness function does not give an easily interpretable result for distributions with local differences in their characteristic functions. A more subtle shortcoming is that it does not provide a direct indication of the distribution features which, when compared, would maximize test power - rather, it is the witness function norm, and (broadly speaking) its variance under the null, that determine test power.\nOur approach builds on the analytic representations of probability distributions of Chwialkowski et al. (2015), where differences in expectations of analytic functions at particular spatial or frequency locations are used to construct a two-sample test statistic, which can be computed in linear time. Despite the differences in these analytic functions being evaluated at random locations, the analytic tests have greater power than linear time tests based on subsampled estimates of the MMD (Gretton et al., 2012b; Zaremba et al., 2013). Our first theoretical contribution, in Sec. 3, is to derive a lower bound on the test power, which can be maximized over the choice of test locations. We propose two novel tests, both of which significantly outperform the random feature choice of Chwialkowski et al.. The (ME) test evaluates the difference of mean embeddings at locations chosen to maximize the test power lower bound (i.e., spatial features); unlike the maxima of the MMD witness function, these features are directly chosen to maximize the distinguishability of the distributions, and take variance into account. The Smooth Characteristic Function (SCF) test uses as its statistic the difference of the two smoothed empirical characteristic functions, evaluated at points in the frequency domain so as to maximize the same criterion (i.e., frequency features). Optimization of the mean embedding kernels/frequency smoothing functions themselves is achieved on a held-out data set with the same consistent objective.\nAs our second theoretical contribution in Sec. 3, we prove that the empirical estimate of the test power criterion asymptotically converges to its population quantity uniformly over the class of Gaussian kernels. Two important consequences follow: first, in testing, we obtain a more powerful test with fewer features. Second, we obtain a parsimonious and interpretable set of features that best distinguish the probability distributions. In Sec. 4, we provide experiments demonstrating that the proposed linear-time tests greatly outperform all previous linear time tests, and achieve performance that compares to or exceeds the more expensive quadratic-time MMD test (Gretton et al., 2012a). Moreover, the new tests discover features of text data (NIPS proceedings) and image data (distinct facial expressions) which have a clear human interpretation, thus validating our feature elicitation procedure in these challenging high-dimensional testing scenarios."
    }, {
      "heading" : "2 ME and SCF tests",
      "text" : "In this section, we review the ME and SCF tests (Chwialkowski et al., 2015) for two-sample testing. In Sec. 3, we will extend these approaches to learn features that optimize the power of these tests. Given two samples X := {xi}ni=1,Y := {yi}ni=1 ⊂ Rd independently and identically distributed (i.i.d.) according to P and Q, respectively, the goal of a two-sample test is to decide whether P is different from Q on the basis of the samples. The task is formulated as a statistical hypothesis test proposing a null hypothesis H0 : P = Q (samples are drawn from the same distribution) against an alternative hypothesis H1 : P 6= Q (the sample generating distributions are different). A test calculates a test statistic λ̂n from X and Y, and rejectsH0 if λ̂n exceeds a predetermined test threshold (critical value). The threshold is given by the (1− α)-quantile of the (asymptotic) distribution of λ̂n under H0 i.e., the null distribution, and α is the significance level of the test.\nME test The ME test uses as its test statistic λ̂n, a form of Hotelling’s T-squared statistic, defined as λ̂n := nz>nS −1 n zn, where zn := 1 n ∑n i=1 zi, Sn := 1 n−1 ∑n i=1(zi − zn)(zi − zn)>, and zi := (k(xi,vj)− k(yi,vj))Jj=1 ∈ RJ . The statistic depends on a positive definite kernel k : X ×X → R (with X ⊆ Rd), and a set of J test locations V = {vj}Jj=1 ⊂ Rd. Under H0, asymptotically λ̂n follows χ2(J), a chi-squared distribution with J degrees of freedom. The ME test rejects H0 if λ̂n > Tα, where the test threshold Tα is given by the (1 − α)-quantile of the asymptotic null distribution χ2(J). Although the distribution of λ̂n under H1 was not derived, Chwialkowski et al. (2015) showed that if k is analytic, integrable and characteristic (in the sense of Sriperumbudur et al. (2011)), under H1, λ̂n can be arbitrarily large as n→∞, allowing the test to correctly reject H0.\nOne can intuitively think of the ME test statistic as a squared normalized (by the inverse covariance S−1n ) L\n2(X , VJ) distance of the mean embeddings (Smola et al., 2007) of the empirical measures Pn := 1 n ∑n i=1 δxi , and Qn := 1 n ∑n i=1 δyi where VJ := 1 J ∑J i=1 δvi , and δx is the Dirac measure concentrated at x. The unnormalized counterpart (i.e., without S−1n ) was shown by Chwialkowski et al. (2015) to be a metric on the space of probability measures for any V . Both variants behave similarly for two-sample testing, with the normalized version being a semimetric having a more computationally tractable null distribution, i.e., χ2(J).\nSCF test The SCF uses the test statistic which has the same form as the ME test statistic with a modified zi := [l̂(xi) sin(x>i vj) − l̂(yi) sin(y>i vj), l̂(xi) cos(x>i vj) − l̂(yi) cos(y>i vj)]Jj=1 ∈ R2J , where l̂(x) = ∫ Rd exp(−iu\n>x)l(u) du is the Fourier transform of l(x), and l : Rd → R is an analytic translation-invariant kernel i.e., l(x − y) defines a positive definite kernel for x and y. In contrast to the ME test defining the statistic in terms of spatial locations, the locations V = {vj}Jj=1 ⊂ Rd in the SCF test are in the frequency domain. As a brief description, let ϕP (w) := Ex∼P exp(iw>x) be the characteristic function of P . Define a smooth characteristic function as φP (v) = ∫ Rd ϕP (w)l(v − w) dw (Chwialkowski et al., 2015, Definition 2). Then, similar to the ME test, the statistic defined by the SCF test can be seen as a normalized (by S−1n ) version of L2(X , VJ) distance of empirical φP (v) and φQ(v). The SCF test statistic has asymptotic distribution χ2(2J) under H0. We will use J ′ to refer to the degrees of freedom of the chi-squared distribution i.e., J ′ = J for the ME test, and J ′ = 2J for the SCF test.\nIn this work, we modify the statistic with a regularization parameter γn > 0, giving λ̂n := nz>n (Sn + γnI) −1 zn, for stability of the matrix inverse. Using multivariate Slutsky’s theorem, under H0, λ̂n still asymptotically follows χ2(J ′) provided that γn → 0 as n→∞."
    }, {
      "heading" : "3 Lower bound on test power, consistency of empirical power statistic",
      "text" : "This section contains our main results. We propose to optimize the test locations V and kernel parameters (jointly referred to as θ) by maximizing a lower bound on the test power in Proposition 1. This criterion offers a simple objective function for fast parameter tuning. The bound may be of independent interest in other Hotelling’s T-squared statistics, since apart from the Gaussian case (e.g. Bilodeau and Brenner, 2008, Ch. 8), the characterization of such statistics under the alternative distribution is challenging. The optimization procedure is given in Sec. 4. We use Exy as a shorthand for Ex∼PEy∼Q and let ‖ · ‖F be the Frobenius norm. Proposition 1 (Lower bound on ME test power). Let K be a uniformly bounded (i.e., ∃B < ∞ such that supk∈K sup(x,y)∈X 2 |k(x,y)| ≤ B) family of k : X × X → R measurable kernels. Let V be a collection in which each element is a set of J test locations. Assume that c̃ := supV∈V,k∈K ‖Σ−1‖F < ∞. For large n, the test power P ( λ̂n ≥ Tα ) of the ME test sat-\nisfies P ( λ̂n ≥ Tα ) ≥ L(λn) where\nL(λn) := 1− 2e−ξ1(λn−Tα) 2/n − 2e−\n[γn(λn−Tα)(n−1)−ξ2n] 2\nξ3n(2n−1)2 − 2e−[(λn−Tα)/3−c3nγn] 2γ2n/ξ4 ,\nand c3, ξ1, . . . ξ4 are positive constants depending on only B, J and c̃. The parameter λn := nµ>Σ−1µ is the population counterpart of λ̂n := nz>n (Sn + γnI) −1 zn where µ = Exy[z1] and Σ = Exy[(z1 − µ)(z1 − µ)>]. For large n, L(λn) is increasing in λn.\nProof (sketch). The idea is to construct a bound for |λ̂n − λn| which involves bounding ‖zn − µ‖2 and ‖Sn−Σ‖F separately using Hoeffding’s inequality. The result follows after a reparameterization of the bound on P(|λ̂n − λn| ≥ t) to have P ( λ̂n ≥ Tα ) . See Sec. F for details.\nProposition 1 suggests that for large n it is sufficient to maximize λn to maximize a lower bound on the ME test power. The same conclusion holds for the SCF test (result omitted due to space constraints). Assume that k is characteristic (Sriperumbudur et al., 2011). It can be shown that λn = 0 if and only if P = Q i.e., λn is a semimetric for P and Q. In this sense, one can see λn as encoding the ease of rejecting H0. The higher λn, the easier for the test to correctly reject H0 when H1 holds. This observation justifies the use of λn as a maximization objective for parameter tuning.\nContributions The statistic λ̂n for both ME and SCF tests depends on a set of test locations V and a kernel parameter σ. We propose to set θ := {V, σ} = arg maxθ λn = arg maxθ µ>Σ−1µ. The optimization of θ brings two benefits: first, it significantly increases the probability of rejecting H0 when H1 holds; second, the learned test locations act as discriminative features allowing an interpretation of how the two distributions differ. We note that optimizing parameters by maximizing a test power proxy (Gretton et al., 2012b) is valid under both H0 and H1 as long as the data used for parameter tuning and for testing are disjoint. If H0 holds, then θ = arg max 0 is arbitrary. Since the test statistic asymptotically follows χ2(J ′) for any θ, the optimization does not change the null distribution. Also, the rejection threshold Tα depends on only J ′ and is independent of θ.\nTo avoid creating a dependency between θ and the data used for testing (which would affect the null distribution), we split the data into two disjoint sets. Let D := (X,Y) and Dtr,Dte ⊂ D such that Dtr ∩Dte = ∅ and Dtr ∪Dte = D. In practice, since µ and Σ are unknown, we use λ̂trn/2 in place of λn, where λ̂trn/2 is the test statistic computed on the training set D\ntr. For simplicity, we assume that each of Dtr and Dte has half of the samples in D. We perform an optimization of θ with gradient ascent algorithm on λ̂trn/2(θ). The actual two-sample test is performed using the test statistic λ̂ te n/2(θ) computed on Dte. The full procedure from tuning the parameters to the actual two-sample test is summarized in Sec. A.\nSince we use an empirical estimate λ̂trn/2 in place of λn for parameter optimization, we give a finitesample bound in Theorem 2 guaranteeing the convergence of z>n (Sn + γnI)\n−1zn to µ>Σ−1µ as n increases, uniformly over all kernels k ∈ K (a family of uniformly bounded kernels) and all test locations in an appropriate class. Kernel classes satisfying conditions of Theorem 2 include the widely used isotropic Gaussian kernel classKg = { kσ : (x,y) 7→ exp ( −(2σ2)−1‖x− y‖2 ) | σ > 0 } , and\nthe more general full Gaussian kernel class Kfull = {k : (x,y) 7→ exp ( −(x− y)>A(x− y) ) | A is positive definite} (see Lemma 5 and Lemma 6). Theorem 2 (Consistency of λ̂n in the ME test). Let X ⊆ Rd be a measurable set, and V be a collection in which each element is a set of J test locations. All suprema over V and k are to be understood as supV∈V and supk∈K respectively. For a class of kernels K on X ⊆ Rd, define\nF1 := {x 7→ k(x,v) | k ∈ K,v ∈ X}, F2 := {x 7→ k(x,v)k(x,v′) | k ∈ K,v,v′ ∈ X}, (1) F3 := {(x,y) 7→ k(x,v)k(y,v′) | k ∈ K,v,v′ ∈ X}. (2)\nAssume that (1) K is a uniformly bounded (by B) family of k : X × X → R measurable kernels, (2) c̃ := supV,k ‖Σ−1‖F < ∞, and (3) Fi = {fθi | θi ∈ Θi} is VC-subgraph with VC-index V C(Fi), and θ 7→ fθi(m) is continuous (∀m, i = 1, 2, 3). Let c1 := 4B2J √ Jc̃, c2 := 4B √ Jc̃, and c3 := 4B2Jc̃2. Let Ci-s (i = 1, 2, 3) be the universal constants associated to Fi-s according to Theorem 2.6.7 in van der Vaart and Wellner (2000). Then for any δ ∈ (0, 1) with probability at least 1− δ,\nsup V,k ∣∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣∣ ≤ 2TF1 ( 2\nγn c1BJ 2n− 1 n− 1 + c2 √ J\n) + 2\nγn c1J(TF2 + TF3) +\n8\nγn\nc1B 2J\nn− 1 + c3γn,where\nTFj = 16 √ 2Bζj√ n\n( 2 √ log [ Cj × V C(Fj)(16e)V C(Fj) ] + √ 2π[V C(Fj)− 1]\n2\n) +Bζj √ 2 log(5/δ)\nn ,\nfor j = 1, 2, 3 and ζ1 = 1, ζ2 = ζ3 = 2.\nProof (sketch). The idea is to lower bound the difference with an expression involving supV,k ‖zn − µ‖2 and supV,k ‖Sn −Σ‖F . These two quantities can be seen as suprema of empirical processes, and can be bounded by Rademacher complexities of their respective function classes (i.e., F1,F2, and F3). Finally, the Rademacher complexities can be upper bounded using Dudley entropy bound and VC subgraph properties of the function classes. Proof details are given in Sec. D.\nTheorem 2 implies that if we set γn = O(n−1/4), then we have supV,k ∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣ = Op(n−1/4) as the rate of convergence. Both\nProposition 1 and Theorem 2 require c̃ := supV∈V,k∈K ‖Σ−1‖F < ∞ as a precondition. To guarantee that c̃ < ∞, a concrete construction of K is the isotropic Gaussian kernel class Kg, where σ is constrained to be in a compact set. Also, consider V := {V | any two locations are at least distance apart, and all test locations have their norms bounded by ζ} for some , ζ > 0. Then, for any non-degenerate P,Q, we have c̃ < ∞ since (σ,V) 7→ λn is continuous, and thus attains its supremum over compact sets K and V.\n4 Experiments\nIn this section, we demonstrate the effectiveness of the proposed methods on both toy and real problems. We consider the isotropic Gaussian kernel class Kg in all kernel-based tests. We study seven two-sample test algorithms. For the SCF test, we set l̂(x) = k(x,0). Denote by MEfull and SCF-full the ME and SCF tests whose test locations and the Gaussian width σ are fully optimized using gradient ascent on a separate training sample (Dtr) of the same size as the test set (Dte). ME-grid and SCF-grid are as in Chwialkowski et al. (2015) where only the Gaussian width is optimized by a grid search,1and the test locations are randomly drawn from a multivariate normal distribution. MMD-quad (quadratic-time) and MMD-lin (linear-time) re-\nfer to the nonparametric tests based on maximum mean discrepancy of Gretton et al. (2012a), where to ensure a fair comparison, the Gaussian kernel width is also chosen so as to maximize a criterion for the test power on training data, following the same principle as (Gretton et al., 2012b). For MMDquad, since its null distribution is given by an infinite sum of weighted chi-squared variables (no closed-form quantiles), in each trial we randomly permute the two samples 400 times to approximate the null distribution. Finally, T 2 is the standard two-sample Hotelling’s T-squared test, which serves as a baseline with Gaussian assumptions on P and Q.\nIn all the following experiments, each problem is repeated for 500 trials. For toy problems, new samples are generated from the specified P,Q distributions in each trial. For real problems, samples are partitioned randomly into training and test sets in each trial. In all of the simulations, we report an empirical estimate of P(λ̂ten/2 ≥ Tα) which is the proportion of the number of times the statistic λ̂ te n/2 is above Tα. This quantity is an estimate of type-I error under H0, and corresponds to test power when H1 is true. We set α = 0.01 in all the experiments. All the code and preprocessed data are available at https://github.com/wittawatj/interpretable-test.\nOptimization The parameter tuning objective λ̂trn/2(θ) is a function of θ consisting of one real-valued σ and J test locations each of d dimensions. The parameters θ can thus be regarded as a Jd + 1 Euclidean vector. We take the derivative of λ̂trn/2(θ) with respect to θ, and use gradient ascent to maximize it. J is pre-specified and fixed. For the ME test, we initialize the test locations with realizations from two multivariate normal distributions fitted to samples from P and Q; this ensures that the initial locations are well supported by the data. For the SCF test, initialization using the standard normal distribution is found to be sufficient. The parameter γn is not optimized; we set the regularization parameter γn to be as small as possible while being large enough to ensure that (Sn + γnI)\n−1 can be stably computed. We emphasize that both the optimization and testing are linear in n. The testing cost O(J3 + J2n + dJn) and the optimization costs O(J3 + dJ2n) per gradient ascent iteration. Runtimes of all methods are reported in Sec. C in the appendix.\n1. Informative features: simple demonstration We begin with a demonstration that the proxy λ̂trn/2(θ) for the test power is informative for revealing the difference of the two samples in the ME\n1Chwialkowski et al. (2015) chooses the Gaussian width that minimizes the median of the p-values, a heuristic that does not directly address test power. Here, we perform a grid search to choose the best Gaussian width by maximizing λ̂trn/2 as done in ME-full and SCF-full.\ntest. We consider the Gaussian Mean Difference (GMD) problem (see Table 1), where both P and Q are two-dimensional normal distributions with the difference in means. We use J = 2 test locations v1 and v2, where v1 is fixed to the location indicated by the black triangle in Fig. 1. The contour plot shows v2 7→ λ̂trn/2(v1,v2).\nFig. 1 (top) suggests that λ̂trn/2 is maximized when v2 is placed in either of the two regions that captures the difference of the two samples i.e., the region in which the probability masses of P and Q have less overlap. Fig. 1 (bottom), we consider placing v1 in one of the two key regions. In this case, the contour plot shows that v2 should be placed in the other region to maximize λ̂trn/2, implying that placing multiple test locations in the same neighborhood will not increase the discriminability. The two modes on the left and right suggest two ways to place the test location in a region that reveals the difference. The non-convexity of the λ̂trn/2 is an indication of many informative ways to detect differences of P and Q, rather than a drawback. A convex objective would not capture this multimodality.\n2. Test power vs. sample size n We now demonstrate the rate of increase of test power with sample size. When the null hypothesis holds, the type-I error stays at the specified level α. We consider the following four toy problems: Same Gaussian (SG), Gaussian mean difference (GMD), Gaussian variance difference (GVD), and Blobs. The specifications of P and Q are summarized in Table. 1. In the Blobs problem, P and Q are defined as a mixture of Gaussian distributions arranged on a 4× 4 grid in R2. This problem is challenging as the difference of P and Q is encoded at a much smaller length scale compared to the global structure (Gretton et al., 2012b). Specifically, the eigenvalue ratio for the covariance of each Gaussian distribution is 2.0 in P , and 1.0 in Q. We set J = 5 in this experiment.\nThe results are shown in Fig. 2 where type-I error (for SG problem), and test power (for GMD, GVD and Blobs problems) are plotted against test sample size. A number of observations are worth noting. In the SG problem, we see that the type-I error roughly stays at the specified level: the rate of rejection of H0 when it is true is roughly at the specified level α = 0.01.\nGMD with 100 dimensions turns out to be an easy problem for all the tests except MMD-lin. In the GVD and Blobs cases, ME-full and SCFfull achieve substantially higher test power than ME-grid and SCF-grid,\nrespectively, suggesting a clear advantage from optimizing the test locations. Remarkably, ME-full consistently outperforms the quadratic-time MMD across all test sample sizes in the GVD case. When the difference of P and Q is subtle as in the Blobs problem, ME-grid, which uses randomly drawn test locations, can perform poorly (see Fig. 2d) since it is unlikely that randomly drawn locations will be placed in the key regions that reveal the difference. In this case, optimization of the test locations can considerably boost the test power (see ME-full in Fig. 2d). Note also that SCF variants perform significantly better than ME variants on the Blobs problem, as the difference in P and Q is localized in the frequency domain; ME-full and ME-grid would require many more test locations in the spatial domain to match the test powers of the SCF variants. For the same reason, SCF-full does much better than the quadratic-time MMD across most sample sizes, as the latter represents a weighted distance between characteristic functions integrated across the entire frequency domain (Sriperumbudur et al., 2010, Corollary 4).\n3. Test power vs. dimension d We next investigate how the dimension (d) of the problem can affect type-I errors and test powers of ME and SCF tests. We consider the same artificial problems: SG, GMD and GVD. This time, we fix the test sample size to 10000, set J = 5, and vary the dimension. The results are shown in Fig. 3. Due to the large dimensions and sample size, it is computationally infeasible to run MMD-quad.\nWe observe that all the tests except the T-test can maintain type-I error at roughly the specified significance level α = 0.01 as dimension increases. The type-I performance of the T-test is incorrect at large d because of the difficulty in accurately estimating the covariance matrix in high dimensions. It is interesting to note the high performance of ME-full in the GMD problem in Fig. 3b. ME-full achieves the maximum test power of 1.0 throughout and matches the power T-test, in spite of being nonparametric and making no assumption on P andQ (the T-test is further advantaged by its excessive Type-I error). However, this is true only with optimization of the test locations. This is reflected in the test power of ME-grid in Fig. 3b which drops monotonically as dimension increases, highlighting the importance of test location optimization. The performance of MMD-lin degrades quickly with increasing dimension, as expected from Ramdas et al. (2015).\n4. Distinguishing articles from two categories We now turn to performance on real data. We first consider the problem of distinguishing two categories of publications at the conference on Neural Information Processing Systems (NIPS). Out of 5903 papers published in NIPS from 1988 to 2015, we manually select disjoint subsets related to Bayesian inference (Bayes), neuroscience (Neuro), deep learning (Deep), and statistical learning theory (Learn) (see Sec. B). Each paper is represented as a bag of words using TF-IDF (Manning et al., 2008) as features. We perform stemming, remove all stop words, and retain only nouns. A further filtering of document-frequency (DF) of words that satisfies 5 ≤ DF ≤ 2000 yields approximately 5000 words from which 2000 words (i.e., d = 2000 dimensions) are randomly selected. See Sec. B for more details on the preprocessing. For ME and SCF tests, we use only one test location i.e., set J = 1. We perform 1000 permutations to approximate the null distribution of MMD-quad in this and the following experiments.\nType-I errors and test powers are summarized in Table. 2. The first column indicates the categories of the papers in the two samples. In Bayes-Bayes problem, papers on Bayesian inference are randomly partitioned into two samples in each trial. This task represents a case in which H0 holds. Among all the linear-time tests, we observe that ME-full has the highest test power in all the tasks, attaining a maximum test power of 1.0 in the Bayes-Neuro problem. This high performance assures that although different test locations V may be selected in different trials, these locations are each informative. It is interesting to observe that ME-full has performance close to or better than MMD-quad, which requires O(n2) runtime complexity. Besides clear advantages of interpretability and linear runtime of the proposed tests, these results suggest that evaluating the differences in expectations of analytic functions at particular locations can yield an equally powerful test at a much lower cost, as opposed to\ncomputing the RKHS norm of the witness function as done in MMD. Unlike Blobs, however, Fourier features are less powerful in this setting.\nWe further investigate the interpretability of the ME test by the following procedure. For the learned test location vt ∈ Rd (d = 2000) in trial t, we construct ṽt = (ṽt1, . . . , ṽtd) such that ṽtj = |vtj |. Let ηtj ∈ {0, 1} be an indicator variable taking value 1 if ṽtj is among the top five largest for all j ∈ {1, . . . , d}, and 0 otherwise. Define ηj := ∑ t η t j as a proxy indicating the significance of word j i.e., ηj is high if word j is frequently among the top five largest as measured by ṽtj . The top seven words as sorted in descending order by ηj in the Bayes-Neuro problem are spike, markov, cortex, dropout, recurr, iii, gibb, showing that the learned test locations are highly interpretable. Indeed, “markov” and “gibb” (i.e., stemmed from Gibbs) are discriminative terms in Bayesian inference category, and “spike” and “cortex” are key terms in neuroscience. We give full lists of discriminative terms learned in all the problems in Sec. B.1. To show that not all the randomly selected 2000 terms are informative, if the definition of ηtj is modified to consider the least important words (i.e., ηj is high if word j is frequently among the top five smallest as measured by ṽtj), we instead obtain circumfer, bra, dominiqu, rhino, mitra, kid, impostor, which are not discriminative.\n(a) HA (b) NE (c) SU\n(d) AF (e) AN (f) DI (g) v1\nFigure 4: (a)-(f): Six facial expressions of actor AM05 in the KDEF data. (g): Average across trials of the learned test locations v1.\n5. Distinguishing positive and negative emotions In the final experiment, we study how well ME and SCF tests can distinguish two samples of photos of people showing positive and negative facial expressions. Our emphasis is on the discriminative features of the faces identified by ME test showing how the two groups differ. For this purpose, we use Karolinska Directed Emotional Faces (KDEF) dataset (Lundqvist et al., 1998) containing 5040 aligned face images of 70 amateur actors, 35 females and 35 males. We use only photos showing front views of the faces. In the dataset, each actor displays seven expressions: happy (HA), neutral (NE), surprised (SU), sad (SA), afraid (AF), angry (AN), and disgusted (DI). We assign HA, NE, and SU faces into the positive emotion group (i.e., samples from P ), and AF, AN and DI faces into the negative emotion group (samples from Q). We denote this problem as “+ vs. −”. Examples of six facial expressions from one actor are shown in Fig. 4. Photos of the SA group are unused to keep the sizes of the two samples\nthe same. Each image of size 562 × 762 pixels is cropped to exclude the background, resized to 48× 34 = 1632 pixels (d), and converted to grayscale. We run the tests 500 times with the same setting used previously i.e., Gaussian kernels, and J = 1. The type-I errors and test powers are shown in Table 3. In the table, “± vs. ±” is a problem in which all faces expressing the six emotions are randomly split into two samples of equal sizes i.e., H0 is true. Both ME-full and SCF-full achieve high test powers while maintaining the correct type-I errors.\nAs a way to interpret how positive and negative emotions differ, we take an average across trials of the learned test locations of ME-full in the “+ vs. −” problem. This average is shown in Fig. 4g. We see that the test locations faithfully capture the difference of positive and negative emotions by giving more weights to the regions of nose, upper lip, and nasolabial folds (smile lines), confirming the interpretability of the test in a high-dimensional setting."
    }, {
      "heading" : "Acknowledgement",
      "text" : "We thank the Gatsby Charitable Foundation for the financial support."
    }, {
      "heading" : "A Algorithm",
      "text" : "The full algorithm for the proposed tests from parameter tuning to the actual two-sample testing is given in Algorithm 1.\nAlgorithm 1 Optimizing parameters and testing Input: Two samples X, Y, significance level α, and number of test locations J\n1: Split D := (X,Y) into disjoint training and test sets, Dtr and Dte, of the same size nte. 2: Optimize parameters θ = arg maxθ λ̂trn/2(θ) where λ̂ tr n/2(θ) is computed with the training set D\ntr. 3: Set Tα to the (1− α)-quantile of χ2(J ′). 4: Compute the test statistic λ̂ten/2(θ) using D te. 5: Reject H0 if λ̂ten/2(θ) > Tα."
    }, {
      "heading" : "B Experiments on NIPS text collection",
      "text" : "The full procedure for processing the NIPS text collection is summarized as following.\n1. Download all 5903 papers from 1988 to 2015 from https://papers.nips.cc/ as PDF files.\n2. Convert each PDF file to text with pdftotext2.\n3. Remove all stop words. We use the list of stop words from http://www.ranks.nl/stopwords.\n4. Keep only nouns. We use the list of nouns as available in WordNet-3.03.\n5. Keep only words which contain only English alphabets i.e., does not contain punctuations or numbers. Also, word length must be between 3 and 20 characters (inclusive).\n6. Keep only words which occur in at least 5 documents, and in no more than 2000 documents.\n7. Convert all characters to small case. Stem all words with SnowballStemmer in NLTK (Bird et al., 2009). For example, “recognize” and “recognizer” become “recogn” after stemming.\n8. Categorize papers into disjoint collections. A paper is treated as belonging to a group if its title has at least one word from the list of keywords for the category. Papers that match the criteria of both categories are not considered. The lists of keywords are as follows.\n(a) Bayesian inference (Bayes): graphical model, bayesian, inference, mcmc, monte carlo, posterior, prior, variational, markov, latent, probabilistic, exponential family.\n(b) Deep learning (Deep): deep, drop out, auto-encod, convolutional, neural net, belief net, boltzmann. (c) Learning theory (Learn): learning theory, consistency, theoretical guarantee, complexity, pac-\nbayes, pac-learning, generalization, uniform converg, bound, deviation, inequality, risk min, minimax, structural risk, VC, rademacher, asymptotic.\n(d) Neuroscience (Neuro): motor control, neural, neuron, spiking, spike, cortex, plasticity, neural decod, neural encod, brain imag, biolog, perception, cognitive, emotion, synap, neural population, cortical, firing rate, firing-rate, sensor.\n9. Randomly select 2000 words from the remaining words.\n10. Treat each paper as a bag of words and construct a feature vector with TF-IDF (Manning et al., 2008).\n2pdftotext is available at http://poppler.freedesktop.org. 3WordNet is available online at https://wordnet.princeton.edu/wordnet/citing-wordnet/.\nB.1 Discriminative terms identified by ME test\nIn this section, we provide full lists of discriminative terms following the procedure described in Sec. 4. The top ten words in each problem are as follows.\n• Bayes-Bayes: collabor, traffic, bay, permut, net, central, occlus, mask, draw, joint. • Bayes-Deep: infer, bay, mont, adaptor, motif, haplotyp, ecg, covari, boltzmann, classifi. • Bayes-Learn: infer, markov, graphic, segment, bandit, boundari, favor, carlo, prioriti, prop. • Bayes-Neuro: spike, markov, cortex, dropout, recurr, iii, gibb, basin, circuit, subsystem. • Learn-Deep: deep, forward, delay, subgroup, bandit, recept, invari, overlap, inequ, pia. • Learn-Neuro: polici, interconnect, hardwar, decay, histolog, edg, period, basin, inject, human."
    }, {
      "heading" : "C Runtimes",
      "text" : ""
    }, {
      "heading" : "D Proof of theorem 2",
      "text" : "Recall Theorem 2: Theorem 2 (Consistency of λ̂n in the ME test). Let X ⊆ Rd be a measurable set, and V be a collection in which each element is a set of J test locations. All suprema over V and k are to be understood as supV∈V and supk∈K respectively. For a class of kernels K on X ⊆ Rd, define\nF1 := {x 7→ k(x,v) | k ∈ K,v ∈ X}, F2 := {x 7→ k(x,v)k(x,v′) | k ∈ K,v,v′ ∈ X}, (1) F3 := {(x,y) 7→ k(x,v)k(y,v′) | k ∈ K,v,v′ ∈ X}. (2)\nAssume that (1) K is a uniformly bounded (by B) family of k : X × X → R measurable kernels, (2) c̃ := supV,k ‖Σ−1‖F <∞, and (3) Fi = {fθi | θi ∈ Θi} is VC-subgraph with VC-index V C(Fi), and θ 7→ fθi(m) is continuous (∀m, i = 1, 2, 3). Let c1 := 4B2J √ Jc̃, c2 := 4B √ Jc̃, and c3 := 4B2Jc̃2. Let Ci-s (i = 1, 2, 3) be the universal constants associated to Fi-s according to Theorem 2.6.7 in van der Vaart and Wellner (2000). Then for any δ ∈ (0, 1) with probability at least 1− δ,\nsup V,k ∣∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣∣ ≤ 2TF1 ( 2\nγn c1BJ 2n− 1 n− 1 + c2 √ J\n) + 2\nγn c1J(TF2 + TF3) +\n8\nγn\nc1B 2J\nn− 1 + c3γn,where\nTFj = 16 √ 2Bζj√ n\n( 2 √ log [ Cj × V C(Fj)(16e)V C(Fj) ] + √ 2π[V C(Fj)− 1]\n2\n) +Bζj √ 2 log(5/δ)\nn ,\nfor j = 1, 2, 3 and ζ1 = 1, ζ2 = ζ3 = 2.\nA proof is given as follows."
    }, {
      "heading" : "D.1 Notations",
      "text" : "Let 〈A,B〉F := tr ( A>B ) be the Frobenius inner product, and ‖A‖F := √ 〈A,A〉F . A 0 means that A ∈ Rd×d is symmetric, positive semidefinite. For a ∈ Rd, ‖a‖2 = 〈a,a〉2 = a>a. [a1; . . . ; aN ] ∈ Rd1+...+dN is the concatenation of the an ∈ Rdn vectors. R+ is the set of positive reals. f ◦ g is the composition of function f and g. LetM denote a general metric space below. In measurability requirements metric spaces are meant to be endowed with their Borel σ-algebras.\nLet C be a collection of subsets ofM (C ⊆ 2M). C is said to shatter an {p1, p2, . . . , pi} ⊆ M set, if for any S ⊆ {p1, p2, . . . , pi} there exist C ∈ C such that S = C ∩ {p1, p2, . . . , pi}; in other words, arbitrary subset of {p1, p2, . . . , pi} can be cut out by an element of C. The VC index of C is the smallest i for which no set of size i is shattered:\nV C (C) = inf { i : max\np1,...,pi |{C ∩ {p1, . . . , pi} : C ∈ C}| < 2i\n} .\nA collection C of measurable sets is called VC-class if its index V C (C) is finite. The subgraph of a real-valued function f :M→ R is sub(f) = {(m,u) : u < f(m)} ⊆ M× R. A collection of F measurable functions is called VC-subgraph class, or shortly VC if the collection of all subgraphs of F , {sub(f)}f∈F is a VC-class of sets; its index is defined as V C (F) := V C ( {sub(f)}f∈F ) .\nLet L0(M) be the set ofM→ R measurable functions. Given an i.i.d. (independent identically distributed) sample from P (wi i.i.d.∼ P), let w1:n = (w1, . . . , wn) and let Pn = 1n ∑n i=1 δwi denote the empirical measure.\nLq (M,Pn) = { f ∈ L0 (M) : ‖f‖Lq(M,Pn) := [∫ M |f(w)| qdPn(w) ] 1 q = [ 1 n ∑n i=1 |f(wi)|q ] 1 q <∞ } (1 ≤\nq <∞), ‖f‖L∞(M) := supm∈M |f(m)|. Define Pf := ∫ M f(w)dP(w), where P is a probability distribution onM. Let ‖Pn − P‖F := supf∈F |Pnf − Pf |.\nThe diameter of a class F ⊆ L2 (M,Pn) is diam(F , L2(M,Pn)) := supf,f ′∈F ‖f − f ′‖L2(M,Pn), its rcovering number (r > 0) is the size of the smallest r-net\nN ( r,F , L2 (M,Pn) ) = inf { t ≥ 1 : ∃f1, . . . , ft ∈ F such that F ⊆ ∪ti=1B(r, fi) } ,\nwhere B(r, f) = { g ∈ L2 (M,Pn) | ‖f − g‖L2(M,Pn) ≤ r } is the ball with center f and radius r. ×Ni=1Qi is the N -fold product measure. For sets Qi, ×ni=1Qi is their Cartesian product. For a function class F ⊆ L0 (M) and w1:n ∈Mn, R(F , w1:n) := Er [ supf∈F ∣∣ 1 n ∑n i=1 rif(wi)\n∣∣] is the empirical Rademacher average, where r := r1:n and ri-s are i.i.d. samples from a Rademacher random variable [P(ri = 1) = P(ri = −1) = 12 ]. Let (Θ, ρ) be a metric space; a collection of F = {fθ | θ ∈ Θ} ⊆ L0(M) functions is called a separable Carathéodory family if Θ is separable and θ 7→ fθ(m) is continuous for all m ∈M. span(·) denotes the linear hull of its arguments. Γ(t) = ∫∞ 0 ut−1e−udu denotes the Gamma function."
    }, {
      "heading" : "D.2 Bound in terms of Sn and zn",
      "text" : "For brevity, we will interchangeably use Sn for Sn(V) and zn for zn(V). Sn(V) and zn(V) will be used mainly when the dependency of V needs to be emphasized. We start with supV,k ∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣and upper bound the argument of supV,k as∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣\n= ∣∣∣z>n (Sn + γnI)−1zn − µ> (Σ + γnI)−1 µ + µ> (Σ + γnI)−1 µ− µ>Σ−1µ∣∣∣\n≤ ∣∣∣z>n (Sn + γnI)−1zn − µ> (Σ + γnI)−1 µ∣∣∣+ ∣∣∣µ> (Σ + γnI)−1 µ− µ>Σ−1µ∣∣∣\n:= ( 1) + ( 2).\nFor ( 1), we have∣∣∣z>n (Sn + γnI)−1zn − µ> (Σ + γnI)−1 µ∣∣∣ = ∣∣∣〈znz>n , (Sn + γnI)−1〉F − 〈µµ>, (Σ + γnI)−1〉F ∣∣∣\n= ∣∣∣〈znz>n , (Sn + γnI)−1〉F − 〈znz>n , (Σ + γnI)−1〉F + 〈znz>n , (Σ + γnI)−1〉F − 〈µµ>, (Σ + γnI)−1〉F ∣∣∣\n≤ ∣∣∣〈znz>n , (Sn + γnI)−1 − (Σ + γnI)−1〉\nF ∣∣∣+ ∣∣∣〈znz>n − µµ>, (Σ + γnI)−1〉 F ∣∣∣ = ‖znz>n ‖F ‖(Sn + γnI)−1 − (Σ + γnI) −1 ‖F + ‖znz>n − µµ>‖F ‖ (Σ + γnI) −1 ‖F\n(a) ≤ ‖znz>n ‖F ‖(Sn + γnI)−1[(Σ + γnI)− (Sn + γnI)] (Σ + γnI) −1 ‖F + ‖znz>n − znµ> + znµ> − µµ>‖F ‖Σ−1‖F\n(a) ≤ ‖znz>n ‖F ‖(Sn + γnI)−1‖F ‖Σ− Sn‖F ‖Σ−1‖F + ‖zn(zn − µ)>‖F ‖Σ−1‖F + ‖(zn − µ)µ>‖F ‖Σ−1‖F (b)\n≤ √ J\nγn ‖zn‖22‖Σ− Sn‖F ‖Σ−1‖F + ‖zn‖2‖zn − µ‖2‖Σ−1‖F + ‖µ‖2‖zn − µ‖2‖Σ−1‖F ,\nwhere at (a) we use ‖ (Σ + γnI)−1 ‖F ≤ ‖Σ−1‖F and at (b) we use ‖(Sn + γnI)−1‖F ≤ √ J‖(Sn + γnI) −1‖2 ≤ √ J/γn. For ( 2), we have∣∣∣µ> (Σ + γnI)−1 µ− µ>Σ−1µ∣∣∣ = ∣∣∣〈µµ>, (Σ + γnI)−1 −Σ−1〉 F\n∣∣∣ ≤ ‖µµ>‖F ‖ (Σ + γnI)−1 −Σ−1‖F = ‖µ‖22‖ (Σ + γnI) −1 [Σ− (Σ + γnI)] Σ−1‖F = γn‖µ‖22‖‖ (Σ + γnI) −1\nΣ−1‖F ≤ γn‖µ‖22‖‖ (Σ + γnI)\n−1 ‖F ‖Σ−1‖F (a)\n≤ γn‖µ‖22‖‖Σ−1‖2F . Combining the upper bounds for ( 1) and ( 2), we arrive at∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣\n≤ √ J\nγn ‖zn‖22‖Σ− Sn‖F ‖Σ−1‖F + (‖zn‖2 + ‖µ‖2)‖zn − µ‖2‖Σ−1‖F + γn‖µ‖22‖‖Σ−1‖2F\n≤ 4B2Jc̃ √ J\nγn ‖Σ− Sn‖F + 4B\n√ Jc̃‖zn − µ‖2 + 4B2Jc̃2γn\n= c1 γn ‖Σ− Sn‖F + c2‖zn − µ‖2 + c3γn (3)\nwith c1 := 4B2J √ Jc̃, c2 := 4B √ Jc̃, c3 := 4B\n2Jc̃2, and c̃ := supV,k ‖Σ−1‖F < ∞, where we applied the triangle inequality, the CBS (Cauchy-Bunyakovskii-Schwarz) inequality, and ‖ab>‖F = ‖a‖2‖b‖2. The boundedness of kernel k with the Jensen inequality implies that\n‖z̄n‖22 = ‖ 1\nn n∑ i=1 zi‖22 ≤ 1 n n∑ i=1 ‖zi‖22 = 1 n n∑ i=1 ‖(k(xi,vj)− k(yi,vj))Jj=1‖22 (4)\n= 1\nn n∑ i=1 J∑ j=1 [k(xi,vj)− k(yi,vj)]2\n≤ 2 n n∑ i=1 J∑ j=1 k2(xi,vj) + k 2(yi,vj) ≤ 4B2J, (5)\n‖µ(V)‖22 = J∑ j=1 (Exy [k(x,vj)− k(y,vj)])2 ≤ J∑ j=1 Exy [k(x,vj)− k(y,vj)]2 ≤ 4B2J. (6)\nTaking sup in (3), we get\nsup V,k ∣∣z>n (Sn + γnI)−1zn − µ>Σ−1µ∣∣ ≤ c1γn supV,k ‖Σ− Sn‖F + c2 supV,k ‖zn − µ‖2 + c3γn."
    }, {
      "heading" : "D.3 Empirical process bound on z̄n",
      "text" : "Recall that z̄n (V) = 1n ∑n i=1 zi (V) ∈ RJ , zi (V) = (k(xi,vj) − k(yi,vj))Jj=1 ∈ RJ , µ(V) = (Exy [k(x,vj)− k(y,vj)])Jj=1; thus\nsup V sup k∈K ‖z̄n(V)− µ(V)‖2 = sup V sup k∈K sup b∈B(1,0) 〈b, z̄n(V)− µ(V)〉2\nusing that ‖a‖2 = supb∈B(1,0) 〈a,b〉2. Let us bound the argument of the supremum: 〈b, z̄n(V)− µ(V)〉2 ≤ J∑ j=1 |bj | ∣∣∣∣∣ 1n n∑ i=1 [k(xi,vj)− k(yi,vj)]− Exy [k(x,vj)− k(y,vj)] ∣∣∣∣∣ ≤\nJ∑ j=1 |bj | (∣∣∣∣∣ 1n n∑ i=1 k(xi,vj)− Exk(x,vj) ∣∣∣∣∣+ ∣∣∣∣∣ 1n n∑ i=1 k(yi,vj)− Eyk(y,vj) ∣∣∣∣∣ )\n≤ √ J sup\nv∈X sup k∈K ∣∣∣∣∣ 1n n∑ i=1 k(xi,v)− Exk(x,v) ∣∣∣∣∣+√J supv∈X supk∈K ∣∣∣∣∣ 1n n∑ i=1 k(yi,v)− Eyk(y,v) ∣∣∣∣∣ = √ J ‖Pn − P‖F1 + √ J ‖Qn −Q‖F1 (7)\nby the triangle inequality and exploiting that ‖b‖1 ≤ √ J ‖b‖2 ≤ √ J with b ∈ B(1,0). Thus, we have\nsup V sup k∈K ‖z̄n(V)− µ(V)‖2 ≤\n√ J ‖Pn − P‖F1 + √ J ‖Qn −Q‖F1 ."
    }, {
      "heading" : "D.4 Empirical process bound on Sn",
      "text" : "Noting that\nΣ(V) = Exy [ z(V)z>(V) ] − µ(V)µ>(V), Sn(V) = 1\nn n∑ a=1 za(V)z>a (V)− 1 n(n− 1) n∑ a=1 ∑ b6=a zaz T b ,\nExy [ z(V)z>(V) ] = Exy\n[ 1\nn n∑ a=1 za(V)z>a (V)\n] , µ(V)µ>(V) = Exy  1 n(n− 1) n∑ a=1 ∑ b6=a za(V)zTb (V)  , we bound our target quantity as\n‖Sn(V)−Σ(V)‖F ≤ ∥∥∥∥∥ 1n n∑ a=1 za(V)z>a (V)− Exy [ z(V)z>(V) ]∥∥∥∥∥ F + ∥∥∥∥∥∥ 1n(n− 1) n∑ a=1 ∑ b 6=a za(V)zTb (V)− µ(V)µ>(V) ∥∥∥∥∥∥ F\n=: (∗1) + (∗2). (8)\n(∗2) = ∥∥∥∥∥∥ 1n n∑ a=1 za(V)  1 n− 1 ∑ b6=a z>b (V) − µ(V)µ>(V) ∥∥∥∥∥∥ F\n≤ ∥∥∥∥∥∥ 1n n∑ a=1 za(V)  1 n− 1 ∑ b 6=a z>b (V)− µ>(V) ∥∥∥∥∥∥ F + ∥∥∥∥∥ ( 1 n n∑ a=1 za(V)− µ(V) ) µ>(V) ∥∥∥∥∥ F\n≤ ∥∥∥∥∥∥ ( 1 n n∑ a=1 za(V) )( 1 n− 1 n∑ b=1 zb(V)− µ(V) )>∥∥∥∥∥∥ F + ∥∥∥∥∥ ( 1 n n∑ a=1 za(V) ) z>a (V) n− 1 ∥∥∥∥∥ F\n+ ∥∥∥∥∥ ( 1 n n∑ a=1 za(V)− µ(V) ) µ>(V) ∥∥∥∥∥ F\n= ‖z̄n(V)‖2 ∥∥∥∥∥ 1n− 1 n∑ b=1 zb(V)− µ(V) ∥∥∥∥∥ 2 + 1 n− 1 ‖z̄n(V)‖2 ‖za(V)‖2 + ‖z̄n(V)− µ(V)‖2 ‖µ(V)‖2\n≤ 2B √ J\n( n\nn− 1 ‖z̄n − µ(V)‖2 +\n2B √ J\nn− 1\n) + 1\nn− 1 4B2J + 2B\n√ J ‖z̄n(V)− µ(V)‖2\n= 8B2J\nn− 1 + 2B\n√ J 2n− 1 n− 1 ‖z̄n − µ(V)‖2 (9)\nusing the triangle inequality, the sub-additivity of sup, ∥∥abT∥∥\nF = ‖a‖2 ‖b‖2, ‖z̄n(V)‖2 ≤ 2B √ J , ‖za(V)‖2 ≤\n2B √ J [see Eq. (5)] and∥∥∥∥∥ 1n− 1 n∑ b=1 zb(V)− µ(V) ∥∥∥∥∥ 2 = ∥∥∥∥ nn− 1 z̄n − nn− 1µ(V) + 1n− 1µ(V) ∥∥∥∥ 2 ≤ n n− 1 ‖z̄n − µ(V)‖2 + 1 n− 1 ‖µ(V)‖2 with Eq. (6). Considering the first term in Eq. (8)∥∥∥∥∥ 1n n∑ a=1 za(V)z>a (V)− Exy [ z(V)z>(V) ]∥∥∥∥∥ F = sup B∈B(1,0) 〈 B, 1 n n∑ a=1 za(V)z>a (V)− Exy [ z(V)z>(V) ]〉 F\n≤ sup B∈B(1,0) J∑ i,j=1 |Bij | ∣∣∣∣∣ 1n n∑ a=1 [k(xa,vi)− k(ya,vi)][k(xa,vj)− k(ya,vj)]− Exy ([k(x,vi)− k(y,vi)] [k(x,vj)− k(y,vj)]) ∣∣∣∣∣ ≤ sup\nB∈B(1,0) J∑ i,j=1 |Bij | (∣∣∣∣∣ 1n n∑ a=1 k(xa,vi)k(xa,vj)− Ex [k(x,vi)k(x,vj)] ∣∣∣∣∣ +\n∣∣∣∣∣ 1n n∑ a=1 k(xa,vi)k(ya,vj)− Exy [k(x,vi)k(y,vj)] ∣∣∣∣∣ +\n∣∣∣∣∣ 1n n∑ a=1 k(ya,vi)k(xa,vj)− Exy [k(y,vi)k(x,vj)] ∣∣∣∣∣+ ∣∣∣∣∣ 1n n∑ a=1 k(ya,vi)k(ya,vj)− Ey [k(y,vi)k(y,vj)] ∣∣∣∣∣ )\n≤J sup v,v′∈X sup k∈K ∣∣∣∣∣ 1n n∑ a=1 k(xa,v)k(xa,v ′)− Ex [k(x,v)k(x,v′)] ∣∣∣∣∣\n+ 2J sup v,v′∈X sup k∈K ∣∣∣∣∣ 1n n∑ a=1 k(xa,v)k(ya,v ′)− Exy [k(x,v)k(y,v′)] ∣∣∣∣∣ + J sup\nv,v′∈X sup k∈K ∣∣∣∣∣ 1n n∑ a=1 k(ya,v)k(ya,v ′)− Ey [k(y,v)k(y,v′)] ∣∣∣∣∣ by exploiting that ‖A‖F = supB∈B(1,0) 〈B,A〉F , and ∑J i,j=1 |Bij | ≤ J ‖B‖F ≤ J with B ∈ B(1,0). Using the bounds obtained for the two terms of Eq. (8), we get\nsup V sup k∈K ‖Sn(V)−Σ(V)‖F ≤\n≤ 8B 2J\nn− 1 + 2B\n√ J 2n− 1 n− 1 sup V sup k∈K ‖z̄n − µ(V)‖2 + J ( ‖Pn − P‖F2 + 2 ‖(P ×Q)n − (P ×Q)‖F3 + ‖Qn −Q‖F2 ) .\n(10)"
    }, {
      "heading" : "D.5 Bounding by concentration and the VC property",
      "text" : "By combining Eqs. (3), (7) and (10)\nsup V sup k ∣∣z̄>n (Sn + γnI)−1z̄n − µ>Σ−1µ∣∣ ≤ ≤ c̄1 γn [ 8B2J n− 1 + 2B √ J 2n− 1 n− 1 √ J ( ‖Pn − P‖F1 + ‖Qn −Q‖F1\n) +J ( ‖Pn − P‖F2 + 2 ‖(P ×Q)n − (P ×Q)‖F3 + ‖Qn −Q‖F2\n) ] +c̄2 √ J ( ‖Pn − P‖F1 + ‖Qn −Q‖F1 ) + c̄3γn\n= ( ‖Pn − P‖F1 + ‖Qn −Q‖F1 )( 2 γn c̄1BJ 2n− 1 n− 1 + c̄2 √ J ) + c̄3γn\n+ c̄1 γn J [ ‖Pn − P‖F2 + ‖Qn −Q‖F2 + 2 ‖(P ×Q)n − (P ×Q)‖F3 ] + 8 γn c̄1B 2J n− 1 . (11)\nApplying Lemma 3 with δ5 , we get the statement with a union bound.\nLemma 3 (Concentration of the empirical process for uniformly bounded separable Carathéodory VC classes). Let F be\n1. VC-subgraph class ofM→ R functions with VC index VC(F),"
    }, {
      "heading" : "2. a uniformly bounded (‖f‖L∞(M) ≤ K <∞,∀f ∈ F) separable Carathéodory family.",
      "text" : "Let Q be a probability measure, and let Qn = 1n ∑n i=1 δxi be the corresponding empirical measure. Then for any δ ∈ (0, 1) with probability at least 1− δ\n‖Qn −Q‖F ≤ 16 √\n2K√ n\n[ 2 √ log [ C × V C(F)(16e)V C(F) ] + √ 2π[V C(F)− 1]\n2\n] +K √ 2 log ( 1 δ ) n\nwhere the universal constant C is associated according to Lemma 7(iv).\nProof. Notice that g(x1, . . . , xn) = ‖Qn −Q‖F satisfies the bounded difference property with b = 2K n [see Eq. (18)]:\n|g(x1, . . . ,xn)− g ( x1, . . . ,xj ,x ′ j ,xj+1, . . . ,xn ) |\n≤ ∣∣∣∣∣supf∈F ∣∣∣Qf − 1 n n∑ i=1 f(xi) ∣∣∣− sup f∈F ∣∣∣Qf − 1 n n∑ i=1 f(xi) + 1 n [ f(xj)− f(x′j) ] ∣∣∣∣∣∣∣∣ ≤ 1 n sup f∈F |f(xj)− f(x′j)| ≤ 1 n ( sup f∈F |f(xj)|+ sup f∈F |f(x′j)| ) ≤ 2K n .\nHence, applying Lemma 8, and using symmetrization Steinwart and Christmann (2008) (Prop. 7.10) for the uniformly bounded separable Carathéodory F class, for arbitrary δ ∈ (0, 1) with probability at least 1− δ\n‖Qn −Q‖F ≤ Ex1:n ‖Qn −Q‖F +K\n√ 2 log ( 1 δ ) n\n≤ 2Ex1:nR(F , x1:n) +K\n√ 2 log ( 1 δ ) n .\nBy the Dudley entropy bound Bousquet (2003) [see Eq. (4.4); diam(F , L2(M,Qn)) ≤ 2 supf∈F ‖f‖L2(M,Qn) ≤ 2 supf∈F ‖f‖L∞(M) ≤ 2K < ∞], Lemma 7(iv) [with F ≡ K, q = 2 M = Qn] and the monotone decreasing property of the covering number, one arrives at R(F , x1:n) ≤ 8 √\n2√ n ∫ 2K 0 √ logN(r,F , L2(M,Qn))dr\n≤ 8 √\n2√ n [∫ K 0 √ logN(r,F , L2(M,Qn))dr +K √ logN(K,F , L2(M,Qn)) ]\n≤ 8 √\n2K√ n [∫ 1 0 √ logN(rK,F , L2(M,Qn))dr + √ logN(K,F , L2(M,Qn)) ]\n≤ 8 √\n2K√ n [∫ 1 0 √ log [ a1 ( 1 r )a2] dr + √ log(a1) ] = 8 √ 2K√ n [ 2 √ log(a1) + ∫ 1 0 √ a2 log ( 1 r ) dr ]\n= 8 √\n2K√ n\n[ 2 √\nlog(a1) + √ πa2 2\n] ,\nwhere a1 := C × V C(F)(16e)V C(F), a2 := 2[V C(F) − 1] and ∫ 1 0 √ log ( 1 r ) dr = ∫∞ 0 t 1 2 e−tdt = Γ ( 3 2 ) = √ π 2 .\nLemma 4 (Properties of Fi from K).\n1. Uniform boundedness of Fi-s [see Eqs. (1)-(2)]: If K is uniformly bounded, i.e., ∃B < ∞ such that supk∈K sup(x,y)∈X 2 |k(x,y)| ≤ B; then F1, F2 and F3 [Eqs. (1)-(2)] are also uniformly bounded with B, B2, B2 constants, respectively. That is, supk∈K,v∈X |k(x,v)| ≤ B, supk∈K,(v,v′)∈X 2 |k(x,v)k(x,v′)| ≤ B2, supk∈K,(v,v′)∈X 2 |k(x,v)k(y,v′)| ≤ B2.\n2. Separability ofFi: sinceF1, F2 andF3 is parameterized by Θ = K×X ,K×X 2,K×X 2, separability of K implies that of Θ.\n3. Measurability of Fi: ∀k ∈ K is measurable, then the elements of Fi (i = 1, 2, 3) are also measurable."
    }, {
      "heading" : "E Example kernel families",
      "text" : "Below we give examples for K kernel classes for which the associated Fi-s are VC-subgraph and uniformly bounded separable Carathéodory families. The VC property will be a direct consequence of the VC indices of finite-dimensional function classes and preservation theorems (see Lemma 7); for a nice example application see Srebro and Ben-David (2006) (Section 5) who study the pseudo-dimension of (x,y) 7→ k(x,y) kernel classes, for different Gaussian families. We take these Gaussian classes (isotropic, full) and use the preservation trick to bound the VC indices of the associated Fi-s. Lemma 5 (Fi-s are VC-subgraph and uniformly bounded separable Carathéodory families for isotropic Gaussian\nkernel). Let K = { kσ : (x,y) ∈ X × X ⊆ Rd × Rd 7→ e− ‖x−y‖22 2σ2 : σ > 0 } . Then the F1, F2, F3 classes [see\nEqs. (1)-(2)] associated to K are\n• VC-subgraphs with indices V C(F1) ≤ d+ 4, V C(F2) ≤ d+ 4, V C(F3) ≤ 2d+ 4, and\n• uniformly bounded separable Carathéodory families, with ‖f‖L∞(M) ≤ 1 for all f ∈ {F1,F2,F3}.4\nProof. VC subgraph property:\n• F1: Consider the function class G = { x 7→ ‖x−v‖ 2 2 2σ2 = 1 2σ2 ( ‖x‖22 − 2 〈x,v〉2 + ‖v‖ 2 2 ) : σ > 0,v ∈ X } ⊆\nL0(Rd). G ⊆ G̃ := span ( x 7→ ‖x‖22 , {x 7→ xi}di=1 ,x 7→ 1 ) vector space, dim(G) ≤ d + 2. Thus by Lemma 7(i)-(ii), G is VC with V C(G) ≤ d+4; applying Lemma 7(iii) with φ(z) = e−z , F1 = φ◦G is also VC with index V C(F1) ≤ d+ 4.\n• F2: Since F2 = { x 7→ k(x,v)k(x,v′) = e− ‖x−v‖22+‖x−v′‖22 2σ2 : σ > 0,v ∈ X ,v′ ∈ X } ,\nand { x 7→ ‖x−v‖22+‖x−v′‖22\n2σ2 : σ > 0,v ∈ X ,v ′ ∈ X\n} ⊆ S =\nspan ( x 7→ ‖x‖22 , {x 7→ xi}di=1 ,x 7→ 1 ) , V C(F2) ≤ d+ 4.\n• F3: Since F3 = { (x,y) 7→ k(x,v)k(y,v′) = e− ‖x−v‖2+‖y−v′‖22 2σ2 = e− ‖[x;y]−[v;v′]‖22 2σ2 : σ > 0,v ∈ Rd,v′ ∈ Rd } ,\nfrom the result on F1 we get that V C(F3) ≤ 2d+ 4.\nUniformly bounded, separable Carathéodory family: The result follows from Lemma 4 by noting that |k(x,y)| ≤ 1 =: B, (x,y) 7→ e− ‖x−y‖22 2σ2 is continuous (∀σ > 0), R+ is separable, and the (σ,v) 7→ e− ‖x−v‖22 2σ2 , (σ,v,v′) 7→ e− ‖x−v‖22 2σ2 e− ‖x−v′‖22 2σ2 , (σ,v,v′) 7→ e− ‖x−v‖22 2σ2 e− ‖y−v′‖22 2σ2 mappings are continuous (∀x,y ∈ X ).\nLemma 6 (Fi-s are VC-subgraph and uniformly bounded separable Carathéodory families for full Gaussian kernel). Let K = {kA : (x,y) ∈ X × X ⊆ Rd × Rd 7→ e−(x−y)\n>A(x−y) : A 0}. Then the F1, F2, F3 classes [see Eqs. (1)-(2)] associated to K are\n• VC-subgraphs with indices V C(F1) ≤ d(d+1)2 + d + 2, V C(F2) ≤ d(d+1)+2 2 + d + 2, V C(F3) ≤ d(d+ 1) + 2d+ 3,\n• uniformly bounded separable Carathéodory families, with ‖f‖L∞(M) ≤ 1 for all f ∈ {F1,F2,F3}.4\nProof. We prove the VC index values; the rest is essentially identical to the proof of Lemma 5.\n• F1: Using that G = { x 7→ (x− v)>A(x− v) : A 0,v ∈ X } ⊆ S :=\nspan ({x 7→ xixj}1≤i≤j≤d, {x 7→ xi}1≤i≤d,x 7→ 1), we have V C(F1) ≤ V C(G) ≤ dim(S) + 2 ≤ d(d+1)\n2 + d+ 3. • F2: SinceF2 = { x 7→ k(x,v)k(x,v′) = e− [ (x−v)>A(x−v)+(x−v′) > A(x−v′) ] : A 0,v ∈ X ,v′ ∈ X } ,\nand { (x,y) 7→ (x− v)>A(x− v) + (x− v′)>A (x− v′) } ⊆ S\n:= span ({x 7→ xixj}1≤i≤j≤d, {x 7→ xi}1≤i≤d,x 7→ 1) ,\nwe have V C(F2) ≤ V C(S) = dim(S) + 2 ≤ d(d+1)2 + d+ 3.\n4M = X for F1 and F2, andM = X 2 in case of F3.\n• F3: Exploiting that F3 = { (x,y) 7→ k(x,v)k(y,v′) = e− [ (x−v)>A(x−v)+(y−v′) > B(y−v′) ] : A 0,B 0,v ∈ X ,v′ ∈ X } ,\nand { (x,y) 7→ (x− v)>A(x− v) + (y − v′)>B(y − v′) }\n⊆ S := span ({(x,y) 7→ xixj}1≤i≤j≤d, {(x,y) 7→ xi}1≤i≤d, (x,y) 7→ 1, {(x,y) 7→ yiyj}1≤i≤j≤d, {(x,y) 7→ yi}1≤i≤d), we have V C(F3) ≤ V C(S) = dim(S) + 2 ≤ d(d+ 1) + 2d+ 3."
    }, {
      "heading" : "F Proof of proposition 1",
      "text" : "Recall Proposition 1: Proposition 1 (Lower bound on ME test power). Let K be a uniformly bounded (i.e., ∃B < ∞ such that supk∈K sup(x,y)∈X 2 |k(x,y)| ≤ B) family of k : X × X → R measurable kernels. Let V be a collection in which each element is a set of J test locations. Assume that c̃ := supV∈V,k∈K ‖Σ−1‖F <∞. For large n, the test power P ( λ̂n ≥ Tα ) of the ME test satisfies P ( λ̂n ≥ Tα ) ≥ L(λn) where\nL(λn) := 1− 2e−ξ1(λn−Tα) 2/n − 2e−\n[γn(λn−Tα)(n−1)−ξ2n] 2\nξ3n(2n−1)2 − 2e−[(λn−Tα)/3−c3nγn] 2γ2n/ξ4 ,\nand c3, ξ1, . . . ξ4 are positive constants depending on only B, J and c̃. The parameter λn := nµ>Σ−1µ is the population counterpart of λ̂n := nz>n (Sn + γnI) −1 zn where µ = Exy[z1] and Σ = Exy[(z1−µ)(z1−µ)>]."
    }, {
      "heading" : "For large n, L(λn) is increasing in λn.",
      "text" : ""
    }, {
      "heading" : "F.1 Proof",
      "text" : "By (3), we have\n|λ̂n − λn| ≤ c1n\nγn ‖Σ− Sn‖F + c2n‖zn − µ‖2 + c3nγn. (12)\nWe will bound each of the three terms in (12)."
    }, {
      "heading" : "Bounding ‖zn − µ‖2 (second term in (12))",
      "text" : "Let g(x,y,v) := k(x,v)−k(y,v). Define v∗ := arg maxv∈{v1,...,vJ} ∣∣ 1 n ∑n i=1 g(xi,yi,v)− Exy [g(x,y,v)] ∣∣. Define Gi := g(xi,yi,v∗).\n‖zn − µ‖2 = sup b∈B(1,0) 〈b, zn − µ〉2\n≤ sup b∈B(1,0) J∑ j=1 |bj | ∣∣∣∣∣ 1n n∑ i=1 [k(xi,vj)− k(yi,vj)]− Exy [k(x,vj)− k(y,vj)] ∣∣∣∣∣ = sup\nb∈B(1,0) J∑ j=1 |bj | ∣∣∣∣∣ 1n n∑ i=1 g(xi,yi,vj)− Exy [g(x,y,vj)] ∣∣∣∣∣ ≤\n∣∣∣∣∣ 1n n∑ i=1 Gi − Exy [G1] ∣∣∣∣∣ supb∈B(1,0) J∑ j=1 |bj |\n≤ √ J ∣∣∣∣∣ 1n n∑ i=1 Gi − Exy [G1] ∣∣∣∣∣ supb∈B(1,0) ‖b‖2 = √ J\n∣∣∣∣∣ 1n n∑ i=1 Gi − Exy [G1] ∣∣∣∣∣ ,\nwhere we used the fact that ‖b‖1 ≤ √ J‖b‖2. It can be seen that −2B ≤ Gi ≤ 2B because\nGi = k(xi,v ∗)− k(yi,v∗) ≤ |k(xi,v∗)|+ |k(yi,v∗)| ≤ 2B. Using Hoeffding’s inequality (Lemma 9) to bound ∣∣ 1 n ∑n i=1Gi − Exy[G1] ∣∣, we have P (nc2‖zn − µ‖2 ≤ α) ≥ 1− 2 exp ( − α 2\n8B2c22Jn\n) . (13)\nBounding first (‖Σ− Sn‖F ) and third terms in (12) Let η(vi,vj) := ∣∣ 1 n ∑n a=1 g(xa,ya,vi)g(xa,ya,vj)− Exy [g(x,y,vi)g(x,y,vj)] ∣∣. Define (v∗1,v∗2) = arg max(v(1),v(2))∈{(vi,vj)}Ji,j=1 η(v (1),v(2)). Define Hi := g(xi,yi,v∗1)g(xi,yi,v ∗ 2). By (8), we have\n‖Sn −Σ‖F ≤ (∗1) + (∗2), (∗1) = ∥∥∥∥ 1n n∑ a=1 zaz > a − Exy[z1z>1 ] ∥∥∥∥ F ,\n(∗2) = 8B2J\nn− 1 + 2Bk\n√ J 2n− 1 n− 1 ‖zn − µ‖2.\nWe can upper bound (∗2) by applying Hoeffding’s inequality to bound ‖zn − µ‖2 giving P ( c1n\nγn (∗2) ≤ α\n) ≥ 1− 2 exp ( − (αγn − αγnn+ 8B 2c1Jn) 2\n32B4c21J 2n(2n− 1)2\n) . (14)\nWe can upper bound (∗1) with\n(∗1) = sup B∈B(1,0)\n〈 B, 1\nn n∑ a=1 zaz > a − Exy[z1z>1 ] 〉 F\n≤ sup B∈B(1,0) J∑ i=1 J∑ j=1 |Bij | ∣∣∣∣∣ 1n n∑ a=1 g(xa,ya,vi)g(xa,ya,vj)− Exy [g(x,y,vi)g(x,y,vj)] ∣∣∣∣∣ ≤\n∣∣∣∣∣ 1n n∑ a=1 Ha − Exy [H1] ∣∣∣∣∣ supB∈B(1,0) J∑ i=1 J∑ j=1 |Bij |\n≤ J ∣∣∣∣∣ 1n n∑ a=1 Ha − Exy [H1] ∣∣∣∣∣ supB∈B(1,0) ‖B‖F = J ∣∣∣∣∣ 1n n∑ a=1 Ha − Exy [H1] ∣∣∣∣∣ , where we used the fact that ∑J i=1 ∑J j=1 |Bij | ≤ J‖B‖F . It can be seen that −4B2 ≤ Ha ≤ 4B2. Using\nHoeffding’s inequality (Lemma 9) to bound ∣∣ 1 n ∑n a=1Ha − Exy [H1] ∣∣, we have P ( c1n\nγn (∗1) ≤ α\n) ≥ 1− 2 exp ( − α\n2γ2n 32B4J2c21n\n) , (15)\nimplying that\nP ( c1n\nγn (∗1) + c3nγn ≤ α\n) ≥ 1− 2 exp ( − (α− c3nγn) 2 γ2n\n32B4J2c21n\n) . (16)\nApplying a union bound on (13), (14), and (16) with t = α/3, we can conclude that P (∣∣∣λ̂n − λn∣∣∣ ≤ t) ≥ P(c1n\nγn ‖Σ− Sn‖F + c2n‖zn − µ‖2 + c3nγn ≤ t ) ≥ 1− 2 exp ( − t 2\n32 · 8B2c22Jn\n) − 2 exp ( − (tγnn− tγn − 24B 2c1Jn) 2\n32 · 32B4c21J2n(2n− 1)2\n) − 2 exp ( − (t/3− c3nγn) 2 γ2n\n32B4J2c21n\n) .\nA rearrangement yields P ( λ̂n ≥ Tα )\n≥ 1− 2 exp ( − (λn − Tα) 2\n32 · 8B2c22Jn\n) − 2 exp ( − (γn(λn − Tα)(n− 1)− 24B 2c1Jn) 2\n32 · 32B4c21J2n(2n− 1)2\n) − 2 exp ( − ((λn − Tα)/3− c3nγn)\n2 γ2n 32B4J2c21n\n) .\nDefine ξ1 := 132·8B2c22J , ξ2 := 24B 2c1J, ξ3 := 3 2 · 32B4c21J2, ξ4 := 32B4J2c21. We have\nP ( λ̂n ≥ Tα ) ≥ 1− 2 exp ( −ξ1(λn − Tα) 2\nn\n) − 2 exp ( − (γn(λn − Tα)(n− 1)− ξ2n) 2\nξ3n(2n− 1)2\n) − 2 exp ( − ((λn − Tα)/3− c3nγn)\n2 γ2n ξ4\n) ."
    }, {
      "heading" : "G External lemmas",
      "text" : "In this section we detail some external lemmas used in our proof. Lemma 7 (properties of VC classes, see page 141, 146-147 in van der Vaart and Wellner (2000) and page 160-161 in Kosorok (2008)).\n(i) Monotonicity: G ⊆ G̃ ⊆ L0(M)⇒ V C(G) ≤ V C(G̃).\n(ii) Finite-dimensional vector space: if G is a finite-dimensional vector space of measurable functions, then V C(G) ≤ dim(G) + 2.\n(iii) Composition with monotone function: If G is VC and φ : R→ R is monotone, then for φ ◦ G := {φ ◦ g : g ∈ G}, V C(φ ◦ G) ≤ V C(G).\n(iv) The r-covering number of a VC class grows only polynomially in 1r : Let F be VC on the domainM with measurable envelope F (|f(m)| ≤ F (m), ∀m ∈ M, f ∈ F). Then for any q ≥ 1 and M probability measure for which ‖F‖Lq(M,M) > 0\nN ( r ‖F‖Lq(M,M) ,F , L q(M,M) ) ≤ C × V C(F)(16e)V C(F) ( 1\nr\n)q[V C(F)−1] (17)\nfor any r ∈ (0, 1) with a universal constant C. Lemma 8 (McDiarmid’s inequality). LetX1, . . . , Xn ∈M be independent random variables and let g :Mn → R be a function such that the\nsup x1,...,xn,x′j∈M ∣∣g(x1, . . . ,xn)− g (x1, . . . ,xj ,x′j ,xj+1, . . . ,xn)∣∣ ≤ b (18) bounded difference property holds. Then for arbitrary δ ∈ (0, 1)\nP g(X1, . . . , Xn) ≤ E[g(X1, . . . , Xn)] + b √ log ( 1 δ ) n\n2  ≥ 1− δ. Lemma 9 (Hoeffding’s inequality). Let X1, . . . , Xn be i.i.d. random variables with P(a ≤ Xi ≤ b) = 1. Let X := 1n ∑n i=1Xi. Then,\nP (∣∣X − E[X]∣∣ ≤ t) ≥ 1− 2 exp(− 2nt2\n(b− a)2\n) .\nEquivalently, for any δ ∈ (0, 1), with probability at least 1− δ, it holds that∣∣X − E[X]∣∣ ≤ b− a√ 2n √ log(2/δ)."
    } ],
    "references" : [ {
      "title" : "On a new multivariate two-sample test",
      "author" : [ "L. Baringhaus", "C. Franz" ],
      "venue" : "Journal of Multivariate Analysis,",
      "citeRegEx" : "Baringhaus and Franz.,? \\Q2004\\E",
      "shortCiteRegEx" : "Baringhaus and Franz.",
      "year" : 2004
    }, {
      "title" : "Theory of multivariate statistics",
      "author" : [ "M. Bilodeau", "D. Brenner" ],
      "venue" : "Springer Science & Business Media,",
      "citeRegEx" : "Bilodeau and Brenner.,? \\Q2008\\E",
      "shortCiteRegEx" : "Bilodeau and Brenner.",
      "year" : 2008
    }, {
      "title" : "New approaches to statistical learning theory",
      "author" : [ "O. Bousquet" ],
      "venue" : "Annals of the Institute of Statistical Mathematics,",
      "citeRegEx" : "Bousquet.,? \\Q2003\\E",
      "shortCiteRegEx" : "Bousquet.",
      "year" : 2003
    }, {
      "title" : "Fast two-sample testing with analytic representations of probability measures",
      "author" : [ "K. Chwialkowski", "A. Ramdas", "D. Sejdinovic", "A. Gretton" ],
      "venue" : null,
      "citeRegEx" : "Chwialkowski et al\\.,? \\Q1972\\E",
      "shortCiteRegEx" : "Chwialkowski et al\\.",
      "year" : 1972
    }, {
      "title" : "Diagnostic measures for model criticism",
      "author" : [ "G.P. Cinzia Carota", "N.G. Polson" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "Carota and Polson.,? \\Q1996\\E",
      "shortCiteRegEx" : "Carota and Polson.",
      "year" : 1996
    }, {
      "title" : "Testing for homogeneity with kernel Fisher discriminant analysis",
      "author" : [ "M. Eric", "F.R. Bach", "Z. Harchaoui" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Eric et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Eric et al\\.",
      "year" : 2008
    }, {
      "title" : "Kernels based tests with non-asymptotic bootstrap approaches for two-sample problems",
      "author" : [ "M. Fromont", "B. Laurent", "M. Lerasle", "P. Reynaud-Bouret" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Fromont et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Fromont et al\\.",
      "year" : 2012
    }, {
      "title" : "A kernel two-sample test",
      "author" : [ "A. Gretton", "K.M. Borgwardt", "M.J. Rasch", "B. Schölkopf", "A. Smola" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Gretton et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Gretton et al\\.",
      "year" : 2012
    }, {
      "title" : "Optimal kernel choice for large-scale two-sample tests",
      "author" : [ "A. Gretton", "D. Sejdinovic", "H. Strathmann", "S. Balakrishnan", "M. Pontil", "K. Fukumizu", "B.K. Sriperumbudur" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Gretton et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Gretton et al\\.",
      "year" : 2012
    }, {
      "title" : "Introduction to Empirical Processes and Semiparametric Inference",
      "author" : [ "M.R. Kosorok" ],
      "venue" : null,
      "citeRegEx" : "Kosorok.,? \\Q2008\\E",
      "shortCiteRegEx" : "Kosorok.",
      "year" : 2008
    }, {
      "title" : "Statistical model criticism using kernel two sample tests",
      "author" : [ "J.R. Lloyd", "Z. Ghahramani" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Lloyd and Ghahramani.,? \\Q2015\\E",
      "shortCiteRegEx" : "Lloyd and Ghahramani.",
      "year" : 2015
    }, {
      "title" : "Automatic construction and Natural-Language description of nonparametric regression models",
      "author" : [ "J.R. Lloyd", "D. Duvenaud", "R. Grosse", "J.B. Tenenbaum", "Z. Ghahramani" ],
      "venue" : "In AAAI,",
      "citeRegEx" : "Lloyd et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Lloyd et al\\.",
      "year" : 2014
    }, {
      "title" : "The Karolinska directed emotional faces-KDEF",
      "author" : [ "D. Lundqvist", "A. Flykt", "A. Öhman" ],
      "venue" : "Technical report, ISBN 91-630-7164-9,",
      "citeRegEx" : "Lundqvist et al\\.,? \\Q1998\\E",
      "shortCiteRegEx" : "Lundqvist et al\\.",
      "year" : 1998
    }, {
      "title" : "Introduction to information retrieval",
      "author" : [ "C.D. Manning", "P. Raghavan", "H. Schütze" ],
      "venue" : null,
      "citeRegEx" : "Manning et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Manning et al\\.",
      "year" : 2008
    }, {
      "title" : "Principal differences analysis: Interpretable characterization of differences between distributions",
      "author" : [ "J. Mueller", "T. Jaakkola" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Mueller and Jaakkola.,? \\Q2015\\E",
      "shortCiteRegEx" : "Mueller and Jaakkola.",
      "year" : 2015
    }, {
      "title" : "On the decreasing power of kernel and distance based nonparametric hypothesis tests in high dimensions",
      "author" : [ "A. Ramdas", "S. Jakkam Reddi", "B. Póczos", "A. Singh", "L. Wasserman" ],
      "venue" : "In AAAI,",
      "citeRegEx" : "Ramdas et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Ramdas et al\\.",
      "year" : 2015
    }, {
      "title" : "Equivalence of distance-based and RKHS-based statistics in hypothesis testing",
      "author" : [ "D. Sejdinovic", "B. Sriperumbudur", "A. Gretton", "K. Fukumizu" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "Sejdinovic et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Sejdinovic et al\\.",
      "year" : 2013
    }, {
      "title" : "A Hilbert space embedding for distributions",
      "author" : [ "A. Smola", "A. Gretton", "L. Song", "B. Schölkopf" ],
      "venue" : "In ALT,",
      "citeRegEx" : "Smola et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Smola et al\\.",
      "year" : 2007
    }, {
      "title" : "Learning bounds for support vector machines with learned kernels",
      "author" : [ "N. Srebro", "S. Ben-David" ],
      "venue" : "In COLT, pages 169–183,",
      "citeRegEx" : "Srebro and Ben.David.,? \\Q2006\\E",
      "shortCiteRegEx" : "Srebro and Ben.David.",
      "year" : 2006
    }, {
      "title" : "Hilbert space embeddings and metrics on probability measures",
      "author" : [ "B. Sriperumbudur", "A. Gretton", "K. Fukumizu", "B. Schoelkopf", "G. Lanckriet" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Sriperumbudur et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Sriperumbudur et al\\.",
      "year" : 2010
    }, {
      "title" : "Universality, characteristic kernels and RKHS embedding of measures",
      "author" : [ "B.K. Sriperumbudur", "K. Fukumizu", "G.R. Lanckriet" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "Sriperumbudur et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Sriperumbudur et al\\.",
      "year" : 2011
    }, {
      "title" : "Testing for equal distributions in high dimension. InterStat",
      "author" : [ "G. Székely", "M. Rizzo" ],
      "venue" : null,
      "citeRegEx" : "Székely and Rizzo.,? \\Q2004\\E",
      "shortCiteRegEx" : "Székely and Rizzo.",
      "year" : 2004
    }, {
      "title" : "Weak Convergence and Empirical Processes: With Applications to Statistics (Springer Series in Statistics)",
      "author" : [ "A. van der Vaart", "J. Wellner" ],
      "venue" : null,
      "citeRegEx" : "Vaart and Wellner.,? \\Q2000\\E",
      "shortCiteRegEx" : "Vaart and Wellner.",
      "year" : 2000
    }, {
      "title" : "B-test: A non-parametric, low variance kernel two-sample test",
      "author" : [ "W. Zaremba", "A. Gretton", "M. Blaschko" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Zaremba et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Zaremba et al\\.",
      "year" : 2013
    } ],
    "referenceMentions" : [ {
      "referenceID" : 10,
      "context" : "One application for such divergence measures is to model criticism, where samples from a trained model are compared with a validation sample: in the univariate case, through the KL divergence (Cinzia Carota and Polson, 1996), or in the multivariate case, by use of the maximum mean discrepancy (MMD) (Lloyd and Ghahramani, 2015).",
      "startOffset" : 300,
      "endOffset" : 328
    }, {
      "referenceID" : 14,
      "context" : "An alternative, interpretable analysis of a multivariate difference in distributions may be obtained by projecting onto a discriminative direction, such that the Wasserstein distance on this projection is maximized (Mueller and Jaakkola, 2015).",
      "startOffset" : 215,
      "endOffset" : 243
    }, {
      "referenceID" : 5,
      "context" : "Nonparametric two-sample tests based on RKHS distances (Eric et al., 2008; Fromont et al., 2012; Gretton et al., 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al.",
      "startOffset" : 55,
      "endOffset" : 119
    }, {
      "referenceID" : 6,
      "context" : "Nonparametric two-sample tests based on RKHS distances (Eric et al., 2008; Fromont et al., 2012; Gretton et al., 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al.",
      "startOffset" : 55,
      "endOffset" : 119
    }, {
      "referenceID" : 21,
      "context" : ", 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al.",
      "startOffset" : 29,
      "endOffset" : 82
    }, {
      "referenceID" : 0,
      "context" : ", 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al.",
      "startOffset" : 29,
      "endOffset" : 82
    }, {
      "referenceID" : 16,
      "context" : ", 2012a) or energy distances (Székely and Rizzo, 2004; Baringhaus and Franz, 2004) have as their test statistic an integral probability metric, the Maximum Mean Discrepancy (Gretton et al., 2012a; Sejdinovic et al., 2013).",
      "startOffset" : 173,
      "endOffset" : 221
    }, {
      "referenceID" : 11,
      "context" : "Lloyd and Ghahramani (2015) used this witness function to compare the model output of the Automated Statistician (Lloyd et al., 2014) with a reference sample, yielding a visual indication of where the model fails.",
      "startOffset" : 113,
      "endOffset" : 133
    }, {
      "referenceID" : 23,
      "context" : "Despite the differences in these analytic functions being evaluated at random locations, the analytic tests have greater power than linear time tests based on subsampled estimates of the MMD (Gretton et al., 2012b; Zaremba et al., 2013).",
      "startOffset" : 191,
      "endOffset" : 236
    }, {
      "referenceID" : 7,
      "context" : "Lloyd and Ghahramani (2015) used this witness function to compare the model output of the Automated Statistician (Lloyd et al.",
      "startOffset" : 0,
      "endOffset" : 28
    }, {
      "referenceID" : 3,
      "context" : "Our approach builds on the analytic representations of probability distributions of Chwialkowski et al. (2015), where differences in expectations of analytic functions at particular spatial or frequency locations are used to construct a two-sample test statistic, which can be computed in linear time.",
      "startOffset" : 84,
      "endOffset" : 111
    }, {
      "referenceID" : 3,
      "context" : "2 ME and SCF tests In this section, we review the ME and SCF tests (Chwialkowski et al., 2015) for two-sample testing. In Sec. 3, we will extend these approaches to learn features that optimize the power of these tests. Given two samples X := {xi}i=1,Y := {yi}i=1 ⊂ R independently and identically distributed (i.i.d.) according to P and Q, respectively, the goal of a two-sample test is to decide whether P is different from Q on the basis of the samples. The task is formulated as a statistical hypothesis test proposing a null hypothesis H0 : P = Q (samples are drawn from the same distribution) against an alternative hypothesis H1 : P 6= Q (the sample generating distributions are different). A test calculates a test statistic λ̂n from X and Y, and rejectsH0 if λ̂n exceeds a predetermined test threshold (critical value). The threshold is given by the (1− α)-quantile of the (asymptotic) distribution of λ̂n under H0 i.e., the null distribution, and α is the significance level of the test. ME test The ME test uses as its test statistic λ̂n, a form of Hotelling’s T-squared statistic, defined as λ̂n := nznS −1 n zn, where zn := 1 n ∑n i=1 zi, Sn := 1 n−1 ∑n i=1(zi − zn)(zi − zn), and zi := (k(xi,vj)− k(yi,vj))j=1 ∈ R . The statistic depends on a positive definite kernel k : X ×X → R (with X ⊆ R), and a set of J test locations V = {vj}j=1 ⊂ R. Under H0, asymptotically λ̂n follows χ(J), a chi-squared distribution with J degrees of freedom. The ME test rejects H0 if λ̂n > Tα, where the test threshold Tα is given by the (1 − α)-quantile of the asymptotic null distribution χ(J). Although the distribution of λ̂n under H1 was not derived, Chwialkowski et al. (2015) showed that if k is analytic, integrable and characteristic (in the sense of Sriperumbudur et al.",
      "startOffset" : 68,
      "endOffset" : 1678
    }, {
      "referenceID" : 3,
      "context" : "2 ME and SCF tests In this section, we review the ME and SCF tests (Chwialkowski et al., 2015) for two-sample testing. In Sec. 3, we will extend these approaches to learn features that optimize the power of these tests. Given two samples X := {xi}i=1,Y := {yi}i=1 ⊂ R independently and identically distributed (i.i.d.) according to P and Q, respectively, the goal of a two-sample test is to decide whether P is different from Q on the basis of the samples. The task is formulated as a statistical hypothesis test proposing a null hypothesis H0 : P = Q (samples are drawn from the same distribution) against an alternative hypothesis H1 : P 6= Q (the sample generating distributions are different). A test calculates a test statistic λ̂n from X and Y, and rejectsH0 if λ̂n exceeds a predetermined test threshold (critical value). The threshold is given by the (1− α)-quantile of the (asymptotic) distribution of λ̂n under H0 i.e., the null distribution, and α is the significance level of the test. ME test The ME test uses as its test statistic λ̂n, a form of Hotelling’s T-squared statistic, defined as λ̂n := nznS −1 n zn, where zn := 1 n ∑n i=1 zi, Sn := 1 n−1 ∑n i=1(zi − zn)(zi − zn), and zi := (k(xi,vj)− k(yi,vj))j=1 ∈ R . The statistic depends on a positive definite kernel k : X ×X → R (with X ⊆ R), and a set of J test locations V = {vj}j=1 ⊂ R. Under H0, asymptotically λ̂n follows χ(J), a chi-squared distribution with J degrees of freedom. The ME test rejects H0 if λ̂n > Tα, where the test threshold Tα is given by the (1 − α)-quantile of the asymptotic null distribution χ(J). Although the distribution of λ̂n under H1 was not derived, Chwialkowski et al. (2015) showed that if k is analytic, integrable and characteristic (in the sense of Sriperumbudur et al. (2011)), under H1, λ̂n can be arbitrarily large as n→∞, allowing the test to correctly reject H0.",
      "startOffset" : 68,
      "endOffset" : 1783
    }, {
      "referenceID" : 17,
      "context" : "One can intuitively think of the ME test statistic as a squared normalized (by the inverse covariance S−1 n ) L (X , VJ) distance of the mean embeddings (Smola et al., 2007) of the empirical measures Pn := 1 n ∑n i=1 δxi , and Qn := 1 n ∑n i=1 δyi where VJ := 1 J ∑J i=1 δvi , and δx is the Dirac measure concentrated at x.",
      "startOffset" : 153,
      "endOffset" : 173
    }, {
      "referenceID" : 2,
      "context" : ", without S−1 n ) was shown by Chwialkowski et al. (2015) to be a metric on the space of probability measures for any V .",
      "startOffset" : 31,
      "endOffset" : 58
    }, {
      "referenceID" : 20,
      "context" : "Assume that k is characteristic (Sriperumbudur et al., 2011).",
      "startOffset" : 32,
      "endOffset" : 60
    }, {
      "referenceID" : 22,
      "context" : "7 in van der Vaart and Wellner (2000). Then for any δ ∈ (0, 1) with probability at least 1− δ,",
      "startOffset" : 13,
      "endOffset" : 38
    }, {
      "referenceID" : 3,
      "context" : ", 1)) Blobs Gaussian mixtures in R as studied in Chwialkowski et al. (2015); Gretton et al.",
      "startOffset" : 49,
      "endOffset" : 76
    }, {
      "referenceID" : 3,
      "context" : ", 1)) Blobs Gaussian mixtures in R as studied in Chwialkowski et al. (2015); Gretton et al. (2012b).",
      "startOffset" : 49,
      "endOffset" : 100
    }, {
      "referenceID" : 3,
      "context" : "ME-grid and SCF-grid are as in Chwialkowski et al. (2015) where only the Gaussian width is optimized by a grid search,1and the test locations are randomly drawn from a multivariate normal distribution.",
      "startOffset" : 31,
      "endOffset" : 58
    }, {
      "referenceID" : 3,
      "context" : "ME-grid and SCF-grid are as in Chwialkowski et al. (2015) where only the Gaussian width is optimized by a grid search,1and the test locations are randomly drawn from a multivariate normal distribution. MMD-quad (quadratic-time) and MMD-lin (linear-time) refer to the nonparametric tests based on maximum mean discrepancy of Gretton et al. (2012a), where to ensure a fair comparison, the Gaussian kernel width is also chosen so as to maximize a criterion for the test power on training data, following the same principle as (Gretton et al.",
      "startOffset" : 31,
      "endOffset" : 347
    }, {
      "referenceID" : 3,
      "context" : "ME-grid and SCF-grid are as in Chwialkowski et al. (2015) where only the Gaussian width is optimized by a grid search,1and the test locations are randomly drawn from a multivariate normal distribution. MMD-quad (quadratic-time) and MMD-lin (linear-time) refer to the nonparametric tests based on maximum mean discrepancy of Gretton et al. (2012a), where to ensure a fair comparison, the Gaussian kernel width is also chosen so as to maximize a criterion for the test power on training data, following the same principle as (Gretton et al., 2012b). For MMDquad, since its null distribution is given by an infinite sum of weighted chi-squared variables (no closed-form quantiles), in each trial we randomly permute the two samples 400 times to approximate the null distribution. Finally, T 2 is the standard two-sample Hotelling’s T-squared test, which serves as a baseline with Gaussian assumptions on P and Q. In all the following experiments, each problem is repeated for 500 trials. For toy problems, new samples are generated from the specified P,Q distributions in each trial. For real problems, samples are partitioned randomly into training and test sets in each trial. In all of the simulations, we report an empirical estimate of P(λ̂ n/2 ≥ Tα) which is the proportion of the number of times the statistic λ̂ te n/2 is above Tα. This quantity is an estimate of type-I error under H0, and corresponds to test power when H1 is true. We set α = 0.01 in all the experiments. All the code and preprocessed data are available at https://github.com/wittawatj/interpretable-test. Optimization The parameter tuning objective λ̂ n/2(θ) is a function of θ consisting of one real-valued σ and J test locations each of d dimensions. The parameters θ can thus be regarded as a Jd + 1 Euclidean vector. We take the derivative of λ̂ n/2(θ) with respect to θ, and use gradient ascent to maximize it. J is pre-specified and fixed. For the ME test, we initialize the test locations with realizations from two multivariate normal distributions fitted to samples from P and Q; this ensures that the initial locations are well supported by the data. For the SCF test, initialization using the standard normal distribution is found to be sufficient. The parameter γn is not optimized; we set the regularization parameter γn to be as small as possible while being large enough to ensure that (Sn + γnI) −1 can be stably computed. We emphasize that both the optimization and testing are linear in n. The testing cost O(J + Jn + dJn) and the optimization costs O(J + dJn) per gradient ascent iteration. Runtimes of all methods are reported in Sec. C in the appendix. 1. Informative features: simple demonstration We begin with a demonstration that the proxy λ̂ n/2(θ) for the test power is informative for revealing the difference of the two samples in the ME Chwialkowski et al. (2015) chooses the Gaussian width that minimizes the median of the p-values, a heuristic that does not directly address test power.",
      "startOffset" : 31,
      "endOffset" : 2869
    }, {
      "referenceID" : 15,
      "context" : "The performance of MMD-lin degrades quickly with increasing dimension, as expected from Ramdas et al. (2015).",
      "startOffset" : 88,
      "endOffset" : 109
    }, {
      "referenceID" : 13,
      "context" : "Each paper is represented as a bag of words using TF-IDF (Manning et al., 2008) as features.",
      "startOffset" : 57,
      "endOffset" : 79
    }, {
      "referenceID" : 12,
      "context" : "For this purpose, we use Karolinska Directed Emotional Faces (KDEF) dataset (Lundqvist et al., 1998) containing 5040 aligned face images of 70 amateur actors, 35 females and 35 males.",
      "startOffset" : 76,
      "endOffset" : 100
    }, {
      "referenceID" : 13,
      "context" : "Treat each paper as a bag of words and construct a feature vector with TF-IDF (Manning et al., 2008).",
      "startOffset" : 78,
      "endOffset" : 100
    }, {
      "referenceID" : 22,
      "context" : "7 in van der Vaart and Wellner (2000). Then for any δ ∈ (0, 1) with probability at least 1− δ,",
      "startOffset" : 13,
      "endOffset" : 38
    }, {
      "referenceID" : 2,
      "context" : "By the Dudley entropy bound Bousquet (2003) [see Eq.",
      "startOffset" : 28,
      "endOffset" : 44
    }, {
      "referenceID" : 18,
      "context" : "The VC property will be a direct consequence of the VC indices of finite-dimensional function classes and preservation theorems (see Lemma 7); for a nice example application see Srebro and Ben-David (2006) (Section 5) who study the pseudo-dimension of (x,y) 7→ k(x,y) kernel classes, for different Gaussian families.",
      "startOffset" : 178,
      "endOffset" : 206
    }, {
      "referenceID" : 21,
      "context" : "Lemma 7 (properties of VC classes, see page 141, 146-147 in van der Vaart and Wellner (2000) and page 160-161 in Kosorok (2008)).",
      "startOffset" : 68,
      "endOffset" : 93
    }, {
      "referenceID" : 9,
      "context" : "Lemma 7 (properties of VC classes, see page 141, 146-147 in van der Vaart and Wellner (2000) and page 160-161 in Kosorok (2008)).",
      "startOffset" : 113,
      "endOffset" : 128
    } ],
    "year" : 2016,
    "abstractText" : "Two semimetrics on probability distributions are proposed, given as the sum of differences of expectations of analytic functions evaluated at spatial or frequency locations (i.e, features). The features are chosen so as to maximize the distinguishability of the distributions, by optimizing a lower bound on test power for a statistical test using these features. The result is a parsimonious and interpretable indication of how and where two distributions differ locally. We show that the empirical estimate of the test power criterion converges with increasing sample size, ensuring the quality of the returned features. In real-world benchmarks on highdimensional text and image data, linear-time tests using the proposed semimetrics achieve comparable performance to the state-of-the-art quadratic-time maximum mean discrepancy test, while returning human-interpretable features that explain the test results.",
    "creator" : "LaTeX with hyperref package"
  }
}