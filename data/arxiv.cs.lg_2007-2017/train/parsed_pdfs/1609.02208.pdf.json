{
  "name" : "1609.02208.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Breaking the Bandwidth Barrier: Geometrical Adaptive Entropy Estimation",
    "authors" : [ "Weihao Gao", "Sewoong Oh", "Pramod Viswanath" ],
    "emails" : [ "wgao9@illinois.edu", "swoh@illinois.edu", "pramodv@illinois.edu" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Unsupervised representation learning is one of the major themes of modern data science; a common theme among the various approaches is to extract maximally “informative\" features via information-theoretic metrics (entropy, mutual information and their variations) – the primary reason for the popularity of information theoretic measures is that they are invariant to one-to-one transformations and that they obey natural axioms such as data processing. Such an approach is evident in many applications, as varied as computational biology [17], sociology [30] and information retrieval [23], with the citations representing a mere smattering of recent works. Within mainstream machine learning, a systematic effort at unsupervised clustering and hierarchical information extraction is conducted in recent works of [37, 35]. The basic workhorse in all these methods is the computation of mutual information (pairwise and multivariate) from i.i.d. samples. Indeed, sample-efficient estimation of mutual information emerges as the central scientific question of interest in a variety of applications, and is also of fundamental interest to statistics, machine learning and information theory communities. While these estimation questions have been studied in the past three decades (and summarized in [40]), the renewed importance of estimating information theoretic measures in a sample-efficient manner is persuasively argued in a recent work [6], where the authors note that existing estimators perform poorly in several key scenarios of central interest (especially when the high dimensional random variables are strongly related to each other). The most common estimators (featured in scientific software packages) are nonparametric and involve k nearest neighbor (NN) distances between the samples. The widely used estimator of mutual information is the one by Kraskov and Stögbauer and Grassberger [16] and christened the KSG estimator (nomenclature based on the authors, cf. [6]) – while this estimator works well in practice (and performs much better than other approaches such as those based on kernel density estimation procedures), it ∗Coordinated Science Lab and Department of Electrical and Computer Engineering †Coordinated Science Lab and Department of Industrial and Enterprise Systems Engineering\nar X\niv :1\n60 9.\n02 20\n8v 1\n[ cs\n.I T\n] 7\nS ep\n2 01\nstill suffers in high dimensions. The basic issue is that the KSG estimator (and the underlying differential entropy estimator based on nearest neighbor distances by Kozachenko and Leonenko (KL) [15]) does not take advantage of the fact that the samples could lie in a smaller dimensional subspace (more generally, manifold) despite the high dimensionality of the data itself. Such lower dimensional structures effectively act as boundaries, causing the estimator to suffer from what is known as boundary biases.\nAmeliorating this deficiency is the central theme of recent works [7, 6, 22], each of which aims to improve upon the classical KL (differential) entropy estimator of [15]. A local SVD is used to heuristically improve the density estimate at each sample point in [6], while a local Gaussian density (with empirical mean and covariance weighted by NN distances) is heuristically used for the same purpose in [22]. Both these approaches, while inspired and intuitive, come with no theoretical guarantees (even consistency) and from a practical perspective involve delicate choice of key hyper parameters. An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics. The local density estimation method is a strong generalization of the traditional kernel density estimation methods, but requires a delicate normalization which necessitates the solution of certain integral equations (cf. Equation (9) of [21]). Indeed, such an elaborate numerical effort is one of the key impediments for the entropy estimator of [7] to be practically valuable. A second key impediment is that theoretical guarantees (such as consistency) can only be provided when the bandwidth is chosen globally (leading to poor sample complexity in practice) and consistency requires the bandwidth h to be chosen such that nhd →∞ and h→ 0, where n is the sample size and d is the dimension of the random variable of interest. More generally, it appears that a systematic application of local log-likelihood methods to estimate functionals of the unknown density from i.i.d. samples is missing in the theoretical statistics literature (despite local log-likelihood methods for regression and density estimation being standard textbook fare [41, 20]). We resolve each of these deficiencies in this paper by undertaking a comprehensive study of estimating the (differential) entropy and mutual information from i.i.d. samples using sample dependent bandwidth choices (typically fixed k-NN distances). This effort allows us to connect disparate threads of ideas from seemingly different arenas: NN methods, local log-likelihood methods, asymptotic order statistics and sample-dependent heuristic, but inspired, methods for mutual information estimation suggested in the work of [16].\nMain Results: We make the following contributions.\n1. Density estimation: Parameterizing the log density by a polynomial of degree p, we derive simple closed form expressions for the local log-likelihood maximization problem for the cases of p ≤ 2 for arbitrary dimensions, with Gaussian kernel choices. This derivation, posed as an exercise in [20, Exercise 5.2], significantly improves the computational efficiency upon similar endeavors in the recent efforts of [7, 22, 38].\n2. Entropy estimation: Using resubstitution of the local density estimate, we derive a simple closed form estimator of the entropy using a sample dependent bandwidth choice (of k-NN distance, where k is a fixed small integer independent of the sample size): this estimator outperforms state of the art entropy estimators in a variety of settings. Since the bandwidth is data dependent and vanishes too fast (because k is fixed), the estimator has a bias, which we derive a closed form expression for and show that it is independent of the underlying distribution and hence can be easily corrected: this is our main theoretical contribution, and involves new theorems on asymptotic statistics of nearest neighbors generalizing classical work in probability theory [29], which might be of independent mathematical interest.\n3. Generalized view: We show that seemingly very different approaches to entropy estimation – recent works of [6, 7, 22] and the classical work of fixed k-NN estimator of Kozachenko and Leonenko [15] – can all be cast in the local log-likelihood framework as specific kernel and sample dependent bandwidth choices. This allows for a unified view, which we theoretically justify by showing that resubstitution entropy estimation for any kernel choice using fixed k-NN distances as bandwidth involves a bias term that is independent of the underlying distribution (but depends on the specific choice of kernel and parametric density family). Thus our work is a strict mathematical generalization of the classical work of [15].\n4. Mutual Information estimation: The inspired work of [16] constructs a mutual information estimator that subtly altered (in a sample dependent way) the three KL entropy estimation terms, leading to superior empirical performance. We show that the underlying idea behind this change can be incorporated in our framework as well, leading to a novel mutual information estimator that combines the two ideas and outperforms state of the art estimators in a variety of settings.\nIn the rest of this paper we describe these main results, the sections organized in roughly the same order as the enumerated list."
    }, {
      "heading" : "2 Local likelihood density estimation (LLDE)",
      "text" : "Given n i.i.d. samples X1, . . . , Xn, estimating the unknown density fX(·) in Rd is a very basic statistical task. Local likelihood density estimators [21, 12] constitute state of the art and are specified by a weight function K : Rd → R (also called a kernel), a degree p ∈ Z+ of the polynomial approximation, and the bandwidth h ∈ R, and maximizes the local log-likelihood:\nLx(f) = n∑ j=1 K ( Xj − x h ) log f(Xj)− n ∫ K ( u− x h ) f(u) du , (1)\nwhere maximization is over an exponential polynomial family, locally approximating f(u) near x:\nloge fa,x(u) = a0 + 〈a1, u− x〉+ 〈u− x, a2(u− x)〉+ · · ·+ ap[u− x, u− x, . . . , u− x] , (2)\nparameterized by a = (a0, . . . , ap) ∈ R1×d×d 2×···×dp , where 〈·, ·〉 denotes the inner-product and ap[u, . . . , u] the p-th order tensor projection. The local likelihood density estimate (LLDE) is defined as f̂n(x) = fâ(x),x(x) = eâ0(x), where â(x) ∈ arg maxa Lx(fa,x). The maximizer is represented by a series of nonlinear equations, and does not have a closed form in general. We present below a few choices of the degrees and the weight functions that admit closed form solutions. Concretely, for p = 0, it is known that LDDE reduces to the standard Kernel Density Estimator (KDE) [21]:\nf̂n(x) = 1\nn n∑ i=1 K ( x−Xi h )/∫ K ( u− x h ) du . (3)\nIf we choose the step function K(u) = I(‖u‖ ≤ 1) with a local and data-dependent choice of the bandwidth h = ρk,x where ρk,x is the k-NN distance from x, then the above estimator recovers the popular k-NN density estimate as a special case, namely, for Cd = πd/2/Γ(d/2 + 1),\nf̂n(x) = 1 n\n∑n i=1 I(‖Xi − x‖ ≤ ρk,x)\nVol{u ∈ Rd : ‖u− x‖ ≤ ρk,x} =\nk\nnCd ρdk,x . (4)\nFor higher degree local likelihood, we provide simple closed form solutions and provide a proof in Section 8.1. Somewhat surprisingly, this result has eluded prior works [22, 38] and [7] which specifically attempted the evaluation for p = 2. Part of the subtlety in the result is to critically use the fact that the parametric family (eg., the polynomial family in (2)) need not be normalized themselves; the local log-likelihood maximization ensures that the resulting density estimate is correctly normalized so that it integrates to 1.\nProposition 2.1. [20, Exercise 5.2] For a degree p ∈ {1, 2}, the maximizer of local likelihood (1) admits a closed form solution, when using the Gaussian kernel K(u) = e− ‖u‖2 2 . In case of p = 1,\nf̂n(x) = S0\nn(2π)d/2hd exp\n{ −1\n2\n1\nS20 ‖S1‖2\n} , (5)\nwhere S0 ∈ R and S1 ∈ Rd are defined for given x ∈ Rd and h ∈ R as\nS0 ≡ n∑ j=1 e− ‖Xj−x‖ 2 2h2 , S1 ≡ n∑ j=1 1 h (Xj − x) e− ‖Xj−x‖ 2 2h2 . (6)\nIn case of p = 2, for S0 and S1 defined as above,\nf̂n(x) = S0\nn(2π)d/2hd|Σ|1/2 exp\n{ − 1\n2\n1\nS20 ST1 Σ −1S1\n} , (7)\nwhere |Σ| is the determinant and S2 ∈ Rd×d and Σ ∈ Rd×d are defined as\nS2 ≡ n∑ j=1 1 h2 (Xj − x)(Xj − x)T e− ‖Xj−x‖ 2 2h2 , Σ ≡ S0S2 − S1S T 1 S20 , (8)\nwhere it follows from Cauchy-Schwarz that Σ is positive semidefinite.\nOne of the major drawbacks of the KDE and k-NN methods is the increased bias near the boundaries. LLDE provides a principled approach to automatically correct for the boundary bias, which takes effect only for p ≥ 2 [12, 31]. This explains the performance improvement for p = 2 in the figure below (left panel), and the gap increases with the correlation as boundary effect becomes more prominent. We use the proposed estimators with p ∈ {0, 1, 2} to estimate the mutual information between two jointly Gaussian random variables with correlation r, from n = 500 samples, using resubstitution methods explained in the next sections. Each point is averaged over 100 instances.\nIn the right panel, we generate i.i.d. samples from a 2-dimensional Gaussian with correlation 0.9, and found local approximation f̂(u−x∗) around x∗ denoted by the blue ∗ in the center. Standard k-NN approach fits a uniform distribution over a circle enclosing k = 20 nearest neighbors (red circle). The green lines are the contours of the degree-2 polynomial approximation with bandwidth h = ρ20,x. The figure illustrates that k-NN method suffers from boundary effect, where it underestimates the probability by over estimating the volume in (4). However, degree-2 LDDE is able to correctly capture the local structure of the pdf, correcting for boundary biases. Despite the advantages of the LLDE, it requires the bandwidth to be data independent and vanishingly small (sublinearly in sample size) for consistency almost everywhere – both of these are impediments to practical use since there is no obvious systematic way of choosing these hyperparameters. On the other hand, if we restrict our focus to functionals of the density, then both these issues are resolved: this is the focus of the next section where we show that the bandwidth can be chosen to be based on fixed k-NN distances and the resulting universal bias easily corrected.\n3 k-LNN Entropy Estimator We consider resubstitution entropy estimators of the form Ĥ(x) = −(1/n) ∑n i=1 log f̂n(Xi) and propose to use the local likelihood density estimator in (7) and a choice of bandwidth that is local (varying for each point x) and adaptive (based on the data). Concretely, we choose, for each sample point Xi, the bandwidth hXi to be the the distance to its k-th nearest neighbor ρk,i. Precisely, we propose the following k-Local Nearest Neighbor (k-LNN) entropy estimator of degree-2:\nĤ (n) kLNN(X) = −\n1\nn n∑ i=1\n{ log\nS0,i n(2π)d/2ρdk,i|Σi|1/2 − 1 2 1 S20,i ST1,iΣ −1 i S1,i\n} −Bk,d , (9)\nwhere subtracting Bk,d defined in Theorem 1 removes the asymptotic bias, and k ∈ Z+ is the only hyper parameter determining the bandwidth. In practice k is a small integer fixed to be in the range 4 ∼ 8. We only use the dlog ne nearest subset of samples Ti = {j ∈ [n] : j 6= i and ‖Xi −Xj‖ ≤ ρdlogne,i} in computing the quantities below:\nS0,i ≡ ∑\nj∈Ti,m\ne − ‖Xj−Xi‖\n2\n2ρ2 k,i , S1,i ≡ ∑ j∈Ti,m 1 ρk,i (Xj −Xi)e − ‖Xj−Xi‖ 2 2ρ2 k,i ,\nS2,i ≡ ∑\nj∈Ti,m\n1\nρ2k,i (Xj −Xi)(Xj −Xi)T e\n− ‖Xj−Xi‖\n2\n2ρ2 k,i , Σi ≡ S0,iS2,i − S1,iST1,i S20,i . (10)\nThe truncation is important for computational efficiency, but the analysis works as long as m = O(n1/(2d)−ε) for any positive ε that can be arbitrarily small. For a larger m, for example of Ω(n), those neighbors that are further away have a different asymptotic behavior. We show in Theorem 1 that the asymptotic bias is independent of the underlying distribution and hence can be precomputed and removed, under mild conditions on a twice continuously differentiable pdf f(x) (cf. Lemma 3.1 below).\nTheorem 1. For k ≥ 3 and X1, X2, . . . , Xn ∈ Rd are i.i.d. samples from a twice continuously differentiable pdf f(x), then\nlim n→∞\nE[Ĥ(n)kLNN(X)] = H(X) , (11)\nwhere Bk,d in (9) is a constant that only depends on k and d. Further, if E[(log f(X))2] < ∞ then the variance of the proposed estimator is bounded by Var[Ĥ(n)kLNN(X)] = O((log n) 2/n).\nThis proves the L1 and L2 consistency of the k-LNN estimator; we relegate the proof to Section 10 for ease of reading the main part of the paper. The proof assumes Ansatz 1 (also stated in Section 10, which states that a certain exchange of limit holds. As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made. Our choice of a local adaptive bandwidth hXi = ρk,i is crucial in ensuring that the asymptotic bias Bk,d does not depend on the underlying distribution f(x). This relies on a fundamental connection to the theory of asymptotic order statistics made precise in Lemma 3.1, which also gives the explicit formula for the bias below.\nThe main idea is that the empirical quantities used in the estimate (10) converge in large n limit to similar quantities defined over order statistics. We make this intuition precise in the next section. We define order statistics over i.i.d. standard exponential random variables E1, E2, . . . , Em and i.i.d. random variables ξ1, ξ2, . . . , ξm drawn uniformly (the Haar measure) over the unit sphere in Rd, for a variable m ∈ Z+. We define for α ∈ {0, 1, 2},\nS̃(m)α ≡ m∑ j=1 ξ (α) j ( ∑j `=1E`) α ( ∑k `=1E` ) α exp { − ( ∑j `=1E` ) 2 2( ∑k `=1E` ) 2 } , (12)\nwhere ξ(0)j = 1, ξ (1) j = ξj ∈ Rd, and ξ (2) j = ξjξ T j ∈ Rd×d, and let S̃α = limm→∞ S̃ (m) α and Σ̃ = (1/S̃0)2(S̃0S̃2− S̃1S̃ T 1 ). We show that the limiting S̃α’s are well-defined (in the proof of Theorem 1) and are directly related to the bias terms in the resubstitution estimator of entropy:\nBk,d = E[ log( k∑ `=1 E`) + d 2 log 2π − logCd − log S̃0 + 1 2 log ∣∣Σ̃∣∣+ ( 1 2S̃20 S̃T1 Σ̃ −1S̃1) ] . (13)\nIn practice, we propose using a fixed small k such as five. For k ≤ 3 the estimator has a very large variance, and numerical evaluation of the corresponding bias also converges slowly. For some typical choices of k, we provide approximate evaluations below, where 0.0183(±6) indicates empirical mean µ = 183× 10−4 with confidence interval 6×10−4. In these numerical evaluations, we truncated the summation at m = 50, 000. Although we prove that Bk,d converges in m, in practice, one can choose m based on the number of samples and Bk,d can be evaluated for that m. Theoretical contribution: Our key technical innovation is a fundamental connection between nearest neighbor statistics and asymptotic order statistics, stated below as Lemma 3.1: we show that the (normalized) distances ρ`,i’s jointly converge to the standardized uniform order statistics and the directions (Xj` − Xi)/‖Xj` −Xi‖’s converge to independent uniform distribution (Haar measure) over the unit sphere.\nConditioned on Xi = x, the proposed estimator uses nearest neighbor statistics on Z`,i ≡ Xj` − x where Xj` is the `-th nearest neighbor from x such that Z`,i = ((Xj` − Xi)/‖Xj` − Xi‖)ρ`,i. Naturally, all the techniques we develop in this paper generalize to any estimators that depend on the nearest neighbor statistics {Z`,i}i,`∈[n] – and the value of such a general result is demonstrated later (in Section 4) when we evaluate the bias in similarly inspired entropy estimators [6, 7, 22, 15].\nLemma 3.1. Let E1, E2, . . . , Em be i.i.d. standard exponential random variables and ξ1, ξ2, . . . , ξm be i.i.d. random variables drawn uniformly over the unit (d− 1)-dimensional sphere in d dimensions, independent of the Ei’s. Suppose f is twice continuously differentiable and x ∈ Rd satisfies that there exists ε > 0 such that f(a) > 0, ‖∇f(a)‖ = O(1) and ‖Hf (a)‖ = O(1) for any ‖a− x‖ < ε. Then for any m = O(log n), we have the following convergence conditioned on Xi = x:\nlim n→∞\ndTV((cdnf(x)) 1/d(Z1,i, . . . , Zm,i ) , ( ξ1E 1/d 1 , . . . , ξm( m∑ `=1 E`) 1/d )) = 0 . (14)\nwhere dTV(·, ·) is the total variation and cd is the volume of unit Euclidean ball in Rd.\nEmpirical contribution: Numerical experiments suggest that the proposed estimator outperforms state-of-the-art entropy estimators, and the gap increases with correlation. The idea of using k-NN distance as bandwidth for entropy estimation was originally proposed by Kozachenko and Leonenko in [15], and is a special case of the k-LNN method we propose with degree 0 and a step kernel. We refer to Section 4 for a formal comparison. Another popular resubstitution entropy estimator is to use KDE in (3) [13], which is a special case of the k-LNN method with degree 0, and the Gaussian kernel is used in simulations. As comparison, we also study a new estimator [14] based on von Mises expansion (as opposed to simple re-substitution) which has an improved convergence rate in the large sample regime. In Figure 2 (left), we draw 100 samples i.i.d. from two standard Gaussian random variables with correlation r, and plot resulting mean squared error averaged over 100 instances. The ground truth, in this case is H(X) = log(2πe) + 0.5 log(1− r2). On the right, we repeat the same simulation for fixed r = 0.99999 and varying number of samples and m = 7 loge n.\nIn Figure 3, we repeat the same simulation for 6 standard Gaussian random variables with Cov(X1, X2) = Cov(X3, X4) = Cov(X5, X6) = r and Cov(Xi, Xj) = 0 for other pairs (i, j). On the left, we draw 100 i.i.d.\nsamples with various r. We plot resulting mean squared error averaged over 100 instances. The ground truth is H(X) = 3 log(2πe) + 1.5 log(1− r2). On the right, we repeat the same simulation for fixed r = 0.99999 and varying number of samples and m = 7 loge n.\nIn Figure 4 (left), we draw 100 samples i.i.d. from a mixture of two joint Gaussian distributions with zero mean and covariance (\n1 r r 1\n) and ( 1 −r −r 1 ) , respectively, and plot resulting average estimate over 100\ninstances. Here we plot an upper bound of the ground truth H(X) ≤ log(2) + log(2πe) + 0.5 log(1− r2) for r ≥ 0.9. On the right, we repeat the same simulation for fixed r = 0.99999 and varying number of samples and m = 7 loge n.\n4 Universality of the k-LNN approach In this section, we show that Theorem 1 holds universally for a general family of entropy estimators, specified by the choice of k ∈ Z+, degree p ∈ Z+, and a kernel K : Rd → R, thus allowing a unified view of several seemingly disparate entropy estimators [15, 6, 7, 22]. The template of the entropy estimator is the following: given n i.i.d. samples, we first compute the local density estimate by maximizing the local likelihood (1) with bandwidth ρk,i, and then resubstitute it to estimate entropy: Ĥ (n) k,p,K(X) = −(1/n) ∑n i=1 log f̂n(Xi).\nTheorem 2. For the family of estimators described above, under the hypotheses of Theorem 1, if the solution to the maximization â(x) = arg maxa Lx(fa,x) exists for all x ∈ {X1, . . . , Xn}, then for any choice of k ≥ p+1, p ∈ Z+, and K : Rd → R, the asymptotic bias is independent of the underlying distribution:\nlim n→∞\nE[Ĥ(n)k,p,K(X)] = H(X) + B̃k,p,K,d , (15)\nfor some constant B̃k,d,p,K that only depends on k, p,K and d.\nWe provide a proof in Section 11. Although in general there is no simple analytical characterization of the asymptotic bias B̃k,p,K,d it can be readily numerically computed: since B̃k,p,K,d is independent of the underlying distribution, one can run the estimator over i.i.d. samples from any distribution and numerically approximate the bias for any choice of the parameters. However, when the maximization â(x) = arg maxa Lx(fa,x) admits a closed form solution, as is the case with proposed k-LNN, then B̃k,p,K,d can be characterized explicitly in terms of uniform order statistics.\nThis family of estimators is general: for instance, the popular KL estimator is a special case with p = 0 and a step kernel K(u) = I(‖u‖ ≤ 1). [15] showed (in a remarkable result at the time) that the asymptotic bias is independent of the dimension d and can be computed exactly to be log n− ψ(n) + ψ(k)− log k and ψ(k) is the digamma function defined as ψ(x) = Γ−1(x)dΓ(x)/dx. The dimension independent nature of this asymptotic bias term (of O(n−1/2) for d = 1 in [36, Theorem 1] and O(n−1/d) for general d in [8]) is special to the choice of p = 0 and the step kernel; we explain this in detail in Section 11, later in the paper. Analogously, the estimator in [6] can be viewed as a special case with p = 0 and an ellipsoidal step kernel.\n5 k-LNN Mutual information estimator Given an entropy estimator ĤKL, mutual information can be estimated: Î3KL = ĤKL(X) + ĤKL(Y ) − ĤKL(X,Y ). In [16], Kraskov and Stögbauer and Grassberger introduced ÎKSG(X;Y ) by coupling the choices of the bandwidths. The joint entropy is estimated in the usual way, but for the marginal entropy, instead of using kNN distances from {Xj}, the bandwidth hXi = ρk,i(X,Y ) is chosen, which is the k nearest neighbor distance from (Xi, Yi) for the joint data {(Xj , Yj)}. Consider Î3LNN(X;Y ) = ĤkLNN(X) + ĤkLNN(Y )− ĤkLNN(X,Y ). Inspired by [16], we introduce the following novel mutual information estimator we denote by ÎLNN−KSG(X;Y ). where for the joint (X,Y ) we use the LNN entropy estimator we proposed in (9), and for the marginal entropy we use the bandwidth hXi = ρk,i(X,Y ) coupled to the joint estimator. Empirically, we observe ÎKSG outperforms Î3KL everywhere, validating the use of correlated bandwidths. However, the performance of ÎLNN−KSG is similar to Î3LNN–sometimes better and sometimes worse. In Figure 5 (left), we estimate mutual information under the same setting as in Figure 2 (left). For most regimes of correlation r, both 3LNN and LNN-KSG outperforms other state-of-the-art estimators. The gap\nincreases with correlation r. On the right, we draw i.i.d. samples from two random variables X and Y , where X is uniform over [0, 1] and Y = X + U , where U is uniform over [0, 0.01] independent of X. In the large sample limit, all estimators find the correct mutual information. The plot show how sensitive the estimates are, in the small sample regime. Both LNN and LNN-KSG are significantly more robust compared to other approaches. Mutual information estimators have been recently proposed in [6, 7, 22] based on local likelihood maximization. However, they involve heuristic choices of hyper-parameters or solving elaborate optimization and numerical integrations, which are far from being easy to implement.\nIn Figure 6, we test the mutual information estimators for Y = f(X) + U , where X is uniformly distributed over [0, 1] and U is uniformly distributed over [0, θ], independent of X, for some noise level θ. Similar simulation were studied in [7]. We draw 2500 i.i.d. sample points for each relationship. The plot show that for small noise level θ, i.e., near-functional related random variables, our proposed estimators Î3LNN and ÎLNN−KSG perform much better than 3KL and KSG estimators. Also our proposed estimators can handle both linear and nonlinear functional relationships.\nIn Figure 7, we test our estimators on linear and nonlinear relationships for both low-dimensional (D = 2) and high-dimensional (D = 5). Here Xi’s are uniformly distributed over [0, 1] and U is uniformly distributed over [−38/2, 38/2], independently of Xi’s. Similar simulation were studied in [6]. We can see that our estimators Î3LNN and ÎLNN−KSG converges much faster than Î3KL and ÎKSG."
    }, {
      "heading" : "6 Breaking the bandwidth barrier",
      "text" : "While k-NN distance based bandwidth are routine in practical usage [31], the main finding of this work is that they also turn out to be the “correct\" mathematical choice for the purpose of asymptotically unbiased estimation of an integral functional such as the entropy: − ∫ f(x) log f(x); we briefly discuss the ramifications below. Traditionally, when the goal is to estimate f(x), it is well known that the bandwidth should satisfy h→ 0 and nhd →∞, for KDEs to be consistent. As a rule of thumb, h = 1.06σ̂n−1/5 is suggested when d = 1 where σ̂ is the sample standard deviation [41, Chapter 6.3]. On the other hand, when estimating entropy, as well as other integral functionals, it is known that resubstitution estimators of the form −(1/n) ∑n i=1 log f̂(Xi) achieve variances scaling as O(1/n) independent of the bandwidth [19]. This allows for a bandwidth as small as O(n−1/d). The bottleneck in choosing such a small bandwidth is the bias, scaling as O(h2 + (nhd)−1 + En) [19], where the lower order dependence on n, dubbed En, is generally not known. The barrier in choosing a global bandwidth of h = O(n−1/d) is the strictly positive bias whose value depends on the unknown distribution and cannot be subtracted off. However, perhaps surprisingly, the proposed local and adaptive choice of the k-NN distance admits an asymptotic bias that is independent of the unknown underlying distribution. Manually subtracting off the non-vanishing bias gives an asymptotically unbiased estimator, with a potentially faster\nconvergence as numerically compared below. Figure 8 illustrates how k-NN based bandwidth significantly improves upon, say a rule-of-thumb choice of O(n−1/(d+4)) explained above and another choice of O(n−1/(d+2)). In the left figure, we use the setting from Figure 2 (right) but with correlation r = 0.999. On the right, we generate X ∼ N (0, 1) and U from uniform [0, 0.01] and let Y = X + U and estimate I(X;Y ). Following recent advances in [18, 33], the proposed local estimator has a potential to be extended to, for example, Renyi entropy, but with a multiplicative bias as opposed to additive."
    }, {
      "heading" : "7 Discussion",
      "text" : "The topic of estimation of an integral functional of an unknown density from i.i.d. samples is a classical one in statistics and we tie together a few pertinent topics from the literature in the context of the results of this manuscript."
    }, {
      "heading" : "7.1 Uniform order statistics and NN distances",
      "text" : "The expression for the asymptotic bias in (13) which is independent of the underlying distribution forms the main result of this paper and crucially depends on Lemma 3.1. Precisely, the lemma implies that the quantities Si’s in (10) converge in distribution to S̃i’s in (12). There are two parts to this convergence result: the nearest neighbor distances converge to uniform order statistics and the directions to those nearest neighbors converge independently to Haar measures on the unit sphere. The former has been extensively studied, for example see [29] for a survey of results. The latter is a new result that we state in Lemma 3.1, and proved in Section 9. Intuitively, assuming smoothness, the probability density fX in the neighborhood of a sample Xi (as defined by the distance to the k-th nearest neighbor) converges to a uniform distribution over a ball (of radius decreasing at the rate ρk,i = Θ(n−1/d)), as more samples are collected. The nearest neighbor distances and directions converge to those from the uniform distribution over the ball, and Lemma 3.1 makes this intuition precise for the nearest m neighbors up to m = O(n1/(2d)− ) with any arbitrarily small but positive ε.\nOnly the convergence analysis of the distances, and not the directions, is required for traditional k-NN\nbased estimators, such as the entropy estimator of [15]. In the seminal paper, [15] introduced resubstitution entropy estimators of the form Ĥ(X) = −(1/n) ∑n i=1 log f̂n(Xi) with f̂n(x) = k/(nCd ρ d k,x) (as defined in (4)). This k-NN estimator has a non-vanishing asymptotic bias, which was computed as Bk,d = (ψ(k)− log(k)) with the digamma function ψ(·) and was suggested to be manually removed. For k = 1 this was proved in the original paper of [15], which later was extended in [32, 9] to general k. This mysterious bias term Bk,d = (ψ(k)− log(k)) whose original proofs in [15, 32, 9] provided little explanation for, can be alternatively proved with both rigor and intuition by making connections to uniform order statistics. For a special case of k = 1, with extra assumptions on the support being compact, such an elegant proof is provided in [2, Theorem 7.1] which explicitly applies the convergence of the nearest neighbor distance to uniform order statistics. Namely,\nE[Ĥ(X)] = E [ − 1 n n∑ i=1 log ( k nCd ρdk,Xi ) ] → E [ − log k f(Xi)∑k\nj=1Ej ] = H(X) + ψ(k)− log(k) ,\nwhere the asymptotic expression follows from Cd n f(x)ρdk,x → ∑k j=1Ej as shown, for example, in Lemma 3.1\nand we used E[log ∑k j=1Ej ] = ψ(k), where ψ(k) = is the digamma function defined as ψ(x) = Γ\n−1(x)dΓ(x)/dx and for large x it is approximately log(x) up to O(1/x), i.e. ψ(x) = log x− 1/(2x) + o(1/x). Note that this only requires the convergence of the distance and not the direction. Inspired by this modern approach, we extend such a connection in Lemma 3.1 to prove consistency of our estimator."
    }, {
      "heading" : "7.2 Convergence rate of the bias",
      "text" : "Establishing the convergence rate of the KL estimator is a challenging problem, and is not quite resolved despite work over the past three decades. The O(1/n) convergence rate of the variance is established in [3, 18, 2, 4] under various assumptions. Establishing the convergence rate of the bias is more challenging. It has been first studied in [10, 11], where root-n consistency is shown in 1-dimension with bounded support and assuming f(x) is bounded below. [36] is the first to prove a root mean squared error convergence rate of O(1/ √ n) for general densities with unbounded support in 1-dimension and exponentially decaying tail, such as the Gaussian density. These assumptions are relaxed in [5], where zeroes and fat tails are allowed in f(x). In general d-dimensions, [8, 33] prove bounds on the convergence rate of the bias for finite k = O(1), and [24, 1] for k = Ω(log n). Establishing the convergence rate for the bias of the proposed local estimator is an interesting open problem – it is interesting to see if the superior empirical performance of the local estimator is captured in the asymptotics of rate of convergence of the bias.\nIt is intuitive that kernel density estimators can capture the structure in the distribution if the distribution lies on a lower dimensional manifold. This is made precise in [27], which also shows improved convergence rates for distributions whose support is on low dimensional manifolds. However, the estimator in [27] critically uses the geodesic distances between the sample points on the manifold. Given that the proposed estimators fit distributions locally, a concrete question of interest is whether such an improvement can be achieved without such an explicit knowledge of the geodesic distances, i.e., whether the local estimators automatically adapt to underlying lower dimensional structures."
    }, {
      "heading" : "7.3 Ensemble estimators",
      "text" : "Recent works [34, 25, 26, 1] have proposed ensemble estimators, which use known estimators based on kernel density estimators and k-NN methods and construct a new estimate by taking the weighted linear combination of those methods with varying bandwidth or k, respectively. With a proper choice of the weights, which can be computed analytically by solving a simple linear program, a boosting of the convergence rate can be achieved. The key property that allows the design of such ensemble estimators is that the leading terms (in terms of the sample size n) of the bias have a multiplicative constant that only depends on the unknown distribution. An intuitive explanation for this phenomenon is provided in [1] in the context of k-NN methods; it is interesting to explore if such a phenomenon continues in the k-LNN scenario studied in this paper. Such a study would potentially lead to ensemble-based estimators in the local setting and also naturally allow a careful understanding of the rate of convergence of the bias term."
    }, {
      "heading" : "8 Proofs",
      "text" : ""
    }, {
      "heading" : "8.1 Proof of proposition 2.1",
      "text" : "We first prove the derivation of the LLDE with degree p = 2 in Equation (7). The gradient of the local likelihood evaluated at the maximizer is zero [21], which gives a computational tool for finding the maximizer:\n1\nn n∑ j=1 K( Xj − x h ) = ∫ K( u− x h )ea0+a T 1 (u−x)+(u−x) T a2(u−x)du , (16)\n1\nn n∑ j=1 Xj − x h K( Xj − x h ) = ∫ u− x h K( u− x h )ea0+a T 1 (u−x)+(u−x) T a2(u−x)du , (17)\n1\nn n∑ j=1 (Xj − x)(Xj − x)T h2 K( Xj − x h )\n=\n∫ (u− x)(u− x)T\nh2 K( u− x h )ea0+a T 1 (u−x)+(u−x) T a2(u−x)du , (18)\nwhere K(x) = exp{−‖x‖2/2} is the Gaussian kernel. Notice that the left-hand side of the equations are S0/n, S1/n and S2/n, respectively. The RHS can be written in closed forms as:\n1 n S0 = (2π) d/2|M |−1/2ea0+ 12a T 1 M −1a1 , (19) 1 n S1 = 1 nh S0M −1a1 , (20) 1 n S2 = 1 nh2 S0(M −1 +M−1a1a T 1M −1) , (21)\nwhere M = h−2Id×d − 2a2 assuming h sufficiently small such that M is positive definite. We want to derive f̂(x) = exp{a0} from the equations. From (20) we get M−1a1 = S1(h/S0). Together with (21), we get M−1 +M−1a1a T 1M −1 = S2(h 2/S0). Hence, M−1 = (S2/S0− (S1/S0)(S1/S0)T )h2 = h2Σ. Plug them in (19), we obtain the desired expression. Analogously, for the derivation of the LLDE with degree p = 1 in Equation (5), we get\n1 n S0 = (2π) d/2hdea0+ h2 2 a T 1 a1 , (22) 1 n S1 = h n S0a1 . (23)\nThis gives a1 = (1/(hS0))S1, and ea0 = (S0/(n(2π)d/2hd)) exp{−0.5‖S1‖2/S20}."
    }, {
      "heading" : "9 Proof of Lemma 3.1",
      "text" : "Let us introduce some notations first. Define Sd−1 ≡ {x ∈ Rd : ‖x‖ = 1} as the unit (d − 1)-dimensional sphere and σd−1 as a normalized spherical measure on Sd−1. For any θ = (θ1, . . . , θm) ∈ (Sd−1)m and x = (x1, . . . , xm) ∈ Rm+ , define θx ≡ (θ1x1, . . . , θmxm) ∈ Rd×m. For any set B ∈ Rd×m and θ ∈ (Sd−1)m, define Bθ = {x ∈ Rm+ : θx ∈ B}. Let {ξi}mi=1 be i.i.d. random variables uniformly over Sd−1. Then for any joint random variables (W1, . . . ,Wm) ∈ Rm+ which are independent with {ξi}mi=1, we have\nP{(ξ1W1, . . . , ξmWm) ∈ B} = ∫ θ∈(Sd−1)m P{(W1, . . . ,Wm) ∈ Bθ | θ} d(σd−1)m(θ) . (24)\nLet Z = (Z1,i, . . . , Zm,i), ‖Z‖ = (‖Z1,i‖, . . . , ‖Zm,i‖) and let E = (E1/d1 , . . . , ( ∑m `=1E`)\n1/d), then∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B }− P {( ξ1E 1/d 1 , . . . , ξm( m∑ `=1 E`) 1/d ) ∈ B }∣∣∣∣∣ ≤\n∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B }− ∫ θ∈(Sd−1)m P{(E1/d1 , . . . , ( m∑ `=1 E`) 1/d) ∈ Bθ | θ} d(σd−1)m(θ) ∣∣∣∣∣ ≤\n∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B }− ∫ θ∈(Sd−1)m P{(cdnf(x))1/d‖Z‖ ∈ Bθ | θ} d(σd−1)m(θ) ∣∣∣∣∣ +\n∫ θ∈(Sd−1)m ∣∣∣P{(cdnf(x))1/d‖Z‖ ∈ Bθ | θ} − P{E ∈ Bθ | θ} ∣∣∣ d(σd−1)m(θ) . (25) Now consider the first term in (25). We consider two cases separately. Case 1. If ‖Zm,i‖ ≥ ( √ ncdf(x))\n−1/d, we show that the tail events happen with a low probability. Denote B(x, r) = {z : ‖z − x‖ ≤ r} and let p = P{t ∈ B(x, ‖Zm,i‖)} = ∫ B(x,‖Zm,i‖) f(t)dt. Since f is twice continuously differentiable, we can see that p ≥ 0.5cd‖Zm,i‖df(x) ≥ 0.5/ √ n for sufficiently large n. Therefore,\nP{‖Zm,i‖ ≥ ( √ ncdf(x)) −1/d} = m−1∑ `=0 ( n ` ) p`(1− p)n−` ≤ m−1∑ `=0 n` ( 1− 1 2 √ n )(n−`) ≤\nm−1∑ `=0 nle−( √ n−` √ n)/2 ≤ mnme−( √ n−m/ √ n)/2 . (26)\nCase 2. If ‖Zm,i‖ < ( √ ncdf(x)) −1/d, let B = {t : (cdnf(x))1/dt ∈ B and ‖tm‖ < ( √ ncdf(x))\n−1/d} and Bθ = {t : (cdnf(x))1/dt ∈ Bθ and tm < ( √ ncdf(x)) −1/d}. Note that\nP(Z ∈ Ã) = (n!/(n− k)!) ∫ t∈Ã m∏ j=1 f(x+ tj)PX(|X − x| > |tm|)n−mdt , (27)\nwhich gives∫ θ∈(Sd−1)m P{(cdnf(x)) 1/d‖Z‖ ∈ Bθ, ‖Zm,i‖ < ( √ ncdf(x))\n−1/d | θ} d(σd−1)m(θ) P{(cdnf(x))1/dZ ∈ B, ‖Zm,i‖ < ( √ ncdf(x))−1/d}\n=\n∫ θ∈(Sd−1)m P{‖Z‖ ∈ Bθ | θ} d(σ d−1)m(θ)\nP{Z ∈ B}\n=\n∫ θ∈(Sd−1)m n! (n−k)! ( ∫ t∈Bθ (∏m j=1 f(x+ θjtj) ) (P{‖X − x‖ > ‖tm‖} )n−m dt ) d(σd−1)m(θ)\nn! (n−k)! ∫ t∈B (∏m j=1 f(x+ tj) ) (P{‖X − x‖ > ‖tm‖} )n−m dt\n≤ supθ∈(Sd−1)m supt∈Bθ\n∏m j=1 f(x+ θjtj)\ninft∈B ∏m j=1 f(x+ tj)\n≤\n( sup‖t‖≤( √ ncdf(x))−1/d f(x+ t)\ninf‖t‖≤( √ ncdf(x))−1/d f(x+ t)\n)m , (28)\nwhere the first inequality follows from the fact that ∫ θ∈(Sd−1)m( ∫ Bθ g(tm)dt)d(σ d−1)m(θ) = ∫ B g(‖tm‖)dt.\nSince f is continuously differentiable, by mean value theorem, there exists a, b ∈ B(x, ( √ ncdf(x))\n−1/d) such that\nsup‖t‖≤( √ ncdf(x))−1/d f(x+ t) inf‖t‖≤( √ ncdf(x))−1/d f(x+ t) = f(b) + (a− b)T∇f(a) f(b) ≤ 1 + 2(\n√ ncdf(x))\n−1/d‖∇f(a)‖ f(b) , (29)\nBy the assumption, there exists a ball B(x, ε) such that ‖∇f(a)‖ = O(1) and f(a) > 0 for all a ∈ B(x, ε), so for sufficiently large n such that ( √ ncdf(x))\n−1/d < ε, there exists some constant C such that sup‖t‖≤( √ ncdf(x))−1/d\nf(x+t) ≤ (1+Cn−1/(2d)) inf‖t‖≤(√ncdf(x))−1/d f(x+t). Therefore, (28) is upper bounded by (1 + Cn−1/(2d))m. Similarly, (28) is lower bounded by (1− Cn−1/(2d))m.\nFor simplicity, let E = {‖Zm,i‖ < ( √ ncdf(x))\n−1/d}. Then combining the two cases, the first term in (25) is bounded by:∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B }− ∫ θ∈(Sd−1)m P{(cdnf(x))1/d‖Z‖ ∈ Bθ | θ} d(σd−1)m(θ)\n∣∣∣∣∣ ≤ P { (cdnf(x)) 1/dZ ∈ B, EC } + ∫ θ∈(Sd−1)m P{(cdnf(x))1/d‖Z‖ ∈ Bθ, EC | θ} d(σd−1)m(θ)\n+ ∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B, E }− ∫ θ∈(Sd−1)m P{(cdnf(x))1/d‖Z‖ ∈ Bθ, E | θ} d(σd−1)m(θ) ∣∣∣∣∣ ≤ P{EC}+\n∫ θ∈(Sd−1)m P{EC} d(σd−1)m(θ)\n+ P { (cdnf(x)) 1/dZ ∈ B, E } ∣∣∣∣∣ 1− ∫ θ∈(Sd−1)m P{(cdnf(x)) 1/d‖Z‖ ∈ Bθ, E | θ} d(σd−1)m(θ) P { (cdnf(x))1/dZ ∈ B, E } ∣∣∣∣∣\n≤ 2P{EC}+ P { (cdnf(x)) 1/dZ ∈ B, E } max{(1 + Cn−1/(2d))m − 1, 1− (1− Cn−1/(2d))m} ≤ 2mnme−( √ n−m/ √ n)/2 + max{(1 + Cn−1/(2d))m − 1, 1− (1− Cn−1/(2d))m} . (30)\nNow consider the second term of (25). We will use Corollary 5.5.5 of [29] to show that this term vanishes for m = O(log n) and as n grows.\nLemma 9.1 (Corollary 5.5.5, [29]). Let Y1, Y2, . . . , Yn be i.i.d. samples from unknown distribution with pdf f . Let Y1:n ≤ Y2:n ≤ · · · ≤ Yn:n be the order statistics. Assume the density f satisfies | log f(y)| ≤ Lyδ for 0 < y < y0 and f(y) = 0 for y < 0, where L and δ are constants. Then\ndTV ( n (Y1:n, Y2:n, . . . , Ym:n) , ( E1, E1 + E2, . . . , m∑ j=1 Ej ) ) ≤ C0 ( (m/n)δm1/2 +m/n ) , (31)\nwhere C0 > 0 is a constant. E1, . . . , Em are i.i.d standard exponential random variables.\nNow for fixed x, consider the distribution of cdf(x)‖X − x‖d denoted by P̃ . Define Y1, Y2, . . . , Yn drawn i.i.d. from P̃ . We can see that cdf(x)‖Z‖d L = (Y1:n, . . . , Ym:n), where L = denotes equivalence in distribution. The pdf f̃ of P̃ is given by:\nf̃(t) = d\ndt P{cdf(x)‖X − x‖d ≤ t} =\nd\ndt ∫ y∈B(x,rt) f(y)dy . (32)\nwhere rt = (t/(cdf(x)))1/d. Here we have:\ndrt dt\n= t1/d−1(cdf(x)) −1/d\nd =\n1\nf(x)dcdr d−1 t\n. (33)\nIf f is twice continuously differentiable, we have:∣∣∣ f̃(t)− 1 ∣∣∣ = ∣∣∣∣∣ ddt ∫ y∈B(x,rt) f(y)dy − 1 ∣∣∣∣∣ = ∣∣∣∣∣ drtdt ( ddrt ∫ y∈B(x,rt) f(y)dy)− 1 ∣∣∣∣∣ = 1\nf(x)dcdr d−1 t ∣∣∣∣∣ ddrt (∫ y∈B(x,rt) f(y)dy ) − f(x)dcdrd−1t ∣∣∣∣∣ = 1\nf(x)dcdr d−1 t ∣∣∣∣∣ ∫ y∈Sd−1(x,rt) (f(y)− f(x))dσd−1(y) ∣∣∣∣∣ , (34)\nwhere Sd−1 is the (d−1)-sphere centered at x with radius rt and σd−1 is the spherical measure. By mean value theorem, there exists a(y) ∈ B(x, rt) such that f(y)− f(x) = (y−x)T∇f(x) + (a(y)−x)THf (a(y))(a(y)−x), where a(y) depends on y. Therefore,∣∣∣∣∣ ∫ y∈Sd−1(x,rt) (f(y)− f(x))dσd−1(y)\n∣∣∣∣∣ =\n∣∣∣∣∣∣∣∣∣ ∫ y∈Sd−1(x,rt) (y − x)T∇f(x)dσd−1(y)︸ ︷︷ ︸ =0 + ∫ y∈Sd−1(x,rt) (a(y)− x)THf (a(y))(a(y)− x)dσd−1(y) ∣∣∣∣∣∣∣∣∣ ≤ ( sup\na∈B(x,rt) ‖Hf (a)‖ ‖a− x‖2\n) σd−1(Sd−1(x, rt))\n≤ dcdrd+1t\n( sup\na∈B(x,rt) ‖Hf (a)‖\n) (35)\nSince there exists a ball B(x, ε) such that ‖Hf (a)‖ = O(1) for all a ∈ B(x, ε). Therefore, for sufficiently small t such that rt < ε, we have:\n∣∣∣ f̃(t)− 1 ∣∣∣ ≤ dcdrd+1t ( supa∈B(x,rt) ‖Hf (a)‖ )\nf(x)dcdr d−1 t\n= r2t\n( supa∈B(x,rt) ‖Hf (a)‖ ) f(x) . (36)\nRecall that rt = (t/(cdf(x)))1/d, so there exists L > 0 such that |f̃(t) − 1| ≤ Lt2/d for sufficiently small t. Hence, | log f̃(t)| ≤ L′t2/d for some L′ > 0 and sufficiently small t. So f̃ satisfies the condition in Lemma. 9.1 with δ = 2/d. Therefore, for any Bθ ⊆ Rm+ , we have:∣∣∣P{(cdnf(x))1/d‖Z‖ ∈ Bθ} − P{E ∈ Bθ} ∣∣∣\n≤ dTV  cdnf(x)‖Z‖d, (E1, E1 + E2, . . . , m∑ j=1 Ej )\n≤ C0 ( ( m\nn )2/dm1/2 +\nm\nn\n) . (37)\nTherefore, by combing (30) and (37), we have:∣∣∣∣∣P{ (cdnf(x))1/dZ ∈ B }− P {( ξ1E 1/d 1 , . . . , ξm( m∑ l=1 E`) 1/d ) ∈ B }∣∣∣∣∣ ≤ 2mnme− √ n−m/ √ n 2 + max{(1 + Cn −1 2d )m − 1, 1− (1− Cn −1 2d )m}+ C0 ( ( m\nn )\n2 dm 1 2 +\nm\nn\n) , (38)\nfor any setB ∈ Rd×m. Therefore, the total variation distance dTV((cdnf(x))1/d(Z1,i, Z2,i, . . . , Zm,i), (ξ1E1/d1 , ξ2(E1+ E2) 1/d, . . . , ξm( ∑m `=1E`)\n1/d )) is bounded by the RHS quantity. By taking m = O(log n), the RHS converges to 0 as n goes to infinity. Therefore, we have the desired statement."
    }, {
      "heading" : "10 Proof of Theorem 1",
      "text" : "We first compute the asymptotic bias. We define new notations to represent the estimate as\nĤ (n) k =\n1\nn n∑ i=1 { h ( (cdnf(Xi)) 1/dZk,i, S0,i, S1,i, S2,i) ) − log f(Xi)︸ ︷︷ ︸\n≡Hi\n} ,\nwhere h : Rd × R× Rd × Rd×d → R is defined as\nh(t1, t2, t3, t4) =\nd log ‖t1‖+ d log(2π)− log cd − log t2 + 1\n2 log\n( det ( t4 t2 − t3t T 3 t22 )) + 1 2 tT3 (t4 − t3tT3 )−1t3 . (39)\nLet Hi ≡ h((cdnf(Xi))1/dZk,i, S0,i, S1,i, S2,i)) − log f(Xi). Since the terms H1, H2, . . . ,Hn are identically distributed, the expected value of Ĥ(n)k converges to\nlim n→∞ E[Ĥ(n)k ] = limn→∞E[H1] = limn→∞EX1 [ E[H1|X1] ] (40)\nTypical approach of dominated convergence theorem cannot be applied to the above limit, since analyzing E[H1|X1] for finite sample n is challenging. In order to exchange the limit with the (conditional) expectation, we assume the following Ansatz 1 to be true. As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39]. This assumption can be avoided for Renyi entropy as in the proof of consistency in [28] or for sharper results such as the convergence rate of the bias with respect to the sample size but with more assumptions as in [8, 33, 1].\nAnsatz 1. The following exchange of limit holds:\nlim n→∞\nE[H1] = EX1 [\nlim n→∞\nE[H1|X1] ] , (41)\nUnder this ansatz, perhaps surprisingly, we will show that the expectation inside converges to − log f(X1) plus some bias that is independent of the underlying distribution. Precisely, for almost every x and given X1 = x,\nE[H1|X1 = x] + log f(x) = E [ h((cdnf(x)) 1/dZk,i, S0,1, S1,i, S2,i) ]\n−→ Bk,d , (42)\nas n→∞ where Bk,d is a constant that only depends on k and d, defined in (44). This implies that\nEX1 [\nlim n→∞\nE[H1|X1] ] = EX1 [− log f(X1) +Bk,d]\n= H(X) +Bk,d . (43)\nTogether with (40), this finishes the proof of the desired claim. We are now left to prove the convergence of (42). We first give a formal definition of the bias Bk,d by replacing the sample defined quantities by a similar quantities defined from order-statistics, and use Lemma 3.1 to prove the convergence. Recall that our order-statistics is defined by two sequences of m i.i.d. random variables: i.i.d. standard exponential random variables E1, . . . , Em and i.i.d. random variables ξ1, . . . , ξm uniformly distributed over Sd−1. We define\nBk,d ≡ E h  ξk( k∑\n`=1\nE`\n)1/d , S̃\n(∞) 0 , S̃ (∞) 1 , S̃ (∞) 2  , (44) where, as we will show, S̃(∞)α is the limit of empirical quantity Sα,i defined from samples for each α ∈ {0, 1, 2}, and we know that (cdnf(x))1/dZk,i converges to ξk( ∑k `=1E`)\n1/d for almost every x from Lemma 3.1. S(∞) is defined by a convergent random sequence\nS̃(m)α ≡ m∑ j=1 ξ (α) j (\n∑j `=1E`) α/d\n( ∑k `=1E`) α/d exp\n{ − ( ∑j `=1E` ) 2/d\n2( ∑k `=1E` ) 2/d\n} , (45)\nwhere ξ(0)j = 1, ξ (1) j = ξj , ξ (2) j = ξjξ T j and S̃ (∞) α = limm→∞ S̃ (m) α . This limit exists, since S̃ (m) 0 is nondecreasing in m, and the convergence of S̃(m)1 and S̃ (m) 2 follows from Lemma 10.1. We introduce sim-\npler notations for the joint random variables: S̃(m) = (ξk( ∑k `=1E`) 1/d, S̃ (m) 0 , S̃ (m) 1 , S̃ (m) 2 ) and S̃ (∞) =\n(ξk( ∑k `=1E`) 1/d, S̃ (∞) 0 , S̃ (∞) 1 , S̃ (∞) 2 ). Considering the quantities S (n) = ((cdnf(x)) 1/dZk,i, S0,i, S1,i, S2,i) defined from samples, we show that this converges to S̃(∞). Precisely, applying triangular inequality,\ndTV(S (n), S̃(∞)) ≤ dTV(S(n), S̃(m)) + dTV(S̃(m), S̃(∞)) , (46)\nand we show that both terms converge to zero for any m = Θ(log n). Given that h is continuous and bounded, this implies that\nlim n→∞ E[H1|X1 = x] = E[ lim n→∞ h(S(n))− log f(x)|X1 = x]\n= − log f(x) + E[h(S̃(∞))] ,\nfor almost every x, proving (43). The convergence of the first term follows from Lemma 3.1. Precisely, consider the function gm : Rd×m → Rd × R× Rd × Rd×d defined as:\ngm(t1, t2, . . . , tm) =  tk, m∑ j=1 exp{− ‖tj‖ 2 2‖tk‖2 }, m∑ j=1 tj ‖tk‖ exp{− ‖tj‖ 2 2‖tk‖2 }, m∑ j=1 tjt T j ‖tk‖2 exp{− ‖tj‖ 2 2‖tk‖2 }  , (47) such that S(n) = gm ( (cdnf(x)) 1/d (Z1,i, Z2,i, . . . , Zm,i ) ) , which follows from the definition of S(n) =\n((cdnf(x)) 1/dZk,i, S0,i, S1,i, S2,i) in (10). Similarly, S̃(m) = gm ( ξ1E 1/d 1 , ξ2(E1 + E2) 1/d, . . . ξm( ∑m `=1E`) 1/d ) . Since gm is continuous, so for any set A ∈ Rd × R × Rd × Rd×d, there exists a set Ã ∈ Rd×m such that gm(Ã) = A. So for any x such that there exists ε > 0 such that f(a) > 0, ‖∇f(a)‖ = O(1) and ‖Hf (a)‖ = O(1) for any ‖a− x‖ < ε, we have:\ndTV(S (n), S̃(m))\n= sup A ∣∣∣∣∣P{gm ( (cdnf(x)) 1dZ1,i, . . . , (cdnf(x)) 1dZm,i ) ∈ A}− P{gm( ξ1E 1d1 , . . . ξm( m∑ l=1 E`) 1 d ) ∈ A} ∣∣∣∣∣ ≤ sup Ã∈Rd×m ∣∣∣∣∣P{( (cdnf(x))1/dZ1,i, . . . , (cdnf(x))1/dZm,i ) ∈ Ã}− P{( ξ1E1/d1 , . . . ξm( m∑ `=1 E`) 1/d ) ∈ Ã}\n∣∣∣∣∣ = dTV (( (cdnf(x)) 1/dZ1,i, . . . , (cdnf(x)) 1/dZm,i ) , ( ξ1E 1/d 1 , . . . ξm(\nm∑ `=1 E`) 1/d )) n→∞−→ 0 , (48)\nwhere the last inequality follows from Lemma 3.1. By the assumption that f has open support and ‖∇f‖ and ‖Hf‖ is bounded almost everywhere, this convergence holds for almost every x.\nFor the second term in (46), let T̃ (m)α = S̃ (∞) α − S̃(m)α and we claim that T̃ (m)α converges to 0 in distribution\nby the following lemma.\nLemma 10.1. Assume m→∞ as n→∞ and k ≥ 3 , then\nlim n→∞\nE‖ T̃ (m)α ‖ = 0 (49)\nfor any α ∈ {0, 1, 2}. Hence (T̃ (m)0 , T̃ (m) 1 , T̃ (m) 2 ) converges to (0, 0, 0) in distribution.\nThis implies that (S̃(m)0 , S̃ (m) 1 , S̃ (m) 2 ) converges to (S̃ (∞) 0 , S̃ (∞) 1 , S̃ (∞) 2 ) in distribution, i.e.,\ndTV(S̃ (m), S̃(∞)) n→∞−→ 0 , (50)\nCombine (48) and (50) in (46), this implies the desired claim. We next prove the upper bound on the variance, following the technique from [2, Section 7.3]. For the usage of Efron-Stein inequality, we need a second set of i.i.d. samples {X ′1, X ′2, . . . , X ′n}. For simplicity, denote Ĥ = Ĥ(n)kLNN (X) be the kLNN estimate base on original sample {X1, . . . , Xn} and Ĥ(i) be the kLNN estimate based on {X1, . . . , Xi−1, X ′i, Xi+1, . . . Xn}. Then Efron-Stein theorem states that\nVar [ Ĥ ] ≤ 2 n∑ j=1 E [( Ĥ − Ĥ(j) )2 ] . (51)\nRecall that\nĤ = 1\nn n∑ i=1 { h ( (cdnf(Xi)) 1/dZk,i, S0,i, S1,i, S2,i) ) − log f(Xi)︸ ︷︷ ︸\n≡Hi\n} ,\nwhere h : Rd × R× Rd × Rd×d → R is defined as\nh(t1, t2, t3, t4) =\nd log ‖t1‖+ d log(2π)− log cd − log t2 + 1\n2 log\n( det ( t4 t2 − t3t T 3 t22 )) + 1 2 tT3 (t4 − t3tT3 )−1t3 . (52)\nSimilarly, we can write Ĥ(j) = 1n ∑n i=1H (j) i for any j ∈ {1, . . . , n}. Therefore, the difference of Ĥ and Ĥ(j) can be bounded by:\nĤ − Ĥ(j) = 1 n n∑ i=1 ( Hi −H(j)i ) . (53)\nNotice that Hi only depends on Xi and its m nearest neighbors, so Hi −H(j)i = 0 if none of Xj and X ′j are in m nearest neighbor of Xi. If we denote Zi,j = I{Xj is in m nearest neighbor of Xi}, then Hi = H(j)i if Zi,j +Zi,j′ = 0. According to [2, Lemma 20.6], since X has a density, with probability one, ∑n i=1 Zi,j ≤ mγd,\nwhere γd is the minimal number of cones of angle π/6 that can cover Rd, which only depends on d. Similarly,∑n i=1 Zi,j′ ≤ mγd. If we denote S = {i : Zi,j + Zi,j′ > 0}, the cardinality of S satisfy |S| ≤ 2mγd. Therefore,\nwe have Ĥ − Ĥ(j) = 1n ∑ i∈S ( Hi −H(j)i ) . By Cauchy-Schwarz inequality, we have\nE [( Ĥ − Ĥ(j) )2 ] = E  1 n2 (∑ i∈S ( Hi −H(j)i ))2  ≤ E [ |S| n2 ∑ i∈S ( Hi −H(j)i )2 ]\n= |S| n2 ∑ i∈S E [( Hi −H(j)i )2 ] ≤ 2|S| n2 ∑ i∈S ( E [ H2i ] + E [ (H (j) i ) 2 ] ) . (54)\nNotice that Hi’s and H (j) i ’s are identically distributed, so we are left to compute E [ H21 ] . Conditioning\non X1 = x, similarly to (42), we have\nE [ (H1 + log f(x)) 2|X1 = x ] = E [ h2((cdnf(x)) 1/dZk,i, S0,1, S1,i, S2,i) ]\n−→ B(2)k,d , (55)\nas n→∞, where B(2)k,d ≡ E [ h2 ( ξk (∑k `=1E` )1/d , S̃ (∞) 0 , S̃ (∞) 1 , S̃ (∞) 2 )] . Therefore,\nE [ H21 |X1 = x ] = B (2) k,d − 2 log f(x)E [H1|X1 = x ]− (log f(x)) 2\n= B (2) k,d − 2 log f(x)Bk,d + (log f(x)) 2 . (56)\nTake expectation over X1, we obtain: E[H21 ] = EX1 [\nlim n→∞\nE [ H21 |X1 ] ] = EX1 [ B (2) k,d − 2 log f(X1)Bk,d + (log f(X1)) 2 ]\n= B (2) k,d + 2H(X)Bk,d +\n∫ f(x)(log f(x))2dx < +∞ , (57)\nwhere the last inequality comes from the assumption that ∫ f(x)(log f(x))2dx < +∞. Combining with (51) and (54), we have\nVar [ Ĥ ] ≤ 2 n∑ j=1 E [( Ĥ − Ĥ(j) )2 ] ≤ 4|S| n ∑ i∈S ( E [ H2i ] + E [ (H (j) i ) 2 ] ) ≤ 8|S| 2C2 n ≤ 32m 2γ2dC2 n , (58)\nwhere C2 is the upper bound for E[H21 ]. Take m = O(log n) then the proof is complete."
    }, {
      "heading" : "10.1 Proof of Lemma 10.1",
      "text" : "Firstly, since |ξi| = 1, we can upper bound the expectation of E‖ T̃ (m)α,i ‖ by:\nE‖ T̃ (m)α,i ‖ = E ∥∥∥ ∞∑ j=m+1 ξ (α) j ( ∑j `=1E`) α/d ( ∑k `=1E`) α/d exp{− ( ∑j `=1E` ) 2/d 2( ∑k `=1E` ) 2/d } ∥∥∥\n≤ ∞∑\nj=m+1\nE ∥∥∥ ξ(α)j (∑j`=1E`)α/d\n( ∑k `=1E`) α/d exp{−\n( ∑j `=1E` ) 2/d\n2( ∑k `=1E` )\n2/d } ∥∥∥\n= ∞∑ j=m+1 E ∣∣∣ (∑j`=1E`)α/d ( ∑k `=1E` ) α/d exp{− ( ∑j `=1E` ) 2/d 2( ∑k `=1E` ) 2/d } ∣∣∣ . (59)\nNotice that the expression is a function of ( ∑j `=1E`/ ∑k `=1E`)\n1/d ≡ Rj for j > m, we will identify the distribution of Rj first. For any fixed j ≥ k, let Tk = ∑k `=1E` and Tj−k = ∑j `=k+1E`, such that Rj = ((Tk +Tj−k)/Tk) 1/d. Notice that Tk is the summation of k i.i.d. standard exponential random variables, so Tk ∼ Erlang (k, 1). Similarly, Tj−k ∼ Erlang (j − k, 1). Also Tk and Tj−k are independent. Recall that the pdf of Erlang (k, λ) is given by fk,λ(x) = λkxk−1e−λx/(k − 1)! for x ≥ 0. Therefore, the CDF of Rj is\ngiven by:\nFRj (t) = P{Rj ≤ t} = P{( Tk + Tj−k Tk )1/d ≤ t} = P{Tj−k Tk ≤ td − 1}\n= ∫ x≥0 xk−1e−x (k − 1)! (∫ (td−1)x y=0 yj−k−1e−y (j − k − 1)! dy ) dx\n= ∫ x≥0 xk−1e−x (k − 1)! ( 1− j−k−1∑ `=0 1 `! x`(td − 1)`e−x(t d−1) ) dx\n= 1− j−k−1∑ `=0 (∫ x≥0 xk−1e−x (k − 1)! 1 `! x`(td − 1)`e−x(t d−1)dx )\n= 1− j−k−1∑ `=0 ( (td − 1)` (k − 1)!`! ∫ x≥0 xk−1+`e−xt d dx )\n= 1− j−k−1∑ `=0 (td − 1)` (k − 1)!`! (k − 1 + `)! t−d(k−1+`)\n= 1− j−k−1∑ `=0 ( k − 1 + ` ` ) t−d(k−1)(1− t−d)` , (60)\nfor t ∈ [1,+∞). Given the CDF of Rj , each term in (66) is upper bounded by:\nE ∣∣∣ (∑j`=1E`)α/d\n( ∑k `=1E` ) α/d exp{−\n( ∑j `=1E` ) 2/d\n2( ∑k `=1E` )\n2/d } ∣∣∣ = ERj ∣∣∣ tαe−t2 ∣∣∣ ≤ ERj [ t2e−t2 ]\n= ∫ ∞ t=1 t2e−t 2 dFRj (t) = t 2e−t 2 FRj (t) ∣∣∣∞ 1 − ∫ ∞ t=1 FRj (t)d(t 2e−t 2 )\n= − ∫ ∞ t=1 (2te−t 2 − 2t3e−t 2 )FRj (t)dt = ∫ ∞ t=1 2t(t2 − 1)e−t 2 FRj (t)dt . (61)\nTherefore, in order to establish an upper bound for (66), we need an upper bound for FRj (t). Here we will consider two cases depending on t. If t > (j/2k)1/d, we just use the trivial upper bound FRj (t) < 1. If 1 ≤ t ≤ (j/2k)1/d, since td ≥ 1, we have:\nFRj (t) = 1− j−k−1∑ `=0 ( k − 1 + ` ` ) t−d(k−1)(1− t−d)` ≤ 1− j−k−1∑ `=0 ( k − 1 + ` ` ) t−dk(1− t−d)` . (62)\nNotice that ( k−1+` ` ) t−dk(1− t−d)` is the pmf of negative binomial distribution NB(k, 1− t−d). Therefore, FRj (t) ≤ P{X ≥ j − k}, where X ∼ NB(k, 1 − t−d). The mean and variance of X are given by E[X] = (1− t−d)k/(1− (1− t−d)) = (td − 1)k and Var(X) = (1− t−d)k/(1− (1− t−d))2 = (t2d − td)k. Therefore, by Chebyshev inequality, the tail probability is upper bounded by:\nP{X ≥ j − k} ≤ Var(X) (j − k − E[X])2 = (t2d − td)k (j − k − (td − 1)k)2 = (t2d − td)k (j − tdk)2 ≤ 4t2dk/j2 , (63)\nhere we use the fact that t ≤ (j/2k)1/d so j − tdk > j/2. Therefore, FRj (t) ≤ 4t2dk/j2 for t > (j/2k)1/d. Combine the two cases and plug into (61), we obtain:\nE ∣∣∣ (∑j`=1E`)α/d\n( ∑k `=1E` ) α/d exp{−\n( ∑j `=1E` ) 2/d\n2( ∑k `=1E` )\n2/d } ∣∣∣ = ∫ ∞\nt=1\n2t(t2 − 1)e−t 2\nFRj (t)dt\n≤ ∫ (j/2k)1/d t=1 2t(t2 − 1)e−t 2 4t2dk j2 dt+ ∫ ∞ (j/2k)1/d 2t(t2 − 1)e−t 2 dt\n≤ 8k j2 ∫ ∞ t=1 t2d+3e−t 2 dt+ 2 ∫ ∞ (j/2k)1/d t3e−t 2 dt\n≤ 8kCd j2 + 2\n( −1\n2 e−t\n2 (t2 + 1) ∣∣∣∞ (j/2k)1/d ) =\n8kCd j2 + e−(j/2k) 2/d (( j 2k )2/d + 1) , (64)\nwhere Cd = ∫∞ t=1 t2d+3e−t 2 dt is a constant only depend on d. Therefore, we can see that\nE ∣∣∣ (∑j`=1E`)α/d\n( ∑k `=1E` ) α/d exp{−\n( ∑j `=1E` ) 2/d\n2( ∑k `=1E` )\n2/d } ∣∣∣ = O(1/j2). (65)\nSo\nE‖ T̃ (m)α,i ‖ ≤ ∞∑\nj=m+1\nE ∣∣∣ (∑j`=1E`)α/d\n( ∑k `=1E` ) α/d exp{−\n( ∑j `=1E` ) 2/d\n2( ∑k `=1E` )\n2/d } ∣∣∣→ 0 . (66)\ngiven m→∞ as n→∞."
    }, {
      "heading" : "11 Proof of Theorem 2",
      "text" : "The proposed estimator is a solution to a maximization problem â = arg maxa LXi(fa,Xi). From [21] we know that the maximizer is a fixed point of a series of non-linear equations of the form∑\nj 6=i\n(Xj −Xi)⊗α ραk,i K (Xj −Xi ρk,i ) = nρdk,i e a0 ∫ (u−Xi)⊗α ραk,i K (u−Xi ρk,i ) e〈u−x,a1〉+···+ap[(u−x),··· ,(u−x)] 1 ρdk,i du\nfor all α ∈ [p] where the superscript ⊗α indicates the α-th order tensor product. From the proof of Theorem 1, specifically (48) and (50), we know that the left-hand side converges to a value that only depends on k, d and K. Let’s denote it by Sα(k) ∈ Rd α\n. We make a change of variables ã0 = a0 + d log ρk,i + log n and ãα = aα/ρ α k,i for α 6= 0. Then, in the limit of growing n, the above equations can be rewritten as\nSα(k, d,K) = e ã0Fα(d,K, ã1, . . . , ãp) , (67)\nfor some function Fα. Notice that the dependence on the underlying distribution vanishes in the limit, and the fixed point ã only depends on k, p, d, and K. The desired claim follows from the fact that the estimate is limn→∞ f̂n(Xi) = limn→∞ eâ0 = limn→∞Ak,d,p,K/(nρdk,i) = f(Xi)Ak,d,p,KCd limn 1/(Cdnρ d k,if(Xi)) =\nf(Xi)Ak,d,p,KCd/ ∑k `=1E`, and plugging in the entropy estimator Ĥ(X)→ EXi [− log f(Xi)] +Bk,d,p,K .\nIn the case of the KL estimator, it happens that S0 = k and F0(d) = Cd such that eã0 = k/Cd, eâ0 = f(Xi)k/(Cdρ d k,if(Xi)n) and Bk,d,p,K = − log k + E[log( ∑k `=1E`)] = − log k + φ(k)."
    }, {
      "heading" : "Acknowledgement",
      "text" : "This work is supported by NSF SaTC award CNS-1527754, NSF CISE award CCF-1553452, NSF CISE award CCF-1617745. We thank the anonymous reviewers for their constructive feedback."
    } ],
    "references" : [ {
      "title" : "Efficient multivariate entropy estimation via k-nearest neighbour distances",
      "author" : [ "T.B. Berrett", "R.J. Samworth", "M. Yuan" ],
      "venue" : "arXiv preprint arXiv:1606.00304",
      "citeRegEx" : "1",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Lectures on the Nearest Neighbor Method",
      "author" : [ "G. Biau", "L. Devroye" ],
      "venue" : "Springer",
      "citeRegEx" : "2",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Sums of functions of nearest neighbor distances",
      "author" : [ "P.J. Bickel", "L. Breiman" ],
      "venue" : "moment bounds, limit theorems and a goodness of fit test. The Annals of Probability, pages 185–214",
      "citeRegEx" : "3",
      "shortCiteRegEx" : null,
      "year" : 1983
    }, {
      "title" : "On the kozachenko–leonenko entropy estimator, 2016",
      "author" : [ "S. Delattre", "N. Fournier" ],
      "venue" : null,
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2016
    }, {
      "title" : "On entropy estimation by m-spacing method",
      "author" : [ "F. El Haje Hussein", "Y. Golubev" ],
      "venue" : "Journal of Mathematical Sciences,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2009
    }, {
      "title" : "Efficient estimation of mutual information for strongly dependent variables",
      "author" : [ "S. Gao", "G. Ver Steeg", "A. Galstyan" ],
      "venue" : "International Conference on Artificial Intelligence and Statistics (AISTATS)",
      "citeRegEx" : "6",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Estimating mutual information by local gaussian approximation",
      "author" : [ "S. Gao", "G. Ver Steeg", "A. Galstyan" ],
      "venue" : "31st Conference on Uncertainty in Artificial Intelligence (UAI)",
      "citeRegEx" : "7",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Demystifying fixed k-nearest neighbor information estimators",
      "author" : [ "W. Gao", "S. Oh", "P. Viswanath" ],
      "venue" : "arXiv preprint arXiv:1604.03006",
      "citeRegEx" : "8",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "A new class of random vector entropy estimators and its applications in testing statistical hypotheses",
      "author" : [ "M.N. Goria", "N.N. Leonenko", "V.V. Mergel", "P.L. Novi Inverardi" ],
      "venue" : "Nonparametric Statistics, 17(3):277–297",
      "citeRegEx" : "9",
      "shortCiteRegEx" : null,
      "year" : 2005
    }, {
      "title" : "Limit theorems for sums of general functions of m-spacings",
      "author" : [ "P. Hall" ],
      "venue" : "Mathematical Proceedings of the Cambridge Philosophical Society, volume 96, pages 517–532. Cambridge Univ Press",
      "citeRegEx" : "10",
      "shortCiteRegEx" : null,
      "year" : 1984
    }, {
      "title" : "On powerful distributional tests based on sample spacings",
      "author" : [ "P. Hall" ],
      "venue" : "Journal of Multivariate Analysis, 19(2):201–224",
      "citeRegEx" : "11",
      "shortCiteRegEx" : null,
      "year" : 1986
    }, {
      "title" : "Locally parametric nonparametric density estimation",
      "author" : [ "N. Hjort", "M. Jones" ],
      "venue" : "The Annals of Statistics, pages 1619–1647",
      "citeRegEx" : "12",
      "shortCiteRegEx" : null,
      "year" : 1996
    }, {
      "title" : "Estimation of entropy and other functionals of a multivariate density",
      "author" : [ "H. Joe" ],
      "venue" : "Annals of the Institute of Statistical Mathematics, 41(4):683–697",
      "citeRegEx" : "13",
      "shortCiteRegEx" : null,
      "year" : 1989
    }, {
      "title" : "Nonparametric von mises estimators for entropies",
      "author" : [ "K. Kandasamy", "A. Krishnamurthy", "B. Poczos", "L. Wasserman" ],
      "venue" : "divergences and mutual informations. In NIPS, pages 397–405",
      "citeRegEx" : "14",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Sample estimate of the entropy of a random vector",
      "author" : [ "L.F. Kozachenko", "N.N. Leonenko" ],
      "venue" : "Problemy Peredachi Informatsii, 23(2):9–16",
      "citeRegEx" : "15",
      "shortCiteRegEx" : null,
      "year" : 1987
    }, {
      "title" : "Estimating mutual information",
      "author" : [ "A. Kraskov", "H. Stögbauer", "P. Grassberger" ],
      "venue" : "Physical review E, 69(6):066138",
      "citeRegEx" : "16",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "Conditional density-based analysis of t cell signaling in single-cell data",
      "author" : [ "S. Krishnaswamy", "M. Spitzer", "M. Mingueneau", "S. Bendall", "O. Litvin", "E. Stone", "D. Peer", "G. Nolan" ],
      "venue" : "Science, 346:1250689",
      "citeRegEx" : "17",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "A class of rényi information estimators for multidimensional densities",
      "author" : [ "N. Leonenko", "L. Pronzato", "V. Savani" ],
      "venue" : "The Annals of Statistics, 36(5):2153–2182",
      "citeRegEx" : "18",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "Exponential concentration for mutual information estimation with application to forests",
      "author" : [ "H. Liu", "L. Wasserman", "J.D. Lafferty" ],
      "venue" : "NIPS, pages 2537–2545",
      "citeRegEx" : "19",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Local regression and likelihood",
      "author" : [ "C. Loader" ],
      "venue" : "Springer Science & Business Media",
      "citeRegEx" : "20",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "Local likelihood density estimation",
      "author" : [ "C.R. Loader" ],
      "venue" : "The Annals of Statistics, 24(4):1602–1618",
      "citeRegEx" : "21",
      "shortCiteRegEx" : null,
      "year" : 1996
    }, {
      "title" : "Nonparametric k-nearest-neighbor entropy estimator",
      "author" : [ "D. Lombardi", "S. Pant" ],
      "venue" : "Physical Review E, 93(1):013310",
      "citeRegEx" : "22",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Introduction to information retrieval",
      "author" : [ "C.D. Manning", "P. Raghavan", "H. Schütze" ],
      "venue" : "volume 1. Cambridge university press Cambridge",
      "citeRegEx" : "23",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "kn-nearest neighbor estimators of entropy",
      "author" : [ "R.M. Mnatsakanov", "N. Misra", "S. Li", "E.J. Harner" ],
      "venue" : "Mathematical Methods of Statistics, 17(3):261–277",
      "citeRegEx" : "24",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "Ensemble estimation of multivariate f-divergence",
      "author" : [ "K.R. Moon", "A.O. Hero" ],
      "venue" : "2014 IEEE International Symposium on Information Theory, pages 356–360. IEEE",
      "citeRegEx" : "25",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Nonparametric ensemble estimation of distributional functionals",
      "author" : [ "K.R. Moon", "K. Sricharan", "K. Greenewald", "A.O. Hero III" ],
      "venue" : "arXiv preprint arXiv:1601.06884",
      "citeRegEx" : "26",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Submanifold density estimation",
      "author" : [ "A. Ozakin", "A.G. Gray" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 1375–1382",
      "citeRegEx" : "27",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "Estimation of rényi entropy and mutual information based on generalized nearest-neighbor graphs",
      "author" : [ "D. Pál", "B. Póczos", "C. Szepesvári" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 1849–1857",
      "citeRegEx" : "28",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "Approximate distributions of order statistics: with applications to nonparametric statistics",
      "author" : [ "R-D Reiss" ],
      "venue" : "Springer Science & Business Media",
      "citeRegEx" : "29",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Detecting novel associations in large data sets",
      "author" : [ "D. Reshef", "Y. Reshef", "H. Finucane", "S. Grossman", "G. McVean", "P. Turnbaugh", "E. Lander", "M. Mitzenmacher", "P. Sabeti" ],
      "venue" : "science, 334(6062):1518–1524",
      "citeRegEx" : "30",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Density estimation",
      "author" : [ "S.J. Sheather" ],
      "venue" : "Statistical Science, 19(4):588–597",
      "citeRegEx" : "31",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "Nearest neighbor estimates of entropy",
      "author" : [ "H. Singh", "N. Misra", "V. Hnizdo", "A. Fedorowicz", "E. Demchuk" ],
      "venue" : "American journal of mathematical and management sciences, 23(3-4):301–321",
      "citeRegEx" : "32",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Analysis of k-nearest neighbor distances with application to entropy estimation",
      "author" : [ "S. Singh", "B. Póczos" ],
      "venue" : "arXiv preprint arXiv:1603.08578",
      "citeRegEx" : "33",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Ensemble estimators for multivariate entropy estimation",
      "author" : [ "K. Sricharan", "D. Wei", "A.O. Hero" ],
      "venue" : "IEEE Transactions on Information Theory, 59(7):4374–4388",
      "citeRegEx" : "34",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "The information sieve",
      "author" : [ "G. Ver Steeg", "A. Galstyan" ],
      "venue" : "to appear in ICML, arXiv:1507.02284",
      "citeRegEx" : "35",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Root-n consistent estimators of entropy for densities with unbounded support",
      "author" : [ "A.B. Tsybakov", "E.C. Van der Meulen" ],
      "venue" : "Scandinavian Journal of Statistics,",
      "citeRegEx" : "36",
      "shortCiteRegEx" : "36",
      "year" : 1996
    }, {
      "title" : "Discovering structure in high-dimensional data through correlation explanation",
      "author" : [ "G. Ver Steeg", "A. Galstyan" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 577–585",
      "citeRegEx" : "37",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Locally weighted full covariance gaussian density estimation",
      "author" : [ "P. Vincent", "Y. Bengio" ],
      "venue" : "Technical report, Technical report 1240",
      "citeRegEx" : "38",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Divergence estimation for multidimensional densities via-nearest-neighbor distances",
      "author" : [ "Q. Wang", "S.R. Kulkarni", "S. Verdú" ],
      "venue" : "Information Theory, IEEE Transactions on, 55(5):2392–2405",
      "citeRegEx" : "39",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "Universal estimation of information measures for analog sources",
      "author" : [ "Q. Wang", "S.R. Kulkarni", "S. Verdú" ],
      "venue" : "Foundations and Trends in Communications and Information Theory, 5(3):265–353",
      "citeRegEx" : "40",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "All of nonparametric statistics",
      "author" : [ "L. Wasserman" ],
      "venue" : "Springer Science & Business Media",
      "citeRegEx" : "41",
      "shortCiteRegEx" : null,
      "year" : 2006
    } ],
    "referenceMentions" : [ {
      "referenceID" : 16,
      "context" : "Such an approach is evident in many applications, as varied as computational biology [17], sociology [30] and information retrieval [23], with the citations representing a mere smattering of recent works.",
      "startOffset" : 85,
      "endOffset" : 89
    }, {
      "referenceID" : 29,
      "context" : "Such an approach is evident in many applications, as varied as computational biology [17], sociology [30] and information retrieval [23], with the citations representing a mere smattering of recent works.",
      "startOffset" : 101,
      "endOffset" : 105
    }, {
      "referenceID" : 22,
      "context" : "Such an approach is evident in many applications, as varied as computational biology [17], sociology [30] and information retrieval [23], with the citations representing a mere smattering of recent works.",
      "startOffset" : 132,
      "endOffset" : 136
    }, {
      "referenceID" : 36,
      "context" : "Within mainstream machine learning, a systematic effort at unsupervised clustering and hierarchical information extraction is conducted in recent works of [37, 35].",
      "startOffset" : 155,
      "endOffset" : 163
    }, {
      "referenceID" : 34,
      "context" : "Within mainstream machine learning, a systematic effort at unsupervised clustering and hierarchical information extraction is conducted in recent works of [37, 35].",
      "startOffset" : 155,
      "endOffset" : 163
    }, {
      "referenceID" : 39,
      "context" : "While these estimation questions have been studied in the past three decades (and summarized in [40]), the renewed importance of estimating information theoretic measures in a sample-efficient manner is persuasively argued in a recent work [6], where the authors note that existing estimators perform poorly in several key scenarios of central interest (especially when the high dimensional random variables are strongly related to each other).",
      "startOffset" : 96,
      "endOffset" : 100
    }, {
      "referenceID" : 5,
      "context" : "While these estimation questions have been studied in the past three decades (and summarized in [40]), the renewed importance of estimating information theoretic measures in a sample-efficient manner is persuasively argued in a recent work [6], where the authors note that existing estimators perform poorly in several key scenarios of central interest (especially when the high dimensional random variables are strongly related to each other).",
      "startOffset" : 240,
      "endOffset" : 243
    }, {
      "referenceID" : 15,
      "context" : "The widely used estimator of mutual information is the one by Kraskov and Stögbauer and Grassberger [16] and christened the KSG estimator (nomenclature based on the authors, cf.",
      "startOffset" : 100,
      "endOffset" : 104
    }, {
      "referenceID" : 5,
      "context" : "[6]) – while this estimator works well in practice (and performs much better than other approaches such as those based on kernel density estimation procedures), it ∗Coordinated Science Lab and Department of Electrical and Computer Engineering †Coordinated Science Lab and Department of Industrial and Enterprise Systems Engineering",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 14,
      "context" : "The basic issue is that the KSG estimator (and the underlying differential entropy estimator based on nearest neighbor distances by Kozachenko and Leonenko (KL) [15]) does not take advantage of the fact that the samples could lie in a smaller dimensional subspace (more generally, manifold) despite the high dimensionality of the data itself.",
      "startOffset" : 161,
      "endOffset" : 165
    }, {
      "referenceID" : 6,
      "context" : "Ameliorating this deficiency is the central theme of recent works [7, 6, 22], each of which aims to improve upon the classical KL (differential) entropy estimator of [15].",
      "startOffset" : 66,
      "endOffset" : 76
    }, {
      "referenceID" : 5,
      "context" : "Ameliorating this deficiency is the central theme of recent works [7, 6, 22], each of which aims to improve upon the classical KL (differential) entropy estimator of [15].",
      "startOffset" : 66,
      "endOffset" : 76
    }, {
      "referenceID" : 21,
      "context" : "Ameliorating this deficiency is the central theme of recent works [7, 6, 22], each of which aims to improve upon the classical KL (differential) entropy estimator of [15].",
      "startOffset" : 66,
      "endOffset" : 76
    }, {
      "referenceID" : 14,
      "context" : "Ameliorating this deficiency is the central theme of recent works [7, 6, 22], each of which aims to improve upon the classical KL (differential) entropy estimator of [15].",
      "startOffset" : 166,
      "endOffset" : 170
    }, {
      "referenceID" : 5,
      "context" : "A local SVD is used to heuristically improve the density estimate at each sample point in [6], while a local Gaussian density (with empirical mean and covariance weighted by NN distances) is heuristically used for the same purpose in [22].",
      "startOffset" : 90,
      "endOffset" : 93
    }, {
      "referenceID" : 21,
      "context" : "A local SVD is used to heuristically improve the density estimate at each sample point in [6], while a local Gaussian density (with empirical mean and covariance weighted by NN distances) is heuristically used for the same purpose in [22].",
      "startOffset" : 234,
      "endOffset" : 238
    }, {
      "referenceID" : 6,
      "context" : "An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics.",
      "startOffset" : 53,
      "endOffset" : 56
    }, {
      "referenceID" : 5,
      "context" : "An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics.",
      "startOffset" : 112,
      "endOffset" : 119
    }, {
      "referenceID" : 21,
      "context" : "An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics.",
      "startOffset" : 112,
      "endOffset" : 119
    }, {
      "referenceID" : 11,
      "context" : "An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics.",
      "startOffset" : 175,
      "endOffset" : 183
    }, {
      "referenceID" : 20,
      "context" : "An effort towards a systematic study is initiated in [7] which connects the aforementioned heuristic efforts of [6, 22] to the local log-likelihood density estimation methods [12, 21] from theoretical statistics.",
      "startOffset" : 175,
      "endOffset" : 183
    }, {
      "referenceID" : 20,
      "context" : "Equation (9) of [21]).",
      "startOffset" : 16,
      "endOffset" : 20
    }, {
      "referenceID" : 6,
      "context" : "Indeed, such an elaborate numerical effort is one of the key impediments for the entropy estimator of [7] to be practically valuable.",
      "startOffset" : 102,
      "endOffset" : 105
    }, {
      "referenceID" : 40,
      "context" : "samples is missing in the theoretical statistics literature (despite local log-likelihood methods for regression and density estimation being standard textbook fare [41, 20]).",
      "startOffset" : 165,
      "endOffset" : 173
    }, {
      "referenceID" : 19,
      "context" : "samples is missing in the theoretical statistics literature (despite local log-likelihood methods for regression and density estimation being standard textbook fare [41, 20]).",
      "startOffset" : 165,
      "endOffset" : 173
    }, {
      "referenceID" : 15,
      "context" : "This effort allows us to connect disparate threads of ideas from seemingly different arenas: NN methods, local log-likelihood methods, asymptotic order statistics and sample-dependent heuristic, but inspired, methods for mutual information estimation suggested in the work of [16].",
      "startOffset" : 276,
      "endOffset" : 280
    }, {
      "referenceID" : 6,
      "context" : "2], significantly improves the computational efficiency upon similar endeavors in the recent efforts of [7, 22, 38].",
      "startOffset" : 104,
      "endOffset" : 115
    }, {
      "referenceID" : 21,
      "context" : "2], significantly improves the computational efficiency upon similar endeavors in the recent efforts of [7, 22, 38].",
      "startOffset" : 104,
      "endOffset" : 115
    }, {
      "referenceID" : 37,
      "context" : "2], significantly improves the computational efficiency upon similar endeavors in the recent efforts of [7, 22, 38].",
      "startOffset" : 104,
      "endOffset" : 115
    }, {
      "referenceID" : 28,
      "context" : "Since the bandwidth is data dependent and vanishes too fast (because k is fixed), the estimator has a bias, which we derive a closed form expression for and show that it is independent of the underlying distribution and hence can be easily corrected: this is our main theoretical contribution, and involves new theorems on asymptotic statistics of nearest neighbors generalizing classical work in probability theory [29], which might be of independent mathematical interest.",
      "startOffset" : 416,
      "endOffset" : 420
    }, {
      "referenceID" : 5,
      "context" : "Generalized view: We show that seemingly very different approaches to entropy estimation – recent works of [6, 7, 22] and the classical work of fixed k-NN estimator of Kozachenko and Leonenko [15] – can all be cast in the local log-likelihood framework as specific kernel and sample dependent bandwidth choices.",
      "startOffset" : 107,
      "endOffset" : 117
    }, {
      "referenceID" : 6,
      "context" : "Generalized view: We show that seemingly very different approaches to entropy estimation – recent works of [6, 7, 22] and the classical work of fixed k-NN estimator of Kozachenko and Leonenko [15] – can all be cast in the local log-likelihood framework as specific kernel and sample dependent bandwidth choices.",
      "startOffset" : 107,
      "endOffset" : 117
    }, {
      "referenceID" : 21,
      "context" : "Generalized view: We show that seemingly very different approaches to entropy estimation – recent works of [6, 7, 22] and the classical work of fixed k-NN estimator of Kozachenko and Leonenko [15] – can all be cast in the local log-likelihood framework as specific kernel and sample dependent bandwidth choices.",
      "startOffset" : 107,
      "endOffset" : 117
    }, {
      "referenceID" : 14,
      "context" : "Generalized view: We show that seemingly very different approaches to entropy estimation – recent works of [6, 7, 22] and the classical work of fixed k-NN estimator of Kozachenko and Leonenko [15] – can all be cast in the local log-likelihood framework as specific kernel and sample dependent bandwidth choices.",
      "startOffset" : 192,
      "endOffset" : 196
    }, {
      "referenceID" : 14,
      "context" : "Thus our work is a strict mathematical generalization of the classical work of [15].",
      "startOffset" : 79,
      "endOffset" : 83
    }, {
      "referenceID" : 15,
      "context" : "Mutual Information estimation: The inspired work of [16] constructs a mutual information estimator that subtly altered (in a sample dependent way) the three KL entropy estimation terms, leading to superior empirical performance.",
      "startOffset" : 52,
      "endOffset" : 56
    }, {
      "referenceID" : 20,
      "context" : "Local likelihood density estimators [21, 12] constitute state of the art and are specified by a weight function K : R → R (also called a kernel), a degree p ∈ Z of the polynomial approximation, and the bandwidth h ∈ R, and maximizes the local log-likelihood: Lx(f) = n ∑",
      "startOffset" : 36,
      "endOffset" : 44
    }, {
      "referenceID" : 11,
      "context" : "Local likelihood density estimators [21, 12] constitute state of the art and are specified by a weight function K : R → R (also called a kernel), a degree p ∈ Z of the polynomial approximation, and the bandwidth h ∈ R, and maximizes the local log-likelihood: Lx(f) = n ∑",
      "startOffset" : 36,
      "endOffset" : 44
    }, {
      "referenceID" : 20,
      "context" : "Concretely, for p = 0, it is known that LDDE reduces to the standard Kernel Density Estimator (KDE) [21]:",
      "startOffset" : 100,
      "endOffset" : 104
    }, {
      "referenceID" : 21,
      "context" : "Somewhat surprisingly, this result has eluded prior works [22, 38] and [7] which specifically attempted the evaluation for p = 2.",
      "startOffset" : 58,
      "endOffset" : 66
    }, {
      "referenceID" : 37,
      "context" : "Somewhat surprisingly, this result has eluded prior works [22, 38] and [7] which specifically attempted the evaluation for p = 2.",
      "startOffset" : 58,
      "endOffset" : 66
    }, {
      "referenceID" : 6,
      "context" : "Somewhat surprisingly, this result has eluded prior works [22, 38] and [7] which specifically attempted the evaluation for p = 2.",
      "startOffset" : 71,
      "endOffset" : 74
    }, {
      "referenceID" : 11,
      "context" : "LLDE provides a principled approach to automatically correct for the boundary bias, which takes effect only for p ≥ 2 [12, 31].",
      "startOffset" : 118,
      "endOffset" : 126
    }, {
      "referenceID" : 30,
      "context" : "LLDE provides a principled approach to automatically correct for the boundary bias, which takes effect only for p ≥ 2 [12, 31].",
      "startOffset" : 118,
      "endOffset" : 126
    }, {
      "referenceID" : 27,
      "context" : "As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made.",
      "startOffset" : 12,
      "endOffset" : 16
    }, {
      "referenceID" : 14,
      "context" : "As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made.",
      "startOffset" : 190,
      "endOffset" : 205
    }, {
      "referenceID" : 8,
      "context" : "As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made.",
      "startOffset" : 190,
      "endOffset" : 205
    }, {
      "referenceID" : 17,
      "context" : "As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made.",
      "startOffset" : 190,
      "endOffset" : 205
    }, {
      "referenceID" : 38,
      "context" : "As noted in [28], such an assumption is common in the literature on consistency of k-NN estimators, where it has been implicitly assumed in existing analyses of entropy estimators including [15, 9, 18, 39], without explicitly stating that such assumptions are being made.",
      "startOffset" : 190,
      "endOffset" : 205
    }, {
      "referenceID" : 5,
      "context" : "Naturally, all the techniques we develop in this paper generalize to any estimators that depend on the nearest neighbor statistics {Z`,i}i,`∈[n] – and the value of such a general result is demonstrated later (in Section 4) when we evaluate the bias in similarly inspired entropy estimators [6, 7, 22, 15].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 6,
      "context" : "Naturally, all the techniques we develop in this paper generalize to any estimators that depend on the nearest neighbor statistics {Z`,i}i,`∈[n] – and the value of such a general result is demonstrated later (in Section 4) when we evaluate the bias in similarly inspired entropy estimators [6, 7, 22, 15].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 21,
      "context" : "Naturally, all the techniques we develop in this paper generalize to any estimators that depend on the nearest neighbor statistics {Z`,i}i,`∈[n] – and the value of such a general result is demonstrated later (in Section 4) when we evaluate the bias in similarly inspired entropy estimators [6, 7, 22, 15].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 14,
      "context" : "Naturally, all the techniques we develop in this paper generalize to any estimators that depend on the nearest neighbor statistics {Z`,i}i,`∈[n] – and the value of such a general result is demonstrated later (in Section 4) when we evaluate the bias in similarly inspired entropy estimators [6, 7, 22, 15].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 14,
      "context" : "The idea of using k-NN distance as bandwidth for entropy estimation was originally proposed by Kozachenko and Leonenko in [15], and is a special case of the k-LNN method we propose with degree 0 and a step kernel.",
      "startOffset" : 122,
      "endOffset" : 126
    }, {
      "referenceID" : 12,
      "context" : "Another popular resubstitution entropy estimator is to use KDE in (3) [13], which is a special case of the k-LNN method with degree 0, and the Gaussian kernel is used in simulations.",
      "startOffset" : 70,
      "endOffset" : 74
    }, {
      "referenceID" : 13,
      "context" : "As comparison, we also study a new estimator [14] based on von Mises expansion (as opposed to simple re-substitution) which has an improved convergence rate in the large sample regime.",
      "startOffset" : 45,
      "endOffset" : 49
    }, {
      "referenceID" : 14,
      "context" : "4 Universality of the k-LNN approach In this section, we show that Theorem 1 holds universally for a general family of entropy estimators, specified by the choice of k ∈ Z, degree p ∈ Z, and a kernel K : R → R, thus allowing a unified view of several seemingly disparate entropy estimators [15, 6, 7, 22].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 5,
      "context" : "4 Universality of the k-LNN approach In this section, we show that Theorem 1 holds universally for a general family of entropy estimators, specified by the choice of k ∈ Z, degree p ∈ Z, and a kernel K : R → R, thus allowing a unified view of several seemingly disparate entropy estimators [15, 6, 7, 22].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 6,
      "context" : "4 Universality of the k-LNN approach In this section, we show that Theorem 1 holds universally for a general family of entropy estimators, specified by the choice of k ∈ Z, degree p ∈ Z, and a kernel K : R → R, thus allowing a unified view of several seemingly disparate entropy estimators [15, 6, 7, 22].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 21,
      "context" : "4 Universality of the k-LNN approach In this section, we show that Theorem 1 holds universally for a general family of entropy estimators, specified by the choice of k ∈ Z, degree p ∈ Z, and a kernel K : R → R, thus allowing a unified view of several seemingly disparate entropy estimators [15, 6, 7, 22].",
      "startOffset" : 290,
      "endOffset" : 304
    }, {
      "referenceID" : 14,
      "context" : "[15] showed (in a remarkable result at the time) that the asymptotic bias is independent of the dimension d and can be computed exactly to be log n− ψ(n) + ψ(k)− log k and ψ(k) is the digamma function defined as ψ(x) = Γ−1(x)dΓ(x)/dx.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 7,
      "context" : "The dimension independent nature of this asymptotic bias term (of O(n−1/2) for d = 1 in [36, Theorem 1] and O(n−1/d) for general d in [8]) is special to the choice of p = 0 and the step kernel; we explain this in detail in Section 11, later in the paper.",
      "startOffset" : 134,
      "endOffset" : 137
    }, {
      "referenceID" : 5,
      "context" : "Analogously, the estimator in [6] can be viewed as a special case with p = 0 and an ellipsoidal step kernel.",
      "startOffset" : 30,
      "endOffset" : 33
    }, {
      "referenceID" : 15,
      "context" : "In [16], Kraskov and Stögbauer and Grassberger introduced ÎKSG(X;Y ) by coupling the choices of the bandwidths.",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 15,
      "context" : "Inspired by [16], we introduce the following novel mutual information estimator we denote by ÎLNN−KSG(X;Y ).",
      "startOffset" : 12,
      "endOffset" : 16
    }, {
      "referenceID" : 0,
      "context" : "samples from two random variables X and Y , where X is uniform over [0, 1] and Y = X + U , where U is uniform over [0, 0.",
      "startOffset" : 68,
      "endOffset" : 74
    }, {
      "referenceID" : 5,
      "context" : "Mutual information estimators have been recently proposed in [6, 7, 22] based on local likelihood maximization.",
      "startOffset" : 61,
      "endOffset" : 71
    }, {
      "referenceID" : 6,
      "context" : "Mutual information estimators have been recently proposed in [6, 7, 22] based on local likelihood maximization.",
      "startOffset" : 61,
      "endOffset" : 71
    }, {
      "referenceID" : 21,
      "context" : "Mutual information estimators have been recently proposed in [6, 7, 22] based on local likelihood maximization.",
      "startOffset" : 61,
      "endOffset" : 71
    }, {
      "referenceID" : 0,
      "context" : "In Figure 6, we test the mutual information estimators for Y = f(X) + U , where X is uniformly distributed over [0, 1] and U is uniformly distributed over [0, θ], independent of X, for some noise level θ.",
      "startOffset" : 112,
      "endOffset" : 118
    }, {
      "referenceID" : 6,
      "context" : "Similar simulation were studied in [7].",
      "startOffset" : 35,
      "endOffset" : 38
    }, {
      "referenceID" : 0,
      "context" : "Here Xi’s are uniformly distributed over [0, 1] and U is uniformly distributed over [−3/2, 3/2], independently of Xi’s.",
      "startOffset" : 41,
      "endOffset" : 47
    }, {
      "referenceID" : 5,
      "context" : "Similar simulation were studied in [6].",
      "startOffset" : 35,
      "endOffset" : 38
    }, {
      "referenceID" : 30,
      "context" : "6 Breaking the bandwidth barrier While k-NN distance based bandwidth are routine in practical usage [31], the main finding of this work is that they also turn out to be the “correct\" mathematical choice for the purpose of asymptotically unbiased estimation of an integral functional such as the entropy: − ∫ f(x) log f(x); we briefly discuss the ramifications below.",
      "startOffset" : 100,
      "endOffset" : 104
    }, {
      "referenceID" : 18,
      "context" : "On the other hand, when estimating entropy, as well as other integral functionals, it is known that resubstitution estimators of the form −(1/n) ∑n i=1 log f̂(Xi) achieve variances scaling as O(1/n) independent of the bandwidth [19].",
      "startOffset" : 228,
      "endOffset" : 232
    }, {
      "referenceID" : 18,
      "context" : "The bottleneck in choosing such a small bandwidth is the bias, scaling as O(h + (nhd)−1 + En) [19], where the lower order dependence on n, dubbed En, is generally not known.",
      "startOffset" : 94,
      "endOffset" : 98
    }, {
      "referenceID" : 17,
      "context" : "Following recent advances in [18, 33], the proposed local estimator has a potential to be extended to, for example, Renyi entropy, but with a multiplicative bias as opposed to additive.",
      "startOffset" : 29,
      "endOffset" : 37
    }, {
      "referenceID" : 32,
      "context" : "Following recent advances in [18, 33], the proposed local estimator has a potential to be extended to, for example, Renyi entropy, but with a multiplicative bias as opposed to additive.",
      "startOffset" : 29,
      "endOffset" : 37
    }, {
      "referenceID" : 28,
      "context" : "The former has been extensively studied, for example see [29] for a survey of results.",
      "startOffset" : 57,
      "endOffset" : 61
    }, {
      "referenceID" : 14,
      "context" : "based estimators, such as the entropy estimator of [15].",
      "startOffset" : 51,
      "endOffset" : 55
    }, {
      "referenceID" : 14,
      "context" : "In the seminal paper, [15] introduced resubstitution entropy estimators of the form Ĥ(X) = −(1/n) ∑n i=1 log f̂n(Xi) with f̂n(x) = k/(nCd ρ d k,x) (as defined in (4)).",
      "startOffset" : 22,
      "endOffset" : 26
    }, {
      "referenceID" : 14,
      "context" : "For k = 1 this was proved in the original paper of [15], which later was extended in [32, 9] to general k.",
      "startOffset" : 51,
      "endOffset" : 55
    }, {
      "referenceID" : 31,
      "context" : "For k = 1 this was proved in the original paper of [15], which later was extended in [32, 9] to general k.",
      "startOffset" : 85,
      "endOffset" : 92
    }, {
      "referenceID" : 8,
      "context" : "For k = 1 this was proved in the original paper of [15], which later was extended in [32, 9] to general k.",
      "startOffset" : 85,
      "endOffset" : 92
    }, {
      "referenceID" : 14,
      "context" : "This mysterious bias term Bk,d = (ψ(k)− log(k)) whose original proofs in [15, 32, 9] provided little explanation for, can be alternatively proved with both rigor and intuition by making connections to uniform order statistics.",
      "startOffset" : 73,
      "endOffset" : 84
    }, {
      "referenceID" : 31,
      "context" : "This mysterious bias term Bk,d = (ψ(k)− log(k)) whose original proofs in [15, 32, 9] provided little explanation for, can be alternatively proved with both rigor and intuition by making connections to uniform order statistics.",
      "startOffset" : 73,
      "endOffset" : 84
    }, {
      "referenceID" : 8,
      "context" : "This mysterious bias term Bk,d = (ψ(k)− log(k)) whose original proofs in [15, 32, 9] provided little explanation for, can be alternatively proved with both rigor and intuition by making connections to uniform order statistics.",
      "startOffset" : 73,
      "endOffset" : 84
    }, {
      "referenceID" : 2,
      "context" : "The O(1/n) convergence rate of the variance is established in [3, 18, 2, 4] under various assumptions.",
      "startOffset" : 62,
      "endOffset" : 75
    }, {
      "referenceID" : 17,
      "context" : "The O(1/n) convergence rate of the variance is established in [3, 18, 2, 4] under various assumptions.",
      "startOffset" : 62,
      "endOffset" : 75
    }, {
      "referenceID" : 1,
      "context" : "The O(1/n) convergence rate of the variance is established in [3, 18, 2, 4] under various assumptions.",
      "startOffset" : 62,
      "endOffset" : 75
    }, {
      "referenceID" : 3,
      "context" : "The O(1/n) convergence rate of the variance is established in [3, 18, 2, 4] under various assumptions.",
      "startOffset" : 62,
      "endOffset" : 75
    }, {
      "referenceID" : 9,
      "context" : "It has been first studied in [10, 11], where root-n consistency is shown in 1-dimension with bounded support and assuming f(x) is bounded below.",
      "startOffset" : 29,
      "endOffset" : 37
    }, {
      "referenceID" : 10,
      "context" : "It has been first studied in [10, 11], where root-n consistency is shown in 1-dimension with bounded support and assuming f(x) is bounded below.",
      "startOffset" : 29,
      "endOffset" : 37
    }, {
      "referenceID" : 35,
      "context" : "[36] is the first to prove a root mean squared error convergence rate of O(1/ √ n) for general densities with unbounded support in 1-dimension and exponentially decaying tail, such as the Gaussian density.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 4,
      "context" : "These assumptions are relaxed in [5], where zeroes and fat tails are allowed in f(x).",
      "startOffset" : 33,
      "endOffset" : 36
    }, {
      "referenceID" : 7,
      "context" : "In general d-dimensions, [8, 33] prove bounds on the convergence rate of the bias for finite k = O(1), and [24, 1] for k = Ω(log n).",
      "startOffset" : 25,
      "endOffset" : 32
    }, {
      "referenceID" : 32,
      "context" : "In general d-dimensions, [8, 33] prove bounds on the convergence rate of the bias for finite k = O(1), and [24, 1] for k = Ω(log n).",
      "startOffset" : 25,
      "endOffset" : 32
    }, {
      "referenceID" : 23,
      "context" : "In general d-dimensions, [8, 33] prove bounds on the convergence rate of the bias for finite k = O(1), and [24, 1] for k = Ω(log n).",
      "startOffset" : 107,
      "endOffset" : 114
    }, {
      "referenceID" : 0,
      "context" : "In general d-dimensions, [8, 33] prove bounds on the convergence rate of the bias for finite k = O(1), and [24, 1] for k = Ω(log n).",
      "startOffset" : 107,
      "endOffset" : 114
    }, {
      "referenceID" : 26,
      "context" : "This is made precise in [27], which also shows improved convergence rates for distributions whose support is on low dimensional manifolds.",
      "startOffset" : 24,
      "endOffset" : 28
    }, {
      "referenceID" : 26,
      "context" : "However, the estimator in [27] critically uses the geodesic distances between the sample points on the manifold.",
      "startOffset" : 26,
      "endOffset" : 30
    }, {
      "referenceID" : 33,
      "context" : "3 Ensemble estimators Recent works [34, 25, 26, 1] have proposed ensemble estimators, which use known estimators based on kernel density estimators and k-NN methods and construct a new estimate by taking the weighted linear combination of those methods with varying bandwidth or k, respectively.",
      "startOffset" : 35,
      "endOffset" : 50
    }, {
      "referenceID" : 24,
      "context" : "3 Ensemble estimators Recent works [34, 25, 26, 1] have proposed ensemble estimators, which use known estimators based on kernel density estimators and k-NN methods and construct a new estimate by taking the weighted linear combination of those methods with varying bandwidth or k, respectively.",
      "startOffset" : 35,
      "endOffset" : 50
    }, {
      "referenceID" : 25,
      "context" : "3 Ensemble estimators Recent works [34, 25, 26, 1] have proposed ensemble estimators, which use known estimators based on kernel density estimators and k-NN methods and construct a new estimate by taking the weighted linear combination of those methods with varying bandwidth or k, respectively.",
      "startOffset" : 35,
      "endOffset" : 50
    }, {
      "referenceID" : 0,
      "context" : "3 Ensemble estimators Recent works [34, 25, 26, 1] have proposed ensemble estimators, which use known estimators based on kernel density estimators and k-NN methods and construct a new estimate by taking the weighted linear combination of those methods with varying bandwidth or k, respectively.",
      "startOffset" : 35,
      "endOffset" : 50
    }, {
      "referenceID" : 0,
      "context" : "An intuitive explanation for this phenomenon is provided in [1] in the context of k-NN methods; it is interesting to explore if such a phenomenon continues in the k-LNN scenario studied in this paper.",
      "startOffset" : 60,
      "endOffset" : 63
    }, {
      "referenceID" : 20,
      "context" : "The gradient of the local likelihood evaluated at the maximizer is zero [21], which gives a computational tool for finding the maximizer:",
      "startOffset" : 72,
      "endOffset" : 76
    }, {
      "referenceID" : 28,
      "context" : "5 of [29] to show that this term vanishes for m = O(log n) and as n grows.",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 28,
      "context" : "5, [29]).",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 27,
      "context" : "As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39].",
      "startOffset" : 12,
      "endOffset" : 16
    }, {
      "referenceID" : 14,
      "context" : "As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39].",
      "startOffset" : 227,
      "endOffset" : 242
    }, {
      "referenceID" : 8,
      "context" : "As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39].",
      "startOffset" : 227,
      "endOffset" : 242
    }, {
      "referenceID" : 17,
      "context" : "As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39].",
      "startOffset" : 227,
      "endOffset" : 242
    }, {
      "referenceID" : 38,
      "context" : "As noted in [28] this is common in the literature on consistency of k-NN estimators, where the same assumptions have been implicitly made without explicitly stating as such, in existing analyses of entropy estimators including [15, 9, 18, 39].",
      "startOffset" : 227,
      "endOffset" : 242
    }, {
      "referenceID" : 27,
      "context" : "This assumption can be avoided for Renyi entropy as in the proof of consistency in [28] or for sharper results such as the convergence rate of the bias with respect to the sample size but with more assumptions as in [8, 33, 1].",
      "startOffset" : 83,
      "endOffset" : 87
    }, {
      "referenceID" : 7,
      "context" : "This assumption can be avoided for Renyi entropy as in the proof of consistency in [28] or for sharper results such as the convergence rate of the bias with respect to the sample size but with more assumptions as in [8, 33, 1].",
      "startOffset" : 216,
      "endOffset" : 226
    }, {
      "referenceID" : 32,
      "context" : "This assumption can be avoided for Renyi entropy as in the proof of consistency in [28] or for sharper results such as the convergence rate of the bias with respect to the sample size but with more assumptions as in [8, 33, 1].",
      "startOffset" : 216,
      "endOffset" : 226
    }, {
      "referenceID" : 0,
      "context" : "This assumption can be avoided for Renyi entropy as in the proof of consistency in [28] or for sharper results such as the convergence rate of the bias with respect to the sample size but with more assumptions as in [8, 33, 1].",
      "startOffset" : 216,
      "endOffset" : 226
    }, {
      "referenceID" : 20,
      "context" : "From [21] we know that the maximizer is a fixed point of a series of non-linear equations of the form ∑",
      "startOffset" : 5,
      "endOffset" : 9
    } ],
    "year" : 2016,
    "abstractText" : "Estimators of information theoretic measures such as entropy and mutual information are a basic workhorse for many downstream applications in modern data science. State of the art approaches have been either geometric (nearest neighbor (NN) based) or kernel based (with a globally chosen bandwidth). In this paper, we combine both these approaches to design new estimators of entropy and mutual information that outperform state of the art methods. Our estimator uses local bandwidth choices of k-NN distances with a finite k, independent of the sample size. Such a local and data dependent choice improves performance in practice, but the bandwidth is vanishing at a fast rate, leading to a non-vanishing bias. We show that the asymptotic bias of the proposed estimator is universal; it is independent of the underlying distribution. Hence, it can be precomputed and subtracted from the estimate. As a byproduct, we obtain a unified way of obtaining both kernel and NN estimators. The corresponding theoretical contribution relating the asymptotic geometry of nearest neighbors to order statistics is of independent mathematical interest.",
    "creator" : "LaTeX with hyperref package"
  }
}