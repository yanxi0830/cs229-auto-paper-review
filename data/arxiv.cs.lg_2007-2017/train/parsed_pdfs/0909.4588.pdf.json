{
  "name" : "0909.4588.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Discrete MDL Predicts in Total Variation",
    "authors" : [ "Marcus Hutter" ],
    "emails" : [ "RSISE@ANU", "SML@NICTA", "marcus@hutter1.net" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :0\n90 9.\n45 88\nv1 [\nm at\nh. PR\n] 2\nContents"
    }, {
      "heading" : "1 Introduction 1",
      "text" : ""
    }, {
      "heading" : "2 Facts, Insights, Problems 4",
      "text" : ""
    }, {
      "heading" : "3 Notation and Main Result 6",
      "text" : ""
    }, {
      "heading" : "4 Proof for Finite Model Class 8",
      "text" : ""
    }, {
      "heading" : "5 Proof for Countable Model Class 10",
      "text" : ""
    }, {
      "heading" : "6 Implications 12",
      "text" : "7 Variations 14 References 14\nKeywords\nminimum description length; countable model class; total variation distance; sequence prediction; discriminative learning; reinforcement learning."
    }, {
      "heading" : "1 Introduction",
      "text" : "The minimum description length (MDL) principle recommends to use, among competing models, the one that allows to compress the data+model most [Grü07]. The better the compression, the more regularity has been detected, hence the better will\npredictions be. The MDL principle can be regarded as a formalization of Ockham’s razor, which says to select the simplest model consistent with the data.\nMultistep lookahead sequential prediction. We consider sequential prediction problems, i.e. having observed sequence x ≡ (x1,x2,...,xℓ) ≡ x1:ℓ, predict z ≡ (xℓ+1,...,xℓ+h)≡ xℓ+1:ℓ+h, then observe xℓ+1 ∈X for ℓ≡ ℓ(x) = 0,1,2,.... Classical prediction is concerned with h= 1, multi-step lookahead with 1<h<∞, and total prediction with h=∞. In this paper we consider the last, hardest case. An infamous problem in this category is the Black raven paradox [Mah04, Hut07]: Having observed ℓ black ravens, what is the likelihood that all ravens are black. A more computer science problem is (infinite horizon) reinforcement learning, where predicting the infinite future is necessary for evaluating a policy. See Section 6 for these and other applications.\nDiscrete MDL and Bayes. Let M= {Q1,Q2,...} be a countable class of models=theories=hypotheses=probabilities over sequences X∞, sorted w.r.t. to their complexity=codelength K(Qi)=2log2i (say), containing the unknown true sampling distribution P . Our main result will be for arbitrary measurable spaces X , but to keep things simple in the introduction, let us illustrate MDL for finite X .\nIn this case, we define Qi(x) as the Qi-probability of data sequence x∈X ℓ. It is possible to code x in logP (x)−1 bits, e.g. by using Huffman coding. Since x is sampled from P , this code is optimal (shortest among all prefix codes). Since we do not know P , we could select the Q∈M that leads to the shortest code on the observed data x. In order to be able to reconstruct x from the code we need to know which Q has been chosen, so we also need to code Q, which takes K(Q) bits. Hence x can be coded in minQ∈M{−logQ(x)+K(Q)} bits. MDL selects as model the minimizer\nMDLx := arg min Q∈M {− logQ(x) +K(Q)}\nGiven x, the true predictive probability of z is P (z|x)=P (xz)/P (x). Since P is unknown we use MDLx(z|x) :=MDLx(xz)/MDLx(x) as a substitute. Our main concern is how close is the latter to the former. We can measure the distance between two predictive distributions by\ndh(P,Q|x) = ∑\nz∈Xh\n∣∣P (z|x)−Q(z|x) ∣∣ (1)\nfor h<∞ and d∞=limh→∞dh=sup{d1,d2,...}. It is easy to see that dh is monotone increasing and that d∞ is twice the total variation distance (tvd) defined in (3).\nMDL is closely related to Bayesian prediction, so a comparison to existing results for Bayes is interesting. Bayesians use Bayes(z|x) for prediction, where Bayes(x) :=∑ Q∈MQ(x)wQ is the Bayesian mixture with prior weights wQ > 0 ∀Q ∈ M and∑ Q∈MwQ=1. A natural choice is wQ∝2 −K(Q).\nResults. The following results can be shown\n∑∞ ℓ=0 E[dh(P,MDL\nx|x1:ℓ)] ≤ 21 h·2 K(P ),∑∞\nℓ=0E[dh(P,Bayes|x1:ℓ)] ≤ h·lnw −1 P ,\nd∞(P,MDL x|x) → 0 d∞(P,Bayes|x) → 0\n{ almost surely\nfor ℓ(x)→∞ (2)\nwhere the expectation E is w.r.t. P [·|x]. The left statements for h < ∞ imply dh → 0 almost surely, including some form of convergence rate. For Bayes it has been proven in [Hut03]; for MDL the proof in [PH05] can be adapted. As far as asymptotics is concerned, the right results d∞→ 0 are much stronger, and require more sophisticated proof techniques. For Bayes, the result follows from [BD62]. The proof for MDL is the primary novel contribution of this paper; more precisely for arbitrary measurable X in total variation distance. Another general consistency result is presented in [Grü07, Thm.5.1]. Consistency is shown (only) in probability and the predictive implications of the result are unclear. A stronger almost sure result is alluded to, but the given reference to [BC91] contains only results for i.i.d. sequences which do not generalize to arbitrary classes. So existing results for discrete MDL are far less satisfactory than the elegant Bayesian prediction in tvd.\nMotivation. The results above hold for completely arbitrary countable model classes M. No independence, ergodicity, stationarity, identifiability, or other assumption need to be made.\nThe bulk of previous results for MDL are for continuous model classes [Grü07]. Much has been shown for classes of independent identically distributed (i.i.d.) random variables [BC91, Grü07]. Many results naturally generalize to stationaryergodic sequences like (kth-order) Markov. For instance, asymptotic consistency has been shown in [Bar85]. There are many applications violating these assumptions, some of them are presented below and in Section 6.\nOne can often hear the exaggerated claim that (e.g. unlike Bayes) MDL can be used even if the true distribution P is not in M. Indeed, it can be used, but the question is wether this is any good. There are some results supporting this claim, e.g. if P is in the closure of M, but similar results exist for Bayes. Essentially P needs to be at least close to some Q∈M for MDL to work, and there are interesting environments that are not even close to being stationary-ergodic or i.i.d.\nNon-i.i.d. data is pervasive [AHRU09]; it includes all time-series prediction problems like weather forecasting and stock market prediction [CBL06]. Indeed, these are also perfect examples of non-ergodic processes. Too much green house gases, a massive volcanic eruption, an asteroid impact, or another world war could change the climate/economy irreversibly. Life is also not ergodic; one inattentive second in a car can have irreversible consequences. Also stationarity is easily violated in multi-agent scenarios: An environment which itself contains a learning agent is nonstationary (during the relevant learning phase). Extensive games and multi-agent reinforcement learning are classical examples [WR04].\nOften it is assumed that the true distribution can be uniquely identified asymptotically. For non-ergodic environments, asymptotic distinguishability can depend\non the realized observations, which prevent a prior reduction or partitioning of M. Even if principally possible, it can be practically burdensome to do so, e.g. in the presence of approximate symmetries. Indeed this problem is the primary reason for considering predictive MDL. MDL might never identify the true distribution, but our main result shows that the sequentially selected models become predictively indistinguishable.\nThe countability of M is the severest restriction of our result. Nevertheless the countable case is useful. A semi-parametric problem class ⋃∞ d=1Md with Md={Qθ,d :θ∈IR d} (say) can be reduced to a countable class M={Pd} for which our result holds, where Pd is a Bayes or NML or other estimate of Md [Grü07]. Alternatively, ⋃ dMd could be reduced to a countable class by considering only computable parameters θ. Essentially all interesting model classes contain such a countable topologically dense subset. Under certain circumstances MDL still works for the non-computable parameters [Grü07]. Alternatively one may simply reject non-computable parameters on philosophical grounds [Hut05]. Finally, the techniques for the countable case might aid proving general results for continuous M, possibly along the lines of [Rya09].\nContents. The paper is organized as follows: In Section 2 we provide some insights how MDL and Bayes work in restricted settings, what breaks down for general countable M, and how to circumvent the problems. The formal development starts with Section 3, which introduces notation and our main result. The proof for finite M is presented in Section 4 and for denumerable M in Section 5. In Section 6 we show how the result can be applied to sequence prediction, classification and regression, discriminative learning, and reinforcement learning. Section 7 discusses some MDL variations."
    }, {
      "heading" : "2 Facts, Insights, Problems",
      "text" : "Before starting with the formal development, we describe how MDL and Bayes work in some restricted settings, what breaks down for general countable M, and how to circumvent the problems. For deterministic environments, MDL reduces to learning by elimination, and the four results in (2) can easily be understood. Consistency of MDL for i.i.d. (and stationary-ergodic) sources is also intelligible. For general M, MDL may no longer converge to the true model. We have to give up the idea of model identification, and concentrate on predictive performance.\nDeterministic MDL = elimination learning. For a countable class M = {Q1,Q2,...} of deterministic theories=models=hypotheses=sequences, sorted w.r.t. to their complexity=codelength K(Qi) = 2log2i (say) it is easy to see why MDL works: Each Q is a model for one infinite sequence xQ1:∞, i.e. Q(x\nQ)=1. Given the true observations x≡xP1:ℓ so far, MDL selects the simplest Q consistent with x P 1:ℓ and for h=1 predicts xQℓ+1. This (and potentially other) Q becomes (forever) inconsistent if and only if the prediction was wrong. Assume the true model is P =Qm. Since\nelimination occurs in order of increasing index i, and Qm never makes any error, MDL makes at most m−1 prediction errors. Indeed, what we have described is just classical Gold style learning by elimination. For 1<h<∞, the prediction xQℓ+1:ℓ+h may be wrong only on xQℓ+h, which causes h wrong predictions before the error is revealed. (Note that at time ℓ only xPℓ is revealed.) Hence the total number of errors is bounded by h·(m−1). The bound is for instance attained on the class consisting of Qi=1\nih0∞, and the true sequence switches from 1 to 0 after having observed m·h ones. For h=∞, a wrong prediction gets eventually revealed. Hence each wrong Qi (i<m) gets eventually eliminated, i.e. P gets eventually selected. So for h=∞ we can (still/only) show that the number of errors is finite. No bound on the number of errors in terms ofm only is possible. For instance, forM={Q1=1 ∞,Q2=P=1 n0∞}, it takes n time steps to reveal that prediction 1∞ is wrong, and n can be chosen arbitrarily large.\nDeterministic Bayes = majority learning. Bayesian learning is at the same time, closely related to and very different from MDL. Bayes predicts with a wQweighted average of the models (rather than with a single one). For a deterministic class, Bayes is similar to prediction by majority: Consider the models consistent with the true observation xP1:ℓ, having total weight W , and take the weighted majority prediction (this is the Bayes-optimal decision under 0-1 loss, Bayesian prediction would randomize). For h=1, making a wrong prediction means thatQ’s contributing to at least half of the total weight W get eliminated. Since P =Qm never gets eliminated, we have wP ≤W ≤2\n−#Errors, hence the number of errors is bounded by log2w −1 P . For probabilistic Bayesian prediction proper, it is also easy to see that the expected number of errors is bounded by lnw−1P . One can show that these bounds are essentially sharp. (e.g. for Qi defined as the digits after the comma of the binary expansion of (i−1)/2n for i=1..m and m=2n−1.) With the same reasoning as in the MDL case, for h>1 we have to multiply the bound by h; and for h=∞ we get correct prediction eventually, but no explicit bound anymore.\nComparison of deterministic↔probabilistic and MDL↔Bayes. The flavor of results carries over to some extent to the probabilistic case. On a very abstract level even the line of reasoning carries over, although this is deeply buried in the sophisticated mathematical analysis of the latter. So the special deterministic case illustrates the more complex probabilistic case. For instance for h=1 and wi∝1/i\n2, we see that “Bayes” makes only 2log2m errors, while MDL can make up to the m errors. This carries over to the probabilistic case. Also the multiplier h for 1<h<∞ and the lack of an explicit bound for h=∞ carries over. Cf. the bounds in (2). The reader is invited to reveal other relations not explicitly mentioned here. The differences are as follows: In the probabilistic case, the true P can in general not be identified anymore. Further, while the Bayesian bound trivially follows from the 1/2-century old classical merging of opinions result [BD62], the corresponding MDL bound we prove in this paper is more difficult to obtain.\nConsistency of MDL for stationary-ergodic sources. For an i.i.d. class M,\nthe law of large numbers applied to the random variables Zt := log[P (xt)/Q(xt)] implies 1\nℓ ∑ℓ t=1Zt →KL(P ||Q) := ∑ x1 P (x1)log[P (x1)/Q(x1)] with P -probability 1.\nEither the Kullback-Leibler (KL) divergence is zero, which is the case if and only if P =Q, or logP (x1:ℓ)−logQ(x1:ℓ)≡ ∑ℓ t=1Zℓ∼KL(P ||Q)ℓ→∞, i.e. asymptotically MDL does not select Q. For countable M, a refinement of this argument shows that MDL eventually selects P [BC91]. This reasoning can be extended to stationaryergodic M, but essentially not beyond. To see where the limitation comes from, we present some troubling examples.\nTrouble makers. For instance, let P be a Bernoulli(θ0) process, but let the Qprobability that xt=1 be θt, i.e. time-dependent (still assuming independence). For a suitably converging but “oscillating” (i.e. infinitely often larger and smaller than its limit) sequence θt→ θ0 one can show that log[P (x1:t)/Q(x1:t)] converges to but oscillates around K(Q)−K(P ) w.p.1, i.e. there are non-stationary distributions for which MDL does not converge (not even to a wrong distribution).\nOne idea to solve this problem is to partition M, where two distributions are in the same partition if and only if they are asymptotically indistinguishable (like P and Q above), and then ask MDL to only identify a partition. This approach cannot succeed generally, whatever particular criterion is used, for the following reason: Let P (x1)>0 ∀x1. For x1=1, let P and Q be asymptotically indistinguishable, e.g. P =Q on the remainder of the sequence. For x1=0, let P and Q be asymptotically distinguishable distributions, e.g. different Bernoullis. This shows that for nonergodic sources like this one, asymptotic distinguishability depends on the drawn sequence. The first observation can lead to totally different futures.\nPredictive MDL avoids trouble. The Bayesian posterior does not need to converge to a single (true or other) distribution, in order for prediction to work. We can do something similar for MDL. At each time we still select a single distribution, but give up the idea of identifying a single distribution asymptotically. We just measure predictive success, and accept infinite oscillations. That’s the approach taken in this paper."
    }, {
      "heading" : "3 Notation and Main Result",
      "text" : "The formal development starts with this section. We need probability measures and filters for infinite sequences, conditional probabilities and densities, the total variation distance, and the concept of merging (of opinions), in order to formally state our main result.\nMeasures on sequences. Let (Ω :=X∞,F ,P ) be the space of infinite sequences with natural filtration and product σ-field F and probability measure P . Let ω∈Ω be an infinite sequence sampled from the true measure P . Except when mentioned otherwise, all probability statements and expectations refer to P , e.g. almost surely (a.s.) and with probability 1 (w.p.1) are short for with P -probability 1 (w.P .p.1). Let x=x1:ℓ=ω1:ℓ be the first ℓ symbols of ω.\nFor countable X , the probability that an infinite sequence starts with x is P (x):= P [{x}×X∞]. The conditional distribution of an event A given x is P [A|x] :=P [A∩ ({x}×X∞)]/P (x), which exists w.p.1. For other probability measures Q on Ω, we define Q(x) and Q[A|x] analogously. General X are considered at the end of this section.\nConvergence in total variation. P is said to be absolutely continuous relative to Q, written\nP ≪ Q :⇔ [Q[A] = 0 implies P [A] = 0 for all A ∈ F ]\nP and Q are said to be mutually singular, written P⊥Q, iff there exists an A∈F for which P [A]=1 and Q[A]=0. The total variation distance (tvd) between Q and P given x is defined as\nd(P,Q|x) := sup A∈F\n∣∣Q[A|x]− P [A|x] ∣∣ (3)\nQ is said to predict P in tvd (or merge with P ) if d(P,Q|x) → 0 for ℓ(x) → ∞ with P -probability 1. Note that this in particular implies, but is stronger than one-step predictive on- and off-sequence convergence Q(xℓ+1=aℓ+1|x1:ℓ)−P (xℓ+1= aℓ+1|x1:ℓ)→0 for any a, not necessarily equal ω [KL94]. The famous Blackwell and Dubins convergence result [BD62] states that if P is absolutely continuous relative to Q, then (and only then [KL94]) Q merges with P :\nIf P ≪ Q then d(P,Q|x) → 0 w.p.1 for ℓ(x) → ∞\nBayesian prediction. This result can immediately be utilized for Bayesian prediction. Let M :={Q1,Q2,Q3,...} be a countable (finite or infinite) class of probability measures, and Bayes[A] := ∑ Q∈MQ[A]wQ with wQ > 0 ∀Q and ∑ Q∈MwQ = 1. If the model assumption P ∈M holds, then obviously P≪Bayes, hence Bayes merges with P , i.e. d(P,Bayes|x)→ 0 w.p.1 for all P ∈M. Unlike many other Bayesian convergence and consistency theorems, no (independence, ergodicity, stationarity, identifiability, or other) assumption on the model class M need to be made. Good convergence rates for the weaker dh<∞ distances have also been shown [Hut03]. The analogous result for MDL is as follows:\nTheorem 1 (MDL predictions) Let M be a countable class of probability measures on X∞ containing the unknown true sampling distribution P . No (independence, ergodicity, stationarity, identifiability, or other) assumptions need to be made on M. Let\nMDLx := arg min Q∈M\n{− logQ(x) +K(Q)} with ∑\nQ∈M\n2−K(Q) < ∞\nbe the measure selected by MDL at time ℓ given x∈X ℓ. Then the predictive distributions MDLx[·|x] converge to P [·|x] in the sense that\nd(P,MDLx|x) ≡ sup A∈F\n∣∣MDLx[A|x]− P [A|x] ∣∣ → 0 for ℓ(x) → ∞ w.p.1\nK(Q) is usually interpreted and defined as the length of some prefix code for Q, in which case ∑ Q2 −K(Q) ≤ 1. If K(Q) := log2w −1 Q is chosen as complexity, by Bayes rule Pr(Q|x) = Q(x)wQ/Bayes(x), the maximum a posteriori estimate MAPx :=argmaxQ∈M{Pr(Q|x)}≡MDL\nx. Hence the theorem also applies to MAP. The proof of the theorem is surprisingly subtle and complex compared to the analogous Bayesian case. One reason is that MDLx(x) is not a measure on X∞.\nArbitrary X . For arbitrary X , definitions are more subtle. The casual reader satisfied with countable X can skip this paragraph. We can consider even more generally xt∈Xt [BD62]. Let Bt be a σ-field of subsets of Xt for t=1,2,3,.... Let Fℓ be the σ-field for X ℓ :=X1×...×Xℓ generated by (i.e. the smallest σ-field containing) B1×...×Bℓ for ℓ≤∞. Let (Ω :=X\n∞,F =F∞,P ) be a probability space. Let Pℓ be the marginal distribution on (X ℓ,Fℓ), i.e. Pℓ[A] :=P [A×Xℓ+1×Xℓ+2×...] for A∈Fℓ. The predictive distribution P ℓ[A|x1:ℓ] is (a version of) the conditional distribution of the future “xℓ+1:∞” given past x1:ℓ, implicitly defined by ∫ P ℓ[A|x1:ℓ]dPℓ(x1:ℓ):=P [A] ∀A∈F . Similarly define Qℓ and Q ℓ for the other Q∈M. See [Doo53] for details.\nLet M be a measure on Ω such that Q is absolutely continuous (see below) relative to M for all Q∈M. For instance M [·] =Bayes[·] has this property. Now define the density (Radon-Nikodym derivative) Qℓ(x1:ℓ) (round brackets) of measure Qℓ[·] (square brackets) relative to Mℓ[·]. It is important to note that all essential quantities, in particular MDLx, are independent of the particular choice of M . We therefore plainly speak of the Q-density or even Q-probability of x.\nFor countable X and counting measure M , Qℓ[A|x] and Qℓ(x) coincide with Q[A|x] and Q(x) above. In the following, we drop the sup&superscripts ℓ, since they will always be clear from the argument. Note that by Carathodory’s extension theorem, {Q(x) :x∈X ∗} uniquely defines Q[A] ∀A∈F ."
    }, {
      "heading" : "4 Proof for Finite Model Class",
      "text" : "We first prove Theorem 1 for finite model classes M. For this we need the following Definition and Lemma:\nDefinition 2 (Relations between Q and P ) For any probability measures Q and P , let\n• Qr+Qs=Q be the Lebesgue decomposition of Q relative to P into an absolutely continuous non-negative measure Qr≪P and a singular non-negative measure Qs⊥P . • g(ω) := dQr/dP = limℓ→∞[Q(x1:ℓ)/P (x1:ℓ)] be (a version of) the RadonNikodym derivative, i.e. Qr[A]= ∫ A g dP . • Ω◦ := {ω :Q(x1:ℓ)/P (x1:ℓ)→0} ≡ {ω :g(ω)=0}. • ~Ω := {ω :d(P,Q|x)→0 for ℓ(x)→∞}.\nIt is well-known that the Lebesgue decomposition exists and is unique. The representation of the Radon-Nikodym derivative as a limit of local densities can e.g. be found in [Doo53, VII§8]: Z\nr/s ℓ (ω) :=Q r/s(x1:ℓ)/P (x1:ℓ) for ℓ=1,2,3,... constitute two martingale sequences, which converge w.p.1. Qr≪P implies that the limit Zr∞ is the Radon-Nikodym derivative dQr/dP . (Indeed, Doob’s martingale convergence theorem can be used to prove the Radon-Nikodym theorem.) Qs⊥P implies Zr∞=0 w.p.1. So g is uniquely defined and finite w.p.1.\nLemma 3 (Generalized merging of opinions) For any Q and P , the following holds:\n(i) P≪Q if and only if P [Ω◦]=0 (ii) P [Ω◦]=0 implies P [~Ω]=1 [(i)+[BD62]] (iii) P [Ω◦∪~Ω]=1 [generalizes (ii)]\n(i) says that Q(x)/P (x) converges almost surely to a strictly positive value if and only if P is absolutely continuous relative to Q, (ii) says that an almost sure positive limit of Q(x)/P (x) implies that Q merges with P . (iii) says that even if P 6≪Q, we still have d(P,Q|x)→ 0 on almost every sequence that has a positive limit of Q(x)/P (x).\nProof. Recall Definition 2. (i⇐) Assume P [Ω◦]=0: P [A]>0 implies Q[A]≥Qr[A]= ∫ A g dP >0, since g>0 a.s. by assumption P [Ω◦]=0. Therefore P≪Q. (i⇒) Assume P ≪ Q: Choose a B for which P [B] = 1 and Qs[B] = 0. Now\nQr[Ω◦]= ∫ Ω◦ g dP =0 implies 0≤Q[B∩Ω◦]≤Qs[B]+Qr[Ω◦]= 0+0. By P ≪Q this implies P [B∩Ω◦]=0, hence P [Ω◦]=0. (ii) That P ≪Q implies P [~Ω] = 1 is Blackwell-Dubins’ celebrated result. The result now follows from (i). (iii) generalizes [BD62]. For P [Ω◦]= 0 it reduces to (ii). The case P [Ω◦]= 1 is trivial. Therefore we can assume 0<P [Ω◦]<1. Consider measure P ′[A] :=P [A|B] conditioned on B :=Ω\\Ω◦.\nAssume Q[A] = 0. Using ∫ Ω◦ g dP = 0, we get 0 =Qr[A] = ∫ A g dP = ∫ A\\Ω◦ g dP . Since g > 0 outside Ω◦, this implies P [A\\Ω◦] = 0. So P ′[A] = P [A∩B]/P [B] = P [A\\Ω◦]/P [B]=0. Hence P ′≪Q. Now (ii) implies d(P ′,Q|x)→0 with P ′ probability 1. Since P ′≪P we also get d(P ′,P |x)→0 w.P ′.p.1.\nTogether this implies 0 ≤ d(P,Q|x) ≤ d(P ′,P |x)+d(P ′,Q|x) → 0 w.P ′.p.1, i.e. P ′[~Ω]=1. The claim now follows from\nP [Ω◦ ∪ ~Ω] = P ′[Ω◦ ∪ ~Ω]P [Ω \\ Ω◦] + P [Ω◦ ∪ ~Ω|Ω◦]P [Ω◦]\n= 1 · P [Ω \\ Ω◦] + 1 · P [Ω◦] = P [Ω] = 1\nThe intuition behind the proof of Theorem 1 is as follows. MDL will asymptotically not select Q for which Q(x)/P (x)→0. Hence for those Q potentially selected by MDL, we have ω 6∈Ω◦, hence ω∈~Ω, for which d(P,Q|x)→0 (a.s.). The technical\ndifficulties are for finite M that the eligible Q depend on the sequence ω, and for infinite M to deal with non-uniformly converging d, i.e. to infer d(P,MDLx|x)→0.\nProof of Theorem 1 for finite M. Recall Definition 2, and let gQ,Ω ◦ Q,~ΩQ refer to some Q∈M≡{Q1,...,Qm}. The set of sequences ω for which some gQ for some Q∈M is undefined has P -measure zero, and hence can be ignored. Fix some sequence ω∈Ω for which gQ(ω) is defined for all Q∈M, and let Mω :={Q∈M :gQ(ω)=0}.\nMDLx := arg min Q∈M LQ(x), where LQ(x) := − logQ(x) +K(Q).\nConsider the difference\nLQ(x)− LP (x) = − log Q(x)\nP (x) +K(Q)−K(P )\nℓ→∞ −→ − log gQ(ω) +K(Q)−K(P )\nFor Q∈Mω, the r.h.s. is +∞, hence\n∀Q∈Mω ∃ℓQ∀ℓ>ℓQ : LQ(x) > LP (x)\nSince M is finite, this implies\n∀ℓ>ℓ0 ∀Q∈Mω : LQ(x) > LP (x), where ℓ0 := max{ℓQ : Q ∈ Mω} < ∞\nTherefore, since P ∈M, we have MDLx 6∈Mω ∀ℓ > ℓ0, so we can safely ignore all Q ∈Mω and focus on Q ∈ Mω := M\\Mω. Let Ω1 := ⋂ Q∈Mω\n(Ω◦Q∪~ΩQ). Since P [Ω1]=1 by Lemma 3(iii), we can also assume ω∈Ω1.\nQ ∈ Mω ⇒ gQ(ω) > 0 ⇒ ω 6∈ Ω ◦ Q ⇒ ω ∈ ~ΩQ ⇒ d(P,Q|x) → 0\nThis implies d(P,MDLx|x) ≤ sup Q∈Mω d(P,Q|x) → 0\nwhere the inequality holds for ℓ> ℓ0 and the limit holds, since M is finite. Since the set of ω excluded in our considerations has measure zero, d(P,MDLx|x)→ 0 w.p.1, which proves the theorem for finite M."
    }, {
      "heading" : "5 Proof for Countable Model Class",
      "text" : "The proof in the previous Section crucially exploited finiteness of M. We want to prove that the probability that MDL asymptotically selects “complex” Q is small. The following Lemma establishes that the probability that MDL selects a specific complex Q infinitely often is small.\nLemma 4 (MDL avoids complex probability measures Q) For any Q and P we have P [Q(x)/P (x)≥c infinitly often]≤1/c.\nProof. P [∀ℓ0∃ℓ>ℓ0 : Q(x)\nP (x) ≥ c]\n(a) = P [ lim\nℓ→∞\nQ(x) P (x) ≥ c] ≤\n(b) ≤ 1\nc E[lim ℓ\nQ(x) P (x) ] (c) = 1 c E[lim\nℓ\nQ(x) P (x) ]\n(d) ≤ 1\nc lim ℓ E[\nQ(x) P (x) ] (e) ≡ 1 c\n(a) is true by definition of the limit superior lim, (b) is Markov’s inequality, (c) exploits the fact that the limit of Q(x)/P (x) exists w.p.1, (d) uses Fatou’s lemma, and (e) is obvious.\nFor sufficiently complex Q, Lemma 4 implies that LQ(x)>LP (x) for most x. Since convergence is non-uniform in Q, we cannot apply the Lemma to all (infinitely many) complex Q directly, but need to lump them into one Q̄.\nProof of Theorem 1 for countable M. Let the Q∈M={Q1,Q2,...} be ordered somehow, e.g. in increasing order of complexity K(Q), and P =Qn. Choose some (large) m≥n and let M̃ := {Qm+1,Qm+2,...} be the set of “complex” Q. We show that the probability that MDL selects infinitely often complex Q is small:\nP [MDLx ∈ M̃ infinitely often]\n≡ P [∀ℓ0∃ℓ>ℓ0 : MDL x ∈ M̃]\n≤ P [∀ℓ0∃ℓ>ℓ0 ∧Q ∈ M̃ : LQ(x) ≤ LP (x)]\n= P [∀ℓ0∃ℓ>ℓ0 : sup i>m\nQi(x) P (x) 2K(P )−K(Qi) ≥ 1] (a) ≤ P [∀ℓ0∃ℓ>ℓ0 : Q̄(x) P (x) δ 2K(P ) ≥ 1] (b) ≤ δ 2K(P ) (c) ≤ ε\nThe first three relations follow immediately from the definition of the various quantities. Bound (a) is the crucial “lumping” step. First we bound\nsup i>m\nQi(x) P (x) 2−K(Qi) ≤\n∞∑\ni=m+1\nQi(x) P (x) 2−K(Qi) = δ Q̄(x) P (x) ,\nδ := ∑\ni>m\n2−K(Qi) < ∞, Q̄(x) := 1\nδ\n∑\ni>m\nQi(x)2 −K(Qi),\nWhile MDL·[·] is not a (single) measure on Ω and hence difficult to deal with, Q̄ is a proper probability measure on Ω. In a sense, this step reduces MDL to Bayes. Now we apply Lemma 4 in (b) to the (single) measure Q̄. The bound (c) holds for sufficiently large m=mε(P ), since δ→ 0 for m→∞. This shows that for the sequence of MDL estimates\n{MDLx1:ℓ :ℓ > ℓ0} ⊆ {Q1, ..., Qm} with probability at least 1− ε\nHence the already proven Theorem 1 for finite M implies that d(P,MDLx|x)→ 0 with probability at least 1−ε. Since convergence holds for every ε > 0, it holds w.p.1."
    }, {
      "heading" : "6 Implications",
      "text" : "Due to its generality, Theorem 1 can be applied to many problem classes. We illustrate some immediate implications of Theorem 1 for time-series forecasting, classification, regression, discriminative learning, and reinforcement learning.\nTime-series forecasting. Classical online sequence prediction is concerned with predicting xℓ+1 from (non-i.i.d.) sequence x1:ℓ for ℓ=1,2,3,.... Forecasting farther into the future is possible by predicting xℓ+1:ℓ+h for some h>0. One can show that 0≤ d1 ≤ dh ≤ dh+1 ≤ d∞ = 2d≤ 2, see (1) and (3). Hence Theorem 1 implies good asymptotic (multi-step) predictions. Offline learning is concerned with training a predictor on x1:ℓ for fixed ℓ in-house, and then selling and using the predictor on xℓ+1:∞ without further learning. Theorem 1 shows that for enough training data, predictions “post-learning” will be good.\nClassification and Regression. In classification (discrete X ) and regression (continuous X ), a sample is a set of pairs D = {(y1,x1),...,(yℓ,xℓ)}, and a functional relationship ẋ= f(ẏ)+noise, i.e. a conditional probability P (ẋ|ẏ) shall be learned. For reasons apparent below, we have swapped the usual role of ẋ and ẏ. The dots indicate ẋ∈X and ẏ∈Y), while x=x1:ℓ ∈X ℓ and y= y1:ℓ∈Y ℓ. If we assume that also ẏ follows some distribution, and start with a countable model class M of joint distributions Q(ẋ,ẏ) which contains the true joint distribution P (ẋ,ẏ), our main result implies that MDLD[(ẋ,ẏ)|D] converges to the true distribution P (ẋ,ẏ). Indeed since/if samples are assumed i.i.d., we don’t need to invoke our general result.\nDiscriminative learning. Instead of learning a generative [Jeb03] joint distribution P (ẋ,ẏ), which requires model assumptions on the input ẏ, we can discriminatively [LSS07] learn P (·|ẏ) directly without any assumption on y (not even i.i.d). We can simply treat y1:∞ as an oracle to all Q, define M\n′ = {Q′} with Q′(x) := Q(x|y1:∞), and apply our main result to M\n′, leading to MDL′x[A|x]→P ′[A|x], i.e. MDLx|y1:∞[A|x,y1:∞]→P [A|x,y1:∞]. This not yet useful since y1:∞ is never known completely. If x1,x2,... are conditionally independent, we can write\nQ(x|y) =\nℓ∏\nt=1\nQ(xt|yt) = ∑\nxℓ+1:m\nm∏\nt=1\nQ(xt|yt) = ∑\nxℓ+1:m\nQ(x1:m|y1:m) = Q(x1:ℓ|y1:m)\nTaking the limit m→∞ we get Q(x|y) =Q(x|y1:∞). This is a generic property satisfied for all causal processes, that a future yt for t > l does not influence past observations x1:ℓ. Hence for a class of conditionally independent distributions, we get MDLx|y[A|x,y]→P [A|x,y]. Since the x given y are not identically distributed, classical MDL consistency results for i.i.d. or stationary-ergodic sources do not apply. The following corollary formalizes our findings:\nCorollary 5 (Discriminative MDL) Let M ∋ P be a class of discriminative causal distributions Q[·|y1:∞], i.e. Q(x|y1:∞) =Q(x|y), where x= x1:ℓ and y = y1:ℓ.\nRegression and classification are typical examples. Further assume M is countable. Let MDLx|y := argminQ∈M{−logQ(x|y)+K(Q)} be the discriminative MDL measure (at time ℓ given x,y). Then supA ∣∣MDLx|y[A|x,y]−P [A|x,y] ∣∣→0 for ℓ(x)→∞, P [·|y1:∞] almost surely, for every sequence y1:∞.\nFor finite Y and conditionally independent x, the intuitive reason how this can work is as follows: If ẏ appears in y1:∞ only finitely often, it plays asymptotically no role; if it appears infinitely often, then P (·|ẏ) can be learned. For infinite Y and deterministic M, the result is also intelligible: Every ẏ might appear only once, but probing enough function values xt=f(yt) allows to identify the function.\nReinforcement learning (RL). In the agent framework [RN03], an agent interacts with an environment in cycles. At time t, an agent chooses an action yt based on past experience x<t≡(x1,...,xt−1) and past actions y<t with probability π(yt|x<ty<t) (say). This leads to a new perception xt with probability µ(xt|x<ty1:t) (say). Then cycle t+1 starts. Let P (xy)= ∏ℓ t=1µ(xt|x<ty1:t)π(yt|x<ty<t) be the joint interaction probability. We make no (Markov, stationarity, ergodicity) assumption on µ and π. They may be POMDPs or beyond.\nCorollary 6 (Single-agent MDL) For a fixed policy=agent π, and a class of environments {ν1,ν2,...} ∋ µ, let M= {Qi} with Qi(x|y) = ∏ℓ t=1νi(xt|x<ty1:t). Then d(P [·|y],MDLx|y)→0 with joint P -probability 1.\nThe corollary follows immediately from the previous corollary and the facts that the Qi are causal and that with P [·|y1:∞]-probability 1 ∀y1:∞ implies w.P .p.1 jointly in x and y.\nIn reinforcement learning [SB98], the perception xt := (ot,rt) consists of some regular observation ot and a reward rt∈[0,1]. Goal is to find a policy which maximizes accrued reward in the long run. The previous corollary implies\nCorollary 7 (Fixed-policy MDL value function convergence) Let VP [xy] := EP [·|xy][rℓ+1+γrℓ+2+γ\n2rℓ+3+...] be the future γ-discounted P -expected reward sum (true value of π), and similarly VQi[xy] for Qi. Then the MDL value converges to the true value, i.e. V\nMDL x|y [xy]−VP [xy]→0, w.P .p.1. for any policy π.\nProof. The corollary follows from the general inequality\n∣∣EP [f ]−EQ[f ] ∣∣ ≤ sup |f | · sup\nA\n∣∣P [A]−Q[A] ∣∣\nby inserting f :=rℓ+1+γrℓ+2+γ 2rℓ+3+... and P =P [·|xy] and Q=MDL x|y[·|xy], and using 0≤f≤1/(1−γ) and Corollary 6.\nSince the value function probes the infinite future, we really made use of our convergence result in total variation. Corollary 7 shows that MDL approximates\nthe true value asymptotically arbitrarily well. The result is weaker than it may appear. Following the policy that maximizes the estimated (MDL) value is often not a good idea, since the policy does not explore properly [Hut05]. Nevertheless, it is a reassuring non-trivial result."
    }, {
      "heading" : "7 Variations",
      "text" : "MDL is more a general principle for model selection than a uniquely defined procedure. For instance, there are crude and refined MDL [Grü07], the related MML principle [Wal05], a static, a dynamic, and a hybrid way of using MDL for prediction [PH05], and other variations. For our setup, we could have defined multi-step lookahead prediction as a product of single-step predictions:\nMDLI(x1:ℓ) := ℓ∏\nt=1\nMDLx<t(xt|x<t), MDLI(z|x) = MDLI(xz)/MDLI(x)\nwhich is a more incremental MDL version. Both, MDLx and MDLI are ‘static’ in the sense of [PH05], and each allows for a dynamic and a hybrid version. Due to its incremental nature, MDLI likely has better predictive properties than MDLx, and conveniently defines a single measure over X∞, but inconveniently is 6∈M. One reason for using MDL is that it can be computationally simpler than Bayes. E.g. if M is a class of MDPs, then MDLx is still an MDP and hence tractable, but MDLI like Bayes are a nightmare to deal with.\nAcknowledgements. My thanks go to Peter Sunehag for useful discussions."
    } ],
    "references" : [ {
      "title" : "Learning from non-IID data: Theory, Algorithms and Practice (LNIDD’09)",
      "author" : [ "M.-R. Amini", "A. Habrard", "L. Ralaivola", "N. Usunier", "editors" ],
      "venue" : "Bled, Slovenia,",
      "citeRegEx" : "Amini et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Amini et al\\.",
      "year" : 2009
    }, {
      "title" : "Logically Smooth Density Estimation",
      "author" : [ "A.R. Barron" ],
      "venue" : "PhD thesis, Stanford University,",
      "citeRegEx" : "Barron.,? \\Q1985\\E",
      "shortCiteRegEx" : "Barron.",
      "year" : 1985
    }, {
      "title" : "Minimum complexity density estimation",
      "author" : [ "A.R. Barron", "T.M. Cover" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Barron and Cover.,? \\Q1991\\E",
      "shortCiteRegEx" : "Barron and Cover.",
      "year" : 1991
    }, {
      "title" : "Merging of opinions with increasing information",
      "author" : [ "D. Blackwell", "L. Dubins" ],
      "venue" : "Annals of Mathematical Statistics,",
      "citeRegEx" : "Blackwell and Dubins.,? \\Q1962\\E",
      "shortCiteRegEx" : "Blackwell and Dubins.",
      "year" : 1962
    }, {
      "title" : "Prediction, Learning, and Games",
      "author" : [ "N. Cesa-Bianchi", "G. Lugosi" ],
      "venue" : null,
      "citeRegEx" : "Cesa.Bianchi and Lugosi.,? \\Q2006\\E",
      "shortCiteRegEx" : "Cesa.Bianchi and Lugosi.",
      "year" : 2006
    }, {
      "title" : "The Minimum Description Length Principle",
      "author" : [ "P.D. Grünwald" ],
      "venue" : null,
      "citeRegEx" : "Grünwald.,? \\Q2007\\E",
      "shortCiteRegEx" : "Grünwald.",
      "year" : 2007
    }, {
      "title" : "Convergence and loss bounds for Bayesian sequence prediction",
      "author" : [ "M. Hutter" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Hutter.,? \\Q2003\\E",
      "shortCiteRegEx" : "Hutter.",
      "year" : 2003
    }, {
      "title" : "Universal Artificial Intelligence: Sequential Decisions based on Algorithmic Probability",
      "author" : [ "M. Hutter" ],
      "venue" : null,
      "citeRegEx" : "Hutter.,? \\Q2005\\E",
      "shortCiteRegEx" : "Hutter.",
      "year" : 2005
    }, {
      "title" : "On universal prediction and Bayesian confirmation",
      "author" : [ "M. Hutter" ],
      "venue" : "Theoretical Computer Science,",
      "citeRegEx" : "Hutter.,? \\Q2007\\E",
      "shortCiteRegEx" : "Hutter.",
      "year" : 2007
    }, {
      "title" : "Machine Learning: Discriminative and Generative",
      "author" : [ "T. Jebara" ],
      "venue" : null,
      "citeRegEx" : "Jebara.,? \\Q2003\\E",
      "shortCiteRegEx" : "Jebara.",
      "year" : 2003
    }, {
      "title" : "Weak and strong merging of opinions",
      "author" : [ "E. Kalai", "E. Lehrer" ],
      "venue" : "Journal of Mathematical Economics,",
      "citeRegEx" : "Kalai and Lehrer.,? \\Q1994\\E",
      "shortCiteRegEx" : "Kalai and Lehrer.",
      "year" : 1994
    }, {
      "title" : "Discriminative learning can succeed where generative learning fails",
      "author" : [ "P. Long", "R. Servedio", "H.U. Simon" ],
      "venue" : "Information Processing Letters,",
      "citeRegEx" : "Long et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Long et al\\.",
      "year" : 2007
    }, {
      "title" : "Probability captures the logic of scientific confirmation",
      "author" : [ "P. Maher" ],
      "venue" : "Contemporary Debates in Philosophy of Science,",
      "citeRegEx" : "Maher.,? \\Q2004\\E",
      "shortCiteRegEx" : "Maher.",
      "year" : 2004
    }, {
      "title" : "Asymptotics of discrete MDL for online prediction",
      "author" : [ "J. Poland", "M. Hutter" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Poland and Hutter.,? \\Q2005\\E",
      "shortCiteRegEx" : "Poland and Hutter.",
      "year" : 2005
    }, {
      "title" : "Artificial Intelligence. A Modern Approach",
      "author" : [ "S.J. Russell", "P. Norvig" ],
      "venue" : null,
      "citeRegEx" : "Russell and Norvig.,? \\Q2003\\E",
      "shortCiteRegEx" : "Russell and Norvig.",
      "year" : 2003
    }, {
      "title" : "Characterizing predictable classes of processes",
      "author" : [ "D. Ryabko" ],
      "venue" : "In Proc. 25th Conference on Uncertainty in Artificial Intelligence (UAI’09),",
      "citeRegEx" : "Ryabko.,? \\Q2009\\E",
      "shortCiteRegEx" : "Ryabko.",
      "year" : 2009
    }, {
      "title" : "Reinforcement Learning: An Introduction",
      "author" : [ "R.S. Sutton", "A.G. Barto" ],
      "venue" : null,
      "citeRegEx" : "Sutton and Barto.,? \\Q1998\\E",
      "shortCiteRegEx" : "Sutton and Barto.",
      "year" : 1998
    }, {
      "title" : "Statistical and Inductive Inference by Minimum Message Length",
      "author" : [ "C.S. Wallace" ],
      "venue" : null,
      "citeRegEx" : "Wallace.,? \\Q2005\\E",
      "shortCiteRegEx" : "Wallace.",
      "year" : 2005
    }, {
      "title" : "Best-response multiagent learning in nonstationary environments",
      "author" : [ "M. Weinberg", "J.S. Rosenschein" ],
      "venue" : "In Proc. 3rd International Joint Conf. on Autonomous Agents & Multi Agent Systems",
      "citeRegEx" : "Weinberg and Rosenschein.,? \\Q2004\\E",
      "shortCiteRegEx" : "Weinberg and Rosenschein.",
      "year" : 2004
    } ],
    "referenceMentions" : [ ],
    "year" : 2013,
    "abstractText" : "The Minimum Description Length (MDL) principle selects the model that has the shortest code for data plus model. We show that for a countable class of models, MDL predictions are close to the true distribution in a strong sense. The result is completely general. No independence, ergodicity, stationarity, identifiability, or other assumption on the model class need to be made. More formally, we show that for any countable class of models, the distributions selected by MDL (or MAP) asymptotically predict (merge with) the true measure in the class in total variation distance. Implications for non-i.i.d. domains like time-series forecasting, discriminative learning, and reinforcement learning are discussed.",
    "creator" : "LaTeX with hyperref package"
  }
}