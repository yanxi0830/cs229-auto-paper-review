{
  "name" : "1602.03476.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Conditional Dependence via Shannon Capacity: Axioms, Estimators and Applications∗",
    "authors" : [ "Weihao Gao", "Sreeram Kannan", "Sewoong Oh", "Pramod Viswanath" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "1 Introduction\nThe axiomatic study of dependence measures on joint distributions between two random variables X and Y has a long history in statistics [Sha48, Rén59, Csi08]. In this paper, we study the relatively unexplored terrain of measures that depend only on the conditional distribution PY |X . We are motivated to study conditional dependence measures from a problem in causal strength estimation. Causal learning is a basic problem in many areas of scientific learning, where one wants to uncover the cause-effect relationship usually using interventions or sometimes directly from observational data [Pea09, RE15, MPJ+15].\nIn this paper, we are interested in an even simpler question: given a causal relationship, how does one measure the strength of the relationship. This problem arises in many contexts, for example, one may know causal genetic pathways but only a subset of these maybe active in a particular tissue or organ - therefore, deducing how much influence each causal link exerts becomes necessary.\nWe focus on a simple model: consider a pair of random variables (X,Y ) with known causal direction X → Y , and suppose that there are no confounders - we are interested in quantifying the causal influence X has on Y . We denote the causal influence quantity by C(X → Y ). There are two philosophically distinct ways to model the quantity: the first one is factual influence, i.e., how much influence does X exert on Y under the current probability of the cause X. The second possible way, which one can term as potential influence measures how much influence X can potentially exert on Y - without cognizance to the present distribution of the cause. For example, consider a (hypothetical) city which has very few smokers, but smoking inevitably leads to lung-cancer. In such a city, the factual influence of smoking on lung-cancer will be small but the potential influence is very high. Depending on the setting, one may prefer the former or the latter. In this paper, we are interested in the potential influence of a cause on its effect.\nWe want C(X → Y ) to be invariant to scaling and one-one transformations of the variables X,Y . This naturally suggests information theoretic metrics as plausible choices of C(X → Y ), starting with the mutual information I(X;Y ) = D(PXY ||PXPY ), at least in the case of factual influence. This measures the information through the channel from X → Y as given by the prior PX . Observe that this metric is ∗Parts of this manuscript has appeared in the International Conference on Machine Learning (ICML), 2016. †Department of Electrical and Computer Engineering, University of Illinois at Urbana-Champaign, email:wgao9@illinois.edu ‡Department of Electrical Engineering, University of Washington, email:ksreeram@uw.edu §Department of Industrial and Enterprise Engineering, University of Illinois at Urbana-Champaign, email:swoh@illinois.edu ¶Department of Electrical and Computer Engineering, University of Illinois at Urbana-Champaign, email:pramodv@illinois.edu\nar X\niv :1\n60 2.\n03 47\n6v 3\n[ cs\n.I T\n] 2\nJ un\n2 01\n6\nsymmetric with respect to the directions X → Y and Y → X; this property is not always desirable. In fact, this measure is taken as a starting point to develop an axiomatic approach to studying causal strength on general graphs in [JBGW+13].\nIn a recent work [KSM+14], potential causal influence is posited as a relevant metric to spot “trends” in gene pathways. In the particular application considered there, rare biological states of gene X in a given data may nevertheless correspond to important biological states (or become common under different biological conditions), and therefore it is important to have causal measures that are not sensitive to the cause distribution but only depend on the relationship between the cause and the effect. To quantify the potential influence of those rare X, the following approach is proposed. Replace the observed distribution PX by a uniform distribution UX and calculate the mutual information under the joint distribution UXPY |X . The resulting causal strength quantification is C(X → Y ) = D(UXPY |X ||PUPY ), where PY represents the distribution at the output of a channel PY |X with input given by UX . We call this quantification as Uniform Mutual Information (UMI) and pronounced “you-me”. A key challenge is to compute this quantity from i.i.d. samples in a statistical efficient manner, especially when the channel output is continuous valued (and potentially in high dimensions). This is the first focus point of this paper.\nUMI is not invariant under bijective transformations (since a uniform distribution on X is different from a uniform distribution on X3) and is also sensitive to the estimated support size of X. Even more fundamentally, it is unclear why one would prefer the uniform prior to measure potential influence through the channel PY |X . Based on natural axioms of data processing and additivity, we motivate an alternative measure of causal strength: the largest amount of information that can be sent through the channel, namely the Shannon capacity. Formally C(X → Y ) = maxQX D(QXPY |X ||QXPY ), where PY represents the distribution at the output of a channel PY |X with input given by QX . We refer to such a quantification as Capacitated Mutual Information (CMI) and pronounced “see-me”. A key challenge is to compute this quantity from i.i.d. samples in a statistical efficient manner, especially when the channel output is continuous valued (and potentially in high dimensions). This is the second focus point of this paper. We make the following main contributions in this paper.\n• UMI Estimation: We construct a novel estimator to compute UMI from data sampled i.i.d. from a distribution PXY . The estimator brings together ideas from three disparate threads in statistical estimation theory: nearest-neighbor methods, a correlation boosting idea in the estimation of (standard) mutual information from samples [KSG04], and importance sampling. The estimator has only a single hyper parameter (the number of nearest-neighbors considered, set to 4 or 5 in practice), uses an offthe-shelf kernel density estimator of only PX , and has strong connections to the entropy estimator of [KL87]. Our main technical result is to show that the estimator is consistent (in probability) supposing that the Radon-Nikodym derivative dPUdPX is uniformly bounded over the support. In simulations, the estimator has very strong performance in terms of sample complexity (compared to a baseline of the partition-based estimator in [Mod89]).\n• CMI Estimation: We build upon the estimator derived for UMI and construct an optimization problem that mimics the optimization problem inherent in computing the capacity directly from the conditional probability distribution of the channel. Our main technical result is to show the consistency of this estimator, supposing that the Radon-Nikodym derivative\ndPQ dPX\nis uniformly bounded over the support, where PQ is the optimizing input to the channel. Simulation results show strong empirical performance, compared to a baseline of a partition-based method followed by discrete optimization.\n• Application to gene pathway influence: In [KSM+14], considered an important result in single-cell flow-cytometry data analysis, a causal strength metric (termed DREMI) is proposed for measuring the causal influence of a gene – this estimator is a specific way of implementing UMI along with a “channel amplification” step, and DREMI was successfully used to spot gene-pathway trends. We show that our proposed CMI and UMI estimators also exhibit the same performance as DREMI when supplied with the full dataset, while at the same time, having significantly smaller sample complexity for the same performance.\n2 An Axiomatic Approach\nWe formally model an influence measure on conditional probability distributions, by postulating five natural axioms. Let X be drawn from an alphabet X , and Y from an alphabet Y. Let the probability distribution of Y given X be given as PY |X . Let P be a family of conditional distributions; usually we will consider the case when P is the set of all possible conditional distributions. Then the influence measure C(X → Y ) is a function of the conditional distribution to non-negative real numbers: C : P(Y|X )→ R+, and we can write C(X → Y ) as C(PY |X). We postulate that the function C satisfies five axioms on P, and show that CMI satisfies all five axioms:\n0. Independence: The measure C(PY |X) = 0 if and only if PY=y|X=x depends only on y. 1. Data Processing: If X → Y → Z be a processing chain, i.e., PZ=z|X=x = ∑ y∈Y PZ=z|Y=yPY=y|X=x,\nthen the natural data processing inequalities should hold: (a) C(PY |X) ≥ C(PZ|X); and (b) C(PZ|Y ) ≥ C(PZ|X).\n2. Additivity: For a parallel channel PY1,Y2|X1,X2 := PY1|X1PY2|X2 , we need\nC(PY1,Y2|X1,X2) = C(PY1|X1) + C(PY2|X2). (1)\n3. Monotonicity: A causal relationship is strong if many possible values of PY are achievable by varying the input probability distribution PX . Thus if we consider PY |X as a map from the probability simplex in X to the probability simplex in Y , the larger the range of this map, the stronger should be the causal strength.\n(a) C should only depend on the range of the map, Range(PY |X), the convex hull of the output distributions PY |X=x. (b) C should be a monotonic function of the range of the map. If PY |X and QY |X are such that, Range(PY |X) ⊆ Range(QY |X) then: C(PY |X) ≤ C(QY |X).\n4. Maximum value: The maximum value over all possible conditional distributions for a particular output alphabet Y should be achieved exactly when the relationship is fully causal, i.e., each Y = y can be achieved by setting X = x for some x.\nWe begin our exploration of appropriate influence measures with the alphabets for X and Y being discrete. Let I(PXY ) := D(PXY ||PXPY ) denote the mutual information with respect to the joint distribution PXY . Since we are looking at potential influence measures, Shannon capacity, defined as the maximum over input probability distributions of the mutual information, is a natural choice:\nCMI(PY |X) := max PX I(PXPY |X). (2)\nOur first claim is the following:\nProposition 1. CMI satisfies all the axioms of causal influence.\nProof: The proof is fairly straightforward.\n• Clearly Axiom 0 holds, cf. Chapter 2 of [CT12].\n• Axiom 1: Suppose CMI(PZ|X) is achieved with P ∗X . Consider the joint distribution P ∗XPY |XPZ|Y . Utilizing the data-processing inequality for mutual information, we get\nCMI(PY |X) = max PX\nI(PXPY |X) ≥ I(P ∗XPY |X)\n≥ I(P ∗XPZ|X) = CMI(PZ|X). (3)\nThus Axiom 1a is satisfied. Now consider Axiom 1b. With the same joint distribution, let P ∗Y be the marginal of Y . Then we have,\nCMI(PZ|Y ) = max PY\nI(PY PZ|Y ) ≥ I(P ∗Y PZ|Y )\n≥ I(P ∗XPZ|X) = CMI(PZ|X). (4)\n• Axiom 2: This is a standard result for Shannon capacity and we refer the interested reader to Chapter 7 of [CT12].\n• Axiom 3a: First we rewrite capacity equivalently as the information-centroid (see [CS04]):\nCMI(PY |X) := max PX min qY\nD(PY |X‖qY |PX)\n= min qY max PX\nD(PY |X‖qY |PX)\n= min qY max x\nD(PY |X=x‖qY ). (5)\nHere the conditional KL divergence D(X‖Y |Z) is defined in the usual way:\nD(X‖Y |Z) = ∑ z PZ(z) ∑ (x,y) PX|Z(x|z) log PX|Z(x|z) PY |Z(y|z) . (6)\nThis characterization allows us to make the observation that the capacity is a function only of the convex hull of the probability distributions PY |X=x. Given a conditional probability distribution PY |X , we augment the input alphabet to have one more input symbol x′ such that PY |X=x′ = ∑ x αxPY |X=x is a convex combination of the other conditional distributions. We claim that the capacity of the new channel is unchanged: one direction is obvious, i.e., the new channel has capacity greater than or equal to the original channel, since adding a new symbol cannot decrease capacity. To show the other direction, we use (5) and observe that, due to the convexity of KL divergence in its arguments, we get,\nD(PY |X=x′‖qY ) = D( ∑ x αxPY |X=x‖qY )\n≤ ∑ x αxD(PY |X=x‖qY ) ≤ max x D(PY |X=x‖qY ).\nThus Shannon capacity is only a function of the convex hull of the range of the map PY |X , satisfying Axiom 3a. This function is monotonic directly from (5), thus satisfying Axiom 3b.\n• Axiom 4: For fixed output alphabet Y, it is clear that maxX ,PY |X CMI = log |Y|. Now suppose for some conditional distribution PY |X we have CMI(PY |X) = log |Y|. This implies that, with the optimizing input distribution, H(Y ) − H(Y |X) = log |Y|. This implies that H(Y ) = log |Y| and H(Y |X) = 0, thus Y is a deterministic function of the essential support of X and since H(Y ) = log |Y|, it implies that PY = UY , the uniform distribution and the deterministic function is onto.\nAxiomatic View of UMI : Now consider an alternative metric: Uniform Mutual Information (UMI) which is defined as the mutual information with uniform input distribution,\nUMI(PY |X) := I(UXPY |X), (7)\nwhere UX is the uniform distribution on X . This estimator is motivated by the recent work in [KSM+14]. We investigate how this estimator fares in terms of the proposed axioms.\n• UMI clearly satisfies Axiom 0. It also satisfies Axioms 1a. Data-processing inequality for mutual information on the joint distribution UXPY |XPZ|Y implies that I(UXPY |X) ≥ I(UXPZ|X), which is the same as UMI(PY |X) ≥ UMI(PZ|X). Thus I(UY PZ|Y ) ≥ I(UXPZ|X).\n• UMI however does not satisfy Axiom 1b in general. However, if the transition matrices PY |X and PZ|Y are both doubly stochastic, then a straightforward calculation shows that UMI satisfies Axiom 1b too.\n• UMI satisfies Axiom 2 since the uniform distribution on X1, X2 naturally factors as UX1,X2 = UX1UX2 and we have UMI(PY1,Y2|X1,X2)\n= I(UX1,X2PY1,Y2|X1,X2) (8) = I(UX1UX2PY1|X1PY2|X2) (9) = UMI(PY1|X1) + UMI(PY2|X2). (10)\n• UMI does not satisfy Axiom 3a since multiple repeated values of PY |X=x does not alter the convex hull but alters the UMI value.\n• Interestingly, UMI does satisfy Axiom 4 for the same reason as CMI.\n2.1 Real-valued alphabets\nFor real-valued X, the Shannon mutual information is not finite without additional regularizations. This is also true of other measures of relation such as the Renyi correlation [Rén59], and in each case the measure is studied in the context of some form penalty term. Typically this is done via a cost constraint on the real-valued input parameters. In this context, one possibility is to consider the following norm-constrained optimization to ensure the causal effect is finite valued:\nCMI(PY |X , a) := max PX :E‖X‖22≤a I(PXPY |X). (11)\nIn practice, a is chosen from the empirical moments of X from samples: a := 1N ∑N i=1 ‖Xi‖22 for samples X1, . . . , XN . This regularization turns to be the so-called power constraint on the input, common in treatments of additive noise communication channels.\n3 Estimators\nAlthough the definition of UMI and CMI seamlessly applies to both discrete and continuous random variables, the estimation becomes relatively straightforward when both X and Y are discrete; the estimation of the conditional distribution PY |X and the computation of UMI and CMI can be separated in a straightforward manner. For this reason and also due to an application in genomic biology that we study, we focus on the more challenging regime Y is continuous. Due to certain subtleties in the estimation process, we provide separate estimators each customized for each case of discrete and continuous X , respectively.\n3.1 Uniform Mutual Information\nThe idea of applying UMI to infer the strength of conditional dependence was first proposed in [KSM+14]. Off-the-shelf 2-dimensional kernel density estimators (KDE) are used to first estimate the joint distribution PXY from given samples. Subsequently, the channel PY |X is computed directly from the joint distribution, and then UMI is computed via either numerical integration or sampling from UX and PY |X . This approach suffers from known drawbacks of KDE, such as sensitivity to the choice of the bandwidth and increased bias in higher dimensional X and Y . However, a more critical challenge in using KDE to estimate the joint distribution at all points (and not just at samples) is the overkill nature: we only need to compute a single functional (UMI) of the joint distribution, which could in principle be computed more efficiently directly from the samples. It is not at all clear how to directly estimate UMI.\nPerhaps surprisingly, we bring together ideas from three topics in statistical estimation to introduce novel estimators that are also provably convergent. Our estimator is based on (a) k-nearest neighbor estimators, e.g. [KL87]; (b) the correlation boosting idea of the estimator from [KSG04]–which is widely adopted in practice [KBG+07]; and (c) the importance sampling techniques to adjust for the uniform prior for UMI. We explain each idea below.\nConsider a simpler task of computing the mutual information from samples; several approaches exist for this estimation: [Pan03, KSG04, WKV09, PPS10, SRHI10, PXS12, GSG14, GSG15, KKPW15]. Note that three applications of the entropy estimator, such as those from [BDGVdM97], gives an estimate of the mutual information, i.e. Î(X;Y ) = Ĥ(X) + Ĥ(Y ) − Ĥ(X,Y ). Each entropy term can be computed using, for example, a KDE based approach, which suffers from the same challenges, as in UMI. Alternatively, to bypass estimating PXY at every point, the differential entropy estimation can be done via k nearest neighbor (kNN) methods (pioneering work in [KL87]). This KL entropy estimator provides the first step in designing the UMI estimator. However, taking the route of estimating the mutual information via estimating the three differential entropies (two marginals and one joint), it is entirely unclear how to estimate two of these quantities (differential entropy of Y and that of (U, Y )) directly from samples.\nPerhaps surprisingly, an innovative approach undertaken in [KSG04] to improve upon three applications of KL estimators provides a solution. The KSG estimator of [KSG04] is based on kNN distance ρk,i defined as the distance to the k-th nearest neighbor from (Xi, Yi) in `∞ distance, i.e. ρk,i = max{‖Xjk −Xi‖∞, ‖Yjk − Yi‖∞} where (Xjk , Yjk) is the k-th nearest neighbor to (Xi, Yi). Precisely, the KSG estimator is Î(X;Y ) =\n1\nN N∑ i=1 ( ψ(k) + ψ(N)− ψ(nx,i)− ψ(ny,i) ) , (12)\nwhere ψ(x) is the digamma function, ψ(x) = Γ′(x)/Γ(x) (for large x, ψ(x) ≈ log x− 1/(2x)), and the kNN statistics nx,i and ny,i are defined as\nnx,i ≡ ∑ j 6=i I{‖Xj −Xi‖∞ < ρk,i} , and (13)\nny,i ≡ ∑ j 6=i I{‖Yj − Yi‖∞ < ρk,i}. (14)\nNote that the number of nearest neighbors in X and Y are computed with respect to ρk,i in the joint space (X,Y ). This innovative idea, not only gives a simple estimator, but also has an advantage of canceling correlations in three entropy estimates, giving an improved performance. However, despite its popularity in practice due to its simplicity, no convergence result has been known until very recently (when [GOV16] showed some consistency and rate of convergence properties).\nInspired by the innovative mutual information estimator in (12), we combine importance sampling techniques to adjust for the uniform prior for UMI, and propose a novel estimator. On top of the provable convergence, our estimator has only one hyper-parameter k (besides the choice of bandwidth hN for estimating the marginal distribution PX which is a significantly simpler task compared to estimating the joint), which is the number of nearest neighbors to consider; in practice k is set to a small integer such as 4 or 5. Continuous X . We propose a novel UMI estimator based on the Kraskov mutual information estimator. For a conditional probability density fY |X , we want to compute the uniform mutual information from N i.i.d. samples (X1, Y1), . . . , (XN , YN ) that are generated from fY |XfX for some prior on X. Our UMI estimator is based on k nearest neighbor (kNN) statistics. Given a choice of k ∈ Z+ and N samples,\nÛMI ≡ 1 N N∑ i=1 wi ( ψ(k) + log Ncdxcdy cdx+dy nx,i ny,i ) , (15)\nwhere X ⊆ Rdx , Y ⊆ Rdy , cd = π d 2 /Γ(d2 + 1) is the volume of d-dimensional unit ball, and wi is the self-normalized importance sampling estimate [CMMR12] of u(Xi)f(Xi) :\nwi ≡ N/f̃(Xi)∑N\nj=1\n( 1/f̃(Xj) ) , (16) where f̃ : X → R is the estimate of fX(x). We use the standard kernel density estimator with a bandwidth hN :\nf̃(x) ≡ 1 NhdxN N∑ i=1 K (Xi − x hN ) . (17)\nWe define the kNN statistics nx,i and ny,i as follows. For each sample (Xi, Yi), calculate the Euclidean distance ρk,i (as opposed to the `∞ distance proposed by [KSG04]) to the k-th nearest neighbor. This determines the (random) number of samples within ρk,i in X : first nx,i is defined as the same as in (13), but with Euclidean distance; second we have a weighted number of samples within ρk,i in Y as\nny,i ≡ ∑ j 6=i wjI{‖Yj − Yi‖ < ρk,i}. (18)\nCompared to (12), we first exchange log function for the digamma functions of N , nx,i, and ny,i. This step (especially for nx,i, and ny,i) is crucial for proving convergence. We use ideas from importance sampling and introduce new variables wi’s that capture the correction for the mismatch in the prior. The constants cdx , cdy , and cdx+dy correct for the volume measured in `2.\nDiscrete X . Similarly, for a discrete random variable X, the joint probability density function is denoted by f(x, y) = pX(x)fY |X(y|x). We propose a UMI estimator, and overload the same notation for this discrete case.\nÛMI ≡ 1 N N∑ i=1 wXi ( ψ(k) + log N nXi nyi ) , (19)\nwhere nXi = |{j ∈ [N ] : j 6= i,Xj = Xi}| is the number of samples j such that Xj = Xi, wXi is the self-normalizing estimate of 1/(|X |pX(Xi)) defined as\nwx ≡ N\n|X |nx , (20)\nand ny,i is the weighted kNN statistics defined as follows. For each sample (Xi, Yi), let the distance to the k-th nearest neighbor be ρk,i, where those samples that have the same X value as Xi is considered and the Euclidean distance is measured in Y. We define the weighted number of samples within ρk,i in Y as\nny,i ≡ ∑ j 6=i wXj I{‖Yj − Yi‖ < ρk,i}. (21)\n3.2 Capacitated Mutual Information\nGiven standard estimators for mutual information and entropy, it is not at all clear how to directly estimate CMI where fX is changed to the (unknown) optimal input distribution. However, combining the mutual information estimator in (12) with importance sampling techniques, we design a novel estimator as a solution to an optimize over the space of the weights. Our estimator has only one hyper-parameter k, the number of nearest neighbors to consider. Continuous X . For a conditional distribution fY |X , we compute an estimate of CMI from i.i.d. samples (X1, Y1), . . . , (XN , YN ) generated from fY |XfX for some prior on X. We introduce a novel CMI estimator that is based on our UMI estimator. Given a choice of k ∈ Z+ and N samples, the estimated CMI is the solution of the following constrained optimization:\nĈMI = max w∈Ta,N\n1\nN N∑ i=1 wi ( ψ(k) + log( Ncdxcdy cdx+dynx,iny,i ) ) ,\nwhere dx, dy, nx,i, ny,i and cd are defined in the same as in (15). We optimize over w1, . . . , wN under the second moment constraint, i.e. Ta,N = {w ∈ RN |wi ≥ 0,∀i ∈ [N ], (1/N) ∑N i=1 wi = 1, (1/N) ∑N i=1 wi‖Xi‖2 ≤ a2}. Observe that no KDE of PX is needed for CMI estimation, making it particularly simple and robust. Discrete X . Similarly, we define the CMI estimate ĈMI as the solution of the following constrained optimization:\nĈMI = max w∈T∆\n1\nN N∑ i=1 wXi ( ψ(k) + log( N nx,iny,i ) )\nwhere nx,i and ny,i are defined in (19). T∆ is the set of quantized version of an interval [C1, C2] with step size ∆, i.e. T∆ = { w ∈ {C1 + mi∆}|X | ∣∣(1/N)∑|X |x=1 wx ∈ [1 − |X |∆, 1 + |X |∆], and mi ∈ {0, 1, . . . , d(C2 − C1)/C1e} for all i } . Such a quantization is crucial in proving consistence in Theorem 2.\n4 Convergence Guarantees\nWe show both the proposed UMI and CMI estimators are consistent under typical assumptions on the distribution. While consistency of estimators in the large sample limit is generally only a (basic) first step in understanding their properties, this is not so for fixed-k nearest neighbor based estimators. As far as we know, the only estimator based on fixed-k nearest neighbors that is known to be consistent is the entropy estimator of [KL87], and the convergence rate is only known for the univariate case [TVdM96] (and that too under significant assumptions on the univariate density). Our result below for the consistency of the UMI estimator for discrete alphabet marks another instance where consistency of fixed-k nearest neighbor based estimators is established.\nUniform Mutual Information: As our estimators use the off-the-shelf kernel density estimator of PX [DP84, SJ91] and also the ides from the nearest-neighbor methods [KL87], we make assumptions on the conditional density fY |X that are typical in these literature. One extra assumption we make for UMI is that the Radon-Nikodym derivative dPUdPX is uniformly bounded over the support. This is necessary for controlling the importance-sampling estimates of wi’s. We refer to the Assumption 1 in the supplementary material for a precise description.\nTheorem 1. Under the Assumption 1 in the supplementary material, the UMI estimator converges to the true value in probability, i.e. for all ε > 0 and all δ > 0,\nlim N→∞\nP ( ∣∣ÛMI−UMI(fY |X)∣∣ > ε ) = 0 , (22)\nif k > max{dy/dx, dx/dy} for continuous X and (logN)(1+δ)dy < k < √ N/(5 logN) for discrete X.\nIn practice, we regularize the kNN distance ρk,i in case it is much smaller than the expected distance of order N−1/(dx+dy). For continuous X , we require k to be larger than the ratio of the dimensions, which is a finite constant. For discrete X , however, the effective dimension of X is zero, which makes the ratio dy/dx unbounded. Hence, for concentration of measure to hold, we need k1/dy scaling at least logarithmically in the number of samples N .\nCapacitated Mutual Information: We make analogous assumptions which are described precisely in Assumption 2 in the supplementary material. The following theorem establishes consistency of our estimator when X is discrete and we quantize Y. Our analysis requires uniform convergence over all possible choices of the weights w, making the quantization step inevitable; improvements on this technical condition are natural future steps.\nTheorem 2. Under the Assumption 2 in the supplementary material, the CMI estimator converges in probability to the true value up to the resolution of the quantization, i.e. if k > (logN)(1+δ)dy for some δ > 0, and k < √ N/(5 logN), for all ε > 0 and ∆ > 0 and s(∆) = O(∆)\nlim N→∞\nP ( ∣∣ĈMI− CMI(fY |X)∣∣ > ε+ s(∆) ) = 0.\n5 Numerical Experiments\n5.1 Gene Causal Strength from Single Cell Data\nWe briefly describe the setup of [KSM+14] to motivate our numerical experiments. Consider a simple genetic pathway: a cascade of genes having expression values X,Y, Z which interact linearly, i.e., X → Y → Z. A key question of interest in this case is how the signaling in the pathway varies in different conditions of intervention. Let T denote the time after the intervention (for example, after giving a certain drug). Then we may want to compare the strength of the causal relationship between two genes at different times after the intervention. In the experiments, usually samples are taken at very few time points, so T has very small cardinality (for example, before the drug, 10 minutes after the drug and 50 minutes after the drug), but at each given time point, many cells are interrogated so we get samples from the distribution\nPX,Y,Z;T=t = P (Y |X;T = t)P (Z|Y ;T = t). For each value of T = t, we observe Nt i.i.d. samples (Xi, Yi, Zi), for i = 1, 2, ..., Nt sampled from PX,Y,Z;T=t. These samples are obtained using a technique called single-cell mass flow cytometry, see [KSM+14] for details. We are interested in obtaining a causal measure C(X → Y ;T = t) = C(P (Y |X;T = t)) and another measure C(Y → Z;T = t) = C(P (Z|Y ;T = t)) for each time point t. This measure serves as a high level summary of how signaling proceeds in the cascade as a function of time, and lets one compare the strengths of a given causal relationship at different points after intervention.\nIf the drug indeed activates the causal pathway, one may expect the causal relationship to follow a certain trend, i.e., at earlier t, the strength of C(X → Y ;T = t) will be high and at a later value of t, the strength of C(Y → Z;T = t) will be high before the effect of the drug wears off, at which time we expect all the relationships to fall back to its low nominal value. Such an analysis is conducted in [KSM+14] where the causal strength function C is evaluated via the so-called DREMI estimator (essentially a version of UMI estimation with a “channel amplification” step and careful choice of hyper parameters therein – no theoretical properties of this estimator were evaluated). In that paper, it is shown that, for two example pathways, DREMI recovers the correct trend, i.e., it correctly identifies the time at which each causal relationship is expected to peak as per prior biological knowledge. This demonstrates the utility of DREMI for causal strength inference in gene networks (see Figure 6 of [KSM+14]). The authors there also demonstrate that other metrics which depend on the whole joint distribution, such as mutual information, maximal information coefficient, and correlation do not capture the trend. As an aside, we note that a somewhat different set of “trend spotting” estimators, primarily trying to find genes which demonstrate a monotonic trend over time from single-cell RNA-sequencing data, have been proposed very recently in [MJG15].\nIn this paper, we have studied influence measures axiomatically and proposed the UMI and CMI measures. It is natural to apply our estimators to each time point in the same setting as [KSM+14] – and look to understand two distinct issues in our experiments with the flow-cytometry data. The first is whether the proposed quantities of UMI and CMI are able to capture the same biological trend as DREMI was able to. The second question relates to the sample complexity: how does the ability to recover the trend vary as a function of the sample complexity? To study this, we subsample the original data from [KSM+14] multiple times (100 in the experiments) at each subsampling ratio and compute the fraction of times we recover the true biological trend. This is plotted in Figure 1. The figure demonstrates that when the whole dataset is made available, UMI and CMI are able to spot the trend correctly (just as DREMI does). When fewer samples are available, UMI uniformly dominates DREMI and, in turn, CMI uniformly dominates UMI in terms of capturing the biological trend as a function of number of samples available. We believe that this strong empirical evidence lends credence to our approach. For completeness, we note that the datasets represented in Figure 1 refer to regular T-cells (left figure) and T-cells exposed with an antigen (right figure), for which we expect different biological trends, but both of which are correctly captured by our metrics.\n5.2 Synthetic data\nWe demonstrate the accuracy of the proposed UMI and CMI estimators on synthetic experiments. We generate N samples from PXY where X is distributed as beta distribution Beta(1.5, 1.5) and Y = X + N , N ∼ N (0, σ2), independent of X. We present three results with varying σ2 ∈ {0.09, 0.36, 1.0}. Figure\n2 shows the estimate of UMI, averaged over 100 instances. This is compared to the ground truth and the state-of-the-art partition based estimators from [Mod89]. The ground truth has been computed via simulations with 8192 samples from the desired distribution PY |XUX using Kraskov’s mutual information estimator [KSG04]. For CMI, we use exactly the same distribution PXY as in UMI, but with varying σ2 ∈ {0.36, 1.0, 2.25}, which is illustrated in Figure 3. Under the power constraint, the ground truth is given by 12 log(1 + σ2X σ2N ) = 12 log(1 + 1/16σ 2). The proposed CMI estimator is compared against BlahutArimoto algorithm [Bla72, Ari72] for computing discrete channel capacity, applied to quantized data. Both figures illustrate that the proposed estimators significantly improves over the state-of-the-art partition based methods, in terms of sample complexity.\n6 Discussion\nIn this paper we have proposed novel information theoretic measures of potential influence of one variable on another, as well as provided novel estimators to compute the measures from i.i.d. samples. The technical innovation has been in proposing these estimators, by combining separate threads of ideas in statistics (including importance sampling and nearest-neighbor methods). The consistency proofs suggest that a similar analysis the very popular estimator of (traditional) mutual information in [KSG04] can be conducted successfully; such work has been recently conducted in [GOV16]. Several other issues in statistical estimation theory intersect with our current work and we discuss some of these topics below.\n(a) The main technical results of this paper have been weak consistency of the proposed estimators. Proving stronger consistency guarantees and rates of convergence would be natural improvements, albeit challenging ones. Rates of convergence in the nearest-neighbor methods are barely known in the literature even for traditional information theoretic quantities: for instance, [TVdM96] derives a √ N consistency for the single dimensional case of differential entropy estimation (under strong assumptions on the underlying\npdf), leaving higher dimensional scenarios open, and which recently have been successfully addressed in [GOV16].\n(b) There is a natural generalization of our estimators when the alphabet Y is high dimensional, using the kNN approach (just as in the differential entropy estimator of [KL87] or in the mutual information estimator of [KSG04]). However, very recent works [GSG14, GSG15, LP16] have shown that boundary biases common in high dimensional scenarios is much better handled using local parametric methods (as in [L+96, HJ96]). Adapting these approaches to the estimators for UMI and CMI is an interesting direction of future research.\n(c) We have considered both the case of discrete and (single dimensional) continuous alphabet X . The scenario of high dimensional X is significantly more challenging for CMI estimation: this is because of the (vastly) expanded space of distributions over which the optimization can be performed. Also challenging is to consider application specific regularization of the inputs in this scenario.\n(d) While the focus of this paper has been on quantifying potential causal influence, a related question involves testing the direction of causality for a pair of random variables. This is a widely studied topic with a long lineage [Pea09] but also of strong topical interest [JBGW+13, JSSS15, MPJ+15, SJSB15]. A natural inclination is to explore the efficacy of UMI and CMI measures to test for direction of causality – especially in the context of the benchmark data sets collected in [MPJ+15]. Our results are as follows: UMI has a 45% probability to predict the correct direction. CMI gives 53% probability. Directly comparing the marginal entropy H(X) and H(Y ) by the estimator in [KL87] also only provides 45% accuracy. While in [MPJ+15], different entropy estimators (with appropriate hyper parameter choices) were applied to get an accuracy up to 60%-70%. Further research is needed to shed conclusive light, although we point out that the benchmark data sets in [MPJ+15] have substantial confounding factors that make causal direction hard to measure in the first place.\n(e) The axiomatic derivation of potential causal influence naturally suggests CMI as an appropriate measure. We are also able to show that a more general quantity – the so-called Rényi capacity – also meets the axioms. For any λ > 0, λ 6= 1, define Rényi entropy as\nHλ(P ) := 1\nλ− 1 logEP [(dP )λ] (23)\nand Rényi divergence as:\nDλ(P‖Q) := 1\nλ− 1 logEQ\n[( dP\ndQ\n)λ] . (24)\nNow define the asymmetric information measure [Csi95]:\nKλ(PXPY |X) := inf QY\nDλ(PXY ‖PXQY ), (25)\nwhich converges to the traditional mutual information when λ → 1. Now we can define the Rényi capacity for any parameter λ as, for any fixed conditional distribution PY |X :\nCMIλ := sup PX inf QY\nDλ(PXY ‖PXQY ), (26)\nObserve that as λ→ 1, we have CMIλ → CMI, the traditional Shannon capacity. We observe the following. Proposition 2. For any λ > 0, λ 6= 1 we have that CMIλ satisfies the axioms in Section 2.\nThe proof is available in Appendix D. In the light of this result, it would be interesting to design estimators for the more general family of Rényi capacity measures and confirm their performance on empirical tasks such as the ones studied in [KSM+14]. It would also be very interesting to understand the role of additional axioms that would lead to uniqueness of Shannon capacity (in the same spirit as entropy being uniquely characterized by somewhat similar axioms [Csi08]).\n(f) Finally, a comment on the optimization problem in CMI estimation: the optimization problem involving the wi’s is not necessarily a concave program for a given sample realization, although this program converges to that of Shannon capacity computation involves maximizing mutual information, which is a concave function of the input probability distribution. Standard (stochastic) gradient decent is used in our experiments, and we did not face any disparity in convergent values over the set of synthetic experiments we conducted.\nAcknowledgements\nThis work is supported in part by ARO W911NF1410220, NSF SaTC award CNS-1527754, NSF CISE award CCF-1553452 and a University of Washington startup grant.\nReferences\n[Ari72] Suguru Arimoto. An algorithm for computing the capacity of arbitrary discrete memoryless channels. Information Theory, IEEE Transactions on, 18(1):14–20, 1972.\n[BDGVdM97] Jan Beirlant, Edward J Dudewicz, László Györfi, and Edward C Van der Meulen. Nonparametric entropy estimation: An overview. International Journal of Mathematical and Statistical Sciences, 6(1):17–39, 1997.\n[Bla72] Richard E Blahut. Computation of channel capacity and rate-distortion functions. Information Theory, IEEE Transactions on, 18(4):460–473, 1972.\n[CMMR12] Jean Cornuet, Jean-Michel Marin, Antonietta Mira, and Christian P Robert. Adaptive multiple importance sampling. Scandinavian Journal of Statistics, 39(4):798–812, 2012.\n[CS04] Imre Csiszár and Paul C Shields. Information theory and statistics: A tutorial. Now Publishers Inc, 2004.\n[Csi95] Imre Csiszár. Generalized cutoff rates and renyi’s information measures. Information Theory, IEEE Transactions on, 41(1):26–34, 1995.\n[Csi08] Imre Csiszár. Axiomatic characterizations of information measures. Entropy, 10(3):261–273, 2008.\n[CT12] Thomas M Cover and Joy A Thomas. Elements of information theory. John Wiley & Sons, 2012.\n[DP84] Luc Devroye and Clark S Penrod. The consistency of automatic kernel density estimates. The Annals of Statistics, pages 1231–1249, 1984.\n[GOV16] Weihao Gao, Sewoong Oh, and Pramod Viswanath. Demystifying fixed k-nearest neighbor information estimators. arXiv preprint arXiv:1604.03006, 2016.\n[GSG14] Shuyang Gao, Greg Ver Steeg, and Aram Galstyan. Efficient estimation of mutual information for strongly dependent variables. arXiv preprint arXiv:1411.2003, 2014.\n[GSG15] Shuyang Gao, Greg Ver Steeg, and Aram Galstyan. Estimating mutual information by local gaussian approximation. arXiv preprint arXiv:1508.00536, 2015.\n[HJ96] Nils Lid Hjort and MC Jones. Locally parametric nonparametric density estimation. The Annals of Statistics, pages 1619–1647, 1996.\n[HV15] Siu-Wai Ho and Sergio Verdú. Convexity/concavity of renyi entropy and α-mutual information. In Information Theory (ISIT), 2015 IEEE International Symposium on, pages 745–749. IEEE, 2015.\n[JBGW+13] Dominik Janzing, David Balduzzi, Moritz Grosse-Wentrup, Bernhard Schölkopf, et al. Quantifying causal influences. The Annals of Statistics, 41(5):2324–2358, 2013.\n[JSSS15] D. Janzing, B. Steudel, N. Shajarisales, and B. Schölkopf. Justifying Information-Geometric Causal Inference, chapter 18, pages 253–265. Springer International Publishing, 2015.\n[KBG+07] Shiraj Khan, Sharba Bandyopadhyay, Auroop R Ganguly, Sunil Saigal, David J Erickson III, Vladimir Protopopescu, and George Ostrouchov. Relative performance of mutual information estimation methods for quantifying the dependence among short and noisy data. Physical Review E, 76(2):026209, 2007.\n[KKPW15] Kirthevasan Kandasamy, Akshay Krishnamurthy, Barnabas Poczos, and Larry Wasserman. Nonparametric von mises estimators for entropies, divergences and mutual informations. In Advances in Neural Information Processing Systems, pages 397–405, 2015.\n[KL87] LF Kozachenko and Nikolai N Leonenko. Sample estimate of the entropy of a random vector. Problemy Peredachi Informatsii, 23(2):9–16, 1987.\n[KSG04] A. Kraskov, H. Stögbauer, and P. Grassberger. Estimating mutual information. Physical review E, 69(6):066138, 2004.\n[KSM+14] Smita Krishnaswamy, Matthew H Spitzer, Michael Mingueneau, Sean C Bendall, Oren Litvin, Erica Stone, Dana Pe’er, and Garry P Nolan. Conditional density-based analysis of t cell signaling in single-cell data. Science, 346(6213):1250689, 2014.\n[L+96] Clive R Loader et al. Local likelihood density estimation. The Annals of Statistics, 24(4):1602– 1618, 1996.\n[LP16] Damiano Lombardi and Sanjay Pant. Nonparametric k-nearest-neighbor entropy estimator. Physical Review E, 93(1):013310, 2016.\n[MJG15] Jonas Mueller, Tommi Jaakkola, and David Gifford. Modeling trends in distributions. arXiv preprint arXiv:1511.04486, 2015.\n[Mod89] Rudy Moddemeijer. On estimation of entropy and mutual information of continuous distributions. Signal processing, 16(3):233–248, 1989.\n[MPJ+15] J.M. Mooij, J. Peters, D. Janzing, J. Zscheischler, and B. Schölkopf. Distinguishing cause from effect using observational data: methods and benchmarks. Journal of Machine Learning Research, 2015.\n[Owe13] Art B. Owen. Monte Carlo theory, methods and examples. 2013.\n[Pan03] Liam Paninski. Estimation of entropy and mutual information. Neural computation, 15(6):1191–1253, 2003.\n[Pea09] Judea Pearl. Causality. Cambridge university press, 2009.\n[PPS10] Dávid Pál, Barnabás Póczos, and Csaba Szepesvári. Estimation of rényi entropy and mutual information based on generalized nearest-neighbor graphs. In Advances in Neural Information Processing Systems, pages 1849–1857, 2010.\n[PV10] Yury Polyanskiy and Sergio Verdú. Arimoto channel coding converse and rényi divergence. In Communication, Control, and Computing (Allerton), 2010 48th Annual Allerton Conference on, pages 1327–1333. IEEE, 2010.\n[PXS12] Barnabás Póczos, Liang Xiong, and Jeff Schneider. Nonparametric divergence estimation with applications to machine learning on distributions. arXiv preprint arXiv:1202.3758, 2012.\n[RE15] Robin J Richardson and Thomas S Evans. Non-parametric causal models. 2015.\n[Rén59] Alfréd Rényi. On measures of dependence. Acta mathematica hungarica, 10(3-4):441–451, 1959.\n[Sha48] C.E. Shannon. A mathematical theory of communication. Bell System Tech. J., 27:379423 and 623656, 1948.\n[SJ91] Simon J Sheather and Michael C Jones. A reliable data-based bandwidth selection method for kernel density estimation. Journal of the Royal Statistical Society. Series B (Methodological), pages 683–690, 1991.\n[SJSB15] N. Shajarisales, D. Janzing, B. Schölkopf, and M. Besserve. Telling cause from effect in deterministic linear dynamical systems. In Proceedings of the 32nd International Conference on Machine Learning, volume 37 of JMLR Workshop and Conference Proceedings, page 285?294. JMLR, 2015.\n[SMH+03] Harshinder Singh, Neeraj Misra, Vladimir Hnizdo, Adam Fedorowicz, and Eugene Demchuk. Nearest neighbor estimates of entropy. American journal of mathematical and management sciences, 23(3-4):301–321, 2003.\n[SRHI10] Kumar Sricharan, Raviv Raich, and Alfred O Hero III. Empirical estimation of entropy functionals with confidence. arXiv preprint arXiv:1012.4188, 2010.\n[TVdM96] Alexandre B Tsybakov and EC Van der Meulen. Root-n consistent estimators of entropy for densities with unbounded support. Scandinavian Journal of Statistics, pages 75–83, 1996.\n[VEH14] Tim Van Erven and Peter Harremoës. Rényi divergence and kullback-leibler divergence. Information Theory, IEEE Transactions on, 60(7):3797–3820, 2014.\n[WKV09] Qing Wang, Sanjeev R Kulkarni, and Sergio Verdú. Divergence estimation for multidimensional densities via-nearest-neighbor distances. Information Theory, IEEE Transactions on, 55(5):2392–2405, 2009.\nAppendix\nA Proof of the UMI estimator convergence in Theorem 1\nWe present the proof of the theorem for two separate UMI estimators: first for continuous X and next for discrete X. We first state the formal assumptions under which the theorem holds.\nAssumption 1. For continuous X , define fU (y) ≡ ∫ x u(x)fY |X(y|x)dx, (27)\nfU (x ∣∣y) ≡ u(x)fY |X(y|x)\nfU (y) . (28)\nWe make the following assumptions: (a) ∫ fX,Y (x, y) ( log f(x, y) )2 dxdy <∞.\n(b) There exists a finite constant C such that the Hessian matrix of H(f) and H(fU ) exists and max{‖H(f)‖2, ‖H(fU )‖2} < C almost everywhere.\n(c) There exists a positive constant C ′ such that the conditional pdfs satisfy fY |X(y ∣∣x) < C ′ and fU (x∣∣y) <\nC ′ almost everywhere.\n(d) There exist positive constants C1 < C2 such that the marginal pdf satisfy, almost everywhere,\nC1 µ(X ) < fX(x) < C2 µ(X ) .\n(e) The bandwidth hN of kernel density estimator is chosen as hN = 1 2N −1/(2dx+3).\nFor discrete X , define\nfu(y) ≡ ∑ x∈X 1 |X | fY |X(y|x). (29)\nWe make the following assumptions: (a) ∫ fY |X(y|x) ( log fY |X(y|x) )2 dy <∞, for all x ∈ X .\n(b) There exists a finite constant C such that the Hessian matrix of H(fY |X) exists and ‖H(fY |X)‖2 < C almost everywhere, for all x ∈ X .\n(c) There exists a finite constant C ′ such that the conditional pdf fY |X(y ∣∣x) < C ′ almost everywhere, for\nall x ∈ X .\n(d) There exists finite constants C1 < C2 such that the prior pX(x) > C1/|X | and fX(x) < C2/|X | almost everywhere.\nA.1 The case of continuous X Given these assumptions, we define\ng(Xi, Yi) ≡ ψ(k) + log(N) + log ( cdxcdy cdx+dy ) − ( log(nx,i) + log(ny,i) )\n(30)\nsuch that ÎUk,N (X,Y ) = 1 N ∑N i=1 wi g(Xi, Yi). Define each quantity with the true prior fX(x) as\nw′i ≡ u(Xi)\nfX(Xi) , (31) n′y,i ≡ ∑ j 6=i w′jI{‖Yj − Yi‖ < ρk,i} , (32)\ng′(Xi, Yi) ≡ ψ(k) + log(N) + log ( cdxcdy cdx+dy ) − ( log(nx,i) + log(n ′ y,i) ) . (33)\nWith UX equal to the uniform distribution on the support of X, we apply the triangle inequality to show that each term converges to zero in probability.\n∣∣ÎUk,N (X,Y )− IU (fY |X)∣∣ = ∣∣∣ 1N N∑ i=1 wig(Xi, Yi)− ∫∫ u(x)fY |X(y|x) log fY |X(y|x)∫ u(x′)fY |X(y|x′)dx′ dxdy ∣∣∣ ≤ 1\nN ∣∣∣ N∑ i=1 ( wig(Xi, Yi)− w′ig′(Xi, Yi) )∣∣∣+ (34) ∣∣∣ 1 N N∑ i=1 w′ig ′(Xi, Yi)− ∫∫ u(x)fY |X(y|x) log fY |X(y|x)∫ u(x′)fY |X(y|x′)dx′ dxdy ∣∣∣.(35)\nThe first term (34) captures the error in the kernel density estimator and we have the following claim, whose proof is delegated to Appendix C.\nLemma 1. The term in Equation (34) converges to 0 as N →∞ in probability.\nThe second term in the error (35) comes from the sample noise in density estimation. Similar to the decomposition of mutual information, I(X;Y ) = H(X) + H(Y ) − H(X,Y ), we decompose our estimator into three terms:\n1\nN N∑ i=1 w′ig ′(Xi, Yi) = Ĥ U k,N (X) + Ĥ U k,N (Y )− ĤUk,N (X,Y )− N∑ i=1 w′i N (2 log(N − 1)− ψ(N)− log(N)) ,\nwhere\nĤUk,N (X,Y ) ≡ N∑ i=1 w′i N ( − ψ(k) + ψ(N) + log cdx+dy + (dx + dy) log ρk,i ) , (36)\nĤUk,N (X) ≡ N∑ i=1 w′i N ( − log nx,i + log(N − 1) + log cdx + dx log ρk,i ) , (37)\nĤUk,N (Y ) ≡ N∑ i=1 w′i N ( − log ny,i + log(N − 1) + log cdy + dy log ρk,i ) . (38)\nNotice that ∑N i=1 w′i N (2 log(N −1)−ψ(N)− log(N)) goes to 0 as N goes to infinity. The desired claim follows directly from the following two lemmas showing the convergence each entropy estimates to corresponding entropies under UMI.\nLemma 2. Under the hypotheses of Theorem 1, for all ε > 0\nlim N→∞\nP ( ∣∣∣ĤUk,N (X,Y )− ( − ∫∫ u(x)fY |X(y|x) log fY |X(y|x)u(x)dxdy )∣∣∣ > ε) = 0 . (39)\nLemma 3. Under the hypotheses of Theorem 1, for all ε > 0\nlim N→∞\nP ( ∣∣∣ĤUk,N (X) + ĤUk,N (Y )− ( − ∫∫ u(x)fY |X(y|x)( log fX(x) + fU (y))dxdy )∣∣∣ > ε) = 0 , (40)\nwhere fU (y) = ∫ fY |X(y|x)u(x)dx.\nA crucial technical idea in proving these lemmas is the concept of importance sampling. For any function h(Xi, Yi), the importance sampling estimate of E[h] is given by\nh̃N = 1\nN N∑ i=1 w′ih(Xi, Yi) , (41)\nwhere w′i = Nu(Xi)/f(Xi). The following lemma gives the almost sure convergence of h̃n. Lemma 4 (Theorem 9.1 in [Owe13]). Assume E[h] = ∫∫\nu(x)fY |X(y|x)h(x, y)dxdy exists, then\nP (\nlim n→∞\nh̃n = E[h] ) = 1 .\nA.1.1 Proof of Lemma 10\nGiven Xi = x, denote aj = 1\nhdxN K(\nXj−x hN ) such that f̃X(Xi) = 1 N ∑N j=1 aj . For sufficiently small hN , the\nmean of aj is given by: E[aj ] = ∫ z∈RdX 1 hdxN K( z −Xi hN )fX(z)dz\n= ∫ u∈RdX K(u)fX(x+ hNu)du\n= ∫ u∈RdX K(u) ( fX(x) + hNu T∇fX(x) + h2NuTH(fX)(x)u+ o(h2N ))du\n= fX(x) + h 2 NC ∫ u∈RdX ‖u‖2K(u)du+ o(h2N ) , (42)\nwhere we used the fact that the kernel is centered such that ∫ K(u)aTudu = 0. For sufficiently small hN , we obtain |E[aj ]− fX(x)| < hN . Therefore,\nP ( ∣∣ f̃X(Xi)− fX(Xi) ∣∣ > N−1/(2dx+3)∣∣∣Xi = x)\n≤ P ( ∣∣ N∑\nj=1\naj −NfX(Xi) ∣∣ > N (2dx+2)/(2dx+3)∣∣∣Xi = x)\n≤ P ( ∣∣ ∑\nj 6=i\naj − (N − 1)E[aj ] ∣∣ > N (2dx+2)/(2dx+3) − ∣∣ai −NfX(x) + (N − 1)E[aj ]∣∣∣∣∣Xi = x). (43)\nSince ai is bounded by A/h dx N , by choosing hN = 1 2N − 12dx+3 , the right hand side is lower bounded by:\nN (2dx+2)/(2dx+3) − ∣∣ai −NfX(x) + (N − 1)E[aj ]∣∣\n≥ N (2dx+2)/(2dx+3) − |ai − fX(x)| − (N − 1)|E[aj ]− fX(x)| ≥ N (2dx+2)/(2dx+3) −A/hdxN −NhN ≥ 1 3 N (2dx+2)/(2dx+3). (44)\nSince for j 6= i, a′js are i.i.d and bounded by A/h dx N , by Hoeffding’s inequality, we obtain\nP ( ∣∣ ∑\nj 6=i\naj − (N − 1)E[aj ] ∣∣ > N (2dx+2)/(2dx+3) − ∣∣ai −NfX(x) + (N − 1)E[aj ]∣∣∣∣∣Xi = x)\n≤ P ( ∣∣ ∑\nj 6=i\naj − (N − 1)E[aj ] ∣∣ > 1\n3 N (2dx+2)/(2dx+3) ∣∣∣Xi = x) ≤ 2 exp{−2 ( 13N (2dx+2)/(2dx+3))2\n(N − 1) ·A2h−2dxN }\n≤ 2 exp{− 2 9A2(N − 1) (N (2dx+2)/(2dx+3)hdxN ) 2}\n≤ 2 exp{−N 1/(2dx+3)\n9A2 }. (45)\nSince this upper bound is independent of x, we can take expectation over x to obtain the desired claim.\nA.1.2 Proof of Lemma 2\nDefine\nf̂X,Y (Xi, Yi) = exp{ψ(k)− ψ(N)} cdx+dyρ dx+dy k,i , (46)\nso that\nĤUk,N (X,Y ) = − N∑ i=1 w′i N log f̂X,Y (Xi, Yi) . (47)\nBy Theorem 8 of [SMH+03], we have\nlim N→∞\nE [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)] = log fX,Y (x, y) . (48)\nNotice that w′i log f̂(Xi, Yi) are identically distributed, therefore, by plugging in w ′ i = u(Xi)/fX(Xi), we have\nlim N→∞\nEĤUk,N (X,Y )\n= − lim N→∞ E[w′i log f̂X,Y (Xi, Yi)]\n= − lim N→∞ ∫∫ E [ u(Xi) fX(Xi) log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]fX,Y (x, y)dxdy\n= − lim N→∞\n∫∫ u(x)fY |X(y|x)E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]dxdy. (49) Now we want to show that\nlim N→∞\n∫∫ u(x)fY |X(y|x)E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]dxdy = ∫∫ u(x)fY |X(y|x) ( lim N→∞ E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)] )dxdy\n= ∫∫ u(x)fY |X(y|x) log fX,Y (x, y)dxdy , (50)\nwhich follows from the reverse Fatou’s lemma and the fact that\nlim sup N→∞ ∫∫ ∣∣ u(x) f(x) E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)] ∣∣2f(x, y)dxdy\n≤ C−21 lim sup N→∞ ∫∫ ∣∣E[ log f̂X,Y (Xi, Yi)∣∣(Xi, Yi) = (x, y)] ∣∣2f(x, y)dxdy ≤ C−21 ∫∫ lim sup N→∞\n∣∣E[ log f̂X,Y (Xi, Yi)∣∣(Xi, Yi) = (x, y)] ∣∣2f(x, y)dxdy ≤ C−21 ∫∫ lim sup N→∞ ( log fX,Y (x, y) )2 f(x, y)dxdy < +∞ . (51)\nAs explained in the main result section, we regularize the kNN distance such that ρ dx+dy k,i > Ck/N for some positive constant C. This ensures that log f̂X,Y (Xi, Yi) < C ′ almost surely. It follows that E[log f̂X,Y (Xi, Yi)|Xi = x, Yi = y] < C ′ and one can apply reverse Fatou’s lemma. Similar interchange of limit has been used in [KL87, WKV09] without the regularization; in this context [PPS10] claims that this step is not justified (although no counterexample is pointed out). But in our case given the practical way the algorithm is implemented with the regularization, reverse Fatou’s lemma is justified. Therefore,\nlim N→∞\nEĤUk,N (X,Y ) = − ∫∫ u(x)fY |X(y|x) log fX,Y (x, y)dxdy. (52)\nMoreover, by Theorem11 of [SMH+03], we have:\nlim N→∞\nVar[f̂X,Y (Xi, Yi)] = ( Γ′(k)\nΓ(k) )′Var[log fX,Y (x, y)] , (53)\nand for any j 6= i:\nlim N→∞ Cov[f̂X,Y (Xi, Yi), f̂X,Y (Xj , Yj)] = 0 . (54)\nBy w′i ≤ 1/C1 for all i and the fact that f̂X,Y (Xi, Yi) are identically distributed, we have: Var [ ĤUk,N (X,Y ) ] =\nN∑ i=1 (w′i) 2 N2 Var[f̂X,Y (Xi, Yi)] + ∑ j 6=i w′iw ′ j N2 Cov[f̂X,Y (Xi, Yi), f̂X,Y (Xj , Yj)]\n≤ N∑ i=1 1 C21N 2 Var[f̂X,Y (Xi, Yi)] + ∑ j 6=i 1 C21N 2 Cov[f̂X,Y (Xi, Yi), f̂X,Y (Xj , Yj)]\n= 1\nC21N ((\nΓ′(k) Γ(k) )′Var[log fX,Y (x, y)]) + 1\nC21N 2\n( N\n2\n) Cov[f̂X,Y (X1, Y1), f̂X,Y (X2, Y2)] . (55)\nTherefore,\nlim N→∞\nVar [ ĤUk,N (X,Y ) ] = 0 . (56)\nCombining (52) and (56), we get:\nlim N→∞\nE [( ĤUk,N (X,Y )− ( − ∫∫ u(x)fY |X(y|x) log fX,Y (x, y)dxdy ))2]\n= lim N→∞\nVar [ ĤUk,N (X,Y ) ] + lim N→∞ ( EĤUk,N (X,Y )− ( − ∫∫ u(x)fY |X(y|x) log fX,Y (x, y)dxdy ))2\n= 0. (57)\nTherefore, ĤUk,N (X,Y ) converges to its mean in L 2, and hence in probability, i.e.,\nlim N→∞\nP ( ∣∣ĤUk,N (X,Y )− ( − ∫∫ u(x)fY |X(y|x) log fX,Y (x, y)dxdy )∣∣ > ε) = 0. (58)\nA.1.3 Proof of Lemma 3\nDefine\nf̂X(Xi) ≡ nx,i\n(N − 1)cdxρ dx k,i\n, (59)\nf̂U (Yi) ≡ ny,i\n(N − 1)cdyρ dy k,i\n, (60)\nsuch that\nĤUk,N (X) + Ĥ U k,N (Y ) = − N∑ i=1 w′i N ( log f̂X(Xi) + log f̂U (Yi) ) . (61)\nBy triangle inequality, we can write the formula in Lemma 3 as:∣∣ĤUk,N (X) + ĤUk,N (Y )− ( − ∫∫ u(x)fY |X(y|x)( log fX(x) + log fU (y))dxdy )∣∣ =\n∣∣ N∑ i=1 w′i N ( log f̂X(Xi) + log f̂U (Yi) ) − ∫∫ u(x)fY |X(y|x) ( log fX(x) + log fU (y) ) dxdy ∣∣ ≤\n∣∣ N∑ i=1 w′i N ( log fX(Xi) + log fU (Yi) ) − ∫∫ u(x)fY |X(y|x) ( log fX(x) + log fU (y) ) dxdy ∣∣ (62) +\nN∑ i=1 w′i N ∣∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣∣. (63) The first term (62) comes from sampling. Recall that w′i = u(Xi)/fX(Xi). Since the random variables\nw′i ( log fX(Xi) + log fU (Yi) ) are i.i.d., therefore, by the strong law of large numbers,\nN∑ i=1 w′i N ( log fX(Xi) + log fU (Yi) ) → E ( u(x) fX(x) ( log fX(x) + log fU (y) ) ) (64)\nalmost surely. The mean is given by\nE ( u(x) fX(x) (log fX(x) + log fU (y)) ) =\n∫∫ u(x)\nfX(x)\n( log fX(x) + log fU (y) ) f(x, y)dxdy\n= ∫∫ u(x)fY |X(y|x) ( log fX(x) + log fU (y) ) dxdy. (65)\nTherefore, (62) converges to 0 almost surely.\nThe second term (63) comes from density estimation. To simplfy the notations, let Zi = (Xi, Yi), z = (x, y) and f(z) = f(x, y). For any fixed ε > 0, by union bound, we obtain that\nP ( N∑ i=1 w′i N ∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε ) ≤ P\n( N⋃ i=1 {∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε/2} )+ P( N∑ i=1 w′i > 2N).(66)\nThe second term converges to zero by Lemma 4. The first term is bounded by:\nP ( N⋃ i=1 {∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε/2} ) (67) ≤ N · P\n( ∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε/2 ) = N\n∫ P ( ∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣∣ > ε/2∣∣Zi = z )︸ ︷︷ ︸\n≤I1(z)+I2(z)+I3(z)+I4(z)\nf(z)dz (68)\nwhere\nI1(z) = P ( ρk,i > logN(Nf(x, y)cdx+dy ) − 1dx+dy ∣∣Zi = z ) (69)\nI2(z) = P ( ρk,i < max { (logN)2(NfX(x)cdx) − 1dx , (logN)2(NfU (y)cdy ) − 1dy } ∣∣Zi = z ) (70) I3(z) =\n∫ r1 r=r2 P ( ∣∣ log f̂X(Xi)− log fX(Xi)∣∣ > ε/4∣∣∣ρk,i = r, Zi = z )fρk,i(r)dr (71)\nI4(z) = ∫ r1 r=r2 P ( ∣∣ log f̂U (Yi)− log fU (Yi)∣∣ > ε/4∣∣∣ρk,i = r, Zi = z )fρk,i(r)dr (72)\nwhere fρk,i(r) is the pdf of ρk,i given Zi = z. Here r1 = logN(Nf(z)cdx+dy ) − 1dx+dy and\nr2 = max { (logN)2(NfX(x)cdx) − 1dx , (logN)2(NfU (y)cdy ) − 1dy }. (73)\nI1(z) and I2(z) are the probability that the k-NN distance ρk,i is large or small given Zi = z. I3(z) and I4(z) gives the probability that the estimator deviates from the true value, given that ρk,i is medium. We will consider the four terms separately.\nI1(z): Let BZ(z, r) = {Z : ‖Z − z‖ < r} be the (dx + dy)-dimensional ball centered at z with radius r. Since the Hessian matrix of H(f) exists and ‖H(f)‖2 < C almost everywhere, then for sufficiently small r, the probability mass within BZ(z, r) is given by\nP ( u ∈ BZ(z, r) ) = ∫ ‖u−z‖≤r f(u)du\n= ∫ ‖u−z‖≤r f(z) + (u− z)T∇f(z) + (u− z)TH(f)(z)(u− z) + o(‖u− z‖2)du\n∈ [ f(z)cdx+dyr dx+dy (1− Cr2)), f(z)cdx+dyrdx+dy (1 + Cr2)) ] . (74)\nThen for sufficiently large N , the probability mass within BZ(z, r1) is lower bounded by\np1 ≡ P ( u ∈ BZ(z, logN(Nf(z)cdx+dy ) − 1dx+dy ) )\n≥ f(z)cdx+dy ( logN(Nf(z)cdx+dy ) − 1dx+dy )dx+dy( 1− C(logN(Nf(z)cdx+dy ) − 1dx+dy )2 ) ≥ (logN) dx+dy\n2N . (75)\nI1(z) is the probability that at most k samples fall in BZ(z, r1), so it is upper bounded by\nI1(z) = P ( ρk,i > logN(Nf(z)cdx+dy ) − 1dx+dy ∣∣Zi = z )\n= k−1∑ m=0 ( N − 1 m ) pm1 (1− p1)N−1−m\n≤ k−1∑ m=0 Nm(1− p1)N−1−m ≤ kNk−1(1− (logN) dx+dy\n2N )N−k−1\n≤ kNk−1 exp{− (logN) dx+dy (N − k − 1)\n2N }\n≤ kNk−1 exp{− (logN) dx+dy\n4 } (76)\nfor any dx, dy ≥ 1.\nI2: Let r2,1 ≡ (logN)2(NfX(x)cdx) − 1dx . Then for sufficiently large N , the probability mass within\nBZ(z, r2,1) is given by:\np2,1 ≡ P ( u ∈ BZ(z, (logN)2(NfX(x)cdx) − 1dx ) )\n≤ f(z)cdx+dy ( (logN)2(NfX(x)cdx) − 1dx )dx+dy( 1 + C(logN(NfX(x)cdx) − 1dx )2 ) ≤ 2f(z)cdx+dy\n(f(x)cdx) dx+dy dx\n(logN)2(dx+dy)N− dx+dy dx\n≤ 2fY |X(y|x) cdx+dy cdx (logN)2(dx+dy)N− dx+dy dx ≤ 2C ′ cdx+dy cdx (logN)2(dx+dy)N− dx+dy dx (77)\nwhere the last equation comes from the assumption that fY |X(y|x) < C ′. Similarly, let r2,2 = (logN)2(NfU (y)cdy ) − 1dy , the probability of being in BZ(z, r2) is\np2,2 ≡ P ( u ∈ BZ(z, (logN)2(NfU (y)cdy ) − 1dy ) )\n≤ f(z)cdx+dy ( (logN)2(NfU (y)cdx) − 1dx )dx+dy( 1 + C(logN(NfU (y)cdx) − 1dy )2 ) ≤ 2f(z)cdx+dy\n(fU (y)cdy ) dx+dy dy\n(logN)2(dx+dy)N − dx+dydy\n≤ 2 f(z) fU (y) cdx+dy cdy (logN)2(dx+dy)N − dx+dydy ≤ 2C2 fU (x, y)\nfU (y) cdx+dy cdy (logN)2(dx+dy)N − dx+dydy\n≤ 2C2C ′ cdx+dy cdy (logN)2(dx+dy)N − dx+dydy . (78)\nI2(z) is the probability that at least k samples lie in BZ(z,max{r2,1, r2,2}). It is upper bounded as\nfollows: I2(z) = P ( ρk,i < max { (logN)2(NfX(x)cdx) − 1dx , (logN)2(NfU (y)cdy ) − 1dy } ∣∣Zi = z ) =\nN−1∑ m=k ( N − 1 m ) max{p2,1, p2,2}m(1− {p2,1, p2,2})N−1−m\n≤ N−1∑ m=k Nm max{p2,1, p2,2}m\n≤ N−1∑ m=k ( 2C ′C2 cdx+dy min{cdx , cdy} (logN)2(dx+dy)N −min{ dydx , dx dy } )m ≤ (4C ′C2 cdx+dy\nmin{cdx , cdy} )k(logN)2k(dx+dy)N\n−kmin{ dydx , dx dy }\n(79)\nfor sufficiently large N such that 2C ′ cdx+dy\nmin{cdx ,cdy} (logN)2(dx+dy)N\n−min{ dx+dydx , dx+dy dy } < 1/2, the last inequal-\nity comes from sum of geometric series. This holds for any dx, dy ≥ 1 and k ≥ 1.\nI3: Given that Zi = z = (x, y) and ρk,i = r. Recall that f̂X(Xi) = nx,i\n(N−1)cdxρ dx k,i\n, so we have\nP ( ∣∣ log f̂X(Xi)− log fX(Xi)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( ∣∣ log nx,i − log(N − 1)− log cdx − dx log ρk,i − log fX(x)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( ∣∣ log nx,i − log(N − 1)cdxrdxfX(x)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( nx,i > (N − 1)cdxrdxfX(x)eε/4 ∣∣ρk,i = r, Zi = z ) + P ( nx,i < (N − 1)cdxrdxfX(x)e−ε/4\n∣∣ρk,i = r, Zi = z ). (80) Given Zi = z and ρk,i = r ∈ [r2,1, r1], the probability distribution of nx,i is given in the following lemma:\nLemma 5. Given Zi = z = (x, y) and ρk,i = r < rN for some deterministic sequence of rN such that limN→∞ rN = 0 and for any positive ε > 0, the number of neighbors nx,i − k is distributed as ∑N−1 l=k+1 Ul, where Ul are i.i.d Bernoulli random variables with mean fX(x)cdxr dx(1−ε/8) ≤ E[Ul] ≤ fX(x)cdxrdx(1+ε/8) for sufficiently large N .\nGiven lemma. 5, we obtain\nP ( nx,i > (N − 1)cdxrdxfX(x)eε/4 ∣∣∣ρk,i = r, Zi = z ) = P\n( N−1∑ l=k+1 Ul > (N − 1)cdxrdxfX(x)eε/4 − k )\n= P ( N−1∑ l=k+1 Ul − (N − k − 1)E[Ul] > (N − 1)cdxrdxfX(x)eε/4 − k − (N − k − 1)E[Ul] ) , (81)\nand the right hand side in the probability is lower bounded by\n(N − 1)cdxrdxfX(x)eε/4 − k − E[Ul] ≥ (N − 1)cdxrdxfX(x)eε/4 − k − (N − k − 1)fX(x)cdxrdx(1 + ε/8) ≥ (N − k − 1)cdxrdxfX(x)(eε/4 − 1− ε/8)− k ≥ (N − k − 1)cdxrdxfX(x)ε/16 (82)\nfor sufficiently large N such that (N −k−1)cdxrdxfX(x)(eε/4−1− ε/16) > k. Since Ul is bernoulli, we have\nE[U2l ] = E[Ul]. Now applying Bernstein’s inequality, (81) is upper bounded by:\nP ( N−1∑ l=k+1 Ul − (N − k − 1)E[Ul] > (N − 1)cdxrdxfX(x)eε − k − (N − k − 1)E[Ul] )\n≤ P ( N−1∑ l=k+1 Ul − (N − k − 1)E[Ul] > (N − k − 1)cdxrdxfX(x)ε/16 ) ≤ exp{− ((N − k − 1)cdxr dxfX(x)ε/16) 2\n2 (\n(N − k − 1)E[U2l ] + 1 3 ((N − k − 1)cdxrdxfX(x)ε/16) )} ≤ exp{− ((N − k − 1)cdxr dxfX(x)ε/16) 2\n2 ( (N − k − 1)cdxrdxfX(x)(1 + ε/8) + 13 ((N − k − 1)cdxrdxfX(x)ε/16) )}\n= exp{− ε 2\n512(1 + 7ε/48) (N − k − 1)cdxrdxfX(x)} . (83)\nSimilarly, the tail bound on the other direction is given by: P ( nx,i < (N − 1)cdxrdxfX(x)e−ε/4 ∣∣∣ρk,i = r, Zi = z ) = P\n( N−1∑ l=k+1 Ul < (N − 1)cdxrdxfX(x)e−ε/4 − k )\n= P ( N−1∑ l=k+1 Ul − (N − k − 1)E[Ul] < (N − 1)cdxrdxfX(x)e−ε/4 − k − (N − k − 1)E[Ul] ) , (84)\nwhere the right hand side is negative and upper bounded by:\n(N − 1)cdxrdxfX(x)e−ε/4 − k − E[Ul] ≤ (N − 1)cdxrdxfX(x)e−ε/4 − k − (N − k − 1)fX(x)cdxrdx(1− ε/8) ≤ (N − k − 1)cdxrdxfX(x)(e−ε/4 − 1 + ε/8) ≤ −(N − k − 1)cdxrdxfX(x)ε/16 (85)\nfor small enough r such that cdxr dxfX(x)e −ε/4 ≤ 1 and small enough ε that e−ε/4 − 1 + 3ε/16 < 0. Similarly, (84) is upper bounded by:\nP ( N−1∑ l=k+1 Ul − (N − k − 1)E[Ul] < (N − 1)cdxrdxfX(x)e−ε/4 − k − (N − k − 1)E[Ul] )\n≤ exp{− ε 2\n512(1 + 7ε/48) (N − k − 1)cdxrdxfX(x)}. (86)\nTherefore, I3(z) is upper bounded by:\nI3(z) = ∫ r1 r=r2 P ( ∣∣ log f̂X(Xi)− log fX(Xi)∣∣ > ε∣∣ρk,i = r, Zi = z )fρk,i(r)dr\n≤ ∫ logN(Nf(z)cdx+dy )− 1dx+dy r=(logN)2(NfX(x)cdx ) − 1 dx P ( ∣∣ log f̂X(Xi)− log fX(Xi)∣∣ > ε∣∣ρk,i = r, Zi = z )fρk,i(r)dr\n≤ ∫ logN(Nf(z)cdx+dy )− 1dx+dy r=(logN)2(NfX(x)cdx ) − 1 dx 2 exp{− ε 2 512(1 + 7ε/48) (N − k − 1)cdxrdxfX(x)}fρk,i(r)dr ≤ 2 exp{− ε 2\n1024 NcdxfX(x)((logN)\n2(NfX(x)cdx) − 1dx )dx}\n≤ 2 exp{− ε 2\n1024 (logN)2dx} (87)\nfor sufficiently large N such that (N − k − 1)/(1 + 748ε) > N/2.\nI4: Given that Zi = z = (x, y) and ρk,i = r. Recall that f̂U (Yi) = ny,i\n(N−1)cdy r dy\n, then we have\nP ( ∣∣ log f̂U (Yi)− log fU (Yi)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( ∣∣ log ny,i − log(N − 1)− log cdy − dy log ρk,i − log fU (y)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( ∣∣ log ny,i − log(N − 1)cdyrdyfY (y)∣∣ > ε/4∣∣ρk,i = r, Zi = z )\n= P ( ny,i > (N − 1)cdyrdyfU (y)eε/4 ∣∣ρk,i = r, Zi = z ) + P ( ny,i < (N − 1)cdyrdyfU (y)e−ε/4\n∣∣ρk,i = r, Zi = z ). (88) Recall that\nny,i = ∑ j 6=i w′jI{‖Yj − Yi‖ < ρk,i} = ∑ j 6=i u(Xi) fX(Xi) I{‖Yj − Yi‖ < ρk,i}. (89)\nWe write ny,i = m (1) y,i +m (2) y,i , where\nm (1) y,i = ∑ j:‖Zj−z‖<ρk,i u(Xj) fX(Xj)\nm (2) y,i = ∑ j:‖Zj−z‖>ρk,i u(Xj) fX(Xj) I{‖Yj − Yi‖ < ρk,i}. (90)\nSince C1/µ(K) ≤ fX(Xj) ≤ C2/µ(K), we have: k/C2 ≤ m(1)y,i ≤ k/C1. Given that Zi = z and ρk,i = r ∈ [r2,2, r1], the probability distribution of m (2) y,i is given by the following lemma:\nLemma 6. Given Zi = z = (x, y) and ρk,i = r < rN for some deterministic sequence of rN such that limN→∞ rN = 0 and for a positive ε > 0, the distribution of m (2) y,i is distributed as ∑N−1 l=k+1 Vl where Vl are i.i.d random variables with Vl ∈ [0, 1/C1] and mean fU (y)cdyrdy (1 − ε/8) ≤ E[Vl] ≤ fU (y)cdyrdy (1 + ε/8), for sufficiently large N .\nGiven Lemma 6 and the fact that m (1) y,i ≥ k/C2, we obtain\nP ( ny,i > (N − 1)cdyrdyfU (y)eε/4 ∣∣∣ρk,i = r, Zi = z ) ≤ P\n( N−1∑ l=k+1 Vl > (N − 1)cdyrdyfU (y)eε/4 − k/C2 )\n= P ( N−1∑ l=k+1 Vl − (N − k − 1)E[Vl] > (N − 1)cdyrdyfU (y)eε/4 − k/C2 − (N − k − 1)E[Vl] ) ; (91)\nhere the right hand side is lower bounded by\n(N − 1)cdyrdyfU (y)eε/4 − k/C2 − E[Vl] ≥ (N − 1)cdyrdyfU (y)eε/4 − k/C2 − (N − k − 1)cdyrdyfU (y)(1 + ε/8) ≥ (N − k − 1)cdyrdyfU (y)(eε/4 − 1− ε/8)− k/C2 ≥ (N − k − 1)cdyrdyfU (y)ε/16 (92)\nfor sufficiently large N such that (N −k−1)cdyrdyfU (y)(eε/4−1−ε/16) > k/C2. Since Vl is upper bounded\nby 1/C1, so E[V 2l ] ≤ E[Vl]/C1. Now applying Bernstein’s inequality, (91) is upper bounded by:\nPr ( N−1∑ l=k+1 Vl − (N − k − 1)E[Vl] > (N − 1)cdyrdyfU (y)eε − k − (N − k − 1)E[Vl] )\n≤ P ( N−1∑ l=k+1 Vl − (N − k − 1)E[Vl] > (N − k − 1)cdyrdyfU (y)ε/16 ) ≤ exp{− ((N − k − 1)cdyrdyfU (y)ε/16)2\n2 (\n(N − k − 1)E[V 2l ] + 1 3C1 ((N − k − 1)cdyrdyfU (y)ε/8) )} ≤ exp{− ((N − k − 1)cdyrdyfU (y)ε/16)2\n2 (\n(N − k − 1)cdyrdyfU (y)(1 + ε/8)/C1 + 13C1 ((N − k − 1)cdyr dyfU (y)ε/16) )} ≤ exp{− C1ε 2\n512(1 + 7ε/48) (N − k − 1)cdyrdyfU (y)} . (93)\nSimilarly, since m (1) y,i < k/C1, the tail bound on the other way is given by:\nP ( ny,i < (N − 1)cdyrdyfU (y)e−ε/4 ∣∣∣ρk,i = r, Zi = z ) ≤ P\n( N−1∑ l=k+1 Vl < (N − 1)cdyrdyfU (y)e−ε/4 − k/C1 )\n= P ( N−1∑ l=k+1 Vl − (N − k − 1)E[Vl] < (N − 1)cdyrdyfU (y)e−ε/4 − k/C1 − (N − k − 1)E[Vl] ) , (94)\nwhere the right hand side is negative and upper bounded by:\n(N − 1)cdyrdyfU (y)e−ε/4 − k/C1 − E[Vl] ≤ (N − 1)cdyrdyfU (y)e−ε/4 − k/C1 − (N − k − 1)cdyrdyfU (y)(1− ε/8) ≤ (N − k − 1)cdyrdyfU (y)(e−ε/4 − 1 + ε/8) ≤ −(N − k − 1)cdyrdyfU (y)ε/16 (95)\nfor small enough r such that cdyr dyfU (y)e −ε/4 ≤ 1/C1 and small enough ε that e−ε/4 − 1 + 3ε/16 < 0. Similarly, (94) is upper bounded by:\nP ( N−1∑ l=k+1 Vl − (N − k − 1)E[Vl] < (N − 1)cdyrdyfU (y)e−ε/4 − k − (N − k − 1)E[Vl] )\n≤ exp{− C1ε 2\n512(1 + 7ε/48) (N − k − 1)cdyrdyfU (y)}. (96)\nTherefore, I4(z) is upper bounded by:\nI4(z) = ∫ r1 r=r2 P ( ∣∣ log f̂U (Yi)− log fU (Yi)∣∣ > ε∣∣ρk,i = r, Zi = z )fρk,i(r)dr\n≤ ∫ logN(Nf(z)cdx+dy )− 1dx+dy r=(logN)2(NfU (y)cdy ) − 1 dy P ( ∣∣ log f̂U (Yi)− log fU (Yi)∣∣ > ε∣∣ρk,i = r, Zi = z )fρk,i(r)dr\n≤ ∫ logN(Nf(z)cdx+dy )− 1dx+dy r=(logN)2(NfU (y)cdy ) − 1 dy exp{− C1ε 2 512(1 + 7ε/48) (N − k − 1)cdyrdyfU (y)}fρk,i(r)dr ≤ 2 exp{−C1ε 2\n1024 NcdyfU (y)((logN)\n2(NfU (y)cdy ) − 1dy )dy}\n≤ 2 exp{−C1ε 2\n1024 (logN)2dy} (97)\nfor sufficiently large N such that (N − k − 1)/(1 + 7ε/48)) > N/2.\nNow combining (76), (79), (87) and (97), we obtain\nP ( N∑ i=1 w′i N ∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε ) ≤ N ∫∫ (I1(z) + I2(z) + I3(z) + I4(z))f(z)dz\n≤ kNk exp{− (logN) dx+dy\n4 }+ (4C ′C2 cdx+dy min{cdx , cdy} )k(logN)2k(dx+dy)N 1−kmin{ dydx , dy dy }\n+ 2N exp{− ε 2 1024 (logN)2dx}+ 2N exp{−C 2 1ε 2 1024 (logN)2dy}. (98)\nIf k > max{dy/dx, dx/dy}, we have 1− kmin{dx+dydx , dx+dy dy } < 0. Then each of the four terms goes to 0 as N →∞ and we conclude:\nlim N→∞ P ( N∑ i=1 w′i N ∣∣( log f̂X(Xi) + log f̂U (Yi) )− ( log fX(Xi) + log fU (Yi) )∣∣ > ε ) = 0. (99) Therefore, by combining the convergence properties of error from kernel density estimation, error from selfnormalized importance sampling and error from density estimation, we obtain that ÎUk,N (X,Y ) converges to IU (fY |X) in probability.\nA.1.4 Proof of Lemma 5\nGiven that Zi = z = (x, y) and ρk,i = r, let {1, 2, . . . , i− 1, i+ 1, . . . , N} = S ∪ {j} ∪ T be a partition of the indexes with ∣∣S∣∣ = k − 1 and ∣∣T ∣∣ = N − k − 1. Then define an event AS,j,T associated to the partition as: AS,j,T = { ‖Zs − z‖ < ‖Zj − z‖,∀s ∈ S, and ‖Zt − z‖ > ‖Zj − z‖,∀t ∈ T } . (100)\nSince Zj − z are i.i.d. random variables, each event AS,j,T has identical probability. The number of such partitions is (N−1)!(N−k−1)!(k−1)! , and thus P ( AS,j,T ) = (N−k−1)!(k−1)!(N−1)! . So the cdf of nx,i is given by:\nP ( nx,i ≤ k +m ∣∣ρk,i = r, Zi = z ) =\n∑ S,j,T P ( AS,j,T ) P ( nx,i ≤ k +m ∣∣AS,j,T , ρk,i = r, Zi = z ) =\n(N − k − 1)!(k − 1)! (N − 1)! ∑ S,j,T P ( nx,i ≤ k +m ∣∣AS,j,T , ρk,i = r, Zi = z ). (101) Now condition on event AS,j,T and ρk,i = r, namely Zj is the k-nearest neighbor with distance r, S is the set of samples with distance smaller than r and T is the set of samples with distance greater than r. Recall that nx,i is the number of samples with ‖Xj − x‖ < r. For any index s ∈ S ∪ {j}, ‖Xs − x‖ < r is satisfied. Therefore, nx,i ≤ k + m means that there are no more than m samples in T with X-distance smaller than r. Let Ul = I{‖Xl − x‖ < r\n∣∣‖Zl − z‖ > r}.Therefore, P ( nx,i ≤ k +m\n∣∣AS,j,T , ρk,i = r, Zi = z ) = P\n( ∑ t∈T I{‖Xt − x‖ < r} ≤ m ∣∣ ‖Zs − z‖ < r,∀s ∈ S, ‖Zj − z‖ = r, ‖Zt − z‖ > r,∀t ∈ T,Zi = z )\n= P ( ∑ t∈T I{‖Xt − x‖ < r} ≤ m ∣∣ ‖Zt − z‖ > r,∀t ∈ T )\n= P ( N−1∑ l=k+1 Ul ≤ m ) . (102)\nWe can drop the conditions of Zs’s for s 6∈ T since Zs and Xt are independent. Therefore, given that ‖Zt − z‖ > r for all t ∈ T , the variables I{‖Xt − x‖ < r} are i.i.d. and have the same distribution as Ul. Therefore, we have:\nP ( nx,i ≤ k +m ∣∣ρk,i = r, Zi = z ) =\n(N − k − 1)!(k − 1)! (N − 1)! ∑ S,j,T P ( nx,i ≤ k +m ∣∣AS,j,T , ρk,i = r, Zi = z ) =\n(N − k − 1)!(k − 1)! (N − 1)! ∑ S,j,T P ( N∑ l=k+1 Ul ≤ m )\n= P ( N−1∑ l=k+1 Ul ≤ m )\n(103)\nand so nx,i − k have the same distribution as ∑N−1 l=k+1 Ul given Zi = z and ρk,i = r. Here the mean of Ul is given by:\nE[Ul] = P ( ‖Xl − x‖ < r ∣∣ ‖Zl − z‖ > r ) = P( ‖Xl − x‖ < r, ‖Zl − z‖ > r )P( ‖Zl − z‖ > r ) = ∫ ‖u−x‖<r fX(u)du− ∫∫ ‖(u,v)−(x,y)‖,r f(u, v)dudv\n1− ∫∫ ‖(u,v)−(x,y)‖,r f(u, v)dudv\n. (104)\nSince ‖H(fX)‖ ≤ C almost everywhere, if r < rN and rN decays as N goes to infinity, for sufficiently large N , we have the following bound for E[Ul]:\nE[Ul] < ∫ ‖u−x‖<r fX(u)du\n= ∫ ‖u−x‖<r fX(x) + (u− x)∇fX(x) + (u− x)TH(fX)(x)(u− x) + o(‖u− x‖2) < fX(x)cdxr dx(1 + Cr2) < fX(x)cdxr dx(1 + ε/8) , (105)\nand\nE[Ul] > ∫ ‖u−x‖<r fX(u)du− ∫ ‖(u,v)−(x,y)‖,r f(u, v)dudv\n> fX(x)cdxr dx(1− Cr2)− f(x, y)cdx+dyrdx+dy (1 + Cr2) > fX(x)cdxr dx(1− ε/8). (106)\nA.1.5 Proof of Lemma 6\nGiven that Zi = z = (x, y) and ρk,i = r. Define AS,j,T as same as in Lemma 5. Let Vl = u(Xl)fX(Xl) I{‖Yl−y‖ < r ∣∣‖Zl − z‖ > r}. Condition on event AS,j,T , the cdf of m(2)y,i is given by:,\nP ( m\n(2) y,i ≤ m ∣∣AS,j,T , ρk,i = r, Zi = z ) = P\n( ∑ t∈T u(Xt) fX(Xt) I{‖Yt − y‖ < ρk,i} ≤ m ∣∣ ‖Zs − z‖ < r,∀s ∈ S, ‖Zj − z‖ = r, ‖Zt − z‖ > r,∀t ∈ T,Zi = z ) = P\n( ∑ t∈T u(Xt) fX(Xt) I{‖Yt − y‖ < ρk,i} ≤ m ∣∣ ‖Zt − z‖ > r,∀t ∈ T ) = P\n( N−1∑ l=k+1 Vl ≤ m ) . (107)\nSimilarly we can drop the conditions of Zs’s for s 6∈ T . Therefore, given that ‖Zt − z‖ > r for all t ∈ T , the variables u(Xt)fX(Xt) I{‖Yt − y‖ < r} are i.i.d. and have the same distribution as Vl. Therefore, we have:\nP ( m\n(2) y,i ≤ m ∣∣ρk,i = r, Zi = z ) =\n(N − k − 1)!(k − 1)! (N − 1)! ∑ S,j,T P ( m (2) y,i ≤ m ∣∣AS,j,T , ρk,i = r, Zi = z ) =\n(N − k − 1)!(k − 1)! (N − 1)! ∑ S,j,T P ( N−1∑ l=k+1 Vl ≤ m )\n= P ( N−1∑ l=k+1 Vl ≤ m )\n(108)\nsom (2) y,i have the same distribution as ∑N−1 l=k+1 Vl given Zi = z and ρk,i = r. Here Vl ≤ supx u(x) fX(x) = 1/C1.\nThe mean of Vl is given by:\nE[Vl] = E [ u(Xl) fX(Xl) I{‖Yl − y‖ < r} ∣∣ ‖Zl − z‖ > r ]\n=\n∫∫ ‖v−y‖<r u(u) fX(u) f(u, v)dudv − ∫∫ ‖(u,v)−(x,y)‖<r u(u) fX(u) f(u, v)dudv\n1− ∫∫ ‖(u,v)−(x,y)‖,r u(u) fX(u) f(u, v)dudv . (109)\nSince ‖H(fU )‖ ≤ C almost everywhere, if r < rN and rN decays as N goes to infinity, for sufficiently large N , we have the following bound for E[Vl]:\nE[Vl] < ∫∫ ‖v−y‖<r u(u) fX(u) f(u, v)dudv\n= ∫ ‖v−y‖<r fU (v)dy\n= ∫ ‖v−y‖<r fU (y) + (v − y)∇fU (y) + (v − y)TH(fU )(y)(v − y) + o(‖v − y‖2) < fU (y)cdyr dy (1 + Cr2) < fU (y)cdyr dy (1 + ε/8) (110)\nand\nE[Vl] > ∫∫ ‖v−y‖<r u(u) fX(u) f(u, v)dudv − ∫∫ ‖(u,v)−(x,y)‖,r u(u) fX(u) f(u, v)dudv\n= ∫ ‖v−y‖<r fU (v)dy − ∫∫ ‖(u,v)−(x,y)‖,r fU (u, v)dudv > fU (y)cdyr dy (1− Cr2)− fU (x, y)cdx+dyrdx+dy (1 + Cr2) > fU (y)cdyr dy (1− ε/8). (111)\nA.2 The case of discrete X Under Assumption 1, we prove a more general version of the theorem. Let (X1, Y1), . . . , (Xn, Yn) be i.i.d. samples drawn from some unknown prior pX(x) anb let qX(x) be some known distribution on X such that qX(x)/pX(x) ∈ [C3, C4] for all x ∈ X . Then define\nw(q)x ≡ NqX(x)\nnx , (112)\nn (q) y,i ≡ ∑ j 6=i w (q) Xj I{‖Yj − Yi‖ < ρk,i}. (113)\nThe proposed estimator is:\nÎ (q) k,N (X,Y ) ≡\n1\nN N∑ i=1 w (q) Xi ( ψ(k) + log(N)− ( log(nXi) + log(n (q) y,i) ) ) . (114)\nWe claim that Î (q) k,N converges to the true value in probability, i.e.\nlim N→∞\nP ( ∣∣Î(q)k,N (X,Y )− I(q)(fY |X)∣∣ > ε ) = 0 , (115)\nwhere\nI(q)(fY |X) ≡ ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x) fq(y) dy (116)\nand\nfq(y) ≡ ∑ x′∈X qx(X)fY |X(y|x′). (117)\nNotice that Theorem 1 is a special case when qX(x) is uniform. Define g(Xi, Yi) ≡ ψ(k) + log(N)− ( log(nx,i) + log(n (q) y,i) )\n(118)\nsuch that Îqk,N (X,Y ) = 1 N ∑N i=1 w (q) Xi g(Xi, Yi). Define each quantity with the true prior pX(x) as\nw′x ≡ qX(x)\npX(x) , (119) n′y,i ≡ ∑ j 6=i w′Xj I{‖Yj − Yi‖ < ρk,i} , (120)\ng′(Xi, Yi) ≡ ψ(k) + log(N)− ( log(nXi) + log(n ′ y,i) ) . (121)\nWe apply triangular inequality, and show that each term converges to zero in probability.∣∣Î(q)k,N (X,Y )− I(q)(fY |X)∣∣ = ∣∣∣ 1 N N∑ i=1 w (q) Xi g(Xi, Yi)− ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x)∑ x′∈X qX(x)fY |X(y|x′) dy ∣∣∣\n≤ 1 N ∣∣∣ N∑ i=1 ( w (q) Xi g(Xi, Yi)− w′Xig ′(Xi, Yi) ) ∣∣∣ (122)\n+ ∣∣∣ 1 N N∑ i=1 w′Xig ′(Xi, Yi)− ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x)∑ x′∈X qX(x)fY |X(y|x′) dy ∣∣∣. (123)\nThe first term (122) captures the error in estimating pX(x). Similar as in (188), the probability that it deviates from 0 is is upper bounded by:\nP ( 1 N ∣∣ N∑ i=1 ( w (q) Xi g(Xi, Yi)− w′Xig ′(Xi, Yi) ) ∣∣ > ε) ≤ P( max x∈X |w(q)x − w′x| > ε/(3 logN) ) (124)\nfor sufficiently large N . Recall that wx = NqX(x)/nx, (124) is bounded by: P (\nmax x∈X |w(q)x − w′x| > ε/(3 logN) ) = P ( max x∈X ∣∣∣NqX(x) nx − qX(x) pX(x)\n∣∣∣ > ε/(3 logN)) = P ( ∀x ∈ X , nx 6∈ [\nNqX(x) qX(x) pX(x) + ε3 logN , NqX(x) qX(x) pX(x) ε 3 logN\n] )\n≤ P ( ∀x ∈ X , nx 6∈ [NpX(x)(1−\nεpX(x)\n6 logNqX(x) ), Npx(1 +\nεpX(x) 6 logNqX(x) )] )\n(125)\nfor sufficiently large N such that εpx3 logNqX(x) < 1/3. Recall that for each x ∈ X , nx = ∑N i=1 I{Xi = x}. Therefore, nx is a binomial random variable with parameter (N, pX(x)). Therefore, by Hoeffding’s inequality, for any x ∈ X , we have:\nP ( |nx −NpX(x)| ≤ Nεp2X(x)\n6 logNqX(x)\n) ≤ 2 exp{− 1\n2N (\nNεp2X(x)\n6 logNqX(x) )2} ≤ 2 exp{− Nε 2C21 72|X |2C24 (logN)2 } (126)\nwhere the last inequality comes from the assumption that pX(x) > C1/|X | and qX(x)/pX(x) < C4. Then by union bound, (125) is upper bounded by:\nP ( ∀x ∈ X , nx 6∈ [NpX(x)(1−\nεpX(x)\n6 logNqX(x) ), Npx(1 +\nεpX(x) 6 logNqX(x) )] )\n≤ |X |max x∈X\nP ( |nx −NpX(x)| ≤ Nεp2X(x)\n6 logNqX(x) ) ≤ 2|X | exp{− Nε\n2C21 72|X |2C24 logN }. (127)\nCombining with (124), we know that (122) converges to 0 in probability. The second term in the error (123) comes from the sample noise in density estimation. we decompose our estimator into three terms:\n1\nN N∑ i=1 w′Xig ′(Xi, Yi) = Ĥ q k,N (Y )− Ĥ q k,N (Y |X)− N∑ i=1 w′Xi N (log(N − 1)− logN + log(nXi)− ψ(nXi)) ,\nwhere\nĤqk,N (Y |X) ≡ N∑ i=1 w′Xi N ( − ψ(k) + ψ(nXi) + log cdy + dy log ρk,i ) , (128)\nĤqk,N (Y ) ≡ N∑ i=1 w′Xi N ( − log ny,i + log(N − 1) + log cdy + dy log ρk,i ) . (129)\nNotice that ∑N i=1 w′Xi N (log(N − 1) − logN + log(nXi) − ψ(nXi)) converges to 0 in probability as N goes to infinity. The desired claim follows directly from the following two lemmas showing the convergence each entropy estimates to corresponding conditional entropy Hq(Y |X) and entropy Hq(Y ). The desired claim immediately follows the two lemmas.\nLemma 7. Under the hypotheses of Theorem 1, for all ε > 0\nlim N→∞\nP (∣∣∣Ĥqk,N (Y |X)− ( −∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x)dy )∣∣∣ > ε) = 0 . (130) Lemma 8. Under the hypotheses of Theorem 1, for all ε > 0\nlim N→∞\nP (∣∣∣Ĥqk,N (Y )− ( −∑ x∈X qX(x) ∫ fY |X(y|x) log fq(y) ) dy )∣∣∣ > ε) = 0 , (131)\nwhere fq(y) = ∑ x∈X qX(x)fY |X(y|x).\nA.2.1 Proof of Lemma 7\nDefine\nf̂Y |X(Yi|Xi) = exp{ψ(k)− ψ(nXi)}\ncdyρ dy k,i\n, (132)\nso that\nĤqk,N (Y |X) = − N∑ i=1 w′Xi N log f̂Y |X(Xi, Yi) , (133)\nNotice that f̂Y |X(Yi|Xi) is just the k-nearest neighbour density estimator for the conditional pdf fY |X(y|x). Therefore, by Theorem 8. [SMH+03], we have\nlim N→∞\nE [ log f̂Y |X(Yi|Xi) ∣∣(Xi, Yi) = (x, y)] = log fY |X(y|x) , (134)\nNotice that w′Xi log f̂(Yi|Xi) are identically distributed, therefore, we have\nlim N→∞\nEĤUk,N (X,Y )\n= − lim N→∞ E[w′Xi log f̂X,Y (Xi, Yi)]\n= − lim N→∞ ∑ x∈X qX(x) pX(x) pX(x) ( ∫ E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]fY |X(y|x)dy )\n= − lim N→∞ ∑ x∈X qX(x) ( ∫ E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]fY |X(y|x)dy ) (135)\nUse the same technique in the proof of Lemma 2 and Equation (51), we can switch the order of limit and integration. Therefore,\nlim N→∞ ∑ x∈X qX(x) ( ∫ E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]fY |X(y|x)dy )\n= ∑ x∈X qX(x) ( ∫ lim N→∞ E [ log f̂X,Y (Xi, Yi) ∣∣(Xi, Yi) = (x, y)]fY |X(y|x)dy )\n= ∑ x∈X qX(x) ∫ logY |X(y|x)fY |X(y|x)dy , (136)\nTherefore,\nlim N→∞ EĤqk,N (Y |X) = − ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x)dy. (137)\nMoreover, by Theorem11. [SMH+03], we have:\nlim N→∞\nVar[f̂Y |X(Yi|Xi)] = ( Γ′(k)\nΓ(k) )′Var[log fY |X(y|x)] <∞ , (138)\nand for any j 6= i:\nlim N→∞\nCov[f̂Y |X(Yi|Xi), f̂Y |X(Yj |Yi)] = 0. (139)\nSince w′x ≤ C4 for all x, similarly as in Lemma 2, we obtain\nlim N→∞\nVar [ Ĥqk,N (Y |X) ] = 0 , (140)\nCombining (137) and (140), we know Ĥqk,N (Y |X) converges to its mean in L2, hence in probability, i.e.,\nlim N→∞\nP ( ∣∣Ĥqk,N (X,Y )− ( −∑\nx∈X qX(x)\n∫ logY |X(y|x)fY |X(y|x)dy )∣∣ > ε) = 0. (141)\nA.2.2 Proof of Lemma 8\nDefine\nf̂q(Yi) ≡ ny,i\n(N − 1)cdyρ dy k,i\n, (142)\nsuch that\nĤqk,N (Y ) = − N∑ i=1 w′Xi N log f̂q(Yi). (143)\nBy triangle inequality, we can write the formula in Lemma 8 as:∣∣Ĥqk,N (Y )− ( −∑ x∈X qX(x) ∫ fY |X(y|x) log fq(y) ) dy )∣∣\n= ∣∣ N∑ i=1 w′Xi N log f̂q(Yi)− ∑ x∈X qX(x) ∫ fY |X(y|x) log fq(y) ) dy ∣∣\n≤ ∣∣ N∑ i=1 w′Xi N log fq(Yi)− ∑ x∈X qX(x) ∫ fY |X(y|x) log fq(y) ) dy ∣∣ (144)\n+ N∑ i=1 w′i N ∣∣∣ log f̂q(Yi)− log fq(Yi)∣∣∣. (145) The first term comes (144) from sampling. Recall that w′Xi = qX(Xi)/pX(Xi). Therefore by strong law\nof large numbers,\nN∑ i=1 w′Xi N log fq(Yi)→ E ( qX(x) pX(x) log fq(y) )\n(146)\nalmost surely. The mean is given by E ( qX(x) pX(x) log fq(y) ) = ∑ x∈X qX(x) ∫ fY |X(y|x) log fq(y)dy. (147)\nTherefore, (144) converges to 0 almost surely.\nThe second term (145) comes from density estimation. For any fixed ε > 0, by union bound, we obtain that\nP ( N∑ i=1 w′Xi N ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε ) ≤ P\n( N⋃ i=1 {∣∣ log f̂q(Yi)− log fq(Yi)∣∣∣∣∣ > ε/2} )+ P( N∑ i=1 w′Xi > 2N). (148)\nThe second term converges to zero by the law of large numbers. The first term is bounded by:\nP ( N⋃ i=1 {∣∣∣ log f̂q(Yi)− log fq(Yi)∣∣∣∣∣ > ε/2} ) (149) ≤ N · P\n( ∣∣∣ log f̂q(Yi)− log fq(Yi)∣∣∣∣∣ > ε/2 ) = N\n∑ x∈X pX(x) ∫ P ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣∣∣ > ε/2∣∣∣(Xi, Yi) = (x, y) )︸ ︷︷ ︸\n≤I1(x,y)+I2(x,y)+I3(x,y)\nfY |X(y|x)dy (150)\nwhere\nI1(x, y) = P ( ρk,i > (N 1/2pX(x)fY |X(y|x)cdy )−1/dy ∣∣Xi = x, Yi = y ) (151)\nI2(x, y) = P ( ρk,i < (logN) 1+δ/2(Nfq(y)cdy ) −1/dy ∣∣Xi = x, Yi = y ) (152) I3(x, y) =\n∫ r1 r=r2 P ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε/2∣∣∣ρk,i = r, (Xi, Yi) = (x, y) )fρk,i(r)dr (153)\nwhere fρk,i(r) is the pdf of ρk,i given Xi and Yi. Here r1 = (N 1/2pX(x)fY |X(y|x)cdy ) − 1dy and r2 = (logN)1+δ/2(Nfq(y)cdy ) − 1dy . We will consider the three terms separately.\nI1(z): Let B(x, y, r) = {(X,Y ) : ‖Y − y‖ < r,X = x} be the dy-dimensional ball centered at y with radius r with same x. Since the Hessian matrix of H(fY |X) exists and ‖H(fY |X)‖2 < C almost everywhere for any x ∈ X , then for sufficiently small r, the probability mass within B(x, y, r) is given by\nP ( (u, v) ∈ B(x, y, r) )\n= pX(x) ∫ ‖v−y‖≤r fY |X(v)dv\n= pX(x) ∫ ‖v−y‖≤r fY |X(y) + (v − y)T∇fY |X(y) + (v − y)TH(fY |X)(y)(v − y) + o(‖v − y‖2)du\n∈ [ pX(x)fY |X(y|x)cdyrdy (1− Cr2)), pX(x)fY |X(y|x)cdyrdy (1 + Cr2)) ] . (154)\nThen for sufficiently large N , the probability mass within B(x, y, r1) is lower bounded by p1 ≡ P ( (u, v) ∈ B(x, y, (N1/2pX(x)fY |X(y|x)cdy )−1/dy ) )\n≥ pX(x)fY |X(y|x)cdy ( (N1/2pX(x)fY |X(y|x)cdy )−1/dy )dy( 1− C((N1/2pX(x)fY |X(y|x)cdy ) − 1dy )2 ) ≥ 1\n2 N−1/2. (155)\nI1(z) is the probability that at most k samples fall in BZ(z, r1), so it is upper bounded by I1(z) = P ( ρk,i > r1 ∣∣Zi = z ) =\nk−1∑ m=0 ( N − 1 m ) pm1 (1− p1)N−1−m\n≤ k−1∑ m=0 Nm(1− p1)N−1−m ≤ kNk−1(1− 1 2 √ N )N−k−1 ≤ kNk−1 exp{−N − k − 1 2 √ N } (156)\nfor any dx, dy ≥ 1.\nI2: Let r2 = (logN) 1+δ/2(Nfq(y)cdy ) −1/dy . Then for sufficiently large N , the probability mass within B(x, y, r2) is given by:\np2 ≡ P ( u ∈ B(x, y, (logN)1+δ/2(Nfq(y)cdy )−1/dy ) ) ≤ pX(x)fY |X(y|x)cdy ( (logN)1+δ/2(Nfq(y)cdy ) −1/dy )dy( 1 + C((logN)1+δ/2(Nfq(y)cdy ) −1/dy )2\n) ≤\n2pX(x)fY |X(y|x) fq(y) (logN)(1+δ/2)dyN−1\n≤ 2pX(x)fY |X(y|x)∑ x∈X qX(x)fY |X(y|x) (logN)(1+δ/2)dyN−1 ≤ 2 C3|X |N (logN)(1+δ/2)dy (157)\nwhere the last equation comes from the assumption that qX(x)/pX(x) > C3. I2(z) is the probability that at least k samples lying in B(x, y, r2). Therefore, it is upper bounded by\nI2(z) = P ( ρk,i < r2 ∣∣Zi = z ) =\nN−1∑ m=k ( N − 1 m ) pm2 (1− p2)N−1−m\n≤ N−1∑ m=k Nmpm2 m!\n≤ N−1∑ m=k Nmpm2 (m/e)m\n≤ N−1∑ m=k ( Nep2 k )m\n≤ N−1∑ m=k ( 2e C3|X | (logN)(1+δ/2)dy/k)m. (158)\nHere we use the fact that m! > (m/e)m for all m. Since k > (logN)(1+δ)dy by assumption, (logN)(1+δ/2)dy/k is decreasing as N increases. For sufficiently large N such that 2eC1|X | (logN) (1+δ/2)dy/k < 1/2, we obtain:\nI2(z) ≤ 2( 2e\nC3|X | (logN)(1+δ/2)dy/k)k\n≤ 2( 2e C3|X | )(logN) (1+δ)dy (logN)−δ(logN) (1+δ)dy/2. (159)\nI3: Given that (Xi, Yi) = (x, y) and ρk,i = r. Recall that f̂q(Yi) = ny,i\n(N−1)cdy r dy\n, then we have\nP ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )\n= P ( ∣∣ log ny,i − log(N − 1)− log cdy − dy log ρk,i − log fq(y)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )\n= P ( ∣∣ log ny,i − log(N − 1)cdyrdyfq(y)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )\n= P ( ny,i > (N − 1)cdyrdyfq(y)eε/2 ∣∣ρk,i = r, (Xi, Yi) = (x, y) ) + P ( ny,i < (N − 1)cdyrdyfq(y)e−ε/2\n∣∣ρk,i = r, (Xi, Yi) = (x, y) ). (160) Following a similar technique as the analysis of I4 in proof of Lemma 3, we obtain\nP ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )\n≤ 2 exp{− C3ε 2\n128(1 + 7ε/24) (N − k − 1)cdyrdyfq(y)} (161)\nwhere C3 is the lower bound of qX(x)/pX(x). Therefore, I3(x, y) is upper bounded by:\nI3(x, y) = ∫ r1 r=r2 P ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )fρk,i(r)dr\n≤ ∫ (N1/2pX(x)fY |X(y|x)cdy )−1/dy r=(logN)1+δ/2(Nfq(y)cdy ) −1/dy P ( ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε/2∣∣ρk,i = r, (Xi, Yi) = (x, y) )fρk,i(r)dr\n≤ ∫ (N1/2pX(x)fY |X(y|x)cdy )−1/dy r=(logN)1+δ/2(Nfq(y)cdy ) −1/dy 2 exp{− C3ε 2 128(1 + 7ε/24) (N − k − 1)cdyrdyfq(y)}fρk,i(r)dr ≤ 2 exp{−C3ε 2\n256 Ncdyfq(y)((logN)\n1+δ/2(Nfq(y)cdy ) − 1dy )dy}\n≤ 2 exp{−C3ε 2\n256 (logN)(1+δ/2)dy} (162)\nfor sufficiently large N such that (N − k − 1)/(1 + 7ε/24)) > N/2.\nNow combine (156), (159), and (162), and we obtain\nP ( N∑ i=1 w′i N ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε ) ≤ N\n∑ x∈X pX(x) ∫ (I1(x, y) + I2(x, y) + I3(x, y))dy\n≤ kNk exp{−N − k − 1 2 √ N }+ 2N exp{−C3ε 2 256 (logN)(1+δ/2)dy} + 2N( 2e\nC3|X | )(logN)\n(1+δ)dy (logN)−δ(logN) (1+δ)dy/2. (163)\nOne can easily see that the first and second terms converges to 0 as N goes to infinity, given that k <√ N/(5 logN). To see that the last term converges to 0, we will show that the logarithm goes to −∞ as N goes to infinity, which is\nlog(N( 2e\nC3|X | )(logN)\n(1+δ)dy (logN)−δ(logN) (1+δ)dy/2)\n= logN + log( 2e\nC3|X | )(logN)(1+δ)dy − logNδ(logN)(1+δ)dy/2\n= logN + log( 2e C3|X | )(logN)(1+δ)dy − δ 2 (logN)(1+δ)dy+1. (164)\nThe negative term has the larger exponent, so the logarithm will goes to −∞, and we have\nlim N→∞ P ( N∑ i=1 w′Xi N ∣∣ log f̂q(Yi)− log fq(Yi)∣∣ > ε ) = 0. (165) Therefore, by combining the convergence of error from sampling and error from density estimation, we obtain that Î (q) k,N (X,Y ) converges to I (q)(fY |X) in probability.\nB Proof of the CMI estimator convergence\nAssumption 2. We make the following assumptions: (a) ∫ fY |X(y|x) ∣∣ log fY |X(y|x)∣∣dy <∞, for all x ∈ X . (b) ∫ fY |X(y|x) ( log fY |X(y|x) )2 dy <∞, for all x ∈ X .\n(c) There exists a finite constant C such that the Hessian matrix of H(fY |X) exists and ‖H(fY |X)‖2 < C almost everywhere, for all x ∈ X .\n(d) There exists a finite constant C ′ such that the conditional pdf fY |X(y ∣∣x) < C ′ almost everywhere, for\nall x ∈ X .\n(e) There exists finite constants C1 < C3 < C4 < C2 such that the ratio of the optimal prior q ∗ of the\nmaximizer in the definition of C(fY |X) and the true prior satisfies that q∗X(x)/pX(x) ∈ [C3, C4] for every x ∈ X .\n(e) There exists finite constants C5 < C6 such that pX(x) > C5/|X | and pX(x) < C6/|X |, for all x ∈ X .\nDefine\nI(fY |X)(qX) ≡ ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x)∑ x′∈X qX(x ′)fY |X(y|x′) dy (166)\nand\nÎk,N (X,Y )(w) ≡ 1\nN N∑ i=1 wXi ( ψ(k) + log(N)− ( log(nXi) + log(ny,i) ) ) (167)\nsuch that C(fY |X) = maxqX∈Q I(fY |X)(qX) and Ĉ ∆ k,N (X,Y ) = maxw∈T∆ Îk,N (X,Y )(w). First, consider the quantity:\nC∆(fY |X) ≡ max qX∈T∆(Q) I(fY |X)(qX) (168)\nwhere the constraint set T∆(Q) is defined as: T∆(Q) = {qX ∈ R|X | : [(qX(x)/pX(x))] ∈ T∆ and ∑ x∈X qX(x) ∈ [1− |X |∆, 1 + |X |∆]} (169)\nwe rewrite the error term in Theorem 23 as∣∣Ĉ∆k,N (X,Y )− C(fY |X)∣∣ ≤ ∣∣C∆(fY |X)− C(fY |X)∣∣+ ∣∣Ĉ∆k,N − C∆(fY |X)∣∣. (170) The first error comes from quantization. Let q∗ be the maximizer of C(fY |X). By assumption, q∗(x)/pX(x) ∈ [C3, C4] ⊆ [C1, C2], for all x. Since T∆(Q) is a quantization of the simplex Q, so there exists a q0 ∈ T∆(Q) such that |q0(x) − q∗(x)| < ∆ · pX(x) < ∆ for all x ∈ X . Now we will bound the difference of I(fY |X)(q0) and I(fY |X)(q ∗) by the following lemma:\nLemma 9. Under the assumptions of Theorem 23, if q(x)/p(x) ∈ [C1, C2] and q′(x)/p(x) ∈ [C1, C2] for all x ∈ X , then ∣∣ I(fY |X)(q)− I(fY |X)(q′) ∣∣ ≤ Lmax\nx∈X |q(x)− q′(x)| , (171)\nfor some positive constant L.\nThen we have:\nC(fY |X) = I(fY |X)(q ∗)\n≤ I(fY |X)(q0) + Lmax x∈X |q0(x)− q∗(x)| ≤ max q∈T∆(Q) I(fY |X)(q) + L∆ = C∆(fY |X) + L∆. (172)\nSimilarly, let q∗∗ be the maximizer of C∆(fY |X), we can also find a q1 ∈ Q such that |q1(x)−q∗∗(x)| < ∆ for all x ∈ X . Using Lemma 9 again, we will obtain C∆(fY |X) ≤ C(fY |X) + L∆. Therefore, the first term in (170) is bounded by O(∆).\nNow consider the second term. Upper bound on the second term relies on the convergence of dicrete UMI estimation from Theorem . Recall that in the proof of Theorem 1, we have shown that under certain conditions,\nP ( ∣∣Îk,N (X,Y )(wq)− I(fY |X)(q)∣∣ > ε/2 ) N→∞−→ 0 (173)\nfor any q with bounded qX/pX . Here (wq)x = q(x)/pX(x). Since the set T∆(Q) is finite, by union bound, we have:\nlim N→∞\nP ( ∀q ∈ T∆(Q), ∣∣Îk,N (X,Y )(wq)− I(fY |X)(q)∣∣ ≤ ε/2 ) ≥ 1− |T∆(Q)| lim N→∞ P ( ∣∣Îk,N (X,Y )(wq)− I(fY |X)(q)∣∣ ≤ ε/2 ) = 1. (174)\nAlso, by the strong law of large numbers, we have that\nlim N→∞\nP ( ∀x ∈ X , |px(X)− nX/N | < ∆/C2|X | ) = 1. (175)\nWe claim that if the events inside the probability in (174) and (175) happen simultaneously, then ∣∣Ĉ∆k,N −\nC∆(fY |X) ∣∣ < ε+O(∆), which implies the desired claim.\nLet w∗ = arg maxw∈T∆ Îk,N (X,Y )(w). Define q2(x) = w ∗ xpX(x). Since [q2(x)/pX(x)] ∈ T∆ for all x and∣∣ ∑\nx∈X q2(x)− 1 ∣∣ = ∣∣ ∑ x∈X w∗x(pX(x)− nx/N) + (∆/2)|X | ∣∣\n≤ |X | ((∆/2) + C2 max x∈X ∣∣ pX(x)− nx/N ∣∣) ≤ (|X |/2 + 1)∆ . (176)\nTherefore, q2 ∈ T∆(Q), so\nĈ∆k,N = Îk,N (X,Y )(w∗) ≤ I(fY |X)(q2) + ε ≤ C∆(fY |X) + ε. (177)\nOn the other hand, consider q∗∗ = arg maxqX∈T∆(Q) I(fY |X)(qX) again, and define (w0)x = q ∗∗(x)/pX(x). We know that (w0) ∈ T |X |∆ but not necessarily ∑N i=1(w0)Xi = N . But we claim that the sum is closed to N as follows\n∣∣ N∑ i=1 (w0)Xi −N ∣∣ = ∣∣ ∑ x∈X nxq ∗∗(x) pX(x) −N |\n≤ N max x∈X { q∗∗(x) pX(x) ∣∣ nx N − pX(x) ∣∣ } ≤ NC2 ∆\nC2|X | < N∆ (178)\nso we can find a (w1) ∈ T∆(W ) such that |(w1)x − (w0)x| ≤ ∆ for all x. Let q4(x) = (w1)xpX(x), similar as (176), we know that q4 ∈ T∆(Q). Moreover, ∣∣ q4(x) − q∗∗(x) ∣∣ ≤ pX(x)∣∣ (w1)x − (w0)x ∣∣ ≤ ∆ for all x. Then we have\nC∆(fY |X) = I(fY |X)(q ∗∗)\n≤ I(fY |X)(q4) + Lmax x∈X |q∗∗(x)− q4(x)|\n≤ Îk,N (X,Y )(w1) + ε+ L∆ = Ĉ∆k,N + ε+ L∆. (179)\nTherefore, we have |Ĉ∆k,N − C(fY |X)| < ε+O(∆), thus our proof is complete.\nB.1 Proof of Lemma 9\nWe will show that for any x ∈ X , we have | ∂∂qX(x)I(fY |X)(q)| ≤ L/|X | for some L. Therefore,∣∣ I(fY |X)(q)− I(fY |X)(q′) ∣∣ ≤ ∑ x∈X | ∂I(fY |X)(q) ∂qX(x) | |qX(x)− q′X(x)|\n≤ Lmax x∈X |qX(x)− q′X(x)| (180)\nLet fq(y) = ∑ x∈X qX(x)fY |X(y|x). Since qX(x) ∈ [C1pX(x), C2pX(x)] ⊆ [C1C5/|X |, C2C6/|X |] we\nknow that\nfq(y) ∈ [C1C5 min x∈X fY |X(y|x), C2C6 max x∈X fY |X(y|x)] (181)\nfor all x, y. Therefore, the absolute value of the gradient is bounded by∣∣∣ ∂I(fY |X)(q) ∂qX(x) ∣∣∣ =\n∣∣∣ ∂ ∂qX(x) ( ∑ x∈X qX(x) ∫ fY |X(y|x) log fY |X(y|x) fq(y) dy )∣∣∣\n= ∣∣∣ ∫ fY |X(y|x) log fY |X(y|x) fq(y) dy ∣∣∣+ ∣∣∣ ∑\nx′∈X qX(x\n′)\n∫ fY |X(y|x′)fY |X(y|x) fq(y) dy ∣∣∣\n≤ ∣∣∣max\ny log fY |X(y|x) fq(y) ∣∣∣+ ∣∣∣max y fY |X(y|x) fq(y) ∣∣∣ ≤ max{| logC1C5|, | logC2C6|}+ 1/(C1C5) (182)\nwhere L = |X |max{| logC1C5|, | logC2C6|}.\nC Proof of Lemma 1\nThe term in Equation (34) is upper bounded by:\n1\nN ∣∣∣ N∑ i=1 ( wig(Xi, Yi)− w′ig′(Xi, Yi) ) ∣∣∣ ≤ 1\nN N∑ i=1 ∣∣wig(Xi, Yi)− w′ig′(Xi, Yi)∣∣ ≤ 1\nN N∑ i=1 ( |wi − w′i| |g′(Xi, Yi)|+ wi ∣∣g(Xi, Yi)− g′(Xi, Yi)∣∣) = 1\nN N∑ i=1 ( |wi − w′i| |g′(Xi, Yi)|+ wi ∣∣ log(ny,i)− log(n′y,i)∣∣) ≤ 1\nN N∑ i=1 ( |wi − w′i| |g′(Xi, Yi)|+ wi ∣∣ny,i − n′y,i∣∣( 12ny,i + 12n′y,i ) )\n≤ 1 N N∑ i=1 |wi − w′i| |g′(Xi, Yi)|+ N∑ i=1 wi N ( ∑ j 6=i I{‖Yj − Yi| < ρk,i}|w′j − wj | 2 ∑ j 6=i I{‖Yj − Yi| < ρk,i}w′j + ∑ j 6=i I{‖Yj − Yi| < ρk,i}|w′j − wj | 2 ∑ j 6=i I{‖Yj − Yi| < ρk,i}wj ) ≤ 1\nN N∑ i=1 |wi − w′i| |g′(Xi, Yi)|+ N∑ i=1 wi N ( max1≤j≤N |w′j − wj | 2 min1≤j≤N w′j + max1≤j≤N |w′j − wj | 2 min1≤j≤N w′j ) ≤ max\n1≤i≤N |wi − w′i|\n( max\n1≤i≤N |g′(Xi, Yi)|+\n1\n2 min1≤j≤N w′j +\n1\n2 min1≤j≤N wj ) , (183)\nwhere the last inequality follows from the fact that ∑N i=1 wi = N . We upper bound each term as follows.\nw′j = u(Xi) fX(Xi) ≥ 1/µ(K) C2/µ(K) = 1/C2. (184)\nSimilarly we have w′j ≤ 1/C1. This implies that n′y,i = ∑ j 6=i w ′ jI{‖Yi−Yj‖ ≤ ρk,i} ≥ k/C2. For finite k and sufficiently large N , we have:\ng′(Xi, Yi) = ψ(k) + log(N) + log( cdxcdy cdx+dy\n)− ( log(nx,i) + log(ny,i) )\n≤ ψ(k) + log(N) + log( cdxcdy cdx+dy\n)− ( log(k) + log(k/C2) )\n≤ 2 logN , (185)\nand similarly, using the fact that ny,i = ∑ j 6=i w ′ jI{‖Yi − Yj‖ ≤ ρk,i} ≤ N/C1,\ng′(Xi, Yi) ≥ ψ(k) + log(N) + log( cdxcdy cdx+dy\n)− ( log(N) + log(N/C1) )\n≥ −2 logN. (186)\nWe claim that for sufficiently large Nsuch that logN > max{C2ε/3, 3C2/2}, if |wi − w′i| < ε/(3 logN) for all i, then (183) is upper bounded by ε.\nmax 1≤i≤N\n|wi − w′i| (\nmax 1≤i≤N\n|g′(Xi, Yi)|+ 1\n2 min1≤j≤N w′j +\n1\n2 min1≤j≤N wj )\n≤ ε 3 logN\n( 2 logN +\nC2 2 + 1\n2/C2 − ε3 logN ) ≤ ε\n3 logN\n( 2 logN +\nC2 2\n+ C2 ) ≤ ε. (187)\nPutting these bounds together, we have, for any ε > 0 and sufficiently large N ,\nP ( 1 N ∣∣ N∑ i=1 ( wig(Xi, Yi)− w′ig′(Xi, Yi) ) ∣∣ > ε) ≤ P( max 1≤i≤N |wi − w′i| > ε/(3 logN) ) . (188)\nDefine\nw′′i = N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) ) (189) and applying the triangle inequality and union bound for (188), we have\nP (\nmax 1≤i≤N\n|wi − w′i| > ε\n3 logN ) ≤ P ( max\n1≤i≤N |w′i − w′′i |+ max 1≤i≤N |w′′i − wi| >\nε\n3 logN ) ≤ P ( max\n1≤i≤N |w′i − w′′i | >\nε\n6 logN\n) (190)\n+ P (\nmax 1≤i≤N\n|w′′i − wi| > ε\n6 logN\n) . (191)\nFor (190), recall that w′i = u(Xi)/fX(Xi). Since u(Xi)/fX(Xi) ∈ [1/C2, 1/C1] for all i. Therefore\nP (\nmax 1≤i≤N\n|w′i − w′′i | > ε\n6 logN ) = P ( max\n1≤i≤N | u(Xi) fX(Xi) − N/fX(Xi)∑N j=1 ( 1/fX(Xj) ) | > ε 6 logN ) = P ( ( max\n1≤i≤N\nu(Xi)\nfX(Xi) ∣∣ 1− N∑N j=1 ( u(Xj)/fX(Xj) ) ∣∣ ) > ε 6 logN ) ≤ P\n( 1 C1 ∣∣ N∑ j=1 u(Xj) fX(Xj) −N ∣∣ > ε 6 logN N∑ j=1 u(Xj) fX(Xj) ) .\n≤ P ( ∣∣ N∑\nj=1\nu(Xj)\nfX(Xj) −N ∣∣ > ε 6 logN NC1 C2 ) . (192)\nNote that w′j = u(Xj) fX(Xj) are i.i.d. random variables with E[w′j ] = ∫ fX(x) u(x) fX(x)\ndx = 1 and w′j ∈ [1/C2, 1/C1]. Therefore, by Hoeffding’s inequality, we obtain:\nP ( ∣∣ N∑\nj=1\nu(Xj)\nfX(Xj) −N ∣∣ > εNC1 6 logNC2 )\n≤ 2 exp − 2 ( εNC1 6 logNC2 )2 N(1/C1 − 1/C2)2  = 2 exp { − ε\n2NC41 18(logN)2(C2 − C1)2\n} (193)\nwhich shows that the probability in (190) goes to 0 as N goes to infinity. For the probability in (191), recall that for any i,\n|w′′i − wi| = ∣∣ N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) ) − N/f̃X(Xi)∑N j=1 ( 1/f̃X(Xj) ) ∣∣. (194) We use the following lemma that shows an upper bound for the error of kernel density estimator.\nf̃X(Xi) = 1\n(N − 1)hdxN ∑ j 6=i K( Xj −Xi hN ). (195)\nLemma 10. Assume that K(u) ≤ A for all u, κj(K) = ∫ Rdx ‖u‖\njK(u)du < +∞ for any positive integer j ≥ 1 and ∫ Rdx uK(u)du = 0. By choosing hN = 1 2N −1/(2dx+3), we have for a given i ∈ {1, . . . , N},\nP ( ∣∣ f̃X(Xi)− fX(Xi) ∣∣ > N−1/(2dx+3)) ≤ 2 exp{−N1/(2dx+3)\n16A2 }. (196)\nApplying the union bound we get that with probability at least 1− 2N exp{−N 1/(2dx+3)\n16A2 }, we have\n|f̃X(Xi)− fX(Xi)| < N−1/(2dx+3) , (197)\nfor all i. When this bound holds, we claim that the event inside of the probability in (191) holds for sufficiently large N . Together with (193), this proves the desired claim: for given ε > 0 and large enough N ,\n1\nN ∣∣ N∑ i=1 ( wig(Xi, Yi)− w′ig′(Xi, Yi) ) ∣∣ ≤ ε (198)\nwith probability at least 1− 2N exp{−N 1/(2dx+3) 16A2 } − 2 exp{− ε2NC41\n18(logN)2(C2−C1)2 }. Now, we are left to show that (197) implies event inside of the probability in (191). Given (197), we\nhave\n| f̃X(Xi) fX(Xi)\n− 1| < N −1/(2dx+3) fX(Xi) < µ(K)N−1/(2dx+3) C1 (199)\nfor all i. Therefore, for sufficiently large N , wi − w′i is lower bounded by\nwi − w′′i = N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) ) − N/f̃X(Xi)∑N j=1 ( 1/f̃X(Xj) ) ≥ N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) )(1− 1 + µ(K)N−1/(2dx+3)C1 1− µ(K)N −1/(2dx+3)\nC1 ) ≥ N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) )(1− (1 + 3µ(K)N−1/(2dx+3) C1 ) )\n(200)\n≥ −3C2µ(K)N −1/(2dx+3)\nC21 , (201)\nwhere (200) follows from the fact that (1 + a)/(1 − a) ≤ 1 + 3a for a ∈ [0, 1/3], and (201) follows from the fact that C1/µ(K) ≤ fX(x) ≤ C2/µ(K). Similarly, it is upper bounded by\nwi − w′′i = N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) ) − N/f̃X(Xi)∑N j=1 ( 1/f̃X(Xj) ) ≤ N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) )(1− 1− µ(K)N−1/(2dx+3)C1 1 + µ(K)N −1/(2dx+3)\nC1 ) ≤ N/fX(Xi)∑N\nj=1\n( 1/fX(Xj) )(1− (1− 3µ(K)N−1/(2dx+3) C1 ) )\n≤ 3C2µ(K)N −1/(2dx+3)\nC21 . (202)\nHere (202) comes from the fact that (1 − a)/(1 + a) ≥ 1 − 3a for all a ≥ 0. Therefore, |wi − w′′i | ≤ 3C2µ(K)N\n−1/(2dx+3)/C21 . For a given ε > 0 and for sufficiently largeN such that ε/(6 logN) ≥ 3C2µ(K)N−1/(2dx+3)/C21 , we have\nP (\nmax 1≤i≤N\n|w′′i − wi| > ε\n6 logN ) ≤ P ( max\n1≤i≤N |wi − w′′i | >\n3C2µ(K)N −1/(2dx+3)\nC21 ) ≤ P ( ∀i , |f̃X(Xi)− fX(Xi)| < N−1/(2dx+3) ) .\nTogether with (188) and (193), this proves the desired convergence of the first term (34).\nD Proof of Proposition 2\nThe proof steps are similar to that of Proposition 1, only requiring citations to properties of Rényi divergence and asymmetric information.\n• Clearly Axiom 0 holds – it follows from a standard result that Dλ = 0 if and only if P = Q almost everywhere [Csi95].\n• Axiom 1: Suppose CMIλ(PZ|X) is achieved with P ∗X . Consider the joint distribution P ∗XPY |XPZ|Y . Utilizing the data-processing inequality for asymmetric mutual information (cf. Equation (55) in [PV10]), we get\nCMIλ(PY |X) = max PX\nKλ(PXPY |X) ≥ Kλ(P ∗XPY |X)\n≥ Kλ(P ∗XPZ|X) = CMIλ(PZ|X). (203)\nThus Axiom 1a is satisfied. Now consider Axiom 1b. With the same joint distribution, let P ∗Y be the marginal of Y . Then we have,\nCMIλ(PZ|Y ) = max PY\nKλ(PY PZ|Y ) ≥ Kλ(P ∗Y PZ|Y )\n≥ Kλ(P ∗XPZ|X) = CMIλ(PZ|X). (204)\n• Axiom 2: The asymmetric mutual information has the same additivity property as traditional mutual information, cf. Theorem 27 of [VEH14]. The corresponding additivity for CMIλ now follows.\n• Axiom 3a: The information-centroid representation for CMIλ states that (see [Csi95] or Equation (44) of [PV10]):\nCMIλ(PY |X) = min QY max x\nDλ(PY |X=x‖QY ). (205)\nThis characterization allows us to make the observation that CMIλ is a function only of the convex hull of the probability distributions PY |X=x, just as earlier: given a conditional probability distribution PY |X , we augment the input alphabet to have one more input symbol x\n′ such that PY |X=x′ = ∑ x αxPY |X=x is a convex combination of the other conditional distributions. We claim that the CMIλ of the new channel is unchanged: one direction is obvious, i.e., the new channel has capacity greater than or equal to the original channel, since adding a new symbol cannot decrease capacity. To show the other direction, we use (5) and observe that, due to the quasi convexity of Rényi divergence in its arguments (cf. Theorem 13 in [VEH14]), we get,\nDλ(PY |X=x′‖qY ) = Dλ( ∑ x αxPY |X=x‖qY ) ≤ max x Dλ(PY |X=x‖qY ).\nThus CMIλ is only a function of the convex hull of the range of the map PY |X , satisfying Axiom 3a. This function is monotonic directly from (205), thus satisfying Axiom 3b.\n• Axiom 4: For fixed output alphabet Y, it is clear that maxX ,PY |X CMIλ = log |Y| for each λ. Now suppose for some conditional distribution PY |X we have CMIλ(PY |X) = log |Y|. This implies that, with the optimizing input distribution, Hλ(Y ) − Hλ(Y |X) = log |Y|. This implies that Hλ(Y ) = log |Y| and Hλ(Y |X) = 0, thus Y is a deterministic function of the essential support of X and since Hλ(Y ) = log |Y|, the Schur concavity of Rényi entropy (cf. Theorem 1 of [HV15]) implies that PY = UY , the uniform distribution and the deterministic function is onto."
    } ],
    "references" : [ {
      "title" : "IEEE Transactions on",
      "author" : [ "Suguru Arimoto. An algorithm for computing the capacity of arbitrary discrete memoryless channels. Information Theory" ],
      "venue" : "18(1):14–20,",
      "citeRegEx" : "Ari72",
      "shortCiteRegEx" : null,
      "year" : 1972
    }, {
      "title" : "Nonparametric entropy estimation: An overview",
      "author" : [ "Jan Beirlant", "Edward J Dudewicz", "László Györfi", "Edward C Van der Meulen" ],
      "venue" : "International Journal of Mathematical and Statistical Sciences, 6(1):17–39,",
      "citeRegEx" : "BDGVdM97",
      "shortCiteRegEx" : null,
      "year" : 1997
    }, {
      "title" : "IEEE Transactions on",
      "author" : [ "Richard E Blahut. Computation of channel capacity", "rate-distortion functions. Information Theory" ],
      "venue" : "18(4):460–473,",
      "citeRegEx" : "Bla72",
      "shortCiteRegEx" : null,
      "year" : 1972
    }, {
      "title" : "Scandinavian Journal of Statistics",
      "author" : [ "Jean Cornuet", "Jean-Michel Marin", "Antonietta Mira", "Christian P Robert. Adaptive multiple importance sampling" ],
      "venue" : "39(4):798–812,",
      "citeRegEx" : "CMMR12",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Information theory and statistics: A tutorial",
      "author" : [ "Imre Csiszár", "Paul C Shields" ],
      "venue" : "Now Publishers Inc,",
      "citeRegEx" : "Csiszár and Shields.,? \\Q2004\\E",
      "shortCiteRegEx" : "Csiszár and Shields.",
      "year" : 2004
    }, {
      "title" : "Generalized cutoff rates and renyi’s information measures",
      "author" : [ "Imre Csiszár" ],
      "venue" : "Information Theory, IEEE Transactions on, 41(1):26–34,",
      "citeRegEx" : "Csi95",
      "shortCiteRegEx" : null,
      "year" : 1995
    }, {
      "title" : "Entropy",
      "author" : [ "Imre Csiszár. Axiomatic characterizations of information measures" ],
      "venue" : "10(3):261–273,",
      "citeRegEx" : "Csi08",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "Elements of information theory",
      "author" : [ "Thomas M Cover", "Joy A Thomas" ],
      "venue" : "John Wiley & Sons,",
      "citeRegEx" : "CT12",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "The Annals of Statistics",
      "author" : [ "Luc Devroye", "Clark S Penrod. The consistency of automatic kernel density estimates" ],
      "venue" : "pages 1231–1249,",
      "citeRegEx" : "DP84",
      "shortCiteRegEx" : null,
      "year" : 1984
    }, {
      "title" : "Demystifying fixed k-nearest neighbor information estimators",
      "author" : [ "Weihao Gao", "Sewoong Oh", "Pramod Viswanath" ],
      "venue" : "arXiv preprint arXiv:1604.03006,",
      "citeRegEx" : "GOV16",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "Efficient estimation of mutual information for strongly dependent variables",
      "author" : [ "Shuyang Gao", "Greg Ver Steeg", "Aram Galstyan" ],
      "venue" : "arXiv preprint arXiv:1411.2003,",
      "citeRegEx" : "GSG14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Estimating mutual information by local gaussian approximation",
      "author" : [ "Shuyang Gao", "Greg Ver Steeg", "Aram Galstyan" ],
      "venue" : "arXiv preprint arXiv:1508.00536,",
      "citeRegEx" : "GSG15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Locally parametric nonparametric density estimation",
      "author" : [ "Nils Lid Hjort", "MC Jones" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Hjort and Jones.,? \\Q1996\\E",
      "shortCiteRegEx" : "Hjort and Jones.",
      "year" : 1996
    }, {
      "title" : "Convexity/concavity of renyi entropy and α-mutual information",
      "author" : [ "Siu-Wai Ho", "Sergio Verdú" ],
      "venue" : "Information Theory (ISIT), 2015 IEEE International Symposium on, pages 745–749. IEEE,",
      "citeRegEx" : "HV15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "et al",
      "author" : [ "Dominik Janzing", "David Balduzzi", "Moritz Grosse-Wentrup", "Bernhard Schölkopf" ],
      "venue" : "Quantifying causal influences. The Annals of Statistics, 41(5):2324–2358,",
      "citeRegEx" : "JBGW13",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "Justifying Information-Geometric Causal Inference",
      "author" : [ "D. Janzing", "B. Steudel", "N. Shajarisales", "B. Schölkopf" ],
      "venue" : "chapter 18, pages 253–265. Springer International Publishing",
      "citeRegEx" : "JSSS15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Physical Review E",
      "author" : [ "Shiraj Khan", "Sharba Bandyopadhyay", "Auroop R Ganguly", "Sunil Saigal", "David J Erickson III", "Vladimir Protopopescu", "George Ostrouchov. Relative performance of mutual information estimation methods for quantifying the dependence among short", "noisy data" ],
      "venue" : "76(2):026209,",
      "citeRegEx" : "KBG07",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "divergences and mutual informations",
      "author" : [ "Kirthevasan Kandasamy", "Akshay Krishnamurthy", "Barnabas Poczos", "Larry Wasserman. Nonparametric von mises estimators for entropies" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 397–405,",
      "citeRegEx" : "KKPW15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Problemy Peredachi Informatsii",
      "author" : [ "LF Kozachenko", "Nikolai N Leonenko. Sample estimate of the entropy of a random vector" ],
      "venue" : "23(2):9–16,",
      "citeRegEx" : "KL87",
      "shortCiteRegEx" : null,
      "year" : 1987
    }, {
      "title" : "Estimating mutual information",
      "author" : [ "A. Kraskov", "H. Stögbauer", "P. Grassberger" ],
      "venue" : "Physical review E, 69(6):066138",
      "citeRegEx" : "KSG04",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "Dana Pe’er",
      "author" : [ "Smita Krishnaswamy", "Matthew H Spitzer", "Michael Mingueneau", "Sean C Bendall", "Oren Litvin", "Erica Stone" ],
      "venue" : "and Garry P Nolan. Conditional density-based analysis of t cell signaling in single-cell data. Science, 346(6213):1250689,",
      "citeRegEx" : "KSM14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Local likelihood density estimation",
      "author" : [ "Clive R Loader" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Loader,? \\Q1996\\E",
      "shortCiteRegEx" : "Loader",
      "year" : 1996
    }, {
      "title" : "Nonparametric k-nearest-neighbor entropy estimator",
      "author" : [ "Damiano Lombardi", "Sanjay Pant" ],
      "venue" : "Physical Review E,",
      "citeRegEx" : "Lombardi and Pant.,? \\Q2016\\E",
      "shortCiteRegEx" : "Lombardi and Pant.",
      "year" : 2016
    }, {
      "title" : "Modeling trends in distributions",
      "author" : [ "Jonas Mueller", "Tommi Jaakkola", "David Gifford" ],
      "venue" : "arXiv preprint arXiv:1511.04486,",
      "citeRegEx" : "MJG15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Signal processing",
      "author" : [ "Rudy Moddemeijer. On estimation of entropy", "mutual information of continuous distributions" ],
      "venue" : "16(3):233–248,",
      "citeRegEx" : "Mod89",
      "shortCiteRegEx" : null,
      "year" : 1989
    }, {
      "title" : "Distinguishing cause from effect using observational data: methods and benchmarks",
      "author" : [ "J.M. Mooij", "J. Peters", "D. Janzing", "J. Zscheischler", "B. Schölkopf" ],
      "venue" : "Journal of Machine Learning Research",
      "citeRegEx" : "MPJ15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Monte Carlo theory",
      "author" : [ "Art B. Owen" ],
      "venue" : "methods and examples.",
      "citeRegEx" : "Owe13",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "Neural computation",
      "author" : [ "Liam Paninski. Estimation of entropy", "mutual information" ],
      "venue" : "15(6):1191–1253,",
      "citeRegEx" : "Pan03",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Causality",
      "author" : [ "Judea Pearl" ],
      "venue" : "Cambridge university press,",
      "citeRegEx" : "Pea09",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "In Advances in Neural Information Processing Systems",
      "author" : [ "Dávid Pál", "Barnabás Póczos", "Csaba Szepesvári. Estimation of rényi entropy", "mutual information based on generalized nearest-neighbor graphs" ],
      "venue" : "pages 1849–1857,",
      "citeRegEx" : "PPS10",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "and Computing (Allerton)",
      "author" : [ "Yury Polyanskiy", "Sergio Verdú. Arimoto channel coding converse", "rényi divergence. In Communication", "Control" ],
      "venue" : "2010 48th Annual Allerton Conference on, pages 1327–1333. IEEE,",
      "citeRegEx" : "PV10",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "Nonparametric divergence estimation with applications to machine learning on distributions",
      "author" : [ "Barnabás Póczos", "Liang Xiong", "Jeff Schneider" ],
      "venue" : "arXiv preprint arXiv:1202.3758,",
      "citeRegEx" : "PXS12",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Non-parametric causal models",
      "author" : [ "Robin J Richardson", "Thomas S Evans" ],
      "venue" : null,
      "citeRegEx" : "Richardson and Evans.,? \\Q2015\\E",
      "shortCiteRegEx" : "Richardson and Evans.",
      "year" : 2015
    }, {
      "title" : "Acta mathematica hungarica",
      "author" : [ "Alfréd Rényi. On measures of dependence" ],
      "venue" : "10(3-4):441–451,",
      "citeRegEx" : "Rén59",
      "shortCiteRegEx" : null,
      "year" : 1959
    }, {
      "title" : "A mathematical theory of communication",
      "author" : [ "C.E. Shannon" ],
      "venue" : "Bell System Tech. J., 27:379423 and 623656",
      "citeRegEx" : "Sha48",
      "shortCiteRegEx" : null,
      "year" : 1948
    }, {
      "title" : "A reliable data-based bandwidth selection method for kernel density estimation",
      "author" : [ "Simon J Sheather", "Michael C Jones" ],
      "venue" : "Journal of the Royal Statistical Society. Series B (Methodological),",
      "citeRegEx" : "Sheather and Jones.,? \\Q1991\\E",
      "shortCiteRegEx" : "Sheather and Jones.",
      "year" : 1991
    }, {
      "title" : "Telling cause from effect in deterministic linear dynamical systems",
      "author" : [ "N. Shajarisales", "D. Janzing", "B. Schölkopf", "M. Besserve" ],
      "venue" : "Proceedings of the 32nd International Conference on Machine Learning, volume 37 of JMLR Workshop and Conference Proceedings, page 285?294. JMLR",
      "citeRegEx" : "SJSB15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "American journal of mathematical and management sciences",
      "author" : [ "Harshinder Singh", "Neeraj Misra", "Vladimir Hnizdo", "Adam Fedorowicz", "Eugene Demchuk. Nearest neighbor estimates of entropy" ],
      "venue" : "23(3-4):301–321,",
      "citeRegEx" : "SMH03",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Empirical estimation of entropy functionals with confidence",
      "author" : [ "Kumar Sricharan", "Raviv Raich", "Alfred O Hero III" ],
      "venue" : "arXiv preprint arXiv:1012.4188,",
      "citeRegEx" : "SRHI10",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "Scandinavian Journal of Statistics",
      "author" : [ "Alexandre B Tsybakov", "EC Van der Meulen. Root-n consistent estimators of entropy for densities with unbounded support" ],
      "venue" : "pages 75–83,",
      "citeRegEx" : "TVdM96",
      "shortCiteRegEx" : null,
      "year" : 1996
    }, {
      "title" : "IEEE Transactions on",
      "author" : [ "Tim Van Erven", "Peter Harremoës. Rényi divergence", "kullback-leibler divergence. Information Theory" ],
      "venue" : "60(7):3797–3820,",
      "citeRegEx" : "VEH14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "IEEE Transactions on",
      "author" : [ "Qing Wang", "Sanjeev R Kulkarni", "Sergio Verdú. Divergence estimation for multidimensional densities via-nearest-neighbor distances. Information Theory" ],
      "venue" : "55(5):2392–2405,",
      "citeRegEx" : "WKV09",
      "shortCiteRegEx" : null,
      "year" : 2009
    } ],
    "referenceMentions" : [ {
      "referenceID" : 14,
      "context" : "In fact, this measure is taken as a starting point to develop an axiomatic approach to studying causal strength on general graphs in [JBGW13].",
      "startOffset" : 133,
      "endOffset" : 141
    }, {
      "referenceID" : 20,
      "context" : "In a recent work [KSM14], potential causal influence is posited as a relevant metric to spot “trends” in gene pathways.",
      "startOffset" : 17,
      "endOffset" : 24
    }, {
      "referenceID" : 19,
      "context" : "The estimator brings together ideas from three disparate threads in statistical estimation theory: nearest-neighbor methods, a correlation boosting idea in the estimation of (standard) mutual information from samples [KSG04], and importance sampling.",
      "startOffset" : 217,
      "endOffset" : 224
    }, {
      "referenceID" : 18,
      "context" : "The estimator has only a single hyper parameter (the number of nearest-neighbors considered, set to 4 or 5 in practice), uses an offthe-shelf kernel density estimator of only PX , and has strong connections to the entropy estimator of [KL87].",
      "startOffset" : 235,
      "endOffset" : 241
    }, {
      "referenceID" : 24,
      "context" : "In simulations, the estimator has very strong performance in terms of sample complexity (compared to a baseline of the partition-based estimator in [Mod89]).",
      "startOffset" : 148,
      "endOffset" : 155
    }, {
      "referenceID" : 20,
      "context" : "• Application to gene pathway influence: In [KSM14], considered an important result in single-cell flow-cytometry data analysis, a causal strength metric (termed DREMI) is proposed for measuring the causal influence of a gene – this estimator is a specific way of implementing UMI along with a “channel amplification” step, and DREMI was successfully used to spot gene-pathway trends.",
      "startOffset" : 44,
      "endOffset" : 51
    }, {
      "referenceID" : 7,
      "context" : "Chapter 2 of [CT12].",
      "startOffset" : 13,
      "endOffset" : 19
    }, {
      "referenceID" : 7,
      "context" : "• Axiom 2: This is a standard result for Shannon capacity and we refer the interested reader to Chapter 7 of [CT12].",
      "startOffset" : 109,
      "endOffset" : 115
    }, {
      "referenceID" : 20,
      "context" : "This estimator is motivated by the recent work in [KSM14].",
      "startOffset" : 50,
      "endOffset" : 57
    }, {
      "referenceID" : 33,
      "context" : "This is also true of other measures of relation such as the Renyi correlation [Rén59], and in each case the measure is studied in the context of some form penalty term.",
      "startOffset" : 78,
      "endOffset" : 85
    }, {
      "referenceID" : 20,
      "context" : "1 Uniform Mutual Information The idea of applying UMI to infer the strength of conditional dependence was first proposed in [KSM14].",
      "startOffset" : 124,
      "endOffset" : 131
    }, {
      "referenceID" : 18,
      "context" : "[KL87]; (b) the correlation boosting idea of the estimator from [KSG04]–which is widely adopted in practice [KBG07]; and (c) the importance sampling techniques to adjust for the uniform prior for UMI.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 19,
      "context" : "[KL87]; (b) the correlation boosting idea of the estimator from [KSG04]–which is widely adopted in practice [KBG07]; and (c) the importance sampling techniques to adjust for the uniform prior for UMI.",
      "startOffset" : 64,
      "endOffset" : 71
    }, {
      "referenceID" : 16,
      "context" : "[KL87]; (b) the correlation boosting idea of the estimator from [KSG04]–which is widely adopted in practice [KBG07]; and (c) the importance sampling techniques to adjust for the uniform prior for UMI.",
      "startOffset" : 108,
      "endOffset" : 115
    }, {
      "referenceID" : 1,
      "context" : "Note that three applications of the entropy estimator, such as those from [BDGVdM97], gives an estimate of the mutual information, i.",
      "startOffset" : 74,
      "endOffset" : 84
    }, {
      "referenceID" : 18,
      "context" : "Alternatively, to bypass estimating PXY at every point, the differential entropy estimation can be done via k nearest neighbor (kNN) methods (pioneering work in [KL87]).",
      "startOffset" : 161,
      "endOffset" : 167
    }, {
      "referenceID" : 19,
      "context" : "Perhaps surprisingly, an innovative approach undertaken in [KSG04] to improve upon three applications of KL estimators provides a solution.",
      "startOffset" : 59,
      "endOffset" : 66
    }, {
      "referenceID" : 19,
      "context" : "The KSG estimator of [KSG04] is based on kNN distance ρk,i defined as the distance to the k-th nearest neighbor from (Xi, Yi) in `∞ distance, i.",
      "startOffset" : 21,
      "endOffset" : 28
    }, {
      "referenceID" : 9,
      "context" : "However, despite its popularity in practice due to its simplicity, no convergence result has been known until very recently (when [GOV16] showed some consistency and rate of convergence properties).",
      "startOffset" : 130,
      "endOffset" : 137
    }, {
      "referenceID" : 3,
      "context" : "where X ⊆ Rx , Y ⊆ Ry , cd = π d 2 /Γ(d2 + 1) is the volume of d-dimensional unit ball, and wi is the self-normalized importance sampling estimate [CMMR12] of u(Xi) f(Xi) : wi ≡ N/f̃(Xi) ∑N j=1 ( 1/f̃(Xj) ) , (16)",
      "startOffset" : 147,
      "endOffset" : 155
    }, {
      "referenceID" : 19,
      "context" : "For each sample (Xi, Yi), calculate the Euclidean distance ρk,i (as opposed to the `∞ distance proposed by [KSG04]) to the k-th nearest neighbor.",
      "startOffset" : 107,
      "endOffset" : 114
    }, {
      "referenceID" : 18,
      "context" : "As far as we know, the only estimator based on fixed-k nearest neighbors that is known to be consistent is the entropy estimator of [KL87], and the convergence rate is only known for the univariate case [TVdM96] (and that too under significant assumptions on the univariate density).",
      "startOffset" : 132,
      "endOffset" : 138
    }, {
      "referenceID" : 39,
      "context" : "As far as we know, the only estimator based on fixed-k nearest neighbors that is known to be consistent is the entropy estimator of [KL87], and the convergence rate is only known for the univariate case [TVdM96] (and that too under significant assumptions on the univariate density).",
      "startOffset" : 203,
      "endOffset" : 211
    }, {
      "referenceID" : 18,
      "context" : "Uniform Mutual Information: As our estimators use the off-the-shelf kernel density estimator of PX [DP84, SJ91] and also the ides from the nearest-neighbor methods [KL87], we make assumptions on the conditional density fY |X that are typical in these literature.",
      "startOffset" : 164,
      "endOffset" : 170
    }, {
      "referenceID" : 20,
      "context" : "1 Gene Causal Strength from Single Cell Data We briefly describe the setup of [KSM14] to motivate our numerical experiments.",
      "startOffset" : 78,
      "endOffset" : 85
    }, {
      "referenceID" : 20,
      "context" : "Figure 1: CMI and UMI estimators significantly improve over DREMI in capturing the biological trend in flow-cytometry data: the figures above refer to the same setting as Figure 6 of [KSM14].",
      "startOffset" : 183,
      "endOffset" : 190
    }, {
      "referenceID" : 20,
      "context" : "These samples are obtained using a technique called single-cell mass flow cytometry, see [KSM14] for details.",
      "startOffset" : 89,
      "endOffset" : 96
    }, {
      "referenceID" : 20,
      "context" : "Such an analysis is conducted in [KSM14] where the causal strength function C is evaluated via the so-called DREMI estimator (essentially a version of UMI estimation with a “channel amplification” step and careful choice of hyper parameters therein – no theoretical properties of this estimator were evaluated).",
      "startOffset" : 33,
      "endOffset" : 40
    }, {
      "referenceID" : 20,
      "context" : "This demonstrates the utility of DREMI for causal strength inference in gene networks (see Figure 6 of [KSM14]).",
      "startOffset" : 103,
      "endOffset" : 110
    }, {
      "referenceID" : 23,
      "context" : "As an aside, we note that a somewhat different set of “trend spotting” estimators, primarily trying to find genes which demonstrate a monotonic trend over time from single-cell RNA-sequencing data, have been proposed very recently in [MJG15].",
      "startOffset" : 234,
      "endOffset" : 241
    }, {
      "referenceID" : 20,
      "context" : "It is natural to apply our estimators to each time point in the same setting as [KSM14] – and look to understand two distinct issues in our experiments with the flow-cytometry data.",
      "startOffset" : 80,
      "endOffset" : 87
    }, {
      "referenceID" : 20,
      "context" : "The second question relates to the sample complexity: how does the ability to recover the trend vary as a function of the sample complexity? To study this, we subsample the original data from [KSM14] multiple times (100 in the experiments) at each subsampling ratio and compute the fraction of times we recover the true biological trend.",
      "startOffset" : 192,
      "endOffset" : 199
    }, {
      "referenceID" : 24,
      "context" : "Figure 2: The proposed UMI estimator significantly outperforms partition based methods [Mod89] in sample complexity.",
      "startOffset" : 87,
      "endOffset" : 94
    }, {
      "referenceID" : 24,
      "context" : "This is compared to the ground truth and the state-of-the-art partition based estimators from [Mod89].",
      "startOffset" : 94,
      "endOffset" : 101
    }, {
      "referenceID" : 19,
      "context" : "The ground truth has been computed via simulations with 8192 samples from the desired distribution PY |XUX using Kraskov’s mutual information estimator [KSG04].",
      "startOffset" : 152,
      "endOffset" : 159
    }, {
      "referenceID" : 19,
      "context" : "The consistency proofs suggest that a similar analysis the very popular estimator of (traditional) mutual information in [KSG04] can be conducted successfully; such work has been recently conducted in [GOV16].",
      "startOffset" : 121,
      "endOffset" : 128
    }, {
      "referenceID" : 9,
      "context" : "The consistency proofs suggest that a similar analysis the very popular estimator of (traditional) mutual information in [KSG04] can be conducted successfully; such work has been recently conducted in [GOV16].",
      "startOffset" : 201,
      "endOffset" : 208
    }, {
      "referenceID" : 39,
      "context" : "Rates of convergence in the nearest-neighbor methods are barely known in the literature even for traditional information theoretic quantities: for instance, [TVdM96] derives a √ N consistency for the single dimensional case of differential entropy estimation (under strong assumptions on the underlying",
      "startOffset" : 157,
      "endOffset" : 165
    }, {
      "referenceID" : 9,
      "context" : "pdf), leaving higher dimensional scenarios open, and which recently have been successfully addressed in [GOV16].",
      "startOffset" : 104,
      "endOffset" : 111
    }, {
      "referenceID" : 18,
      "context" : "(b) There is a natural generalization of our estimators when the alphabet Y is high dimensional, using the kNN approach (just as in the differential entropy estimator of [KL87] or in the mutual information estimator of [KSG04]).",
      "startOffset" : 170,
      "endOffset" : 176
    }, {
      "referenceID" : 19,
      "context" : "(b) There is a natural generalization of our estimators when the alphabet Y is high dimensional, using the kNN approach (just as in the differential entropy estimator of [KL87] or in the mutual information estimator of [KSG04]).",
      "startOffset" : 219,
      "endOffset" : 226
    }, {
      "referenceID" : 28,
      "context" : "This is a widely studied topic with a long lineage [Pea09] but also of strong topical interest [JBGW13, JSSS15, MPJ15, SJSB15].",
      "startOffset" : 51,
      "endOffset" : 58
    }, {
      "referenceID" : 25,
      "context" : "A natural inclination is to explore the efficacy of UMI and CMI measures to test for direction of causality – especially in the context of the benchmark data sets collected in [MPJ15].",
      "startOffset" : 176,
      "endOffset" : 183
    }, {
      "referenceID" : 18,
      "context" : "Directly comparing the marginal entropy H(X) and H(Y ) by the estimator in [KL87] also only provides 45% accuracy.",
      "startOffset" : 75,
      "endOffset" : 81
    }, {
      "referenceID" : 25,
      "context" : "While in [MPJ15], different entropy estimators (with appropriate hyper parameter choices) were applied to get an accuracy up to 60%-70%.",
      "startOffset" : 9,
      "endOffset" : 16
    }, {
      "referenceID" : 25,
      "context" : "Further research is needed to shed conclusive light, although we point out that the benchmark data sets in [MPJ15] have substantial confounding factors that make causal direction hard to measure in the first place.",
      "startOffset" : 107,
      "endOffset" : 114
    }, {
      "referenceID" : 5,
      "context" : "Now define the asymmetric information measure [Csi95]: Kλ(PXPY |X) := inf QY Dλ(PXY ‖PXQY ), (25) which converges to the traditional mutual information when λ → 1.",
      "startOffset" : 46,
      "endOffset" : 53
    }, {
      "referenceID" : 20,
      "context" : "In the light of this result, it would be interesting to design estimators for the more general family of Rényi capacity measures and confirm their performance on empirical tasks such as the ones studied in [KSM14].",
      "startOffset" : 206,
      "endOffset" : 213
    }, {
      "referenceID" : 6,
      "context" : "It would also be very interesting to understand the role of additional axioms that would lead to uniqueness of Shannon capacity (in the same spirit as entropy being uniquely characterized by somewhat similar axioms [Csi08]).",
      "startOffset" : 215,
      "endOffset" : 222
    }, {
      "referenceID" : 0,
      "context" : "References [Ari72] Suguru Arimoto.",
      "startOffset" : 11,
      "endOffset" : 18
    }, {
      "referenceID" : 1,
      "context" : "[BDGVdM97] Jan Beirlant, Edward J Dudewicz, László Györfi, and Edward C Van der Meulen.",
      "startOffset" : 0,
      "endOffset" : 10
    }, {
      "referenceID" : 2,
      "context" : "[Bla72] Richard E Blahut.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 3,
      "context" : "[CMMR12] Jean Cornuet, Jean-Michel Marin, Antonietta Mira, and Christian P Robert.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 5,
      "context" : "[Csi95] Imre Csiszár.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 6,
      "context" : "[Csi08] Imre Csiszár.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 7,
      "context" : "[CT12] Thomas M Cover and Joy A Thomas.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 8,
      "context" : "[DP84] Luc Devroye and Clark S Penrod.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 9,
      "context" : "[GOV16] Weihao Gao, Sewoong Oh, and Pramod Viswanath.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 10,
      "context" : "[GSG14] Shuyang Gao, Greg Ver Steeg, and Aram Galstyan.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 11,
      "context" : "[GSG15] Shuyang Gao, Greg Ver Steeg, and Aram Galstyan.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 13,
      "context" : "[HV15] Siu-Wai Ho and Sergio Verdú.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 14,
      "context" : "[JBGW13] Dominik Janzing, David Balduzzi, Moritz Grosse-Wentrup, Bernhard Schölkopf, et al.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 15,
      "context" : "[JSSS15] D.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 16,
      "context" : "[KBG07] Shiraj Khan, Sharba Bandyopadhyay, Auroop R Ganguly, Sunil Saigal, David J Erickson III, Vladimir Protopopescu, and George Ostrouchov.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 17,
      "context" : "[KKPW15] Kirthevasan Kandasamy, Akshay Krishnamurthy, Barnabas Poczos, and Larry Wasserman.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 18,
      "context" : "[KL87] LF Kozachenko and Nikolai N Leonenko.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 19,
      "context" : "[KSG04] A.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 20,
      "context" : "[KSM14] Smita Krishnaswamy, Matthew H Spitzer, Michael Mingueneau, Sean C Bendall, Oren Litvin, Erica Stone, Dana Pe’er, and Garry P Nolan.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 23,
      "context" : "[MJG15] Jonas Mueller, Tommi Jaakkola, and David Gifford.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 24,
      "context" : "[Mod89] Rudy Moddemeijer.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 25,
      "context" : "[MPJ15] J.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 26,
      "context" : "[Owe13] Art B.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 27,
      "context" : "[Pan03] Liam Paninski.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 28,
      "context" : "[Pea09] Judea Pearl.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 29,
      "context" : "[PPS10] Dávid Pál, Barnabás Póczos, and Csaba Szepesvári.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 30,
      "context" : "[PV10] Yury Polyanskiy and Sergio Verdú.",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 31,
      "context" : "[PXS12] Barnabás Póczos, Liang Xiong, and Jeff Schneider.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 33,
      "context" : "[Rén59] Alfréd Rényi.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 34,
      "context" : "[Sha48] C.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 36,
      "context" : "[SJSB15] N.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 37,
      "context" : "[SMH03] Harshinder Singh, Neeraj Misra, Vladimir Hnizdo, Adam Fedorowicz, and Eugene Demchuk.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 38,
      "context" : "[SRHI10] Kumar Sricharan, Raviv Raich, and Alfred O Hero III.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 39,
      "context" : "[TVdM96] Alexandre B Tsybakov and EC Van der Meulen.",
      "startOffset" : 0,
      "endOffset" : 8
    }, {
      "referenceID" : 40,
      "context" : "[VEH14] Tim Van Erven and Peter Harremoës.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 41,
      "context" : "[WKV09] Qing Wang, Sanjeev R Kulkarni, and Sergio Verdú.",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 26,
      "context" : "1 in [Owe13]).",
      "startOffset" : 5,
      "endOffset" : 12
    }, {
      "referenceID" : 37,
      "context" : "By Theorem 8 of [SMH03], we have",
      "startOffset" : 16,
      "endOffset" : 23
    }, {
      "referenceID" : 29,
      "context" : "Similar interchange of limit has been used in [KL87, WKV09] without the regularization; in this context [PPS10] claims that this step is not justified (although no counterexample is pointed out).",
      "startOffset" : 104,
      "endOffset" : 111
    }, {
      "referenceID" : 37,
      "context" : "(52) Moreover, by Theorem11 of [SMH03], we have:",
      "startOffset" : 31,
      "endOffset" : 38
    }, {
      "referenceID" : 37,
      "context" : "[SMH03], we have lim N→∞ E [ log f̂Y |X(Yi|Xi) ∣∣(Xi, Yi) = (x, y)] = log fY |X(y|x) , (134)",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 37,
      "context" : "[SMH03], we have:",
      "startOffset" : 0,
      "endOffset" : 7
    }, {
      "referenceID" : 5,
      "context" : "• Clearly Axiom 0 holds – it follows from a standard result that Dλ = 0 if and only if P = Q almost everywhere [Csi95].",
      "startOffset" : 111,
      "endOffset" : 118
    }, {
      "referenceID" : 30,
      "context" : "Equation (55) in [PV10]), we get CMIλ(PY |X) = max PX Kλ(PXPY |X) ≥ Kλ(P ∗ XPY |X) ≥ Kλ(P ∗ XPZ|X) = CMIλ(PZ|X).",
      "startOffset" : 17,
      "endOffset" : 23
    }, {
      "referenceID" : 40,
      "context" : "Theorem 27 of [VEH14].",
      "startOffset" : 14,
      "endOffset" : 21
    }, {
      "referenceID" : 5,
      "context" : "• Axiom 3a: The information-centroid representation for CMIλ states that (see [Csi95] or Equation (44) of [PV10]): CMIλ(PY |X) = min QY max x Dλ(PY |X=x‖QY ).",
      "startOffset" : 78,
      "endOffset" : 85
    }, {
      "referenceID" : 30,
      "context" : "• Axiom 3a: The information-centroid representation for CMIλ states that (see [Csi95] or Equation (44) of [PV10]): CMIλ(PY |X) = min QY max x Dλ(PY |X=x‖QY ).",
      "startOffset" : 106,
      "endOffset" : 112
    }, {
      "referenceID" : 40,
      "context" : "Theorem 13 in [VEH14]), we get, Dλ(PY |X=x′‖qY ) = Dλ( ∑",
      "startOffset" : 14,
      "endOffset" : 21
    }, {
      "referenceID" : 13,
      "context" : "Theorem 1 of [HV15]) implies that PY = UY , the uniform distribution and the deterministic function is onto.",
      "startOffset" : 13,
      "endOffset" : 19
    } ],
    "year" : 2016,
    "abstractText" : "We consider axiomatically the problem of estimating the strength of a conditional dependence relationship PY |X from a random variables X to a random variable Y . This has applications in determining the strength of a known causal relationship, where the strength depends only on the conditional distribution of the effect given the cause (and not on the driving distribution of the cause). Shannon capacity, appropriately regularized, emerges as a natural measure under these axioms. We examine the problem of calculating Shannon capacity from the observed samples and propose a novel fixed-k nearest neighbor estimator, and demonstrate its consistency. Finally, we demonstrate an application to single-cell flow-cytometry, where the proposed estimators significantly reduce sample complexity.",
    "creator" : "LaTeX with hyperref package"
  }
}