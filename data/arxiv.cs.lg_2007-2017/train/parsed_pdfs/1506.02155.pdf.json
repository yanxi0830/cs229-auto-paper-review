{
  "name" : "1506.02155.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Optimal Rates for Random Fourier Features",
    "authors" : [ "Bharath K. Sriperumbudur", "Zoltán Szabó" ],
    "emails" : [ "bks18@psu.edu", "zoltan.szabo@gatsby.ucl.ac.uk" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 6.\n02 15\n5v 1\n[ m\nat h.\nST ]"
    }, {
      "heading" : "1 Introduction",
      "text" : "Kernel methods [19] have enjoyed tremendous success in solving several fundamental problems of machine learning ranging from classification, regression, feature extraction, dependency estimation, causal discovery, Bayesian inference and hypothesis testing. Such a success owes to their capability to represent and model complex relations by mapping points into high (possibly infinite) dimensional feature spaces. At the heart of all these techniques is the kernel trick, which allows to implicitly compute inner products between these high dimensional feature maps, λ via a kernel function k: k(x,y) = 〈λ(x), λ(y)〉. However, this flexibility and richness of kernels has a price: by resorting to implicit computations these methods operate on the Gram matrix of the data, which raises serious computational challenges while dealing with large scale data. In order to resolve this bottleneck, numerous solutions have been proposed, such as low-rank matrix approximations [28, 9, 1], explicit feature maps designed for additive kernels [26, 14], hashing [22, 12], and random Fourier features (RFF) [16] constructed for shift-invariant kernels, the focus of the current paper.\nRFFs implement an extremely simple, yet efficient idea: instead of relying on the implicit feature map λ associated with the kernel, by appealing to Bochner’s theorem [27]—any bounded, continuous, shift-invariant\n∗Contributed equally.\nkernel is the Fourier transform of a probability measure—-[16] proposed an explicit low-dimensional random Fourier feature map φ obtained by empirically approximating the Fourier integral so that k(x,y) ≈ 〈φ(x), φ(y)〉. The advantage with this explicit low-dimensional feature representation is that the kernel machine can be efficiently solved in the primal form through fast linear solvers, thereby enabling to handle large scale data. Through numerical experiments, it has also been demonstrated that kernel algorithms constructed using the approximate kernel do not suffer from significant performance degradation [16]. Another advantage with the RFF approach is that unlike low rank matrix approximation approach [28, 9] which also speeds up kernel machines, it approximates the entire kernel function and not just the kernel matrix. This property is particularly useful while dealing with out of sample data and also in online learning applications. The RFF technique has found wide applicability in several areas such as fast function-to-function regression [15], differential privacy preserving [4] and causal discovery [13].\nDespite the success of the RFF method, surprisingly, very little is known about its performance guarantees. To the best of our knowledge, the only paper in the machine learning literature providing certain theoretical insight into the accuracy of kernel approximation via RFF is [16]: it shows that Am := sup{|k(x,y) − 〈φ(x), φ(y)〉R2m | : x,y ∈ S} = Op( √\nlog(m)/m) for any compact set S ⊂ Rd, where m is the number of random Fourier features. However, since the approximation proposed by the RFF method involves empirically approximating the Fourier integral, the RFF estimator can be thought of as an empirical characteristic function (ECF). In the probability and statistics literature, the systematic study of ECF-s was initiated by [10] and followed up by [7, 6, 30]. While [10] shows the almost sure convergence of Am to zero, [7, Theorems 1 and 2] and [30, Theorems 6.2 and 6.3] show that the optimal rate is m−1/2. In addition, [10] shows that almost sure convergence cannot be attained over the entire space (i.e., Rd) if the characteristic function decays to zero at infinity. Due to this, [7, 30] study the convergence behavior of Am when the diameter of S grows with m and show that almost sure convergence of Am is guaranteed as long as the diameter of S is eo(m). Unfortunately, all these results (to the best of our knowledge) are asymptotic in nature and the only known finite sample guarantee by [16] is non-optimal. In this paper (see Section 3), we present a probabilistic inequality for Am that holds for any m and provides the optimal rate of m−1/2 along with guaranteeing the almost sure convergence of Am as long as the diameter of S is eo(m). Apart from the uniform convergence, we also study the convergence of k(x,y) − 〈φ(x), φ(y)〉R2m in Lr-norm (1 ≤ r < ∞) and obtain an optimal convergence rate of m−1/2. Traditionally, kernel based algorithms involve computing the value of the kernel. Recently, kernel algorithms involving the derivatives of the kernel (i.e., the Gram matrix consists of derivatives of the kernel computed at training samples) have been used to address numerous machine learning tasks, e.g., semi-supervised or Hermite learning with gradient information [32, 21], nonlinear variable selection [17, 18], (multi-task) gradient learning [29] and fitting of infinite-dimensional exponential family distributions [23]. Given the importance of these derivative based kernel algorithms, similar to [16], which proposed an elegant approach to speed up the classical kernel based methods by approximating the kernel through a finite dimensional random feature map φ, in Section 4, we propose a finite dimensional random feature map approximation to kernel derivatives (which can be used to speed up the above mentioned derivative based kernel algorithms). We present a finite sample bound that quantifies the quality of approximation in uniform and Lr-norms and show the rate of convergence to be m−1/2 in both these cases.\nA summary of our contributions are as follows. We\n1. provide the first detailed finite sample performance analysis of RFFs for approximating kernels and their derivatives. 2. prove uniform and Lr convergence on fixed compacts sets with optimal rate in terms of the RFF dimension (m);\n3. provide sufficient conditions for the growth rate of compact sets while preserving almost sure convergence uniformly and in Lr; specializing our result we match the best attainable asymptotic growth rate.\nVarious notations and definitions that are used through the paper are provided in Section 2 along with a brief review of RFF approximation proposed by [16]. The detailed proofs of the results in Sections 3 and 4 are provided in the supplementary material."
    }, {
      "heading" : "2 Notations & Preliminaries",
      "text" : "In this section, we introduce notations that are used throughout the paper and then present preliminaries on kernel approximation through random feature maps as introduced by [16].\nDefinitions & Notation: For a topological space X , C(X ) (resp. Cb(X )) denotes the space of all continuous (resp. bounded continuous) functions on X . For f ∈ Cb(X ), ‖f‖∞ := supx∈X |f(x)| is the supremum norm of f (we also write it as ‖f‖X ). Mb(X ) and M1+(X ) is the set of all finite Borel and probability measures on X , respectively. For µ ∈ Mb(X ), Lr(X , µ) denotes the Banach space of r-power (r ≥ 1) µ-integrable functions. For X ⊆ Rd, we will use Lr(X ) for Lr(X , µ) if µ is a Lebesgue measure on X . For f ∈ Lr(X , µ), ‖f‖Lr(X ,µ) := (∫ X |f |r dµ )1/r\ndenotes the Lr-norm of f for 1 ≤ r < ∞ and we write it as ‖ · ‖Lr(X ) if X ⊆ Rd and µ is the Lebesgue measure. For any f ∈ L1(X ,P) where P ∈ M1+(X ), we define Pf := ∫\nX f(x) dP(x) and Pmf := 1 m ∑m i=1 f(Xi) where (Xi) m i=1 i.i.d.∼ P, Pm := 1m ∑m\ni=1 δXi is the empirical measure and δx is a Dirac measure supported on x ∈ X . supp(P) denotes the support of P. Pm := ⊗mj=1P denotes the m-fold product measure. For v := (v1, . . . , vd) ∈ Rd, ‖v‖2 := √ ∑d i=1 v 2 i . The diameter of A ⊆ Y where (Y, ρ) is a metric space is defined as |A|ρ := sup{ρ(x, y) : x, y ∈ Y}. If Y = Rd with ρ = ‖ · ‖2, we denote the diameter of A as |A|. The volume of A ⊆ Rd is defined as vol(A) = ∫\nA 1 dx respectively. For A ⊆ Rd, we define\nA∆ := A − A = {x − y : x,y ∈ A}. conv(A) is the convex hull of A. For a function g defined on open set B ⊆ Rd × Rd, ∂p,qg(x,y) := ∂\n|p|+|q|g(x,y) ∂x\np1 1 ···∂x pd d ∂y q1 1 ···∂y qd d , (x,y) ∈ B, where p,q ∈ Nd are multi-indices, |p| = ∑dj=1 pj and N := {0, 1, 2, . . .}. Define vp = ∏d j=1 v pj j . For positive sequences (an)n∈N, (bn)n∈N, an = o(bn) if limn→∞ anbn = 0. Xn = Op(rn) (resp. Oa.s.(rn)) denotes that Xn rn is bounded in probability (resp. almost surely). Γ(t) = ∫∞ 0 x t−1e−x dx is the Gamma function, Γ ( 1 2 ) = √ π and Γ(t+ 1) = tΓ(t).\nRandom feature maps: Let k : Rd × Rd → R be a bounded, continuous, positive definite, translationinvariant kernel, i.e., there exists a positive definite function ψ : Rd → R such that k(x,y) = ψ(x − y), x,y ∈ Rd where ψ ∈ Cb(Rd). By Bochner’s theorem [27, Theorem 6.6], ψ can be represented as the Fourier transform of a finite non-negative Borel measure Λ on Rd, i.e.,\nk(x,y) = ψ(x− y) = ∫\nRd\ne √ −1ωT (x−y)dΛ(ω) (⋆) =\n∫\nRd\ncos ( ω T (x− y) ) dΛ(ω), (1)\nwhere (⋆) follows from the fact that ψ is real-valued and symmetric. Since Λ(Rd) = ψ(0), k(x,y) = ψ(0) ∫ e √ −1ωT (x−y) dP(ω) where P := Λψ(0) ∈ M1+(Rd). Therefore, w.l.o.g., we assume throughout the paper that ψ(0) = 1 and so Λ ∈ M1+(Rd). Based on (1), [16] proposed an approximation to k by replacing Λ with its empirical measure, Λm constructed from (ωi)mi=1 i.i.d.∼ Λ so that resultant approximation can be\nwritten as the Euclidean inner product of finite dimensional random feature maps, i.e.,\nk̂(x,y) = 1\nm\nm∑\ni=1\ncos ( ω\nT i (x− y)\n) (∗) = 〈φ(x), φ(y)〉\nR2m , (2)\nwhere φ(x) = 1√ m (cos(ωT1 x), . . . , cos(ω T mx), sin(ω T 1 x), . . . , sin(ω T mx)) and (∗) holds based on the basic trigonometric identity: cos(a− b) = cos a cos b+sina sin b. This elegant approximation to k is particularly useful in speeding up kernel-based algorithms as the finite-dimensional random feature map φ can be used to solve these algorithms in the primal thereby offering better computational complexity (than by solving them in the dual) while at the same time not lacking in performance. Apart from these practical advantages, [16, Claim 1] provides a theoretical guarantee that supx,y∈S |k̂(x,y)−k(x,y)| → 0 as m → ∞ for any compact set S ⊆ Rd. Formally, [16, Claim 1] showed that—note that (3) is slightly different but more precise than the one in the statement of Claim 1 in [16]—for any ǫ > 0,\nΛm\n({\n(ωi) m i=1 : sup x,y∈S |k̂(x,y) − k(x,y)| ≥ ǫ\n})\n≤ Cd ( |S|σǫ−1 ) 2d d+2 e− mǫ2 4(d+2) , (3)\nwhere σ2 := ∫ ‖ω‖2 dΛ(ω) and Cd := 2 6d+2 d+2 (( 2 d ) d d+2 + ( d 2 ) 2 d+2 )\n≤ 27d when d ≥ 2. The condition σ2 < ∞ implies that ψ (and therefore k) is twice differentiable. From (3) it is clear that the probability has polynomial tails if ǫ < |S|σ (i.e., small ǫ) and Gaussian tails if ǫ ≥ |S|σ (i.e., large ǫ) and can be equivalently written as\nΛm\n({\n(ωi) m i=1 : sup x,y∈S |k̂(x,y) − k(x,y)| ≥ C\nd+2 2d d |S|σ √ m−1 logm\n})\n≤ m α4(d+2) (logm)− dd+2 , (4)\nwhere α := 4d− C d+2 d\nd |S|2σ2. For |S| sufficiently large (i.e., α < 0), it follows from (4) that\nsup x,y∈S\n|k̂(x,y) − k(x,y)| = Op ( |S| √ m−1 logm ) . (5)\nWhile (5) shows that k̂ is a consistent estimator of k in the topology of compact convergence (i.e., k̂ convergences to k uniformly over compact sets), the rate of convergence of √\n(logm)/m is not optimal. In addition, the order of dependence on |S| is not optimal. While a faster rate (in fact, an optimal rate) of convergence is desired—better rates in (5) can lead to better convergence rates for the excess error of the kernel machine constructed using k̂—, the order of dependence on |S| is also important as it determines the rate at which |S| can be grown as a function of m when m → ∞ (see Remark 1(ii) for a discussion about the significance of growing |S|). In the following section, we present an analogue of (4)—see Theorem 1—that provides optimal rates and has correct dependence on |S|."
    }, {
      "heading" : "3 Main results: Approximation of k",
      "text" : "As discussed in Sections 1 and 2, while the random feature map approximation of k introduced by [16] has many practical advantages, it does not seem to be theoretically well understood. The existing theoretical results on the quality of approximation do not provide a complete picture owing to their non-optimality. In this section, we first present our main result (see Theorem 1) that improves upon (4) and provides a rate of m−1/2 with logarithm dependence on |S|. We then discuss the consequences of Theorem 1 along with its optimality in Remark 1. Next, in Corollary 2 and Theorem 3, we discuss the Lr-convergence (1 ≤ r < ∞) of k̂ to k over compact subsets of Rd.\nTheorem 1. Suppose k(x,y) = ψ(x − y), x, y ∈ Rd where ψ ∈ Cb(Rd) is positive definite and σ2 :=∫ ‖ω‖2 dΛ(ω) < ∞. Then for any τ > 0 and non-empty compact set S ⊂ Rd,\nΛm\n({\n(ωi) m i=1 : sup x,y∈S |k̂(x,y) − k(x,y)| ≥ h(d, |S|, σ) +\n√ 2τ√\nm\n})\n≤ e−τ ,\nwhere h(d, |S|, σ) := 32 √ 2d log(|S|+ 1) + 32 √ 2d log(σ + 1) + 16 √ 2d(log(|S|+ 1))−1.\nProof (sketch). Note that supx,y∈S |k̂(x,y) − k(x,y)| = supg∈G |Λmg − Λg|, where G := {gx,y(ω) = cos(ωT (x − y)) : x,y ∈ S}, which means the object of interest is the suprema of an empirical process indexed by G. Instead of bounding supg∈G |Λmg−Λg| by using Hoeffding’s inequality on a cover of G and then applying union bound as carried out in [16], we use the refined technique of applying concentration via McDiarmid’s inequality, followed by symmetrization and bound the Rademacher average by Dudley entropy bound. The result is obtained by carefully bounding the L2(Λm)-covering number of G. The details are provided in Section B.1 of the supplementary material.\nRemark 1.\n(i) Theorem 1 shows that k̂ is a consistent estimator of k in the topology of compact convergence as m → ∞ with the rate of a.s. convergence being √\nm−1 log |S| (almost sure convergence is guaranteed by the first Borel-Cantelli lemma). In comparison to (4), it is clear that Theorem 1 provides improved rates with better constants and logarithmic dependence on |S| instead of a linear dependence. (ii) Growing diameter: While Theorem 1 provides almost sure convergence uniformly over compact sets, one might wonder whether it is possible to achieve uniform convergence over Rd. [10, Section 2] showed that such a result is possible if Λ is a discrete measure but not possible for Λ that is absolutely continuous w.r.t. the Lebesgue measure (i.e., if Λ has a density). Since uniform convergence of k̂ to k over Rd is not possible for many interesting k (e.g., Gaussian kernel), it is of interest to study the convergence on S whose diameter grows with m. Therefore, as mentioned in Section 2, the order of dependence of rates on |S| is critical. Suppose |Sm| → ∞ as m → ∞ (we write |Sm| instead of |S| to show the explicit dependence on m). Then Theorem 1 shows that k̂ is a consistent estimator of k in the topology of compact convergence if m−1 log |Sm| → 0 as m → ∞ (i.e., |Sm| = eo(m)) in contrast to the result in (4) which requires |Sm| = o( √\nm/ logm). In other words, Theorem 1 ensures consistency even when |Sm| grows exponential in m where as (4) ensures consistency only if |Sm| does not grow faster than √ m. (iii) Optimality: Note that ψ is the characteristic function of Λ ∈ M1+(Rd) since ψ is the Fourier transform of Λ (by Bochner’s theorem). Therefore, the object of interest supx,y∈S |k̂(x,y) − k(x,y)| = ‖ψ̂ − ψ‖S∆ , is the uniform norm of the difference between ψ and the empirical characteristic function ψ̂ = 1m ∑m i=1 cos(〈ωi, ·〉), when both are restricted to a compact set S∆ ⊂ Rd. The question\nof the convergence behavior of ‖ψ̂ − ψ‖S∆ is not new and has been studied in great detail in probability and statistics literature (e.g., see [10, 30] for d = 1 and [6, 7] for d > 1) where the characteristic function is not just a real-valued symmetric function (like ψ) but is Hermitian. [30, Theorems 6.2 and 6.3] show that the optimal rate of convergence of ‖ψ̂ − ψ‖S∆ is m−1/2 when d = 1, which matches with our result in Theorem 1. Also Theorems 1 and 2 in [7] show that the logarithmic dependence on |Sm| is optimal. In particular, [7, Theorem 1] matches with the growing diameter result in Remark 1(ii), while [7, Theorem 2] shows that if Λ is absolutely continuous w.r.t. the Lebesgue measure and if lim supm→∞ m\n−1 log |Sm| > 0, then there exists a positive ǫ such that lim supm→∞ Λ\nm(‖ψ̂ − ψ‖Sm,∆ ≥ ǫ) > 0. This means the rate |Sm| = eo(m) is not only the best possible in general for almost sure convergence, but if faster sequence |Sm| is considered then even stochastic convergence cannot be retained for any characteristic function vanishing at infinity along at\nleast one path. While these previous results match with that of Theorem 1 (and its consequences), we would like to highlight the fact that all these previous results are asymptotic in nature whereas Theorem 1 provides a finite sample probabilistic inequality that holds for any m. We are not aware of any such finite sample result except for the one in [16].\nUsing Theorem 1, one can obtain a probabilistic inequality for the Lr-norm of k̂ − k over any compact set S ⊂ Rd, as given by the following result (proved in Section B.2 of the supplement). Corollary 2. Suppose k satisfies the assumptions in Theorem 1. Then for any 1 ≤ r < ∞, τ > 0 and non-empty compact set S ⊂ Rd,\nΛm\n\n\n \n (ωi)\nm i=1 : ‖k̂ − k‖Lr(S) ≥\n(\nπd/2|S|d 2dΓ(d2 + 1)\n)2/r h(d, |S|, σ) + √ 2τ√\nm\n \n\n\n ≤ e−τ ,\nwhere ‖k̂ − k‖Lr(S) := ‖k̂ − k‖Lr(S×S) = (∫\nS\n∫\nS |k̂(x,y) − k(x,y)|r dx dy\n) 1 r\n.\nCorollary 2 shows that ‖k̂− k‖Lr(S) = Oa.s.(m−1/2|S|2d/r log |S|) and therefore if |Sm| → ∞ as m → ∞, then consistency of k̂ in Lr(Sm)-norm is achieved as long as m−1/2|Sm|2d/r log |Sm| → 0 as m → ∞. This means, in comparison to the uniform norm in Theorem 1 where |Sm| can grow exponential in mδ (δ < 1), |Sm| cannot grow faster than m r 4d to achieve consistency in Lr-norm.\nInstead of using Theorem 1 to obtain a bound on ‖k̂− k‖Lr(S) (this bound may be weak as ‖k̂− k‖Lr(S) ≤ ‖k̂ − k‖S×Svol2/r(S) for any 1 ≤ r < ∞), a better bound (for 2 ≤ r < ∞) can be obtained by directly bounding ‖k̂− k‖Lr(S), as shown in the following result, which is proved in Section B.3 of the supplement. Theorem 3. Suppose k(x,y) = ψ(x− y), x, y ∈ Rd where ψ ∈ Cb(Rd) is positive definite. Then for any 1 ≤ r < ∞, τ > 0 and non-empty compact set S ⊂ Rd,\nΛm\n\n\n \n (ωi)\nm i=1 : ‖k̂ − k‖Lr(S) ≥\n(\nπd/2|S|d 2dΓ(d2 + 1)\n)2/r (\nC′r m1−max{ 1 2 , 1 r } + √ 2τ√ m )      ≤ e−τ ,\nwhere C′r is a universal constant that depends only on r but not on |S| and m.\nTheorem 3 shows an improved dependence on |S| without the extra log |S| factor given in Corollary 2 and therefore provides a better rate for 2 ≤ r < ∞ when the diameter of S grows, i.e., ‖k̂ − k‖Lr(Sm)\na.s.→ 0 if |Sm| = o(m r 4d ) as m → ∞. However, for 1 ≤ r < 2, Theorem 3 provides a slower rate than Corollary 2 and therefore it is appropriate to use the bound in Corollary 2. While one might wonder why we only considered the convergence of ‖k̂ − k‖Lr(S) and not ‖k̂ − k‖Lr(Rd), it is important to note that the latter is not well-defined because k̂ /∈ Lr(Rd) even if k ∈ Lr(Rd)."
    }, {
      "heading" : "4 Approximation of kernel derivatives",
      "text" : "In the previous section we focused on the approximation of the kernel function where we presented uniform and Lr convergence guarantees on compact sets for the random Fourier feature approximation, and discussed how fast the diameter of these sets can grow to preserve uniform and Lr convergence almost surely. In this section, we propose an approximation to derivatives of the kernel and analyze the uniform and Lr convergence behavior of the proposed approximation. As motivated in Section 1, the question of approximating the derivatives of the kernel through finite dimensional random feature map is also important as it\nenables to speed up several interesting machine learning tasks that involve the derivatives of the kernel (e.g., [32, 21, 17, 18, 29, 23]).\nTo this end, we consider k as in (1) and define ha := cos(πa2 + ·), a ∈ N (in other words h0 = cos, h1 = − sin, h2 = − cos, h3 = sin and ha = hamod4). For p,q ∈ Nd, assuming ∫ |ωp+q| dΛ(ω) < ∞, it follows from dominated convergence theorem that\n∂p,qk(x,y) =\n∫\nRd\nω p(−ω)qh|p+q| ( ω T (x− y) ) dΛ(ω)\n=\n∫\nRd\nω p+q [ h|p|(ω Tx)h|q|(ω Ty) + h3+|p|(ω Tx)h3+|q|(ω Ty) ] dΛ(ω),\nso that ∂p,qk(x,y) can be approximated by replacing Λ by Λm, resulting in\n∂̂p,qk(x,y) := sp,q(x,y) = 1\nm\nm∑\nj=1\nω p j (−ωj)qh|p+q| ( ω T j (x− y) ) = 〈φp(x), φq(y)〉 R2m , (6)\nwhere φp(u) := 1√ m\n( ω\np 1 h|p|(ω T 1 u), · · · ,ωpmh|p|(ωTmu),ωp1 h3+|p|(ωT1 u), · · · ,ωpmh3+|p|(ωTmu)\n) and\n(ωj) m j=1 i.i.d.∼ Λ. Now the goal is to understand the behavior of ‖sp,q−∂p,qk‖S×S and ‖sp,q−∂p,qk‖Lr(S) for r ∈ [1,∞), i.e., obtain analogues of Theorems 1 and 3. As in the proof sketch of Theorem 1, while ‖sp,q − ∂p,qk‖S×S can be analyzed as the suprema of an empirical process indexed by a suitable function class (say G), some technical issues arise because G is not uniformly bounded. This means McDiarmid or Talagrand’s inequality cannot be applied to achieve concentration and bounding Rademacher average by Dudley entropy bound may not be reasonable. While these issues can be tackled by resorting to more technical and refined methods, in this paper, we generalize (see Theorem 4 which is proved in Section B.1 of the supplement) Theorem 1 to derivatives under the restrictive assumption that supp(Λ) is bounded (note that many popular kernels including the Gaussian do not satisfy this assumption). We also present another result (see Theorem 5) by generalizing the proof technique1 of [16] to unbounded functions where the boundedness assumption of supp(Λ) is relaxed but at the expense of a slightly worse rate. Theorem 4. Let p,q ∈ Nd, Tp,q := supω∈supp(Λ) |ωp+q|, Cp,q := Eω∼Λ [ |ωp+q| ‖ω‖22 ] , and assume that C2p,2q < ∞. Suppose supp(Λ) is bounded if p 6= 0 and q 6= 0. Then for any τ > 0 and non-empty compact set S ⊂ Rd,\nΛm\n({\n(ωi) m i=1 : sup x,y∈S |∂p,qk(x,y) − sp,q(x,y)| ≥ H(d,p,q, |S|) + Tp,q\n√ 2τ√\nm\n})\n≤ e−τ ,\nwhere\nH(d,p,q, |S|) = 32 √\n2d T2p,2q\n[ √\nU(p,q, |S|) + 1 2 √ U(p,q, |S|) +\n√\nlog( √\nC2p,2q + 1)\n]\nand U(p,q, |S|) = log(|S|T−1/22p,2q + 1). 1We also correct some technical issues in the proof of [16, Claim 1], where (i) a shift-invariant argument was applied to the non-shift invariant kernel estimator k̂(x,y) = 1 m ∑m j=1 2 cos(ωTj x + bj) cos(ω T j y + bj) =\n1 m\n∑m\nj=1\n[\ncos(ωTj (x− y)) + cos(ω T j (x+ y) + 2bj)\n]\n, (ii) the convexity of S was not imposed leading to possibly\nundefined Lipschitz constant (L) and (iii) the randomness of ∆∗ = argmax∆∈S∆ ∥ ∥∇[k(∆)− k̂(∆)] ∥ ∥ 2 was not taken into account, thus the upper bound on the expectation of the squared Lipschitz constant (E[L2]) does not hold.\nRemark 2. (i) Note that Theorem 4 reduces to Theorem 1 if p = q = 0, in which case Tp,q = T2p,2q = 1. If p 6= 0 or q 6= 0, then the boundedness of supp(Λ) implies that Tp,q < ∞ and T2p,2q < ∞. (ii) Growth of |Sm|: By the same reasoning as in Remark 1(ii) and Corollary 2, it follows that ‖∂p,qk − sp,q‖Sm a.s.−→ 0 if |Sm| = eo(m) and ‖∂p,qk − sp,q‖Lr(Sm) a.s.−→ 0 if m−1/2|Sm|2d/r log |Sm| → 0 (for 1 ≤ r < ∞) as m → ∞. An exact analogue of Theorem 3 can be obtained (but with different constants) under the assumption that supp(Λ) is bounded and it can be shown that for r ∈ [2,∞), ‖∂p,qk−sp,q‖Lr(Sm)\na.s.−→ 0 if |Sm| = o(m r 4d ).\nThe following result relaxes the boundedness of supp(Λ) by imposing certain moment conditions on Λ but at the expense of a slightly worse rate. The proof relies on applying Bernstein inequality at the elements of a net (which exists by the compactness of S) combined with a union bound, and extending the approximation error from the anchors by a probabilistic Lipschitz argument.\nTheorem 5. Let p,q ∈ Nd, ψ be continuously differentiable, z 7→ ∇z [∂p,qk(z)] be continuous, S ⊂ Rd be any non-empty compact set, Dp,q,S := supz∈conv(S∆) ‖∇z [∂p,qk(z)]‖2 and Ep,q := Eω∼Λ [|ωp+q| ‖ω‖2]. Assume that Ep,q < ∞. Suppose ∃L > 0, σ > 0 such that\nEω∼Λ [ |f(z;ω)|M ] ≤ M !σ\n2LM−2\n2 (∀M ≥ 2, ∀z ∈ S∆), (7)\nwhere f(z;ω) = ∂p,qk(z) − ωp(−ω)qh|p+q| ( ω T z ) . Then\nΛm\n({\n(ωi) m i=1 : sup x,y∈S |∂p,qk(x,y) − sp,q(x,y)| ≥ ǫ\n})\n≤ 2d−1e − mǫ2 8σ2(1+ ǫL 2σ2 )\n+16Fd ( |S|(Dp,q,S + Ep,q) ǫ ) d d+1 e − mǫ2 8(d+1)σ2(1+ ǫL 2σ2 ) ,(8)\nwhere Fd := d − 1d+1 + d 1 d+1 .\nRemark 3.\n(i) By the continuity of z 7→ ∇z [∂p,qk(z)] and the compactness of S∆, it is easy to see Dp,q,S < ∞. (7) holds if |f(z;ω)| ≤ L2 and Eω∼Λ [ |f(z;ω)|2 ] ≤ σ2 (∀z ∈ S∆). If supp(Λ) is bounded, then f is\nguaranteed (see Section B.5 in the supplement). (ii) In the special case when p = q = 0, our requirement boils down to the continuously differentiability\nof ψ, E0,0 = Eω∼Λ ‖ω‖2 < ∞, and (7). (iii) Note that (8) is similar to (3) and therefore based on the discussion in Section 2, it is clear that\nsupx,y∈S |∂p,qk(x,y) − sp,q(x,y)| = Oa.s.(|S| √\nm−1 logm). But the advantage with Theorem 5 over [16, Claim 1] is that it can handle unbounded functions. In comparison to Theorem 4, we obtain slightly worse rates and it will be of interest to improve the rates of Theorem 5 while handling unbounded functions."
    }, {
      "heading" : "5 Discussion",
      "text" : "In this paper, we presented the first detailed theoretical analysis about the approximation quality of random Fourier features (RFF) that are proposed by [16] in the context of improving the computational complexity of kernel machines. While [16] provided a probabilistic bound on the uniform approximation (over compact subsets of Rd) of a kernel by random features, the result is not optimal. We improved this result by providing a finite sample bound with optimal rate of convergence and also analyzed the quality of approximation in Lr-norm (1 ≤ r < ∞). We also proposed a RFF approximation for derivatives of a kernel and provided\ntheoretical guarantees on the quality of approximation in uniform and Lr-norms over compact subsets of Rd.\nWhile all the results in this paper (and also in the literature) dealt with the approximation quality of RFF over only compact subsets of Rd, it is of interest to understand its behavior over entire Rd. However, as discussed in Remark 1(ii) and in the paragaph following Theorem 3, RFF cannot approximate the kernel uniformly or in Lr-norm over Rd. By truncating the Taylor series expansion of the exponential function, [5] proposed a non-random finite dimensional representation to approximate the Gaussian kernel which also enjoys the computational advantages of RFF. However, this representation also does not approximate the Gaussian kernel uniformly over Rd. Therefore, the question remains whether it is possible to approximate a kernel uniformly or in Lr-norm over Rd but still retaining the computational advantages associated with RFF."
    }, {
      "heading" : "Acknowledgments",
      "text" : "This work was supported by the Gatsby Charitable Foundation."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "Kernel methods represent one of the most powerful tools in machine learning to tackle problems<lb>expressed in terms of function values and derivatives due to their capability to represent and model<lb>complex relations. While these methods show good versatility, they are computationally intensive<lb>and have poor scalability to large data as they require operations on Gram matrices. In order<lb>to mitigate this serious computational limitation, recently randomized constructions have been<lb>proposed in the literature, which allow the application of fast linear algorithms. Random Fourier<lb>features (RFF) are among the most popular and widely applied constructions: they provide an<lb>easily computable, low-dimensional feature representation for shift-invariant kernels. Despite the<lb>popularity of RFFs, very little is understood theoretically about their approximation quality. In this<lb>paper, we provide the first detailed theoretical analysis about the approximation quality of RFFs<lb>by establishing optimal (in terms of the RFF dimension) performance guarantees in uniform and<lb>L (1 ≤ r < ∞) norms. We also propose a RFF approximation to derivatives of a kernel with a<lb>theoretical study on its approximation quality.",
    "creator" : "LaTeX with hyperref package"
  }
}