{
  "name" : "1609.01508.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Low-rank Bandits with Latent Mixtures",
    "authors" : [ "Aditya Gopalan" ],
    "emails" : [ "ADITYA@ECE.IISC.ERNET.IN", "ODALRICAMBRYM.MAILLARD@INRIA.FR", "ZAKI@ECE.IISC.ERNET.IN" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n60 9.\n01 50\n8v 1\n[ cs\n.L G\n√ BT ), with B the number of users. An ingredient towards this result is a novel robustness\nproperty of OFUL, of independent interest.\nKeywords: Multi-armed bandits, online learning, low-rank matrices, recommender systems, reinforcement learning.\n1. Introduction\nRecommender systems aim to provide targeted, personalized content recommendations to users by learning their responses over time. The underlying goal is to be able to predict which items a user might prefer based on preferences expressed by other related users and items, also known as the principle of collaborative filtering.\nA popular approach to model preferences expressed by users in recommender systems is via probabilistic mixture models or latent class models (Hofmann and Puzicha, 1999; Kleinberg and Sandler, 2004). In such a mixture model, we have a set of A items (content) that can be recommended to B users (consumers). Whenever item a is recommended to user b, the system gains an expected reward of ra,b. The key structural assumption that captures the relationship between users’ preferences is that there exists a set of latent set of C representative user types or typical taste profiles.\nFormally, each taste profile c is a unique vector uc ≡ (ua,c)a of the expected rewards that every item a elicits under the taste profile. Each user b is assumed to sample one of the typical profiles randomly using an individual probability distribution vb ≡ (vb,c)c; its reward distribution across the items subsequently becomes that induced by the assumed profile.\nOur focus is to address the sequential optimization of net reward gained by the recommender, without any prior knowledge of either the latent user classes or users’ mixture distributions. Assuming that users arrive to the system repeatedly following an unknown stochastic process and re-sample their profiles over time, according to their respective unknown mixtures across latent classes, we seek online learning strategies that can achieve low regret relative to the best single item that can be recommended to each user. Note that this is qualitatively different than the task of estimating latent classes or user mixtures in a batch fashion, well-studied by now (Sutskever et al., 2009; Anandkumar et al., 2014a,b); the task of simultaneously optimizing net utility in a bandit fashion in complex expression models like these has received little or no analytical treatment. Our work takes a step towards filling this void.\nAn especially challenging aspect of online learning in recommender systems is the relatively meager number of available interactions with a same user, which is offset to an extent by the assumption that users can only have a limited number of taste profiles (classes). Indeed, if one can identify the class to which a certain user belongs and aggregate information from all other users in that class, then one can recommend to the user the best item for the class. In practice, classes are latent and not necessarily known in advance, and several works (Gentile et al., 2014; Lazaric et al., 2013; Maillard and Mannor, 2014) study the restricted situation when each user always belongs to one specific class (i.e., when all mixture distributions have support size 1). We go two steps further, since in many situations (a) users cannot be assumed to belong to one class only, such as when a user account is shared by several individuals (e.g. a smart-TV), and (b) the duration of a user-session, that is the number of consecutive recommendations to the same individual connected to a user-account, cannot assumed to be long1.\nThe key challenges that this work addresses are (1) the lack of knowledge of “features” on both the user-side and item-side in a linear bandit problem (in this case, both the user mixture weights and the item class reward profiles) and (2) provable regret minimization with very few i.e. O(1) interactions with every user b having a specific taste profile, as opposed to a large number of interactions such as in transfer learning (Lazaric et al., 2013).\nContributions and overview of results. We consider a setting when users are assumed to come from arbitrary mixtures across classes (they are not assumed to fall perfectly in one class as was the assumption in works by Gentile et al. (2014); Maillard and Mannor (2014)). We develop a novel bandit algorithm (Algorithm 3) that combines (a) the Optimization in the Face of Uncertainty Linear bandit OFUL algorithm (Abbasi-Yadkori et al., 2011) for bandits with known action features, and (b) a variant of the Robust Tensor Power (RTP) algorithm (Anandkumar et al., 2014b) that uses only bandit (partial) estimates of latent user classes with observations coming from a mixture model. More specifically, we introduce a subroutine (Algorithm 1) that makes use of the RTP method to extract item-side attributes (U ) and, contributing to its theoretical analysis, show a recovery property (Theorem 1). Note that the RTP method ideally requires (unbiased) estimates of the 2nd and 3rd order moments of actions’ rewards, but with bandit information the learner can access only partial reward information, i.e., a single reward sample from an action. To overcome this, we devise an importance sampling scheme across 3 successive time instants to build the 2nd and 3rd order moment tensor estimates that RTP uses. For the task of issuing recommendations, we develop an algorithm (section 4), essentially based on OFUL, instantiated per user, using for each a the estimated latent class vectors {ua,c}c (obtained via the RTP subroutine) as arm features, and uncertain parameter vector to be learned vb.\n1. It is also unlikely to be very short, say, less than 3.\nWe carry out a rigorous analysis of the algorithm and show that it achieves regret Õ(ℓC √ BT ) in T rounds of interaction (Theorem 4), provided each arriving user interacts with the system for ℓ > 3 rounds with the same profile. In comparison, the regret of the strategy that completely disregards the latent mixture structure of rewards and employs a standard bandit strategy (e.g. UCB (Auer et al., 2002)) per user, scales as O(B √ TA/B) = O( √ ABT ) after T rounds2 , which is considerably suboptimal in the practical case with a very large number of items but very few representative user classes (C ≪ A). It is also worth noting that the regret bound we achieve, order-wise, is what would result from applying the OFUL or any optimal linear bandit algorithm assuming a priori knowledge of all latent user classes {ua,c}a,c, that is Õ(ℓC √ BT ). In this sense, our result shows that one can simultaneously estimate features on both sides of a bilinear reward model and achieve regret performance equivalent to that of a one-sided linear model, which is the first result of its kind to the best of our knowledge3. Our results are presented for finite time horizons with explicit details of the constants arising from the error analysis of RTP, which at this point are large but possibly improvable.\nEn route to deriving the regret for our algorithm, we also make a novel contribution that advances the theoretical understanding of OFUL, and which is of independent interest. We show that in the standard linear bandit setting, where the expected reward of an arm linearly depends\non d features, OFUL yields (sub-linear) Õ ( ρd √ T ) regret even when it makes decisions based on\nperturbed or inexact feature vectors (Theorem 3), where ρ quantifies the distortion. This property holds whenever the perturbation error is small enough, and we explicitly give both (a) a sufficient condition on the size of the perturbation in terms of the set of actual features, and (b) a bound on the (multiplicative) distortion ρ in the regret due to the perturbation (note that ρ = 1 in the ideal linear case).\n2. Setup and notation\nFor any positive integer n, [n] denotes the set {1, 2, . . . , n}. At each n ∈ N, nature selects a user bn ∈ [B] according to the probability distribution β over [B], independent of the past, and bn is revealed to the learner. A user class cn is subsequently sampled from the probability distribution vbn over [C], and cn (the assumed class of user bn) interacts with the learner for the next ℓ > 3 consecutive steps. Such an interaction will often be termed a mini-session.\nIn each step l ∈ [ℓ] of a mini-session, the learner plays an action (issues a recommendation) an,l ∈ [A] and subsequently receives reward Yn,l = uan,l,cn + ηn,l, where ηn,l is a (centered) R-sub-Gaussian i.i.d. random variable independent from an,l, cn, representing the noise in the reward. We let ua ∈ RC represent the vector (ua,c)c∈[C] of the mean rewards from action a in each class. Note that E[uan,l,cn |an,l] = E[u⊤an,lvbn |an,l]. For convenience, we use the index notation t ≡ (n, l) and introduce T = Nℓ, where N is the total number of mini-sessions, and T the total number of interactions of the learner with the system. We denote likewise Yt, at, ct, ηt for Yn,l, an,l, cn, ηn,l, and let umax def = maxa∈[A],c∈[C] |ua,c|.\nWe are interested in designing an online recommendation strategy, i.e., one that plays actions depending on past observations, achieving low (cumulative) regret after T ≡ (N, ℓ) mini-sessions, defined as RT def= ∑ n∈[N ],l∈[ℓ] rn,l, where rn,l def = maxa∈[A] u ⊤ a vbn − u⊤an,lvbn . In other words, we wish to compete against a strategy that plays for every user an action yielding the highest reward in expectation under its mixture distribution over user classes.\n2. Roughly, each UCB per-user plays from a pool of A actions for about T/B rounds, thus suffering regret O( √\nA(T/B)). 3. An earlier result of Djolonga et al. (2013) gets O(T 4/5) regret while moreover assuming a perfect control of the\nsampling process (we can’t assume this due to the user arrivals).\n3. Recovering latent user classes: The EstimateFeatures subroutine\nIn this section, we provide an estimation algorithm for the matrix U , using the RTP method.4\nEstimation of tensors. We assume that in mini-session n, when interacting with user bn, the triplet {an,l}l6ℓ is chosen from a distribution pn(a, a′, a′′|bn). Letting Xan,l,bn,n,l def = Yn,l = uan,l,cn + ηn,l to explicitly indicate the active user and action chosen at (n, l), we form the importance-weighted estimates\nr̃a,a′,n def =\n1\nn\nn∑\ni=1\nXai,1,bi,i,1Xai,2,bi,i,2\npi(a, a′|bi) I{ai,1 = a, ai,2 = a′},\nr̃a,a′,a′′,n def =\n1\nn\nn∑\ni=1\nXai,1,bi,i,1Xai,2,bi,i,2Xai,3,bi,i,3\npi(a, a′, a′′|bi) I{ai,1 = a, ai,2 = a′, ai,3 = a′′} .\nfor the second and third-order tensors5. We introduce the matrices M̂n,2 ≡ (r̃a,a′,n)a,a′∈[A] and M2 ≡ (ma,a′)a,a′∈[A] with ma,a′ def= E[r̃a,a′,n], and the tensors M̂n,3 ≡ (r̃a,a′,a′′,n)a,a′,a′′∈[A] and M3 ≡ (ma,a′,a′′)a,a′,a′′∈[A] with ma,a′,a′′ def = E[r̃a,a′,a′′,n]. The following result decomposes the matrix M2 and tensor M3 as weighted sums of outer products.\nLemma 1 When the user arrivals are i.i.d. according to the law β, i.e., bi i.i.d∼ β ∀i ∈ [n], it holds that\nma,a′,n = ∑\nc∈[C] vβ,cua,cua′,c, and\nma,a′,a′′,n = ∑\nc∈[C] vβ,cua,cua′,cua′′,c .\nHaving shown the unbiasedness of the empirical 2nd and 3rd moment tensors M̂n,2 and M̂n,3, we next turn to showing concentration to their respective means.\nLemma 2 Assuming that pi(a, a′|bi) > q2,i and pi(a, a′, a′′|bi) > q3,i for deterministic q2,i, q3,i, for all i ∈ N, a, a′, a′′ ∈ [A], then for all n 6 N , with probability higher than 1− δ, it holds simultaneously for all a, a′, a′′ that\n|r̃a,a′,n −ma,a′,n| 6\n√√√√ n∑\ni=1\nq−22,i log(4A2/δ)\n2n2 ,\n|r̃a,a′,n −ma,a′,a′′,n| 6\n√√√√ n∑\ni=1\nq−23,i log(4A3/δ)\n2n2 .\nAn immediate corollary is the following one:\nCorollary 1 Provided that q2,i = γi/A2 and q3,i = γi/A3 for some γi > 0, then on an event of probability higher than 1− δ, the following hold simultaneously:\ne(2)n def = ‖M̂n,2 −M2‖ 6 A3\n√√√√ n∑\ni=1\nγ−2i log(4A2/δ)\n2n2 ,\ne(3)n def = ‖M̂n,3 −M3‖ 6 A9/2\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 .\n4. We consider ℓ = 3 to describe the algorithm; ℓ > 3 is easily handled by repeating the 3-wise sampling p(a, a′, a′′) for ⌊ℓ/3⌋ times and discarding the remaining (< 3) steps in the mini-session during exploration (leading to a negligible regret overhead). 5. An alternative is the implicit exploration method due to Kocák et al. (2014).\nAlgorithm 1 EstimateFeatures 1: Input: #sessions n; #mini-sessions ℓ; (user, action, reward) tuples\n(bi, ai,l,Xai,l ,bi,i,l)16i6n,16l6ℓ.\n2: Compute the A × A matrix M̂n,2 = (r̃a,a′,n)a,a′∈[A] and the A × A × A tensor M̂n,3 = (r̂a,a′,a′′,)a,a′,a′′∈[A]. 3: Compute a A× C whitening matrix Ŵn of M̂n,2 {Take Ŵn = ÛnD̂−1/2n where D̂n is the C × C diagonal matrix with the top C eigenvalues of M̂n,2, and Ûn the A× C matrix of corresponding eigenvectors.} 4: Form the C × C × C tensor T̂n = M̂n,3(Ŵn, Ŵn, Ŵn). 5: Apply the RTP algorithm (Anandkumar et al., 2014b) to T̂n, and compute its robust eigenvalues\n(λ̂n,c)c∈[C] with eigenvectors (ϕ̂n,c)c∈[C]. {The paper of Anandkumar et al. (2014b, Sec. 4) defines eigenvalues/eigenvectors of tensors.}\n6: Compute for each c ∈ [C], un,c = λn,c(Ŵ⊤n )†ϕ̂n,c and vn,c = λ−2n,c. 7: Output: Estimate of latent classes U : The A×C matrix Un obtained by stacking the vectors\nun,c ∈ RA side by side.\nReconstruction algorithm. The EstimateFeatures algorithm (Algorithm 1) employs a whitening matrix Ŵn, of the empirical estimate of the matrix M2, to build the empirical tensor T̂n. This tensor is then used to recover the columns of the matrix U = (ua,c)a∈[A],c∈[C] via the RTP algorithm. For the sake of completeness, we also introduce W , a whitening matrix of M2 (i.e., WTM2W = I), the corresponding tensor T = M3(W,W,W ), and finally the estimation error en def = ‖T̂n − T ‖. Reconstruction guarantee. Our next result makes use of the following proposition from Anandkumar et al. (2014b, Theorem 5.1), restated here for completeness.\nProposition 1 (Theorem 5.1 of Anandkumar et al. (2014b)) Let T̂ = T + E ∈ RC×C×C , where T is a symmetric tensor with orthogonal decomposition T = ∑C c=1 λcϕ ⊗3 c , where each λc > 0, {ϕc}c∈[C] is an orthonormal basis, and E is a symmetric tensor with operator norm ||E|| 6 ε. Let λmin = min{λc : c ∈ [C]}, λmax = max{λc : c ∈ [C]}. Run the RTP algorithm with input T̂ for C iterations. Let {(λ̂c, ϕ̂c)}c∈[C] be the corresponding sequence of estimated eigenvalue/eigenvector pairs returned. Then, there exist universal constants C1, C2 > 0 for which the following is true. Fix η ∈ (0, 1) and run RTP with parameters (i.e., number of iterations) L,N with L = poly(C) log(1/η), and N > C2 ( log(C) + log log ( λmax ε )) . If ε 6 C1 λmin C , then with probability at least 1− η, there exists a permutation π ∈ SC such that\n∀c ∈ [C] : |λc − λ̂π(c)| 6 5ε, ||ϕc − ϕ̂π(c)|| 6 8ε/λc,\nand ||T − C∑\nc=1\nλ̂cϕ̂ ⊗3 c || 6 55ε .\nLemma 1 gives a decomposition of the (symmetric) tensor M3, but it may be not orthogonal; standard transformation (Anandkumar et al., 2014b, Sec. 4.3) gives an orthogonal decomposition for the tensor6 M3(W,W,W ), with W a matrix that whitens M2. We can thus use Proposition 1\n6. For a 3rd order tensor A ∈ Ra×a×a and 2nd order tensor or matrix B ∈ Ra×b, A(B,B,B) ∈ Rb×b×b is the 3rd order tensor defined by [A(B,B,B)]i1,i2,i3 def = ∑\nj1,j2,j3∈[n] Aj1,j2,j3Bj1,i1Bj2,i2Bj3,i3 . See Anandkumar et al.\n(2014b) for more details on notation and results.\nwith T = M3(W,W,W ), T̂ = T̂n, ε = en and η = δ in order to prove the following guarantee (Theorem 1) on the recovery error between columns of U and their estimate.\nWe now introduce mild separability conditions on the mixture weights vb and the spectrum of the 2nd moment matrix M2 needed for the reconstruction guarantee to hold, similar to those assumed for Lazaric et al. (2013, Theorem 2).\nAssumption 1 There exist positive constants vmin, σmin, σmax and Γ such that\nmin b∈[B],c∈[C] vb,c > vmin, ∀c ∈ [C], σc = √ λc(M2) ∈ [σmin, σmax] and\nmin c 6=c′∈[C]×[C]\n|σc − σc′ | > Γ ,\nwhere λc(A) denotes the cth top eigenvalue of A.\nTheorem 1 (Recovery guarantee for online estimation of user classes U ) Let Assumption 1 hold, and let δ ∈ (0, 1). If the number of mini-session satisfies\nn2∑n i=1 γ −2 i > max\n{ 2A6 log(4A2/δ)\nmin{Γ, σmin}2 , A9(1 + 10( 1Γ + 1 σmin )(1 + u3max)) 2C5 log(4A3/δ) 2C21σ 3 min\n} ,\nthen with probability at least 1 − 2δ, there exists some permutation π ∈ SC such that for all c ∈ [C], the output Ūn of the EstimateFeatures algorithm satisfies\n||uc − un,π(c)|| 6 3A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 . (1)\nwhere uc = (ua,c)a∈[A]. Here, the constant (we use the ”diamond” symbol to denote it) is\n3 = ( CA σmin\n)3/2 ( 13 √ σmax + 4 √ 2min{Γ, σmin}\n+ 5 ( σmax Γ + 1\n2σmax\n) min{Γ, σmin} ) ℵ\n+\n( 2σmax\nΓ +\n1\nσmax\n) 1\nv2min\n+ 5 √ 3/8 (√ σmax + √ min{Γ, σmin}/2 )(2CA σmin )3 ℵ2 min{Γ, σmin} ,\nwith the notation ℵ = 1 + 10( 1Γ + 1σmin )(1 + u 3 max).\nThe proof strategy follows that of Lazaric et al. (2013, Theorem 2) and is detailed in the appendix for clarity. It consists in relating, on the one hand, the estimation errors e(2)n of M2 and e (3) n of M3 from Corollary 1 to the condition ε 6 C1 λminC , and, on the other hand, relating the reconstruction error on the columns of U to the control on the terms |λc − λ̂π(c)| and ||ϕc − ϕ̂π(c)|| coming from Proposition 1. We note that the bound appearing in the condition on the number of mini-sessions is potentially large (due to the terms A6, C5, etc.). This is due to the combination of the RTP method with the importance sampling scheme, and it remains unclear if the bound can be significantly improved within this framework.\n4. Recovering latent mixture distributions (vb): robustness of the OFUL algorithm\nIn order to recover the weights vectors vb ∈ RC and thus the matrix V , it would be tempting to use again an instance of the RTP method but this time to aggregate across actions, i.e., by forming a B×B and B×B×B tensor. Unfortunately, aggregation of elements of U fails for two reasons: First, we do not have different views across users b, contrary to what we have for actions a. It is thus hopeless to be able to form an estimate of the 2nd and 3rd moment tensors as before. Second, and rather technically, convex combinations of the {ua,c}a∈[A] need not be positive. This prevents the application of the RTP method which requires positive weights to work.\nWe thus consider a different strategy that uses an algorithm designed for linear bandits. However since the feature matrix U is unknown a priori and can only be estimated, we need to work with perturbed features. A first solution is to propagate the additional error resulting from the error on the features in the standard proof of OFUL. However, this leads to a sub-optimal regret that is no longer scaling as Õ( √ T ) with the time horizon. We overcome this hurdle by showing in Theorem 3 a robustness property of OFUL of independent interest, which aids us in controlling the regret of the overall latent class algorithm (Algorithm 3).\nConsider OFUL run with perturbed (not necessarily linearly realizable) rewards. Formally, consider a finite action set A = {1, 2, . . . , A} and distinct feature vectors {ūa ∈ RC×1}a∈A. Let Ū⊤ := [ū1 ū2 . . . ūA] ∈ RC×A. The expected reward when playing action At = a at time t is denoted by ma := E [ Yt ∣∣ At = a ] , with m := (ma)a∈A. Let us assume that there exists a unique optimal action for the expected rewards m, i.e., argmaxa∈A ma = {a⋆}, with the regret at time n being Rn := ∑n t=1 (ma⋆ −mAt). The key point here is that m need not be linearly realizable w.r.t. the actions’ features – we will not require that min v∈RC ∥∥m− Ūv ∥∥ be 0.\nAlgorithm 2 OFUL (Optimism in Face of Uncertainty for Linear bandits) (Abbasi-Yadkori et al., 2011)\nRequire: Arms’ features Ū , regularization parameter λ, norm parameter RΘ for all times t > 1 do\n1. Form the C × (t− 1) matrix Ū1:t−1 := [ūA1 ūA2 . . . ūAt−1 ] consisting of all arm features played up to time t− 1, and Y1:t−1 := (Y1, . . . , Yt−1)⊤. Set Vt−1 := λI + ∑t−1 s=1 ūAs ū ⊤ As\n. 2. Choose the action\nAt ∈ argmax a∈A max v∈Ct−1 ū ⊤ a v, where\nCt−1 := {v ∈ RC : ‖v − v̂t−1‖Vt−1 6 Dt−1},\nDt−1 := R\n√ 2 log ( det(Vt−1)1/2λ−C/2\nδ\n) +λ1/2RΘ\nv̂t−1 := V −1 t−1Ū1:t−1Y1:t−1..\nend for\nOFUL Regret with linearly realizable rewards. The OFUL algorithm is stated for the sake of clarity as Algorithm 2. Before studying the linearly non-realizable case, we record the wellknown regret bound for it in the unperturbed case, that is when ∀a ∈ [A],ma = ū⊤a v⋆ for some unknown v⋆.\nTheorem 2 (OFUL regret (Abbasi-Yadkori et al., 2011)) Assume that ||v⋆||2 6 RΘ, and that for all a ∈ A, ||ūa||2 6 RX , |〈ūa,v⋆〉| 6 1. Then with probability at least 1− δ, the regret of OFUL satisfies: ∀n > 0,\nRn 6 4 √ nC log(1 + nR2X /(λC) ×\n( λ1/2RΘ +R √ 2 log(1/δ) + C log(1 + nR2X /(λC)) ,\nprovided that the regularization parameter λ is chosen such that λ > max { 1, R2X , 1/R 2 Θ } .\nRegret of OFUL with Perturbed Features. We make a structural definition to present the\nresult. Let α(Ū ) := maxJ ∥∥A−1J ∥∥ 2 , where A = [ Ū IC ] ∈ R(A+C)×C , AJ is the C × C submatrix of A formed by picking rows J , and J ranges over all size-C subsets of full-rank rows of A. We will require for our purposes that α(ŪT) is not too large. For intuition regarding α, we refer to Forsgren (1996) (the final 3 paragraphs of p. 770, Corollary 5.4 and section 7). We remark that the condition that α(ŪT) be small is analogous to a γ-incoherence type property commonly used in prior work (Bresler et al., 2014, Assumption A2), stating that two distinct feature vectors uc and uc′ , c 6= c′, must have a minimum angle separation.\nLet v◦ ∈ RC be arbitrary with ℓ2 norm at most RΘ (it helps to think of Ūv◦ as an approximation of m), εa := ma − ū⊤a v◦, ε := (εa)a∈A ∈ RA. We now state a robustness result for OFUL potentially of independent interest.\nTheorem 3 (OFUL robustness property) Suppose ||v◦||26RΘ, λ>max { 1, R2X , 1/4R 2 Θ } , ∀a∈A, ||ūa||2 6 RX and |ma| 6 1. If the deviation from linearity satisfies\n‖ε‖2 ≡ ∥∥m− Ūv◦ ∥∥ 2 < min a 6=a⋆ ū ⊤ a⋆v ◦ − ū⊤a v◦ 2α(Ū⊤) ‖ūa⋆ − ūa‖2 , (2)\nthen, with probability at least 1− δ for all T > 0,\nRT 6 8ρ ′ √ TC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) ,\nwhere ρ′ := max { 1,maxa 6=a⋆ ma⋆−ma ū ⊤\na⋆ v ◦−ū⊤a v◦\n} .\nTheorem 3 essentially states that when the deviation of the actual mean reward vector from the subspace spanned by the feature vectors is small, the OFUL algorithm continues to enjoy a favorable O( √ T ) regret up to a factor ρ′ > 1. The quantity ρ′ in the result is a geometric measure of the distortion in the arms’ actual rewards m with respect to the (linear) approximation Ūv◦. We control this quantity in the next paragraph. (Note that ρ′ = 1 in the perfectly linearly realizable case ε = 0, and this gives back the standard OFUL regret up to a universal multiplicative constant.)\nApplying the Robust analysis of OFUL to the Low-rank Bandit setup. In this paragraph, we translate Theorem 3 to our Low Rank Bandit (LRB) setting in which OFUL uses feature vectors with noisy perturbations (estimated by, say, a Robust Tensor Power (RTP) algorithm). Throughout this section, we fix a user b.\nWe can now translate Theorem 3 thanks to the correspondence with the perturbed OFUL setting: In our low-rank bandit setting, the matrix Ū = Ūn depends on the reconstruction algorithm at mini-session n. Moreover, the optimal action a⋆ ≡ a⋆b now depends on the user b. We denote for a user b ∈ [B] the minimum gap across suboptimal actions to be gb def= mina 6=a⋆\nb (ua⋆ b − ua)⊤vb.\nLikewise, the error vector ε depends on b, n. Its norm ||ε||2 appears in the condition (2) and the definition of ρ, and is controlled by the reconstruction error of Theorem 1. It decays with the number of mini-sessions n.\nWe define αn def = α(Ūn), α⋆ def = α(U) and use maxb ||vb|| for RΘ, Using these notations, and adapting the proof of Theorem 3 to handle a variable Un, we can now translate the result of the perturbed OFUL to our LRB setting:\nLemma 3 Let 0 < δ 6 1 and b ∈ [B]. Provided that the number of mini-sessions n0 satisfies n 2 0∑n0\ni=1 γ −2 i\n>\n9b,δ, where we introduced the notation\n9b,δ =max\n{ 2A6 log(4A2/δ)\nmin{Γ, σmin}2 ,\nA9(1 + 10( 1Γ + 1 σmin )(1 + u3max)) 2C5 log(4A3/δ)\n2C21σ 3 min\n×\n3 2A6C2 log(4A3/δ) ×\nmax { 2α2⋆,\n8A||vb||22 g2b , 27α2⋆Cu 2 max||vb||22 g2b + 1 2\n}} ,\nthen with probability at least 1 − 2δ, ||ε||2 = ||(U − Ūn)vb||2 is small enough that for any n > n0, condition (2) is satisfied. Consequently, Theorem 3 applies with\nRΘ = max b ||vb||2, RX = max a∈A\n||ua||2 + √ A\n2α⋆ , and\nρ′ ≡ ρ′n,b 6 2.\nThus, provided that the total number of mini-sessions of interaction (not necessarily corresponding to interactions with user b) is large enough, then the OFUL algorithm run during interactions with user b will achieve a controlled regret. However, we want to warn that the 9b,δ resulting from the RTP method, especially the second term of the max, may be potentially large, although being a constant.\n5. Putting it together: Online Recommendation algorithm\nThis section details our main contributions for recommendations in the context of mini-sessions of interactions with unknown mixtures of latent profiles: first Algorithm 3 that combines RTP with OFUL, and then a regret analysis in Theorem 4.\nThe recommendation algorithm we propose (Algorithm 3) uses the RTP method to estimate the matrix U and then applies OFUL to determine an optimistic action. Importantly, it finally outputs a distribution that mixes the optimistic action with a uniform exploration. The mixture coefficient goes to 0 with the number of rounds, thus converging to playing OFUL only. It ensures that the importance sampling weights are bounded away from 0 in the beginning.\nMain analytical result: Regret bound\nTheorem 4 (Regret of Algorithm 3) With Assumption 1 holding, let δ ∈ (0, 1), 9δ = maxb∈[B] 9b,δ (from Lemma 3), and let n0 be the first mini-session at which\nn20∑n0 i=1 γ −2 i > 9δ. The regret of Algorithm 3 at time\nT = Nℓ (acting for N mini-sessions of length ℓ) using internal instances of OFUL parameterized by δ > 0 satisfies\nE[RT ] 616\n√ BTC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n))\n+ ℓ(n0 − 1 + N∑\nn=n0\nγn) + 3δT ,\nprovided that λ > min{1, R2X , 1/R2Θ}, with RΘ > maxb ||vb||2, RX > maxa∈A ||ua||2 + √ A 2α⋆ . Consequently, choosing δ = 1/T and γn = √ log(n+ 1)/n, n ∈ N, say, yields the orderE[RT ] = O ( C √ BT logT ) .\nDiscussion. (1) The regret of Algorithm 3 scales with T similar to that of an OFUL algorithm run with perfect knowledge of the feature matrix U : Õ(C √ BT ). This is a non-trivial result as U is not assumed to be known a priori and is estimated by Algorithm 3 using tensor methods.\nAlgorithm 3 Per-user OFUL with exploration Require: Parameters λ, RΘ for OFUL, exploration rate parameters γn, n > 1.\n1: for mini-session n = 1, . . . , N do 2: Get user bn. 3: Let pn ∼ Bernoulli(γn) 4: if pn = 0 then 5: {Carry out an ESTIMATE mini-session} 6: for step k = 1, 2, . . . , ℓ do 7: Output an,k ∼ Uniform([A]). 8: end for 9: Let Un = EstimateFeatures (Algorithm 1) with input (bi, ai,l,Xai,l,bi,i,l)16i6n,16l6ℓ,pn=0\n{Update feature estimates using samples from previous ESTIMATE mini-sessions} 10: else 11: {Carry out an OFUL mini-session} 12: for step k = 1, 2, . . . , ℓ do 13: Run one iteration of OFUL (Algorithm 2) with features Un, parameters λ and RΘ, and\npast actions and rewards (ai,l,Xai,l,bi,i,l), 1 6 i < n, 1 6 l 6 ℓ, for which pi = 1 and bi = bn {An instance of OFUL for each user using current feature estimates, and observed actions and rewards from previous OFUL mini-sessions}\n14: Output action an,k returned by OFUL 15: end for 16: end if 17: end for\n(2) One can also compare the result with the regret of ignoring the mixture (low-rank) structure and simply running an instance of UCB per user, which would scale as O( √ ABT ). This becomes highly suboptimal when the number of actions/items A is much larger than the number of user types C, demonstrating the gain from leveraging the mixed linear structure of the problem. Note\nalso that we do not need a specific user to interact for a long time but for as few as ℓ > 3 consecutive steps, contrary for instance to the transfer method (Lazaric et al., 2013), where a large number of consecutive interaction steps with the same user is required.\n(3) It is worthwhile to contrast the result and approach with that in Djolonga et al. (2013) – the authors there incur an additional regret term due to the error in approximately estimating the low-rank matrix, which requires additional tuning ending up with a regret of O(T 4/5). On the other hand, we avoid this approximation error by showing and exploiting the robustness property of OFUL, which guarantees √ T regret as soon as the estimated features Ũ are within a small radius of the actual ones. The result (and analysis) does come with a caveat that the model-dependent term 9δ , although being independent on the time horizon T , is potentially large. With γn set as in Theorem 4, it appears as an additive exponential constant term in the regret7. This arises from the RTP method, and it is currently unclear if this term can be significantly reduced with the current line of analysis. Numerical evidence, however, indicates that no such large additive constant enters into the regret (Section 5). Also, on the bright side, note that 9δ does not need to be known by the algorithm.\nNumerical Results. The performance of the low-rank bandit strategy (Algorithm 3) is shown in Figure 1, simulated for 20 users arriving uniformly at random, 3 user classes and 200 actions. Both the latent class matrix U200×3 the mixture matrix V20×3 are random one-shot instantiations. The proposed algorithm (Algorithm 3), with two different exploration rate schedules Õ(n−1/2) and Õ(n−1/3) (’RTP+OFUL(sqrt)’ and ’RTP+OFUL(cuberoot)’ in the figure), is compared with (a) basic UCB (’UCB’ in the figure) ignoring the linear structure of the problem (i.e., UCB per-user with 200 actions), (b) OFUL per-user with complete knowledge of the user classes and pn = 1 always, i.e., no exploration mini-sessions, and (c) An implementation of the Alternating Least Squares estimator (Takács and Tikk, 2012; Mary et al., 2014) for the matrix U along with OFUL per-user. The proposed algorithm, with the theoretically suggested exploration Õ(n−1/2), is observed to exploit the latent structure considerably better than simple UCB, and is not too far from the unrealistic OFUL strategy which enjoys the luxury of latent class information. It is also competitive with performing Alternating Least Squares, which does not come with analytically sound performance guarantees in the bandit learning setting. Also, the large additive constants in the theoretical bounds for Algorithm 3 do not manifest here.\nRelated work. The popular low-rank matrix completion problem studies the recovery U and V given a small number of entries sampled at random from UV T with both U and V being tall matrices, see for instance Jain et al. (2013) and citations therein. However, its setting is different than ours for several reasons. It typically deals with batch data arising from a sampling process that is not active but uniform across entries of UV T . Further, it requires sensing operators having strong properties (such as the RIP property), and most importantly, the performance metric is not regret but reconstruction error (Frobenius or 2-norm).\nIn the linear bandit literature (Abbasi-Yadkori et al., 2011; Rusmevichientong and Tsitsiklis, 2010; Dani et al., 2008), the key constraining assumption is that either user side (V ) or item side (U ) features are precisely and completely known a priori. In contrast, the problem of low regret recommendation across users with latent mixtures does not afford us the luxury of knowing either U or V , and so they must be learnt “on the fly”. Another related work in the context of bandit type schemes for latent mixture model recommender systems is that of Bresler et al. (2014), in which, under the very specific uniform mixture model for all users, they exhibit strategies with good regret.\nNguyen et al. (2014) consider an alternating minimization type scheme in linear bandit models with two-sided uncertainty (an alternative model involving latent “factors”). However no rigorous guarantees are given for the bandit schemes they present; moreover, it is not known if alternating minimization finds global minima in general. Another related work is in the transfer learning setting\n7. With additional prior knowledge of γn, the dependence of the additive term can be made polynomial in 9δ: choosing γn = min{1, √ 9δ/n}, it holds that ℓ(n0 − 1 + ∑N\nn=n0 γn) 6 2\n√ 9δℓT + ℓ .\nfrom Lazaric et al. (2013): The method combines the RTP method (Anandkumar et al., 2014b, 2012) essentially with a standard UCB (Auer et al., 2002), but however works in the setting of a large number interactions with a same user, without assuming access to “user ids”. As a result, the regret bound in this setting scales linearly with the number of rounds. Our result in this paper shows that with additional access to just user identifiers, we can reduce the regret rate to be sublinear in time.\nThe RTP method has been used as a processing step to the EM algorithm in crowdsourcing (Zhang et al., 2014), but only convergence properties are considered, which is not enough to provide regret guarantees.\nOn the theoretical side, our contribution generalizes the setting of clustered bandits (Maillard and Mannor, 2014; Gentile et al., 2014) in which a hard clustering model is assumed (one user is assigned to one class, or equivalently mixture distributions can only have support size 1). In particular, Maillard and Mannor (2014) specifically highlight the benefit of a collaborative gain across users against using a vanilla UCB for each user. However their setting is less general than assuming a soft clustering of users (one user corresponds to a mixture of classes) across various “representative” taste profiles as we study here.\nThe Alternating Least-Squares (ALS) method (Takács and Tikk, 2012; Mary et al., 2014) has been shown to yield promising experimental results in similar settings where both U and V are unknown. However, no theoretical guarantees are known for this algorithm that may converge to a local optimum in general.\nThe work of Valko et al. (2014) studies stochastic bandits with a linear model over a low-rank (graph Laplacian) structure. However, they assume complete knowledge of the graph and hence knowledge of the eigenvectors of the Laplacian, converting it into a bilinear problem with only one-sided uncertainty. This is in contrast to our setup where both U , V are completely uncertain.\nPerhaps the closest work to ours is that of Djolonga et al. (2013) where the authors develop a flexible approach for bandit problems in high dimension but with low-dimensional reward dependence. They use a two-phase algorithm: First a low-rank matrix completion technique (the Dantzig selector) estimates the feature-reward map, then a Gaussian Process-UCB (GP-UCB) bandit algorithm controls the regret, and show that if after n iterations the approximation error between the feature matrix and its estimate is less then η, the final regret is given by the sum of the regret of GP-UCB when given perfect knowledge of the features and of n + η(T − n) (due to the learning phase and approximation error). This results in an overall regret scaling with O(T 4/5). We depart from their results in two fundamental ways: Firstly, they have the possibility of uniformly sampling the entries (a common assumption in low-rank matrix completion techniques). We do not have this luxury in our setting as we do not control the process of user arrivals, that is not constrained to be uniform. Secondly, we prove and exploit a novel robustness property (see Theorem 8) of the bandit subroutine we use (OFUL in our case instead of GP-UCB), which allows us to effectively eliminate the approximation error in their work and obtain a O( √ T ) regret bound (see Theorem 4).\n6. Conclusion & Directions\nWe consider a full-blown latent class mixture model in which users are described by unknown mixtures across unknown user classes, more general and challenging than when users are assumed to fall perfectly in one class (Gentile et al., 2014; Maillard and Mannor, 2014).\nWe provide the first provable sublinear regret guarantees in this setting, when both the canonical classes and user mixture weights are completely unknown, which we believe is striking when compared to existing work in the setting, e.g., alternate minimization typically gets stuck in local minima. We currently use a combination of noisy tensor factorization and linear bandit techniques, and control the uncertainty in the estimates resulting from each one of these techniques. This enables us to effectively recover the latent class structure.\nFuture directions include reducing the numerical constant (e.g. using an alternative to RTP), and studying how to combine our work with the aggregation of user parameters suggested in Maillard and Mannor (2014).\nReferences\nYasin Abbasi-Yadkori, David Pal, and Csaba Szepesvari. Improved Algorithms for Linear Stochastic Bandits. In Proc. NIPS, pages 2312–2320, 2011.\nAnimashree Anandkumar, Daniel Hsu, and Sham M Kakade. A method of moments for mixture models and hidden markov models. arXiv preprint arXiv:1203.0683, 2012.\nAnimashree Anandkumar, Rong Ge, Daniel Hsu, and Sham M Kakade. A tensor approach to learning mixed membership community models. Journal of Machine Learning Research, 15(1):2239–2312, 2014a.\nAnimashree Anandkumar, Rong Ge, Daniel Hsu, Sham M. Kakade, and Matus Telgarsky. Tensor decompositions for learning latent variable models. J. Mach. Learn. Res., 15(1):2773–2832, January 2014b.\nP. Auer, N. Cesa-Bianchi, and P. Fischer. Finite-time analysis of the multiarmed bandit problem. Machine Learning, 47(2):235–256, 2002.\nGuy Bresler, George H Chen, and Devavrat Shah. A latent source model for online collaborative filtering. In Proc. NIPS 27, pages 3347–3355. Curran Associates, Inc., 2014.\nVarsha Dani, Thomas P. Hayes, and Sham M. Kakade. Stochastic Linear Optimization under Bandit Feedback. In Proc. COLT, 2008.\nJosip Djolonga, Andreas Krause, and Volkan Cevher. High-dimensional Gaussian process bandits. In Proc. NIPS, pages 1025–1033, 2013.\nAnders Forsgren. On linear least-squares problems with diagonally dominant weight matrices. SIAM Journal on Matrix Analysis and Applications, 17(4):763–788, 1996.\nClaudio Gentile, Shuai Li, and Giovanni Zappella. Online clustering of bandits. In Proc. ICML, pages 757–765, 2014.\nMohammad Gheshlaghi Azar, Alessandro Lazaric, and Emma Brunskill. Sequential transfer in multi-armed bandit with finite set of models. In Proc. NIPS, pages 2220–2228. Curran Associates, Inc., 2013.\nThomas Hofmann and Jan Puzicha. Latent class models for collaborative filtering. In IJCAI, volume 99, pages 688–693, 1999.\nPrateek Jain, Praneeth Netrapalli, and Sujay Sanghavi. Low-rank matrix completion using alternating minimization. In Proc. ACM Symposium on Theory Of computing (STOC), pages 665–674. ACM, 2013.\nJon Kleinberg and Mark Sandler. Using mixture models for collaborative filtering. In Proc. ACM Symposium on Theory Of Computing (STOC), pages 569–578. ACM, 2004.\nTomáš Kocák, Gergely Neu, Michal Valko, and Rémi Munos. Efficient learning by implicit exploration in bandit problems with side observations. In Proc. NIPS, pages 613–621, 2014.\nAlessandro Lazaric, Emma Brunskill, et al. Sequential transfer in multi-armed bandit with finite set of models. In Proc. NIPS, pages 2220–2228, 2013.\nOdalric-Ambrym Maillard and Shie Mannor. Latent bandits. In Proc. ICML, pages 136–144, 2014.\nJérémie Mary, Romaric Gaudel, and Preux Philippe. Bandits warm-up cold recommender systems. arXiv preprint arXiv:1407.2806, 2014.\nHai Thanh Nguyen, Jérémie Mary, and Philippe Preux. Cold-start problems in recommendation systems via contextual-bandit algorithms. arXiv preprint, arXiv:1405.7544, 2014.\nPaat Rusmevichientong and John N Tsitsiklis. Linearly parameterized bandits. Mathematics of Operations Research, 35(2):395–411, 2010.\nGilbert W Stewart, Ji-guang Sun, and Harcourt Brace Jovanovich. Matrix perturbation theory, volume 175. Academic press New York, 1990.\nIlya Sutskever, Joshua B. Tenenbaum, and Ruslan R Salakhutdinov. Modelling relational data using Bayesian clustered tensor factorization. In Proc. NIPS, pages 1821–1828. Curran Associates, Inc., 2009.\nGábor Takács and Domonkos Tikk. Alternating least squares for personalized ranking. In ACM Conference on Recommender systems, 2012.\nMichal Valko, Rémi Munos, Branislav Kveton, and Tomáš Kocák. Spectral Bandits for Smooth Graph Functions. In Proc. ICML, 2014.\nYuchen Zhang, Xi Chen, Dengyong Zhou, and Michael I Jordan. Spectral methods meet EM: A provably optimal algorithm for crowdsourcing. In Proc. NIPS, pages 1260–1268, 2014.\nAppendix A. Proofs of Lemmas 1 and 2\nProof of Lemma 1 This result holds by construction of the estimates r̃a,a′,n and r̃a,a′,a′′,n. Note that\nE [ r̃a,a′,n ] = 1\nn\nn∑\ni=1\n∑\nb∈[B] E\n[ Xai,1,bi,i,1Xai,2,bi,i,2\npi(a, a′|bi) I{ai,1 = a, ai,2 = a′}\n∣∣∣∣bi = b ] β(b)\n= 1\nn\nn∑\ni=1\n∑\nb∈[B]\n∑\nc∈[C] E\n[ Xai,1,b,i,1Xai,2,b,i,2\npi(a, a′|b) I{ai,1 = a, ai,2 = a′}\n∣∣∣∣bi = b, ci = c ] vb,cβ(b)\n= 1\nn\nn∑\ni=1\n∑\nb∈[B]\n∑\nc∈[C] E\n[ Xa,b,i,1Xa′,b,i,2 ∣∣∣∣bi = b, ci = c ] vb,cβ(b)\n(a) =\n1\nn\nn∑\ni=1\n∑\nb∈[B]\n∑\nc∈[C] E\n[ Xa,b,i,1 ∣∣∣∣bi = b, ci = c ] E [ Xa′,b,i,2 ∣∣∣∣bi = b, ci = c ] vb,cβ(b)\n= 1\nn\nn∑\ni=1\n∑\nb∈[B]\n∑\nc∈[C] ua,cua′,cvb,cβ(b)\n= ∑ c∈[C] ( ∑ b∈[B] vb,cβ(b))ua,cua′,c = ∑\nc∈[C] vβ,cua,cua′,c ,\nwhere (a) holds by independence of the sample generated by user b when in the same class c. Note that ci is the same for all ℓ = 1, 2, 3 interaction steps, that is ci = ci,1 = ci,2 = ci,3, where ci,ℓ is the class corresponding to sample Xa,b,i,ℓ. This is the reason why we get ua,cua′,cvb,c and not a product ua,cua′,cv2b,c for instance.\nProof of Lemma 2 Since the rewards generated by each source a, b are i.i.d., the estimate r̃a,a′,n is a sum of i.i.d. random variables bounded in [0, 1], re-weighted by the probability weights pi(a, a\n′|bi), which are measurable functions of the past. Assuming that there exists some deterministic q2,i > 0 such that ∀i ∈ N, pi(a, a′|bi) > q2,i, we can thus apply a version of Azuma-Hoeffding inequality for bounded martingale difference sequence. Let us recall that by this inequality, for a deterministic time s, and (Ym)m6s ∈ [0, 1] being a bounded martingale difference sequence, then for all δ ∈ (0, 1) it holds\nP(|1 s\ns∑\ni=1\nYi| > √ log(2/δ)\n2s ) 6 δ .\nIn our case, Yi = Xai,1 ,bi,i,1Xai,2,bi,i,2 pi(a,a′|bi) I{ai,1 = a, ai,2 = a ′} −ma,a′ , and we deduce that\nP(|r̃a,a′,n −ma,a′ | >\n√√√√ n∑\ni=1\nq−22,i log(2/δ)\n2n2 ) 6 δ .\nLikewise, we get that\nP(|r̃a,a′,a′′,n −ma,a′,a′′ | >\n√√√√ n∑\ni=1\nq−23,i log(2/δ)\n2n2 ) 6 δ .\nTaking a union bound over the actions in each case, and then over the two events concludes the proof.\nProof of Corollary 1 From Lemma 2, we deduce that on an event of probability higher than 1− δ, it holds simultaneously that\ne(2)n def = ‖M̂n,2 −M2‖ 6 A\n√√√√ n∑\nm=1\nq−22,m log(4A2/δ)\n2n2 ) and\ne(3)n def = ‖M̂n,3 −M3‖ 6 A3/2\n√√√√ n∑\nm=1\nq−23,m log(4A3/δ)\n2n2 ) .\nThis indeed holds by relating the norm of the matrix (tensor) with each of the elements. We conclude by replacing the values of q2,i and q3,i.\nAppendix B. Proof of Theorem 1\nWe prove in this section a slightly more detailed result, namely, the following: Theorem 1. Assume that {γi}i>1 are chosen such that n−2 ∑n i=1 γ −2 i\nn→ 0. Let λmin be the minimum robust eigenvalue of the tensor T = M3(W,W,W ). Let δ ∈ (0, 1). Provided that\nn2∑n i=1 γ −2 i > max\n{ 2A6 log(4A2/δ)\nmin{Γ, σmin}2 , A9(1 + 10( 1Γ + 1 σmin )(1 + u3max)) 2C5 log(4A3/δ) 2C21λ 2 minσ 3 min\n} ,\nwith probability higher than 1−2δ, there exists some permutation π ∈ SC such that for all c ∈ [C],\n||uc − un,π(c)|| 6 ∆A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 + o(n−2\nn∑\ni=1\nγ−2i ),\nwhere we introduced the problem-dependent constant\n∆ = 13 √ σmax ( CA σmin )3/2( 1 + 10( 1 Γ + 1 σmin )(1 + u3max) ) + (2σmax Γ + 1 σmax ) 1 v2min .\nFor general {γi}i>1 (not necessarily such that n−2 ∑n i=1 γ −2 i\nn→ 0), it holds with same probability that\n||uc − un,π(c)|| 6 3A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 ,\nwhere, using the notation ℵ = 1 + 10( 1Γ + 1σmin )(1 + u 3 max), we have introduced the constant\n3 = ( CA σmin )3/2( 13 √ σmax + 4 √ 2min{Γ, σmin}+ 5 (σmax Γ + 1 2σmax ) min{Γ, σmin} ) ℵ\n+ (2σmax\nΓ +\n1\nσmax ) 1 v2min + 5 √ 3/8 (√ σmax + √ min{Γ, σmin}/2 )(2CA σmin )3ℵ2min{Γ, σmin} .\nProof The proof closely follows that of Gheshlaghi Azar et al. (2013). First, note that by property of the rank 1 decomposition ((Anandkumar et al., 2014b, Theorem 4.3)), it holds that λc = ( ∑\nb∈[B] vb,cβ(b)) −2 and thus v−2min > λmax > λmin > 1.\nWe first decompose the following term to make appear the terms from Proposition 1:\n||uc − un,π(c)|| 6 (3)\n|λc − λ̂n,π(c)|︸ ︷︷ ︸ RTP.1 ‖W⊤†‖︸ ︷︷ ︸ b ||ϕc||︸ ︷︷ ︸ a + |λ̂π(c)|︸ ︷︷ ︸ RTP.3 ‖W⊤† − Ŵ⊤†‖︸ ︷︷ ︸ d ||ϕc||︸ ︷︷ ︸ 1 + |λ̂π(c)|︸ ︷︷ ︸ RTP.3 ‖Ŵ⊤†‖︸ ︷︷ ︸ c ||ϕc − ϕ̂n,π(c)||︸ ︷︷ ︸ RTP.2 .\nNote that ϕc, and ϕ̂n,π(c) are both normalized vectors. Thus, (a) is bounded as ||ϕc|| 6 1. It holds for (b) that ‖W⊤†‖ 6 √ Cσmax, and for (c), on the 1− δ event Ω from Corollary 1, that\n‖Ŵ⊤†‖ 6 √ Cσ̂max 6 √ C( √ σmax + √ e (2) n ) . (4)\nThe term (d) requires a little more work. It holds that\n‖W⊤† − Ŵ⊤†‖ = ‖ÛD̂1/2 − UD1/2‖ 6 ‖(Û − U)D1/2‖+ ‖Û(D̂1/2 −D1/2)‖ 6 ‖Û − U‖︸ ︷︷ ︸\ne\nσmax + ‖D̂1/2 −D1/2‖︸ ︷︷ ︸ f\n√ C .\nWe use the result of Lemma 5 from Gheshlaghi Azar et al. (2013) to control (e) and (f). If\ne (2) n 6 1 2Γ, then it holds\n‖D̂1/2 −D1/2‖ 6 e (2) n\nσmax ‖Û − U‖ 6 2\n√ Ce (2) n\nΓ ,\nfrom which we deduce that\n‖W⊤† − Ŵ⊤†‖ 6 (2σmax Γ + 1 σmax ) √ Ce(2)n . (5)\nAt this point, (RTP.1), (RTP.2) and (RTP.3) are controlled by the perturbation method from Anandkumar et al. (2014b), under the condition that en = ‖T − T̂‖ 6 C1 λminC (where C1 is a universal constant). In this case, with probability 1 − δ, the RTP algorithm with well-chosen parameters achieves\n|λc − λ̂n,π(c)| 6 5‖T − T̂n‖\n‖ϕc − ϕ̂n,π(c)‖ 6 8 ‖T − T̂n‖\nλc .\nIn order to make the condition explicit in our setting, we use the fact that by Lemma 6 from Gheshlaghi Azar et al. (2013), if e(2)n 6 12 min{Γ, σmin} then\nen 6 ( C σmin )3/2( e(3)n + 2(1 + √ 2 + 2)e(2)n ( 1 Γσ + 1 σmin )(e(3)n +maxc ||uc||3) ) . (6)\nThe condition e(2)n 6 12 min{Γ, σmin} holds if the number of sessions n is sufficiently large: Indeed on an event of probability higher than 1− δ, then it is enough that\nA3\n√√√√ n∑\ni=1\nγ−2i log(4A2/δ)\n2n2 6\n1 2 min{Γ, σmin} ,\nthat is, reordering the terms, that\nn2∑n i=1 γ −2 i > 2A6 log(4A2/δ) min{Γ, σmin}2 . (7)\nNow, in order to satisfy the condition en = ‖T − T̂n‖ 6 C1 λminC , it is enough that ( C σmin )3/2( e(3)n + 2(1 + √ 2 + 2)e(2)n ( 1 Γ + 1 σmin )(e(3)n +max c ||uc||3) ) 6 C1 λmin C .\nLet us decompose the left-hand-side term: After some simplifications usingmaxc ||uc||3 6 A3/2u3max and e(3)n 6 A3/2, the previous inequality happens when\ne(3)n +A 3/2 9e(2)n 6 C1 λminσ\n3/2 min\nC5/2 .\nwhere 9 = 2(1 + √ 2 + 2)( 1Γ + 1 σmin )(1 + u3max). Using the definition of e (3) n and e (2) n then we deduce that it is enough that\n(1 + 9)A9/2\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 6 C1\nλminσ 3/2 min\nC5/2 ,\nthat is, reordering the terms that\nn2∑n i=1 γ −2 i > A9(1 + 9)2C5 log(4A3/δ) 2C21λ 2 minσ 3 min . (8)\nCombining the decomposition (3) with (4),(5), and using the fact that v−2min > λc > 1, we obtain\n||uc − ūn,π(c)|| 6 5en √ C √ σmax + (λc + 5en) √ C (2σmax\nΓ +\n1\nσmax\n) e(2)n\n+8 √ C(λc + 5en)( √ σmax + √ e (2) n )\nen λc .\n6 √ C [ 13 √ σmaxen +\n(2σmax Γ + 1\nσmax ) e(2)n v2min + 8\n√ e (2) n en\n+5 (2σmax\nΓ +\n1\nσmax\n) e(2)n en + 40( √ σmax + √ e (2) n )e 2 n ] .\nNow, using (6) and unfolding the last inequality, it holds with probability higher than 1− 2δ that ||uc − ūn,π(c)||\n6 √ C [ 13 √ σmax ( C σmin )3/2 (e(3)n + e (2) n A 3/2 9) + (2σmax Γσ + 1 σmax ) e(2)n v2min\n+8 ( C σmin )3/2√ e (2) n (e (3) n + e (2) n A 3/2 9) +5 ( C σmin )3/2(2σmax Γσ + 1 σmax ) e(2)n (e (3) n + e (2) n A 3/2 9) + 40( √ σmax + √ e (2) n )e 2 n ]\n6 [ 13 √ σmax ( CA σmin )3/2 (1 + 9) + (2σmax Γσ + 1 σmax ) 1 v2min ]\n×A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 + o(n−2\nn∑\ni=1\nγ−2i ) ,\nwhich, after some cosmetic simplifications, concludes the first part of the proof of Theorem 1. Alternatively, when n−2 ∑n i=1 γ −2 i 6→ ∞, we can always resort to the condition that e (2) n 6 1/2min{Γ, σmin} in order to simplify the previous derivation. We deduce, similarly, that\n||uc − ūn,π(c)||\n6 √ C [ 13 √ σmax ( C σmin )3/2 (e(3)n + e (2) n A 3/2 9) + (2σmax Γσ + 1 σmax ) e(2)n v2min\n+8 ( C σmin )3/2√ e (2) n (e (3) n + e (2) n A 3/2 9) +5 ( C σmin )3/2(2σmax Γσ + 1 σmax ) e(2)n (e (3) n + e (2) n A 3/2 9) + 40( √ σmax + √ e (2) n )e 2 n ]\n6 [( 13 √ σmax ( CA σmin )3/2 + 8 ( CA σmin )3/2√ min{Γ, σmin}/2\n+5 ( CA σmin )3/2(σmax Γσ + 1 2σmax ) min{Γ, σmin} ) (1 + 9) + (2σmax Γσ + 1 σmax ) 1 v2min +40 (√ σmax + √ min{Γ, σmin}/2\n)( CA σmin )3 (1 + 9)2 min{Γ, σmin} √ 3/8\n]\n×A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 ,\nwhere, in order to control the last term e2n, we used the property that\nen 6 ( CA σmin )3/2( 1 + 9 ) min{e(2)n\n√ log(4A3/δ)\nlog(4A2/δ) , A−3/2e(3)n }\n6 ( CA σmin )3/2( 1 + 9 ) min{ √ 3/2e(2)n , A −3/2e(3)n } .\nAppendix C. Proof of Theorem 3\nProof Let M1:t = (mA1 , . . . ,mAt) ⊤. The argument used to prove Theorem 2 in Yadkori et al, 2011, can be used to show that\nv̂t−1 = V −1 t−1Ū1:t−1η1:t−1 + V −1 t−1Ū1:t−1M1:t−1\nwhere η1:t−1 := (η1, . . . , ηt−1) is the observed noise sequence. Let E1:t−1 := (εA1 , . . . , εAt) ⊤ = M1:t−1 − Ū1:t−1v◦. We then have\nv̂t−1 = V −1 t−1Ū1:t−1η1:t−1 + V −1 t−1Ū1:t−1M1:t−1\n= V −1t−1Ū1:t−1η1:t−1 + V −1 t−1Ū1:t−1\n( Ū\n⊤ 1:t−1v ◦ +E1:t−1 )\n= V −1t−1Ū1:t−1η1:t−1 + v ◦ − λV −1t−1v◦ + V −1t−1Ū1:t−1E1:t−1.\nThus, letting v+t−1 := v ◦ + V −1t−1Ū1:t−1E1:t−1 and using the above with techniques from\nYadkori et al together with ‖v◦‖2 6 RΘ, we have that\nv + t−1 ∈ Ct−1\nwith probability at least 1− δ. Now, let a+t−1 ∈ argmaxa∈A ū⊤a v+t−1 be an optimal action corresponding to the approximate parameter v+t−1, and define the instantaneous regret at time t with respect to the approximate parameter as\nr+t := ū ⊤ a+t−1 v + t−1 − ū⊤Atv + t−1 > 0.\nWe now bound this approximate regret using arguments along the lines of Yadkori et al, 2011. Consider\nr+t = ū ⊤ a+t−1 v + t−1 − ū⊤Atv + t−1\n6 ū⊤At ṽt − ū ⊤ Atv + t−1 (since (At, ṽt) is optimistic) = ū⊤At ( ṽt − v+t−1 ) = ū⊤At (ṽt − v̂t−1) + ū ⊤ At ( v̂t−1 − v+t−1 ) 6 ‖ūAt‖V −1t−1 ‖ṽt − v̂t−1‖Vt−1 + ‖ūAt‖V −1t−1 ∥∥v̂t−1 − v+t−1 ∥∥ Vt−1\n(Cauchy-Schwarz’s inequality)\n6 2Dt−1 ‖ūAt‖V −1t−1 . (9)\nNoting that ma ∈ [−1, 1] ∀a, the regret can be written as\nRT =\nT∑\nt=1\n(ma⋆ −mAt) = T∑\nt=1\nmin{ma⋆ −mAt , 2}\n= ρ′ ∑\na 6=a⋆\nT∑\nt=1\nmin\n{ ma⋆ −ma\nρ′ , 2 ρ′\n} I{At = a}\n6 ρ′ ∑\na 6=a⋆\nT∑\nt=1\nmin { ū ⊤ a⋆v ◦ − ū⊤a v◦, 2\nρ′\n} I{At = a} (using the definition of ρ′)\n(a) 6 ρ′ T∑\nt=1\nmin { 2 ( ū ⊤ a⋆v + t−1 − ū⊤Atv + t−1 ) , 2\nρ′\n} (b) = 2ρ′ T∑\nt=1\nmin { ū ⊤ a+t−1 v + t−1 − ū⊤Atv + t−1, 1 ρ′ }\n= 2ρ′ T∑\nt=1\nmin { r+t , 1\nρ′\n} = ρ′ T∑\nt=1\n2 ρ′ min\n{ ρ′r+t , 1 } (c) 6 ρ′ T∑\nt=1\n2 ρ′ min { 2ρ′Dt−1 ‖ūAt‖V −1t−1 , 1 }\n(d) 6 ρ′ T∑\nt=1\n4Dt−1min { ‖ūAt‖V −1t−1 , 1 }\n6 ρ′ √√√√T T∑\nt=1\n16DT 2 min { ‖ūAt‖2V −1t−1 , 1 } (by using Cauchy-Schwarz’s inequality).\nIn the derivation above,\n• Steps (a) and (b) hold because of the following. By Lemma 4 (to follow below), ∥∥v+t−1 − v◦ ∥∥ 2 =∥∥V −1t−1Ū1:t−1E1:t−1 ∥∥ 2 6 α(Ū ) ‖ε‖2. Since argmaxa∈A ū⊤a v◦ is uniquely a⋆ by hypothesis, we\nhave, thanks to Lemma 5 (to follow below), that ū⊤a⋆v + t−1 − ū⊤a v+t−1 >\nū ⊤ a⋆v ◦−ū⊤a v◦ 2 > 0 ∀a 6= a⋆,\nestablishing (a). This in turn shows that the optimal action for v+t−1 is uniquely a ⋆ at all times t, i.e., a+t−1 = argmaxa∈A ū ⊤ a v + t−1 = a ⋆, which is equality (b).\n• Inequality (c) holds by (9) and (d) holds because ρ′ > 1 by definition, and Dt−1 > λ1/2RΘ > 1/2 by hypothesis, implying that 2ρ′Dt−1 > 1.\nThe argument from here can be continued in the same way as in Abbasi-Yadkori et al. (2011) to yield\nRT 6 8ρ ′ √ TC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) .\nThis proves the theorem.\nLemma 4 (Analysis of the time-varying parameter error V −1t−1Ū1:t−1E1:t−1) Let εa = ma − ū⊤a v◦ be the bias in arm a’s reward due to model error, and let ε ≡ (εa)a∈A be the |A| dimensional vector of arm reward biases. Then, ∥∥V −1t−1Ū1:t−1E1:t−1 ∥∥ 2 6 ( max J ∥∥A−1J ∥∥ 2 ) ‖ε‖2 ,\nwhere A(A+C)×C = [ Ū Id ] , AJ is the C ×C submatrix of A formed by picking rows J , and J ranges over all subsets of full-rank rows of A.\nProof [Proof of Lemma 4] Let zt−1 := V −1 t−1Ū1:t−1E1:t−1 = vt−1−v◦ ∈ RC , with ‖E1:t−1‖∞ 6\n‖ε‖∞ = ∥∥m− Ūv◦ ∥∥ ∞. We have\nzt−1 =\n( t−1∑\ns=1\nūAs ū ⊤ As + λI\n)−1 t−1∑\ns=1\nεAs ūAs\n=\n( 1\nt− 1\nt−1∑\ns=1\nūAs ū ⊤ As +\nλ t− 1I )−1 1 t− 1 t−1∑\ns=1\nεAs ūAs\n=\n(∑\na∈A ūaū\n⊤ a\n∑t−1 s=1 I{As = a}\nt− 1 + λ t− 1I )−1 ∑\na∈A εaūa\n∑t−1 s=1 I{As = a}\nt− 1\n=\n(∑\na∈A ūaū\n⊤ a fa(t− 1) +\nλ t− 1I )−1 ∑\na∈A εaūafa(t− 1),\nwhere fa(t− 1) ≡ fa represents the empirical frequency with which action a ∈ A has been played up to and including time t − 1. This allows us to equivalently interpret zt−1 as the solution of a weighted ℓ2-regularized least squares regression problem with K = |A| observations (instead of the original interpretation with t− 1 observations) as follows.\nLet F1/2 be the A × A diagonal matrix with the values √ f1, . . . , √ fA on the diagonal (note:∑A\na=1 fa = 1). With this, we can express zt−1 as\nzt−1 = arg min z∈RC\n∥∥∥F1/2Ūz − F1/2ε ∥∥∥ 2\n2 +\nλ\nt− 1 ‖z‖ 2 2\n= arg min z∈RC\n∥∥∥F1/2 ( Ūz − ε )∥∥∥ 2\n2 +\nλ\nt− 1 ‖z‖ 2 2\n= arg min z∈RC ∥∥∥∥∥ [ F 1/2 0 0 √\nλ t−1IC\n]([ Ū IC ] z − [ ε 0 ])∥∥∥∥∥ 2\n2\n≡ arg min z∈RC\n∥∥∥D1/2 (Az − b) ∥∥∥ 2\n2 = (A⊤DA)−1A⊤Db,\nwith D1/2 being a (A + C) × (A + C) diagonal & positive semidefinite matrix, A⊤DA =∑ a∈A ūaū ⊤ a fa(t − 1) + λt−1I positive definite, and A having full column rank C. A result of Forsgren (1996, Corollary 2.3) can now be applied to yield\n∥∥(A⊤DA)−1A⊤D ∥∥ 2 6 max\nJ\n∥∥A−1J ∥∥ 2\nwhere J ranges over all subsets of full-rank rows of A, and AJ is the C×C submatrix of A formed by picking rows J . Thus, ‖zt−1‖2 6 ( maxJ ∥∥A−1J ∥∥ 2 ) ‖ε‖2. This proves the lemma.\nLemma 5 (Critical radius) Let ū⊤a⋆v ◦ > ū⊤a v ◦ ∀a 6= a⋆. Then, the following are equivalent:\n‖v − v◦‖2 6 α(Ū ) ‖ε‖2 ⇒ ū⊤a⋆v − ū⊤a v > ū ⊤ a⋆v ◦ − ū⊤a v◦ 2 ∀a 6= a⋆, (10)\nand\n‖ε‖2 < mina 6=a⋆ ū ⊤ a⋆v ◦ − ū⊤a v◦ 2α(Ū) ‖ūa⋆ − ūa‖2 . (11)\nProof [Proof of Lemma 5] Assuming (11), observe that when v lies in the interior of an α(Ū) ‖ε‖2ball around v◦, we have, for any a 6= a⋆,\n(ūa⋆ − ūa)⊤ v = (ūa⋆ − ūa)⊤ v◦ + (ūa⋆ − ūa)⊤ (v − v◦) > (ūa⋆ − ūa)⊤ v◦ + min\n‖ψ‖26α(Ū)‖ε‖2 (ūa⋆ − ūa)⊤ ψ\n= (ūa⋆ − ūa)⊤ v◦ − α(Ū) ‖ε‖2‖ūa⋆ − ūa‖2 > (ūa⋆ − ūa)⊤ v◦ − α(Ū)‖ūa⋆ − ūa‖2 ū ⊤ a⋆v\n◦ − ū⊤a v◦ 2α(Ū) ‖ūa⋆ − ūa‖2\n= ū ⊤ a⋆v ◦ − ū⊤a v◦ 2 ,\nwhich proves one direction of the lemma. For the other direction, note that if ‖ε‖2 > ū\n⊤ a⋆v ◦−ū⊤a v◦\n2α(Ū)‖ūa⋆−ūa‖2\nfor some a 6= a⋆, then by setting v = v◦ − (ū ⊤ a⋆v ◦−ū⊤a v◦)(ūa⋆−ūa) 2‖ūa⋆−ūa‖22 , we have both\n‖v − v◦‖2 = ∥∥∥∥∥ ( ū ⊤ a⋆v ◦ − ū⊤a v◦ ) (ūa⋆ − ūa)\n2 ‖ūa⋆ − ūa‖22\n∥∥∥∥∥ 2 = ū ⊤ a⋆v ◦ − ū⊤a v◦ 2 ‖ūa⋆ − ūa‖2 6 α(Ū) ‖ε‖2\nand\n(ūa⋆ − ūa)⊤ v = (ūa⋆ − ūa)⊤ v◦ − (ūa⋆ − ūa)⊤ ( ū ⊤ a⋆v ◦ − ū⊤a v◦ ) (ūa⋆ − ūa)\n2 ‖ūa⋆ − ūa‖22 =\n(ūa⋆ − ūa)⊤ v◦ 2\nwhich contradicts (10), and we are done.\nC.1 Proof of Lemma 3\nWe begin by establishing some auxiliary technical results, which together imply Lemma 3.\nLemma 6 (Controlling αn) If n is large enough so that (1) and\n3A3C\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 6\n1\n2α⋆ , (12)\nhold, then with probability at least 1− δ, αn 6 2α⋆. (13)\nProof [Proof of Lemma 6] The first step is to estimate the factor α in the analysis of Perturbed OFUL. Towards this, note that the quantity α ≡ α(Ū) in our setting becomes\nαn ≡ αn(Ūn) = max J ∥∥(u⋄n)−1J ∥∥ 2 ,\nwhere u⋄n := [ Ūn IC ] has rank C, and J ranges over all combinations of its C full-rank rows. For\nany such subset of C linearly independent rows J , we have, after denoting u⋄ := [ U IC ] , that\n∥∥(u⋄n)−1J ∥∥ 2 6 ∥∥(u⋄)−1J ∥∥ 2 + ∥∥(u⋄n)−1J − (u⋄)−1J ∥∥ 2 .\nThe final term above can be bounded using Anandkumar et al. (2012, Lemma E.4) – a version of Theorem 2.5 in Stewart et al. (1990). Assuming (u⋄)J is invertible, and ∥∥(u⋄)−1J ((u⋄n)J − (u⋄)J ) ∥∥ 2 < 1, then (u⋄n)J is invertible, and a resulting bound on the norm of its inverse lets us write\n∥∥(u⋄)−1J ∥∥ 2 + ∥∥(u⋄n)−1J − (u⋄)−1J ∥∥ 2 6 ∥∥(u⋄)−1J ∥∥ 2 +\n‖(u⋄n)J − (u⋄)J‖2 ∥∥(u⋄)−1J ∥∥2 2\n1− ∥∥(u⋄)−1J ((u⋄n)J − (u⋄)J ) ∥∥ 2 .\nWriting J = Ju ∪ Jl (u and l stand for “upper” and “lower”) with Jl representing the subset of rows taken from the bottom C rows of u⋄n (i.e., IC ), we have\n(u⋄n)J − (u⋄)J = [ (Ūn − U)Ju 0 ] .\nThus, with ‖·‖F denoting the Frobenius norm, and using the dominance of the Frobenius norm over the matrix 2-norm, with probability at least 1− δ,\n‖(u⋄n)J − (u⋄)J‖2 6 ‖(u⋄n)J − (u⋄)J‖F = ∥∥(Ūn − U)Ju ∥∥ F 6 ∥∥Ūn − U ∥∥ F\n=\n√∑\nc∈[C]\n∥∥Ūn,c − Uc ∥∥2 2\n6 3A3C\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 , (14)\nfrom the RTP error estimate (1). Now, letting α ≡ α(U) = maxJ ∥∥∥(u⋄J) −1 ∥∥∥ 2 , the result above implies that for any suitable J ,\n∥∥(u⋄)−1J ((u⋄n)J − (u⋄)J) ∥∥ 2 6 ∥∥(u⋄)−1J ∥∥ 2 ‖(u⋄n)J − (u⋄)J‖2\n6 α ‖(u⋄n)J − (u⋄)J‖2\n6 α3A3C\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2\n< 1/2\nwhenever n is large enough to satisfy (12). When the condition (12) above holds, we get, for any J at time n,\n∥∥(u⋄n)−1J ∥∥ 2 6 ∥∥(u⋄)−1J ∥∥ 2 +\n‖(u⋄n)J − (u⋄)J‖2 ∥∥(u⋄)−1J ∥∥2 2\n1− ∥∥(u⋄)−1J ((u⋄n)J − (u⋄)J ) ∥∥ 2\n6 α+ 2α2 ‖(u⋄n)J − (u⋄)J‖2\n6 α+ 2α23A3C\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 [by (14)]\n6 α+ 2α2 1\n2α = 2α .\nThis shows that αn = maxJ ∥∥(u⋄n)−1J ∥∥ 2 6 2α.\nLemma 7 (Sufficient condition for (2)) If n is large enough so that (1), (12) and\n3A3C\n√√√√ n∑\ni=1\nγ−2i log(4A3/δ)\n2n2 6 min\n{ gb\n4 √ A ‖vb‖2\n, gb\n16α⋆ √ Cumax ‖vb‖2 + gb\n} (15)\nhold, then (2) is satisfied with probability at least 1− δ.\nProof [Proof of Lemma 7] The term ‖ε‖2 = ∥∥(U − Ūn ) vb ∥∥ 2 is bounded from above by\n∥∥U − Ūn ∥∥ 2 ‖vb‖2 6 ∥∥U − Ūn ∥∥ F ‖vb‖2\n6 √ C ‖vb‖2 3A3\n√√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 (by (14))\n≡ √ C ‖vb‖2 ℵn, say. (16)\nFor any a 6= a⋆,\n(ūn,a⋆ − ūn,a)⊤ vb = (ua⋆ − ua)⊤ vb + ∂avb > ζa, (17)\nwith ∂⊤a := (ūn,a⋆ − ua⋆)− (ūn,a − ua), and ζa := inf‖ξ‖26‖∂a‖2 (ua⋆ − ua) ⊤ vb + ξ ⊤ vb.\nAlso, by (14), we have\nmax a∈[A]\n‖ūn,a − ua‖2 6 √ AC max\nc∈[C] ‖ūn,c − uc‖2\n6 √ AC3A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2\n=: ℵn √ AC.\nThus,\nζa > inf ‖ξ‖262ℵn √ AC\n(ua⋆ − ua)⊤ vb + ξ⊤vb = (ua⋆ − ua)⊤ vb − 2ℵn √ AC ‖vb‖2 . (18)\nBy (17) and (18), for any a 6= a⋆,\n(ūn,a⋆ − ūn,a)⊤ vb > (ua⋆ − ua)⊤ vb − 2ℵn √ AC ‖vb‖2 . (19)\nWe also have\n‖ūn,a⋆ − ūn,a‖2 6 ‖ua⋆ − ua‖2 + ‖ūn,a⋆ − ua⋆‖2 + ‖ūn,a − ua‖2 6 ‖ua⋆ − ua‖2 + 2ℵn √ AC (20)\nwhenever (12) holds. Putting (16), (19), (20) and the conclusion of Lemma 6 together, we have that condition (2) in our case, i.e,\n‖ε‖2 ≡ ∥∥(U − Ūn ) vb ∥∥ 2 6 min a 6=a⋆ (ūn,a⋆ − ūn,a)⊤ vb 2αn ‖ūn,a⋆ − ūn,a‖2\nis satisfied when\n√ C ‖vb‖2 ℵn 6 min a 6=a⋆ (ua⋆ − ua)⊤ vb − 2ℵn\n√ AC ‖vb‖2\n4α⋆ ‖ua⋆ − ua‖2 + 2ℵn √ AC .\nThis, in turn, is satisfied if\n2ℵn √ AC ‖vb‖2 6 1\n2 min a 6=a⋆ (ua⋆ − ua)⊤ vb = gb 2 , and\n√ C ‖vb‖2 ℵn 6\ngb/2\n8α⋆ √ Cumax + gb/(2 ‖vb‖2)\n⇔ ℵn 6 gb\n16α⋆Cumax ‖vb‖2 + gb √ C .\nLemma 8 (Control of the distortion ρ due to noisy feature estimates) Ifn is large enough so that (1), (12) and (15) hold, then ρ′ 6 2 with probability at least 1− δ.\nProof [Proof of Lemma 8] We begin by considering\nmax a 6=a⋆ (ua⋆ − ua)⊤ vb (ūn,a⋆ − ūn,a)⊤ vb 6 max a 6=a⋆ (ua⋆ − ua)⊤ vb (ua⋆ − ua)⊤ vb + ∂avb 6 max a 6=a⋆ (ua⋆ − ua)⊤ vb ζa ,\nwith ∂⊤a := (ūn,a⋆ − ua⋆)− (ūn,a − ua), and\nζa := inf ‖ξ‖26‖∂a‖2\n(ua⋆ − ua)⊤ vb + ξ⊤vb\nas in the proof of Lemma 7. Also, by (14), we have that with probability at least 1− δ,\nmax a∈[A]\n‖ūn,a − ua‖2 6 √ AC max\nc∈[C] ‖ūn,c − uc‖2\n6 √ AC3A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2\n=: ℵn √ AC, say.\nThus,\nζa > inf ‖ξ‖262ℵn √ AC\n(ua⋆ − ua)⊤ vb + ξ⊤vb\n= (ua⋆ − ua)⊤ vb − 2ℵn √ AC ‖vb‖2\n⇒ ζa (ua⋆ − ua)⊤ vb\n> 1− 2ℵn √ AC ‖vb‖2\n(ua⋆ − ua)⊤ vb > 1− 2ℵn √ AC ‖vb‖2 gb ,\nwhere gb := mina 6=a⋆ (ua⋆ − ua)⊤ vb > 0 is the minimum gap for user b across suboptimal actions.\nProvided that (1), (12) and (15) hold, we get that with probability at least 1−δ, ζa (ua⋆−ua)⊤vb >\n1 2 for each a 6= a⋆. Also, by the definition of a⋆, the denominator is positive, i.e., (ua⋆ − ua) ⊤ vb > 0. Hence,\nmax a 6=a⋆ (ua⋆ − ua)⊤ vb (ūn,a⋆ − ūn,a)⊤ vb 6 2,\ncompleting the proof of the result.\nLemma 9 (Bounding RX ) If n is large enough so that (1) and (12) hold, then\nRX 6\n√ A 2α⋆ +max a∈A ‖ua‖2 ,\nwith probability at least 1− δ.\nProof [Proof of Lemma 9] Conditions (1) and (12), together with the estimate (20), imply that for any action a,\n‖ūn,a‖2 6 ‖ua‖2 + ‖ūn,a − ua‖2 6 ‖ua‖2 + ℵn √ AC 6 ‖ua‖2 + √ A/(2α⋆).\nwith probability at least 1− δ.\nIn order to conclude the proof of Lemma 3, we gather the conditions from Lemma 6 and Lemma 7. After some simplifications, both conditions are satisfied as soon as\nn2∑n i=1 γ −2 i > 32A6C2 log(4A3/δ)max\n{ 2α2⋆,\n8A||vb||22 g2b , 27α2⋆Cu 2 max||vb||22 g2b + 1/2\n} .\nAppendix D. Proof of Theorem 4\nProof Let n0 be the first mini-session such that both conditions in Lemma 3 are satisfied, that is such that\nn0∑n0 i=1 γ −2 i > 9δ .\nThe cumulative regret RT = ∑T t=1 rt of Algorithm 3 satisfies\nRT =\nN∑\nn=1\nℓ∑\nl=1\nrn,l\n6 (n0 − 1)ℓ+ ∑\nb∈[B]\nN∑\nn=n0\nℓ∑\nl=1\nrn,lI{bn = b}\nwhere rt ≡ rn,l def= u⊤a⋆bnvbn−u ⊤ an,lvbn is the instantaneous regret of Algorithm 3 at time t = ℓn+k when the current user is bn = b. Using the notations of Algorithm 3, it holds that\nE[rt|bn = b] = E[rtI{pn = 1}|bn = b] + E[rtI{pn = 0}|bn = b] 6 E[u⊤a⋆bvb − u ⊤ ãn,k\nvb](1 − γn) + γn. 6 E[u⊤a⋆bvb − u ⊤ ãn,k ub] + γn,\nwhere ãn,k is an action output by an instance of OFUL for user bn = b. Thus, we have\nE[RT |b1, . . . , bN ]\n6 (n0 − 1)ℓ+ E [ ∑\nb∈[B]\nN∑\nn=n0\nℓ∑\nl=1\n( u ⊤ a⋆b vb − u⊤ãn,lvb ) I{bn = b} ∣∣∣∣b1, . . . , bN ] + ℓ N∑\nn=n0\nγn .\n= (n0 − 1)ℓ+ ∑\nb∈[B] E\n[ ∑\nn06n6N, bn=b\nℓ∑\nl=1\n( u ⊤ a⋆b vb − u⊤ãn,lvb )\n︸ ︷︷ ︸ (⋆)\n∣∣∣∣b1, . . . , bN ] + ℓ N∑\nn=n0\nγn. (21)\nFor each user b ∈ [B], the expectation in the right-hand side above corresponds to the cumulative regret of the OFUL strategy when interacting with user b in mini-sessions n0 through N , and when given at each mini-session n the set of perturbed feature vectors Un. Let Nb,n0 =∑N\nn=n0 I{bn = b} count the total number of mini-sessions from n0 in which user b is present (note\nthat ∑ b∈[B]Nb,1 = N and ∑ b∈[B] ℓNb,1 = T ). Let us denote the term (⋆) in the above explicitly using Rb,Nb,n0 ({Un}n∈[n0,N ],bn=b).\nWe can now use the OFUL robustness guarantee – a natural technical extension8 of Theorem 3 along with Lemma 3 – to obtain that, for a given user sequence b1, . . . , bN , with probability at least9 1− 2δ − δ = 1− 3δ,\nRb,Nb,n0 ({Un}n∈[n0,N ],bn=b) 6\n16 √ ℓNb,n0 C log ( 1 + ℓNb,n0R 2 X\nλC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 + ℓNb,n0R 2 X\nλC\n)) .\n8. Although Theorem 3 holds only for a fixed perturbation ε and feature set ū, it is not hard to see that a modification of it, with time-varying εt, ūt and ρ′ being the largest ρ′t over all times t, yields the same conclusion (regret bound). We provide this extension in Theorem 5 in Appendix E below. 9. Although the time horizons played by each OFUL instance per user, Nb,n0 , are technically random and unknown to the instance at the start, conditioning on the sequence of users arriving at each time instant lets us use the conclusion of Lemma 3.\nThis in turn implies that\n∑ b∈B E [ Rb,Nb,n0 ({Un}n∈[n0,N ],bn=b) ∣∣∣∣b1, . . . , bN ]\n(a) 6 16 ∑\nb∈B\n√ ℓNb,n0 C log ( 1 + ℓNb,n0R 2 X\nλC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 + ℓNb,n0R 2 X\nλC\n))\n+ ∑\nb∈B 3δℓNb,n0\n(b) 6 16 ∑\nb∈B\n√ ℓNb,n0 C log ( 1 + ℓNb,n0R 2 X\nλC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 + ℓNb,n0R 2 X\nλC\n))\n+ 3δT.\nThe last term on the right-hand side in (a) is due to the fact that with probability at most 3δ, the per-user regret Rb,Nb,n0 ({Un}n∈[n0,N ],bn=b) can be as large as ℓNb,n0 (the total number of time slots for which user b interacts with the system). The corresponding term in (b) is by using∑\nb∈[B] ℓNb,1 = T . Further bounding using the Cauchy-Schwarz inequality ∑ b∈B √ ℓNb,n0 6√\nBT gives\n∑ b∈B E [ Rb,Nb,n0 ({Un}n∈[n0,N ],bn=b) ∣∣∣∣b1, . . . , bN ]\n6 16 ∑\nb∈B\n√ ℓNb,n0 C log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) + 3δT\n6 16 √ BTC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) + 3δT.\nPlugging this estimate into (21), we obtain that E[RT |b1, . . . bN ] 6 ℓ ( n0 − 1 + N∑\nn=n0\nγn\n)\n+ 16 √ BTC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) + 3δT.\nExpliciting n0 and tuning γn The next step is to control the term n0− 1+ ∑N\nn=n0 γn. To this\nend, we explicit n0 and optimize γn. We write 9 ≡ 9δ in the sequel for convenience. If γn = min{1,91/2n−1/2}, then\nn2∑n m=1 γ −2 m = n2 ⌈9⌉+ 19 ∑n m>⌈9⌉ m\n= 29n2\n⌈9⌉29+ n(n+ 1)− ⌈9⌉(⌈9⌉ − 1)\n> 29\n1 + 1/n+ (⌈9⌉9)/n2 .\nThus, this is higher than 9 if n2 − n − ⌈9⌉9 > 0, that is if n > n0 def= ⌈1/2 + √ ⌈9⌉9 + 1/4⌉. Since n0 > ⌈9⌉, we immediately get\nN∑\nn=n0\nγn 6 9 1/2n − 12 0 + 29 1/2 ( N 1 2 − n 1 2 0 )\n6 1 + 291/2 ( N 1 2 − n 1 2 0 ) .\nThus, we obtain\nn0 − 1 + N∑\nn=n0\nγn 6 29 1/2N 1 2 + n0 − 291/2n1/20\n6 291/2N 1 2 + n0 − 2 √ 9⌈9⌉\nUsing the fact that 9 > 1, the bound simplifies to\nn0 − 1 + N∑\nn=n0\nγn 6 2 √ 9N + 1 .\nIf, on the other hand, a bound on 9 is not readily available beforehand, then choosing γn =√ log(1 + n)/n, n > 1, gives, via a crude bound,\nn∑\nm=1\nγ−2m = n∑\nm=1\nm/ log(1 +m) 6\n√ n∑\nm=1\nm/ log 2 + n∑\nm= √ n\nm/ log(1 + √ n)\n6 n/ log 2 + n2/ log √ n 6 2n2/ log √ n\n⇒ n 2 0∑n0\nm=1 γ −2 m\n> n20\n2n20/ log √ n0\n= log n0\n4 .\nThe bound above is at least 9 provided n0 > exp(49). Thus, we finally get that, upon setting δ = 1/ √ T , the total expected regret satisfies (as an order-wise function of T )\nE[RT ]\n6 ℓ ( exp(49) + N∑\nn=1\n√ log(n+ 1)/n\n)\n+ 16 √ BTC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ log T + C log ( 1 +\nTR2X λC\n)) + 3 √ T\n= O ( C √ BT logT ) .\nAppendix E. Extension of Theorem 3: Robustness of OFUL’s regret with time-varying features\nWe now control the robust regret for user bRb,Nb,n0 ({Un}n∈[n0,N ],bn=b) = ∑\nn06n6N, bn=b\n∑ℓ l=1 ( u ⊤ a⋆b vb−\nu ⊤ ãn,l vb ) , when OFUL is run with evolving feature matrices {Un}n∈[n0,N ],bn=b with decreasing feature error εn = (U − Un)vb, instead of a fixed U with fixed error ε = (U − U)vb. We reindex the n ∈ [n0, N ], bn = b as t = 1, . . . , .. and prove the following result.\nTheorem 5 (OFUL robustness result, extension of Theorem 3 for time-varying features) Assume ||v◦||2 6 RΘ, λ > max { 1, R2X , 1/4R 2 Θ } , ∀a ∈ A, t 6 T , ||ū(t)a ||2 6 RX and |ma| 6 1, and that for all t 6 T , argmaxa∈A ū (t)⊤ a v\n◦ = {a⋆} (i.e., the linearly realizable approximation with respect to the current features has a⋆ as its unique optimal action). If\n∥∥∥ε(t) ∥∥∥ 2 ≡ ∥∥∥m− Ū (t)v◦ ∥∥∥ 2 < min a 6=a⋆ ū (t)⊤ a⋆ v ◦ − ū(t)⊤a v◦\n2α(Ū (t)⊤) ∥∥∥ū(t)a⋆ − ū(t)a ∥∥∥ 2 , (22)\nthen with probability at least 1− δ, for all T > 0,\nRT 6 8ρ ′ √ TC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) ,\nwhere ρ′ := maxt max { 1,maxa 6=a⋆\nma⋆−ma ū (t)⊤\na⋆ v ◦−ū(t)⊤a v◦\n} .\nProof Let M1:t = (mA1 , . . . ,mAt) ⊤. The argument used to prove Theorem 2 in Yadkori et al, 2011, shows that\nv̂t−1 = V −1 t−1Ū (t) 1:t−1η1:t−1 + V −1 t−1Ū (t) 1:t−1M1:t−1\nwhere η1:t−1 := (η1, . . . , ηt−1) is the observed noise sequence, and where Ū (t) 1:t−1 is the matrix built from the time varying features at time t and the action sequence thus far. Let E(t)1:t−1 := (ε (t) A1 , . . . , ε (t) At )⊤ = M1:t−1 − Ū(t)1:t−1v◦. We then have\nv̂t−1 = V −1 t−1Ū (t) 1:t−1η1:t−1 + V −1 t−1Ū (t) 1:t−1M1:t−1\n= V −1t−1Ū (t) 1:t−1η1:t−1 + V −1 t−1Ū (t) 1:t−1\n( Ū\n(t)⊤ 1:t−1v ◦ +E(t)1:t−1\n)\n= V −1t−1Ū (t) 1:t−1η1:t−1 + v ◦ − λV −1t−1v◦ + V −1t−1Ū (t) 1:t−1E (t) 1:t−1.\nThus, letting v+t−1 := v ◦ + V −1t−1Ū (t) 1:t−1E (t) 1:t−1, and using the above with techniques from\nYadkori et al together with ‖v◦‖2 6 RΘ, we have that\nv + t−1 ∈ Ct−1\nwith probability at least 1− δ. Now, let a+t−1 ∈ argmaxa∈A ū (t)⊤ a v + t−1 be an optimal action corresponding to the approximate parameter v+t−1 and approximate feature ū (t)⊤ a , and define the instantaneous regret at time t with respect to the approximate parameter as\nr+t := ū (t)⊤ a+t−1 v + t−1 − ū (t)⊤ At v + t−1 > 0.\nWe now bound this approximate regret using arguments along the lines of Yadkori et al, 2011 as follows. Write\nr+t = ū (t)⊤ a+t−1 v + t−1 − ū (t)⊤ At v + t−1\n6 ū (t)⊤ At ṽt − ū(t)⊤At v + t−1 (since (At, ṽt) is optimistic) = ū (t)⊤ At ( ṽt − v+t−1 ) = ū (t)⊤ At (ṽt − v̂t−1) + ū(t)⊤At ( v̂t−1 − v+t−1 )\n6 ∥∥∥ū(t)At ∥∥∥ V −1t−1 ‖ṽt − v̂t−1‖Vt−1 + ∥∥∥ū(t)At ∥∥∥ V −1t−1 ∥∥v̂t−1 − v+t−1 ∥∥ Vt−1\n(Cauchy-Schwarz’s inequality)\n6 2Dt−1 ∥∥∥ū(t)At ∥∥∥ V −1t−1 . (23)\nNoting that ma ∈ [−1, 1] ∀a, the regret can be written as\nRT =\nT∑\nt=1\n(ma⋆ −mAt) = T∑\nt=1\nmin{ma⋆ −mAt , 2}\n= ρ′ ∑\na 6=a⋆\nT∑\nt=1\nmin\n{ ma⋆ −ma\nρ′ , 2 ρ′\n} I{At = a}\n6 ρ′ ∑\na 6=a⋆\nT∑\nt=1\nmin { ū (t)⊤ a⋆ v ◦ − ū(t)⊤a v◦, 2\nρ′\n} I{At = a} (using the definition of ρ′)\n(a) 6 ρ′ T∑\nt=1\nmin { 2 ( ū (t)⊤ a⋆ v + t−1 − ū (t)⊤ At v + t−1 ) , 2\nρ′\n} (b) = 2ρ′ T∑\nt=1\nmin { ū (t)⊤ a+t−1 v + t−1 − ū (t)⊤ At v + t−1, 1 ρ′ }\n= 2ρ′ T∑\nt=1\nmin { r+t , 1\nρ′\n} = ρ′ T∑\nt=1\n2 ρ′ min\n{ ρ′r+t , 1 } (c) 6 ρ′ T∑\nt=1\n2 ρ′ min\n{ 2ρ′Dt−1 ∥∥∥ū(t)At ∥∥∥ V −1t−1 , 1 }\n(d) 6 ρ′ T∑\nt=1\n4Dt−1min {∥∥∥ū(t)At ∥∥∥ V −1t−1 , 1 }\n6 ρ′ √√√√T T∑\nt=1\n16DT 2 min {∥∥∥ū(t)At ∥∥∥ 2\nV −1t−1\n, 1 } (by using Cauchy-Schwarz’s inequality).\nIn the derivation above,\n• Steps (a) and (b) hold because of the following. By Lemma 10 (to follow below), ∥∥v+t−1 − v◦ ∥∥ 2 =∥∥∥V −1t−1Ū (t) 1:t−1E (t) 1:t−1 ∥∥∥ 2 6 α(Ūt) ∥∥ε(t) ∥∥ 2 . Since argmaxa∈A ū (t)⊤ a v ◦ is uniquely a⋆ by hypothesis,\nwe have, thanks to Lemma 5, that ū(t)⊤a⋆ v + t−1 − ū (t)⊤ a v + t−1 >\nū (t)⊤ a⋆ v ◦−ū(t)⊤a v◦ 2 > 0 ∀a 6= a⋆, es-\ntablishing (a). This in turn shows that the optimal action for v+t−1 is uniquely a ⋆ at all times t, i.e., a+t−1 = argmaxa∈A ū (t)⊤ a v + t−1 = a ⋆, which is precisely equality (b).\n• Remark. In the above, Lemma 5 is written for generic ūa, ε, so in particular applies to each time varying ū(t)a , ε(t). We also used an extended version of Lemma 4 to the case of varying ū (t) a , ε(t),\nwhich we state and prove below as Lemma 10.\n• Inequality (c) holds by (23) and (d) holds because ρ′ > 1 by definition, and Dt−1 > λ1/2RΘ > 1/2 by hypothesis, implying that 2ρ′Dt−1 > 1.\nThe argument from here can be continued in the same way as in Abbasi-Yadkori et al. (2011, proof of Theorem 3) to yield\nRT 6 8ρ ′ √ TC log ( 1 +\nTR2X λC\n)( λ1/2RΘ +R √ 2 log 1\nδ + C log\n( 1 +\nTR2X λC\n)) .\nThis proves the theorem.\nLemma 10 (Extension of Lemma 4 to time-varying feature sets) Let ε(t)a = ma − ū(t)⊤a v◦ be the bias in arm a’s reward due to model error, with respect to the features Ūt, and let ε(t) ≡ ( ε (t) a\n) a∈A . Then, we have\n∥∥∥V −1t−1Ū (t) 1:t−1E (t) 1:t−1 ∥∥∥ 2 6 ( max J ∥∥∥A(t)−1J ∥∥∥ 2 )∥∥∥ε(t) ∥∥∥ 2 ,\nwhere A(t)(A+C)×C =\n[ Ū (t)\nId\n] , A(t)J is the C × C submatrix of A(t) consisting of rows in J , and J ranges\nover all subsets of full-rank rows of A(t).\nProof [Proof of Lemma 10] Let z(t)t−1 := V −1 t−1Ū (t) 1:t−1E (t) 1:t−1 = v + t−1−v◦ ∈ RC , thus ∥∥∥E(t)1:t−1 ∥∥∥ ∞\n6 ∥∥ε(t)\n∥∥ ∞ = ∥∥m− Ū (t)v◦ ∥∥ ∞. We now write\nz (t) t−1 =\n( t−1∑\ns=1\nū (t) As ū (t)⊤ As + λI\n)−1 t−1∑\ns=1\nε (t) As ū (t) As\n=\n( 1\nt− 1\nt−1∑\ns=1\nū (t) As ū (t)⊤ As + λ t− 1I )−1 1 t− 1 t−1∑\ns=1\nε (t) As ū (t) As\n=\n(∑\na∈A ū (t) a ū (t)⊤ a\n∑t−1 s=1 I{As = a}\nt− 1 + λ t− 1I )−1 ∑\na∈A ε(t)a ū (t) a\n∑t−1 s=1 I{As = a}\nt− 1\n=\n(∑\na∈A ū (t) a ū (t)⊤ a fa(t− 1) +\nλ t− 1I )−1 ∑\na∈A ε(t)a ū (t) a fa(t− 1),\nwhere fa(t − 1) is the empirical frequency with which action a ∈ A has been played up to and including time t − 1. This allows us to equivalently interpret zt−1 as the solution of a weighted ℓ2-regularized least squares regression problem with K = |A| observations (instead of the original interpretation with t− 1 observations) as follows (we suppress the dependence of fa on t as per the context for clarity of notation).\nLet F1/2 be the A × A diagonal matrix with the values √ f1, . . . , √ fA on the diagonal (note:∑A\na=1 fa = 1). With this, we can express zt−1 as\nz (t) t−1 = arg min\nz∈RC\n∥∥∥F1/2Ū (t)z − F1/2ε(t) ∥∥∥ 2\n2 +\nλ\nt− 1 ‖z‖ 2 2\n= arg min z∈RC\n∥∥∥F1/2 ( Ū (t)z − ε(t) )∥∥∥ 2\n2 +\nλ\nt− 1 ‖z‖ 2 2\n= arg min z∈RC ∥∥∥∥∥ [ F 1/2 0 0 √\nλ t−1IC\n]([ Ū (t)\nIC\n] z − [ ε(t)\n0 ])∥∥∥∥∥ 2\n2\n≡ arg min z∈RC\n∥∥∥D1/2 (Az − b) ∥∥∥ 2\n2 = (A⊤DA)−1A⊤Db,\nwith D1/2 being a (A + C) × (A + C) diagonal & positive semidefinite matrix, A⊤DA =∑ a∈A ū (t) a ū (t)⊤ a fa(t − 1) + λt−1I being positive definite, and A having full column rank C. A result of Forsgren (1996, Corollary 2.3) now gives ∥∥(A⊤DA)−1A⊤D\n∥∥ 2 6 max\nJ\n∥∥A−1J ∥∥ 2\nwhere J ranges over all subsets of full-rank rows of A, and AJ is the C×C submatrix of A formed by picking rows J . Thus, ∥∥∥z(t)t−1 ∥∥∥ 2 6 ( maxJ ∥∥A−1J ∥∥ 2 ) ∥∥ε(t) ∥∥ 2 . This proves the lemma.\nAppendix F. Unregularized Least squares\nIn our setting where we consider finitely many arms, one way wonder whether it is possible to remove the regularization parameter λ. Following Rusmevichientong and Tsitsiklis (2010), this is indeed possible under the assumption that the minimum eigenvalue of ∑ a∈A uau ⊤ a is away from 0. Then, we first play each arm once (once for all users B, not for each of them) before running\nAlgorithm 3, where OFUL is used with λ = 0 and with Dt−1 redefined to be 4R2 ( A log(t) +\nlog(A/δ) ) . This leads essentially to similar bounds, with α⋆ replaced by maxJ ||U−1J ||2, as we\nshow below. Let U ⊂ RC . We receive at time s, observation ys = u⊤s v⋆ + ηs ∈ R where v⋆ ∈ RC and us ∈ U . We make the following\nAssumption 2 There exists RX , R, λ0 ∈ R+⋆ such that 1. ∀s, ||us|| 6 RX 2. ∀λ ∈ R, logE exp(ληs) 6 λ2R2/2. 3. λmin( ∑t s=1 usu ⊤ s ) > λ0.\nAssumption 2.3 is satisfied for instance when there are C points (u0,i)i∈[C] in Rd such that\nλmin( ∑C i=1 u0,iu ⊤ 0,i) = λ0 > 0, and us = u0,s for s ∈ [C]. We consider the least-squares estimate\nvt = ( t∑\ns=1\nusu ⊤ s\n)−1 ⊤∑\ns=1\nusys ,\nF.1 Preliminary\nIn case U is finite, one can get the following result Theorem 6 Let us introduce the confidence set\nCt = { w ∈ RC : w⊤Gtw 6 Dt,δ } , where Gt = t∑\ns=1\nusu ⊤ s\nand Dt,δ = 4R 2 ( |U| log(t) + log(|U|/δ) ) .\nThen, under Assumption 2, it holds\nP ( vt − v⋆ ∈ Ct ) > 1− δ .\nIn the general case, it holds\nTheorem 7 Let us introduce the confidence set\nCt = { w ∈ RC : w⊤Gtw 6 Dt,δ } , where Gt = t∑\ns=1\nusu ⊤ s\nand Dt,δ = 16R 2 [ 1 + log ( 1 +\n36R2X λ0\n)][ C log ( 36R2X λ0 t ) + log(1/δ) ] log(t) .\nThen, under Assumption 2, and if t > λ0 12R2\nX\nit holds\nP ( vt − v⋆ ∈ Ct ) > 1− δ .\nProof: Indeed, let zt = ∑⊤ s=1 usηs. Since Gt is invertible, it holds that vt = v⋆ + G −1 t zt,\nand thus\n(vt − v⋆)⊤Gt(vt − v⋆) = ztG−1t zt\nIn the case when U is finite, using the Proof of Theorem B.1 in Rusmevichientong and Tsitsiklis (2010) then we further get for all ε > 0,\nP ( ztG −1 t zt > ε 2R2 ) 6 |U|t|U|e−ε2/4 ,\nThus, choosing ε = 2 √ log(|U|t|U|/δ), we obtain that\nP ( ztG −1 t zt > 4R 2 ( |U| log(t) + log(|U|/δ) )) 6 δ ,\nwhich concludes the proof of Theorem 6. From the Proof of Theorem B.2 in Rusmevichientong and Tsitsiklis (2010), it holds that for all ε > 2,\nP ( ztG −1 t zt > ε 2k20R 2 log(t) ) 6 ( 36R2X t/λ0 )C e−ε 2/4 ,\nwhere k0 = 2 √ 1 + log(1 + 36R2X/λ0), which leads to\nP ( ztG −1 t zt > 4 ( 1 + log(1 + 36R2X/λ0))R 2 log(t)ε2 ) 6 ( 36R2X t/λ0 )C e−ε 2/4 ,\nThus, let us use ε = 2 √ log (( 36R2X t/λ0 )C /δ ) , which satisfies ε > 2 as soon as t > λ0e 1/C\n36R2 X\n, thus\nin particular if t > λ0 12R2\nX\n. Now, introducing the constant c = 36R2X/λ0, we obtain\nP ( ztG −1 t zt > 16R 2(1 + log(1 + c)) log(t) ( C log(ct) + log(1/δ) )) 6 δ ,\nwhich concludes the proof of theorem 7.\nF.2 Application to Low-Rank bandits\nIn order to apply this result to the low-rank bandit problem, we need to show that Gt is invertible. In our case, this matrix is at mini-session n M̃t = ∑t s=1 ũn,as ũ ⊤ n,as .\nLet us assume that all actions are sample at least once in the beginning. Thus, in this case λmin(M̃t) > λmin(Ã), where Ã = ∑ a∈[A] ũn,aũ ⊤ n,a. For convenience, let us also introduce the C × C matrix A =∑a∈[A] uau⊤a = U⊤U . In order to show that M̃t is invertible, it us enough to show that λmin(Ã) > 0. Now, by the result of reconstruction of the feature matrix M , we know that there exists with high probability a permutation π such that the columns are well estimated:\n∀c, ||uπ(c) − ũn,c|| 6 3A3 √√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2 .\nThus, we study E = Ã−A. Let λ be any eigenvalue of E, then it holds\nλ 6 trace(E) = ∑\na∈[A] trace\n( ũn,aũ ⊤ n,a − uau⊤a )\n6 ∑\na∈[A] ||ũn,a||2 − ||ua||2\n6 ∑\na∈[A]\n∑\nc∈[C] ũ2n,a,c − u2a,c\n6 ∑\na∈[A]\n∑\nc∈[C] (ũn,a,c − ua,c)2 + 2ua,c(ũn,a,c − ua,c)\n6 ∑\nc∈[C] ||ũn,c − uc||2 + 2\n∑\nc∈[C]\n√∑\na∈[A] u2a,c\n√∑\na∈[A] (ũn,a,c − ua,c)2\n6 ∑\nc∈[C] ||ũn,c − uc||2 + 2||uc||||ũn,c − uc||\n6 (2umax + 1) ∑\nc∈[C] ||ũn,c − uc|| .\nThus, provided that n is large enough that\nλmin(A) > 2(2umax + 1) ∑\nc∈[C] ||ũn,c − uc|| ,\nwe deduce that M̃t is invertible. Using the fact that A = U⊤U , This translates to the condition\nλmin(U ⊤U) > 23(2umax + 1)CA 3\n√√√√ n∑\ni=1\nγ−2i C log(4A3/δ)\n2n2\nthat is\nn2∑n i=1 γ −2 i > 432(2umax + 1) 2C3A6 log(4A3/δ) λ2min(U ⊤U) .\nThus, assuming that all actions are chosen at least once in the beginning, and that\nn2∑n m=1 γ −2 m > 432(2umax + 1) 2C3A6 log(4A3/δ) λ2min(U ⊤U) ,\nthen λmin(M̃t) > λmin(U⊤U)/2 = λ0/2 > 0 and Theorem 6 and Theorem 7 both apply. In order to control the regret of the unregularized version of OFUL, we now use the proof of Rusmevichientong and Tsitsiklis (2010, Theorem 4.1) combined with the fact that λmin(M̃t) > λ0/2 to get\nn∑\nt=A+1\nmin{||ūAt ||2M̃−1t−1 , 1} 6 2max{1, 2R2X λ0\n} ( C log(max{1, 2R 2 X\nλ0 }) + (C + 1) log(n+ 1)\n) .\nA straightforward adaptation of the proof of Theorem 3 then gives\nRn 6 ρ ′ √√√√n(A+ 16D2n,δ n∑\nt=A+1\nmin{||ūAt ||2M̃−1t−1 , 1})\n6 16ρ′R2 ( A log(n) + log(A/δ) )√ n ( 2 +\n4R2X λ0\n)( C log ( 1+\n2R2X λ0\n) + (C+1) log(n+1)\n)\n+ρ′ √ An .\nFollowing the same steps as for Lemma 3, we finally obtain the result:\nTheorem 8 (Unregularized OFUL robustness result) Assume ||v◦||2 6 RΘ, for all a ∈ A, ||ūa||2 6 RX and |ma| 6 1, and that argmaxa∈A ū⊤a v◦ = {a⋆} (i.e., the linearly realizable approximation has a⋆ as its unique optimal action). Assume that each action has been played once. Let 0 < δ 6 1. Provided that the number of mini-sessions n0 is large enough to satisfy\nn20∑n0 i=1 γ −2 i > 9̃b,δ\nwhere\n9̃b,δ = max\n{ 2A6 log(4A2/δ)\nmin{Γ, σmin}2 , A9(1 + 10( 1Γ + 1 σmin )(1 + u3max)) 2C5 log(4A3/δ) 2C21σ 3 min\n432(2umax + 1) 2C3A6 log(4A3/δ)\nλ2min(U ⊤U)\n,\n3 2A6C2 log(4A3/δ)max { 2α2⋆,\n8A||vb||22 g2b , 27α2⋆Cu 2 max||vb||22 g2b + 1/2\n}} ,\nthen with probability at least 1 − δ for all T > 0, the regret RA+1:n of the OFUL algorithm from decision A+ 1 to n satisfies\nRA+1:n 6 32R 2 [ A log(n) + log(A/δ)\n]√\nn ( 2 + 4R 2\nX λ0\n)( C log ( 1+ 2R 2\nX λ0\n) + (C+1) log(n+1) ) ,\nwhere we introduced\nRX = max a∈A\n||ua||2 + √ A\n2α⋆ and α⋆ = min J ||U−1J || .\nThis result enables to get the corresponding variant of Theorem 4 using an unregularized OFUL."
    } ],
    "references" : [ {
      "title" : "Improved Algorithms for Linear Stochastic Bandits",
      "author" : [ "Yasin Abbasi-Yadkori", "David Pal", "Csaba Szepesvari" ],
      "venue" : "In Proc. NIPS,",
      "citeRegEx" : "Abbasi.Yadkori et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Abbasi.Yadkori et al\\.",
      "year" : 2011
    }, {
      "title" : "A method of moments for mixture models and hidden markov models",
      "author" : [ "Animashree Anandkumar", "Daniel Hsu", "Sham M Kakade" ],
      "venue" : "arXiv preprint arXiv:1203.0683,",
      "citeRegEx" : "Anandkumar et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Anandkumar et al\\.",
      "year" : 2012
    }, {
      "title" : "A tensor approach to learning mixed membership community models",
      "author" : [ "Animashree Anandkumar", "Rong Ge", "Daniel Hsu", "Sham M Kakade" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Anandkumar et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Anandkumar et al\\.",
      "year" : 2014
    }, {
      "title" : "Tensor decompositions for learning latent variable models",
      "author" : [ "Animashree Anandkumar", "Rong Ge", "Daniel Hsu", "Sham M. Kakade", "Matus Telgarsky" ],
      "venue" : "J. Mach. Learn. Res.,",
      "citeRegEx" : "Anandkumar et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Anandkumar et al\\.",
      "year" : 2014
    }, {
      "title" : "Finite-time analysis of the multiarmed bandit problem",
      "author" : [ "P. Auer", "N. Cesa-Bianchi", "P. Fischer" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Auer et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Auer et al\\.",
      "year" : 2002
    }, {
      "title" : "A latent source model for online collaborative filtering",
      "author" : [ "Guy Bresler", "George H Chen", "Devavrat Shah" ],
      "venue" : "In Proc. NIPS",
      "citeRegEx" : "Bresler et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Bresler et al\\.",
      "year" : 2014
    }, {
      "title" : "Stochastic Linear Optimization under Bandit Feedback",
      "author" : [ "Varsha Dani", "Thomas P. Hayes", "Sham M. Kakade" ],
      "venue" : "In Proc. COLT,",
      "citeRegEx" : "Dani et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Dani et al\\.",
      "year" : 2008
    }, {
      "title" : "Sequential transfer in multi-armed",
      "author" : [ "Mohammad Gheshlaghi Azar", "Alessandro Lazaric", "Emma Brunskill" ],
      "venue" : null,
      "citeRegEx" : "Azar et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Azar et al\\.",
      "year" : 2014
    }, {
      "title" : "bandit with finite set of models",
      "author" : [ "Thomas Hofmann", "Jan Puzicha" ],
      "venue" : "In Proc. NIPS,",
      "citeRegEx" : "Hofmann and Puzicha.,? \\Q2013\\E",
      "shortCiteRegEx" : "Hofmann and Puzicha.",
      "year" : 2013
    }, {
      "title" : "Using mixture models for collaborative filtering",
      "author" : [ "Jon Kleinberg", "Mark Sandler" ],
      "venue" : "Proc. ACM Symposium on Theory Of computing (STOC),",
      "citeRegEx" : "Kleinberg and Sandler.,? \\Q2013\\E",
      "shortCiteRegEx" : "Kleinberg and Sandler.",
      "year" : 2013
    }, {
      "title" : "Efficient learning by implicit exploration",
      "author" : [ "Tomáš Kocák", "Gergely Neu", "Michal Valko", "Rémi Munos" ],
      "venue" : "Theory Of Computing (STOC),",
      "citeRegEx" : "Kocák et al\\.,? \\Q2004\\E",
      "shortCiteRegEx" : "Kocák et al\\.",
      "year" : 2004
    }, {
      "title" : "bandit problems with side observations",
      "author" : [ "Alessandro Lazaric", "Emma Brunskill" ],
      "venue" : "In Proc. NIPS,",
      "citeRegEx" : "Lazaric and Brunskill,? \\Q2014\\E",
      "shortCiteRegEx" : "Lazaric and Brunskill",
      "year" : 2014
    }, {
      "title" : "Odalric-Ambrym Maillard and Shie Mannor",
      "author" : [ "2014. Jérémie Mary", "Romaric Gaudel", "Preux Philippe" ],
      "venue" : "Proc. NIPS, pages 2220–2228,",
      "citeRegEx" : "Mary et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Mary et al\\.",
      "year" : 2013
    }, {
      "title" : "The final term above can be bounded using Anandkumar et al. (2012, Lemma E.4) – a version of Theorem",
      "author" : [ "Stewart" ],
      "venue" : null,
      "citeRegEx" : "Stewart,? \\Q1990\\E",
      "shortCiteRegEx" : "Stewart",
      "year" : 1990
    }, {
      "title" : "Unregularized Least squares In our setting where we consider finitely many arms, one way wonder whether it is possible to remove the regularization parameter λ",
      "author" : [ "F. Appendix" ],
      "venue" : "Following Rusmevichientong and Tsitsiklis",
      "citeRegEx" : "Appendix,? \\Q2010\\E",
      "shortCiteRegEx" : "Appendix",
      "year" : 2010
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "It combines the Robust Tensor Power Method of Anandkumar et al. (2014b) with the OFUL linear bandit algorithm of Abbasi-Yadkori et al.",
      "startOffset" : 46,
      "endOffset" : 72
    }, {
      "referenceID" : 0,
      "context" : "(2014b) with the OFUL linear bandit algorithm of Abbasi-Yadkori et al. (2011). We provide the first rigorous regret analysis of this combination, showing that its regret after T user interactions is Õ(C √ BT ), with B the number of users.",
      "startOffset" : 49,
      "endOffset" : 78
    }, {
      "referenceID" : 0,
      "context" : "We develop a novel bandit algorithm (Algorithm 3) that combines (a) the Optimization in the Face of Uncertainty Linear bandit OFUL algorithm (Abbasi-Yadkori et al., 2011) for bandits with known action features, and (b) a variant of the Robust Tensor Power (RTP) algorithm (Anandkumar et al.",
      "startOffset" : 141,
      "endOffset" : 170
    }, {
      "referenceID" : 0,
      "context" : ", 2009; Anandkumar et al., 2014a,b); the task of simultaneously optimizing net utility in a bandit fashion in complex expression models like these has received little or no analytical treatment. Our work takes a step towards filling this void. An especially challenging aspect of online learning in recommender systems is the relatively meager number of available interactions with a same user, which is offset to an extent by the assumption that users can only have a limited number of taste profiles (classes). Indeed, if one can identify the class to which a certain user belongs and aggregate information from all other users in that class, then one can recommend to the user the best item for the class. In practice, classes are latent and not necessarily known in advance, and several works (Gentile et al., 2014; Lazaric et al., 2013; Maillard and Mannor, 2014) study the restricted situation when each user always belongs to one specific class (i.e., when all mixture distributions have support size 1). We go two steps further, since in many situations (a) users cannot be assumed to belong to one class only, such as when a user account is shared by several individuals (e.g. a smart-TV), and (b) the duration of a user-session, that is the number of consecutive recommendations to the same individual connected to a user-account, cannot assumed to be long1. The key challenges that this work addresses are (1) the lack of knowledge of “features” on both the user-side and item-side in a linear bandit problem (in this case, both the user mixture weights and the item class reward profiles) and (2) provable regret minimization with very few i.e. O(1) interactions with every user b having a specific taste profile, as opposed to a large number of interactions such as in transfer learning (Lazaric et al., 2013). Contributions and overview of results. We consider a setting when users are assumed to come from arbitrary mixtures across classes (they are not assumed to fall perfectly in one class as was the assumption in works by Gentile et al. (2014); Maillard and Mannor (2014)).",
      "startOffset" : 8,
      "endOffset" : 2064
    }, {
      "referenceID" : 0,
      "context" : ", 2009; Anandkumar et al., 2014a,b); the task of simultaneously optimizing net utility in a bandit fashion in complex expression models like these has received little or no analytical treatment. Our work takes a step towards filling this void. An especially challenging aspect of online learning in recommender systems is the relatively meager number of available interactions with a same user, which is offset to an extent by the assumption that users can only have a limited number of taste profiles (classes). Indeed, if one can identify the class to which a certain user belongs and aggregate information from all other users in that class, then one can recommend to the user the best item for the class. In practice, classes are latent and not necessarily known in advance, and several works (Gentile et al., 2014; Lazaric et al., 2013; Maillard and Mannor, 2014) study the restricted situation when each user always belongs to one specific class (i.e., when all mixture distributions have support size 1). We go two steps further, since in many situations (a) users cannot be assumed to belong to one class only, such as when a user account is shared by several individuals (e.g. a smart-TV), and (b) the duration of a user-session, that is the number of consecutive recommendations to the same individual connected to a user-account, cannot assumed to be long1. The key challenges that this work addresses are (1) the lack of knowledge of “features” on both the user-side and item-side in a linear bandit problem (in this case, both the user mixture weights and the item class reward profiles) and (2) provable regret minimization with very few i.e. O(1) interactions with every user b having a specific taste profile, as opposed to a large number of interactions such as in transfer learning (Lazaric et al., 2013). Contributions and overview of results. We consider a setting when users are assumed to come from arbitrary mixtures across classes (they are not assumed to fall perfectly in one class as was the assumption in works by Gentile et al. (2014); Maillard and Mannor (2014)).",
      "startOffset" : 8,
      "endOffset" : 2092
    }, {
      "referenceID" : 4,
      "context" : "UCB (Auer et al., 2002)) per user, scales as O(B √ TA/B) = O( √ ABT ) after T rounds2 , which is considerably suboptimal in the practical case with a very large number of items but very few representative user classes (C ≪ A).",
      "startOffset" : 4,
      "endOffset" : 23
    }, {
      "referenceID" : 10,
      "context" : "An alternative is the implicit exploration method due to Kocák et al. (2014).",
      "startOffset" : 57,
      "endOffset" : 77
    }, {
      "referenceID" : 1,
      "context" : "Our next result makes use of the following proposition from Anandkumar et al. (2014b, Theorem 5.1), restated here for completeness. Proposition 1 (Theorem 5.1 of Anandkumar et al. (2014b)) Let T̂ = T + E ∈ RC×C×C , where T is a symmetric tensor with orthogonal decomposition T = ∑C c=1 λcφ ⊗3 c , where each λc > 0, {φc}c∈[C] is an orthonormal basis, and E is a symmetric tensor with operator norm ||E|| 6 ε.",
      "startOffset" : 60,
      "endOffset" : 188
    }, {
      "referenceID" : 1,
      "context" : "See Anandkumar et al. (2014b) for more details on notation and results.",
      "startOffset" : 4,
      "endOffset" : 30
    }, {
      "referenceID" : 0,
      "context" : "Algorithm 2 OFUL (Optimism in Face of Uncertainty for Linear bandits) (Abbasi-Yadkori et al., 2011) Require: Arms’ features Ū , regularization parameter λ, norm parameter RΘ for all times t > 1 do 1.",
      "startOffset" : 70,
      "endOffset" : 99
    }, {
      "referenceID" : 0,
      "context" : "Theorem 2 (OFUL regret (Abbasi-Yadkori et al., 2011)) Assume that ||v||2 6 RΘ, and that for all a ∈ A, ||ūa||2 6 RX , |〈ūa,v〉| 6 1.",
      "startOffset" : 23,
      "endOffset" : 52
    }, {
      "referenceID" : 0,
      "context" : "In the linear bandit literature (Abbasi-Yadkori et al., 2011; Rusmevichientong and Tsitsiklis, 2010; Dani et al., 2008), the key constraining assumption is that either user side (V ) or item side (U ) features are precisely and completely known a priori.",
      "startOffset" : 32,
      "endOffset" : 119
    }, {
      "referenceID" : 6,
      "context" : "In the linear bandit literature (Abbasi-Yadkori et al., 2011; Rusmevichientong and Tsitsiklis, 2010; Dani et al., 2008), the key constraining assumption is that either user side (V ) or item side (U ) features are precisely and completely known a priori.",
      "startOffset" : 32,
      "endOffset" : 119
    }, {
      "referenceID" : 9,
      "context" : ", no exploration mini-sessions, and (c) An implementation of the Alternating Least Squares estimator (Takács and Tikk, 2012; Mary et al., 2014) for the matrix U along with OFUL per-user. The proposed algorithm, with the theoretically suggested exploration Õ(n−1/2), is observed to exploit the latent structure considerably better than simple UCB, and is not too far from the unrealistic OFUL strategy which enjoys the luxury of latent class information. It is also competitive with performing Alternating Least Squares, which does not come with analytically sound performance guarantees in the bandit learning setting. Also, the large additive constants in the theoretical bounds for Algorithm 3 do not manifest here. Related work. The popular low-rank matrix completion problem studies the recovery U and V given a small number of entries sampled at random from UV T with both U and V being tall matrices, see for instance Jain et al. (2013) and citations therein.",
      "startOffset" : 125,
      "endOffset" : 943
    }, {
      "referenceID" : 0,
      "context" : "In the linear bandit literature (Abbasi-Yadkori et al., 2011; Rusmevichientong and Tsitsiklis, 2010; Dani et al., 2008), the key constraining assumption is that either user side (V ) or item side (U ) features are precisely and completely known a priori. In contrast, the problem of low regret recommendation across users with latent mixtures does not afford us the luxury of knowing either U or V , and so they must be learnt “on the fly”. Another related work in the context of bandit type schemes for latent mixture model recommender systems is that of Bresler et al. (2014), in which, under the very specific uniform mixture model for all users, they exhibit strategies with good regret.",
      "startOffset" : 33,
      "endOffset" : 578
    }, {
      "referenceID" : 0,
      "context" : "In the linear bandit literature (Abbasi-Yadkori et al., 2011; Rusmevichientong and Tsitsiklis, 2010; Dani et al., 2008), the key constraining assumption is that either user side (V ) or item side (U ) features are precisely and completely known a priori. In contrast, the problem of low regret recommendation across users with latent mixtures does not afford us the luxury of knowing either U or V , and so they must be learnt “on the fly”. Another related work in the context of bandit type schemes for latent mixture model recommender systems is that of Bresler et al. (2014), in which, under the very specific uniform mixture model for all users, they exhibit strategies with good regret. Nguyen et al. (2014) consider an alternating minimization type scheme in linear bandit models with two-sided uncertainty (an alternative model involving latent “factors”).",
      "startOffset" : 33,
      "endOffset" : 713
    }, {
      "referenceID" : 4,
      "context" : ", 2014b, 2012) essentially with a standard UCB (Auer et al., 2002), but however works in the setting of a large number interactions with a same user, without assuming access to “user ids”.",
      "startOffset" : 47,
      "endOffset" : 66
    }, {
      "referenceID" : 1,
      "context" : "(2013): The method combines the RTP method (Anandkumar et al., 2014b, 2012) essentially with a standard UCB (Auer et al., 2002), but however works in the setting of a large number interactions with a same user, without assuming access to “user ids”. As a result, the regret bound in this setting scales linearly with the number of rounds. Our result in this paper shows that with additional access to just user identifiers, we can reduce the regret rate to be sublinear in time. The RTP method has been used as a processing step to the EM algorithm in crowdsourcing (Zhang et al., 2014), but only convergence properties are considered, which is not enough to provide regret guarantees. On the theoretical side, our contribution generalizes the setting of clustered bandits (Maillard and Mannor, 2014; Gentile et al., 2014) in which a hard clustering model is assumed (one user is assigned to one class, or equivalently mixture distributions can only have support size 1). In particular, Maillard and Mannor (2014) specifically highlight the benefit of a collaborative gain across users against using a vanilla UCB for each user.",
      "startOffset" : 44,
      "endOffset" : 1014
    }, {
      "referenceID" : 1,
      "context" : "(2013): The method combines the RTP method (Anandkumar et al., 2014b, 2012) essentially with a standard UCB (Auer et al., 2002), but however works in the setting of a large number interactions with a same user, without assuming access to “user ids”. As a result, the regret bound in this setting scales linearly with the number of rounds. Our result in this paper shows that with additional access to just user identifiers, we can reduce the regret rate to be sublinear in time. The RTP method has been used as a processing step to the EM algorithm in crowdsourcing (Zhang et al., 2014), but only convergence properties are considered, which is not enough to provide regret guarantees. On the theoretical side, our contribution generalizes the setting of clustered bandits (Maillard and Mannor, 2014; Gentile et al., 2014) in which a hard clustering model is assumed (one user is assigned to one class, or equivalently mixture distributions can only have support size 1). In particular, Maillard and Mannor (2014) specifically highlight the benefit of a collaborative gain across users against using a vanilla UCB for each user. However their setting is less general than assuming a soft clustering of users (one user corresponds to a mixture of classes) across various “representative” taste profiles as we study here. The Alternating Least-Squares (ALS) method (Takács and Tikk, 2012; Mary et al., 2014) has been shown to yield promising experimental results in similar settings where both U and V are unknown. However, no theoretical guarantees are known for this algorithm that may converge to a local optimum in general. The work of Valko et al. (2014) studies stochastic bandits with a linear model over a low-rank (graph Laplacian) structure.",
      "startOffset" : 44,
      "endOffset" : 1658
    }, {
      "referenceID" : 4,
      "context" : "Proof The proof closely follows that of Gheshlaghi Azar et al. (2013). First, note that by property of the rank 1 decomposition ((Anandkumar et al.",
      "startOffset" : 51,
      "endOffset" : 70
    }, {
      "referenceID" : 7,
      "context" : "We use the result of Lemma 5 from Gheshlaghi Azar et al. (2013) to control (e) and (f).",
      "startOffset" : 45,
      "endOffset" : 64
    }, {
      "referenceID" : 1,
      "context" : "3) are controlled by the perturbation method from Anandkumar et al. (2014b), under the condition that en = ‖T − T̂‖ 6 C1 λmin C (where C1 is a universal constant).",
      "startOffset" : 50,
      "endOffset" : 76
    }, {
      "referenceID" : 7,
      "context" : "In order to make the condition explicit in our setting, we use the fact that by Lemma 6 from Gheshlaghi Azar et al. (2013), if e n 6 12 min{Γ, σmin} then",
      "startOffset" : 104,
      "endOffset" : 123
    }, {
      "referenceID" : 0,
      "context" : "The argument from here can be continued in the same way as in Abbasi-Yadkori et al. (2011) to yield",
      "startOffset" : 62,
      "endOffset" : 91
    }, {
      "referenceID" : 1,
      "context" : "The final term above can be bounded using Anandkumar et al. (2012, Lemma E.4) – a version of Theorem 2.5 in Stewart et al. (1990). Assuming (u⋄)J is invertible, and ∥(u⋄)−1 J ((un)J − (u⋄)J ) ∥∥ 2 < 1, then (un)J is invertible, and a resulting bound on the norm of its inverse lets us write ∥(u⋄)−1 J ∥∥ 2 + ∥(u⋄n)−1 J − (u⋄)−1 J ∥∥ 2 6 ∥(u⋄)−1 J ∥∥ 2 + ‖(un)J − (u)J‖2 ∥(u⋄)−1 J ∥∥2 2 1− ∥(u⋄)−1 J ((un)J − (u⋄)J ) ∥∥ 2 .",
      "startOffset" : 42,
      "endOffset" : 130
    } ],
    "year" : 2016,
    "abstractText" : "We study the task of maximizing rewards from recommending items (actions) to users sequentially interacting with a recommender system. Users are modeled as latent mixtures of C many representative user classes, where each class specifies a mean reward profile across actions. Both the user features (mixture distribution over classes) and the item features (mean reward vector per class) are unknown a priori. The user identity is the only contextual information available to the learner while interacting. This induces a low-rank structure on the matrix of expected rewards ra,b from recommending item a to user b. The problem reduces to the well-known linear bandit when either useror item-side features are perfectly known. In the setting where each user, with its stochastically sampled taste profile, interacts only for a small number of sessions, we develop a bandit algorithm for the two-sided uncertainty. It combines the Robust Tensor Power Method of Anandkumar et al. (2014b) with the OFUL linear bandit algorithm of Abbasi-Yadkori et al. (2011). We provide the first rigorous regret analysis of this combination, showing that its regret after T user interactions is Õ(C √ BT ), with B the number of users. An ingredient towards this result is a novel robustness property of OFUL, of independent interest.",
    "creator" : "LaTeX with hyperref package"
  }
}