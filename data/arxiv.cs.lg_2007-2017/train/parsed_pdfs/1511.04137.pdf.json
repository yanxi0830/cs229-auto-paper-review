{
  "name" : "1511.04137.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Seeing the Unseen Network: Inferring Hidden Social Ties from Respondent-Driven Sampling",
    "authors" : [ "Lin Chen", "Amin Karbasi" ],
    "emails" : [ "amin.karbasi}@yale.edu" ],
    "sections" : [ {
      "heading" : "Introduction",
      "text" : "Random sampling is an effective way for researchers to learn about a population of interest. Characteristics of the sample can be generalized to the population of interest using standard statistical theory. However, traditional random sampling may be impossible when the target population is hidden, e.g. drug users, men who have sex with men, sex workers and homeless people. Due to concerns like privacy, stigmatization, discrimination, and criminalization, members of hidden populations may be reluctant to participate in a survey. In addition to the hidden populations for which no sampling “frame” exists, there are rare populations of great research interest, marked by their tiny fractions in the entire population. It is unlikely that random sampling from the general population would accrue a reasonable sample from a very rare population. However, it is often the case that members of hidden or rare populations know each other socially. This suggests that social referral would be an effective method for accruing a large sample. To this end, researchers have developed a variety of social link-tracing survey designs. The most popular is respondent-driven sampling (RDS) (Heckathorn 1997).\nIn RDS, a small set of initial subjects, known as “seeds” are selected, not necessarily simultaneously, from the target population. Subjects are given a few coupons, each tagged with a unique identifier, which they can use to recruit other eligible subjects. Participants are given a reward for being interviewed and for each eligible subject they recruit using their coupons. Each subject reports their degree, the number of others whom they know in the target population. No subject is permitted to enter the study twice and the date and time of each interview is recorded.\nWhile RDS can be an effective recruitment method, it reveals only incomplete social network data to researchers. Any ties between recruited subjects along which no recruitment took place remain unobserved. The social network of recruited subjects is of great interest to sociologists, epidemiologists and public health researchers since it may induce dependencies in the outcomes of sampled individuals. Fortunately, RDS reveals information about the underlying social network that can be used to (approximately) reconstruct it. By leveraging the time series of recruitments, the degrees of recruited subjects, coupon information, and who recruited whom, it is possible to interpret the induced subgraph of RDS respondents as a simple random graph model (Crawford 2016).\nIn this paper, we introduce a flexible and expressive stochastic model of RDS recruitment on a partially observed network structure. We derive the likelihood of the observed time series; the model admits any edgewise inter-recruitment time distribution. We propose a stochastic optimization algorithm RENDER (REspoNdent-Driven nEtwork Reconstruction) to estimate unknown parameters and the underlying social network. We conduct extensive experiments, on synthetic and real data, to confirm the accuracy and the reconstruction performance of RENDER. In particular, we apply RENDER to reconstruct the network of injection drug users from an RDS study in St. Petersburg, Russia."
    }, {
      "heading" : "Related Work",
      "text" : "RDS has been modeled as a random walk with replacement on a graph at its equilibrium distribution (Heckathorn 1997; Salganik and Heckathorn 2004; Volz and Heckathorn 2008; Goel and Salganik 2009; Gile and Handcock 2010), and under this argument the sampling probability is proportional to degree, which is the basis for an estimator of the popula-\nar X\niv :1\n51 1.\n04 13\n7v 2\n[ cs\n.S I]\n2 D\nec 2\n01 5\ntion mean (Heckathorn 2002; Salganik 2006). In this paper, we adopt an approach that focuses on the network structure estimable from the RDS sample using recruitment information (Crawford 2016). Crawford (2016) assumes that edgewise inter-recruitment times follow the exponential distribution, but this approach is relatively inflexible. In many other contexts, dynamic or random processes can reveal structural information of an underlying, partially observed, network (Kramer et al. 2009; Shandilya and Timme 2011; Linderman and Adams 2014). Network reconstruction and the edge prediction problem have been studied for diffusion processes where multiple realizations of the process on the same network are available (Liben-Nowell and Kleinberg 2007; Gomez Rodriguez, Leskovec, and Krause 2010; Gomez Rodriguez et al. 2011). In the case of RDS, reconstruction is particularly challenging because only a single realization of the diffusion process is observed. Furthermore, we must account for the role of coupons in recruitment as they intricately introduce bias. However, in contrast to general diffusion processes over graphs, some important network topological information is revealed by RDS. In this study, we leverage all the available data routinely collected during real-world RDS studies."
    }, {
      "heading" : "Problem Formulation",
      "text" : "We conform to the following notation throughout the paper. Suppose that f is a real-valued function and that v is a vector. Then f(v) is a vector of the same size as vector v and the i-th entry of f(v) is denoted by f(v)i, whose value is given by f(vi). The transposes of matrix A and vector v are written as A′ and v′, respectively. And let 1 be the allones column vector."
    }, {
      "heading" : "Dynamics of Respondent-Driven Sampling",
      "text" : "We characterize the social network of the hidden population as a finite undirected simple graph G = (V,E) with no parallel edges or self-loops. Members of the hidden population are vertices; {i, j} ∈ E implies that i ∈ V and j ∈ V know each other. Using RDS, researchers recruit members from the hidden population into the study. The time-varying recruitment-induced subgraph {GS(t) = (VS(t), ES(t)) : 0 ≤ t ≤ tF } is a nested collection of subgraphs of G, where tF is the termination time of the study. For all 0 ≤ t ≤ tF , GS(t) is a subgraph of G. Here, GS(0) is the null graph since there are no subjects in the study initially. For simplicity, we write GS = (VS , ES) for GS(tF ) = (VS(tF ), ES(tF )), and call this the recruitmentinduced subgraph or induced subgraph unless we explicitly specify the time t. The vertex set of the time-varying recruitment-induced subgraph at time t (i.e., GS(t)) denotes the members in the hidden population that are known to the study by time t. The subgraphGS(t) is induced by the vertex set VS(t); i.e., ES(t) = {{i, j}|i, j ∈ VS(t), {i, j} ∈ E}. The time-varying recruitment-induced subgraph evolves in the following way (Crawford 2016).\n1. At time t̃, researchers recruit a subject in the population as a seed. This subject is included in the vertex set VS(t) of\nGS(t) for all t ≥ t̃. Researchers may provide this subject with coupons to recruit its neighbors.\n2. Once recruited into this study (either by researchers or its neighbors) at time t̃, subjects currently holding coupons will attempt to recruit their yet-unrecruited neighbors. The inter-recruitment time along each edge connecting a recruiter with an unrecruited neighbor is i.i.d. with cdf F (t). Recruitment happens when a neighbor is recruited into the study and is provided with a number of coupons. A successful recruitment costs the recruiter one coupon.\nThe directed recruitment graph is GR = (VR, ER), where VR = VS(tF ) is the set of members in the study at the final stage. For two subjects i, j ∈ VR, (i, j) ∈ ER if and only if i recruits j. Note that the subjects recruited by researchers (i.e., the seeds) have zero in-degree in GR. Let n denote the cardinality of VR (equivalently VS(tF )). For simplicity, we label the subject recruited in the ith recruitment event by i. The labels of the subjects in the study are 1, 2, 3, . . . , n. The vector of recruitment times is t = (t1, t2, t3, . . . , tn), where ti is the recruitment time of subject i. In shorthand, we write τ(i; j) = tj−1 − ti for i < j. Let C be the n × n coupon matrix whose element Cij = 1 if subject i has at least one coupon just before the jth recruitment event, and zero otherwise. The rows and columns of the coupon matrix are ordered by subjects’ recruitment time. The degree vector is d = (d1, d2, d3, . . . , dn)′, where di is the degree of i in G. At time t (where t 6= ti for i = 1, 2, 3, . . . , n), if a subject has at least one coupon and at least one neighbor not in the study, we term it a recruiter at time t; if a subject has not entered the study and has at least one neighbor with at least one coupon, we term it a potential recruitee at time t. We assume that the observed data from a RDS recruitment process consist of Y = (GR,d, t,C)."
    }, {
      "heading" : "Likelihood of Recruitment Time Series",
      "text" : "We assume that the inter-recruitment time along an edge connecting a recruiter and potential recruitee is i.i.d. with cdf F (t). Let Fs(t) = Pr [W ≤ t |W > s], where W is the random inter-recruitment time and Pr [W ≤ t] = F (t). We write fs(t) = F ′s(t) for the corresponding conditional pdf. Let Ss(t) = 1 − Fs(t) be the conditional survival function and Hs(t) = fs(t)/Ss(t) be the conditional hazard function.\nWe now derive a closed-form expression for the likelihood of the recruitment time series L(t|GS , θ). In what follows, let M be the set of seeds, and let A denote the adjacency matrix representation of the recruitment-induced subgraph at the final stage GS ; thus we use GS and A interchangeably throughout this paper.\nTheorem 1. (Proof in Appendix). Let R(i) and I(i) be the recruiter set and potential recruitee set just before time ti, respectively, and M be the set of seeds. The following statements with respect to the likelihood of the recruitment time series hold.\n1. The likelihood of the recruitment time series is given by\nL(t|GS , θ)\n= n∏ i=1  ∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu) 1{i/∈M}\n× ∏\nj∈R(i)\nS |Ij | τ(j;i)(ti − tj),\nwhere τ(u; i) = ti−1 − tu. 2. Let m and u be column vectors of size n defined as mi =\n1{i /∈ M} and u = d − A · 1, and let H and S be n × n matrices, defined as Hui = Hτ(u;i)(ti − tu) and Sji = logSτ(j;i)(ti−tj). Furthermore, we form matrices B = (C ◦ H) and D = (C ◦ S), where ◦ denotes the Hadamard (entrywise) product. We let\nβ = log(B′u + LowerTri(AB)′ · 1) δ = D′u + LowerTri(AD)′ · 1,\nwhere LowerTri(·) denotes the lower triangular part (diagonal elements inclusive) of a square matrix. Then, the log-likelihood of the recruitment time series can be written as\nl(t|GS , θ) = m′β + 1′δ."
    }, {
      "heading" : "Network Reconstruction Problem",
      "text" : "Given the observed time series, we seek to reconstruct the n× n binary symmetric, zero-diagonal adjacency matrix A of GS and the parameter θ ∈ Θ (Θ is the parameter space) that maximizes Pr(A, θ|t). Recall that we use GS and A interchangeably throughout this paper. We have\nPr(A, θ|t) ∝ L(t|A, θ) Pr(A, θ),\nwhere Pr(A, θ) is the prior distribution for (A, θ). The constraint for the parameter θ is obvious: θmust reside in the parameter space Θ; i.e., θ ∈ Θ. Now we discuss the constraint for the adjacency matrix A—we require that the adjacency matrix A must be compatible.\nWe seek the matrix A that maximizes the probability Pr(A, θ|t). However, we know that the directed recruitment subgraph, if viewed as an undirected graph, must be a subgraph of the true recruitment-induced subgraph. Let AR be the adjacency matrix of the recruitment subgraph when it is viewed as an undirected graph; i.e., the (i, j) entry of AR is 1 if a direct recruitment event occurs between i and j (either i recruits j or j recruits i), and is 0 otherwise. We require that A be greater than or equal to AR entrywise. Recall that every subject in the study reports its degree; thus the adjacency matrix should also comply with the degree constraints. Following (Crawford 2016), we say that a symmetric, binary and zero-diagonal matrix A is a compatible adjacency matrix if A ≥ AR entrywise, and A · 1 ≤ d entrywise."
    }, {
      "heading" : "Problem Statement",
      "text" : "Now we formulate this problem as an optimization problem.\nAlgorithm 1 RENDER: Alternating inference of GS and θ Input: the observed data Y = (GR,d, t,C); the initial guess for the distribution parameter θ, denoted by θ̂0; the maximum number of iterations, ιmax. Output: the estimated adjacency matrix A (denoted by Â) and the estimated parameter θ (denoted by θ̂) ι← 0 while ι < ιmax\nÂι ← arg maxA is compatible L(t|A, θ̂ι) Pr(A, θ̂ι) (Astep, we use Algorithm 2 here.)\nθ̂ι+1 ← arg maxθ∈Θ L(t|Âι, θ) Pr(Âι, θ) (θ-step) ι← ι+ 1\nend while Â← Âιmax−1 θ̂ ← θ̂ιmax\nProblem. Given the observed data Y = (GS ,d, t,C), we seek an n × n adjacency matrix A (symmetric, binary and zero-diagonal) and a parameter value θ ∈ Θ that\nmaximizes L(t|A, θ) Pr(A, θ) subject to A ≥ AR (entrywise)\nA · 1 ≤ d (entrywise)\nAlternating Inference of A and θ Given the observed data Y, we wish to infer the adjacency matrix A of the recruitment-induced graph and the distribution parameter θ. Given A, the maximum likelihood estimator (MLE) for θ is\nθ̂ = arg maxθ∈Θ L(t|A, θ) Pr(A, θ). Similarly, given the true parameter θ, the MLE for the adjacency matrix A is given by\nÂ = arg maxA is compatible L(t|A, θ) Pr(A, θ).\nIn practice, both the parameter θ and the true recruitmentinduced subgraph GS are unknown and need estimation. However, we can alternately estimate A and θ. This is what RENDER (presented in Algorithm 1) does. Each iteration is divided into two steps: A-step and θ-step.\nEstimation of A using simulated annealing The A-step of RENDER solves\nmax A is compatible\nL(t|A, θ̂ι) Pr(A, θ̂ι);\nequivalently, it suffices to solve\nmax A is compatible\n(l(t|A, θ̂ι) + log Pr(A, θ̂ι)).\nWe employ a simulated-annealing-based method to estimate the adjacency matrix A (presented in Algorithm 2). Let the energy function be\nΛγ(A; t, θ̂ι) , exp [ − ( l(t|A, θ̂ι) + log Pr(A, θ̂ι) ) /γ ] ,\nwhere γ is the temperature. We specify a cooling schedule, which is a sequence of positive numbers {γ}≥1 that satisfy\nlim→∞ γ = 0, where γ is the temperature in the -th iteration. Note that the -th iteration of the simulated annealing procedure has a compatible adjacency matrix A() as its state. Algorithm 3 specifies which state (compatible ad-\nAlgorithm 2 Simulated-annealing-based optimization Input: the number of iterations, max; the cooling schedule {γ}≥1; initial compatible adjacency matrix A(1); estimated parameter θ̂ι. Output: the estimated adjacency matrix Âι for  = 1 to max do\nUse Algorithm 3 to propose a compatible adjacency matrix Ã(+ 1) based on A(). ψ ← min { 1, Λγ (Ã(+1);t,θ̂ι)\nΛγ (A();t,θ̂ι) · Pr(A()|Ã(+1)) Pr(Ã(+1)|A())\n} .\nA(+ 1)← { Ã(+ 1) with probability ψ; A() with probability 1− ψ.\nend for Âι ← A(max + 1).\njacency matrix) the algorithm should transition into in the next iteration. Concretely, in each iteration of Algorithm 2, it randomly proposes an edge that connects vertices i and j. If the edge does not appear in A() and it still conforms to the degree constraint if we add the edge, then we simply add it to Ã( + 1). In contrast, if the edge appears in A() and it still conforms to the subgraph constraint if we remove the edge, then we simply remove it from Ã( + 1). If neither condition is satisfied, the algorithm tries again with a new proposal. We prove in the appendix that the space of compatible adjacency matrices is connected by the proposal method.\nThe proposed compatible adjacency matrix Ã( + 1) is accepted as the state for the next iteration with probability ψ, where ψ equals\nmin { 1, Λγ(Ã(+ 1); t, θ̂ι)\nΛγ(A(); t, θ̂ι) · Pr(A()|Ã(+ 1)) Pr(Ã(+ 1)|A())\n} ;\notherwise, the matrix A() remains the state for the next iter-\nation. The term Λγ (Ã(+1);t,θ̂ι)\nΛγ (A();t,θ̂ι) is called the likelihood ratio\nand the term Pr(A()|Ã(+1)) Pr(Ã(+1)|A()) is called the proposal ratio. To implement Algorithm 2, we have to compute the likelihood ratio and the proposal ratio efficiently. In fact, they can be evaluated efficiently in a recursive manner. Theorem 2. (Proof in Appendix). The proposal ratio Pr(A()|Ã(+1)) Pr(Ã(+1)|A()) is given by\nAdd(A()) + Remove(A())\nAdd(Ã(+ 1)) + Remove(Ã(+ 1)) , where Add(A) = ∑ 1≤i<j≤n 1{Aij = 0, ∑n k=1 Aik <\ndi, ∑n k=1 Ajk < dj}, and Remove(A) =∑\n1≤i<j≤n 1{Aij = 1 and A (ij) R = 0}. Here, we let\nA (ij) R denote the (i, j)-entry of the matrix AR.\nAlgorithm 3 Proposal of compatible adjacency matrix Input: the compatible adjacency matrix A() in the -th iteration. Output: a compatible adjacency matrix Ã(+1), which will be a candidate for the state in the (+ 1)-th iteration. loop\ni, j ← two distinct random integers in [1, n] ∩ N if Aij() = 0 and ∑n k=1 Aik() < di and∑n\nk=1 Ajk() < dj then Ã+(+ 1)← A() Ã+ij(+ 1)← 1 and Ã + ji(+ 1)← 1\nÃ(+ 1)← Ã+(+ 1) and exit loop else\nif Aij() = 1 and A (ij) R = 0 (A (ij) R is the (i, j)-\nentry of the matrix AR) then Ã−(+ 1)← A() Ã−ij(+ 1)← 0 and Ã − ji(+ 1)← 0\nÃ(+ 1)← Ã−(+ 1) and exit loop end if\nend if end loop return Ã(+ 1)\nThe same way, we can find the likelihood ratio in a recursive manner. Theorem 3. (Proof in Appendix). If we view β in Theorem 1 as a function of the adjacency matrix A, denoted by β(A), then the recurrence relation between β(Ã(+1)) and β(A()) is as follows:\n(eβ(Ã(+1)) − eβ(A()))j = ± (Bbj1{a < j} −Baj1{b < j}) . (1)\nHere, we assign the minus sign “−” in “±” if Ã( + 1) = Ã+( + 1), and assign the plus sign “+” in “±” if Ã( + 1) = Ã−( + 1). By the same convention, the likelihood ratio Λγ(Ã(+ 1)|t, θ̂ι)/Λγ(A()|t, θ̂ι) is given by\nexp { −γ−1 [ − log Pr(Ã(+ 1))\nPr(A()) + m′\n( β(Ã(+ 1))\n−β(A()))± n∑ j=1 (Dbj1{a < j} −Daj1{b < j})  , Estimation of distribution parameter In a θ-step in Algorithm 1, we have to solve the optimization problem θ̂ι+1 ← arg maxθ∈Θ L(θ|Âι, t) Pr(Âι, θ). If the parameter space Θ is a subset of the p-dimensional Euclidean space Rp, this problem can be solved using off-the-shelf solvers, e.g., FMINSEARCH in MATLAB."
    }, {
      "heading" : "Experiments",
      "text" : "We evaluated the proposed method in two aspects, the reconstruction performance of the recruitment-induced sub-\ngraph and the parameter estimation of the edgewise interrecruitment time model. Let A be the adjacency matrix of the true recruitment-induced subgraph GS and Â be the estimate. We define the true and false positive rates (TPR and FPR) as TPR(Â,A) = ∑ i<j 1{Âij = 1 and Aij =\n1}/ ( n 2 ) and FPR(Â,A) = ∑ i<j 1{Âij = 1 and Aij =\n0}/ ( n 2 ) . Fig. 1 illustrates an example of the reconstruction procedure. We simulated a RDS process over the Project 90 graph (Woodhouse et al. 1994) with power-law edgewise inter-recruitment time distribution, whose shape parameter α = 2 and scale parameter xmin = 0.5. Fifty subjects are recruited in this process. We show clockwise from top left: the true recruitment-induced subgraphGS , the observed recruitment graph GR, the estimated network with recruitments as blue arrows and dashed lines as inferred edges, and the estimated recruitment-induced subgraph ĜS . The TPR equals 0.769 and the FPR equals 0.106. The estimated parameter α̂ = 1.95 and x̂min = 0.49."
    }, {
      "heading" : "Reconstruction Performance",
      "text" : "Impact of distribution parameter We simulated 50 RDS over the Project 90 graph with inter-recruitment time distribution Gamma(α, α) (parametrized by the shape and scale) for each α = 0.01, 0.1, 1, 10, and 100. Thus a total number of 250 RDS processes are simulated and the mean interrecruitment time is fixed to be 1. The reconstruction performance is illustrated in Fig. 2. Each point on the receiver operating characteristic (ROC) plane represents a reconstruction accuracy performance of a simulated RDS process.\n−0.1\n0.0\n0.1\n0.5 0.75 1 1.25 1.5 α\nPR (E\nxp ) −\nP R\n(G am\nm a)\nPR FPR TPR\nPR Comparison between true and exponential model\nFigure 3: Difference between true and false positive rates (green and red boxplots, respectively) under the exponential model and the true Gamma model (the vertical axis) with the true shape parameter α (the horizontal axis).\nPoints with the same marker have the same inter-recruitment time distribution parameter. From the figure, we can observe that there is no significant sign of separation of points with different inter-recruitment time distribution parameters. Reconstruction accuracy is robust to the distribution parameter.\nImpact of distribution model We simulated 50 RDS process over the Project 90 graph with inter-recruitment time distribution Gamma(0.5, 0.5). The recruitment-induced subgraph is reconstructed via the model of the true inter-\nrecruitment distribution Gamma(0.5, 0.5) and the exponential distribution Exp(1), respectively. The TPR and FPR of each dataset are presented in Fig. 3. The TPR is always higher than the FPR, which reaffirms the effectiveness of our proposed reconstruction method. For each dataset, the TPR and FPR under the true and the exponential models are very close to each other. We observe that there is no significant reconstruction skewness incurred by mis-specification of the inter-recruitment time distribution model."
    }, {
      "heading" : "Parameter Estimation",
      "text" : "We simulated 200 RDS processes over the Project 90 graph with edgewise inter-recruitment time distribution Gamma(α, α) (parametrized by the shape and scale parameters) for each α = 0.5, 0.75, 1, 1.25, and 1.5. We used the method in the “Estimation of distribution parameter” section. We assess the bias of the estimated shape parameter α̂, which is given by α̂−α. Fig. 4 shows the distribution of the bias using Tukey boxplots. In Fig. 4, the red boxes depict the distribution of the biases of the estimated shape parameters inferred through the estimated adjacency matrix, while the green boxes illustrate the distribution of those inferred given the true adjacency matrix. The horizontal axis shows the value of the true shape parameter.\nWith respect to the red boxes (those based on the estimated adjacency matrices), The middle line of each box is very close to zero and thus the estimation is highly accurate. The interquartile range (IQR) , which measures the deviation of the biases, declines as the shape parameter decreases. Even for the box with largest deviation (i.e., the box with α = 1.5), the IQR is approximately [−0.125, 0.02]\nand 99.3% of the biases reside in the interval [−0.27, 0.25]. Compared with the parameter estimation via the true adjacency matrix, this estimator based on the estimated adjacency matrix is biased to some degree. In Fig. 4, we can observe that it underestimates α.\nThen consider the green boxes (those based on the true adjacency matrix). Similar to those based on the estimated adjacency matrix, the deviation of this estimator declines as the value of the shape parameter α decreases. The middle line of each box is noted to coincide perfectly with zero bias line, which suggests that this estimator is unbiased given the true adjacency matrix."
    }, {
      "heading" : "Experiments on Real Data",
      "text" : "We also apply RENDER to data from an RDS study of n = 813 drug users in St. Petersburg, Russian Federation. We use RENDER to infer the underlying social network structure of the drug users in this study. Since it could be confusing to visualize the whole inferred network, we only show the inferred subgraph of the largest community of the network, as presented in Fig. 5. The blue arrows represent the edges in the recruitment subgraph that indicates the recruiter and recruitee. Gray dashed edges are inferred from the data."
    }, {
      "heading" : "Conclusion",
      "text" : "In this paper, we precisely formulated the dynamics of RDS as a continuous-time diffusion process over the underlying graph. We derived the likelihood for the recruitment time series under an arbitrarily recruitment time distribution. As a result, we develop an efficient stochastic optimization algorithm, RENDER, that identifies the optimum network that best explains the collected data. We then supported the performance of RENDER through an exhaustive set of experiments on both synthetic and real data."
    }, {
      "heading" : "Acknowledgements",
      "text" : "FWC was supported by NIH/NCATS grant KL2 TR000140 and NIMH grant P30MH062294. LC would like to thank Zeya Zhang and Yukun Sun for their encouragement."
    }, {
      "heading" : "Appendix",
      "text" : ""
    }, {
      "heading" : "Proof of Theorem 1",
      "text" : "Proof. (1) We consider the recruitment of subject i. Let Ru(i) be the set of recruiters of subject u just before time ti and Iu(i) be the set of recruitees of recruiter u just before time ti. Suppose that i /∈M . The inter-recruitment time between i and its potential recruiter u is denotedWui = ti−tu and is greater than ti−1− tu conditional on previous recruitment of i. Let U be the random variable of next recruiter and X be the random variable of next recruitee. Let J denote the event ∀j ∈ R(i), k ∈ I(i),Wjk > ti−1 − tj . We have\nPr [U = u,X = x,Wux ≥ t− tu | J ] = Pr [Wux ≥ t− tu, tj +Wjk > tu +Wux, ∀j ∈ R(i), k ∈ I(i), {u, x} 6= {j, k} | J ] ,\nand\nPr [WUi ≥ t− tU | J ] = ∑ x∈I(i) ∑ u∈Rx(i) Pr [Wux ≥ t− tu, tj +Wjk > tu\n+Wux,∀j ∈ R(i), k ∈ I(i), {u, x} 6= {j, k} | J ] = ∑ x∈I(i) ∑ u∈Rx(i) ˆ ∞ t−tu fτ(u;i)(s)dsPr [Wjk > s+ tu\n−tj ,∀j ∈ R(i), k ∈ I(i), {u, x} 6= {j, k} | J ] = ∑ x∈I(i) ∑ u∈Rx(i) ˆ ∞ t−tu\nfτ(u;i)(s) ·∏ j∈R(i) ∏ k∈Ij(i) ( 1− Fτ(j;i)(s+ tu − tj)\n) 1− Fτ(u;i)(s) ds\n= ∑ x∈I(i) ∑ u∈Rx(i) ˆ ∞ t−tu\nHτ(u;i)(s) ·∏ j∈R(i) S |Ij(i)| τ(j;i) (s+ tu − tj)ds\nThus the likelihood is∑ x∈I(i) ∑ u∈Rx(i) Hτ(u;i)(ti − tu) ∏ j∈R(i) S |Ij(i)| τ(j;i) (ti − tj)\n= ∏\nj∈R(i)\nS |Ij(i)| τ(j;i) (ti − tj) ∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu)\nNow suppose that i ∈M .\nPr [Wjk ≥ t− tj ,∀j ∈ R(i), k ∈ Ij(i) | J ] = ∏\nj∈R(i) ∏ k∈Ij(i) (1− Fτ(j;i)(t− tj))\n= ∏\nj∈R(i)\nS |Ij(i)| τ(j;i) (t− tj).\nThus the likelihood is∏ j∈R(i) S |Ij(i)| τ(j;i) (ti − tj).\nTherefore the entire likelihood is\nn∏ i=1  ∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu) 1{i/∈M} · ∏\nj∈R(i)\nS |Ij | τ(j;i)(ti − tj).\n(2) The log-likelihood is\nn∑ i=1 1{i /∈M} log  ∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu)  + ∑ j∈R(i) |Ij(i)| logSτ(j;i)(ti − tj)\n . And the number of recruitees of recruiter u just before time ti is given by\n|Ij(i)| = Cji ( n∑ k=i Ajk + uj ) .\nThe term ∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu) in the loglikelihood is given by\n∑ u∈R(i) |Iu(i)|Hτ(u;i)(ti − tu)\n= ∑ u Cui ( n∑ k=i Auk + uu ) Hui =(B′u + LowerTri(AB)′ · 1)i.\nThe term ∑ j∈R(i) |Ij(i)| logSτ(j;i)(ti − tj) in the loglikelihood is given by\n∑ j∈R(i) |Ij(i)| logSτ(j;i)(ti − tj)\n= ∑ j∈R(i) Cji ( n∑ k=i Ajk + uj ) Sji\n=(D′u + LowerTri(AD)′ · 1)i.\nThus the log-likelihood is n∑ i=1 [1{i /∈M} log (B′u + LowerTri(AB)′ · 1)i\n+ (D′u + LowerTri(AD)′ · 1)i] = m ′β + 1′δ.\nProof of connectedness of the space of compatible adjacency matrices Proof. Consider two compatible adjacency matrices A1 and A2. Their Hadamard product A1◦A2, which corresponds to\nthe maximum common subgraph of A1 and A2, is also compatible. We can remove the edges in A1 that do not appear in A1◦A2 one at a time, and thus arrive at state A1◦A2. Then we add the edges in A2 that do not appear in A1 ◦A2 once at a time, and thus finally arrive at state A2. All intermediate adjacency matrices in this procedure are compatible."
    }, {
      "heading" : "Proof of Theorem 2",
      "text" : "Proof. In fact, the total number of possible edges that can be added for A() is given by Add(A()) and the total number of possible edges that can be removed for A() is given by Remove(A()). Thus we have the proposal distribution\nPr(Ã(+ 1)|A()) = 1 Add(A()) + Remove(A()) .\nSimilarly, we have\nPr(A()|Ã(+ 1)) = 1\nAdd(Ã(+ 1)) + Remove(Ã(+ 1)) . (2)\nThus we obtain the proposal ratio:\nPr(A()|Ã(+ 1)) Pr(Ã(+ 1)|A())\n= 1/ ( Add(Ã(+ 1)) + Remove(Ã(+ 1)) )\n1/ (Add(A()) + Remove(A()))\n= Add(A()) + Remove(A())\nAdd(Ã(+ 1)) + Remove(Ã(+ 1)) ."
    }, {
      "heading" : "Proof of Theorem 3",
      "text" : "Proof. Let Jab denote the n × n matrix whose (a, b)-entry is one and all other entries are zeros. We have\nÃ(+ 1)−A() = ± ( Jab + Jba ) ,\nwhere we assign the minus sign “−” in “±” if the edge that connects subjects a and b is added to Ã(+1) and we assign the plus sign “+” in “±” if that edge is removed from A(). And eβ(A) can be re-written as\neβ(A)\n=B′u + LowerTri(AB)′ · 1 =B′(d−A · 1) + LowerTri(AB)′ · 1 =B′d−B′A · 1 + LowerTri(AB)′ · 1 =B′d−B′A′ · 1 + LowerTri(AB)′ · 1 (3) =B′d− (AB)′ · 1 + LowerTri(AB)′ · 1 =B′d− StrictlyUpperTri(AB)′ · 1,\nwhere in (3) we use the fact that A is symmetric and StrictlyUpperTri(·) denotes the strictly upper triangular part (diagonal entries exclusive) of a matrix. Thus\neβ(A)±J ab − eβ(A) = ±StrictlyUpperTri(JabB)′ · 1.\nThe (i, j)-entry of JabB is\n(JabB)ij\n= n∑ k=1 JabikBkj\n=JabibBbj .\nThus ( StrictlyUpperTri(JabB)′ · 1 ) j\n= ∑ i:i<j JabibBbj\n=Bbj1{a < j}.\nHence we have\n(eβ(Ã(+1)) − eβ(A()))j = ± (Bbj1{a < j} −Baj1{b < j}) . (4)\nSimilarly, if we view δ in Theorem 1 as a function of the adjacency matrix A, denoted by δ(A), we have\nδ(Ã(+ 1))− δ(β(A())) = ± (Dbj1{a < j} −Daj1{b < j}) . (5)\nIf we plug in Equations (4) and (5) in the likelihood ratio Λγ (Ã(+1);t,θ̂ι)\nΛγ (A();t,θ̂ι) , we obtain the expression in the theorem\nstatement."
    } ],
    "references" : [ {
      "title" : "F",
      "author" : [ "Chen, L.", "Crawford" ],
      "venue" : "W.; and Karbasi, A.",
      "citeRegEx" : "Chen. Crawford. and Karbasi 2015",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "F",
      "author" : [ "Crawford" ],
      "venue" : "W.",
      "citeRegEx" : "Crawford 2016",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "M",
      "author" : [ "K.J. Gile", "Handcock" ],
      "venue" : "S.",
      "citeRegEx" : "Gile and Handcock 2010",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "M",
      "author" : [ "S. Goel", "Salganik" ],
      "venue" : "J.",
      "citeRegEx" : "Goel and Salganik 2009",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "G",
      "author" : [ "M. Gomez Rodriguez", "D. Balduzzi", "B. Schölkopf", "Scheffer" ],
      "venue" : "T.; et al.",
      "citeRegEx" : "Gomez Rodriguez et al. 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Inferring networks of diffusion and influence",
      "author" : [ "Leskovec Gomez Rodriguez", "M. Krause 2010] Gomez Rodriguez", "J. Leskovec", "A. Krause" ],
      "venue" : "In Proceedings of the 16th ACM SIGKDD international conference on Knowledge discovery and data mining,",
      "citeRegEx" : "Rodriguez et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Rodriguez et al\\.",
      "year" : 2010
    }, {
      "title" : "D",
      "author" : [ "Heckathorn" ],
      "venue" : "D.",
      "citeRegEx" : "Heckathorn 1997",
      "shortCiteRegEx" : null,
      "year" : 1997
    }, {
      "title" : "D",
      "author" : [ "Heckathorn" ],
      "venue" : "D.",
      "citeRegEx" : "Heckathorn 2002",
      "shortCiteRegEx" : null,
      "year" : 2002
    }, {
      "title" : "E",
      "author" : [ "M.A. Kramer", "U.T. Eden", "S.S. Cash", "Kolaczyk" ],
      "venue" : "D.",
      "citeRegEx" : "Kramer et al. 2009",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "and Kleinberg",
      "author" : [ "D. Liben-Nowell" ],
      "venue" : "J.",
      "citeRegEx" : "Liben.Nowell and Kleinberg 2007",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "and Adams",
      "author" : [ "S. Linderman" ],
      "venue" : "R.",
      "citeRegEx" : "Linderman and Adams 2014",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "D",
      "author" : [ "M.J. Salganik", "Heckathorn" ],
      "venue" : "D.",
      "citeRegEx" : "Salganik and Heckathorn 2004",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "M",
      "author" : [ "Salganik" ],
      "venue" : "J.",
      "citeRegEx" : "Salganik 2006",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "and Timme",
      "author" : [ "S.G. Shandilya" ],
      "venue" : "M.",
      "citeRegEx" : "Shandilya and Timme 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "D",
      "author" : [ "E. Volz", "Heckathorn" ],
      "venue" : "D.",
      "citeRegEx" : "Volz and Heckathorn 2008",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "J",
      "author" : [ "D.E. Woodhouse", "R.B. Rothenberg", "J.J. Potterat", "W.W. Darrow", "S.Q. Muth", "A.S. Klovdahl", "H.P. Zimmerman", "H.L. Rogers", "T.S. Maldonado", "Muth" ],
      "venue" : "B.; et al.",
      "citeRegEx" : "Woodhouse et al. 1994",
      "shortCiteRegEx" : null,
      "year" : 1994
    } ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "Learning about the social structure of hidden and hard-toreach populations — such as drug users and sex workers — is a major goal of epidemiological and public health research on risk behaviors and disease prevention. Respondentdriven sampling (RDS) is a peer-referral process widely used by many health organizations, where research subjects recruit other subjects from their social network. In such surveys, researchers observe who recruited whom, along with the time of recruitment and the total number of acquaintances (network degree) of respondents. However, due to privacy concerns, the identities of acquaintances are not disclosed. In this work, we show how to reconstruct the underlying network structure through which the subjects are recruited. We formulate the dynamics of RDS as a continuous-time diffusion process over the underlying graph and derive the likelihood of the recruitment time series under an arbitrary inter-recruitment time distribution. We develop an efficient stochastic optimization algorithm called RENDER (REspoNdent-Driven nEtwork Reconstruction) that finds the network that best explains the collected data. We support our analytical results through an exhaustive set of experiments on both synthetic and real data. Introduction Random sampling is an effective way for researchers to learn about a population of interest. Characteristics of the sample can be generalized to the population of interest using standard statistical theory. However, traditional random sampling may be impossible when the target population is hidden, e.g. drug users, men who have sex with men, sex workers and homeless people. Due to concerns like privacy, stigmatization, discrimination, and criminalization, members of hidden populations may be reluctant to participate in a survey. In addition to the hidden populations for which no sampling “frame” exists, there are rare populations of great research interest, marked by their tiny fractions in the entire population. It is unlikely that random sampling from the general population would accrue a reasonable sample from a very rare population. However, it is often the case that members of hidden or rare populations know each other socially. This suggests that social referral would be an effective method for accruing a large sample. To this end, researchers have developed a variety of social link-tracing survey designs. The most popular is respondent-driven sampling (RDS) (Heckathorn 1997). In RDS, a small set of initial subjects, known as “seeds” are selected, not necessarily simultaneously, from the target population. Subjects are given a few coupons, each tagged with a unique identifier, which they can use to recruit other eligible subjects. Participants are given a reward for being interviewed and for each eligible subject they recruit using their coupons. Each subject reports their degree, the number of others whom they know in the target population. No subject is permitted to enter the study twice and the date and time of each interview is recorded. While RDS can be an effective recruitment method, it reveals only incomplete social network data to researchers. Any ties between recruited subjects along which no recruitment took place remain unobserved. The social network of recruited subjects is of great interest to sociologists, epidemiologists and public health researchers since it may induce dependencies in the outcomes of sampled individuals. Fortunately, RDS reveals information about the underlying social network that can be used to (approximately) reconstruct it. By leveraging the time series of recruitments, the degrees of recruited subjects, coupon information, and who recruited whom, it is possible to interpret the induced subgraph of RDS respondents as a simple random graph model (Crawford 2016). In this paper, we introduce a flexible and expressive stochastic model of RDS recruitment on a partially observed network structure. We derive the likelihood of the observed time series; the model admits any edgewise inter-recruitment time distribution. We propose a stochastic optimization algorithm RENDER (REspoNdent-Driven nEtwork Reconstruction) to estimate unknown parameters and the underlying social network. We conduct extensive experiments, on synthetic and real data, to confirm the accuracy and the reconstruction performance of RENDER. In particular, we apply RENDER to reconstruct the network of injection drug users from an RDS study in St. Petersburg, Russia. Related Work RDS has been modeled as a random walk with replacement on a graph at its equilibrium distribution (Heckathorn 1997; Salganik and Heckathorn 2004; Volz and Heckathorn 2008; Goel and Salganik 2009; Gile and Handcock 2010), and under this argument the sampling probability is proportional to degree, which is the basis for an estimator of the populaar X iv :1 51 1. 04 13 7v 2 [ cs .S I] 2 D ec 2 01 5 tion mean (Heckathorn 2002; Salganik 2006). In this paper, we adopt an approach that focuses on the network structure estimable from the RDS sample using recruitment information (Crawford 2016). Crawford (2016) assumes that edgewise inter-recruitment times follow the exponential distribution, but this approach is relatively inflexible. In many other contexts, dynamic or random processes can reveal structural information of an underlying, partially observed, network (Kramer et al. 2009; Shandilya and Timme 2011; Linderman and Adams 2014). Network reconstruction and the edge prediction problem have been studied for diffusion processes where multiple realizations of the process on the same network are available (Liben-Nowell and Kleinberg 2007; Gomez Rodriguez, Leskovec, and Krause 2010; Gomez Rodriguez et al. 2011). In the case of RDS, reconstruction is particularly challenging because only a single realization of the diffusion process is observed. Furthermore, we must account for the role of coupons in recruitment as they intricately introduce bias. However, in contrast to general diffusion processes over graphs, some important network topological information is revealed by RDS. In this study, we leverage all the available data routinely collected during real-world RDS studies.",
    "creator" : "LaTeX with hyperref package"
  }
}