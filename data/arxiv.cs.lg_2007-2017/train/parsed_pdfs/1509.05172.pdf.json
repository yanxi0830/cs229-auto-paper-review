{
  "name" : "1509.05172.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : null,
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 9.\n05 17\n2v 2\n[ st\nat .M\nL ]\n2 7"
    }, {
      "heading" : "1 Introduction",
      "text" : "In Reinforcement Learning (RL; Sutton and Barto 1998), policy-evaluation refers to the problem of evaluating the value function – a mapping from states to their longterm discounted return under a given policy, using sampled observations of the system dynamics and reward. Policy-evaluation is important both for assessing the quality of a policy, but also as a sub-procedure for policy optimization.\nFor systems with large or continuous state-spaces, an exact computation of the value function is often impossible. Instead, an approximate value-function is sought using various function-approximation techniques (a.k.a. approximate dynamic-programming; Bertsekas 2012). In this approach, the parameters of the value-function approximation are tuned using machine-learning inspired methods, often based on temporaldifferences (TD;Sutton and Barto 1998).\nThe source generating the sampled data divides policy evaluation into two cases. In the on-policy case, the samples are generated by the target-policy – the policy under evaluation; In the off-policy setting, a different behavior-policy generates the data. In\nthe on-policy setting, TD methods are well understood, with classic convergence guarantees and approximation-error bounds, based on a contraction property of the projected Bellman operator underlying TD (Bertsekas and Tsitsiklis, 1996). These bounds guarantee that the asymptotic error, or bias, of the algorithm is contained. For the off-policy case, however, standard TD methods no longer maintain this contraction property, the error bounds do not hold, and these methods might even diverge (Baird, 1995).\nThe standard error-bounds may be shown to hold for an importance-sampling TD method (IS-TD), as proposed by Precup, Sutton, and Dasgupta (2001). However, this method is known to suffer from a high variance of its importance-sampling estimator, limiting its practicality.\nLately, Sutton, Mahmood, and White (2015) proposed the emphatic TD (ETD) algorithm: a modification of the TD idea, which converges off-policy (Yu, 2015), and has a reduced variance compared to IS-TD. This variance reduction is achieved by incorporating a certain decay factor over the importance-sampling ratio. However, to the best of our knowledge, there are no results that bound the bias of ETD. Thus, while ETD is assured to converge, it is not known how good its limit actually is.\nIn this paper, we propose the ETD(λ, β) framework – a modification of the ETD(λ) algorithm, where the decay rate of the importance-sampling ratio, β, is a free parameter, and λ is the same bootstrapping parameter employed in TD(λ) and ETD(λ). By varying the decay rate, one can smoothly transition between the IS-TD algorithm, through ETD, to the standard TD algorithm.\nWe investigate the bias of ETD(λ, β), by studying the conditions under which its underlying projected Bellman operator is a contraction. We show that the original ETD possesses a contraction property, and present the first error bounds for ETD and ETD(λ, β). In addition, our error bound reveals that the decay rate parameter balances between the bias and variance of the learning procedure. In particular, we show that selecting a decay equal to the discount factor as in the original ETD may be suboptimal in terms of the mean-squared error.\nThe main contributions of this work are therefore a unification of several off-policy TD algorithms under the ETD(λ, β) framework, and a new error analysis that reveals the bias-variance trade-off between them.\nRelated Work: In recent years, several different off-policy policy-evaluation algorithms have been studied, such as importance-sampling based least-squares TD (Yu, 2012), and gradient-based TD (Sutton et al., 2009; Liu et al., 2015). These algorithms are guaranteed to converge, however, their asymptotic error can be bounded only when the target and behavior policies are similar (Bertsekas and Yu, 2009), or when their induced transition matrices satisfy a certain matrix-inequality suggested by Kolter (2011), which limits the discrepancy between the target and behavior policies. When these conditions are not satisfied, the error may be arbitrarily large (Kolter, 2011). In contrast, the approximation-error bounds in this paper hold for general target and behavior policies."
    }, {
      "heading" : "2 Preliminaries",
      "text" : "We consider an MDP M = (S,A, P,R, γ), where S is the state space, A is the action space, P is the transition probability matrix, R is the reward function, and γ ∈ [0, 1) is the discount factor.\nGiven a target policy π mapping states to a distribution over actions, our goal is to evaluate the value function:\nV π(s) . = Eπ\n[\n∞ ∑\nt=0\nR(st, at)\n∣ ∣ ∣ ∣ ∣ s0 = s ] .\nLinear temporal difference methods (Sutton and Barto, 1998) approximate the value function by\nV π(s) ≈ θ⊤ϕ(s),\nwhere ϕ(s) ∈ Rn are state features, and θ ∈ Rn are weights, and use sampling to find a suitable θ. Let µ denote a behavior policy that generates the samples s0, a0, s1, a1, . . . according to at ∼ µ(·|st) and st+1 ∼ P (·|st, at). We denote by ρt the ratio π(at|st)/µ(at|st), and we assume, similarly to Sutton, Mahmood, and White (2015), that µ and π are such that ρt is well-defined1 for all t.\nLet T denote the Bellman operator for policy π, given by\nT (V ) . = R+ γPV,\nwhere R and P are the reward vector and transition matrix induced by policy π, and let Φ denote a matrix whose columns are the feature vectors for all states. Let dµ and dπ denote the stationary distributions over states induced by the policies µ and π, respectively. For some d ∈ R|S| satisfying d > 0 element-wise, we denote by Πd a projection to the subspace spanned by ϕ(s) with respect to the d-weighted Euclideannorm.\nFor λ = 0, the ETD(0, β) (Sutton, Mahmood, and White, 2015) algorithm seeks to find a good approximation of the value function by iteratively updating the weight vector θ:\nθt+1 = θt + αFtρt(Rt+1 + γθ ⊤ t ϕt+1 − θ ⊤ t ϕt)ϕt\nFt = βρt−1Ft−1 + 1, F0 = 1, (1)\nwhere Ft is a decaying trace of the importance-sampling ratios, and β ∈ (0, 1) controls the decay rate.\nRemark 1. The algorithm of Sutton, Mahmood, and White (2015) selects the decay rate equal to the discount factor, i.e., β = γ. Here, we provide more freedom in choosing the decay rate. As our analysis reveals, the decay rate controls a bias-variance trade-off of ETD, therefore this freedom is important. Moreover, we note that for β = 0, we obtain the standard TD in an off-policy setting Yu (2012), and when β = 1 we obtain the full importance-sampling TD algorithm Precup, Sutton, and Dasgupta (2001).\n1Namely, if µ(a|s) = 0 then π(a|s) = 0 for all s ∈ S.\nRemark 2. The ETD(0, γ) algorithm of Sutton, Mahmood, and White (2015) also includes a state-dependent emphasis weight i(s), and a state-dependent discount factor γ(s). Here, we analyze the case of a uniform weight i(s) = 1 and constant discount factor γ for all states. While our analysis can be extended to their more general setting, the insights from the analysis remain the same, and for the purpose of clarity we chose to focus on this simpler setting.\nAn important term in our analysis is the emphatic weight vector f , defined by\nf⊤ = d⊤µ (I − βP ) −1. (2)\nIt can be shown (Sutton, Mahmood, and White, 2015; Yu, 2015), that ETD(0, β) converges to θ∗ - a solution of the following projected fixed point equation:\nV = ΠfTV, V ∈ R |S|. (3)\nFor the fixed point equation (3), a contraction property of ΠfT is important for guaranteeing both a unique solution, and a bias bound (Bertsekas and Tsitsiklis, 1996).\nIt is well known that T is a γ-contraction with respect to the dπ-weighted Euclidean norm (Bertsekas and Tsitsiklis, 1996), and by definition Πf is a non-expansion in f - norm, however, it is not immediate that the composed operator ΠfT is a contraction in any norm. Indeed, for the TD(0) algorithm (Sutton and Barto 1998; corresponding to the β = 0 case in our setting), a similar representation as a projected Bellman operator holds, but it may be shown that in the off-policy setting the algorithm might diverge (Baird, 1995). In the next section, we study the contraction properties of ΠfT , and provide corresponding bias bounds.\n3 Bias of ETD(0, β)\nIn this section we study the bias of the ETD(0, β) algorithm. Let us first introduce the following measure of discrepancy between the target and behavior policies:\nκ . = min\ns\ndµ(s)\nf(s) .\nLemma 1. The measure κ obtains values ranging from κ = 0 (when there is a state visited by the target policy, but not the behavior policy), to κ = 1 − β (when the two policies are identical).\nThe technical proof is given in the supplementary material. The following theorem shows that for ETD(0, β) with a suitable β, the projected Bellman operator ΠfT is indeed a contraction.\nTheorem 1. For β > γ2(1−κ), the projected Bellman operatorΠfT is a √ γ2\nβ (1− κ)-\ncontraction with respect to the Euclidean f -weighted norm, namely, ∀v1, v2 ∈ R|S|:\n‖ΠfTv1 −ΠfTv2‖f ≤\n√\nγ2\nβ (1− κ)‖v1 − v2‖f .\nProof. Let F = diag(f). We have\n‖v‖2f − β ‖Pv‖ 2 f = v ⊤Fv − βv⊤P⊤FPv\n≥(a) v⊤Fv − βv⊤diag(f⊤P )v\n= v⊤[F − βdiag(f⊤P )]v\n= v⊤ [ diag ( f⊤(I − βP ) )] v\n=(b) v⊤diag(dµ)v = ‖v‖ 2 dµ ,\nwhere (a) follows from Jensen inequality:\nv⊤P⊤FPv = ∑\ns\nf(s)( ∑\ns′\nP (s′|s)v(s′))2\n≤ ∑\ns\nf(s) ∑\ns′\nP (s′|s)v2(s′)\n= ∑\ns′\nv2(s′) ∑\ns\nf(s)P (s′|s)\n= v⊤diag(f⊤P )v,\nand (b) is by the definition of f in (2). Notice that for every v:\n‖v‖ 2 dµ = ∑\ns\ndµ(s)v 2(s) ≥\n∑\ns\nκf(s)v2(s) = κ ‖v‖ 2 f\nTherefore:\n‖v‖ 2 f ≥ β ‖Pv‖ 2 f + ‖v‖ 2 dµ ≥ β ‖Pv‖ 2 f + κ ‖v‖ 2 f ,\n⇒ β ‖Pv‖ 2 f ≤ (1− κ) ‖v‖ 2 f\nand:\n‖Tv1 − Tv2‖ 2 f = ‖γP (v1 − v2)‖ 2 f\n= γ2 ‖P (v1 − v2)‖ 2 f ≤ γ2\nβ (1− κ) ‖v1 − v2‖\n2 f .\nHence, T is a √ γ2\nβ (1− κ)-contraction. Since Πf is a non-expansion in the f -weighted\nnorm (Bertsekas and Tsitsiklis, 1996), ΠfT is a √ γ2\nβ (1 − κ)-contraction as well.\nRecall that for the original ETD algorithm (Sutton, Mahmood, and White, 2015), we have that β = γ, and the contraction modulus is √\nγ(1− κ) < 1, thus the contraction of ΠfT always holds.\nAlso note that in the on-policy case, the behavior and target policies are equal, and according to Lemma 1 we have 1 − κ = β. In this case, the contraction modulus in Theorem 1 is γ, similar to the result for on-policy TD Bertsekas and Tsitsiklis (1996).\nWe remark that Kolter (2011) also used a measure of discrepancy between the behavior and the target policy to bound the TD-error. However, Kolter (2011) considered the standard TD algorithm, for which a contraction could be guaranteed only for a class of behavior policies that satisfy a certain matrix inequality criterion. Our results show that for ETD(0, β) with a suitable β, a contraction is guaranteed for general behavior policies. We now show in an example that our contraction modulus bounds are tight.\nExample 1. Consider an MDP with two states: Left and Right. In each state there are two identical actions leading to either Left or Right deterministically. The behavior policy will choose Right with probability ε, and the target policy will choose Left with probability ε, hence 1− κ ≈ 1. Calculating the quantities of interest:\nP =\n(\nε 1− ε ε 1− ε\n)\n, dµ = (1− ε, ε)\nf = 1\n1− β (1 + 2εβ − ε− β,−2εβ + ε+ β)\n⊤ .\nSo for v = (0, 1)⊤:\n‖v‖ 2 f =\nε+ β − 2εβ\n1− β , ‖Pv‖\n2 f =\n(1− ε)2\n1− β ,\nand for small ε we obtain that ‖γPv‖ 2 ‖v‖2f ≈ γ 2 β .\nAn immediate consequence of Theorem 1 is the following error bound, based on Lemma 6.9 of Bertsekas and Tsitsiklis (1996):\nCorollary 1. We have\n∥ ∥Φ⊤θ∗ − V π ∥ ∥\nf ≤\n1 √\n1− γ 2\nβ (1− κ)\n‖ΠfV π − V π‖\nf ,\n∥ ∥Φ⊤θ∗ − V π ∥ ∥\ndµ ≤\n1 √\nγ ( 1− γ 2\nβ (1− κ)\n)\n‖ΠfV π − V π‖\nf .\nUp to the weights in the norm, the error ‖ΠfV π − V π‖f is the best approximation we can hope for, within the capability of the linear approximation architecture. Corollary 1 guarantees that we are not too far away from it.\nNotice that the error ∥ ∥Φ⊤θ∗ − V π ∥ ∥\ndµ uses a measure dµ which is independent of\nthe target policy; This could be useful in further analysis of a policy iteration algorithm, which iteratively improves the target policy using samples from a single behavior policy. Such an analysis may proceed similarly to that in Munos (2003) for the on-policy case."
    }, {
      "heading" : "3.1 Numerical Illustration",
      "text" : "We illustrate the importance of the ETD(0, β) bias bound in a numerical example. Consider the 2-state MDP example of Kolter (2011), with transition matrix P = (1/2)1 (where 1 is an all 1 matrix), discount factor γ = 0.99, and value function V = [1, 1.05]⊤ (with R = (I−γP )V ). The features are Φ = [1, 1.05+ε]⊤, with ε = 0.001. Clearly, in this example we have dπ = [0.5, 0.5]. The behavior policy is chosen such that dµ = [p, 1− p].\nIn Figure 1 we plot the mean-squared error ∥ ∥Φ⊤θ∗ − V π ∥ ∥\ndπ , where θ∗ is either\nthe fixed point of the standard TD equation V = ΠdµTV , or the ETD(0, β) fixed point of (3), with β = γ. We also show the optimal error ‖ΠdπV − V\nπ‖dπ achievable with these features. Note that, as observed by Kolter (2011), for certain behavior policies the bias of standard TD is infinite. This means that algorithms that converge to this fixed point, such as the GTD algorithm (Sutton et al., 2009), are hopeless in such cases. The ETD algorithm, on the other hand, has a bounded bias for all behavior policies.\n4 The Bias-Variance Trade-Off of ETD(0, β)\nFrom the results in Corollary 1, it is clear that increasing the decay rate β decreases the bias bound. Indeed, for the case β = 1 we obtain the importance sampling TD algorithm (Precup, Sutton, and Dasgupta, 2001), which is known to have a bias bound similar to on-policy TD. However, as recognized by Precup, Sutton, and Dasgupta (2001) and Sutton, Mahmood, and White (2015), the importance sampling ratio Ft suffers from a high variance, which increases with β. The quantityFt is important as it appears as a multiplicative factor in the definition of the ETD learning rule, so its amplitude directly impacts the stability of the algorithm. In fact, the asymptotic variance of Ft may be infinite, as we show in the following example:\nExample 2. Consider the same MDP given in Example 1, only now the behavior policy chooses Left or Right with probability 0.5, and the target policy chooses always Right. For ETD(0, β) with β ∈ [0, 1), we have that when St = Left then Ft = 1 (since ρt−1 = 0). When St = Right, Ft may take several values depending on how many steps, τ(t),\nwas the last transition from Left to Right, i.e. τ(t) def = min{i ≥ 0 : St−i = Left}. We can write this value as F τ(t) where:\nF τ . =\nτ ∑\ni=0\n(2β)i = (2β)τ+1 − 1\n2β − 1 ,\nif 2β 6= 1. Let us assume that 2β > 1 since interesting cases happen when β is close to 1.\nLet’s compute Ft’s average over time: Following the stationary distribution of the behavior policy, St = Left with probability 1/2. Now, conditioned on St = Right (which happens with probability 1/2), we have τ(t) = i with probability 2−i−1. Thus the average (over time) value of Ft is\nEFt = 1\n2\n∞ ∑\ni=0\n2−i−1F i =\n∑\ni β i+1 − 1\n2(2β − 1) =\n1\n2(1− β) .\nThus Ft amplifies the TD update by a factor of 12(1−β) in average. Unfortunately, the actual values of the (random variable) Ft does not concentrate around its expectation, and actually Ft does not even have a finite variance. Indeed the average (over time) of F 2t is\nEF 2t = 1\n4\n∞ ∑\ni=0\n2−i(F i)2 =\n∑ i 2 −i ( (2β)i+1 − 1 )2\n4(2β − 1)2 = ∞,\nas soon as 2β2 ≥ 1.\nSo although ETD(0, β) converges almost surely (as shown by Yu 2015), the variance of the estimate may be infinite, which suggests a prohibitively slow convergence rate.\nIn the following proposition we characterize the dependence of the variance of Ft on β.\nProposition 1. Define the mismatch matrix P̃µ,π such that [P̃µ,π]s̄s = ∑ a p(s|s̄, ā) π2(a|s̄) µ(a|s̄) and write α(µ, π) the largest magnitude of its eigenvalues. Then for any β < 1/ √\nα(µ, π) the average variance of Ft (conditioned on any state) is finite, and\nEµ [Var[Ft|St = s]] ≤ β2\n1− β\n 2 + (1 + β)\n∥ ∥ ∥P̃µ,π ∥ ∥ ∥\n∞\n1− β2 ∥ ∥\n∥P̃µ,π\n∥ ∥ ∥\n∞\n\n ,\nwhere ∥ ∥\n∥ P̃µ,π\n∥ ∥ ∥\n∞ is the l∞-induced norm which is the maximum absolute row sum of\nthe matrix.\nProof. (Partial) Following the same derivation that Sutton, Mahmood, and White (2015)\nused to prove that f(s) = dµ(s) limt→∞ E[Ft|St = s], we have\nq(s) . = dµ(s) lim\nt→∞ E[F 2t |St = s]\n= dµ(s) lim t→∞\nE[(1 + ρt−1βFt−1) 2|St = s]\n= dµ(s) lim t→∞\nE[1 + 2ρt−1βFt−1 + ρ 2 t−1β 2F 2t−1|St = s].\nFor the first summand, we get dµ(s). For the second summand, we get:\n2βdµ(s) lim t→∞\nE[ρt−1Ft−1|St = s] = 2β ∑\ns̄\n[Pπ]s̄sf(s̄).\nThe third summand equals\nβ2 ∑\ns̄,ā\ndµ(s̄)µ(ā|s̄)p(s|s̄, ā) π2(ā|s̄)\nµ2(ā|s̄) lim t→∞\nE[F 2t−1|St−1 = s̄]\n= β2 ∑\ns̄,ā\np(s|s̄, ā) π2(ā|s̄)\nµ(ā|s̄) q(s̄) = β2\n∑\ns̄\n[P̃µ,π ]s̄sq(s̄).\nHence q = dµ + 2βP⊤π f + β 2P̃⊤µ,πq. Thus for any β < 1/\n√\nα(µ, π), all eigenval-\nues of the matrix β2P̃⊤µ,π have magnitude smaller than 1, and the vector q has finite components. The rest of the proof is very technical and is given in Lemma 2 in the supplementary material.\nProposition 1 and Corollary 1 show that the decay rate β acts as an implicit tradeoff parameter between the bias and variance in ETD. For large β, we have a low bias but suffer from a high variance (possibly infinite if β ≥ 1/ √\nλ(µ, π)), and vice versa for small β. Notice that for the on-policy case, λ(µ, π) = 1 thus for any β < 1 the variance is finite.\nOriginally, ETD(0, β) was introduced with β = γ, and from our perspective, it may be seen as a specific choice for the bias-variance trade-off. However, there is no intrinsic reason to choose β = γ, and other choices may be preferred in practice, depending on the nature of the problem. In the following numerical example, we investigate the biasvariance dependence on β, and show that the optimal β in term of mean-squared error may be quite different from γ."
    }, {
      "heading" : "4.1 Numerical Illustration",
      "text" : "We revisit the 2-state MDP described in Section 3.1, with γ = 0.9, ε = 0.2 and p = 0.95. For these parameter settings, the error of standard TD is 42.55 (p was chosen to be close to a point of infinite bias for these parameters).\nIn Figure 2 we plot the mean-squared error ∥ ∥Φ⊤θ∗ − V π ∥ ∥\ndπ , where θ∗ was ob-\ntained by running ETD(0, β) with a step size α = 0.001 for 10, 000 iterations, and averaging the results over 10, 000 different runs.\nFirst of all, note that for all β, the error is smaller by two orders of magnitude than that of standard TD. Thus, algorithms that converge to the standard TD fixed point such as GTD Sutton et al. (2009) are significantly outperformed by ETD(0, β) in this case. Second, note the dependence of the error on β, demonstrating the bias-variance tradeoff discussed above. Finally, note that the minimal error is obtained for γ = 0.8, and is considerably smaller than that of the original ETD with β = γ = 0.9."
    }, {
      "heading" : "5 Contraction Property for ETD(λ, β)",
      "text" : "We now extend our results to incorporate eligibility traces, in the style of the ETD(λ) algorithm (Sutton, Mahmood, and White, 2015), and show similar contraction properties and error bounds.\nThe ETD(λ, β) algorithm iteratively updates the weight vector θ according to\nθt+1 := θt + α(Rt+1 + γθ ⊤ t ϕt+1 − θ ⊤ t ϕt)et\net = ρt(γλet−1 +Mtϕt), e−1 = 0\nMt = λ+ (1− λ)Ft\nFt = βρt−1Ft−1 + 1, F0 = 1,\nwhere et is the eligibility trace (Sutton, Mahmood, and White, 2015). In this case, we define the emphatic weight vector m by\nm⊤ = d⊤µ (I − P λ,β)−1, (4)\nwhere P a,b for some a, b ∈ R denotes the following matrix:\nP a,b = I − (I − baP )−1(I − bP ).\nThe Bellman operator for general λ and γ is given by:\nT (λ)(V ) = (I − γλP )−1R + Pλ,γV, V ∈ R|S|.\nFor λ = 0 we have Pλ,βπ = βP , P λ,γ π = γP , and m = f so we recover the definitions of ETD(0, β). Recall that our goal is to estimate the value function V π. Thus, we would like to know how well the ETD(λ, β) solution approximatesV π. Mahmood et al. (2015) show that, under suitable step-size conditions, ETD converges to some θ∗ that is a solution of the projected fixed-point equation:\nθ⊤Φ = ΠmT (λ)(θ⊤Φ).\nIn their analysis, however, Mahmood et al. (2015) did not show how well the solution Φ⊤θ∗ approximates V π. Next, we establish that the projected Bellman operator ΠmT (λ) is a contraction. This result will then allow us to bound the error ∥ ∥Φ⊤θ∗ − V π ∥ ∥\nm .\nTheorem 2. ΠmT (λ) is an ω-contraction with respect to the Euclidean m-weighted norm where:\nβ ≥ γ : ω =\n√\nγ2(1 + λβ)2(1− λ) β(1 + γλ)2(1− λβ) ,\nβ ≤ γ : ω =\n√\nγ2(1− βλ)(1 − λ)\nβ(1− γλ)2 .\n(5)\nProof. (sketch) The proof is almost identical to the proof of Theorem 1, only now we cannot apply Jensen’s inequality directly, since the rows of Pλ,β do not sum to 1. However:\nPλ,β1 = ( I − (I − βλP )−1(I − βP ) ) 1 = ζ1,\nwhere ζ = β(1−λ)1−λβ . Notice that each entry of P λ,β is positive. Therefore P\nλ,β ζ will hold\nfor Jensen’s inequality. Let M = diag(m), we have\n‖v‖ 2 m −\n1\nζ\n∥ ∥Pλ,βv ∥ ∥\n2 m = v⊤Mv − ζv⊤\nPλ,β\nζ\n⊤\nM Pλ,β\nζ v\n≥(a) v⊤Mv − βv⊤diag(m⊤ Pλ,β\nζ )v\n= v⊤[M − diag(m⊤Pλ,β)]v\n= v⊤ [ diag ( m⊤(I − Pλ,β) )] v\n=(b) v⊤diag(dµ)v = ‖v‖ 2 dµ ,\nwhere (a) follows from the Jensen inequality and (b) from Equation (4). Therefore:\n‖v‖ 2 m ≥\n1\nζ\n∥ ∥Pλ,βv ∥ ∥\n2 m + ‖v‖ 2 dµ ≥ 1\nζ\n∥ ∥Pλ,βv ∥ ∥\n2 m ,\nand: ∥\n∥ ∥T (λ)v1 − T (λ)v2\n∥ ∥ ∥ 2\nm =\n∥ ∥Pλ,γ(v1 − v2) ∥ ∥\n2\nm\n(Case A: β ≥ γ) ≤\n∥ ∥ ∥ ∥ γ(1 + βλ)\nβ(1 + γλ) Pλ,β(v1 − v2)\n∥ ∥ ∥ ∥ 2\nm\n≤ γ2(1 + λβ)2(1− λ)\nβ(1 + γλ)2(1 − λβ) ‖v1 − v2‖\n2 m ,\n(Case B: β ≤ γ) ≤\n∥ ∥ ∥ ∥ γ(1− βλ)\nβ(1 − γλ) Pλ,β(v1 − v2)\n∥ ∥ ∥ ∥ 2\nm\n≤ γ2(1− βλ)(1 − λ)\nβ(1 − γλ)2 ‖v1 − v2‖\n2 m .\nThe inequalities depending on the two cases originate from the fact that the two matrices Pλ,β , Pλ,γ are polynomials of the same matrix Pπ , and mathematical manipulation on the corresponding eigenvalues decomposition of (v1 − v2). The details are given in Lemma 3 of the supplementary material.\nNow, for a proper choice of β, the operator T (λ) is a contraction, and since Πm is a non-expansion in the m-weighted norm, ΠmT (λ) is a contraction as well.\nIn Figure 3 we illustrate the dependence of the contraction moduli bound on λ and β. In particular, for λ → 1, the contraction modulus diminishes to 0. Thus, for large enough λ, a contraction can always be guaranteed (this can also be shown mathematically from the contraction results of Theorem 2). We remark that a similar result for standard TD(λ) was established by Yu 2012. However, as is well-known (Bertsekas, 2012), increasing λ also increases the variance of the algorithm, and we therefore obtain a bias-variance trade-off in λ as well as β. Finally, note that for β = γ, the contraction modulus equals √\nγ(1−λ) 1−γλ , and that for λ = 0 the result is the same as in Theorem\n1."
    }, {
      "heading" : "6 Conclusion",
      "text" : "In this work we unified several off-policy TD algorithms under the ETD(λ, β) framework, which flexibly manages the bias and variance of the algorithm by controlling the decay-rate of the importance-sampling ratio. From this perspective, we showed that several different methods proposed in the literature are special instances of this biasvariance selection.\nOur main contribution is an error analysis of ETD(λ, β) that quantifies the biasvariance trade-off. In particular, we showed that the recently proposed ETD algorithm of Sutton, Mahmood, and White (2015) has bounded bias for general behavior and target policies, and that by controlling the decay-rate in the ETD(λ, β) algorithm, an improved performance may be obtained by reducing the variance of the algorithm while still maintaining a reasonable bias.\nPossible future extensions of our work includes finite-time bounds for off-policy ETD(λ, β), an error propagation analysis of off-policy policy improvement, and solving the bias-variance trade-off adaptively from data."
    }, {
      "heading" : "A Proof of Lemma 1",
      "text" : "Notice that κ obtains non-negative values since dµ(s), f(s) ≥ 0. Now, if there is a state s visited by the target policy, but not the behavior policy, this means that dµ(s) = 0, and that there is some t such that [d⊤µP t π](s) > 0, and by definition f(s) ≥ [β td⊤µP t π ](s), so we can get κ = 0. Next, we prove the upper bound on κ. Notice that f(s) ≥ 0, and that ∑\ns f(s) = 1/(1 − β). Hence, if dµ 6= (1 − β)f , then there must exist some s such that dµ(s) < (1− β)f(s) so κ < 1 − β. Now, when dµ = dπ, by definition dµ = (1− β)f and we obtain this upper bound."
    }, {
      "heading" : "B Technical Part of Proposition 1",
      "text" : "Lemma 2. The following is true:\n∑\ns\ndµ(s) lim t→∞\nVar[Ft|St = s] ≤ β2\n1− β\n 2 + (1 + β)\n∥ ∥ ∥P̃µ,π ∥ ∥ ∥\n∞\n1− β2 ∥ ∥\n∥P̃µ,π\n∥ ∥ ∥\n∞\n\n .\nProof. Notice that:\nf⊤ = d⊤µ (I − βPπ) −1 ≥(cw) d⊤µ + βd ⊤ µ Pπ,\nso: ∑\ns\ndµ(s) lim t→∞\nVar[Ft|St = s] = q ⊤1 − f⊤D−1µ f\n≤(a) d⊤µ 1 + 2βf ⊤Pπ1\n+ (d⊤µ + 2βf ⊤Pπ)β 2P̃µ,π(I − β 2P̃µ,π) −11 − (dµ + βP ⊤ π dµ) ⊤D−1µ (dµ + βP ⊤ π dµ)\n≤(b) (1 + 2β\n1− β )− (1 + 2β)\n+ ∥ ∥\n∥(d⊤µ + 2βf ⊤Pπ)β 2P̃µ,π(I − β 2P̃µ,π)\n−1 ∥ ∥\n∥\n1\n≤(c) 2β2\n1− β + β2\n∥ ∥d⊤µ + 2βf ⊤Pπ ∥ ∥\n1\n∥ ∥ ∥P̃µ,π(I − β 2P̃µ,π) −1 ∥ ∥ ∥\n∞\n≤(d) β2\n1− β\n 2 + (1 + β)\n∥ ∥ ∥P̃µ,π ∥ ∥ ∥\n∞\n1− β2 ∥ ∥\n∥P̃µ,π\n∥ ∥ ∥\n∞\n\n .\nWhere (a) comes from the inequality on f , (b) also removes the negative summand β2d⊤µ PπD −1 µ P ⊤ π dµ, and swaps sum with l1 norm (all coordinates are non-negative), (c) and (d) are from the sub-multiplicative property of induced norms (the l∞ norm originates from the transpose).\nC Norm Inequality between Pλ,βπ and P λ,γ π\nLemma 3. If β ≥ γ:\n∥ ∥Pλ,γπ v ∥ ∥\n2 m ≤\n∥ ∥ ∥ ∥ γ(1 + βλ)\nβ(1 + γλ) Pλ,βπ v\n∥ ∥ ∥ ∥ 2\nm\n, (6)\nand if β ≤ γ: ∥\n∥Pλ,γπ v ∥ ∥\n2 m ≤\n∥ ∥ ∥ ∥ γ(1− βλ)\nβ(1 − γλ) Pλ,βπ v\n∥ ∥ ∥ ∥ 2\nm\n, (7)\nProof. Mark the orthonormal eigenvectors w.r.t. m, and corresponding eigenvalues of Pπ by uj, tj respectively (tj may be a complex number, this decomposition exists over C almost surely). Notice that since Pλ,βπ , P λ,γ π are polynomials of Pπ they have the same eigenvectors, with the eigenvalues lβj := βtj(1−λ) 1−βλtj , lγj := γtj(1−λ) 1−γλtj\ncorrespondingly. Hence, we can write the first norm as follows:\n∥ ∥Pλ,γπ v ∥ ∥\n2 m =\n∥ ∥ ∥ ∥ ∥ ∥ Pλ,γπ ∑\nj\n< uj, v > uj\n∥ ∥ ∥ ∥ ∥ ∥ 2\nm\n=\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nj\n< uj, v > P λ,γ π uj\n∥ ∥ ∥ ∥ ∥ ∥ 2\nm\n=\n∥ ∥ ∥ ∥ ∥ ∥ ∑\nj\n< uj, v > l γ j uj\n∥ ∥ ∥ ∥ ∥ ∥ 2\nm\n= ∑\nj\n∥ ∥< uj , v > l γ j uj ∥ ∥ 2\nm\n= ∑\nj\n|< uj , v >| 2 ∣ ∣lγj ∣ ∣ 2 ‖uj‖ 2 m .\n(8)\nAnd similarly for β: ∥\n∥Pλ,βπ v ∥ ∥\n2 m = ∑\nj\n|< uj , v >| 2 ∣ ∣ ∣l β j ∣ ∣ ∣ 2 ‖uj‖ 2 m . (9)\nSo if we can find a constant α such that:\n∀j : ∣ ∣lγj ∣ ∣ 2 ≤ α2\n∣ ∣ ∣l β j ∣ ∣ ∣ 2 , (10)\nthen could swap ∥ ∥Pλ,γπ v ∥ ∥ 2 m ≤ ∥ ∥αPλ,γπ v ∥ ∥ 2 m . The expression we want to maximize is:\n∣ ∣lγj ∣ ∣ 2 ∣ ∣ ∣l β j ∣ ∣ ∣ 2 = γ2(1− βλtj)(1 − βλt ∗ j ) β2(1− γλtj)(1 − γλt∗j )\n= γ2(1− βλtj − βλt ∗ j + β 2λ2 |tj | 2 )\nβ2(1− γλtj − γλt∗j + γ 2λ2 |tj |\n2) .\n(11)\nTaking the derivative with respect to Re(tj), Im(tj), shows that there are no extrema points inside the ball |tj | ≤ 1 (we know the eigenvalues are inside this ball since they belong to a stochastic matrix), which means we can look at the boundary of this ball |tj | = 1 to find the maximum value. Since now we get dependence only on Re(tj), the maximum must be on tj = ±1:\nmax t:|tj |≤1\n∣ ∣lγj ∣ ∣ 2 ∣ ∣ ∣l β j ∣ ∣ ∣ 2 = γ2(1± βλ)2 β2(1 ± γλ)2 , (12)\nwhere when β ≥ γ the plus is larger and vice versa."
    } ],
    "references" : [ {
      "title" : "Residual algorithms: Reinforcement learning with function approximation",
      "author" : [ "L. Baird" ],
      "venue" : "ICML.",
      "citeRegEx" : "Baird,? 1995",
      "shortCiteRegEx" : "Baird",
      "year" : 1995
    }, {
      "title" : "Neuro-Dynamic Programming",
      "author" : [ "D. Bertsekas", "J. Tsitsiklis" ],
      "venue" : "Athena Scientific.",
      "citeRegEx" : "Bertsekas and Tsitsiklis,? 1996",
      "shortCiteRegEx" : "Bertsekas and Tsitsiklis",
      "year" : 1996
    }, {
      "title" : "Projected equation methods for approximate solution of large linear systems",
      "author" : [ "D. Bertsekas", "H. Yu" ],
      "venue" : "Journal of Computational and Applied Mathematics 227(1):27–50.",
      "citeRegEx" : "Bertsekas and Yu,? 2009",
      "shortCiteRegEx" : "Bertsekas and Yu",
      "year" : 2009
    }, {
      "title" : "Dynamic Programming and Optimal Control, Vol II",
      "author" : [ "D. Bertsekas" ],
      "venue" : "Athena Scientific, 4th edition.",
      "citeRegEx" : "Bertsekas,? 2012",
      "shortCiteRegEx" : "Bertsekas",
      "year" : 2012
    }, {
      "title" : "The fixed points of off-policy TD",
      "author" : [ "J.Z. Kolter" ],
      "venue" : "NIPS.",
      "citeRegEx" : "Kolter,? 2011",
      "shortCiteRegEx" : "Kolter",
      "year" : 2011
    }, {
      "title" : "Finite-sample analysis of proximal gradient td algorithms",
      "author" : [ "B. Liu", "J. Liu", "M. Ghavamzadeh", "S. Mahadevan", "M. Petrik" ],
      "venue" : "UAI.",
      "citeRegEx" : "Liu et al\\.,? 2015",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2015
    }, {
      "title" : "Emphatic TemporalDifference Learning",
      "author" : [ "A.R. Mahmood", "H. Yu", "M. White", "R.S. Sutton" ],
      "venue" : "arXiv:1507.01569.",
      "citeRegEx" : "Mahmood et al\\.,? 2015",
      "shortCiteRegEx" : "Mahmood et al\\.",
      "year" : 2015
    }, {
      "title" : "Error bounds for approximate policy iteration",
      "author" : [ "R. Munos" ],
      "venue" : "ICML.",
      "citeRegEx" : "Munos,? 2003",
      "shortCiteRegEx" : "Munos",
      "year" : 2003
    }, {
      "title" : "Off-policy temporal-difference learning with function approximation",
      "author" : [ "D. Precup", "R.S. Sutton", "S. Dasgupta" ],
      "venue" : "ICML.",
      "citeRegEx" : "Precup et al\\.,? 2001",
      "shortCiteRegEx" : "Precup et al\\.",
      "year" : 2001
    }, {
      "title" : "Reinforcement learning: An introduction",
      "author" : [ "R.S. Sutton", "A. Barto" ],
      "venue" : "Cambridge Univ Press.",
      "citeRegEx" : "Sutton and Barto,? 1998",
      "shortCiteRegEx" : "Sutton and Barto",
      "year" : 1998
    }, {
      "title" : "Fast gradient-descent methods for temporal-difference learning with linear function approximation",
      "author" : [ "R.S. Sutton", "H.R. Maei", "D. Precup", "S. Bhatnagar", "D. Silver", "C. Szepesvári", "E. Wiewiora" ],
      "venue" : "ICML.",
      "citeRegEx" : "Sutton et al\\.,? 2009",
      "shortCiteRegEx" : "Sutton et al\\.",
      "year" : 2009
    }, {
      "title" : "An emphatic approach to the problem of off-policy temporal-difference learning",
      "author" : [ "R.S. Sutton", "A.R. Mahmood", "M. White" ],
      "venue" : "arXiv:1503.04269.",
      "citeRegEx" : "Sutton et al\\.,? 2015",
      "shortCiteRegEx" : "Sutton et al\\.",
      "year" : 2015
    }, {
      "title" : "Least squares temporal difference methods: An analysis under general conditions",
      "author" : [ "H. Yu" ],
      "venue" : "SIAM Journal on Control and Optimization 50(6):3310–3343.",
      "citeRegEx" : "Yu,? 2012",
      "shortCiteRegEx" : "Yu",
      "year" : 2012
    }, {
      "title" : "On convergence of emphatic temporal-difference learning",
      "author" : [ "H. Yu" ],
      "venue" : "COLT.",
      "citeRegEx" : "Yu,? 2015",
      "shortCiteRegEx" : "Yu",
      "year" : 2015
    } ],
    "referenceMentions" : [ {
      "referenceID" : 9,
      "context" : "1 Introduction In Reinforcement Learning (RL; Sutton and Barto 1998), policy-evaluation refers to the problem of evaluating the value function – a mapping from states to their longterm discounted return under a given policy, using sampled observations of the system dynamics and reward.",
      "startOffset" : 41,
      "endOffset" : 68
    }, {
      "referenceID" : 3,
      "context" : "Instead, an approximate value-function is sought using various function-approximation techniques (a.k.a. approximate dynamic-programming; Bertsekas 2012).",
      "startOffset" : 97,
      "endOffset" : 153
    }, {
      "referenceID" : 9,
      "context" : "In this approach, the parameters of the value-function approximation are tuned using machine-learning inspired methods, often based on temporaldifferences (TD;Sutton and Barto 1998).",
      "startOffset" : 155,
      "endOffset" : 181
    }, {
      "referenceID" : 1,
      "context" : "the on-policy setting, TD methods are well understood, with classic convergence guarantees and approximation-error bounds, based on a contraction property of the projected Bellman operator underlying TD (Bertsekas and Tsitsiklis, 1996).",
      "startOffset" : 203,
      "endOffset" : 235
    }, {
      "referenceID" : 0,
      "context" : "For the off-policy case, however, standard TD methods no longer maintain this contraction property, the error bounds do not hold, and these methods might even diverge (Baird, 1995).",
      "startOffset" : 167,
      "endOffset" : 180
    }, {
      "referenceID" : 13,
      "context" : "Lately, Sutton, Mahmood, and White (2015) proposed the emphatic TD (ETD) algorithm: a modification of the TD idea, which converges off-policy (Yu, 2015), and has a reduced variance compared to IS-TD.",
      "startOffset" : 142,
      "endOffset" : 152
    }, {
      "referenceID" : 12,
      "context" : "Related Work: In recent years, several different off-policy policy-evaluation algorithms have been studied, such as importance-sampling based least-squares TD (Yu, 2012), and gradient-based TD (Sutton et al.",
      "startOffset" : 159,
      "endOffset" : 169
    }, {
      "referenceID" : 10,
      "context" : "Related Work: In recent years, several different off-policy policy-evaluation algorithms have been studied, such as importance-sampling based least-squares TD (Yu, 2012), and gradient-based TD (Sutton et al., 2009; Liu et al., 2015).",
      "startOffset" : 193,
      "endOffset" : 232
    }, {
      "referenceID" : 5,
      "context" : "Related Work: In recent years, several different off-policy policy-evaluation algorithms have been studied, such as importance-sampling based least-squares TD (Yu, 2012), and gradient-based TD (Sutton et al., 2009; Liu et al., 2015).",
      "startOffset" : 193,
      "endOffset" : 232
    }, {
      "referenceID" : 2,
      "context" : "These algorithms are guaranteed to converge, however, their asymptotic error can be bounded only when the target and behavior policies are similar (Bertsekas and Yu, 2009), or when their induced transition matrices satisfy a certain matrix-inequality suggested by Kolter (2011), which limits the discrepancy between the target and behavior policies.",
      "startOffset" : 147,
      "endOffset" : 171
    }, {
      "referenceID" : 4,
      "context" : "When these conditions are not satisfied, the error may be arbitrarily large (Kolter, 2011).",
      "startOffset" : 76,
      "endOffset" : 90
    }, {
      "referenceID" : 0,
      "context" : "For the off-policy case, however, standard TD methods no longer maintain this contraction property, the error bounds do not hold, and these methods might even diverge (Baird, 1995). The standard error-bounds may be shown to hold for an importance-sampling TD method (IS-TD), as proposed by Precup, Sutton, and Dasgupta (2001). However, this method is known to suffer from a high variance of its importance-sampling estimator, limiting its practicality.",
      "startOffset" : 168,
      "endOffset" : 326
    }, {
      "referenceID" : 0,
      "context" : "For the off-policy case, however, standard TD methods no longer maintain this contraction property, the error bounds do not hold, and these methods might even diverge (Baird, 1995). The standard error-bounds may be shown to hold for an importance-sampling TD method (IS-TD), as proposed by Precup, Sutton, and Dasgupta (2001). However, this method is known to suffer from a high variance of its importance-sampling estimator, limiting its practicality. Lately, Sutton, Mahmood, and White (2015) proposed the emphatic TD (ETD) algorithm: a modification of the TD idea, which converges off-policy (Yu, 2015), and has a reduced variance compared to IS-TD.",
      "startOffset" : 168,
      "endOffset" : 495
    }, {
      "referenceID" : 0,
      "context" : "For the off-policy case, however, standard TD methods no longer maintain this contraction property, the error bounds do not hold, and these methods might even diverge (Baird, 1995). The standard error-bounds may be shown to hold for an importance-sampling TD method (IS-TD), as proposed by Precup, Sutton, and Dasgupta (2001). However, this method is known to suffer from a high variance of its importance-sampling estimator, limiting its practicality. Lately, Sutton, Mahmood, and White (2015) proposed the emphatic TD (ETD) algorithm: a modification of the TD idea, which converges off-policy (Yu, 2015), and has a reduced variance compared to IS-TD. This variance reduction is achieved by incorporating a certain decay factor over the importance-sampling ratio. However, to the best of our knowledge, there are no results that bound the bias of ETD. Thus, while ETD is assured to converge, it is not known how good its limit actually is. In this paper, we propose the ETD(λ, β) framework – a modification of the ETD(λ) algorithm, where the decay rate of the importance-sampling ratio, β, is a free parameter, and λ is the same bootstrapping parameter employed in TD(λ) and ETD(λ). By varying the decay rate, one can smoothly transition between the IS-TD algorithm, through ETD, to the standard TD algorithm. We investigate the bias of ETD(λ, β), by studying the conditions under which its underlying projected Bellman operator is a contraction. We show that the original ETD possesses a contraction property, and present the first error bounds for ETD and ETD(λ, β). In addition, our error bound reveals that the decay rate parameter balances between the bias and variance of the learning procedure. In particular, we show that selecting a decay equal to the discount factor as in the original ETD may be suboptimal in terms of the mean-squared error. The main contributions of this work are therefore a unification of several off-policy TD algorithms under the ETD(λ, β) framework, and a new error analysis that reveals the bias-variance trade-off between them. Related Work: In recent years, several different off-policy policy-evaluation algorithms have been studied, such as importance-sampling based least-squares TD (Yu, 2012), and gradient-based TD (Sutton et al., 2009; Liu et al., 2015). These algorithms are guaranteed to converge, however, their asymptotic error can be bounded only when the target and behavior policies are similar (Bertsekas and Yu, 2009), or when their induced transition matrices satisfy a certain matrix-inequality suggested by Kolter (2011), which limits the discrepancy between the target and behavior policies.",
      "startOffset" : 168,
      "endOffset" : 2578
    }, {
      "referenceID" : 9,
      "context" : "Linear temporal difference methods (Sutton and Barto, 1998) approximate the value function by V (s) ≈ θφ(s), where φ(s) ∈ R are state features, and θ ∈ R are weights, and use sampling to find a suitable θ.",
      "startOffset" : 35,
      "endOffset" : 59
    }, {
      "referenceID" : 9,
      "context" : "Linear temporal difference methods (Sutton and Barto, 1998) approximate the value function by V (s) ≈ θφ(s), where φ(s) ∈ R are state features, and θ ∈ R are weights, and use sampling to find a suitable θ. Let μ denote a behavior policy that generates the samples s0, a0, s1, a1, . . . according to at ∼ μ(·|st) and st+1 ∼ P (·|st, at). We denote by ρt the ratio π(at|st)/μ(at|st), and we assume, similarly to Sutton, Mahmood, and White (2015), that μ and π are such that ρt is well-defined1 for all t.",
      "startOffset" : 36,
      "endOffset" : 444
    }, {
      "referenceID" : 9,
      "context" : "Linear temporal difference methods (Sutton and Barto, 1998) approximate the value function by V (s) ≈ θφ(s), where φ(s) ∈ R are state features, and θ ∈ R are weights, and use sampling to find a suitable θ. Let μ denote a behavior policy that generates the samples s0, a0, s1, a1, . . . according to at ∼ μ(·|st) and st+1 ∼ P (·|st, at). We denote by ρt the ratio π(at|st)/μ(at|st), and we assume, similarly to Sutton, Mahmood, and White (2015), that μ and π are such that ρt is well-defined1 for all t. Let T denote the Bellman operator for policy π, given by T (V ) . = R+ γPV, where R and P are the reward vector and transition matrix induced by policy π, and let Φ denote a matrix whose columns are the feature vectors for all states. Let dμ and dπ denote the stationary distributions over states induced by the policies μ and π, respectively. For some d ∈ R satisfying d > 0 element-wise, we denote by Πd a projection to the subspace spanned by φ(s) with respect to the d-weighted Euclideannorm. For λ = 0, the ETD(0, β) (Sutton, Mahmood, and White, 2015) algorithm seeks to find a good approximation of the value function by iteratively updating the weight vector θ: θt+1 = θt + αFtρt(Rt+1 + γθ ⊤ t φt+1 − θ ⊤ t φt)φt Ft = βρt−1Ft−1 + 1, F0 = 1, (1) where Ft is a decaying trace of the importance-sampling ratios, and β ∈ (0, 1) controls the decay rate. Remark 1. The algorithm of Sutton, Mahmood, and White (2015) selects the decay rate equal to the discount factor, i.",
      "startOffset" : 36,
      "endOffset" : 1420
    }, {
      "referenceID" : 9,
      "context" : "Linear temporal difference methods (Sutton and Barto, 1998) approximate the value function by V (s) ≈ θφ(s), where φ(s) ∈ R are state features, and θ ∈ R are weights, and use sampling to find a suitable θ. Let μ denote a behavior policy that generates the samples s0, a0, s1, a1, . . . according to at ∼ μ(·|st) and st+1 ∼ P (·|st, at). We denote by ρt the ratio π(at|st)/μ(at|st), and we assume, similarly to Sutton, Mahmood, and White (2015), that μ and π are such that ρt is well-defined1 for all t. Let T denote the Bellman operator for policy π, given by T (V ) . = R+ γPV, where R and P are the reward vector and transition matrix induced by policy π, and let Φ denote a matrix whose columns are the feature vectors for all states. Let dμ and dπ denote the stationary distributions over states induced by the policies μ and π, respectively. For some d ∈ R satisfying d > 0 element-wise, we denote by Πd a projection to the subspace spanned by φ(s) with respect to the d-weighted Euclideannorm. For λ = 0, the ETD(0, β) (Sutton, Mahmood, and White, 2015) algorithm seeks to find a good approximation of the value function by iteratively updating the weight vector θ: θt+1 = θt + αFtρt(Rt+1 + γθ ⊤ t φt+1 − θ ⊤ t φt)φt Ft = βρt−1Ft−1 + 1, F0 = 1, (1) where Ft is a decaying trace of the importance-sampling ratios, and β ∈ (0, 1) controls the decay rate. Remark 1. The algorithm of Sutton, Mahmood, and White (2015) selects the decay rate equal to the discount factor, i.e., β = γ. Here, we provide more freedom in choosing the decay rate. As our analysis reveals, the decay rate controls a bias-variance trade-off of ETD, therefore this freedom is important. Moreover, we note that for β = 0, we obtain the standard TD in an off-policy setting Yu (2012), and when β = 1 we obtain the full importance-sampling TD algorithm Precup, Sutton, and Dasgupta (2001).",
      "startOffset" : 36,
      "endOffset" : 1759
    }, {
      "referenceID" : 9,
      "context" : "Linear temporal difference methods (Sutton and Barto, 1998) approximate the value function by V (s) ≈ θφ(s), where φ(s) ∈ R are state features, and θ ∈ R are weights, and use sampling to find a suitable θ. Let μ denote a behavior policy that generates the samples s0, a0, s1, a1, . . . according to at ∼ μ(·|st) and st+1 ∼ P (·|st, at). We denote by ρt the ratio π(at|st)/μ(at|st), and we assume, similarly to Sutton, Mahmood, and White (2015), that μ and π are such that ρt is well-defined1 for all t. Let T denote the Bellman operator for policy π, given by T (V ) . = R+ γPV, where R and P are the reward vector and transition matrix induced by policy π, and let Φ denote a matrix whose columns are the feature vectors for all states. Let dμ and dπ denote the stationary distributions over states induced by the policies μ and π, respectively. For some d ∈ R satisfying d > 0 element-wise, we denote by Πd a projection to the subspace spanned by φ(s) with respect to the d-weighted Euclideannorm. For λ = 0, the ETD(0, β) (Sutton, Mahmood, and White, 2015) algorithm seeks to find a good approximation of the value function by iteratively updating the weight vector θ: θt+1 = θt + αFtρt(Rt+1 + γθ ⊤ t φt+1 − θ ⊤ t φt)φt Ft = βρt−1Ft−1 + 1, F0 = 1, (1) where Ft is a decaying trace of the importance-sampling ratios, and β ∈ (0, 1) controls the decay rate. Remark 1. The algorithm of Sutton, Mahmood, and White (2015) selects the decay rate equal to the discount factor, i.e., β = γ. Here, we provide more freedom in choosing the decay rate. As our analysis reveals, the decay rate controls a bias-variance trade-off of ETD, therefore this freedom is important. Moreover, we note that for β = 0, we obtain the standard TD in an off-policy setting Yu (2012), and when β = 1 we obtain the full importance-sampling TD algorithm Precup, Sutton, and Dasgupta (2001). 1Namely, if μ(a|s) = 0 then π(a|s) = 0 for all s ∈ S.",
      "startOffset" : 36,
      "endOffset" : 1863
    }, {
      "referenceID" : 13,
      "context" : "(2) It can be shown (Sutton, Mahmood, and White, 2015; Yu, 2015), that ETD(0, β) converges to θ - a solution of the following projected fixed point equation: V = ΠfTV, V ∈ R .",
      "startOffset" : 20,
      "endOffset" : 64
    }, {
      "referenceID" : 1,
      "context" : "(3) For the fixed point equation (3), a contraction property of ΠfT is important for guaranteeing both a unique solution, and a bias bound (Bertsekas and Tsitsiklis, 1996).",
      "startOffset" : 139,
      "endOffset" : 171
    }, {
      "referenceID" : 1,
      "context" : "It is well known that T is a γ-contraction with respect to the dπ-weighted Euclidean norm (Bertsekas and Tsitsiklis, 1996), and by definition Πf is a non-expansion in f norm, however, it is not immediate that the composed operator ΠfT is a contraction in any norm.",
      "startOffset" : 90,
      "endOffset" : 122
    }, {
      "referenceID" : 0,
      "context" : "Indeed, for the TD(0) algorithm (Sutton and Barto 1998; corresponding to the β = 0 case in our setting), a similar representation as a projected Bellman operator holds, but it may be shown that in the off-policy setting the algorithm might diverge (Baird, 1995).",
      "startOffset" : 248,
      "endOffset" : 261
    }, {
      "referenceID" : 1,
      "context" : "Since Πf is a non-expansion in the f -weighted norm (Bertsekas and Tsitsiklis, 1996), ΠfT is a √ γ β (1 − κ)-contraction as well.",
      "startOffset" : 52,
      "endOffset" : 84
    }, {
      "referenceID" : 1,
      "context" : "In this case, the contraction modulus in Theorem 1 is γ, similar to the result for on-policy TD Bertsekas and Tsitsiklis (1996). We remark that Kolter (2011) also used a measure of discrepancy between the behavior and the target policy to bound the TD-error.",
      "startOffset" : 96,
      "endOffset" : 128
    }, {
      "referenceID" : 1,
      "context" : "In this case, the contraction modulus in Theorem 1 is γ, similar to the result for on-policy TD Bertsekas and Tsitsiklis (1996). We remark that Kolter (2011) also used a measure of discrepancy between the behavior and the target policy to bound the TD-error.",
      "startOffset" : 96,
      "endOffset" : 158
    }, {
      "referenceID" : 1,
      "context" : "In this case, the contraction modulus in Theorem 1 is γ, similar to the result for on-policy TD Bertsekas and Tsitsiklis (1996). We remark that Kolter (2011) also used a measure of discrepancy between the behavior and the target policy to bound the TD-error. However, Kolter (2011) considered the standard TD algorithm, for which a contraction could be guaranteed only for a class of behavior policies that satisfy a certain matrix inequality criterion.",
      "startOffset" : 96,
      "endOffset" : 282
    }, {
      "referenceID" : 1,
      "context" : "9 of Bertsekas and Tsitsiklis (1996): Corollary 1.",
      "startOffset" : 5,
      "endOffset" : 37
    }, {
      "referenceID" : 7,
      "context" : "Such an analysis may proceed similarly to that in Munos (2003) for the on-policy case.",
      "startOffset" : 50,
      "endOffset" : 63
    }, {
      "referenceID" : 4,
      "context" : "Consider the 2-state MDP example of Kolter (2011), with transition matrix P = (1/2)1 (where 1 is an all 1 matrix), discount factor γ = 0.",
      "startOffset" : 36,
      "endOffset" : 50
    }, {
      "referenceID" : 10,
      "context" : "This means that algorithms that converge to this fixed point, such as the GTD algorithm (Sutton et al., 2009), are hopeless in such cases.",
      "startOffset" : 88,
      "endOffset" : 109
    }, {
      "referenceID" : 4,
      "context" : "Note that, as observed by Kolter (2011), for certain behavior policies the bias of standard TD is infinite.",
      "startOffset" : 26,
      "endOffset" : 40
    }, {
      "referenceID" : 4,
      "context" : "Note that, as observed by Kolter (2011), for certain behavior policies the bias of standard TD is infinite. This means that algorithms that converge to this fixed point, such as the GTD algorithm (Sutton et al., 2009), are hopeless in such cases. The ETD algorithm, on the other hand, has a bounded bias for all behavior policies. 4 The Bias-Variance Trade-Off of ETD(0, β) From the results in Corollary 1, it is clear that increasing the decay rate β decreases the bias bound. Indeed, for the case β = 1 we obtain the importance sampling TD algorithm (Precup, Sutton, and Dasgupta, 2001), which is known to have a bias bound similar to on-policy TD. However, as recognized by Precup, Sutton, and Dasgupta (2001) and Sutton, Mahmood, and White (2015), the importance sampling ratio Ft suffers from a high variance, which increases with β.",
      "startOffset" : 26,
      "endOffset" : 713
    }, {
      "referenceID" : 4,
      "context" : "Note that, as observed by Kolter (2011), for certain behavior policies the bias of standard TD is infinite. This means that algorithms that converge to this fixed point, such as the GTD algorithm (Sutton et al., 2009), are hopeless in such cases. The ETD algorithm, on the other hand, has a bounded bias for all behavior policies. 4 The Bias-Variance Trade-Off of ETD(0, β) From the results in Corollary 1, it is clear that increasing the decay rate β decreases the bias bound. Indeed, for the case β = 1 we obtain the importance sampling TD algorithm (Precup, Sutton, and Dasgupta, 2001), which is known to have a bias bound similar to on-policy TD. However, as recognized by Precup, Sutton, and Dasgupta (2001) and Sutton, Mahmood, and White (2015), the importance sampling ratio Ft suffers from a high variance, which increases with β.",
      "startOffset" : 26,
      "endOffset" : 751
    }, {
      "referenceID" : 10,
      "context" : "Thus, algorithms that converge to the standard TD fixed point such as GTD Sutton et al. (2009) are significantly outperformed by ETD(0, β) in this case.",
      "startOffset" : 74,
      "endOffset" : 95
    }, {
      "referenceID" : 6,
      "context" : "Mahmood et al. (2015) show that, under suitable step-size conditions, ETD converges to some θ that is a solution of the projected fixed-point equation: θΦ = ΠmT (θΦ).",
      "startOffset" : 0,
      "endOffset" : 22
    }, {
      "referenceID" : 6,
      "context" : "Mahmood et al. (2015) show that, under suitable step-size conditions, ETD converges to some θ that is a solution of the projected fixed-point equation: θΦ = ΠmT (θΦ). In their analysis, however, Mahmood et al. (2015) did not show how well the solution Φθ approximates V .",
      "startOffset" : 0,
      "endOffset" : 217
    }, {
      "referenceID" : 3,
      "context" : "However, as is well-known (Bertsekas, 2012), increasing λ also increases the variance of the algorithm, and we therefore obtain a bias-variance trade-off in λ as well as β.",
      "startOffset" : 26,
      "endOffset" : 43
    }, {
      "referenceID" : 3,
      "context" : "However, as is well-known (Bertsekas, 2012), increasing λ also increases the variance of the algorithm, and we therefore obtain a bias-variance trade-off in λ as well as β. Finally, note that for β = γ, the contraction modulus equals √ γ(1−λ) 1−γλ , and that for λ = 0 the result is the same as in Theorem 1. 6 Conclusion In this work we unified several off-policy TD algorithms under the ETD(λ, β) framework, which flexibly manages the bias and variance of the algorithm by controlling the decay-rate of the importance-sampling ratio. From this perspective, we showed that several different methods proposed in the literature are special instances of this biasvariance selection. Our main contribution is an error analysis of ETD(λ, β) that quantifies the biasvariance trade-off. In particular, we showed that the recently proposed ETD algorithm of Sutton, Mahmood, and White (2015) has bounded bias for general behavior and target policies, and that by controlling the decay-rate in the ETD(λ, β) algorithm, an improved performance may be obtained by reducing the variance of the algorithm while still maintaining a reasonable bias.",
      "startOffset" : 27,
      "endOffset" : 884
    } ],
    "year" : 2015,
    "abstractText" : "We consider the off-policy evaluation problem in Markov decision processes with function approximation. We propose a generalization of the recently introduced emphatic temporal differences (ETD) algorithm (Sutton, Mahmood, and White, 2015), which encompasses the original ETD(λ), as well as several other off-policy evaluation algorithms as special cases. We call this framework ETD(λ, β), where our introduced parameter β controls the decay rate of an importancesampling term. We study conditions under which the projected fixedpoint equation underlying ETD(λ, β) involves a contraction operator, allowing us to present the first asymptotic error bounds (bias) for ETD(λ, β). Our results show that the original ETD algorithm always involves a contraction operator, and its bias is bounded. Moreover, by controlling β, our proposed generalization allows trading-off bias for variance reduction, thereby achieving a lower total error.",
    "creator" : "LaTeX with hyperref package"
  }
}