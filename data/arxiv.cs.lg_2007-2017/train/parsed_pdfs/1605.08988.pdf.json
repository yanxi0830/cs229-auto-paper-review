{
  "name" : "1605.08988.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "On Explore-Then-Commit Strategies",
    "authors" : [ "Aurélien Garivier", "Emilie Kaufmann" ],
    "emails" : [ "aurelien.garivier@math.univ-toulouse.fr", "emilie.kaufmann@inria.fr", "tor.lattimore@gmail.com" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Imagine a company wanting to optimise its daily profit by choosing between one of two possible website layouts. A natural approach is to start with a period of A/B Testing (exploration) during which the two versions are uniformly presented to users. Once the testing is complete, the company displays the version believed to generate the most profit for the rest of the day (exploitation). The time spent exploring may be chosen adaptively based on past observations, but could also be fixed in advance. Our contribution is to show that strategies of this form are much worse than if the company is allowed to dynamically select which website to display without restrictions for the whole day.\nOur analysis focusses on a simple sequential decision problem played over T time-steps. In time-step t ∈ 1, 2, . . . , T the agent chooses an action At ∈ {1, 2} and receives a normally distributed reward Zt ∼ N (µAt , 1) where µ1, µ2 ∈ R are the unknown mean rewards for actions 1 and 2 respectively.\n∗This work was partially supported by the CIMI (Centre International de Mathématiques et d’Informatique) Excellence program while Emilie Kaufmann visited Toulouse in November 2015. The authors acknowledge the support of the French Agence Nationale de la Recherche (ANR), under grants ANR-13-BS01-0005 (project SPADRO) and ANR-13-CORD-0020 (project ALICIA).\nar X\niv :1\n60 5.\n08 98\n8v 1\n[ m\nThe goal is to find a strategy π (a way of choosing each action At based on past observation) that maximises the cumulative reward over T steps in expectation, or equivalently minimises the regret\nRπµ(T ) = T max {µ1, µ2} − Eµ [ T∑ t=1 µAt ] . (1)\nThis framework is known as the multi-armed bandit problem, which has many applications and has been studied for almost a century [Thompson, 1933]. Although this setting is now quite well understood, the purpose of this article is to show that strategies based on distinct phases of exploration and exploitation are necessarily suboptimal. This is an important message because exploration followed by exploitation is the most natural approach and is often implemented in applications (including the website optimisation problem described above). Moreover, strategies of this kind have been proposed in the literature for more complicated settings [Auer and Ortner, 2010, Perchet and Rigollet, 2013, Perchet et al., 2015]. Recent progress on optimal exploration policies (e.g., by Garivier and Kaufmann [2016]) could have suggested that well-tuned variants of two-phase strategies might be near-optimal. We show, on the contrary, that optimal strategies for multi-armed bandit problems must be fully-sequential, and in particular should mix exploration and exploitation.\nWe study two settings, one when the gap ∆ = |µ1 − µ2| is known and the other when it is not. The most straight-forward strategy in the former case is to explore each action a fixed number of times n and subsequently exploit by choosing the action that appeared best while exploring. It is easy to calculate the optimal n and consequently show that this strategy suffers a regret of Rπµ(T ) ∼ 4 log(T )/∆. A more general approach is to use a so-called Explore-Then-Commit (ETC) strategy, following a nomenclature introduced by Perchet et al. [2015]. An ETC strategy explores each action alternately until some data-dependent stopping time and subsequently commits to a single action for the remaining time-steps. We show in Theorem 2 that by using a sequential probability ratio test (SPRT) it is possible to design an ETC strategy for which Rπµ(T ) ∼ log(T )/∆, which improves on the above result by a factor of 4. We also prove a lower bound showing that no ETC strategy can improve on this result. Surprisingly it is possible to do even better by using a fully sequential strategy inspired by the UCB algorithm for multi-armed bandits [Katehakis and Robbins, 1995]. We design a new strategy for which Rπµ(T ) ∼ log(T )/(2∆), which improves on the fixed-design strategy by a factor of 8 and on SPRT by a factor of 2. Again we prove a lower bound showing that no strategy can improve on this result.\nFor the case where ∆ is unknown, fixed-design strategies are hopeless because there is no reasonable tuning for the exploration budget n. However, it is possible to design an ETC strategy for unknown gaps. Our approach uses a modified fixed-budget best arm identification (BAI) algorithm in its exploration phase (see e.g., Even-Dar et al. [2006], Garivier and Kaufmann [2016]) and chooses the recommended arm for the remaining time-steps. In Theorem 5 we show that a strategy based on this idea satisfies Rπµ(T ) ∼ 4 log(T )/∆, which again we show is optimal within the class of ETC strategies. As before, strategies based on ETC are suboptimal by a factor of 2 relative to the optimal rates achieved by fully sequential strategies such as UCB, which satisfies Rπµ(T ) ∼ 2 log(T )/∆ [Katehakis and Robbins, 1995].\nIn a nutshell, strategies based on fixed-design or ETC are necessarily suboptimal. That this failure occurs even in the simple setting considered here is a strong indicator that they are suboptimal in more complicated settings. Our main contribution, presented in more details in Section 2, is to fully characterise the achievable asymptotic regret when ∆ is either known or unknown and the strategies are either fixed-design, ETC or fully sequential. All upper bounds have explicit finite-time forms, which allow us to derive optimal minimax guarantees. For the lower bounds we give a novel and generic proof of all results. All proofs contain new, original ideas that we believe are fundamental to the understanding of sequential analysis."
    }, {
      "heading" : "2 Notation and Summary of Results",
      "text" : "We assume that the horizon T is known to the agent. The optimal action is a∗ = arg max(µ1, µ2), its mean reward is µ∗ = µa∗ , and the gap between the means is ∆ = |µ1 − µ2|. LetH = R2 be the set of all possible pairs of means, andH∆ = { µ ∈ R2 : |µ1 − µ2| = ∆ } . For i ∈ {1, 2} and n ∈ N let µ̂i,n be the empirical mean of the ith action based on the first n samples. Let At be the action chosen in time-step t and Ni(t) = ∑t s=1 1 {As = i} be the number of times the ith action has been chosen after time-step t. We denote by µ̂i(t) = µ̂i,Ni(t) the empirical mean of the ith arm after time-step t.\nA strategy is denoted by π, which is a function from past actions/rewards to a distribution over the next actions. An ETC strategy is governed by a sampling rule (which determines which arm to sample at each step), a stopping rule (which specifies when to stop the exploration phase) and a decision rule indicating which arm is chosen in the exploitation phase. As we consider two-armed, Gaussian bandits with equal variances, we focus here on uniform sampling rules, which have been shown in Kaufmann et al. [2014] to be optimal in that setting. For this reason, we define an ETC strategy as a pair (τ, â), where τ is an even stopping time with respect to the filtration (Ft = σ(Z1, . . . , Zt))t and â ∈ {1, 2} is Fτ -measurable. In all the ETC strategies presented in this paper, the stopping time τ depends on the horizon T (although this is not reflected in the notation). At time t, the action\npicked by the ETC strategy is At =  1 if t ≤ τ and t is odd , 2 if t ≤ τ and t is even , â otherwise .\nThe regret for strategy π, given in Eq. (1), depends on T and µ. Assuming, for example that µ1 = µ2 + ∆, then an ETC strategy π chooses the suboptimal arm N2(T ) = τ∧T2 + (T − τ)+1 {â = 2} times, and the regret Rπµ(T ) = ∆Eµ[N2(T )] thus satisfies\n∆Eµ[(τ ∧ T )/2] ≤ Rπµ(T ) ≤ (∆/2)Eµ[τ ] + ∆T Pµ(τ ≤ T, â 6= a∗) . (2)\nWe denote the set of all ETC strategies by ΠETC. A fixed-design strategy is and ETC strategy for which there exists an integer n such that τ = 2n almost surely, and the set of all such strategies is denoted by ΠDETC. The set of all strategies is denoted by ΠALL. For S ∈ {H,H∆}, we are interested in strategies π that are uniformly efficient on S, in the sense that\n∀µ ∈ S,∀α > 0, Rπµ(T ) = o(Tα). (3)\nΠALL ΠETC ΠDETC\nH 2 4 NA H∆ 1/2 1 4 We show in this paper that any uniformly efficient strategy in Π has a regret at least equal to CΠS log(T )/|µ1 − µ2|(1− oT (1)) for every parameter µ ∈ S , where CΠS is given in the adjacent table. Furthermore, we prove that these results are tight. In each case, we propose a uniformly efficient strategy matching this bound. In addition, we prove a tight and non-asymptotic regret bound which also implies, in particular, minimax rate-optimality.\nThe paper is organised as follows. First we consider ETC and fixed-design strategies when ∆ known and unknown (Section 3). We then analyse fully sequential strategies that interleave exploration and exploitation in an optimal way (Section 4). For known ∆ we present a novel algorithm that exploits the additional information to improve the regret. For unknown ∆ we briefly recall the well-known results, but also propose a new regret analysis of the UCB* algorithm, a variant of UCB that can be traced back to Lai [1987], for which we also obtain order-optimal minimax regret. A novel, unified proof for all the lower bounds is given in Section 5. All other proofs are deferred to the appendix, which also contains some numerical experiments corroborating the theoretical results.We conclude with a short discussion on non-uniform exploration, and on models with more than 2 arms, possibly non Gaussian.\n3 Explore-Then-Commit Strategies input: T and ∆ n := ⌈ 2W ( T 2∆4/(32π) ) /∆2\n⌉ for k ∈ {1, . . . , n} do\nchoose A2k−1 = 1 and A2k = 2 end for â := arg maxi µ̂i,n for t ∈ {2n+ 1, . . . , T} do\nchoose At = â end for Algorithm 1: FB-ETC algorithm Fixed Design Strategies for Known Gaps. As a warm-up we start with the fixed-design ETC setting where ∆ is known and where the agent chooses each action n times before committing for the remainder. The optimal decision rule is obviously â = arg maxi µ̂i,n with ties broken arbitrarily. The formal description of the strategy is given in Algorithm 1, where W denotes the Lambert function implicitly defined for y > 0 by W (y) exp(W (y)) = y. We denote the regret associated to the choice of n by Rnµ(T ). The following theorem is not especially remarkable except that the bound is sufficiently refined to show certain negative lower-order terms that would otherwise not be apparent.\nTheorem 1. Let µ ∈ H∆, and let\nn =\n⌈ 2\n∆2 W\n( T 2∆4\n32π\n)⌉ . Then Rnµ(T ) ≤ 4\n∆ log\n( T∆2\n4.46\n) − 2\n∆ log log\n( T∆2\n4 √ 2π\n) + ∆\nwhenever T∆2 > 4 √ 2πe, andRnµ(T ) ≤ T∆/2+∆ otherwise. In all cases, Rnµ(T ) ≤ 2.04 √ T +∆. Furthermore, for all ε > 0, T ≥ 1 and n ≤ 4(1− ε) log(T )/∆2,\nRnµ(T ) ≥ (\n1− 2 n∆2\n)( 1− 8 log(T )\n∆2T\n) ∆T ε\n2 √ π log(T ) .\nAs Rnµ(T ) ≥ n∆, this entails that inf 1≤n≤T Rnµ(T ) ∼ 4 log(T )/∆.\nThe proof of Theorem 1 is in Appendix A. Note that the \"asymptotic lower bound\" 4 log(T )/∆ is actually not a lower bound, even up to an additive constant: Rnµ(T ) − 4 log(T )/∆ → −∞ when T →∞. Actually, the same phenomenon applies many other cases, and it should be no surprise that, in numerical experiments, some algorithm reach a regret smaller than Lai and Robbins asymptotic lower bound, as was already observed in several articles (see e.g. Garivier et al. [2016]). Also note that the term ∆ at the end of the upper bound is necessary: if ∆ is large, the problem is statistically so simple that one single observation is sufficient to identify the best arm; but that observation cannot be avoided.\nExplore-Then-Commit Strategies for Known Gaps. We now show the existence of ETC strategies that improve on the optimal fixed-design strategy. Surprisingly, the gain is significant. We describe an algorithm inspired by ideas from hypothesis testing and prove an upper bound on its regret that is minimax optimal and that asymptotically matches our lower bound.\nLet P be the law of X − Y , where X (resp. Y ) is a reward from arm 1 (resp. arm 2). As ∆ is known, the exploration phase of an ETC algorithm can be viewed as a statistical test of the hypothesis H1 : (P = N (∆, 2)) against H2 : (P = N (−∆, 2)). The work of Wald [1945] shows that a significant gain in terms of expected number of samples can be obtained by using a sequential rather than a batch test. Indeed, for a batch test, a sample size of n ∼ (4/∆2) log(1/δ) is necessary to guarantee that both type I and type II errors are upper bounded by δ. In contrast, when a random number of samples is permitted, there exists a sequential probability ratio test (SPRT) with the same guarantees that stops after a random number N of samples with expectation E[N ] ∼ log(1/δ)/∆2 under both H1 and H2. The SPRT stops when the absolute value of the log-likelihood ratio between H1 and H2 exceeds some threshold. Asymptotic upper bound on the expected number of samples used by a SPRT, as well as the (asymptotic) optimality of such procedures among the class of all sequential tests can be found in [Wald, 1945, Siegmund, 1985].\ninput: T and ∆ A1 = 1, A2 = 2, s := 2 while (s/2)∆ |µ̂1(s)− µ̂2(s)| < log ( T∆2 ) do\nchoose As+1 = 1 and As+2 = 2 s := s+ 2\nend while â := arg maxi µ̂i(s) for t ∈ {s+ 1, . . . , T} do\nchoose At = â end for\nAlgorithm 2: SPRT ETC algorithm\nAlgorithm 2 is an ETC strategy that explores each action alternately, halting when sufficient confidence is reached according to a SPRT. The threshold depends on the gap ∆ and the horizon T corresponding to a risk of δ = 1/(T∆2). The exploration phase ends at the stopping time\nτ = inf { t = 2n : ∣∣µ̂1,n−µ̂2,n∣∣ ≥ log(T∆2) n∆ } .\nIf τ < T then the empirical best arm â at time τ is played until time T . If T∆2 ≤ 1, then τ = 1 (one could even define τ = 0 and pick a random arm). The following theorem gives a non-asymptotic upper bound on the regret of the algorithm. The results rely on non-asymptotic upper bounds on the expectation of τ , which are interesting in their own right. Theorem 2. If T∆2 ≥ 1, then the regret of the SPRT-ETC algorithm is upper-bounded as\nRSPRT-ETCµ (T ) ≤ log(eT∆2)\n∆ +\n4 √ log(T∆2) + 4\n∆ + ∆ . Otherwise it is upper bounded by T∆/2+∆, and for all T and ∆ the regret is less than 10 √ T/e+∆.\nThe proof of Theorem 2 is given in Appendix B. The following lower bound shows that no uniformly efficient ETC strategy can improve on the asymptotic regret of Algorithm 2. The proof is given in Section 5 together with the other lower bounds. Theorem 3. Let π be an ETC strategy that is uniformly efficient onH∆. Then for all µ ∈ H∆,\nlim inf T→∞\nRπµ(T )\nlog(T ) ≥ 1 ∆ .\nExplore-Then-Commit Strategies for Unknown Gaps. When the gap is unknown it is not possible to tune a fixed-design strategy that achieves logarithmic regret. ETC strategies can enjoy logarithmic regret and these are now analysed. We start with the asymptotic lower bound. Theorem 4. Let π be a uniformly efficient ETC strategy onH. For all µ ∈ H, if ∆ = |µ1 − µ2| then\nlim inf T→∞\nRπµ(T )\nlog(T ) ≥ 4 ∆ .\nA simple idea for constructing an algorithm that matches the lower bound is to use a (fixed-confidence) best arm identification algorithm for the exploration phase. Given a risk parameter δ, a δ-PAC BAI algorithm consists of a sampling rule (At), a stopping rule τ and a recommendation rule â which is Fτ measurable and satisfies, for all µ ∈ H such that µ1 6= µ2, Pµ(â = a∗) ≥ 1− δ. In a bandit model with two Gaussian arms, Kaufmann et al. [2014] propose a δ-PAC algorithm using a uniform sampling rule and a stopping rule τδ that asymptotically attains the minimal sample complexity Eµ[τδ] ∼ (8/∆2) log(1/δ). Using the regret decomposition (2), it is easy to show that the ETC algorithm using the stopping rule τδ for δ = 1/T matches the lower bound of Theorem 4.\ninput: T (≥ 3) A1 = 1, A2 = 2, s := 2 while |µ̂1(s)− µ̂2(s)| < √ 8 log(T/s) s do choose As+1 = 1 and As+2 = 2 s := s+ 2 end while â := arg maxi µ̂i(s) for t ∈ {s+ 1, . . . , T} do\nchoose At = â end for\nAlgorithm 3: BAI-ETC algorithm\nAlgorithm 3 is a slight variant of this optimal BAI algorithm, based on the stopping time\nτ = inf t = 2n : |µ̂1,n − µ̂2,n|> √ 4 log ( T/(2n) ) n . The motivation for the difference (which comes from a more carefully tuned threshold featuring log(T/2n) in place of log(T )) is that the confidence level should depend on the unknown gap ∆, which determines the regret when a mis-identification occurs. The improvement only appears in the non-asymptotic regime where we are able to prove both asymptotic optimality and order-optimal minimax regret. The latter would not be possible using a fixed-confidence BAI strategy. The proof of this result can be found in Appendix C. The main difficulty is developing a sufficiently strong deviation bound, which we do in Appendix F, and that may be of independent interest. Note that a similar strategy was proposed and analysed by Lai et al. [1983], but in the continuous time framework and with asymptotic analysis only. Theorem 5. If T∆2 > 4e2, the regret of the BAI-ETC algorithm is upper bounded as\nRBAI-ETCµ (T ) ≤ 4 log\n( T∆2\n4 ) ∆ + 334 √ log ( T∆2 4 ) ∆ + 178 ∆ + ∆.\nIt is upper bounded by T∆ otherwise, and by 32 √ T + ∆ in any case."
    }, {
      "heading" : "4 Fully Sequential Strategies for Known and Unknown Gaps",
      "text" : "In the previous section we saw that allowing a random stopping time leads to a factor of 4 improvement in terms of the asymptotic regret relative to the naive fixed-design strategy. We now turn our attention to fully sequential strategies when ∆ is known and unknown. The latter case is the classic 2-armed bandit problem and is now quite well understood. Our modest contribution in that case is the first algorithm that is simultaneously asymptotically optimal and order optimal in the minimax sense. For\nthe former case, we are not aware of any previous research where the gap is known except the line of work by Bubeck et al. [2013], Bubeck and Liu [2013], where different questions are treated. In both cases we see that fully sequential strategies improve on the best ETC strategies by a factor of 2.\nKnown Gaps. We start by stating the lower bound (proved in Section 5), which is a straightforward generalisation of Lai and Robbins’ lower bound.\nTheorem 6. Let π be a strategy that is uniformly efficient onH∆. Then for all µ ∈ H∆,\nlim inf T→∞\nRπµ(T )\nlog T ≥ 1 2∆\nWe are not aware of any existing algorithm matching this lower bound, which motivates us to introduce a new strategy called ∆-UCB that exploits the knowledge of ∆ to improve the performance of UCB. In each round the algorithm chooses the arm that has been played most often so far unless the other arm has an upper confidence bound that is close to ∆ larger than the empirical estimate of the most played arm. Like ETC strategies, ∆-UCB is not anytime in the sense that it requires the knowledge of both the horizon T and the gap ∆.\n1: input: T and ∆ 2: εT = ∆ log\n− 18 (e+ T∆2)/4 3: for t ∈ {1, . . . , T} do 4: let At,min := arg min\ni∈1,2 Ni(t− 1) and At,max = 3−At,min\n5: if µ̂At,min(t− 1) + √√√√2 log ( TNAt,min (t−1)) NAt,min(t− 1) ≥ µ̂At,max(t− 1) + ∆− 2εT then 6: choose At = At,min 7: else 8: choose At = At,max 9: end if\n10: end for Algorithm 4: ∆-UCB\nTheorem 7. If T (2∆ − 3εT )2 ≥ 2 and Tε2T ≥ e2, the regret of the ∆-UCB algorithm is upper bounded as\nR∆-UCBµ (T ) ≤ log ( 2T∆2 ) 2∆(1− 3εT /(2∆))2 + √ π log (2T∆2) 2∆(1− 3εT /∆)2\n+ ∆\n[ 30e √\nlog(ε2TT ) ε2T + 80 ε2T +\n2\n(2∆− 3εT )2\n] + 5∆.\nMoreover lim supT→∞R ∆-UCB µ (T )/ log(T ) ≤ (2∆)−1 and ∀µ ∈ H∆, R∆-UCBµ (T ) ≤ 328\n√ T + 5∆.\nThe proof may be found in Appendix D.\nUnknown Gaps. In the classical bandit setting where ∆ is unknown, UCB by Katehakis and Robbins [1995] is known to be asymptotically optimal: RUCBµ (T ) ∼ 2 log(T )/∆, which matches the lower bound of Lai and Robbins [1985]. Non-asymptotic regret bounds are given for example by Auer et al. [2002], Cappé et al. [2013]. Unfortunately, UCB is not optimal in the minimax sense, which is so far only achieved by algorithms that are not asymptotically optimal [Audibert and Bubeck, 2009, Lattimore, 2015]. Here, with only two arms, we are able to show that Algorithm 5 below is simultaneously minimax order-optimal and asymptotically optimal. The strategy is essentially the same as suggested by Lai [1987], but with a fractionally smaller confidence bound. The proof of Theorem 8 is given in Appendix E. Empirically the smaller confidence bonus used by UCB∗ leads to a significant improvement relative to UCB.\n1: input: T 2: for t ∈ {1, . . . , T} do\n3: At = arg max i∈{1,2} µ̂i(t− 1) +\n√ 2\nNi(t− 1) log\n( T\nNi(t− 1) ) 4: end for\nAlgorithm 5: UCB∗\nTheorem 8. For all ε ∈ (0,∆), if T (∆− ε)2 ≥ 2 and Tε2 ≥ e2, the regret of the UCB∗ strategy is upper bounded as\nRUCB ∗ µ (T ) ≤ 2 log\n( T∆2\n2 ) ∆ ( 1− ε∆ )2 + 2 √ π log ( T∆2 2 ) ∆ ( 1− ε∆ )2 + ∆ ( 30e √ log(ε2T ) + 16e ε2 ) +\n2 ∆ ( 1− ε∆ )2 + ∆. Moreover, lim supT→∞R π µ(T )/ log(T ) = 2/∆ and for all µ ∈ H, Rπµ(T ) ≤ 33 √ T + ∆.\nNote that if there are K > 2 arms, then the strategy above is still asymptotically optimal, but suffers a minimax regret of Ω( √ TK log(K)), which is a factor of √ log(K) suboptimal."
    }, {
      "heading" : "5 Proof of the Lower Bounds (Theorems 3, 4, 6 and Lai&Robbins)",
      "text" : "Let π be a uniformly efficient strategy on some class S, as defined in (3), and let λ ∈ H. If m(λ) = arg min{λ1, λ2}, as Eλ[Rπµ(T )] = |λ1 − λ2|Eλ[Nm(λ)(T )] this implies in particular that\n∀α ∈]0, 1], Eλ[Nm(λ)(T )] = o(Tα).\nWithout loss of generality we assume that µ1 = µ2 + ∆ with ∆ > 0. All the lower bounds are based on a change of measure argument, which involves considering an alternative reward vector (µ′1, µ ′ 2) that is “not too far” from (µ1, µ2), but for which the expected behaviour of the algorithm is very different. This is the same approach used by Lai and Robbins [1985], but rewritten and generalised in a more powerful way (in particular regarding the ETC strategies). The improvements come thanks to Inequality 4 in [Garivier et al., 2016], which states that for every (µ′1, µ ′ 2) ∈ H and for every stopping time σ such that N2(T ) is Fσ-measurable,\nEµ [ N1(σ) ] (µ′1 − µ1)2 2 + Eµ [ N2(σ) ] (µ′2 − µ2)2 2 ≥ kl ( Eµ [ N2(T ) T ] , Eµ′ [ N2(T ) T ]) ,\nwhere kl(p, q) is the relative entropy between Bernoulli distributions with parameters p, q ∈ [0, 1] respectively. Since kl(p, q) ≥ (1− p) log(1/(1− q))− log(2) for all p, q ∈ (0, 1), one obtains\nEµ [ N1(σ) ] (µ′1 − µ1)2 2 + Eµ [ N2(σ) ] (µ′2 − µ2)2 2\n≥ (\n1− Eµ[N2(T )] T\n) log ( T\nEµ′ [N1(T )]\n) − log(2) . (4)\nFor µ′ ∈ S such that µ′1 < µ′2, Eµ[N2(T )] = o(Tα) and Eµ′ [N1(T )] = o(Tα) for all α ∈]0, 1], thus\nlim inf T→∞\nEµ [ N1(σ) ] (µ′1 − µ1)2/2 + Eµ [ N2(σ) ] (µ′2 − µ2)2/2\nlog T ≥ 1 .\nLet us now draw the conclusions in each setting.\nKnown gap, General strategy: S = H∆. By choosing σ = T , µ′1 = µ1 and µ ′ 2 = µ1 + ∆ = µ2 + 2∆, we obtain\nlim inf T→∞\nEµ [ N2(T ) ] log T ≥ 1 (2∆)2/2 .\nUnknown gap, General strategy: S = H. We use the same choices, except µ′2 = µ1 + ε for some ε > 0:\nlim inf T→∞\nEµ [ N2(T ) ] log T ≥ 1 (∆ + ε) 2 /2 .\nKnown gap, ETC strategy: S = H∆. For an ETC strategy π with a stopping rule τ , one hasN1(τ∧T ) = N2(τ ∧ T ) = (τ ∧ T )/2. Besides, N2(T ) is indeed Fτ∧T -measurable: after τ ∧T draws, the agent knows whether she will draw arm 2 for the last T − τ ∧ T steps or not. With µ′1 = µ2, µ ′ 2 = µ1, Inequality (4) thus yields:\nlim inf T→∞\nEµ [ τ∧T\n2 ] log T ≥ 1 2∆2/2 .\nUnknown gap, ETC strategy: S = H. Choosing this time µ′1 = (µ1 + µ2 − ε)/2 and µ′2 = (µ1 + µ2 + ε)/2, for some ε > 0 yields\nlim inf T→∞\nEµ [ τ∧T\n2 ] log T ≥ 1( ∆+ε\n2\n)2 .\nRπµ(T ) = ∆Eµ[N2(T )] for general strategies, while Equation (2) shows that Rπµ(T ) ≥ ∆Eµ[(τ ∧ T )/2] for ETC strategies. Therefore letting ε go to zero when needed shows that\nlim inf T→∞\nRπµ(T )\nlog(T ) ≥ C\nΠ S\n∆ , for the value CΠS given at the end of Section 2.\nNote that the asymptotic lower bound of Theorem 1 can also be proved by similar arguments, if one really wants to bring in an elephant to kill a mouse. Moreover, note that this proof may also lead to (not-so-simple) non-asymptotic lower-bounds, as shown in Garivier et al. [2016] for example."
    }, {
      "heading" : "6 Beyond Uniform Exploration, Two Arms and Gaussian distributions",
      "text" : "It is worth emphasising the impossibility of non-trivial lower bounds on the regret of ETC strategies using any possible (non-uniform) sampling rule. Indeed, using UCB as a sampling rule together with an a.s. infinite stopping rule defines an artificial but formally valid ETC strategy that achieves the best possible rate for general strategies. This strategy is not a faithful counter-example to our claim that ETC strategies are sub-optimal, because UCB is not a satisfying exploration rule. If exploration is the objective, then uniform sampling is known to be optimal in the two-armed Gaussian case [Kaufmann et al., 2014], which justifies the uniform sampling assumption.\nThe use of ETC strategies for regret minimisation (e.g., as presented by Perchet and Rigollet [2013]) is certainly not limited to bandit models with 2 arms. The extension to multiple arms is based on the successive elimination idea in which a set of active arms is maintained with arms chosen according to a round robin within the active set. Arms are eliminated from the active set once their optimality becomes implausible and the exploration phase terminates when the active set contains only a single arm (an example is by Auer and Ortner [2010]). The Successive Elimination algorithm has been introduced by Even-Dar et al. [2006] for best-arm identification in the fixed-confidence setting. But as shown in Garivier and Kaufmann [2016], Successive Elimination is suboptimal for the best arm identification task in almost all settings except two-armed Gaussian bandits. It is therefore interesting to investigate the performance in terms of regret of an ETC algorithm using an optimal BAI algorithm. This is actually possible not only for Gaussian distributions, but more generally for one-parameter exponential families, for which Garivier and Kaufmann [2016] propose the asymptotically optimal Track-and-Stop strategy. Denoting d(µ, µ′) = KL(νµ, νµ′) the Kullback-Leibler divergence between two distributions parameterised by µ and µ′, they provide results which can be adapted to obtain the following bound.\nProposition 1. For µ such that µ1 > maxa6=1 µa, the regret of the ETC strategy using Track-and-Stop exploration with risk 1/T satisfies\nlim sup T→∞\nRTaSµ (T )\nlog T ≤ T ∗(µ) ( K∑ a=2 w∗a(µ)(µ1 − µa) ) ,\nwhere T ∗(µ) (resp. w∗(µ)) is the the maximum (resp. maximiser) of the optimisation problem\nmax w∈ΣK inf a6=1\n[ w1d ( µ1,\nw1µ1 + waµa w1 + wa\n) + wad ( µa,\nwaµ1 + waµa w1 + wa\n)] ,\nwhere ΣK is the set of probability distributions on {1, . . . ,K}.\nIn general, it is not easy to quantify the difference to the lower bound of Lai and Robbins\nlim inf T→∞\nRπµ(T )\nlog T ≥ K∑ a=2 µ1 − µa d(µa, µ1) .\nEven for Gaussian distributions, there is no general closed-form formula for T ∗(µ) and w∗(µ) except when K = 2. However, we conjecture that the worst case is when µ1 and µ2 are much larger than the other means: then, the regret is almost the same as in the 2-arm case, and ETC strategies are suboptimal by a factor 2. On the other hand, the most favourable case (in terms of relative efficiency) seems to be when µ2 = · · · = µK : then\nw∗1(µ) =\n√ K − 1\nK − 1 + √ K − 1\n, w∗2(µ) = · · · = w∗K(µ) = 1\nK − 1 + √ K − 1\nand T ∗ = 2( √ K − 1 + 1)2/∆2, leading to\nlim sup T→∞\nRTaSµ (T ) log(T ) ≤ ( 1 + 1√ K − 1 ) 2(K − 1) ∆ ,\nwhile Lai and Robbins’ lower bound yields 2(K − 1)/∆. Thus, the difference grows with K as 2 √ K − 1 log(T )/∆ , but the relative difference decreases."
    }, {
      "heading" : "A Proof of Theorem 1",
      "text" : "Let n ≤ T/2. The number of draws of the suboptimal arm 2 is N2 = n + (T − 2n)1{Sn ≤ 0}, where Sn = (X1 − Y1) + · · ·+ (Xn − Yn) ∼ N (n∆, 2n). The expected regret of the strategy using 2n exploration steps is\nRnµ(T ) = ∆Eµ[N2] = ∆ ( n+ (T − 2n)Pµ(Sn ≤ 0) ) . (5)\nBut\nPµ(Sn ≤ 0) = Pµ ( Sn − n∆√\n2n ≤ −n∆√ 2n = −∆\n√ n\n2\n) .\nDenote by Φ (resp. φ) the pdf (resp. cdf) of the standard Gaussian distribution, and recall thatW is the Lambert function defined for all y > 0 by W (y) exp(W (y)) = y. The regret is thus upper-bounded as Rnµ(T ) ≤ ∆g(n) where, for all x > 0, g(x) = x+ TΦ(−∆ √ x/2). By differentiating g, one can see that its maximum is reached at x∗ such that\nφ ( ∆ √ x∗\n2\n) = ∆ √ x∗/2\nT∆2/4 , and thus x∗ =\n2\n∆2 W\n( T 2∆4\n32π\n) .\nBy choosing n = dx∗e, we obtain\nRnµ(T ) ≤ 2\n∆ W\n( T 2∆4\n32π\n) + ∆ + ∆TΦ ( −∆ √ x∗\n2\n) .\nAs g(n) ≤ g(x∗) + 1 ≤ g(0) + 1 = T/2 + 1, Rnµ(T ) ≤ (T/2 + 1)∆ ≤ 2.04 √ T + ∆ for T∆2 ≤ 4 √ 2πe. If T∆2 ≥ 4 √ 2πe, the inequality W (y) ≤ log ( (1 + e−1)y/ log(y) ) valid for all y ≥ e (see Hoorfar and Hassani [2008]) entails\nW\n( T 2∆4\n32π\n) ≤ log ( (1 + e−1)T 2∆4 32π\nlog ( T 2∆4\n32π\n) ) = 2 log 18 √ 1 + e−1 π\nT∆2√ log ( T∆2\n4 √ 2π\n) \nIn addition, the classic bound on the Gaussian tail Φ(−y) ≤ φ(y)/y yields by definition of x∗:\nΦ ( −∆ √ x∗\n2\n) ≤ φ ( −∆ √ x∗ 2 ) ∆ √ x∗\n2\n= 4\nT∆2 .\nHence, for T∆2 ≥ 4 √ 2πe,\nRnµ(T ) ≤ 4\n∆ log e8 √ 1 + e−1 π\nT∆2√ log ( T∆2\n4 √ 2π\n) + ∆ < 4∆ log  T∆2 4.46 √ log ( T∆2\n4 √ 2π\n) + ∆ .\nTo complete the proof of the uniform upper-bound, we start from\nRnµ(T ) ≤ 2\n∆ W\n( T 2∆4\n32π\n) + 4\n∆ + ∆ .\nDenoting by r ≈ 1.09 the root of (4r − 1)W (r) = 2, the maximum of 2W ( T 2∆4\n32π\n) /∆ + 4/∆ is\nreached at ∆ = ( 32πr/T 2 )1/4 , and is equal to\n2 ∆ W\n( T 2∆4\n32π\n) + 4\n∆ =\n8r3/4 (4r − 1)(2π)1/4 √ T < 2 √ T .\nLet us now prove that choosing n too small leads to catastrophic regret. If n ≤ 4(1− ε) log(T )/∆2, then Equation (5) yields\nPµ(Sn ≤ 0) ≥ 1\n∆ √ πn\n( 1− 2\nn∆2\n) exp ( −∆ 2n\n4 ) ≥ (\n1− 2 n∆2\n) 1\n2 √ π(1− ε) log(T )\nexp ( − (1− ε) log(T ) ) ≥ (\n1− 2 n∆2\n) T ε−1\n2 √ π log(T ) .\nThus, the expected regret is lower-bounded as Rnµ(T ) ≥ ∆(T − 2n)Pµ(Sn ≤ 0) ≥ ∆ (\n1− 2 n∆2\n)( 1− 8 log(T )\n∆2T\n) T ε\n2 √ π log(T ) .\nLet us now turn to the last statement of the theorem. The previous inequality shows that for all ε > 0,\nlim inf T inf 3\n∆2 <n≤ 4(1−ε) log(T ) ∆2\nRnµ(T ) log(T ) = +∞ .\nFor n ≤ 3/∆2, we have that\nPµ(Sn ≤ 0) ≥ Pµ\n( Sn − n∆√\n2n ≤ −\n√ 3\n2\n) > 0 ,\nand hence that lim infT infn≤3/∆2 Rnµ(T )/T > 0. As R n µ(T ) ≥ n∆, the result follows."
    }, {
      "heading" : "B Proof of Theorem 2",
      "text" : "Recall that µ1 > µ2. Using (2), one has\nRπµ(T ) ≤ ∆Eµ [τ\n2\n] + T∆Pµ(τ < T, â = 2) .\nIf T∆2 ≤ 1, then τ = 2 and â is based on a single sample from each action. Therefore â = 2 with probability less than 1/2 and the regret is upper-bounded by ∆ + T∆/2. Otherwise, let S0 = 0, Sn = (X1−Y1)+ · · ·+(Xn−Yn) for every n ≥ 1. For every u > 0, let nu = (log(T∆2)+u)/∆2. Observe that {τ\n2 ≥ ⌈ log(T∆2) + u ∆2 ⌉} ⊂ { Sdnue ≤ log(T∆2) ∆ } .\nMoreover, if nu ∈ N then Snu ∼ N (nu∆, 2nu) and\nPµ ( Snu ≤ log(T∆2)\n∆\n) = Pµ ( Snu − nu∆√\n2nu ≤ log(T∆ 2)/∆−∆(log(T∆2) + u)/∆2√ 2(log(T∆2) + u)/∆2\n)\n= Pµ\n( Snu − nu∆√\n2nu ≤ −u√ 2(log(T∆2) + u)\n) ≤ exp ( − u 2\n4 ( log(T∆2) + u )) .\nHence, for a = 2 √\nlog(T∆2),∫ ∞ na Pµ (τ 2 − 1 ≥ v ) dv = ∫ ∞ a Pµ ( τ 2 − 1 ≥ log(T∆ 2) + u ∆2 ) du ∆2\n≤ ∫ ∞ a Pµ ( τ 2 ≥ ⌈ log(T∆2) + u ∆2 )⌉ du ∆2\n≤ 1 ∆2 ∫ ∞ a exp ( − u 2 4 ( log(T∆2) + u )) du\n≤ 1 ∆2 ∫ ∞ a exp ( − u 2 √ log(T∆2) + 4 ) du as log(T∆2) ≤ u √ log(∆2T )/2\n≤ 1 ∆2 ∫ ∞ 0 exp ( − u 2 √ log(T∆2) + 4 ) du\n= 2 √ log(T∆2) + 4\n∆2 ,\nand Eµ [τ\n2\n] ≤ 1 + na + ∫ ∞ na Pµ (τ 2 − 1 ≥ v ) dv ≤ 1 + log(T∆2) + 4 √ log(T∆2) + 4 ∆2 .\nTo conclude the proof of the first statement, it remains to show that P(τ < T, â = 2) ≤ 1/(T∆2). Since X1 − Y1 ∼ N (∆, 2), Eµ[exp(−∆(X1 − Y1))] = exp(−∆2 + 2∆2/2) = 1 and Mn = exp(−∆Sn) is a martingale. Let τ2 = T ∧ inf{n ≥ 1 : Sn ≤ − log(T∆2)/∆}, and observe that{\nτ < T, â = 2 } ⊂ { ∃n < T : Sn ≤ − log(T∆2)\n∆\n} = { τ2 < T } .\nDoob’s optional stopping theorem yields Eµ[Mτ2 ] = Eµ[M0] = 1. But as Mτ2 = exp(−∆Sτ2) ≥ exp(∆ log(T∆2)/∆) = T∆2 on the event {τ2 < T},\nPµ(τ < T, â = 2) ≤ Pµ(τ2 < T ) ≥ Eµ [ 1{τ2 < T}\nMτ2 T∆2\n] ≤ Eµ [ Mτ2 ] T∆2 = 1 T∆2 .\nThe last statement Theorem 2 is obtained by maximising the bound (except for the ∆ summand). Let u = 1/(∆ √ T ) and f(u) = −u log(u/ √ e) + 2u √ − log(u). Denoting ` = − log(u), f ′(u) = `− 1/2+2 √ `−1/ √ ` = ( √ `+2)(`−1/2)/ √ `, thus the maximum is reached at ` = log ( ∆ √ T ) = 1/2\nand ∆ = √ e/T . Re-injecting this value into the bound, we obtain that for every ∆ > 0,\nRSPRT-ETCµ (T ) ≤ 2 + 4 √ 1 + 4√\ne/T = 10\n√ T\ne ."
    }, {
      "heading" : "C Proof of Theorem 5",
      "text" : "Recall that µ1 = µ2 + ∆ with ∆ > 0. Let Ws = (Xs−Ys−∆)/ √\n2, which means that W1,W2, . . . are i.i.d. standard Gaussian random variables. Introducing F = (â 6= 1, τ < T ), one has by (2) that\nRBAI-ETCµ (T ) ≤ T∆Pµ(F) + ∆Eµ[τ ]. From the definition of τ and Lemma 1.(c) in Appendix F, assuming that T∆2 ≥ 4e2, one obtains\nPµ (F) ≤ Pµ ( ∃s : 2s ≤ T, µ̂1,s − µ̂2,s ≤ − √ 4\ns log\n( T\n2s\n))\n= Pµ ( ∃s ≤ T/2 : ∑s i=1Wi s ≤ − √ 2 s log ( T/2 s ) − ∆√\n2\n)\n≤ 120e\n√ log(∆2T/4)\n∆2T +\n64e\n∆2T .\nThe last step is bounding Eµ[τ ] for which as T∆2 ≥ 4, Lemma 1.(b) yields\nEµ[τ ] ≤ T∑ s=1 Pµ (τ ≥ s) ≤ T∑ s=1 Pµ (∑s i=1Wi s ≤ √ 2 s log ( T/2 s ) − ∆√ 2 )\n≤ 4 log\n( T∆2\n4 ) ∆2 + 4 √ π log ( T∆2 4 ) ∆2 + 4 ∆2 + 1 ,\nTherefore, if T∆2 ≥ 4e2,\nRBAI-ETCµ (T ) ≤ 4 log\n( T∆2\n4 ) ∆ + 4 √ π log ( T∆2 4 ) ∆ + 4 ∆ + ∆ + 120e √ log ( ∆2T 4 ) ∆ + 64e ∆\n≤ 4 log\n( T∆2\n4 ) ∆ + 334 √ log ( T∆2 4 ) ∆ + 178 ∆ + ∆.\nTaking the limit as T → ∞ shows that lim supT→∞RBAI-ETCµ (T )/ log(T ) ≤ 4. Noting that RBAI-ETCµ (T ) ≤ ∆T and taking the minimum of this bound and the finite-time bound given above leads arduously to RBAI-ETCµ (T ) ≤ ∆ + 32 √ T for all µ."
    }, {
      "heading" : "D Proof of Theorem 7",
      "text" : "Define random time τ = max {τ1, τ2} where τi is given by\nτi = min\n{ t ≤ T : sup\ns≥t |µ̂i,s − µi| < εT\n} .\nBy the concentration Lemma 1.(a) in Appendix F we have Eµ[τi] ≤ 1 + 9/ε2T and so Eµ[τ ] ≤ Eµ[τ1 + τ2] ≤ 2 + 18/ε2T . For t > 2τ we have |µ̂At,max(t − 1) − µAt,max | < εT . Therefore the expected number of draws of the suboptimal arm may be bounded by\nEµ[N2(T )] = Eµ [ T∑ t=1 1 {It = 2} ] ≤ Eµ[2τ ] + Eµ [ T∑ t=2τ+1 1 {It = 2} ]\n≤ Eµ[2τ ] + Eµ [ T∑ t=1 1 { µ̂2(t− 1) + √ 2 log(T/N2(t− 1)) N2(t− 1) ≥ µ1 + ∆− 3εT and It = 2 }]\n+ Eµ [ T∑ t=1 1 { µ̂1(t− 1) + √ 2 log(T/N1(t− 1)) N1(t− 1) ≤ µ2 + ∆− εT = µ1 − εT }] (6)\nBy Lemma 1.(b), whenever T (2∆− 3εT )2 ≥ 2,\nEµ [ T∑ t=1 1 { µ̂2(t− 1) + √ 2 log(T/N2(t− 1)) N2(t− 1) ≥ µ1 + ∆− 3εT = µ2 + 2∆− 3εT and It = 2 }]\n≤ T∑ s=1 Pµ\n( µ̂2,s − µ2 + √ 2 log(T/s)\ns ≥ 2∆− 3εT\n)\n≤ 2 log\n( T (2∆−3εT )2\n2 ) (2∆− 3εT )2 + 2 √ π log ( T (2∆−3εT )2 2 ) (2∆− 3εT )2 + 2 (2∆− 3εT )2 + 1\nFor the second term in (6) we apply Lemma 1.(c) to obtain, whenever Tε2T ≥ e2,\nEµ [ T∑ t=1 1 { µ̂1(t− 1) + √ 2 log(T/N1(t− 1)) N1(t− 1) ≤ µ1 − εT }]\n≤ TPµ ( ∃s ∈ N : µ̂1,s + √ 2\ns log(T/s) ≤ µ1 − εT\n) ≤ 30e √ log(ε2TT )\nε2T +\n16e ε2T .\nTherefore, if T (2∆− 3εT )2 ≥ 2 and Tε2T ≥ e2,\nEµ[N2(T )] ≤ 2 log\n( T (2∆−3εT )2\n2 ) (2∆− 3εT )2 + 2 √ π log ( T (2∆−3εT )2 2 ) (2∆− 3εT )2 + 30e √ log(ε2TT ) ε2T\n+ 80\nε2T +\n2\n(2∆− 3εT )2 + 5.\nThe first result follows since the regret is R∆-UCBµ (T ) = ∆Eµ[N2(T )]. For the second it easily noted that for the choice of εT given in the definition of the algorithm that lim supT→∞ Eµ[N2(T )]/ log(T ) ≤ 1/(2∆2). Therefore lim supT→∞R∆-UCBµ (T )/ log(T ) ≤ 1/(2∆). The third result follows from a laborious optimisation step to upper-bound the minimum of T∆ and the finite-time regret bound above."
    }, {
      "heading" : "E Proof of Theorem 8",
      "text" : "For any ε ∈ (0,∆) we have\nEµ[N2(T )] = Eµ [ T∑ t=1 1 {At = 2} ]\n≤ Eµ [ T∑ t=1 1 { At = 2 and µ̂2(t− 1) + √ 2 N2(t− 1) log ( T N2(t− 1) ) ≥ µ1 − ε }]\n+ TPµ ( ∃s : µ̂1,s + √ 2\ns log\n( T\ns\n) ≤ µ1 − ε ) .\nBy the concentration Lemma 1.(b) in Appendix F we have, whenever T (∆− ε)2 ≥ 2,\nEµ [ T∑ t=1 1 { At = 2 and µ̂2(t− 1) + √ 2 N2(t− 1) log ( T N2(t− 1) ) ≥ µ1 − ε }]\n≤ T∑ s=1 Pµ\n( µ̂2,s − µ2 + √ 2\ns log\n( T\ns\n) ≥ ∆− ε )\n≤ 2 log\n( T (∆−ε)2\n2 ) (∆− ε)2 + 2 √ π log ( T (∆−ε)2 2 ) (∆− ε)2 + 2 (∆− ε)2 + 1\nFor the second term we apply Lemma 1.(c) to obtain, whenever Tε2 ≥ e2,\nTPµ ( ∃s : µ̂1,s + √ 2\ns log\n( T\ns\n) ≤ µ1 − ε ) ≤ 30e √ log(ε2T )\nε2 +\n16e\nε2 .\nFinally, if T (∆− ε)2 ≥ 2 and Tε2 ≥ e2,\nRUCBµ (T ) ≤ ∆Eµ[N2(T )]\n≤ 2 log\n( T (∆−ε)2\n2 ) ∆ (1− ε/∆)2 + 2 √ π log ( T (∆−ε)2 2 ) ∆ (1− ε/∆)2 + 2 ∆ (1− ε/∆)2 + ∆ + ∆ ( 30e √ log(ε2T ) ε2 + 16e ε2 )\nThe asymptotic result follows by taking the limit as T tends to infinity and choosing ε = log− 1 8 (T ) while the minimax result follows by finding the minimum of the finite-time bound given above and the naive RUCBµ (T ) ≤ T∆."
    }, {
      "heading" : "F Deviation Inequalities",
      "text" : "As was already the case in the proof of Theorem 1, we heavily rely on the following well-known inequality on the tail of a Gaussian distribution: if X ∼ N (0, 1), then for all x > 0\nP (X ≥ x) ≤ min { 1, 1\nx √ 2π\n} exp ( −x2/2 ) .\nLemma 1 gathers some more specific results that are useful in our regret analyses, and that we believe to be of a certain interest on their own. Lemma 1. Let ε > 0 and ∆ > 0 and W1,W2, . . . be standard i.i.d. Gaussian random variables and µ̂t = ∑t s=1Ws/t. Then the following hold:\n(a). E [ min { t : sup\ns≥t |µ̂s| ≥ ε\n}] ≤ 1 + 9/ε2\n(b). if T∆2 ≥ 2 then T∑ n=1 P\n( µ̂n + √ 2\nn log\n( T\nn\n) ≥ ∆ ) ≤ 2 log ( T∆2 2 ) ∆2 + 2 √ π log ( T∆2 2 ) ∆2 + 2 ∆2 + 1\n(c). if Tε2 ≥ e2 then P ( ∃s ∈ N : µ̂s + √ 2\ns log\n( T\ns\n) + ε ≤ 0 ) ≤ 30e √ log(ε2T )\nε2T +\n16e\nε2T\nThe proof of Lemma 1 follows from standard peeling techniques and inequalities for Gaussian sums of random variables. So far we do not know if this statement holds for subgaussian random variables where slightly weaker results may be shown by adding log log terms to the confidence interval, but unfortunately by doing this one sacrifices minimax optimality.\nProof of Lemma 1.(a). We use a standard peeling argument and the maximal inequality.\nP (∃s ≥ t : |µ̂s| ≥ ε) ≤ ∞∑ k=1 P (∃s ∈ [kt, (k + 1)t] : |µ̂s| ≥ ε)\n≤ ∞∑ k=1 P (∃s ≤ (k + 1)t : |sµ̂s| ≥ ktε)\n≤ ∞∑ k=1 2 exp ( − (ktε) 2 2(k + 1)t ) = ∞∑ k=1 2 exp ( − ktε 2 2 (1 + 1/k) )\n≤ ∞∑ k=1 2 exp ( −ktε 2 4 )\nTherefore E[τ ] ≤ 1 + ∞∑ t=1 P (τ ≥ t) ≤ 1 + ∞∑ t=1 min { 1, 2 ∞∑ k=1 exp ( −ktε 2 4 )}\n= 1 + ∞∑ t=1 min { 1,\n2\nexp (tε2/4)− 1\n} ≤ 1 + ∫ ∞ 0 min { 1,\n2\nexp (tε2/4)− 1\n} dt\n≤ 1 + 4 log(4) ε2 + ∫ ∞ 4/ε2 log(4)\n8\n3 exp (tε2/4) dt = 1 +\n4 log(4)\nε2 +\n8 3ε2 ≤ 1 + 9 ε2 .\nProof of Lemma 1.(b). Let ν be the solution of √ 2 log(T/n)/n = ∆, that is ν = 2W ( ∆2T/2 ) /∆2. Then T∑ n=1 P ( µ̂n + √ 2 n log ( T n ) ≥ ∆ ) ≤ ν + T∑ n=dνe P ( µ̂n ≥ ∆− √ 2 n log ( T n )) .\nAs for all n ≥ ν 2\nn log\nT n ≤ 2 ν log\n( T\nν\n) ν\nn = ∆2\nν n ,\nT∑ n=dνe P\n( µ̂n ≥ ∆− √ 2\nn log\n( T\nn\n)) ≤\n∞∑ n=dνe P ( µ̂n ≥ ∆ ( 1− √ ν n ))\n≤ ∞∑\nn=dνe\nexp ( −n∆ 2\n2\n( 1− √ ν\nn\n)2)\n= ∞∑ n=dνe exp ( −∆ 2 2 (√ n− √ ν )2)\n≤ 1 + ∫ ∞ ν exp ( −∆ 2 2 (√ x− √ ν )2) dx\n= 1 + 2\n∆ ∫ ∞ 0 ( y ∆ + √ ν ) exp ( −y 2 2 ) dy\n= 1 + 2\n∆2 +\n√ 2πν\n∆ .\nHence, as ν ≤ 2 log(∆2T/2)/∆2 whenever T∆2 ≥ 2, T∑ n=1 P ( µ̂n + √ 2 n log ( T n ) ≥ ∆ ) ≤ 2 ∆2 ( log ( T∆2 2 ) + 1 + √ π log ( T∆2 2 )) + 1 .\nProof of Lemma 1.(c). Let x > 0 and n ∈ N, then by the reflection principle (eg., Mörters and Peres [2010]) it holds that\nP (∃s ≤ n : sµ̂s + x ≤ 0) = 2P (nµ̂n + x ≤ 0) ≤ 2 min { 1\nx\n√ n\n2π , 1\n} exp ( −x 2\n2n\n) (7)\nWe prepare to use the peeling technique with a carefully chosen grid. Let\nη = log(ε2T )\nlog(ε2T )− 1 and Gk = [ηk, ηk+1[ .\nAs Tε2 > e2, one has η ∈]1, 2[. Moreover, our choice of η leads to the following inequality, that will be useful in the sequel\n∀x ≥ ε−2, (x/T ) 1 η ≤ e (x/T ) (8)\nUsing a union bound and then Eq. (7), one can write\nP ( ∃s ∈ N : µ̂s + √ 2\ns log\n( T\ns\n) + ε ≤ 0 )\n≤ ∞∑ k=0 P\n( ∃s ∈ Gk : sµ̂s + √ 2ηk log ( T\nηk+1\n) + ηkε ≤ 0 )\n≤ ∞∑ k=0 2 min 1, √\nη 4π log (\nT ηk+1\n)  ( ηk+1 T ) 1 η exp ( −η k−1ε2 2 )\n= ∞∑ k=0 f(k) ≤ 2 max k f(k) + ∫ ∞ 0 f(u)du ,\nwhere the function f is defined on [0,+∞[ by\nf(u) = 2 min 1, √\nη 4π log (\nT ηu+1\n)  ( ηu+1 T ) 1 η exp ( −η u−1ε2 2 ) .\nThe last inequality relies on the fact that f can be checked to be unimodal, which permits to upper bound the sum with an integral. The maximum of f is easily upper bounded as follows, using notably (8):\nmax k f(k) ≤ 2 sup k≥0\n( ηk+1\nT\n) 1 η\nexp ( −η k−1ε2\n2\n) = 2 exp(−1/η) ( 2η\nε2T\n) 1 η\n≤ 8e ε2T .\nThe remainder of the proof is spent bounding the integral, which will be split into three disjoint intervals with boundaries at constants k1 < k2 given by\nk1 = log(1/ε 2)/ log(η) k2 = 1 +\nlog ( − log log(η)\nε2 ) log(η) .\nThese are chosen such that\nηk1 = ε−2 exp ( −η k2−1ε2\n2\n) = √ log(η) .\nFirst, one has\nI1 := ∫ k1 0 f(u)du ≤ ∫ k1 0 √ 2√ π log (\nT ηu+1\n) (ηu+1T ) 1 η exp ( −η u−1ε2 2 ) du\n≤ √ 2√ π log ( T\nηk1+1\n) ∫ k1 0 ( ηu+1 T ) 1 η du ≤ √ 2√ π log ( ε2T η ) ηlog(η) ( ηε2T ) 1η\n≤ e √ 2η2√ π log ( ε2T η ) log(η)ε2T ≤ e √ 2η2√ π log ( ε2T η ) log(ε2T )ε2T , where the last inequality follows from the fact that (log(η))−1 ≤ η/(η − 1) = log ( ε2T ) .\nSecondly,\nI2 := ∫ k2 k1 f(u)du ≤ ∫ k2 k1 √ 2√ π log (\nT ηu+1\n) (ηu+1T ) 1 η exp ( −η u−1ε2 2 ) du\n≤ e √ 2√ π log ( T\nηk2+1\n) ∫ ∞ k1 ηu+1 T exp ( −η u−1ε2 2 ) du =\ne √ 2√ π log ( T\nηk2+1\n) 2η2 exp ( −η k1−1ε2 2 ) ε2T log(η)\n≤ 2e √ 2√ π log ( T\nηk2+1\n) η2ε2T log(η) ≤ 2e √ 2η2√ π log ( ε2T\n−η2 log log(η) ) log(ε2T )ε2T ≤ 2e √ 2η2√\nπ log (\nε2T η2 log log(ε2T )\n) log(ε2T )ε2T\nThe second inequality follows from (8), since by definition of k1, one has ηu+1 ≥ ε−2 for u ≥ k1, whereas the last inequalities use again that (log(η))−1 ≤ log(ε2T ). Using similar arguments for the third term, one has\nI3 := ∫ ∞ k2 f(u)du ≤ 2 ∫ ∞ k2 ( ηu+1 T ) 1 η exp ( −η u−1ε2 2 ) du\n≤ 2e ∫ ∞ k2 ηu+1 T exp ( −η u−1ε2 2 ) du =\n4eη2 exp ( −η k2−1ε2\n2 ) ε2T log(η)\n= 4eη2 ε2T √ log(η) ≤ 4eη 2 ε2T\n√ log(ε2T )\nCombining the three upper bounds yield∫ ∞ 0 f(u)du ≤ I1 + I2 + I3\n≤ eη 2 log(ε2T )\nε2T\n √\n2√ π log ( ε2T η ) + 2√2√ π log ( ε2T η2 log log(ε2T ) ) + 4√ log(ε2T )\n\n≤ 4e log(ε 2T )\nε2T\n √\n2√ π log ( ε2T\n2\n) + 2√2√ π log ( ε2T\n4 log log(ε2T )\n) + 4√ log(ε2T ) \nIt can be shown, using notably the inequality log u ≤ u/e, that for all ε2T ≥ e2,\nlog(ε2T/2) ≥ (1/2) log(ε2T )\nlog\n( ε2T\n4 log log(ε2T )\n) ≥ ( 1− 4\ne2\n) log(ε2T )\nand one obtains∫ ∞ 0 f(u)du ≤ 4e log(ε 2T ) ε2T × 2 + 2e √ 2/( √ e2 − 4) + 4 √ π√ π log(ε2T ) ≤ 30e ε2T √ log(ε2T ).\nFinally,\nP ( ∃s ∈ N : µ̂s + √ 2\ns log\n( T\ns\n) + ε ≤ 0 ) ≤ ∫ ∞\n0\nf(u)du+ 2 max k f(k) ≤ 30e ε2T\n√ log(ε2T ) + 16e\nε2T ."
    }, {
      "heading" : "G Numerical Experiments",
      "text" : "We represent here the regret of the five strategies presented in this article on a bandit problem with ∆ = 1/5, for different values of the horizon. The regret is estimated by 4.105 Monte-Carlo replications. In the legend, the estimated slopes of ∆Rπ(T ) (in logarithmic scale) are indicated after the policy names.\n50 100 200 500 1000 2000 5000 10000 20000 50000\n0 20\n40 60\n80 10\n0\nFB−ETC : 3.65 BAI−ETC : 2.98 UCB : 1.59 SPRT−ETC : 1.03 D−UCB : 0.77\nThe experimental behavior of the algorithms reflects the theoretical results presented above: the regret asymptotically grows as the logarithm of the horizon, the experimental coefficients correspond approximately to theory, and the relative ordering of the policies is respected. However, it should be noted that for short horizons the hierarchy is not quite the same, and the growth rate is not logarithmic; this question is raised in Garivier et al. [2016]."
    } ],
    "references" : [ {
      "title" : "Minimax policies for adversarial and stochastic bandits",
      "author" : [ "Jean-Yves Audibert", "Sébastien Bubeck" ],
      "venue" : "In Proceedings of Conference on Learning Theory (COLT),",
      "citeRegEx" : "Audibert and Bubeck.,? \\Q2009\\E",
      "shortCiteRegEx" : "Audibert and Bubeck.",
      "year" : 2009
    }, {
      "title" : "UCB revisited: Improved regret bounds for the stochastic multi-armed bandit problem",
      "author" : [ "Peter Auer", "Ronald Ortner" ],
      "venue" : "Periodica Mathematica Hungarica,",
      "citeRegEx" : "Auer and Ortner.,? \\Q2010\\E",
      "shortCiteRegEx" : "Auer and Ortner.",
      "year" : 2010
    }, {
      "title" : "Finite-time analysis of the multiarmed bandit problem",
      "author" : [ "Peter Auer", "Nicoló Cesa-Bianchi", "Paul Fischer" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Auer et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Auer et al\\.",
      "year" : 2002
    }, {
      "title" : "Prior-free and prior-dependent regret bounds for thompson sampling",
      "author" : [ "Sébastien Bubeck", "Che-Yu Liu" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Bubeck and Liu.,? \\Q2013\\E",
      "shortCiteRegEx" : "Bubeck and Liu.",
      "year" : 2013
    }, {
      "title" : "Bounded regret in stochastic multi-armed bandits",
      "author" : [ "Sébastien Bubeck", "Vianney Perchet", "Philippe Rigollet" ],
      "venue" : "In Proceedings of the 26th Conference On Learning Theory,",
      "citeRegEx" : "Bubeck et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Bubeck et al\\.",
      "year" : 2013
    }, {
      "title" : "Kullback–Leibler upper confidence bounds for optimal sequential allocation",
      "author" : [ "Olivier Cappé", "Aurélien Garivier", "Odalric-Ambrym Maillard", "Rémi Munos", "Gilles Stoltz" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Cappé et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Cappé et al\\.",
      "year" : 2013
    }, {
      "title" : "Action Elimination and Stopping Conditions for the Multi-Armed Bandit and Reinforcement Learning Problems",
      "author" : [ "Eyal Even-Dar", "Shie Mannor", "Yishay Mansour" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Even.Dar et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Even.Dar et al\\.",
      "year" : 2006
    }, {
      "title" : "Optimal best arm identification with fixed confidence",
      "author" : [ "Aurélien Garivier", "Emilie Kaufmann" ],
      "venue" : "In Proceedings of the 29th Conference On Learning Theory (to appear),",
      "citeRegEx" : "Garivier and Kaufmann.,? \\Q2016\\E",
      "shortCiteRegEx" : "Garivier and Kaufmann.",
      "year" : 2016
    }, {
      "title" : "Explore first, exploit next: The true shape of regret in bandit problems",
      "author" : [ "Aurélien Garivier", "Pierre Ménard", "Gilles Stoltz" ],
      "venue" : "arXiv preprint arXiv:1602.07182,",
      "citeRegEx" : "Garivier et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Garivier et al\\.",
      "year" : 2016
    }, {
      "title" : "Inequalities on the lambert w function and hyperpower function",
      "author" : [ "Abdolhossein Hoorfar", "Mehdi Hassani" ],
      "venue" : "J. Inequal. Pure and Appl. Math,",
      "citeRegEx" : "Hoorfar and Hassani.,? \\Q2008\\E",
      "shortCiteRegEx" : "Hoorfar and Hassani.",
      "year" : 2008
    }, {
      "title" : "Sequential choice from several populations",
      "author" : [ "Michael N Katehakis", "Herbert Robbins" ],
      "venue" : "Proceedings of the National Academy of Sciences of the United States of America,",
      "citeRegEx" : "Katehakis and Robbins.,? \\Q1995\\E",
      "shortCiteRegEx" : "Katehakis and Robbins.",
      "year" : 1995
    }, {
      "title" : "On the Complexity of A/B Testing",
      "author" : [ "Emilie Kaufmann", "Olivier Cappé", "Aurélien Garivier" ],
      "venue" : "In Proceedings of the 27th Conference On Learning Theory,",
      "citeRegEx" : "Kaufmann et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Kaufmann et al\\.",
      "year" : 2014
    }, {
      "title" : "Adaptive treatment allocation and the multi-armed bandit problem",
      "author" : [ "Tze Leung Lai" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Lai.,? \\Q1987\\E",
      "shortCiteRegEx" : "Lai.",
      "year" : 1987
    }, {
      "title" : "Asymptotically efficient adaptive allocation rules",
      "author" : [ "Tze Leung Lai", "Herbert Robbins" ],
      "venue" : "Advances in applied mathematics,",
      "citeRegEx" : "Lai and Robbins.,? \\Q1985\\E",
      "shortCiteRegEx" : "Lai and Robbins.",
      "year" : 1985
    }, {
      "title" : "Sequential design of comparative clinical trials",
      "author" : [ "Tze Leung Lai", "Herbert Robbins", "David Siegmund" ],
      "venue" : "Recent advances in statistics: papers in honor of Herman Chernoff on his sixtieth birthday,",
      "citeRegEx" : "Lai et al\\.,? \\Q1983\\E",
      "shortCiteRegEx" : "Lai et al\\.",
      "year" : 1983
    }, {
      "title" : "Optimally confident UCB: Improved regret for finite-armed bandits",
      "author" : [ "Tor Lattimore" ],
      "venue" : "Technical report,",
      "citeRegEx" : "Lattimore.,? \\Q2015\\E",
      "shortCiteRegEx" : "Lattimore.",
      "year" : 2015
    }, {
      "title" : "Brownian motion, volume 30",
      "author" : [ "Peter Mörters", "Yuval Peres" ],
      "venue" : null,
      "citeRegEx" : "Mörters and Peres.,? \\Q2010\\E",
      "shortCiteRegEx" : "Mörters and Peres.",
      "year" : 2010
    }, {
      "title" : "The multi-armed bandit with covariates",
      "author" : [ "Vianney Perchet", "Philippe Rigollet" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Perchet and Rigollet.,? \\Q2013\\E",
      "shortCiteRegEx" : "Perchet and Rigollet.",
      "year" : 2013
    }, {
      "title" : "Batched bandit problems",
      "author" : [ "Vianney Perchet", "Philippe Rigollet", "Sylvain Chassang", "Eric Snowberg" ],
      "venue" : "In Proceedings of the 28th Conference On Learning Theory,",
      "citeRegEx" : "Perchet et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Perchet et al\\.",
      "year" : 2015
    }, {
      "title" : "On the likelihood that one unknown probability exceeds another in view of the evidence of two samples",
      "author" : [ "William Thompson" ],
      "venue" : null,
      "citeRegEx" : "Thompson.,? \\Q1933\\E",
      "shortCiteRegEx" : "Thompson.",
      "year" : 1933
    }, {
      "title" : "Sequential Tests of Statistical Hypotheses",
      "author" : [ "Abraham Wald" ],
      "venue" : "Annals of Mathematical Statistics,",
      "citeRegEx" : "Wald.,? \\Q1945\\E",
      "shortCiteRegEx" : "Wald.",
      "year" : 1945
    } ],
    "referenceMentions" : [ {
      "referenceID" : 19,
      "context" : "This framework is known as the multi-armed bandit problem, which has many applications and has been studied for almost a century [Thompson, 1933].",
      "startOffset" : 129,
      "endOffset" : 145
    }, {
      "referenceID" : 10,
      "context" : "Surprisingly it is possible to do even better by using a fully sequential strategy inspired by the UCB algorithm for multi-armed bandits [Katehakis and Robbins, 1995].",
      "startOffset" : 137,
      "endOffset" : 166
    }, {
      "referenceID" : 10,
      "context" : "As before, strategies based on ETC are suboptimal by a factor of 2 relative to the optimal rates achieved by fully sequential strategies such as UCB, which satisfies R μ(T ) ∼ 2 log(T )/∆ [Katehakis and Robbins, 1995].",
      "startOffset" : 188,
      "endOffset" : 217
    }, {
      "referenceID" : 1,
      "context" : "Moreover, strategies of this kind have been proposed in the literature for more complicated settings [Auer and Ortner, 2010, Perchet and Rigollet, 2013, Perchet et al., 2015]. Recent progress on optimal exploration policies (e.g., by Garivier and Kaufmann [2016]) could have suggested that well-tuned variants of two-phase strategies might be near-optimal.",
      "startOffset" : 102,
      "endOffset" : 263
    }, {
      "referenceID" : 1,
      "context" : "Moreover, strategies of this kind have been proposed in the literature for more complicated settings [Auer and Ortner, 2010, Perchet and Rigollet, 2013, Perchet et al., 2015]. Recent progress on optimal exploration policies (e.g., by Garivier and Kaufmann [2016]) could have suggested that well-tuned variants of two-phase strategies might be near-optimal. We show, on the contrary, that optimal strategies for multi-armed bandit problems must be fully-sequential, and in particular should mix exploration and exploitation. We study two settings, one when the gap ∆ = |μ1 − μ2| is known and the other when it is not. The most straight-forward strategy in the former case is to explore each action a fixed number of times n and subsequently exploit by choosing the action that appeared best while exploring. It is easy to calculate the optimal n and consequently show that this strategy suffers a regret of R μ(T ) ∼ 4 log(T )/∆. A more general approach is to use a so-called Explore-Then-Commit (ETC) strategy, following a nomenclature introduced by Perchet et al. [2015]. An ETC strategy explores each action alternately until some data-dependent stopping time and subsequently commits to a single action for the remaining time-steps.",
      "startOffset" : 102,
      "endOffset" : 1072
    }, {
      "referenceID" : 1,
      "context" : "Moreover, strategies of this kind have been proposed in the literature for more complicated settings [Auer and Ortner, 2010, Perchet and Rigollet, 2013, Perchet et al., 2015]. Recent progress on optimal exploration policies (e.g., by Garivier and Kaufmann [2016]) could have suggested that well-tuned variants of two-phase strategies might be near-optimal. We show, on the contrary, that optimal strategies for multi-armed bandit problems must be fully-sequential, and in particular should mix exploration and exploitation. We study two settings, one when the gap ∆ = |μ1 − μ2| is known and the other when it is not. The most straight-forward strategy in the former case is to explore each action a fixed number of times n and subsequently exploit by choosing the action that appeared best while exploring. It is easy to calculate the optimal n and consequently show that this strategy suffers a regret of R μ(T ) ∼ 4 log(T )/∆. A more general approach is to use a so-called Explore-Then-Commit (ETC) strategy, following a nomenclature introduced by Perchet et al. [2015]. An ETC strategy explores each action alternately until some data-dependent stopping time and subsequently commits to a single action for the remaining time-steps. We show in Theorem 2 that by using a sequential probability ratio test (SPRT) it is possible to design an ETC strategy for which R μ(T ) ∼ log(T )/∆, which improves on the above result by a factor of 4. We also prove a lower bound showing that no ETC strategy can improve on this result. Surprisingly it is possible to do even better by using a fully sequential strategy inspired by the UCB algorithm for multi-armed bandits [Katehakis and Robbins, 1995]. We design a new strategy for which R μ(T ) ∼ log(T )/(2∆), which improves on the fixed-design strategy by a factor of 8 and on SPRT by a factor of 2. Again we prove a lower bound showing that no strategy can improve on this result. For the case where ∆ is unknown, fixed-design strategies are hopeless because there is no reasonable tuning for the exploration budget n. However, it is possible to design an ETC strategy for unknown gaps. Our approach uses a modified fixed-budget best arm identification (BAI) algorithm in its exploration phase (see e.g., Even-Dar et al. [2006], Garivier and Kaufmann [2016]) and chooses the recommended arm for the remaining time-steps.",
      "startOffset" : 102,
      "endOffset" : 2271
    }, {
      "referenceID" : 1,
      "context" : "Moreover, strategies of this kind have been proposed in the literature for more complicated settings [Auer and Ortner, 2010, Perchet and Rigollet, 2013, Perchet et al., 2015]. Recent progress on optimal exploration policies (e.g., by Garivier and Kaufmann [2016]) could have suggested that well-tuned variants of two-phase strategies might be near-optimal. We show, on the contrary, that optimal strategies for multi-armed bandit problems must be fully-sequential, and in particular should mix exploration and exploitation. We study two settings, one when the gap ∆ = |μ1 − μ2| is known and the other when it is not. The most straight-forward strategy in the former case is to explore each action a fixed number of times n and subsequently exploit by choosing the action that appeared best while exploring. It is easy to calculate the optimal n and consequently show that this strategy suffers a regret of R μ(T ) ∼ 4 log(T )/∆. A more general approach is to use a so-called Explore-Then-Commit (ETC) strategy, following a nomenclature introduced by Perchet et al. [2015]. An ETC strategy explores each action alternately until some data-dependent stopping time and subsequently commits to a single action for the remaining time-steps. We show in Theorem 2 that by using a sequential probability ratio test (SPRT) it is possible to design an ETC strategy for which R μ(T ) ∼ log(T )/∆, which improves on the above result by a factor of 4. We also prove a lower bound showing that no ETC strategy can improve on this result. Surprisingly it is possible to do even better by using a fully sequential strategy inspired by the UCB algorithm for multi-armed bandits [Katehakis and Robbins, 1995]. We design a new strategy for which R μ(T ) ∼ log(T )/(2∆), which improves on the fixed-design strategy by a factor of 8 and on SPRT by a factor of 2. Again we prove a lower bound showing that no strategy can improve on this result. For the case where ∆ is unknown, fixed-design strategies are hopeless because there is no reasonable tuning for the exploration budget n. However, it is possible to design an ETC strategy for unknown gaps. Our approach uses a modified fixed-budget best arm identification (BAI) algorithm in its exploration phase (see e.g., Even-Dar et al. [2006], Garivier and Kaufmann [2016]) and chooses the recommended arm for the remaining time-steps.",
      "startOffset" : 102,
      "endOffset" : 2301
    }, {
      "referenceID" : 11,
      "context" : "As we consider two-armed, Gaussian bandits with equal variances, we focus here on uniform sampling rules, which have been shown in Kaufmann et al. [2014] to be optimal in that setting.",
      "startOffset" : 131,
      "endOffset" : 154
    }, {
      "referenceID" : 12,
      "context" : "For unknown ∆ we briefly recall the well-known results, but also propose a new regret analysis of the UCB* algorithm, a variant of UCB that can be traced back to Lai [1987], for which we also obtain order-optimal minimax regret.",
      "startOffset" : 162,
      "endOffset" : 173
    }, {
      "referenceID" : 8,
      "context" : "Garivier et al. [2016]).",
      "startOffset" : 0,
      "endOffset" : 23
    }, {
      "referenceID" : 20,
      "context" : "The work of Wald [1945] shows that a significant gain in terms of expected number of samples can be obtained by using a sequential rather than a batch test.",
      "startOffset" : 12,
      "endOffset" : 24
    }, {
      "referenceID" : 11,
      "context" : "In a bandit model with two Gaussian arms, Kaufmann et al. [2014] propose a δ-PAC algorithm using a uniform sampling rule and a stopping rule τδ that asymptotically attains the minimal sample complexity Eμ[τδ] ∼ (8/∆) log(1/δ).",
      "startOffset" : 42,
      "endOffset" : 65
    }, {
      "referenceID" : 12,
      "context" : "Note that a similar strategy was proposed and analysed by Lai et al. [1983], but in the continuous time framework and with asymptotic analysis only.",
      "startOffset" : 58,
      "endOffset" : 76
    }, {
      "referenceID" : 3,
      "context" : "the former case, we are not aware of any previous research where the gap is known except the line of work by Bubeck et al. [2013], Bubeck and Liu [2013], where different questions are treated.",
      "startOffset" : 109,
      "endOffset" : 130
    }, {
      "referenceID" : 3,
      "context" : "[2013], Bubeck and Liu [2013], where different questions are treated.",
      "startOffset" : 8,
      "endOffset" : 30
    }, {
      "referenceID" : 7,
      "context" : "In the classical bandit setting where ∆ is unknown, UCB by Katehakis and Robbins [1995] is known to be asymptotically optimal: R μ (T ) ∼ 2 log(T )/∆, which matches the lower bound of Lai and Robbins [1985].",
      "startOffset" : 59,
      "endOffset" : 88
    }, {
      "referenceID" : 7,
      "context" : "In the classical bandit setting where ∆ is unknown, UCB by Katehakis and Robbins [1995] is known to be asymptotically optimal: R μ (T ) ∼ 2 log(T )/∆, which matches the lower bound of Lai and Robbins [1985]. Non-asymptotic regret bounds are given for example by Auer et al.",
      "startOffset" : 59,
      "endOffset" : 207
    }, {
      "referenceID" : 1,
      "context" : "Non-asymptotic regret bounds are given for example by Auer et al. [2002], Cappé et al.",
      "startOffset" : 54,
      "endOffset" : 73
    }, {
      "referenceID" : 1,
      "context" : "Non-asymptotic regret bounds are given for example by Auer et al. [2002], Cappé et al. [2013]. Unfortunately, UCB is not optimal in the minimax sense, which is so far only achieved by algorithms that are not asymptotically optimal [Audibert and Bubeck, 2009, Lattimore, 2015].",
      "startOffset" : 54,
      "endOffset" : 94
    }, {
      "referenceID" : 0,
      "context" : "Unfortunately, UCB is not optimal in the minimax sense, which is so far only achieved by algorithms that are not asymptotically optimal [Audibert and Bubeck, 2009, Lattimore, 2015]. Here, with only two arms, we are able to show that Algorithm 5 below is simultaneously minimax order-optimal and asymptotically optimal. The strategy is essentially the same as suggested by Lai [1987], but with a fractionally smaller confidence bound.",
      "startOffset" : 137,
      "endOffset" : 383
    }, {
      "referenceID" : 8,
      "context" : "The improvements come thanks to Inequality 4 in [Garivier et al., 2016], which states that for every (μ1, μ ′ 2) ∈ H and for every stopping time σ such that N2(T ) is Fσ-measurable, Eμ [ N1(σ) ] (μ1 − μ1) 2 + Eμ [ N2(σ) ] (μ2 − μ2) 2 ≥ kl ( Eμ [ N2(T ) T ] , Eμ′ [ N2(T ) T ]) ,",
      "startOffset" : 48,
      "endOffset" : 71
    }, {
      "referenceID" : 11,
      "context" : "This is the same approach used by Lai and Robbins [1985], but rewritten and generalised in a more powerful way (in particular regarding the ETC strategies).",
      "startOffset" : 34,
      "endOffset" : 57
    }, {
      "referenceID" : 8,
      "context" : "Moreover, note that this proof may also lead to (not-so-simple) non-asymptotic lower-bounds, as shown in Garivier et al. [2016] for example.",
      "startOffset" : 105,
      "endOffset" : 128
    }, {
      "referenceID" : 11,
      "context" : "If exploration is the objective, then uniform sampling is known to be optimal in the two-armed Gaussian case [Kaufmann et al., 2014], which justifies the uniform sampling assumption.",
      "startOffset" : 109,
      "endOffset" : 132
    }, {
      "referenceID" : 8,
      "context" : "If exploration is the objective, then uniform sampling is known to be optimal in the two-armed Gaussian case [Kaufmann et al., 2014], which justifies the uniform sampling assumption. The use of ETC strategies for regret minimisation (e.g., as presented by Perchet and Rigollet [2013]) is certainly not limited to bandit models with 2 arms.",
      "startOffset" : 110,
      "endOffset" : 284
    }, {
      "referenceID" : 1,
      "context" : "Arms are eliminated from the active set once their optimality becomes implausible and the exploration phase terminates when the active set contains only a single arm (an example is by Auer and Ortner [2010]).",
      "startOffset" : 184,
      "endOffset" : 207
    }, {
      "referenceID" : 1,
      "context" : "Arms are eliminated from the active set once their optimality becomes implausible and the exploration phase terminates when the active set contains only a single arm (an example is by Auer and Ortner [2010]). The Successive Elimination algorithm has been introduced by Even-Dar et al. [2006] for best-arm identification in the fixed-confidence setting.",
      "startOffset" : 184,
      "endOffset" : 292
    }, {
      "referenceID" : 1,
      "context" : "Arms are eliminated from the active set once their optimality becomes implausible and the exploration phase terminates when the active set contains only a single arm (an example is by Auer and Ortner [2010]). The Successive Elimination algorithm has been introduced by Even-Dar et al. [2006] for best-arm identification in the fixed-confidence setting. But as shown in Garivier and Kaufmann [2016], Successive Elimination is suboptimal for the best arm identification task in almost all settings except two-armed Gaussian bandits.",
      "startOffset" : 184,
      "endOffset" : 398
    }, {
      "referenceID" : 1,
      "context" : "Arms are eliminated from the active set once their optimality becomes implausible and the exploration phase terminates when the active set contains only a single arm (an example is by Auer and Ortner [2010]). The Successive Elimination algorithm has been introduced by Even-Dar et al. [2006] for best-arm identification in the fixed-confidence setting. But as shown in Garivier and Kaufmann [2016], Successive Elimination is suboptimal for the best arm identification task in almost all settings except two-armed Gaussian bandits. It is therefore interesting to investigate the performance in terms of regret of an ETC algorithm using an optimal BAI algorithm. This is actually possible not only for Gaussian distributions, but more generally for one-parameter exponential families, for which Garivier and Kaufmann [2016] propose the asymptotically optimal Track-and-Stop strategy.",
      "startOffset" : 184,
      "endOffset" : 822
    }, {
      "referenceID" : 9,
      "context" : "If T∆ ≥ 4 √ 2πe, the inequality W (y) ≤ log ( (1 + e−1)y/ log(y) ) valid for all y ≥ e (see Hoorfar and Hassani [2008]) entails",
      "startOffset" : 92,
      "endOffset" : 119
    }, {
      "referenceID" : 16,
      "context" : ", Mörters and Peres [2010]) it holds that",
      "startOffset" : 2,
      "endOffset" : 27
    }, {
      "referenceID" : 8,
      "context" : "However, it should be noted that for short horizons the hierarchy is not quite the same, and the growth rate is not logarithmic; this question is raised in Garivier et al. [2016].",
      "startOffset" : 156,
      "endOffset" : 179
    } ],
    "year" : 2017,
    "abstractText" : "We study the problem of minimising regret in two-armed bandit problems with Gaussian rewards. Our objective is to use this simple setting to illustrate that strategies based on an exploration phase (up to a stopping time) followed by exploitation are necessarily suboptimal. The results hold regardless of whether or not the difference in means between the two arms is known. Besides the main message, we also refine existing deviation inequalities, which allow us to design fully sequential strategies with finite-time regret guarantees that are (a) asymptotically optimal as the horizon grows and (b) order-optimal in the minimax sense. Furthermore we provide empirical evidence that the theory also holds in practice and discuss extensions to non-gaussian and multiple-armed case.",
    "creator" : "LaTeX with hyperref package"
  }
}