{
  "name" : "1603.02010.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Differentially Private Policy Evaluation∗",
    "authors" : [ "Borja Balle", "Maziar Gomrokchi", "Doina Precup" ],
    "emails" : [ "b.deballepigem@lancaster.ac.uk" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Learning how to make decisions under uncertainty is becoming paramount in many practical applications, such as medical treatment design, energy management, adaptive user interfaces, recommender systems etc. Reinforcement learning [Sutton and Barto, 1998] provides a variety of algorithms capable of handling such tasks. However, in many practical applications, aside from obtaining good predictive performance, one might also require that the data used to learn the predictor be kept confidential. This is especially true in medical applications, where patient confidentiality is very important, and in other applications which are user-centric (such as recommender systems). Differential privacy (DP) [Dwork, 2006] is a very active research area, originating from cryptography, but which has now been embraced by the machine learning community. DP is a formal model of privacy used to design mechanisms that reduce the amount of information leaked by the result of queries to a database containing sensitive information about multiple users [Dwork, 2006]. Many supervised learning algorithms have differentially private versions, including logistic regression [Chaudhuri and Monteleoni, 2009, Chaudhuri et al., 2011], support vector machines [Chaudhuri et al., 2011, Rubinstein et al., 2012, Jain and Thakurta, 2013], and the lasso [Thakurta and Smith, 2013]. However, differential privacy for reinforcement learning tasks has not been tackled yet, except for the simpler case of bandit problems [Smith and Thakurta, 2013, Mishra and Thakurta, 2015, Tossou and Dimitrakakis, 2016].\nIn this paper, we tackle differential privacy for reinforcement learning algorithms for the full Markov Decision Process (MDP) setting. We develop differentially private algorithms for the problem of policy evaluation, in which a given way of behaving has to be evaluated quantitatively. We start with the batch, first-visit Monte Carlo approach to policy evaluation, which is well understood and closest to regression algorithms, and provide two differentially private versions, which come with formal privacy proofs as well as guarantees on the quality of the solution obtained. Both\n∗Corresponding e-mail: b.deballepigem@lancaster.ac.uk\nar X\niv :1\n60 3.\n02 01\n0v 1\n[ cs\n.L G\n] 7\nM ar\n2 01\nalgorithms work by injecting Gaussian noise into the parameters vector for the value functions, but they differ in the definition of the noise amount. Our privacy analysis techniques are related to previous output perturbation for empirical risk minimization (ERM), but there are some domain specific challenges that need to be addressed. Our utility analysis identifies parameters of the MDP that control how easy it is to maintain privacy in each case. The theoretical utility analysis, as well as some illustrative experiments, show that the accuracy of the private algorithms does not suffer (compared to usual Monte Carlo) when the data set is large.\nThe rest of the paper is organized as follows. In Sec. 2 we provide background notation and results on differential privacy and Monte Carlo methods for policy evaluation. Sec. 3 presents our proposed algorithms. The privacy analysis and the utility analysis are outlined in Sec. 4 and Sec. 5 respectively. Detailed proofs for both of these sections are given in the Supplementary Material. In Sec. 6 we provide empirical illustrations of the scaling behaviour of the proposal algorithms, using synthetic MDPs, which try to mimic characteristics of real applications. Finally, we conclude in Sec. 7 with a discussion of related work and avenues for future work."
    }, {
      "heading" : "2 Background",
      "text" : "In this section we provide background on differential privacy and policy evaluation from Monte Carlo estimates."
    }, {
      "heading" : "2.1 Differential Privacy",
      "text" : "DP takes a user-centric approach, by providing privacy guarantees based on the difference of the outputs of a learning algorithm trained on two databases differing in a single user. The central goal is to bound the loss in privacy that a user can suffer when the result of an analysis on a database with her data is made public. This can incentivize users to participate in studies using sensitive data, e.g. mining of medical records. In the context of machine learning, differentially private algorithms are useful because they allow learning models in such a way that their parameters do not reveal information about the training data [McSherry and Talwar, 2007]. For example, one can think of using historical medical records to learn prognostic and diagnostic models which can then be shared between multiple health service providers without compromising the privacy of the patients whose data was used to train the model.\nTo formalize the above discussion, let X be an input space and Y an output space. Suppose A is a randomized algorithm that takes as input a tuple X = (x1, . . . , xm) of elements from X for some m ≥ 1 and outputs a (random) element A(X) of Y. We interpret X ∈ Xm as a dataset containing data from m individuals and define its neighbouring datasets as those that differ from X in their last1 element: X ′ = (x1, . . . , xm−1, x ′ m) with xm 6= x′m. We denote this (symmetric) relation by X ' X ′. A is (ε, δ)-differentially private for some ε, δ > 0 if for every m ≥ 1, every pair of datasets X,X ′ ∈ Xm, X ' X ′, and every measurable set Ω ⊆ Y we have\nP[A(X) ∈ Ω] ≤ eεP[A(X ′) ∈ Ω] + δ . (1) 1Formally, we should define neighbouring datasets as those which differ in one element, not necessarily the last. But we are implicitly assuming here that the order of the elements in X does not affect the distribution of A(X), so we can assume without loss of generality that the difference between neighbouring datasets is always in the last element.\nThis definition means that the distribution over possible outputs of A on inputs X and X ′ is very similar, so revealing this output leaks almost no information on whether xm or x ′ m was in the dataset. A simple way to design a DP algorithm for a given function f : Xm → Y is the output perturbation mechanism, which releases A(X) = f(X) + η, where η is noise sampled from a properly calibrated distribution. For real outputs Y = Rd, the Laplace (resp. Gaussian) mechanism (see e.g. Dwork and Roth [2014]) samples each component of the noise η = (η1, . . . , ηd) i.i.d. from a Laplace (resp. Gaussian) distribution with standard deviation O(GS1(f)/ε) (resp. O(GS2(f) ln(1/δ)/ε)), where GSp(f) is the global sensitivity of f given by\nGSp(f) = sup X,X′∈Xm,X'X′\n‖f(X)− f(X ′)‖p .\nCalibrating noise to the global sensitivity is a worst-case approach that requires taking the supremum over all possible pairs of neighbouring datasets, and in general does not account for the fact that in some datasets privacy can be achieved with substantially smaller perturbations. In fact, for many applications (like the one we consider in this paper) the global sensitivity is too large to provide useful mechanisms. Ideally one would like to add perturbations proportional to the potential changes around the input dataset X, as measured, for example by the local sensitivity LSp(f,X) = supX′'X ‖f(X)− f(X ′)‖p. Nissim et al. [2007] showed that approaches based on LSp do not lead to differentially private algorithms, and then proposed an alternative framework for DP mechanisms with data-dependent perturbations based on the idea of smoothed sensitivity. This is the approach we use in this paper; see Section 4 for further details."
    }, {
      "heading" : "2.2 Policy Evaluation",
      "text" : "Policy evaluation is the problem of obtaining (an approximation to) the value function of a Markov reward process defined by an MDP M and a policy π [Sutton and Barto, 1998, Szepesvári, 2010]. In many cases of interest M is unknown but we have access to trajectories containing state transitions and immediate rewards sampled from π. When the state space of M is relatively small, tabular methods that represent the value of each state can be used individually. However, in problems with large (or even continuous) state spaces, parametric representations for the value function are typically needed in order to defeat the curse of dimensionality and exploit the fact that similar states will have similar values. In this paper we focus on policy evaluation with linear function approximation in the batch case, where we have access to a set of trajectories sampled from the policy of interest.\nLet M be an MDP over a finite state space S with N = |S| and π a policy on M . Given an initial state s0 ∈ S, the interaction of π with M is described by a sequence ((st, at, rt))t≥0 of state–action–reward triplets. Suppose 0 < γ < 1 is the discount factor of M . The value function V π : S → R of π assigns to each state the expected discounted cumulative reward obtained by a trajectory following policy π from that state:\nV π(s) = EM,π [∑ t≥0 γ trt ∣∣∣ s0 = s ] . (2) The value function can be considered a vector V π ∈ RS . We make the usual assumption that any reward r generated by M is bounded: 0 ≤ r ≤ Rmax, so 0 ≤ V π(s) ≤ Rmax/(1− γ) for all s ∈ S.\nLet Φ ∈ RS×d be a feature representation that associates each state s ∈ S to a d-dimensional feature vector φ>s = Φ(s, :) ∈ Rd. The goal is to find a parameter vector θ ∈ Rd such that V̂ π = Φθ is a good approximation to V π. To do so, we assume that we have access to a collection X = (x1, . . . , xm) of finite trajectories sampled from M by π, where each xi is a sequence of states, actions and rewards.\nWe will use a Monte Carlo approach, in which the returns of the trajectories in X are used as regression targets to fit the parameters in V̂ π via a least squares approach [Sutton and Barto, 1998]. In particular, we consider first-visit Monte Carlo estimates obtained as follows. Suppose x = ((s1, a1, r1), . . . , (sT , aT , rT )) is a trajectory that visits s and ix,s is the time of the first visit to s; that is, six,s = s, and st 6= s for all t < ix,s. The return collected from this first visit is given by\nFx,s = T∑\nt=ix,s\nrtγ t−ix,s = T−ix,s∑ t=0 rt+ix,sγ t ,\nand provides an unbiased estimate of V π(s). For convenience, when state s is not visited by trajectory x we assume Fx,s = 0.\nGiven the returns from all first visits corresponding to a dataset X with m trajectories, we can find a parameter vector for the estimator V̂ π by solving the optimization problem argminθ JX(θ), where\nJX(θ) = 1\nm m∑ i=1 ∑ s∈Sxi ρs(Fxi,s − φ>s θ)2 , (3)\nand Sx is the set of states visited by trajectory x. The regression weights 0 ≤ ρs ≤ 1 are given as an input to the problem and capture the user’s believe that some states are more relevant than others. It is obvious that JX(θ) is a convex function of θ. However, in general it is not strongly convex and therefore the optimum of argminθ JX(θ) is not necessarily unique. On the other hand, it is known that differential privacy is tightly related to certain notions of stability [Thakurta and Smith, 2013], and optimization problems with non-unique solutions generally pose a problem to stability. In order to avoid this problem, the private policy evaluation algorithms that we propose in Section 3 are based on optimizing slightly modified versions of JX(θ) which promote stability in their solutions. Note that the notions of stability related to DP are for worst-case situations: that is, they need to hold for every possible pair of neighbouring input dataset X ' X ′, regardless of any generative model assumed for the trajectories in those datasets. In particular, these stability considerations are not directly related to the variance of the estimates in V̂ π.\nWe end this section with a discussion of the main obstruction to stability, i.e. the cases where argminθ JX(θ) fails to have a unique solution. Given a dataset X with m trajectories we define a vector FX ∈ RS containing the average first visit returns from all trajectories in X that visit a particular state. In particular, if Xs represents the multiset of trajectories from X that visit state s at some point, then we have\nFX(s) = FX,s = 1 |Xs| ∑ x∈Xs Fx,s . (4)\nIf s is not visited by any trajectory in X we set FX,s = 0. To simplify notation, let FX ∈ RS be the vector collecting all these estimates. We also define a diagonal matrix ΓX ∈ RS×S with entries given by the product of the regression weight on each state and the fraction of trajectories in X\nvisiting that state: ΓX(s, s) = ρs|Xs|/m. Solving for θ in ∇θJX(θ) = 0, it is easy to see that any optimal θX ∈ argminθ JX(θ) must satisfy\nΦ>ΓXΦθX = Φ >ΓXFX . (5)\nThus, this optimization has a unique solution if and only if the matrix Φ>ΓXΦ is invertible. Since it is easy to find neighbouring datasets X ' X ′ where at most one of Φ>ΓXΦ and Φ>ΓX′Φ is invertible, optimizing JX(θ) directly poses a problem to the design differentially private policy evaluation algorithms with small perturbations. Next we present two DP algorithm based on stable policy evaluation algorithms."
    }, {
      "heading" : "3 Private First-Visit Monte Carlo Algorithms",
      "text" : "In this section we give the details of two differentially private policy evaluation algorithms based on first-visit Monte Carlo estimates. Each of these algorithms corresponds to a different stable version of the minimization argminθ JX(θ) described in previous section. A formal privacy analysis of these algorithms is given in Section 4. Bounds showing how the privacy requirement affects the utility of the value estimates are presented in Section 5."
    }, {
      "heading" : "3.1 Algorithm DP-LSW",
      "text" : "One way to make the optimization argminθ JX(θ) more stable to changes in the dataset X is to consider a similar least-squares optimization where the optimization weights do not change with X, and guarantee that the optimization problem is always strongly convex. Thus, we consider a new objective function given in terms of a new set of positive regression weights ws > 0. Let Γ ∈ RS×S be a diagonal matrix with Γ(s, s) = ws. We define the objective function as:\nJwX(θ) = ∑ s∈S ws(FX,s − φ>s θ)2 = ‖FX − Φθ‖22,Γ , (6)\nwhere ‖v‖22,Γ = ‖Γ1/2v‖22 = v>Γv is the weighted L2 norm. To see the relation between the optimizations over JX and J w X , note that equating the gradient of J w X(θ) to 0 we see that a minimum θwX ∈ argminθ JwX(θ) must satisfy Φ>ΓΦθwX = Φ >ΓFX . (7) Thus, the optimization problem is well-posed whenever Φ>ΓΦ is invertible, which henceforth will be our working assumption. Note that this is a mild assumption, since it is satisfied by choosing a feature matrix Φ with full column rank. Under this assumption we have:\nθwX = ( Φ>ΓΦ )−1 Φ>ΓFX = ( Γ1/2Φ )† Γ1/2FX , (8)\nwhere M † denotes the Moore–Penrose pseudo-inverse. The difference between optimizing JX(θ) or JwX(θ) is reflected in the differences between (5) and (7). In particular, if the trajectories in X are i.i.d. and ps denotes the probability that state s is visited by a trajectory in X, then taking ws = EX [ρs|Xs|/m] = ρsps yields a loss function JwX(θ) that captures the effect of each state s in JX(θ) in the asymptotic regime m → ∞. However, we note that knowledge of these visit probabilities is not required for running our algorithm or for our analysis.\nOur first DP algorithm for policy evaluation applies a carefully calibrated output perturbation mechanism to the solution θwX of argminθ J w X(θ). We call this algorithm DP-LSW, and its full pseudo-code is given in Algorithm 1. It receives as input the dataset X, the regression weights w, the feature representation Φ, and the MDP parameters Rmax and γ. Additionally, the algorithm is parametrized by the privacy parameters ε and δ. Its output is the result of adding a random vector η drawn from a multivariate Gaussian distribution N (0, σ2XI) to the parameter vector θwX . In order to compute the variance of η the algorithm needs to solve the discrete optimization problem ψwX = max0≤k≤KX e\n−kβϕwX(k), where KX = maxs∈S |Xs|, β is a parameter computed in the algorithm, and ϕwX(k) is given by the following expression:\nϕwX(k) = ∑ s∈S ws max{|Xs| − k, 1}2 . (9)\nNote that ψwX can be computed in time O(KXN).\nAlgorithm 1: DP-LSW\nInput: X, Φ, γ, Rmax, w, ε, δ Output: θ̂wX Compute θwX ; // cf. (8)\nLet α← 5 √ 2 ln(2/δ)\nε and β ← ε 4(d+ln(2/δ)) ;\nLet ψwX ← max0≤k≤KX e−kβϕwX(k) ; // cf. (9) Let σX ← αRmax‖(Γ 1/2Φ)†‖ 1−γ √ ψwX ; Sample a d-dimensional vector η ∼ N (0, σ2XI); Return θ̂wX = θ w X + η;\nThe variance of the noise in DP-LSW is proportional to the upper bound Rmax/(1− γ) on the return from any state. This bound might be excessively pessimistic in some applications, leading to unnecessary large perturbation of the solution θwX . Fortunately, it is possible to replace the term Rmax/(1− γ) with any smaller upper bound Fmax on the returns generated by the target MDP on any state. In practice this leads to more useful algorithms, but it is important to keep in mind that for the privacy guarantees to remain unaffected, one needs to assume that Fmax is a publicly known quantity (i.e. it is not based on an estimate made from private data). These same considerations apply to the algorithm in the next section."
    }, {
      "heading" : "3.2 Algorithm DP-LSL",
      "text" : "The second DP algorithm for policy evaluation we propose is also an output perturbation mechanism. It differs from DP-LSW in they way stability of the unperturbed solutions is promoted. In this case, we choose to optimize a regularized version of JX(θ). In particular, we consider the objective function JλX(θ) obtained by adding a ridge penalty to the least-squares loss from (3):\nJλX(θ) = JX(θ) + λ\n2m ‖θ‖22 , (10)\nwhere λ > 0 is a regularization parameter. The introduction of the ridge penalty makes the objective function JλX(θ) strongly convex, and thus ensures the existence of a unique solution\nθλX = argminθ J λ X(θ), which can be obtained in closed-form as:\nθλX = ( Φ>ΓXΦ + λ\n2m I\n)−1 Φ>ΓXFX . (11)\nHere ΓX is defined as in Section 2.2. We call DP-LSL the algorithm obtained by applying an output perturbation mechanism to the minimizer of JλX(θ); the full pseudo-code is given in Algorithm 2. It receives as input the privacy parameters ε and δ, a dataset of trajectories X, the regression weights ρ, the feature representation Φ, a regularization parameter λ > ‖Φ‖2‖ρ‖∞, and the MDP parameters Rmax and γ. After computing the solution θλX to argminθ J λ X(θ), the algorithm outputs θ̂ λ X = θ λ X + η, where η is a d-dimensional noise vector drawn from N (0, σ2XI). The variance of η is obtained by solving a discrete optimization problem (different from the one in DP-LSW). Let cλ = ‖Φ‖‖ρ‖∞/ √ 2λ and for k ≥ 0, define ϕλX(k) as: cλ√∑ s ρs min{|Xs|+ k,m}+ ‖ρ‖2\n2 . (12) Then DP-LSL computes ψλX = max0≤k≤m e −kβϕλX(k), which can be done in time O(mN).\nAlgorithm 2: DP-LSL\nInput: X, Φ, γ, Rmax, ρ, λ, ε, δ Output: θ̂λX Compute θλX ; // cf. (11)\nLet α← 5 √ 2 ln(2/δ)\nε and β ← ε 4(d+ln(2/δ)) ;\nLet ψλX ← max0≤k≤m e−kβϕλX(k) ; // cf. (12) Let σX ← 2αRmax‖Φ‖(1−γ)(λ−‖Φ‖2‖ρ‖∞) √ ψλX ; Sample a d-dimensional vector η ∼ N (0, σ2XI); Return θ̂λX = θ λ X + η;"
    }, {
      "heading" : "4 Privacy Analysis",
      "text" : "This section provides a formal privacy analysis for DP-LSW and DP-LSL and shows that both algorithms are (ε, δ)-differentially private. We use the smooth sensitivity framework of [Nissim et al., 2007, 2011], which provides tools for the design of DP mechanisms with data-dependent output perturbations. We rely on the following lemma, which provides sufficient conditions for calibrating Gaussian output perturbation mechanisms with variance proportional to smooth upper bounds of the local sensitivity.\nLemma 1 (Nissim et al. [2011]). Let A be an algorithm that on input X computes a vector µX ∈ Rd deterministically and then outputs ZX ∼ N (µX , σ2XI), where σ2X is a variance that depends on X. Let α = α(ε, δ) = 5 √ 2 ln(2/δ)/ε and β = β(ε, δ, d) = ε/(4d + 4 ln(2/δ)). Suppose ε and δ are such that the following are satisfied for every pair of neighbouring datasets X ' X ′: (a) σX ≥ α‖µX − µX′‖2, and (b) | ln(σ2X)− ln(σ2X′)| ≤ β. Then A is (ε, δ)-differentially private.\nCondition (a) says we need variance at least proportional to the local sensitivity LS2(f,X). Condition (b) asks that the variance does not change too fast between neighbouring datasets, by imposing the constraint σ2X/σ 2 X′ ≤ eβ. This is precisely the spirit of the smoothed sensitivity principle: calibrate the noise to a smooth upper bound of the local sensitivity. We acknowledge Lemma 1 is only available in pre-print form, and thus provide an elementary proof in Appendix A for completeness. The remaining proofs from this section are presented Appendices B and C."
    }, {
      "heading" : "4.1 Privacy Analysis of DP-LSW",
      "text" : "We start by providing an upper bound on the norm ‖θwX − θwX′‖2 for any two neighbouring datasets X ' X ′. Using (8) it is immediate that:\n‖θwX − θwX′‖2 ≤ ‖(Γ1/2Φ)†‖‖FX − FX′‖2,Γ . (13)\nThus, we need to bound ‖FX − FX′‖2,Γ.\nLemma 2. Let X ' X ′ be two neighbouring datasets of m trajectories with X = (x1, . . . , xm−1, x) and X ′ = (x1, . . . , xm−1, x\n′). Let X◦ = (x1, . . . , xm−1). Let Sx (resp. Sx′) denote the set of states visited by x (resp. x′). Then we have\n‖FX − FX′‖2,Γ ≤ Rmax 1− γ √ ∑ s∈Sx∪Sx′ ws (|X◦s |+ 1)2 .\nSince the condition in Lemma 1 needs to hold for any dataset X ′ neighbouring X, we take the supremum of the bound above over all neighbours., which yields the following corollary.\nCorollary 3. If X is a dataset of trajectories, then the following holds for every neighbouring dataset X ′ ' X:\n‖FX − FX′‖2,Γ ≤ Rmax 1− γ √∑ s∈S ws max{|Xs|, 1}2 .\nUsing this result we see that in order to satisfy item (a) of Lemma 1 we can choose a noise variance satisfying:\nσX ≥ αRmax‖(Γ1/2Φ)†‖\n1− γ\n√∑ s∈S ws max{|Xs|, 1}2 , (14)\nwhere only the last multiplicative term depends on the dataset X, and the rest can be regarded as a constant that depends on parameters of the problem which are either public or chosen by the user, and will not change for a neighbouring dataset X ′. Thus, we are left with a lower bound expressible as σX ≥ C √ ϕwX , where ϕ w X = ∑ s(ws/max{|Xs|, 1}2) only depends on the dataset X through its signature 〈X〉 ∈ NS given by the number of times each state appears in the trajectories of X: 〈X〉(s) = |Xs|. Accordingly, we write ϕwX = ϕw(〈X〉), where ϕw : NS → R is the function\nϕw(v) = ∑ s ws max{vs, 1}2 . (15)\nThe signatures of two neighbouring datasets X ' X ′ satisfy ‖〈X〉 − 〈X ′〉‖∞ ≤ 1 because replacing a single trajectory can only change by one the number of first visits to any particular\nstate. Thus, assuming we have a function ψ : NS → R satisfying ψw(v) ≥ ϕw(v) and | ln(ψw(v))− ln(ψw(v′))| ≤ β for all v, v′ ∈ NS with ‖v−v′‖∞ ≤ 1, we can take σX = C √ ψw(〈X〉). This variance clearly satisfies the conditions of Lemma 1 since\n| ln(σ2X)− ln(σ2X′)| = | ln(ψw(〈X〉))− ln(ψw(〈X ′〉))| ≤ β .\nThe function ψw is known as a β-smooth upper bound of ϕw, and the following result provides a tool for constructing such functions.\nLemma 4 (Nissim et al. [2007]). Let ϕ : NS → R. For any k ≥ 0 let ϕk(v) = max‖v−v′‖∞≤k ϕ(v′). Given β > 0, the smallest β-smooth upper bound of ϕ is the function\nψ(v) = sup k≥0\n( e−kβϕk(v) ) . (16)\nFor some functions ϕ, the upper bound ψ can be hard to compute or even approximate [Nissim et al., 2007]. Fortunately, in our case a simple inspection of (15) reveals that ϕwk (v) is easy to compute. In particular, the following lemma implies that ψw(v) can be obtained in time O(N‖v‖∞).\nLemma 5. The following holds for every v ∈ NS : ϕwk (v) = ∑ s∈S ws max{vs − k, 1}2 .\nFurthermore, for every k ≥ ‖v‖∞ − 1 we have ϕwk (v) = ∑ sws.\nCombining the last two lemmas, we see that the quantity ψwX computed in DP-LSW is in fact a β-smooth upper bound to ϕwX . Because the variance σX used in DP-LSW can be obtained by plugging this upper bound into (14), the two conditions of Lemma 1 are satisfied. This completes the proof of the main result of this section:\nTheorem 6. Algorithm DP-LSW is (ε, δ)-differentially private.\nBefore proceeding to the next privacy analysis, note that Corollary 3 is the reason why a mechanism with output perturbations proportional to the global sensitivity is not sufficient in this case. The bound there says that if in the worst case we can find datasets of an arbitrary size m where some states are visited few (or zero) times, then the global sensitivity will not vanish as m→∞. Hence, the utility of such algorithm would not improve with the size of the dataset. The smoothed sensitivity approach works around this problem by adding large noise to these datasets, but adding much less noise to datasets where each state appears a sufficient number of times. Corollary 3 also provides the basis for efficiently computing smooth upper bounds to the local sensitivity. In principle, condition (b) in Lemma 1 refers to any dataset neighbouring X, of which there are uncountably many because we consider real rewards. Bounding the local sensitivity in terms of the signature reduces this to finitely many “classes” of neighbours, and the form of the bound in Corollary 3 makes it possible to apply Lemma 4 efficiently."
    }, {
      "heading" : "4.2 Privacy Analysis of DP-LSL",
      "text" : "The proof that DP-LSL is differentially private follows the same strategy as for DP-LSW. We start with a lemma that bounds the local sensitivity of θλX for pairs of neighbouring datasets X ' X ′. We use the notation Is∈x for an indicator variable that is equal to one when state s is visited within trajectory x.\nLemma 7. Let X ' X ′ be two neighbouring datasets of m trajectories with X = (x1, . . . , xm−1, x) and X ′ = (x1, . . . , xm−1, x\n′). Let Fx ∈ RS (resp. Fx′ ∈ RS) be the vector given by Fx(s) = Fx,s (resp. Fx′(s) = Fx′,s). Define diagonal matrices Γρ,∆x,x′ ∈ RS×S given by Γρ(s, s) = ρs and ∆x,x′(s, s) = Is∈x − Is∈x′. If the regularization parameter satisfies λ > ‖Φ>∆x,x′ΓρΦ‖, then:\n‖θλX − θλX′‖2 2 ≤\n∥∥∥(∆x,x′ΦθλX − Fx + Fx′)> ΓρΦ∥∥∥ 2\nλ− ‖Φ>∆x,x′ΓρΦ‖ .\nAs before, we need to consider the supremum of the bound over all possible neighbours X ′ of X. In particular, we would like to get a bound whose only dependence on the dataset X is through the signature 〈X〉. This is the purpose of the following corollary:\nCorollary 8. Let X be a dataset of trajectories and suppose λ > ‖Φ‖2‖ρ‖∞. Then the following holds for every neighbouring dataset X ′ ' X:\n‖θλX − θλX′‖2 ≤ 2Rmax‖Φ‖\n(1− γ)(λ− ‖Φ‖2‖ρ‖∞)\n√ ϕλX ,\nwhere\nϕλX = ‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs|Xs|+ ‖ρ‖2 2 . By the same reasoning of Section 4.1, as long as the regularization parameter is larger than ‖Φ‖2‖ρ‖∞, a differentially private algorithm can be obtained by adding to θλX a Gaussian perturbation with a variance satisfying\nσX ≥ 2αRmax‖Φ‖\n(1− γ)(λ− ‖Φ‖2‖ρ‖∞)\n√ ϕλX\nand the second condition of Lemma 1. This second requirement can be achieved by computing a β-smooth upper bound of the function ϕλ : NS → R given by\nϕλ(v) = ‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs max{vs,m}+ ‖ρ‖2 2 . When going from ϕλX to ϕ\nλ(v) we substituted |Xs| by max{vs,m} to reflect the fact that any state cannot be visited by more than m trajectories in a dataset X of size m. It turns out that in this case the function ϕλk(v) = max‖v−v′‖∞≤k ϕ λ(v′) arising in Lemma 4 is also easy to compute. Lemma 9. For every v ∈ NS , ϕλk(v) is equal to:‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs max{vs + k,m}+ ‖ρ‖2\n2 . Furthermore, for every k ≥ m−mins vs we have ϕλk(v) = ( ‖Φ‖‖ρ‖∞ √ m√\n2λ\n√∑ s∈S ρs + ‖ρ‖2 )2 .\nFinally, in view of Lemma 4, Corollary 8, and Lemma 9, the variance of the noise perturbation in DP-LSL satisfies the conditions of Lemma 1, so we have proved the following.\nTheorem 10. Algorithm DP-LSL is (ε, δ)-differentially private."
    }, {
      "heading" : "5 Utility Analysis",
      "text" : "Because the promise of differential privacy has to hold for any possible pair of neighbouring datasets X ' X ′, the analysis in previous section does not assume any generative model for the input dataset X. However, in practical applications we expect X = (x1, . . . , xm) to contain multiple trajectories sampled from the same policy on the same MDP. The purpose of this section is to show that when the trajectories xi are i.i.d. the utility of our differentially private algorithms increases asm→∞. In other words, when the input dataset grows, the amount of noise added by our algorithms decreases, thus leading to more accurate estimates of the value function. This matches the intuition that when outputting a fixed number of parameters, using data from more users to estimate these parameters leads to a smaller individual contributions from each user, and makes the privacy constraint easier to satisfy.\nTo measure the utility of our DP algorithms we shall bound the difference in empirical risk between the private and non-private parameters learned from a given dataset. That is, we want to show that the quantity EX,η[J•X(θ̂•X) − J•X(θ•X)] vanishes as |X| = m → ∞, for both • = w and • = λ. The first theorem bounds the expected empirical excess risk of DP-LSW. The bound contains two terms: one vanishes as m → ∞, and the other reflects the fact that states which are never visited pose a problem to stability. The proof is deferred to Appendix D.\nTheorem 11. Let S0 = {s ∈ S|ps = 0} and S+ = S \\S0. Let C = αRmax‖(Γ1/2Φ)†‖‖Γ1/2Φ‖F /(1− γ). Suppose β ≤ 1/2. Then EX,η[JwX(θ̂wX)− JwX(θwX)] is upper bounded by:\nC2 ∑ s∈S0 ws + 6 ∑ s∈S+ ws ( 1 p2sm 2 + β2 ( 1− βps 2 )m) . Note the above bound depends on the dimension d through β and ‖Γ1/2Φ‖F . In terms of the size of the dataset, we can get excess risk bounds that decreases quadratically with m by assuming that either all states are visited with non-zero probability or the user sets the regression weights so that such states do not contribute to θwX .\nCorollary 12. If ws = 0 for all s ∈ S0, then EX,η[JwX(θ̂wX)− JwX(θwX)] = O(1/m2).\nA similar theorem can be proved for DP-LSL. However, in this case the statement of the bound is complicated by the appearance of co-occurrence probabilities of the form Px[s ∈ x ∧ s′ ∈ x] and Px[s ∈ x ∧ s′ /∈ x]. Here we only state the main corollary of our result; the full statement and the corresponding proofs are presented in Appendix E. This corollary is obtained by assuming the regularization parameter is allowed to grow with m, and stresses the tensions in selecting an adequate regularization schedule.\nCorollary 13. Suppose λ = ω(1) with respect to m. Then we have EX,η[JλX(θ̂λX) − JλX(θλX)] = O(1/λm+ 1/λ2 +m/λ3).\nNote that taking λ = Θ(m) we get a bound on the excess risk of order O(1/m2). However, if we want the regularization term in JλX(θ) to vanish as m → ∞ we need λ = o(m). We shall see importance of this trade-off in our experiments."
    }, {
      "heading" : "6 Experiments",
      "text" : "In this section we illustrate the behaviour of the proposed algorithms on synthetic examples. The domain we use consists of a chain of N states, where in each state the agent has some probability p of staying and probability (1 − p) of advancing to its right. There is a reward of 1 when the agent reaches the final, absorbing state, and 0 for all other states. While this is a toy example, it illustrates the typical case of policy evaluation in the medical domain, where patients tend to progress through stages of recovery at different speeds, and past states are not typically revisited (partly because in the medical domain, states contain historic information about past treatments). Trajectories are drawn by starting in an initial state distribution and generating state-action-reward transitions according to the described probabilities until the absorbing state is reached. Trajectories are harvested in a batch, and the same batches are processed by all algorithms.\nWe experiment with both a tabular representation of the value function, as well as with function approximation. In the latter case, we simply aggregate pairs of adjacent states, which are hence forced to take the same value. We compared the proposed private algorithms DP-LSW and DPLSL with their non-private equivalents LSW and LSL. The performance measure used is average root mean squared error over the state space. The error is obtained by comparing the state values estimated by the learning algorithms against the exact values obtained by exact, tabular dynamic programming. Standard errors computed over 20 independent runs are included.\nThe main results are summarized in Fig. 1, for an environment with N = 40 states, p = 0.5, discount γ = 0.99, and for the DP algorithms, ε = 0.1 and δ = 0.1. In general, these constants should be chosen depending on the privacy constraints of the domain. Our theoretical results explain the expected effect of these choices on the privacy-utility trade-off so we do not provide extensive experiments with different values.\nThe left plot in Fig. 1 compares the non-private LSL and LSW versions of Monte Carlo evaluation, in the tabular and function approximation case. As can be seen, both algorithms are very stable and converge to the same solution, but LSW converges faster. The second plot compares the performance of all algorithms in the tabular case, over a range of regularization parameters, for two different batch sizes. The third plot compares the expected RMSE of the algorithms when run with state aggregation, as a function of batch size. As can be seen, the DP algorithms converge to the same solutions as the non-private corresponding versions for large enough batch sizes. Interestingly, the two proposed approaches serve different needs. The LSL algorithms work better with small batches of data, whereas the LSW approach is preferable with large batches. From an empirical point of view, the trade-off between accuracy and privacy in the DP-LSL algorithm should be done by setting a regularization schedule proportional to √ m. While the theory suggests it is not the\nbest schedule in terms of excess empirical risk, it achieves the best overall accuracy. Finally, the last figure shows excess empirical risk as a function of the batch size. Interestingly, more aggressive function approximation helps both differentially private algorithms converge faster. This is intuitive, since using the same data to estimate fewer parameters means the effect of each individual trajectory is already obscured by the function approximation. Decreasing the number of parameters of the function approximator, d, increases β, which lowers the smooth sensitivity bounds. In medical applications, one expects to have many attributes measured about patients, and to need aggressive function approximation in order to provide generalization. This result tells us that differentially private algorithms should be favoured in this case as well.\nOverall, the empirical results are very promising, showing that especially as batch size increases, the noise introduced by the DP mechanism decreases rapidly, and these algorithms provide the same performance but with the additional privacy guarantees."
    }, {
      "heading" : "7 Conclusion",
      "text" : "We present the first differentially private algorithms for policy evaluation in the full MDP setting. Our algorithms are built on top of established Monte Carlo methods, and come with utility guarantees showing that the cost of privacy diminishes as training batches get larger. The smoothed sensitivity framework is a key component of our analyses, which differ from previous works on DP mechanisms for ERM and bandits problems in two substantial ways. The first, we consider optimizations with non-Lipschitz loss functions, which prevents us from using most of the established techniques for analyzing privacy and utility in ERM algorithms and complicates some parts of our analysis. In particular, we cannot leverage the tight utility analysis of [Jain and Thakurta, 2014] to get dimension independent bounds. Second, and more importantly, the natural model of neighbouring datasets for policy evaluation involves replacing a whole trajectory. This implies that neighbouring datasets can differ in multiple regression targets, which is quite different from the usual supervised learning approach where neighbouring datasets can only change a single regression target. Our approach is also different from the on-line learning and bandits setting, where there is a single stream of experience and neighbouring datasets differ in one element of the stream. Note that this setting cannot be used naturally in the full MDP setup, because successive observations in a single stream are inherently correlated.\nIn future work we plan to extend our techniques in two directions. First, we would like to design DP policy evaluation methods based on temporal-difference learning [Sutton, 1988]. Secondly, we will tackle the control case, where policy evaluation is often used as a sub-routine, e.g. as in actorcritic methods. We also plan to evaluate the current algorithms on patient data from an ongoing clinical study (in which case, errors cannot be estimated precisely, because the right answer is not known)."
    }, {
      "heading" : "A Smoothed Gaussian Perturbation",
      "text" : "A proof of Lemma 1 in the paper can be found in the pre-print Nissim et al. [2011]. For the sake of completeness, we provide here an elementary proof (albeit with slightly worse constants). In particular, we are going to prove the following.\nLemma 14. Let A be an algorithm that on input X computes a vector µX ∈ Rd deterministically and then outputs ZX ∼ N (µX , σ2XI), where σ2X is a variance that depends on X. Let α = α(ε, δ) = 15 √ 2 ln(4/δ)/ε and β = β(ε, δ, d) = (2 ln 2)ε/5( √ d + √ 2 ln(4/δ))2. Suppose that ε ≤ 5, δ and d are such β ≤ ln 2, and the following are satisfied for every pair of neighbouring datasets X ' X ′:\n1. σX ≥ α‖µX − µX′‖2,\n2. | ln(σ2X)− ln(σ2X′)| ≤ β.\nThen A is (ε, δ)-differentially private.\nWe start with a simple characterization of (ε, δ)-differential privacy that will be useful for our proof.\nLemma 15. Let A(X) = θX ∈ Rd be the output of a randomized algorithm on input X. Write fθX (θ) for the probability density of the output of A on input X. Suppose that for every pair of neighbouring datasets X ' X ′ there exists a measurable set ΘX,X′ ⊂ Rd such that the following are satisfied:\n1. P[θX /∈ ΘX,X′ ] ≤ δ;\n2. for all θ ∈ ΘX,X′ we have fθX (θ) ≤ eεfθX′ (θ).\nThen A is (ε, δ)-differentially private.\nProof. Fix a pair of neighbouring datasets X ' X ′ and let E ⊆ Rd be any measurable set. Let ΘX,X′ be as in the statement and write Θ c X,X′ = R\nd \\ΘX,X′ . Using the assumptions on ΘX,X′ we see that\nP[θX ∈ E] = P[θX ∈ E ∩ΘX,X′ ] + P[θX ∈ E ∩ΘcX,X′ ] ≤ eεP[θX′ ∈ E ∩ΘX,X′ ] + δ ≤ eεP[θX′ ∈ E] + δ .\nNow we proceed with the proof of Lemma 14. Let X ' X ′ be two neighbouring datasets and let us write Z1 = ZX and Z2 = ZX′ for simplicity. Thus, for i = 1, 2 we have that Zi ∼ N (µi, σ2i I) are d-dimensional independent Gaussian random variables whose means and variances satisfy the assumptions of Lemma 14 for some ε, δ > 0. The density function of Zi is denoted by fZi(z). In order to be able to apply Lemma 15 we want to show that the privacy loss between Z1 and Z2 defined as\nL(z) = ln fZ1(z)\nfZ2(z) (17)\nis bounded by ε for all z ∈ Ω, where Ω ⊂ Rd is an event with probability at least 1− δ under Z1. We can start by identifying a candidate Ω. Since Ω has to have high probability w.r.t. Z1, it should contain µ1 because a ball around the mean is the event with the highest probability under\na spherical Gaussian distribution (among those with the same Lebesgue measure). For technical reasons, instead of a ball we will take a slightly more complicated region, which for now we will parametrize by two quantities a, b > 0. The definition of this region will depend on the difference of means ∆ = µ2 − µ1:\nΩ = Ωa ∩ Ωb = {z + µ1 ∈ Rd | | 〈z,∆〉 | ≤ a} ∩ {z + µ1 ∈ Rd | ‖z‖ ≤ b} . (18)\nWe need to choose a and b such that the probability P[Z1 /∈ Ω] ≤ δ, and for that we shall combine two different tail bounds. On the one hand, note that Z = 〈Z1 − µ1,∆〉 /(σ1‖∆‖) ∼ N (0, 1) is a one dimensional standard Gaussian random variable and recall that for any t ≥ 0:\nP[|Z| > t] ≤ 2e−t2/2 . (19)\nOn the other hand, X = ‖Z1 − µ1‖2/σ21 ∼ χ2d follows a chi-squared distribution with d degrees of freedom, for which is known Laurent and Massart [2000] that for all t ≥ 0:\nP[X > d+ 2 √ dt+ 2t] ≤ e−t . (20)\nTo make our choices for a and b we can take them such that P[Z1 /∈ Ωa],P[Z1 /∈ Ωb] ≤ δ/2, since then by a union bound we will get\nP[Z1 /∈ Ω] ≤ P[Z1 /∈ ΩA] + P[Z1 /∈ ΩB] ≤ δ . (21) Since Z satisfies |Z| ≤ √ 2 ln(4/δ) with probability at least 1− δ/2, we can take\na = σ1‖∆‖ √ 2 ln 4\nδ = σ1‖∆‖Cδ . (22)\nFor X we have that d+2 √ d ln(2/δ)+2 ln(2/δ) ≤ d+2 √ 2d ln(2/δ)+2 ln(2/δ) = ( √ d+ √\n2 ln(2/δ))2. Hence, we choose\nb = σ1( √ d+ √ 2 ln(2/δ)) = σ1Dδ . (23)\nFixing this choice of Ω, we now proceed to see under what conditions on σ1 and σ2 we can get L(z) ≤ ε for all z ∈ Ω. We start by expanding the definition of L(z) to get\nL(z) = d 2 ln σ22 σ21 + ‖µ2 − z‖2 2σ22 − ‖µ1 − z‖ 2 2σ21 . (24)\nThe easiest thing to do is to separate this quantity into several parts and insist on each part being at most a fraction of ε. To simplify calculations we will just require that each part is at most = ε/5. This reasoning applied to the first term shows that we must satisfy\nσ22 σ21 ≤ e2 /d . (25)\nNote that this becomes more restrictive as ≈ 0 or d→∞, in which case we have e /d ≈ 1. Next we look at the second part and write z = z′ + µ1 because this is the form of the vectors in Ω. With some algebra we get:\n‖µ2 − (z′ + µ1)‖2 2σ22 − ‖µ1 − (z ′ + µ1)‖2 2σ21 = ‖∆‖2 + ‖z′‖2 − 2 〈z′,∆〉 2σ22 − ‖z ′‖2 2σ21 . (26)\nTo further decompose this quantity we write z′ ∈ Rd as z′ = zp + zo, where zp = ∆ 〈z′,∆〉 /‖∆‖2 is the orthogonal projection of z onto the line spanned by the vector ∆, and zo is the corresponding orthogonal complement. Pythagora’s Theorem implies ‖z′‖2 = ‖zp‖2 + ‖zo‖2, and the RHS in the above expression is equal to\n‖∆‖2 2σ22 − 〈z ′,∆〉 σ22 + | 〈z′,∆〉 |2 2‖∆‖2\n( 1\nσ22 − 1 σ21\n) + ‖zo‖2\n2\n( 1\nσ22 − 1 σ21\n) . (27)\nNow note that the last two terms can be upper bounded by zero if σ1 ≤ σ2, but need to be taken into account otherwise. Furthermore, if it were the case that σ1 σ2 ≈ 0, then these terms could grow unboundedly. Thus we shall require that a bound of the form\nσ21 σ22 ≤ γ , (28)\nholds for some γ ≥ 1 to be specified later. Nonetheless, we observe that under this assumption\n1 σ22 − 1 σ21 ≤ γ − 1 σ21 . (29)\nFurthermore, z ∈ Ω implies ‖zo‖2 ≤ ‖z′‖2 = ‖z − µ1‖ ≤ b2 and | 〈z′,∆〉 |2 = | 〈z − µ1,∆〉 |2 ≤ a2. Thus we see that\n| 〈z′,∆〉 |2\n2‖∆‖2\n( 1\nσ22 − 1 σ21\n) ≤ C2δ (γ − 1)\n2 , (30)\nand ‖zo‖2\n2\n( 1\nσ22 − 1 σ21\n) ≤ D2δ (γ − 1)\n2 . (31)\nBy requiring that each of these bounds is at most we obtain the following constraint for γ:\nγ ≤ 1 + 2 max{C2δ , D2δ} , (32)\nwhich can be satisfied by taking, for example:\nγ = 1 + 2 (√ d+ √ 2 ln(4/δ) )2 . (33)\nNote that for fixed δ, small and/or large d this choice of γ will make (28) behave much like the bound (25) we assumed above for σ22/σ 2 1. In fact, using that 1 + x ≥ ex ln 2 for all 0 ≤ x ≤ 1 we see\nthat (28) can be satisfied if 2 /( √ d+ √ 2 ln(4/δ))2 ≤ 1 and\nσ21 σ22 ≤ exp  (2 ln 2) (√ d+ √ 2 ln(4/δ) )2  . (34)\nFrom here it is immediate to see that if the second condition | ln(σ21)− ln(σ22)| ≤ β in Lemma 14 is satisfied, then (25) and (34) are both satisfied.\nThe missing ingredient to show that L(z) ≤ ε for all z ∈ Ω is an absolute lower bound on σ1. This will follow from bounding the remaining terms in L(z) as follows:\n‖∆‖2 2σ22 − 〈z ′,∆〉 σ22 ≤ ‖∆‖ 2 + 2σ1‖∆‖Cδ 2σ22 (35)\n≤ γ 2 ‖∆‖2 + 2σ1‖∆‖Cδ σ21\n(36)\n≤ 3 2 ‖∆‖2 + 2σ1‖∆‖Cδ σ21\n(37)\n= 3‖∆‖2\n2σ21 + 3‖∆‖Cδ σ1 , (38)\nwhere we used that ≤ 1 implies γ ≤ 3. If we require each of these two terms to be at most , we obtain the constraint:\nσ1 ≥ ‖∆‖max\n{√ 3\n2 , 3Cδ\n} = 3‖∆‖Cδ . (39)\nTo conclude the proof just note that the above bound can be rewritten as σ1 ≥ α‖∆‖, which is precisely the first condition in Lemma 14."
    }, {
      "heading" : "B Privacy Analysis of DP-LSW",
      "text" : "Lemma 16. Let X ' X ′ be two neighbouring datasets of m trajectories with X = (x1, . . . , xm−1, x) and X ′ = (x1, . . . , xm−1, x\n′). Let X◦ = (x1, . . . , xm−1). Let Sx (resp. Sx′) denote the set of states visited by x (resp. x′). Then we have\n‖FX − FX′‖2,Γ ≤ Rmax 1− γ √ ∑ s∈Sx∪Sx′ ws (|X◦s |+ 1)2 .\nProof. We start by noting that if s ∈ S \\ (Sx ∪ Sx′), then FX,s = FX′,s. In the case s ∈ Sx ∪ Sx′ we can write FX,s = (|X◦s |FX◦,s + Fx,s)/(|X◦s |+ 1). Using a symmetric expression for FX′,s we see that in this case\n|FX,s − FX′,s| = 1\n|X◦s |+ 1 |Fx,s − Fx′,s| ≤\n1\n|X◦s |+ 1 max{Fx,s, Fx′,s} ≤\n1 |X◦s |+ 1 Rmax 1− γ ,\nwhere we used that 0 ≤ Fx,s ≤ Rmax/(1 − γ) for all s and x. When s ∈ Sx \\ Sx′ we can use the same expression as before for FX,s and write FX′,s = FX◦,s. A similar argument as in the previous case then yields\n|FX,s − FX′,s| = 1\n|X◦s |+ 1 |Fx,s − FX◦,s| ≤\n1 |X◦s |+ 1 Rmax 1− γ .\nNote the same bound also holds for the case s ∈ Sx′ \\Sx. Finally, since we have seen that the same bound holds for all s ∈ Sx ∪ Sx′ , we obtain∑\ns∈S ws(FX,s − FX′,s)2 ≤\nR2max (1− γ)2 ∑ s∈Sx∪Sx′ ws (|X◦s |+ 1)2 ,\nwhich yields the desired bound.\nCorollary 17. If X is a dataset of trajectories, then the following holds for every neighbouring dataset X ′ ' X:\n‖FX − FX′‖2,Γ ≤ Rmax 1− γ √∑ s∈S ws max{|Xs|, 1}2 .\nProof. Using the notation from Lemma 16 we observe that |Xs| = |X◦s |+1 if s ∈ Sx, and |Xs| = |X◦s | if s /∈ Sx. Therefore, the following holds for any trajectories x, x′:∑ s∈Sx∪Sx′ ws (|X◦s |+ 1)2 ≤ ∑ s∈S ws (|X◦s |+ 1)2 = ∑ s∈Sx ws |Xs|2 + ∑ s∈S\\Sx ws (|Xs|+ 1)2 ≤ ∑ s∈SX ws |Xs|2 + ∑ s∈S\\SX ws ,\nwhere SX denotes the set of states visited by at least one trajectory from X. Since s /∈ SX implies |Xs| = 0, we can plug this bound into the result of Lemma 16 as follows:\n‖FX − FX′‖2,Γ ≤ Rmax 1− γ √∑ s∈SX ws |Xs|2 + ∑ s∈S\\SX ws = Rmax 1− γ √∑ s∈S ws max{|Xs|, 1}2 .\nLemma 18. The following holds for every v ∈ NS :\nϕwk (v) = ∑ s∈S ws max{vs − k, 1}2 .\nFurthermore, for every k ≥ ‖v‖∞ − 1 we have ϕwk (v) = ∑ sws.\nProof. Recall that ϕwk (v) = max‖v′−v‖∞≤k ϕ w(v′) with ϕw(v) = ∑ sws/max{vs, 1}2 and observe the result follows immediately because\nϕwk (v) = ∑ s∈S ws min−k≤l≤k max{vs + l, 1}2 = ∑ s∈S ws max{vs − k, 1}2 ."
    }, {
      "heading" : "C Privacy Analysis of DP-LSL",
      "text" : "Lemma 19. Let X ' X ′ be two neighbouring datasets of m trajectories with X = (x1, . . . , xm−1, x) and X ′ = (x1, . . . , xm−1, x\n′). Let Fx ∈ RS (resp. Fx′ ∈ RS) be the vector given by Fx(s) = Fx,s (resp. Fx′(s) = Fx′,s). Define the diagonal matrices Γρ,∆x,x′ ∈ RS×S given by Γρ(s, s) = ρs and ∆x,x′(s, s) = Is∈x − Is∈x′. If the regularization parameter satisfies λ > ‖Φ>∆x,x′ΓρΦ‖, then the following holds:\n‖θλX − θλX′‖2 2 ≤\n∥∥∥(∆x,x′ΦθλX − Fx + Fx′)> ΓρΦ∥∥∥ 2\nλ− ‖Φ>∆x,x′ΓρΦ‖ . (40)\nProof. In order to simplify our notation we write θ̄ = θλX and θ̄ ′ = θλX′ for the rest of the proof. Given a trajectory x and a vector θ ∈ Rd we shall also write `(x, θ) = ∑\ns∈Sx ρs(Fx,s − φ > s θ) 2 so\nthat JX(θ) = 1 m ∑m i=1 `(xi, θ). Now we proceed with the proof.\nLet us start by noting that because JλX(θ) is λ/m-strongly convex, we have J λ X(θ1)− JλX(θ2) ≥\n〈∇JλX(θ2), θ1−θ2〉+ λ 2m‖θ1−θ2‖ 2 2 for any θ1, θ2 ∈ Rd. Thus, using that optimality implies ∇JλX(θ̄) =\n∇JλX′(θ̄′) = 0, we get\nλ m ‖θ̄ − θ̄′‖22 ≤ JλX(θ̄′)− JλX(θ̄) + JλX′(θ̄)− JλX′(θ̄′)\n= JX(θ̄ ′)− JX(θ̄) + JX′(θ̄)− JX′(θ̄′) = 1\nm\n( `(x, θ̄′)− `(x, θ̄) + `(x′, θ̄)− `(x′, θ̄′) ) ,\nwhere the equalities follows from definitions of X, X ′, JλX and JX . If we now expand the definition of `(x, θ) we see that\n`(x, θ̄′)− `(x, θ̄) = ∑ s∈Sx ρs ( (φ>s θ̄ ′)2 − (φ>s θ̄)2 − 2Fx,sφ>s (θ̄′ − θ̄) ) ,\n`(x′, θ̄)− `(x′, θ̄′) = ∑ s∈Sx′ ρs ( (φ>s θ̄) 2 − (φ>s θ̄′)2 − 2Fx′,sφ>s (θ̄ − θ̄′) ) .\nUsing the identity (φ>s θ̄ ′)2− (φ>s θ̄)2 = (θ̄′+ θ̄)>φsφ>s (θ̄′− θ̄), we rewrite `(x, θ̄′)− `(x, θ̄) + `(x′, θ̄)− `(x′, θ̄′) as ∑ s∈S ρs [ (Is∈x − Is∈x′)(θ̄′ + θ̄)>φsφ>s − 2(Fx,s − Fx′,s)φ>s ] (θ̄′ − θ̄) , (41)\nwhere we implicitly used that Fx,s = 0 whenever s /∈ x. Finally, using the definitions in the statement we can rearrange the above expression to show that\nλ m ‖θ̄ − θ̄′‖22 ≤ 1 m\n( (θ̄′ + θ̄)>Φ>∆x,x′ − 2(Fx − Fx′)> ) ΓρΦ(θ̄ ′ − θ̄)\n= 2\nm\n( θ̄>Φ>∆x,x′ − (Fx − Fx′)> ) ΓρΦ(θ̄\n′ − θ̄) + 1 m (θ̄′ − θ̄)>Φ>∆x,x′ΓρΦ(θ̄′ − θ̄)\n≤ 2 m ‖ ( θ̄>Φ>∆x,x′ − (Fx − Fx′)> ) ΓρΦ‖2‖θ̄′ − θ̄‖2 + 1 m ‖Φ>∆x,x′ΓρΦ‖‖θ̄′ − θ̄‖22 ,\nwhere we used the Cauchy–Schwartz inequality and the definition of operator norm. The result now follows by solving for ‖θ̄ − θ̄′‖2 in the above inequality.\nCorollary 20. Let X be a dataset of trajectories and suppose λ > ‖Φ‖2‖ρ‖∞. Then the following holds for any neighbouring dataset X ′ ' X:\n‖θλX − θλX′‖2 ≤ 2Rmax‖Φ‖\n(1− γ)(λ− ‖Φ‖2‖ρ‖∞)\n√ ϕλX ,\nwhere\nϕλX = ‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs|Xs|+ ‖ρ‖2 2 . Proof. We start by noting that ‖∆x,x′‖ ≤ 1 and ‖Γρ‖ = ‖ρ‖∞, hence submultiplicativity of matrix operator norms yields ‖Φ>∆x,x′ΓρΦ‖ ≤ ‖Φ‖2‖ρ‖∞. On the other hand, for the numerator in (40) we have ∥∥∥∥(∆x,x′ΦθλX − Fx + Fx′)> ΓρΦ∥∥∥∥\n2\n≤ ( ‖θλX‖2‖Φ‖‖ρ‖∞ + ‖(Fx − Fx′)>Γρ‖2 ) ‖Φ‖ . (42)\nBounding the individual entries in Fx and Fx′ by Rmax/(1 − γ) we get ‖(Fx − Fx′)>Γρ‖2 ≤ Rmax‖ρ‖2/(1 − γ). The last step is to bound the norm ‖θλX‖2, for which we use the closed-form solution to argminθ J λ X(θ) given in the paper and write:\n‖θλX‖2 ≤ ∥∥∥∥(Φ>ΓXΦ + λ2mI)−1Φ>Γ1/2X ∥∥∥∥ ‖FX‖2,ΓX ≤ ∥∥∥∥(Φ>ΓXΦ + λ2mI)−1Φ>Γ1/2X ∥∥∥∥ ( Rmax 1− γ √∑ s∈S ρs|Xs| m ) .\nTo bound the last remaining norm let use write UΣV > for the SVD of Γ 1/2 X Φ, where V ∈ Rd×d with V >V = V V > = I. With this we can write:\n(Φ>ΓXΦ + λ 2m I)−1Φ>Γ 1/2 X = V\n( Σ2 + λ\n2m I\n)−1 ΣU> . (43)\nNow we use that ‖U‖ = ‖V ‖ = 1 and x/(x2 + a) ≤ 1/(2 √ a) for any x ≥ 0 to get ‖V (Σ2 + (λ/2m)I)−1ΣU>‖ ≤ √ m/2λ. Thus we get a bound for ‖θλX‖2 that when plugged into (42) yields the desired result.\nLemma 21. The following holds for every v ∈ NS :\nϕλk(v) = ‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs max{vs + k,m}+ ‖ρ‖2 2 . Furthermore, for every k ≥ m−mins vs we have ϕλk(v) = ( ‖Φ‖‖ρ‖∞ √ m√\n2λ\n√∑ s∈S ρs + ‖ρ‖2 )2 .\nProof. The proof is similar to that of Lemma 18 and is omitted."
    }, {
      "heading" : "D Utility Analysis of DP-LSW",
      "text" : "The goal of this section is to show that as the size m of the dataset X grows, the differentially private solution θwX provided by algorithm DP-LSW is not much worse than the one obtained by directly minimizing JwX(θ). In other words, for large datasets the noise introduced by the privacy constraint is negligible. We do so by proving a O(1/m2) bound for the expected empirical excess risk given by EX,η[JwX(θ̂wX)− JwX(θwX)]. Our analysis starts with a lemma that leverages the law of total expectation in order to reduce the bound to a quantity that only depends on EX [σ2X ].\nLemma 22. EX,η[JwX(θ̂wX)− JwX(θwX)] = ‖Γ1/2Φ‖2FEX [σ2X ] . (44)\nProof. By the law of total expectation it is enough to show that\nEη[JwX(θ̂wX)− JwX(θwX)|X] = σ2X‖Γ1/2Φ‖2F . (45)\nLet X be an arbitrary dataset. Expanding the definition of JwX(θ) we have that for any θ ∈ Rd\nJwX(θ) = F > XΓFX + θ >Φ>ΓΦθ − 2F>XΓΦθ . (46)\nOn the other hand, since ∇θJwX(θwX) = 0, we have θwX >Φ>ΓΦ = F>XΓΦ. Thus, using the definition θ̂wX = θ w X + η, a simple algebraic calculation yields\nJwX(θ̂ w X)− JwX(θwX) = η>Φ>ΓΦη − F>XΓΦη − η>Φ>ΓΦθwX . (47)\nFinally, taking the expectation over η ∼ N (0, σ2XI) of the above expression we get\nEη[JwX(θ̂wX)− JwX(θwX)] = Eη[η>Φ>ΓΦη] = σ2X Tr(Φ>ΓΦ) = σ2X‖Γ1/2Φ‖2F . (48)\nIn order to bound EX [σ2X ] we recall the variance has the form σ2X = C2ψwX , where C is a constant independent of X and\nψwX = max k≥0 e−kβ ∑ s∈S ws max{|Xs| − k, 1}2 ≤ ∑ s ws ( max k≥0\ne−kβ\nmax{|Xs| − k, 1}2\n) . (49)\nThus, we can bound EX [σ2X ] = C2EX [ψwX ] by providing a bound for the expectation of each individual maximum in (49). The two following technical lemmas will prove useful.\nLemma 23. Let b > 0 and a ≥ 1. Then the following holds:\nmax 0≤x≤a−1\ne−bx\n(a− x)2 =  1 a2\nb < 2/a\ne1−ab b > 2 e2\n4 b 2e−ab otherwise\n(50)\nProof. The result follows from a simple calculation.\nLemma 24. Suppose Bm,p is a binomial random variable with m trials and success probability p. Then the following hold:\nE [\n1\nBm,p + 1\n] = 1− (1− p)m+1\np(m+ 1) , E [ 1\nB2m,p IBm,p≥1 ] ≤ 6 p(m+ 1) ( 1− (1− p)m+2 p(m+ 2) − (1− p)m+1 − p(m+ 1) 2 (1− p)m ) .\nProof. The first expectation is a classical exercise in probability textbooks. The second one can be\nproved as follows: E [ 1\nB2m,p IBm,p≥1\n] = m∑ k=1 1 k2 ( m k ) pk(1− p)m−k\n≤ 6 m∑ k=1\n1\n(k + 1)(k + 2)\n( m\nk\n) pk(1− p)m−k\n= 6\np(m+ 1) m∑ k=1 1 k + 2\n(m+ 1)!\n(k + 1)!(m− k)! pk+1(1− p)m−k\n= 6\np(m+ 1) m∑ k=1 1 k + 2 P[Bm+1,p = k + 1]\n= 6\np(m+ 1) m+1∑ j=2 1 j + 1 P[Bm+1,p = j]\n= 6\np(m+ 1)\n( E [\n1\nBm+1,p + 1\n] − P[Bm+1,p = 0]− 1\n2 P[Bm+1,p = 1] ) = 6\np(m+ 1)\n( 1− (1− p)m+2\np(m+ 2) − (1− p)m+1 − p(m+ 1) 2 (1− p)m\n) ,\nwhere we used the first equation in the last step, and the bound (k+ 1)(k+ 2)/k2 ≤ 6 for k ≥ 1 in the first inequality.\nRecall that ps denotes the probability that a trajectory from X visits states s. Because these trajectories are i.i.d. we have that |Xs| = Bm,ps is a binomial random variable. Therefore, we can combine the last two lemmas to prove the following.\nLemma 25. Suppose β ≤ 2. Then we have:\nEX [ max k≥0\ne−kβ\nmax{|Xs| − k, 1}2\n] ≤ { 6 p2s(m+1)(m+2) + e 2β2 4 (1− (1− e −β)ps) m ps > 0 ,\n1 ps = 0 . (51)\nProof. Note in the first place that Lemma 23 implies\nmax k≥0\ne−kβ\nmax{|Xs| − k, 1}2 = I|Xs|=0 + I1≤|Xs|<2/β\n1\n|Xs|2 + I|Xs|≥2/β\ne2\n4 β2e−β|Xs| , (52)\nwhere we used that in the case |Xs| = 0 the maximum is 1. If ps = 0, then obviously |Xs| = 0 almost surely and the expectation of (52) equals 1. On the other hand, when ps > 0 we use the linearity of expectation and bound each term separately. Clearly, EX [I|Xs|=0] = PX [Bm,ps = 0] = (1− ps)m. On the other hand, by looking up the moment generating function of a binomial distribution we have\nEX [I|Xs|≥2/β e2 4 β2e−β|Xs|] ≤ e 2 4 β2EX [e−β|Xs|] = e2 4 β2(1− (1− e−β)ps)m . (53)\nThe remaining term is bounded by EX [ I1≤|Xs|<2/β 1\n|Xs|2\n] ≤ EX [ I1≤|Xs| 1\n|Xs|2\n] . (54)\nTherefore, applying Lemma 24 and upper bounding some negative terms by zero, we get EX [ max k≥0 e−kβ max{|Xs| − k, 1}2 ] ≤ 6 p2s(m+ 1)(m+ 2) + e2β2 4 (1− (1− e−β)ps)m . (55)\nNow we can combine Lemmas 22 and 25 using Equation 49 to get our final result.\nTheorem 26. Let S0 = {s ∈ S|ps = 0} and S+ = S \\S0. Let C = αRmax‖(Γ1/2Φ)†‖‖Γ1/2Φ‖F /(1− γ). Suppose β ≤ 2. Then we have the following:\nEX,η[JwX(θ̂wX)−JwX(θwX)] ≤ C2 ∑ s∈S0 ws + ∑ s∈S+ ws ( 6 p2s(m+ 1)(m+ 2) + e2β2 4 (1− (1− e−β)ps)m ) . The following version is the one given in the paper for reasons of space. It is easily obtained by noting that e2/4 ≤ 6, m2 ≤ (m+ 1)(m+ 2), and when β ≤ 1/2 then 1− (1− e−β)ps ≤ 1− βps/2.\nCorollary 27. Let S0 = {s ∈ S|ps = 0} and S+ = S\\S0. Let C = αRmax‖(Γ1/2Φ)†‖‖Γ1/2Φ‖F /(1− γ). Suppose β ≤ 1/2. Then EX,η[JwX(θ̂wX)− JwX(θwX)] is upper bounded by:\nC2 ∑ s∈S0 ws + 6 ∑ s∈S+ ws ( 1 p2sm 2 + β2 ( 1− βps 2 )m) . The following is an immediate consequence of these results.\nCorollary 28. If ws = 0 for all s ∈ S0, then EX,η[JwX(θ̂wX)− JwX(θwX)] = O(1/m2)."
    }, {
      "heading" : "E Utility Analysis of DP-LSL",
      "text" : "The analysis in this section follows a scheme similar to the previous one. We start by taking the expectation of the excess empirical risk with respect to the Gaussian perturbation η.\nLemma 29.\nEX,η[JλX(θ̂λX)− JλX(θλX)] = EX\n[( λd\n2m +\n1\nm ∑ s∈S ρs‖φs‖22|Xs| ) σ2X ] . (56)\nProof. Let X be an arbitrary dataset with m trajectories. Recalling that θ̂λX = θ λ X + η we get:\nJλX(θ̂ λ X)− JλX(θλX) =\n1\nm m∑ i=1 ∑ s∈Sxi ρs ( (φ>s θ̂ λ X) 2 − (φ>s θλX)2 − 2Fxi,sφ>s η ) + λ 2m ( ‖θ̂λX‖22 − ‖θλX‖22 )\n= 1\nm m∑ i=1 ∑ s∈Sxi ρs ( η>φsφ > s η + 2η >φsφ > s θ λ X − 2Fxi,sφ>s η ) + λ 2m ( ‖η‖22 + 2η>θλX ) .\nTaking the expectation over η ∼ N (0, σ2XI) in the above expression we get\nEη[JλX(θ̂λX)− JλX(θλX)] = 1\nm m∑ i=1 ∑ s∈Sxi ρs Tr(φsφ > s )σ 2 X + λ 2m dσ2X .\nThe result now follows from noting that ∑m\ni=1 ∑ s∈Sxi ρs Tr(φsφ > s ) = ∑ s∈S ρs‖φs‖22|Xs|.\nIn order to bound the expression given by previous lemma we will expand the definition of σX =\nCλ √ ψλX , with Cλ = 2Rmax‖Φ‖/(1 − γ)(λ − ‖Φ‖2‖ρ‖∞), and note that using the straightforward bound (a+ b)2 ≤ 2a2 + 2b2 we have:\nψλX = max k≥0 e−kβ ‖ρ‖2 + ‖Φ‖‖ρ‖∞√ 2λ √∑ s∈S ρs min{|Xs|+ k,m} 2\n≤ 2‖ρ‖22 + ‖Φ‖2‖ρ‖2∞\nλ\n∑ s∈S ρs max k≥0 ( e−2kβ min{|Xs|+ k,m} ) .\nThe following lemma can be used to bound the maximums inside this sum.\nLemma 30. Suppose a ≥ 0 and b > 0. Then the following holds:\nmax 0≤x≤m−a\ne−2bx(a+ x) =  a b < a/2 me−2b(m−a) b > m/2 1\n2ebe 2ab otherwise\n(57)\nAssuming we have 2β < 1 ≤ m, previous lemma yields:\nmax k≥0\n( e−2kβ min{|Xs|+ k,m} ) = |Xs|I|Xs|>2β + 1\n2eβ e2β|Xs|I|Xs|≤2β ≤ |Xs|+\n1\n2eβ I|Xs|=0 . (58)\nWhen taking the expectation of the upper bound for (56) obtained by plugging in (58), several quantities involving products of correlated binomial random variables will appear. Next lemma gives expressions for all these expectations.\nLemma 31. Recall that ps = P[s ∈ x] and |Xs| is a binomial random variable with m trials and success probability ps. Define ps,s′ = P[s ∈ x∧ s′ ∈ x] and p̄s,s′ = P[s ∈ x∧ s′ /∈ x] for any s, s′ ∈ S. Then we have the following:\n1. E[|Xs|] = mps,\n2. E[I|Xs|=0] = (1− ps)m,\n3. E[|Xs|2] = m2p2s +m(ps − p2s),\n4. E[|Xs||Xs′ |] = m(m− 1)psps′ +mps,s′,\n5. E[|Xs|I|Xs′ |=0] = mp̄s,s′(1− ps′) m−1.\nProof. All equations follow from straightforward calculations.\nTheorem 32. Suppose β < 1/2 and λ > ‖Φ‖2‖ρ‖∞. Let Cλ = 2αRmax‖Φ‖/(1−γ)(λ−‖Φ‖2‖ρ‖∞). Then we have\nEX,η[JλX(θ̂λX)− JλX(θλX)] ≤ C2λ {∑ s∈S ρsps ( d‖Φ‖2‖ρ‖2∞ 2 + 2‖ρ‖22‖φs‖22 ) + λ\nm d‖ρ‖22 +\n1\nm d‖Φ‖2‖ρ‖2∞ 4eβ ∑ s∈S ρs(1− ps)m + m λ ‖Φ‖2‖ρ‖2∞ ∑ s,s′∈S ρsρs′psps′‖φs‖22\n+ 1\nλ ‖Φ‖2‖ρ‖2∞ ∑ s∈S ρ2s‖φs‖22(ps − p2s) + ∑ s,s′∈S s 6=s′ ρsρs′‖φs‖22 ( ps,s′ − psps′ + 1 2eβ p̄s,s′(1− ps′)m−1 )  .\nProof. Combining Lemma 29 with (58) and the definition of σ2X yields the following upper bound for EX,η[JλX(θ̂λX)− JλX(θλX)]:\nC2λEX\n[( λd\n2m +\n1\nm ∑ s∈S ρs‖φs‖22|Xs| )( 2‖ρ‖22 + ‖Φ‖2‖ρ‖2∞ λ ∑ s∈S ρs ( |Xs|+ 1 2eβ I|Xs|=0 ))] .\nTerms that do not involve products of the form |Xs||Xs′ | or |Xs|I|Xs′ |=0 can be straightforwardly reduced to linear combinations of expectations in Lemma 31. The remaining term yields the following:\nEX  ∑ s,s′∈S ρsρs′‖φs‖22|Xs| ( |Xs′ |+ 1 2eβ I|Xs′ |=0 ) = ∑ s∈S ρ2s‖φs‖22EX [ |Xs| ( |Xs|+ 1 2eβ I|Xs|=0\n)] + ∑ s,s′∈S s 6=s′ ρsρs′‖φs‖22EX [ |Xs| ( |Xs′ |+ 1 2eβ I|Xs′ |=0 )]\n= ∑ s∈S ρ2s‖φs‖22 ( m2p2s +m(ps − p2s) ) + ∑ s,s′∈S s6=s′ ρsρs′‖φs‖22 ( m(m− 1)psps′ +mps,s′ + 1 2eβ mp̄s,s′(1− ps′)m−1 ) ,\nwhere we used Lemma 31 again. Thus we get:\nEX,η[JλX(θ̂λX)− JλX(θλX)] ≤ C2λ { λd‖ρ‖22 m + d‖Φ‖2‖ρ‖2∞ 2m ∑ s∈S ρs ( mps + 1 2eβ (1− ps)m ) +\n2‖ρ‖22 m ∑ s∈S ρsps‖φs‖22m+ ‖Φ‖2‖ρ‖2∞ λm ∑ s∈S ρ2s‖φs‖22 ( m2p2s +m(ps − p2s) )\n+ ‖Φ‖2‖ρ‖2∞\nλm\n∑ s,s′∈S s 6=s′ ρsρs′‖φs‖22 ( m(m− 1)psps′ +mps,s′ + 1 2eβ mp̄s,s′(1− ps′)m−1 ) The final result is obtained by grouping the terms in this expression by their dependence in λ and m.\nNote that if we take λ = ω(1) with respect to m in the above theorem, then Cλ = O(1/λ) and we get the following corollary.\nCorollary 33. Suppose λ = ω(1) with respect to m. Then we have EX,η[JλX(θ̂λX)− JλX(θλX)] = O ( 1\nλm +\n1 λ2 + m λ3\n) . (59)"
    } ],
    "references" : [ {
      "title" : "Privacy-preserving logistic regression",
      "author" : [ "Kamalika Chaudhuri", "Claire Monteleoni" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Chaudhuri and Monteleoni.,? \\Q2009\\E",
      "shortCiteRegEx" : "Chaudhuri and Monteleoni.",
      "year" : 2009
    }, {
      "title" : "Differentially private empirical risk",
      "author" : [ "Kamalika Chaudhuri", "Claire Monteleoni", "Anand D Sarwate" ],
      "venue" : "minimization. volume 12. JMLR. org,",
      "citeRegEx" : "Chaudhuri et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Chaudhuri et al\\.",
      "year" : 2011
    }, {
      "title" : "Differential privacy. In Proceedings of the 33rd international conference on Automata, Languages and Programming-Volume Part II, pages",
      "author" : [ "Cynthia Dwork" ],
      "venue" : null,
      "citeRegEx" : "Dwork.,? \\Q2006\\E",
      "shortCiteRegEx" : "Dwork.",
      "year" : 2006
    }, {
      "title" : "The algorithmic foundations of differential privacy",
      "author" : [ "Cynthia Dwork", "Aaron Roth" ],
      "venue" : "Foundations and Trends in Theoretical Computer Science,",
      "citeRegEx" : "Dwork and Roth.,? \\Q2014\\E",
      "shortCiteRegEx" : "Dwork and Roth.",
      "year" : 2014
    }, {
      "title" : "Differentially private learning with kernels",
      "author" : [ "Prateek Jain", "Abhradeep Thakurta" ],
      "venue" : "In Proceedings of the 30th International Conference on Machine Learning",
      "citeRegEx" : "Jain and Thakurta.,? \\Q2013\\E",
      "shortCiteRegEx" : "Jain and Thakurta.",
      "year" : 2013
    }, {
      "title" : "near) dimension independent risk bounds for differentially private learning",
      "author" : [ "Prateek Jain", "Abhradeep Guha Thakurta" ],
      "venue" : "In Proceedings of The 31st International Conference on Machine Learning,",
      "citeRegEx" : "Jain and Thakurta.,? \\Q2014\\E",
      "shortCiteRegEx" : "Jain and Thakurta.",
      "year" : 2014
    }, {
      "title" : "Adaptive estimation of a quadratic functional by model selection",
      "author" : [ "Beatrice Laurent", "Pascal Massart" ],
      "venue" : "Annals of Statistics,",
      "citeRegEx" : "Laurent and Massart.,? \\Q2000\\E",
      "shortCiteRegEx" : "Laurent and Massart.",
      "year" : 2000
    }, {
      "title" : "Mechanism design via differential privacy",
      "author" : [ "Frank McSherry", "Kunal Talwar" ],
      "venue" : "In Foundations of Computer Science,",
      "citeRegEx" : "McSherry and Talwar.,? \\Q2007\\E",
      "shortCiteRegEx" : "McSherry and Talwar.",
      "year" : 2007
    }, {
      "title" : "Nearly optimal differentially private stochastic multi-arm bandits",
      "author" : [ "Nikita Mishra", "Abhradeep Thakurta" ],
      "venue" : "In UAI,",
      "citeRegEx" : "Mishra and Thakurta.,? \\Q2015\\E",
      "shortCiteRegEx" : "Mishra and Thakurta.",
      "year" : 2015
    }, {
      "title" : "Smooth sensitivity and sampling in private data analysis",
      "author" : [ "Kobbi Nissim", "Sofya Raskhodnikova", "Adam Smith" ],
      "venue" : "In Proceedings of the thirty-ninth annual ACM symposium on Theory of computing,",
      "citeRegEx" : "Nissim et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Nissim et al\\.",
      "year" : 2007
    }, {
      "title" : "Smooth sensitivity and sampling in private data",
      "author" : [ "Kobbi Nissim", "Sofya Raskhodnikova", "Adam Smith" ],
      "venue" : "Journal of Privacy and Confidentiality,",
      "citeRegEx" : "Nissim et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Nissim et al\\.",
      "year" : 2011
    }, {
      "title" : "Nearly optimal algorithms for private online learning in full-information and bandit settings",
      "author" : [ "Adam Smith", "Abhradeep Thakurta" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Smith and Thakurta.,? \\Q2013\\E",
      "shortCiteRegEx" : "Smith and Thakurta.",
      "year" : 2013
    }, {
      "title" : "Learning to predict by the methods of temporal differences",
      "author" : [ "Richard S. Sutton" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Sutton.,? \\Q1988\\E",
      "shortCiteRegEx" : "Sutton.",
      "year" : 1988
    }, {
      "title" : "Reinforcement learning: An introduction",
      "author" : [ "Richard S Sutton", "Andrew G Barto" ],
      "venue" : "MIT press,",
      "citeRegEx" : "Sutton and Barto.,? \\Q1998\\E",
      "shortCiteRegEx" : "Sutton and Barto.",
      "year" : 1998
    }, {
      "title" : "Algorithms for reinforcement learning",
      "author" : [ "Csaba Szepesvári" ],
      "venue" : null,
      "citeRegEx" : "Szepesvári.,? \\Q2010\\E",
      "shortCiteRegEx" : "Szepesvári.",
      "year" : 2010
    }, {
      "title" : "Differentially private feature selection via stability arguments, and the robustness of the lasso",
      "author" : [ "Abhradeep Guha Thakurta", "Adam Smith" ],
      "venue" : "In Conference on Learning Theory,",
      "citeRegEx" : "Thakurta and Smith.,? \\Q2013\\E",
      "shortCiteRegEx" : "Thakurta and Smith.",
      "year" : 2013
    }, {
      "title" : "Algorithms for differentially private multi-armed bandits",
      "author" : [ "Aristide C.Y. Tossou", "Christos Dimitrakakis" ],
      "venue" : "In International Conference on Artificial Intelligence",
      "citeRegEx" : "Tossou and Dimitrakakis.,? \\Q2016\\E",
      "shortCiteRegEx" : "Tossou and Dimitrakakis.",
      "year" : 2016
    } ],
    "referenceMentions" : [ {
      "referenceID" : 13,
      "context" : "Reinforcement learning [Sutton and Barto, 1998] provides a variety of algorithms capable of handling such tasks.",
      "startOffset" : 23,
      "endOffset" : 47
    }, {
      "referenceID" : 2,
      "context" : "Differential privacy (DP) [Dwork, 2006] is a very active research area, originating from cryptography, but which has now been embraced by the machine learning community.",
      "startOffset" : 26,
      "endOffset" : 39
    }, {
      "referenceID" : 2,
      "context" : "DP is a formal model of privacy used to design mechanisms that reduce the amount of information leaked by the result of queries to a database containing sensitive information about multiple users [Dwork, 2006].",
      "startOffset" : 196,
      "endOffset" : 209
    }, {
      "referenceID" : 15,
      "context" : ", 2012, Jain and Thakurta, 2013], and the lasso [Thakurta and Smith, 2013].",
      "startOffset" : 48,
      "endOffset" : 74
    }, {
      "referenceID" : 7,
      "context" : "In the context of machine learning, differentially private algorithms are useful because they allow learning models in such a way that their parameters do not reveal information about the training data [McSherry and Talwar, 2007].",
      "startOffset" : 202,
      "endOffset" : 229
    }, {
      "referenceID" : 2,
      "context" : "Dwork and Roth [2014]) samples each component of the noise η = (η1, .",
      "startOffset" : 0,
      "endOffset" : 22
    }, {
      "referenceID" : 9,
      "context" : "Nissim et al. [2007] showed that approaches based on LSp do not lead to differentially private algorithms, and then proposed an alternative framework for DP mechanisms with data-dependent perturbations based on the idea of smoothed sensitivity.",
      "startOffset" : 0,
      "endOffset" : 21
    }, {
      "referenceID" : 13,
      "context" : "We will use a Monte Carlo approach, in which the returns of the trajectories in X are used as regression targets to fit the parameters in V̂ π via a least squares approach [Sutton and Barto, 1998].",
      "startOffset" : 172,
      "endOffset" : 196
    }, {
      "referenceID" : 15,
      "context" : "On the other hand, it is known that differential privacy is tightly related to certain notions of stability [Thakurta and Smith, 2013], and optimization problems with non-unique solutions generally pose a problem to stability.",
      "startOffset" : 108,
      "endOffset" : 134
    }, {
      "referenceID" : 9,
      "context" : "We use the smooth sensitivity framework of [Nissim et al., 2007, 2011], which provides tools for the design of DP mechanisms with data-dependent output perturbations. We rely on the following lemma, which provides sufficient conditions for calibrating Gaussian output perturbation mechanisms with variance proportional to smooth upper bounds of the local sensitivity. Lemma 1 (Nissim et al. [2011]).",
      "startOffset" : 44,
      "endOffset" : 398
    }, {
      "referenceID" : 9,
      "context" : "Lemma 4 (Nissim et al. [2007]).",
      "startOffset" : 9,
      "endOffset" : 30
    }, {
      "referenceID" : 9,
      "context" : "For some functions φ, the upper bound ψ can be hard to compute or even approximate [Nissim et al., 2007].",
      "startOffset" : 83,
      "endOffset" : 104
    }, {
      "referenceID" : 5,
      "context" : "In particular, we cannot leverage the tight utility analysis of [Jain and Thakurta, 2014] to get dimension independent bounds.",
      "startOffset" : 64,
      "endOffset" : 89
    }, {
      "referenceID" : 12,
      "context" : "First, we would like to design DP policy evaluation methods based on temporal-difference learning [Sutton, 1988].",
      "startOffset" : 98,
      "endOffset" : 112
    }, {
      "referenceID" : 9,
      "context" : "A proof of Lemma 1 in the paper can be found in the pre-print Nissim et al. [2011]. For the sake of completeness, we provide here an elementary proof (albeit with slightly worse constants).",
      "startOffset" : 62,
      "endOffset" : 83
    }, {
      "referenceID" : 6,
      "context" : "On the other hand, X = ‖Z1 − μ1‖/σ 1 ∼ χd follows a chi-squared distribution with d degrees of freedom, for which is known Laurent and Massart [2000] that for all t ≥ 0: P[X > d+ 2 √ dt+ 2t] ≤ e−t .",
      "startOffset" : 123,
      "endOffset" : 150
    } ],
    "year" : 2016,
    "abstractText" : "We present the first differentially private algorithms for reinforcement learning, which apply to the task of evaluating a fixed policy. We establish two approaches for achieving differential privacy, provide a theoretical analysis of the privacy and utility of the two algorithms, and show promising results on simple empirical examples.",
    "creator" : "LaTeX with hyperref package"
  }
}