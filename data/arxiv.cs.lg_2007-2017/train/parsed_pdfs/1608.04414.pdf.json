{
  "name" : "1608.04414.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Generalization of ERM in Stochastic Convex Optimization: The Dimension Strikes Back",
    "authors" : [ "Vitaly Feldman" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n60 8.\n04 41\n4v 1\n[ cs\n.L G\n] 1\n5 A\nug 2\nIn stochastic convex optimization the goal is to minimize a convex function F (x) . = Ef∼D[f(x)] over a convex set K ⊂ Rd where D is some unknown distribution and each f(·) in the support of D is convex over K. The optimization is commonly based on i.i.d. samples f1, f2, . . . , fn from D. A standard approach to such problems is empirical risk minimization (ERM) that optimizes FS(x) . = 1 n ∑ i≤n f i(x). Here we consider the question of how many samples are necessary for ERM to succeed and the closely related question of uniform convergence of FS to F over K. We demonstrate that in the standard ℓp/ℓq setting of Lipschitz-bounded functions over a K of bounded radius, ERM requires sample size that scales linearly with the dimension d. This nearly matches standard upper bounds and improves on Ω(log d) dependence proved for ℓ2/ℓ2 setting in [SSSS09]. In stark contrast, these problems can be solved using dimension-independent number of samples for ℓ2/ℓ2 setting and log d dependence for ℓ1/ℓ∞ setting using other approaches. We also demonstrate that for a more general class of rangebounded (but not Lipschitz-bounded) stochastic convex programs an even stronger gap appears already in dimension 2."
    }, {
      "heading" : "1 Introduction",
      "text" : "Numerous central problems in machine learning, statistics and operations research are special cases of stochastic optimization from i.i.d. data samples. In this problem the goal is to optimize the value of the expected function F (x) = Ef∼D[f(x)] over some set K given i.i.d. samples f1, f2, . . . , fn of f . For example, in supervised learning the set K consists of hypothesis functions from Z to Y and each sample is an example described by a pair (z, y) ∈ (Z, Y ). For some fixed loss function L : Y × Y → R, an example (z, y) defines a function from K to R given by f(z,y)(h) = L(h(z), y). The goal is to find a hypothesis h that (approximately) minimizes the expected loss relative to some distribution P over examples: E(z,y)∼P [L(h(z), y)] = E(z,y)∼P [f(z,y)(h)].\nHere we are interested in stochastic convex optimization (SCO) problems in which K is some convex subset of Rd and each function in the support of D is convex over K. The importance of this setting stems from the fact that such problems can be solved efficiently via a large variety of known techniques. Therefore in many applications even if the original optimization problem is not convex, it is replaced by a convex relaxation.\nA classic and widely-used approach to solving stochastic optimization problems is empirical risk minimization (ERM) also referred to as stochastic average approximation (SAA) in the optimization literature. In this approach, given a set of samples S = (f1, f2, . . . , fn) the empirical estimate of F : FS(x) . = 1 n ∑ i≤n f i(x) is optimized (sometimes with an additional regularization term such as λ‖x‖2 for some λ > 0). The question we address here is the number of samples required for this approach to work\ndistribution-independently. More specifically, for some fixed convex body K and fixed set of convex functions F over K, what is the smallest number of samples n such that for every probability distribution D supported on F , any algorithm that minimizes FS given n i.i.d. samples from D will produce an ǫ-optimal solution x̂ to the problem (namely, F (x̂) ≤ minx∈K F (x)+ ǫ) with probability at least 1− δ? We will refer to this number as the sample complexity of ERM for ǫ-optimizing F over K (we will fix δ = 1/2 for now).\nThe sample complexity of ERM for ǫ-optimizing F over K is lower bounded by the sample complexity of ǫ-optimizing F over K, that is the number of samples that is necessary to find an ǫ-optimal solution for any algorithm. On the other hand, it is upper bounded by the number of samples that ensures uniform convergence of FS to F . Namely, if with probability ≥ 1 − δ, for all x ∈ K, |FS(x) − F (x)| ≤ ǫ/2 then, clearly, any algorithm based on ERM will succeed. As a result, ERM and uniform convergence are the primary tool for analysis of the sample complexity of learning problems and are the key subject of study in statistical learning theory. Fundamental results in VC theory imply that in some settings, such as binary classification and least-squares regression, uniform convergence is also a necessary condition for learnability (e.g. [Vap98, SSBD14]) and therefore the three measures of sample complexity mentioned above nearly coincide.\nIn the context of stochastic convex optimization the study of sample complexity of ERM and uniform convergence was initiated in an insightful and influential work of Shalev-Shwartz, Shamir, Srebro and Sridharan [SSSS09]. They demonstrated that the relationships between these notions of sample complexity are substantially more delicate even in the most well-studied SCO settings. Specifically, let K be a unit ℓ2 ball and F be the set of all convex sub-differentiable functions with Lipschitz constant relative to ℓ2 bounded by 1 or, equivalently, ‖∇f(x)‖2 ≤ 1 for all x ∈ K. Then, known algorithm for SCO imply that sample complexity of this problem is O(1/ǫ2) and often expressed as 1/ √ n rate of convergence (e.g. [NJLS09, SSBD14]). On the other hand, Shalev-Shwartz et al. [SSSS09] show1 that the sample complexity of ERM for solving this problem with ǫ = 1/2 is Ω(log d). The only known upper bound for sample complexity of ERM is Õ(d/ǫ2) and relies only on the uniform convergence of Lipschitz-bounded functions [SN05, SSSS09].\nAs can seen from this discussion, the work of Shalev-Shwartz et al. [SSSS09] still leaves a major gap between known bounds on sample complexity of ERM (and also uniform convergence) for this basic Lipschitzbounded ℓ2/ℓ2 setup. Another natural question is whether the gap is present in the popular ℓ1/ℓ∞ setup. In this setup K is a unit ℓ1 ball (or in some cases a simplex) and ‖∇f(x)‖∞ ≤ 1 for all x ∈ K. The sample complexity of SCO in this setup is θ(log d/ǫ2) (e.g. [NJLS09, SSBD14]) and therefore, even an appropriately modified lower bound in [SSSS09], does not imply any gap. More generally, the choice of norm can have a major impact on the relationship between these sample complexities and hence needs to be treated carefully. For example, for (the reversed) ℓ∞/ℓ1 setting the sample complexity of the problem is θ(d/ǫ2) (e.g. [FGV15]) and nearly coincides with the number of samples sufficient for uniform convergence."
    }, {
      "heading" : "1.1 Overview of Results",
      "text" : "In this work we substantially strengthen the lower bound in [SSSS09] proving that a linear dependence on the dimension d is necessary for ERM (and, consequently, uniform convergence). We then extend the lower bound to all ℓp/ℓq setups and examine several related questions. Finally, we examine a more general setting of range-bounded SCO (that is |f(x)| ≤ 1 for all x ∈ K). While the sample complexity of this setting is still low (for example Õ(1/ǫ2) when K is an ℓ2 ball) and efficient algorithms are known, we show that ERM might require an infinite number of samples already for d = 2. A (somewhat counterintuitive) conclusion from these lower bounds is that, from the point of view of generalization of ERM and uniform convergence,\n1The dependence on d is not stated explicitly but follows immediately from their analysis.\nconvexity does not reduce the sample complexity in the worst case.\nOur basic construction is fairly simple and its analysis is inspired by the technique in [SSSS09]. It is based on functions of the form maxv∈V 〈v, x〉. Note that the maximum operator preserves both convexity and Lipschitz bound (relative to any norm). The distribution over the sets V that define such functions is uniform over all subsets of some set of vectors W of size 2d/6. Equivalently, each element of W is included in V with probability 1/2 independently of other elements in W . This implies that if the number of samples is less than d/6 then, with probability > 1/2, at least one of the vectors in W (say w) will not be observed in any of the samples. For an appropriate choice of W , this implies that FS can be minimized while maximizing 〈w, x〉 (the maximum over the unit ℓ2 ball is w). Note that a function randomly chosen from our distribution includes the term 〈w, x〉 in the maximum operator with probability 1/2. Therefore the value of the expected function F at w is much larger than the minimum of F . In particular, there exists an ERM algorithm with generalization error of at least 1/4. The details of the construction appear in Sec. 3.1 and Thm. 3.3 gives the formal statement of the lower bound. We also show (see Thm. 3.5) that essentially the same construction gives the same lower bound for any ℓp/ℓq setup with 1/p + 1/q = 1.\nThe use of maximum operator results in functions that are highly non-smooth (that is, their gradient is not Lipschitz-bounded) whereas the construction in [SSSS09] uses smooth functions. Smoothness plays a crucial role in many algorithms for convex optimization (see [Bub15] for examples). It reduces the sample complexity of SCO in ℓ2/ℓ2 setup to O(1/ǫ) when the smoothness parameter is a constant (e.g. [NJLS09, SSBD14]). Therefore it is natural to ask whether our strong lower bound holds for smooth functions as well. We describe a modification of our construction that proves a similar lower bound in the smooth case (with generalization error of 1/128). The main idea is to replace each linear function 〈v, x〉 with some smooth function ν(〈v, x〉) guaranteing that for different vectors v1, v2 ∈ W and every x ∈ K, only one of ν(〈v1, x〉) and ν(〈v2, x〉) can be non-zero. This allows to easily control the smoothness of maxv∈V ν(〈v, x〉). The details of this construction appear in Sec. 3.2 and the formal statement in Thm. 3.7.\nAnother important contribution in [SSSS09] is the demonstration of the important role that strong convexity plays for generalization in SCO: Minimization of FS(x) + λR(x) ensures that ERM will have low generalization error whenever R(x) is strongly convex (for a sufficiently large λ). This result is based on the proof that ERM of a strongly convex Lipschitz function is replace-one stable and the connection between such stability and generalization showed in [BE02] (see also [SSSSS10] for a detailed treatment of the relationship between generalization and stability).\nIt is natural to ask whether other approaches to regularization will ensure generalization. We demonstrate that for the commonly used ℓ1 regularization the answer is negative. We prove this using a simple modification of our lower bound construction: We shift the functions to the positive orthant where the regularization terms λ‖x‖1 is just a linear function. We then subtract this linear function from each function in our construction, thereby balancing the regularization (while maintaining convexity and Lipschitz-boundedness). The details of this construction appear in Sec. 3.3 (see Thm. 3.8).\nFinally, we consider a more general class of range-bounded convex functions (note that the Lipschitz bound of 1 and the bound of 1 on the radius of K imply a bound of 1 on the range up to a constant shift which does not affect the optimization problem). While this setting is not as well-studied, efficient algorithms for it are known. For example, the online algorithm in a recent work of Rakhlin and Sridharan [RS15] together with standard online-to-batch conversion arguments [CCG04], imply that the sample complexity of this problem is Õ(1/ǫ2) for any K that is an ℓ2 ball (of any radius). For general convex bodies K, the problems can be solved via random walk-based approaches [BLNR15, FGV15] or an adaptation of the center-ofgravity method given in [FGV15]. Here we show that for this setting ERM might completely fail already for K being the unit 2-dimensional ball. The construction is based on ideas similar to those we used in the\nsmooth case and is formally described in Sec. 4."
    }, {
      "heading" : "2 Preliminaries",
      "text" : "For an integer n ≥ 1 let [n] .= {1, . . . , n}. Random variables are denoted by bold letters, e.g., f . Given p ∈ [1,∞] we denote the ball of radius R > 0 in ℓp norm by Bdp(R), and the unit ball by Bdp .\nFor a convex body (i.e., compact convex set with nonempty interior) K ⊆ Rd, we consider problems of the form\nmin K\n(FD) . = min\nx∈K\n{\nFD(x) . = E\nf∼D [f(x)]\n}\n,\nwhere f is a random variable defined over some set of convex, sub-differentiable functions F on K and distributed according to some unknown probability distribution D. We denote F ∗ = minK(FD). For an approximation parameter ǫ > 0 the goal is to find x ∈ K such that FD(x) ≤ F ∗ + ǫ and we call any such x an ǫ-optimal solution. For an n-tuple of functions S = (f1, . . . , fn) we denote by FS . = 1n ∑ i∈[n] f i.\nWe say that a point x̂ is an empirical risk minimum for an n-tuple S of functions over K, if FS(x̂) = minK(FS). In some cases there are many points that minimize FS and in this case we refer to a specific algorithm that selects one of the minimums of FS as an empirical risk minimizer. To make this explicit we refer to the output of such a minimizer by x̂(S) .\nGiven x ∈ K, and a convex function f we denote by ∇f(x) ∈ ∂f(x) an arbitrary selection of a subgradient. Let us make a brief reminder of some important classes of convex functions. Let p ∈ [1,∞] and q = p∗ . = 1/(1 − 1/p). We say that a subdifferentiable convex function f : K → R is in the class\n• F(K, B) of B-bounded-range functions if for all x ∈ K, |f(x)| ≤ B.\n• F0p (K, L) of L-Lipschitz continuous functions w.r.t. ℓp, if for all x, y ∈ K, |f(x)−f(y)| ≤ L‖x−y‖p;\n• F1p (K, σ) of functions with σ-Lipschitz continuous gradient w.r.t. ℓp, if for all x, y ∈ K, ‖∇f(x) − ∇f(y)‖q ≤ σ‖x− y‖p.\nWe will omit p from the notation when p = 2."
    }, {
      "heading" : "3 Lower Bounds for Lipschitz-Bounded SCO",
      "text" : "In this section we present our main lower bounds for SCO of Lipschitz-bounded convex functions. For comparison purposes we start by formally stating some known bounds on sample complexity of solving such problems:\nUniform convergence upper bound: The following uniform convergence bounds can be easily derived from the standard covering number argument (e.g. [SN05, SSSS09])\nTheorem 3.1. For p ∈ [1,∞], let K ⊆ Bdp(R) and let D be any distribution supported on functions L-Lipschitz on K relative to ℓp (not necessarily convex). Then, for every ǫ, δ > 0 and n ≥ n1 = O (\nd·(LR)2·log(dLR/(ǫδ)) ǫ2\n)\nPr S∼Dn\n[∃x ∈ K, |FD(x)− FS(x)| ≥ ǫ] ≤ δ.\nAlgorithms: The following upper bounds on sample complexity of Lipschitz-bounded SCO can be obtained from several known algorithms [NJLS09, SSSS09] (see [SSBD14] for a textbook exposition for p = 2).\nTheorem 3.2. For p ∈ [1, 2], let K ⊆ Bdp(R). Then, there is an algorithm Ap that given ǫ, δ > 0 and n = np(d,R,L, ǫ, δ) i.i.d. samples from any distribution D supported on F0p (K, L), outputs an ǫ-optimal solution to FD over K with probability ≥ 1− δ. For p ∈ (1, 2], np = O((LR/ǫ)2 · log(1/δ)) and for p = 1, np = O((LR/ǫ)\n2 · log d · log(1/δ)). Stronger results are known under additional assumptions on smoothness and/or strong convexity (e.g. [NJLS09,\nRSS12, SZ13, BM13])."
    }, {
      "heading" : "3.1 Non-smooth construction",
      "text" : "We will start with a simpler lower bound for non-smooth functions. For simplicity, we will also restrict R = L = 1. Lower bounds for the general setting can be easily obtained from this case by scaling the domain and desired accuracy (see Thm. 3.10 for additional details).\nWe will need a set of vectors W ⊆ {−1, 1}d with the following property: for any distinct w1, w2 ∈ W , 〈w1, w2〉 ≤ d/2. The Chernoff bound together with a standard packing argument imply that there exists a set W with this property of size ≥ ed/8 ≥ 2d/6.\nFor any subset V of W we define a function\ngV (x) . = max{1/2,max\nw∈V 〈w̄, x〉}, (1)\nwhere w̄ . = w/‖w‖ = w/ √ d. We first observe that gV is convex and 1-Lipschitz (relative to ℓ2). This immediately follows from 〈w̄, x〉 being convex and 1-Lipschitz for every w and gV being the maximum of convex and 1-Lipschitz functions. Theorem 3.3. Let K = Bd2 and we define H2 . = {gV | V ⊆ W} for gV defined in eq. (1). Let D be the uniform distribution over H2. Then for n ≤ d/6 and every set of samples S there exists an ERM x̂(S) such that\nPr S∼Dn\n[FD(x̂(S))− F ∗ ≥ 1/4] > 1/2.\nProof. We start by observing that the uniform distribution over H2 is equivalent to picking the function gV where V is obtained by including every element of W with probability 1/2 randomly and independently of all other elements. Further, by the properties of W , for every w ∈ W , and V ⊆ W , gV (w̄) = 1 if w ∈ V and gV (w̄) = 1/2 otherwise. For gV chosen randomly with respect to D, we have that w ∈ V with probability exactly 1/2. This implies that FD(w̄) = 3/4.\nLet S = (gV1 , . . . , gVn) be the random samples. Observe that minK(FS) = 1/2 and F ∗ = minK(FD) =\n1/2 (the minimum is achieved at the origin 0̄). Now, if ⋃ i∈[n]Vi 6= W then let x̂(S) . = w̄ for any w ∈ W \\ ⋃i∈[n]Vi. Otherwise x̂(S) is defined to be the origin 0̄. Then by the property of H2 mentioned above, we have that for all i, gVi(x̂(S)) = 1/2 and hence FS(x̂(S)) = 1/2. This means that x̂(S) is a minimizer of FS.\nCombining these statements, we get that, if ⋃ i∈[n]Vi 6= W then there exists an ERM x̂(S) such that FS(x̂(S)) = minK(FS) and FD(x̂(S)) − F ∗ = 1/4. Therefore to prove the claim it suffices to show that for n ≤ d/6 we have that\nPr S∼Dn\n\n\n⋃\ni∈[n]\nVi 6= W\n\n > 1\n2 .\nThis easily follows from observing that for the uniform distribution over subsets of W , for every w ∈ W ,\nPr S∼Dn\n\nw ∈ ⋃\ni∈[n]\nVi\n\n = 1− 2−n\nand this event is independent from the inclusion of other elements in ⋃\ni∈[n]Vi. Therefore\nPr S∼Dn\n\n\n⋃\ni∈[n]\nVi = W\n\n = ( 1− 2−n )|W | ≤ e−2−n·2d/6 ≤ e−1 < 1\n2 .\nRemark 3.4. In our construction there is a different ERM algorithm that does solve the problem (and generalizes well). For example, the algorithm that always outputs the origin 0̄. Therefore it is natural to ask whether the same lower bound holds when there exists a unique minimizer. Shalev-Shwartz et al. [SSSS09] show that their lower bound construction can be slightly modified to ensure that the minimizer is unique while still having large generalization error. An analogous modification appears to be much harder to analyze in our construction and it is unclear to us how to ensure uniqueness in our strong lower bounds. A further question in this direction is whether it is possible to construct a distribution for which the empirical minimizer with large generalization error is unique and its value is noticeably (at least by 1/poly(d)) smaller than the value of FS at any point x that generalizes well. Such distribution would imply that the solutions that “overfits” can be found easily (for example, in a polynomial number of iterations of the gradient descent).\nOther ℓp norms: We now observe that exactly the same approach can be used to extend this lower bound to ℓp/ℓq setting. Specifically, for p ∈ [1,∞] and q = p∗ we define\ngp,V (x) . = max\n{\n1 2 ,max w∈V 〈w, x〉 d1/q\n}\n.\nIt is easy to see that for every V ⊆ W , gq,V ∈ F0p (Bdp , 1). We can now use the same argument as before with the appropriate normalization factor for points in Bdp . Namely, instead of w̄ for w ∈ W we consider the values of the minimized functions at w/d1/p ∈ Bdp. This gives the following generalization of Thm. 3.3.\nTheorem 3.5. For every p ∈ [1,∞] let K = Bdp and we define Hp . = {gp,V | V ⊆ W} and let D be the uniform distribution over Hp. Then for n ≤ d/6 and every set of samples S there exists an ERM x̂(S) such that\nPr S∼Dn\n[FD(x̂(S))− F ∗ ≥ 1/4] > 1/2."
    }, {
      "heading" : "3.2 Smoothness does not help",
      "text" : "We now extend the lower bound to smooth functions. We will for simplicity restrict our attention to ℓ2 but analogous modifications can be made for other ℓp norms. The functions gV that we used in the construction use two maximum operators each of which introduces non-smoothness. To deal with maximum with 1/2 we simply replace the function max{1/2, 〈w̄, x〉} with a quadratically smoothed version (in the same way\nas hinge loss is sometimes replaced with modified Huber loss). To deal with the maximum over all w ∈ V , we show that it is possible to ensure that individual components do not “interact”. That is, at every point x, the value, gradient and Hessian of at most one component function are non-zero (value, vector and matrix, respectively). This ensures that maximum becomes addition and Lipschitz/smoothness constants can be upper-bounded easily.\nFormally, we define\nν(a) . =\n{\n0 if a ≤ 0 a2 otherwise.\nNow, for V ⊆ W , we define\nhV (x) . = ∑\nw∈V\nν(〈w̄, x〉 − 7/8). (2)\nWe first prove that hV is 1/4-Lipschitz and 1-smooth.\nLemma 3.6. For every V ⊆ W and hV defined in eq. (2) we have hV ∈ F02 (Bd2 , 1/4) ∩ F12 (Bd2 , 1). Proof. It is easy to see that ν(〈w̄, x〉−7/8) is convex for every w and hence hV is convex. Next we observe that for every point x ∈ Bd2 , there is at most one w ∈ W such that 〈w̄, x〉 > 7/8. If 〈w̄, x〉 > 7/8 then ‖w̄ − x‖2 = ‖w̄‖2 + ‖x‖2 − 2〈w̄, x〉 < 1 + 1− 2(7/8) = 1/4. On the other hand, by the properties of W , for distinct w1, w2 we have that ‖w̄1 − w̄2‖2 = 2 − 2〈w̄1, w̄2〉 ≥ 1. Combining these bounds on distances we obtain that if we assume that 〈w̄1, x〉 > 7/8 and 〈w̄2, x〉 > 7/8 then we obtain a contradiction\n‖w̄1 − w̄2‖ ≤ ‖w̄1 − x‖+ ‖w̄2 − x‖ < 1.\nFrom here we can conclude that\n∇hV (x) = { 2(〈w̄, x〉 − 7/8) · w̄ if ∃w ∈ V, 〈w̄, x〉 > 7/8 0 otherwise .\nThis immediately implies that ‖∇hV (x)‖ ≤ 1/4 and hence hV is 1/4-Lipschitz. We now prove smoothness. Given two points x, y ∈ Bd2 we consider two cases. First the simpler case when there is at most one w ∈ V such that either 〈w̄, x〉 > 7/8 or 〈w̄, y〉 > 7/8. In this case ∇hV (x) = ∇ν(〈w̄, x〉−7/8) and ∇hV (y) = ∇ν(〈w̄, y〉−7/8). This implies that the 1-smoothness condition is implied by 1-smoothness of ν(〈w̄, ·〉 − 7/8). That is one can easily verify that ‖∇hV (x)−∇hV (y)‖ ≤ ‖x− y‖.\nNext we consider the case where for x there is w1 ∈ V such that 〈w̄1, x〉 > 7/8, for y there is w2 ∈ V such that 〈w̄2, y〉 > 7/8 and w1 6= w2. Then there exists a point z ∈ Bd2 on the line connecting x and y such that 〈w̄1, z〉 ≤ 7/8 and 〈w̄2, z〉 ≤ 7/8. Clearly, ‖x − y‖ = ‖x − z‖ + ‖z − y‖. On the other hand, by the analysis of the previous case we have that ‖∇hV (x) −∇hV (z)‖ ≤ ‖x − z‖ and ‖∇hV (z) −∇hV (y)‖ ≤ ‖z − y‖. Combining these inequalities we obtain that\n‖∇hV (x)−∇hV (y)‖ ≤ ‖∇hV (x)−∇hV (z)‖+ ‖∇hV (z)−∇hV (y)‖ ≤ ‖x− z‖+ ‖z− y‖ = ‖x− y‖.\nFrom here we can use the proof approach from Thm. 3.3 but with hV in place of gV .\nTheorem 3.7. Let K = Bd2 and we define H . = {hV | V ⊆ W} for hV defined in eq, (2). Let D be the uniform distribution over H. Then for n ≤ d/6 and every set of samples S there exists an ERM x̂(S) such that\nPr S∼Dn\n[FD(x̂(S))− F ∗ ≥ 1/128] > 1/2.\nProof. Let S = (hV1 , . . . , hVn) be the random samples. As before we first note that minK(FS) = 0 and F ∗ = 0. Further, for every w ∈ W , hV (w̄) = 1/64 if w ∈ V and hV (w̄) = 0 otherwise. Hence FD(w̄) = 1/128. Now, if ⋃ i∈[n]Vi 6= W then let x̂(S) . = w̄ for some w ∈ W \\ ⋃i∈[n]Vi. Then for all i, hVi(x̂(S)) = 0 and hence FS(x̂(S)) = 0. This means that x̂(S) is a minimizer of FS and FD(x̂(S))− F ∗ = 1/128.\nNow, exactly as in Thm. 3.3, we can conclude that ⋃ i∈[n]Vi 6= W with probability > 1/2."
    }, {
      "heading" : "3.3 ℓ1 Regularization does not help",
      "text" : "Next we show that the lower bound holds even with an additional ℓ1 regularization term λ‖x‖ for positive λ ≤ 1/ √ d. (Note that if λ > 1/ √ d then the resulting program is no longer 1-Lipschitz relative to ℓ2. Any constant λ can be allowed for ℓ1/ℓ∞ setup). To achieve this we shift the construction to the positive orthant (that is x such that xi ≥ 0 for all i ∈ [d]). In this orthant the subgradient of the regularization term is simply λ1̄ where 1̄ is the all 1’s vector. We can add a linear term to each function in our distribution that balances this term thereby reducing the analysis to non-regularized case. More formally, we define the following family of functions. For V ⊆ W ,\nhλV (x) . = hV (x− 1̄/ √ d)− λ〈1̄, x〉. (3)\nNote that over Bd2(2), hλV (x) is L-Lipschitz for L ≤ 2(2− 7/8) +λ √ d ≤ 9/4. We now state and prove this formally. Theorem 3.8. Let K = Bd2(2) and for a given λ ∈ (0, 1/ √ d], we define Hλ .= {hλV | V ⊆ W} for hλV defined in eq. (3). Let D be the uniform distribution over Hλ. Then for n ≤ d/6 and every set of samples S there exists x̂(S) such that\n• FS(x̂(S)) = minx∈K(FS(x) + λ‖x‖1);\n• PrS∼Dn [FD(x̂(S))− F ∗ ≥ 1/128] > 1/2.\nProof. Let S = (hλ V1 , . . . , hλ Vn ) be the random samples. We first note that F ∗ = FD(0̄) = 0 and\nmin x∈K (FS(x) + λ‖x‖1) = min x∈K\n\n\n∑\ni∈[n]\nhVi\n(\nx− 1̄√ d\n)\n− λ〈1̄, x〉+ λ‖x‖1\n\n\n≥ min x∈K\n\n\n∑\ni∈[n]\nhVi\n(\nx− 1̄√ d\n)\n\n ≥ 0.\nFurther, for every w ∈ W , w̄ + 1̄/ √ d is in the positive orthant and in Bd2(2). Hence hλV (w̄ + 1̄/ √ d) =\nhV (w̄). We can therefore apply the analysis from Thm. 3.7 to obtain the claim."
    }, {
      "heading" : "3.4 Dependence on ǫ",
      "text" : "We now briefly consider the dependence of our lower bound on the desired accuracy. Note that the upper bound for uniform convergence scales as Õ(d/ǫ2).\nWe first observe that our construction implies a lower bound of Ω(d/ǫ2) for uniform convergence nearly matching the upper bound (we do this for the simpler non-smooth ℓ2 setting but the same applies to other setting we consider).\nTheorem 3.9. Let K = Bd2 and we define H2 . = {gV | V ⊆ W} for gV defined in eq. (1). Let D be the uniform distribution over H2. Then for any ǫ > 0 and n ≤ n1 = Ω(d/ǫ2) and every set of samples S there exists a point x̂(S) such that\nPr S∼Dn\n[FD(x̂(S))− FS(x̂(S)) ≥ ǫ] > 1/2.\nProof. For every w ∈ W ,\nFS(w̄) = 1\nn\n∑\ni∈[n]\ngVi(w̄) = 1\n2 +\n1\n2n\n∑\ni∈[n]\n1{w∈Vi},\nwhere 1{w∈Vi} is the indicator variable of w being in Vi. If for some w, 1 2n\n∑\ni∈[n] 1{w∈Vi} ≥ 1/4 + ǫ then we will obtain a point w̄ that violates the uniform convergence by ǫ. For every w, ∑\ni∈[n] 1{w∈Vi} is distributed according to the binomial distribution. Using a standard approximation of the partial binomial sum up to (1/2 − 2ǫ)n, we obtain that for some constant c > 0, the probability that this sum is ≥ 1/2 + 2ǫ is at least\n1 2n · 1√ 8n(1/4 − ǫ2) · ( 1 2 + 2ǫ )(1/2+2ǫ)n · ( 1 2 − 2ǫ )(1/2−2ǫ)n ≥ 2−cnǫ2 .\nNow, using independence between different w ∈ W , we can conclude that, for n ≤ d/(6cǫ2), the probability that there exists w for which uniform convergence is violated is at least\n1− ( 1− 2−cnǫ2 )|W | ≥ 1− e−2−cnǫ 2 ·2d/6 ≥ 1− e−1 > 1 2 .\nA natural question is whether the d/ǫ2 dependence also holds for ERM. We could not answer it and prove only a weaker Ω(d/ǫ) lower bound. For completeness, we also make this statement for general radius R and Lipschitz bound L.\nTheorem 3.10. For L,R > 0 and ǫ ∈ (0, LR/4), let K = Bd2(R) and we define H2 . = {L · gV | V ⊆ W} ⊆ F0(Bd2(R), L) for gV defined in eq. (1). We define the random variable Vα as a random subset of W obtained by including each element of W with probability α . = 2ǫ/(LR) randomly and independently. Let Dα be the probability distribution of the random variable gVα . Then for n ≤ d/32 ·LR/ǫ and every set of samples S there exists an ERM x̂(S) such that\nPr S∼Dnα\n[FDα(x̂(S)) − F ∗ ≥ ǫ] > 1/2.\nProof. By the same argument as in the proof of Thm. 3.3 we have that: For every w ∈ W , and V ⊆ W , L · gV (Rw̄) = LR if w ∈ V and L · gV (Rw̄) = LR/2 otherwise. For gV chosen randomly with respect to Dα, we have that w ∈ V with probability 2ǫ/(LR). This implies that FDα(Rw̄) = LR/2 + ǫ. Similarly, minK(FS) = LR/2 and F ∗ = minK(FDα) = LR/2.\nTherefore, if ⋃ i∈[n]Vi 6= W then there exists an ERM x̂(S) such that FS(x̂(S)) = minK(FS) and FDα(x̂(S))− F ∗ = ǫ. For the distribution Dα and every w ∈ W ,\nPr S∼Dnα\n\nw ∈ ⋃\ni∈[n]\nVi\n\n = 1− (1− α)n ≤ 1− e−2αn\nand this event is independent from the inclusion of other elements in ⋃ i∈[n]Vi (where we used that 1−α ≥ e−2α for α < 1/2). Therefore\nPr S∼Dnα\n\n\n⋃\ni∈[n]\nVi = W\n\n = ( 1− e−2αn )|W | ≤ e−e−2αn·ed/8 ≤ e−1 < 1\n2 ."
    }, {
      "heading" : "4 Range-Bounded Convex Optimization",
      "text" : "As we have outlined in the introduction, SCO is solvable in the more general setting in which instead of the Lipschitz bound and radius of K we have a bound on the range of functions in the support of distribution. Recall that for a bound on the absolute value B we denote this class of functions by F(K, B). This setting is more challenging algorithmically and has not been studied extensively. For comparison purposes and completeness, we state a recent result for this setting from [RS15] (converted from the online to the stochastic setting in the standard way).\nTheorem 4.1 ([RS15]). Let K = Bdp(R) for some R > 0 and B > 0. There is an efficient algorithm A that given ǫ, δ > 0 and n = O(log(B/ǫ) log(1/δ)B2/ǫ2)) i.i.d. samples from any distribution D supported on F(K, B) outputs an ǫ-optimal solution to FD over K with probability ≥ 1− δ.\nThe case of general K can be handled by generalizing the approach in [RS15] or using the algorithms in [BLNR15, FGV15]. Note that for those algorithms the sample complexity will have a polynomial dependence on d (which is unavoidable in this general setting).\nIn contrast to these results, we will now demonstrate that for such problems an ERM algorithm will require an infinite number of samples to succeed already for d = 2. As in the proof of Thm. 3.7 we define fV (x) = ∑\nw∈V φ(〈w, x〉). However we can now use the lack of bounds on the Lipschitz constant (or smoothness) to use φ(a) that is equal to 0 for a ≤ 1− α and φ(1) = 1. For every m ≥ 2, we can choose a set of m vectors W evenly spaced on the unit circle such that for a sufficiently small α > 0, φ(〈w, x〉) will not interact with φ(〈w′, x〉), for any two distinct w,w′ ∈ W . More formally, let m be any positive integer, let wi . = (sin(2π · i/m), cos(2π · i/m)) and let Wm .= {wi | i ∈ [m]}. Let\nφα(a) . =\n{\n0 if a ≤ 1− α (a− 1 + α)/α otherwise.\nFor V ⊆ Wm we set α .= 2/m2 and define\nfV (x) . = ∑\nw∈V\nφα(〈w, x〉). (4)\nIt is easy to see that fV is convex. We now verify that the range of fV is [0, 1] on B22. Clearly, for any unit vector wi ∈ Wm, and x ∈ B22, 〈wi, x〉 ∈ [−1, 1] and therefore φα(〈wi, x〉) ∈ [0, 1]. Now it suffices to establish that for every x ∈ B22, there exists at most one vector w ∈ Wm such that φα(〈w, x〉) > 0. To see this, as in Lemma 3.6, we note that if φα(〈w, x〉) > 0 then 〈w, x〉 > 1 − α. For w ∈ Wm and x ∈ B22, this implies that ‖w − x‖ < √ 1 + 1− 2(1 − α) = √ 2α. For our choice of α = 2/m2, this implies that ‖w − x‖ < 2/m. On the other hand, for i 6= j ∈ [m], we have\n‖wi −wj‖ ≥ ‖w1 − wm‖ ≥ sin(2π/m) ≥ 2π/m− (2π/m)3/6 ≥ 4/m.\nTherefore there does not exist x such that φα(〈wi, x〉) > 0 and φα(〈wj , x〉) > 0. Now we can easily establish the lower bound.\nTheorem 4.2. Let K = B22 and m ≥ 2 be an integer. We define Hm . = {fV | V ⊆ W} for fV defined in eq. (4). Let Dm be the uniform distribution over Hm. Then for n ≤ logm and every set of samples S there exists an ERM x̂(S) such that\nPr S∼Dnm\n[FD(x̂(S))− F ∗ ≥ 1/2] > 1/2.\nProof. Let S = (fV1 , . . . , fVn) be the random samples. Clearly, F ∗ = 0 and minK(FS) = 0. Further, the analysis above implies that for every w ∈ Wm and V ⊆ Wm, fV (w) = 1 if w ∈ V and fV (w) = 0 otherwise. Hence FDm(w) = 1/2. Now, if ⋃ i∈[n]Vi 6= Wm then let x̂(S) . = w for any w ∈ Wm\\ ⋃\ni∈[n]Vi. Then for all i, hVi(x̂(S)) = 0 and hence FS(x̂(S)) = 0. This means that x̂(S) is a minimizer of FS and FDm(x̂(S)) − F ∗ = 1/2.\nNow, exactly as in Thm. 3.3, we can conclude that ⋃\ni∈[n]Vi = Wm with probability at most\n( 1− 2−n )m ≤ e−2−n·m ≤ e−1 < 1\n2 .\nThis lower bound holds for every m. This implies that the sample complexity of 1/2-optimizing F(B22 , 1) over B22 is infinite."
    }, {
      "heading" : "5 Discussion",
      "text" : "Our work points out to substantial limitations of the classic approach to understanding and analysis of generalization in the context of general SCO. One way to bypass our lower bounds is to use additional structural assumptions. For example, for generalized linear regression problems uniform convergence gives nearly optimal bounds on sample complexity [KST08]. One natural question is whether there exist more general classes of functions that capture most of the practically relevant SCO problems and enjoy dimensionindependent (or, scaling as log d) uniform convergence bounds. Note that the functions constructed in our lower bounds have description of size exponential in d and therefore are unlikely to apply to natural classes of functions.\nAn alternative approach is to bypass uniform convergence (and possibly also ERM) altogether. Among a large number of techniques that have been developed for ensuring generalization, the most general ones are based on notions of stability [BE02, SSSSS10]. However, known analyses based on stability often do not provide the strongest known generalization guarantees (e.g. high probability bounds require very strong assumptions). Another issue is that we lack general algorithmic tools for ensuring stability of the output. Therefore many open problems remain and significant progress is required to obtain a more comprehensive understanding of this approach. Some encouraging new developments in this area are the use of notions of stability derived from differential privacy [DFH+15] and the use of tools for analysis of convergence of convex optimization algorithms for proving stability [HRS15]."
    }, {
      "heading" : "Acknowledgements",
      "text" : "I am grateful to Ken Clarkson, Sasha Rakhlin and Thomas Steinke for discussions and insightful comments related to this work."
    } ],
    "references" : [ {
      "title" : "Escaping the local minima via simulated annealing: Optimization of approximately convex functions",
      "author" : [ "Alexandre Belloni", "Tengyuan Liang", "Hariharan Narayanan", "Alexander Rakhlin" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Belloni et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Belloni et al\\.",
      "year" : 2015
    }, {
      "title" : "Non-strongly-convex smooth stochastic approximation with convergence rate o(1/n)",
      "author" : [ "Francis R. Bach", "Eric Moulines" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Bach and Moulines.,? \\Q2013\\E",
      "shortCiteRegEx" : "Bach and Moulines.",
      "year" : 2013
    }, {
      "title" : "Convex optimization: Algorithms and complexity",
      "author" : [ "Sébastien Bubeck" ],
      "venue" : "Foundations and Trends in Machine Learning,",
      "citeRegEx" : "Bubeck.,? \\Q2015\\E",
      "shortCiteRegEx" : "Bubeck.",
      "year" : 2015
    }, {
      "title" : "On the generalization ability of on-line learning algorithms",
      "author" : [ "N. Cesa-Bianchi", "A. Conconi", "C. Gentile" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Cesa.Bianchi et al\\.,? \\Q2004\\E",
      "shortCiteRegEx" : "Cesa.Bianchi et al\\.",
      "year" : 2004
    }, {
      "title" : "Generalization in adaptive data analysis and holdout",
      "author" : [ "Cynthia Dwork", "Vitaly Feldman", "Moritz Hardt", "Toniann Pitassi", "Omer Reingold", "Aaron Roth" ],
      "venue" : "reuse. CoRR,",
      "citeRegEx" : "Dwork et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Dwork et al\\.",
      "year" : 2015
    }, {
      "title" : "Statistical query algorithms for stochastic convex optimization",
      "author" : [ "Vitaly Feldman", "Cristobal Guzman", "Santosh Vempala" ],
      "venue" : "CoRR, abs/1512.09170,",
      "citeRegEx" : "Feldman et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Feldman et al\\.",
      "year" : 2015
    }, {
      "title" : "Train faster, generalize better: Stability of stochastic gradient descent",
      "author" : [ "Moritz Hardt", "Benjamin Recht", "Yoram Singer" ],
      "venue" : "CoRR, abs/1509.01240,",
      "citeRegEx" : "Hardt et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Hardt et al\\.",
      "year" : 2015
    }, {
      "title" : "On the complexity of linear prediction: Risk bounds, margin bounds, and regularization",
      "author" : [ "S. Kakade", "K. Sridharan", "A. Tewari" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Kakade et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Kakade et al\\.",
      "year" : 2008
    }, {
      "title" : "Robust stochastic approximation approach to stochastic programming",
      "author" : [ "A. Nemirovski", "A. Juditsky", "G. Lan", "A. Shapiro" ],
      "venue" : "SIAM J. Optim.,",
      "citeRegEx" : "Nemirovski et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Nemirovski et al\\.",
      "year" : 2009
    }, {
      "title" : "Sequential probability assignment with binary alphabets and large classes of experts",
      "author" : [ "Alexander Rakhlin", "Karthik Sridharan" ],
      "venue" : "CoRR, abs/1501.07340,",
      "citeRegEx" : "Rakhlin and Sridharan.,? \\Q2015\\E",
      "shortCiteRegEx" : "Rakhlin and Sridharan.",
      "year" : 2015
    }, {
      "title" : "Making gradient descent optimal for strongly convex stochastic optimization",
      "author" : [ "Alexander Rakhlin", "Ohad Shamir", "Karthik Sridharan" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Rakhlin et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Rakhlin et al\\.",
      "year" : 2012
    }, {
      "title" : "On complexity of stochastic programming problems",
      "author" : [ "A. Shapiro", "A. Nemirovski" ],
      "venue" : null,
      "citeRegEx" : "Shapiro and Nemirovski.,? \\Q2005\\E",
      "shortCiteRegEx" : "Shapiro and Nemirovski.",
      "year" : 2005
    }, {
      "title" : "Understanding Machine Learning: From Theory to Algorithms",
      "author" : [ "Shai Shalev-Shwartz", "Shai Ben-David" ],
      "venue" : null,
      "citeRegEx" : "Shalev.Shwartz and Ben.David.,? \\Q2014\\E",
      "shortCiteRegEx" : "Shalev.Shwartz and Ben.David.",
      "year" : 2014
    }, {
      "title" : "Stochastic convex optimization",
      "author" : [ "S. Shalev-Shwartz", "O. Shamir", "N. Srebro", "K. Sridharan" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Shalev.Shwartz et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Shalev.Shwartz et al\\.",
      "year" : 2009
    }, {
      "title" : "Learnability, stability and uniform convergence",
      "author" : [ "Shai Shalev-Shwartz", "Ohad Shamir", "Nathan Srebro", "Karthik Sridharan" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "Shalev.Shwartz et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Shalev.Shwartz et al\\.",
      "year" : 2010
    }, {
      "title" : "Stochastic gradient descent for non-smooth optimization: Convergence results and optimal averaging schemes",
      "author" : [ "Ohad Shamir", "Tong Zhang" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Shamir and Zhang.,? \\Q2013\\E",
      "shortCiteRegEx" : "Shamir and Zhang.",
      "year" : 2013
    }, {
      "title" : "Statistical Learning Theory",
      "author" : [ "V. Vapnik" ],
      "venue" : "Wiley-Interscience, New York,",
      "citeRegEx" : "Vapnik.,? \\Q1998\\E",
      "shortCiteRegEx" : "Vapnik.",
      "year" : 1998
    } ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "In stochastic convex optimization the goal is to minimize a convex function F (x) . = Ef∼D[f(x)] over a convex set K ⊂ R where D is some unknown distribution and each f(·) in the support of D is convex over K. The optimization is commonly based on i.i.d. samples f, f, . . . , f from D. A standard approach to such problems is empirical risk minimization (ERM) that optimizes FS(x) . = 1 n ∑ i≤n f (x). Here we consider the question of how many samples are necessary for ERM to succeed and the closely related question of uniform convergence of FS to F over K. We demonstrate that in the standard lp/lq setting of Lipschitz-bounded functions over a K of bounded radius, ERM requires sample size that scales linearly with the dimension d. This nearly matches standard upper bounds and improves on Ω(log d) dependence proved for l2/l2 setting in [SSSS09]. In stark contrast, these problems can be solved using dimension-independent number of samples for l2/l2 setting and log d dependence for l1/l∞ setting using other approaches. We also demonstrate that for a more general class of rangebounded (but not Lipschitz-bounded) stochastic convex programs an even stronger gap appears already in dimension 2.",
    "creator" : "LaTeX with hyperref package"
  }
}