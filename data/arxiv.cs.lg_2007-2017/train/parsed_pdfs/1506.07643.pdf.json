{
  "name" : "1506.07643.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Conservativeness of untied auto-encoders",
    "authors" : [ "Daniel Jiwoong Im", "Mohamed Ishmael Diwan Belghanzi", "Roland Memisevic" ],
    "emails" : [ "imdaniel@iro.umontreal.ca", "mohamed.2.belghazi@hec.ca", "roland.memisevic@umontreal.ca" ],
    "sections" : [ {
      "heading" : "Introduction",
      "text" : "An auto-encoder is a feature learning model that learns to reconstruct its inputs by going though one or more capacityconstrained “bottleneck”-layers. Since it defines a mapping r : Rn → Rn, an auto-encoder can also be viewed as dynamical system, that is trained to have fixed points at the data (Seung 1998). Recent renewed interest in the dynamical systems perspective led to a variety of results that help clarify the role of auto-encoders and their relationship to probabilistic models. For example, (Vincent et al. 2008; Swersky et al. 2011) showed that training an auto-encoder to denoise corrupted inputs is closely related to performing score matching (Hyvärinen 2005) in an undirected model. Similarly, (Alain and Bengio 2014) showed that training the model to denoise inputs, or to reconstruct them under a suitable choice of regularization penalty, lets the autoencoder approximate the derivative of the empirical data density. And (Kamyshanska 2013) showed that, regardless of training criterion, any auto-encoder whose weights are tied (decoder-weights are identical to the encoder weights) can be written as the derivative of a scalar “potential-” or energy-function, which in turn can be viewed as unnormalized data log-probability. For sigmoid hidden units the potential function is exactly identical to the free energy of an RBM, which shows that there is tight link between these two types of model.\nThe same is not true for untied auto-encoders, for which it has not been clear whether such an energy function exists. It has also not been clear under which conditions an\n∗Authors constributed equally.\nenergy function exists or does not exist, or even how to define it in the case where decoder-weights differ from encoder weights. In this paper, we describe necessary and sufficient conditions for the existence of an energy function and we show that suitable learning criteria will lead to an autoencoder that satisfies these conditions at least locally, near the training data. We verify our results experimentally. We also show how we can use an auto-encoder to extract the conservative part of a vector field."
    }, {
      "heading" : "Background",
      "text" : "We will focus on auto-encoders of the form\nr(x) = Rh ( WTx + b ) + c (1)\nwhere x ∈ Rn is an observation, R and W are decoder and encoder weights, respectively, b and c are biases, and h(·) is an elementwise hidden activation function. An auto-encoder can be identified with its vector field, r(x) − x, which is the set of vectors pointing from observations to their reconstructions. The vector field is called conservative if it can be written as the gradient of a scalar function F (x), called potential or energy function:\nr(x)− x = ∇F (x) (2) The energy function corresponds to the unnormalized probability of data.\nIn this case, we can integrate the vector field to find the energy function (Kamyshanska 2013). For an auto-encoder with tied weights and real-valued observations it takes the form\nF (x) = ∫ h(u)du− 1\n2 ‖x− c‖22 + const (3)\nwhere u = WTx + b is an auxiliary variable and h(·) can be any elementwise activation function with known antiderivative. For example, the energy function of an autoencoder with sigmoid activation function is identical to the (Gaussian) RBM free energy (Hinton 2010):\nFsig(x) = ∑ k log ( 1 + exp ( WT·kx + bk )) −1 2 ‖x−c‖22+const (4) A sufficient condition for the existence of an energy function is that the weights are tied (Kamyshanska 2013), but it\nhas not been clear if this is also necessary. A peculiar phenomenon in practice is that it is very common for decoder and encoder weights to be “similar” (albeit not necessarily tied) in response to training. An example of this effect is shown in Figure 11. This raises the question of why this happens, and whether the quasi-tying of weights has anything to do with the emergence of an energy function, and if yes, whether there is a way to compute the energy function despite the lack of exact symmetry. We shall address these questions in what follows."
    }, {
      "heading" : "Conservative auto-encoders",
      "text" : "One of the central objectives of this paper is understanding the conditions for an auto-encoder to be conservative2 and thus to have a well-defined energy function. In the following subsection we derive and explain said conditions."
    }, {
      "heading" : "Conditions for conservative auto-encoders",
      "text" : "Proposition 1. Consider an m-hidden-layer auto-encoder defined as\nr(x; θ) = W (m)h(m) ( W (m−1)h(m−1)(\n· · ·W (1)h(1) (x) · · · ) + c(m−1) ) + c(m),\nwhere θ = ∪mk=0θ(k) such that θ(k) = {W (k), c(k)} are the parameters of the model, and h(k)(·) is a smooth elementwise activation function at layer k. Then the auto-encoder\n1We found these kinds of behaviours not only for unwhitened, but also for binary data.\n2The expressions, “conservative vector field” and “conservative auto-encoders” will be used interchangeably.\nis said to be conservative over a smooth simply connect domain K ⊆ RD if and only if its reconstruction’s Jacobian ∂r(x) ∂x is symmetric for all x ∈ K. A formal proof is provided in the Appendix. A region K is said to be simply connected if and only if any simple curve in K can be shrunk to a point. It is not always the case that a region of RD is simply connected. For instance, a curve surrounding a punctured circle in R2 cannot be continuously deformed to a point without crossing the punctured region. However, as long as we make the reasonable assumption that the activation function does not have a continuum of discontinuities, we should not run into trouble. This makes our analysis valid for activation functions with cusps such as ReLUs.\nThroughout the paper, our focus will be on one–hiddenlayer auto-encoders. Although the necessary and sufficient conditions for their conservativeness are a special case of the above proposition, it is worthwhile to derive them explicitly.\nProposition 2. Let r(x) be a one-hidden-layer autoencoder with D dimensional inputs and H hidden units,\nr(x) = Rh ( WTx + b ) + c,\nwhereR,W,b, c are the parameters of the model. Then r(x) defines a conservative vector field over a smooth simply connect domain K ⊆ RD if and only if RDh′WT is symmetric for all x ∈ K where Dh′ = diag (h′(x)).\nProof. Following proposition 1, an auto-encoder defines a conservative vector field if and only if its Jacobian is symmetric for all x ∈ K.\n∂r(x)\n∂x =\n( ∂r(x)\n∂x\n)T (5)\nBy explicitly calculating the Jacobian, this is equivalent to\n(∀1 ≤ i < j ≤ D) H∑ l=0 ( RjlWli −RilWlj ) h′l (x) = 0 (6)\nDefining Dh′ = diag(h ′ (x)), this holds if and only if\nRDh′W T = WDh′R T (7)\nFor one-hidden-layer auto-encoders with tied weights, Equation 7 holds regardless of the choice of activation function h and x.\nCorollary 1. An auto-encoder with tied weights always defines a conservative vector field.\nProposition 2 illustrates that the set of all one-layered tied auto-encoders is actually a subset of the set of all conservative one-layered auto-encoders. Moreover, the inclusion is strict. That is to say there are untied conservative autoencoders that are not trivially equivalent to tied ones. As example, let us compare the parametrization of tied and conservative untied linear one-layered auto-encoders. runtied(x) in Eq. 7 defines a conservative vector field if and only RWT = WRT which offers a richer parametrization than the tied linear auto-encoder rtied(x) = WWTx.\nIn the following section we explore in more detail and generality of the parametrization imposed by the conditions above."
    }, {
      "heading" : "Understanding the symmetricity condition",
      "text" : "Note that if symmetry holds in the Jacobian of an autoencoder’s reconstruction function, then the vector field is conservative. A sufficient condition for symmetry of the Jacobian is that R can be written\nR = CWDh′E. (8)\nwhere C and E are symmetric matrices, and C commutes with WDh′EDh′WT , as this will ensure symmetry of the partial derivatives:\n∂r(x)\n∂x = RDh′W\nT = CWDh′EDh′W T (9)\n= WDh′EDh′W TC = WDh′R T =\n( ∂r(x)\n∂x\n)T .\nThe case of tied weights (R = W ) follows if C and E are the identity, since then ∂r(x)∂x = RDh′W T = WDh′W T .\nNotice that R = CWDh′ and R = WDh′E are further special cases of the condition R = CWDh′E when E is the identity (first case) or C is the identity (second case). Moreover, we can also find matrices E and C given the parameters W and R, which is shown in Section 1.2 of the supplementary material3.\n3www.uoguelph.ca/˜imj/files/conservative_ ae_supplementary.pdf"
    }, {
      "heading" : "Conservativeness of trained auto-encoders",
      "text" : "Following (Alain and Bengio 2014) we will first assume that the true data distribution is known and the auto-encoder is trained. We then analyze the conservativeness of autoencoders around fixed points of the data manifold. After that, we will proceed to empirically investigate and explain the tendency of trained auto-encoders to become conservative away from the data manifold. Finally, we will use the obtained results to explain why the product of the encoder and decoder weights become increasingly symmetric in response to training."
    }, {
      "heading" : "Local Conservativeness",
      "text" : "Let r(x) be an auto-encoder that minimizes a contractionregularized squared loss function averaged over the true data distribution p,\nLσ(x) = ∫ Rd p(x) [ ‖r(x)− x‖22 + ‖ ∂r(x) ∂x ‖22 ] dx (10)\nA point x ∈ Rd is a fixed point of the auto-encoder if and only if r(x) = x. Proposition 3. Let r(x) be an untied one-layer autoencoder minimizing Equation 10. Then r(x) is locally conservative as the contraction parameter tends to zero.\nTaking a first order Taylor expansion of r(x) around a fixed point x yields\nr(x + ) = x + ∂r(x)\n∂x\nT\n+ o( ) as → 0. (11)\n(Alain and Bengio 2014) shows that the reconstruction r(x) − x becomes an estimator of the score when ‖r(x) − x‖2 is small and the contraction parameters λ → 0. Hence around a fixed point we have\nr(x + )− x = ∂ log(p(x)) ∂x , and (12)\n∂(r(x + )− x) ∂x = ∂2 log(p(x)) ∂x2 (13)\nwhere I is the identity matrix. By explicitly expressing the Jacobian of the autoencoder’s dynamics ∂r(x)−x∂x and using the Taylor expansion of r(x), we have\nWTDh′R T − I = ∂\n2 log(p(x))\n∂x2 (14)\nThe Hessian of log p(x) being symmetric, Equation 14 illustrates that around fixed points,RDh′W is symmetric. In conjunction with Proposition 2, this shows that untied autoencoders, when trained using a contractive regularizer, are locally conservative. Remark that when the auto-encoder is trained with patterns drawn from a continuous family, then auto-encoder forms a continuous attractor that lies near the examples it is trained on (Seung 1998).\nIt is worth noting that dynamics around fixed points can be understood by analyzing the eigenvalues of the Jacobian. The latter being symmetric implies that its eigenvalues cannot have complex parts, which corresponds to the lack of\noscillations one would naturally expect of a conservative vector field. Moreover, in directions orthogonal to the fixed point, the eigenvalues of the reconstruction will be negative. Thus the fixed point is actually a sink."
    }, {
      "heading" : "Empirical Conservativeness",
      "text" : "We now empirically analyze the conservativeness of trained untied auto-encoders. To this end, we train an untied autoencoder with 500 hidden units with and without weight length constraints4 on the MNIST dataset. We measure symmetricity using sym(A) = ‖(A+A\nT )/2‖2 ‖A‖2 which yields values\nbetween [0, 1] with 1 representing complete symmetricity. Figure 2a and 2c shows the evolution of the symmetricity of ∂r(x) ∂x = RDh′W during training. For untied auto-encoders, we observe that the Jacobian becomes increasingly symmetric as training proceeds and hence, by Proposition 2, the auto-encoder becomes increasingly conservative.\nThe contractive auto-encoder tends more towards symmetry than the unregularized auto-encoder. The reach plateaus\n4Weight length constraints : ||wi||2 = α for all i = 1 · · ·H and α is a constant term.\naround 0.951 and 0.974 respectively. It is interesting to note that auto-encoders with weight length constraints yield sensibly higher symmetricity scores as shown in Table 1. The details of the experiments and further interpretations are provided in the supplementary material.\nTo explicitly confirm the conservativeness of the autoencoder in 2D, we monitor the curl of the vector field during training. In our experiments, we created three 2D synthetic datasets by adding gaussian white noise to the parametrization of a line, a circle, and a spiral. As shown in Figure 3, we notice that the curl decrease very sharply during training, which further demonstrates how untied auto-encoders become more conservative during training. Hence, together with symmetricity measurement and decay of curliness advocates that vector fields near the data manifold has the tendancy of becoming conservative. More results on line, circle, and spiral synthetic datasets can be found in the supplementary materials."
    }, {
      "heading" : "Symmetricity of weights product",
      "text" : "The product of weight RWT tends to become increasingly symmetric during training. This behavior is more marked for sigmoid activations than for ReLUs as shown in Figures 2b and 2d. This can be explained by considering the Jacobian symmetricity. We approximately have\nH∑ l=1 (RilWlj −RjlWli)h′l(x) = 0,∀1 ≤ i, j ≤ d (15)\nThis implies that the activations of sigmoid hidden units, at least for training data points, are independent of h′(x) or\na constant. As shown in the supplementary material, most hidden unit activities are concentrated in the highest curvature region when training with weight length constraints. This forces hl(x) to be concentrated on high curvature regions of the sigmoid activation. This may be due to either h′l(x) being nearly constant for all l given x, or h′l(x) being close to linearly independent. In both cases, the Jacobian becomes close to the identity and hence RWT ≈WRT ."
    }, {
      "heading" : "Decomposing the Vector Field",
      "text" : "In this section, we consider finding the closest conservative vector field, in a least square sense, to a non-conservative vector field. Finding this vector field is of great practical importance in many areas of science and engineering (Bhatia et al. 2013). Here we show that conservative auto-encoders can provide a powerful, deep learning based perspective onto this problem.\nThe fundamental theorem of vector calculus, also known as Helmhotz decomposition states that any vector field in R3 can be expressed as the orthogonal sum of an irrotational and a solenoidal field. The Hodge decomposition is a generalization of this result to high dimensional space (James 1966). A complete statement of the result requires careful analysis of boundary conditions as well as differential form formalism. But since 1-forms correspond to vector field, and our interest lies in the latter, we abuse notation to state the result in the special case of 1-forms as\nω = dα+ δβ + γ (16)\nwhere d is the exterior derivative, δ the co-differential, and ∆γ = 0 5. This means that any 1-form (vector field) can be orthogonally decomposed into a direct sum of a scalar, solenoidal, and harmonic components.\nThis shows that it is always theoretically possible to get the closest conservative vector field, in a least square sense, to a non-conservative one. When applied to auto-encoders, this guarantees the existence of a best approximate energy function for any untied conservative auto-encoder. For a\n5For Laplace-deRham, ∆ = dδ + δd. Standard ∆ on 1-forms is dδ.\nmore detailed background on the vector field decomposition we refer to the supplementary material."
    }, {
      "heading" : "Extracting the Conservative Vector Field through Learning",
      "text" : "Although the explicit computation of the projection might be theoretically possible in special cases, we propose to find the best approximate conservative vector through learning. There are several advantages to learning the conservative part of a vector field: i) Learning the scalar vector field component α from some vector field ω with an auto-encoder is straightforward due to the intrinsic tendency of the trained auto-encoder to become conservative, ii) although there is a large body of literature to explicitly compute the projections, these methods are highly sensitive to boundary conditions (Bhatia et al. 2013), while learning based methods eschew this difficulty.\nThe advantage of deep learning based methods over existing approaches, such as matrix-valued radial basis function kernels (Macedo and Castro 2008), is that they can be trained on very large amounts of data. To the best of our knowledge, this is the first application of neural networks to extract the conservative part of any vector field, effectively recovering the scalar part of Eq. 16.\nTwo Dimensional space As a proof of concept, we first extract the conservative part of a two dimensional vector field F (x, y) = (−x+ y,−x− y). The field corresponds to a spiralling sink. We train an untied auto-encoder with 1000 ReLU units for 500 epochs using BFGS over an equally spaced grid of 100 points in each dimension. Figure 4 clearly shows that the conservative part is perfectly recovered.\nHigh Dimensional space We also conducted experiments with high dimensional vector fields. We created a continum of vector fields by considering convex combinations of a conservative and a non-conservative field. The former is obtained by training a tied auto-encoder on MNIST and the latter by setting the parameters of an auto-encoder to random values. That is, we have (Wi, Ri) = β(W0, R0) + (1− β)(WK , RK) where (W0, R0) is the non-conservative autoencoder and (WK , RK) is the conservative auto-encoder. We repeatedly train a tied auto-encoder on this continuum\nTable 2: The fraction of observations with E(x) > E(xrand) for different β values.\nβ 0.0 0.2 0.4 0.6 0.8 1.0 CVF=Tied AE 0.5036 0.7357 0.9338 0.98838 0.9960 0.9968 CVF=Untied AE 0.5072 0.7496 0.9373 0.98595 0.9958 0.9968\nin order to learn its conservative part. The pseudocode for the experiment is presented in Algorithm 1. Figure 5 shows\nAlgorithm 1 Learning to approximate a conservative field with an auto-encoder 1: procedure (D be a data set ) 2: Let (W0, R0) be a random weights for AE. 3: Let (WK , RK) be trained AE on D. 4: Generate Fi ∀i = 1 · · ·K as follows: • (Wi, Ri) = β(W0, R0) + (1− β)(WK , RK) • Sample xi from uniform distributon in the data space. • Fi = {(xi, r(xi))fori = 1 · · ·N}\n5: for each vector field Fi, do 6: Train a tied Auto-encoder on Fi 7: Compute E(x) where x ∈ D 8: Compute E(x̃) where x̃ ∼ Binomial 9: Count number of E(x) > E(x̃).\nthe mean squared error as a function of training epoch for different values of β. We observe that the auto-encoder’s loss function decreases as β gets closer to 1. This is due to auto-encoder only being able to learn the conservative component of the vector field. We then compare the unnormalized model evidence of the auto-encoders. The comparison is based on computing the potential energy of autoencoders given two points at a time. These two points are from the MNIST and a corrupted version of the latter using salt and pepper noise. We validate our experiments by counting the number of times where E(x) > E(xrand). Given that the weights (WK , RK) of the conservative auto-encoder are obtained by training it on MNIST, the potential energy at MNIST data points should be higher than that at the corrupted MNIST data points. However, this does not hold for β < 1. Even for β = 0.6, we can recover the conservative component of the vector field up to 93% . Thus, we conclude that the tied auto-encoder is able to learn the conservative component of the vector field. The procedure is detailed in Algorithm 1.\n0 50 100 150 200 Epochs\n0\n2\n4\n6\n8\n10\n12\n14\nM e a n R\ne co\nn st\nru ct\nio n E\nrr o r\nbeta=0.0 beta=0.2 beta=0.4 beta=0.6 beta=0.8 beta=1.0\nFigure 5: Learning curves for tied (dashed) and untied (solid) auto-encoders.\nTable 2 shows that, on average, the auto-encoders potential energy increasingly favors the original MNIST point over the corrupted ones as the vector field Fi moves from 0 to K. “CVF=Tied AE” refers to conservative vector field FK trained by tied auto-encoder and “CVF=Untied AE” refers to conservative vector field FK trained by untied autoencoder."
    }, {
      "heading" : "Discussion",
      "text" : "In this paper we derived necessary and sufficient conditions for autoencoders to be conservative, and we studied why the Jacobian of the autoencoder tends to become symmetric during training. Moreover, we introduced a way to extract the conservative component of a vector field based on these properties of auto-encoders.\nAn interesting direction for future research is the use of annealed importance sampling or similar sampling-based approaches to globally normalize the energy function values obtained from untied autoencoders. Another interesting direction is the use of parameterizations during training that will automatically satisfy the sufficient conditions for conservativeness but are less restrictive than weight tying."
    }, {
      "heading" : "Appendix",
      "text" : ""
    }, {
      "heading" : "Conservative auto-encoders",
      "text" : "This section provides detailed derivations of Proposition 1 in Section 3.\nProposition 1. Consider an m-hidden-layer auto-encoder defined as\nr(x; θ) = W (m)h(m) ( W (m−1)h(m−1)(\n· · ·W (1)h(1) (x) · · · ) + c(m−1) ) + c(m),\nwhere θ = ∪mk=0θ(k) such that θ(k) = {W (k), c(k)} are the parameters of the model, and h(k)(·) is a smooth elementwise activation function at layer k. Then the auto-encoder is said to be conservative over a smooth simply connect domain K ⊆ RD if and only if its reconstruction’s Jacobian ∂r(x) ∂x is symmetric for all x ∈ K.\nThe high level idea is that simply finding the antiderivative of an auto-encoder vector field as proposed in (Kamyshanska 2013) does not work for untied autoencoders. This is due to the difference in solving first order ordinary differential equations for tied auto-encoders and first order partial differential equations for untied autoencoders. Therefore, here we present a different approach that uses differential forms to facilitate the derivation of the existence condition of a potential energy function in the case of untied auto-encoders.\nThe advantage of differential forms is that they allow us to work with a generalized, coordinate free system. A differential form α of degree l (l-form) on a smooth domain K ⊆ Rd is an expression:\nα = D∑ i=1 fidxi. (17)\nUsing differential form algebra and exterior derivatives, we can show that the 1-form implied by an untied auto-encoder is exact, which means that α can be expressed as α = dβ for some β ∈ Λl−1(K). Let α be the 1-form implied by the vector field of an untied auto-encoder. Then, we have\nα = D∑ i=1 ridxi, and dα = D∑ i=1 d(ri ∧ dxi) (18)\nwhere ∧ is the exterior multiplication, d is the differential operatior on differential forms, and r(·) is the reconstruction function of the auto-encoder. Based on the exterior derivative properties, i) if f ∈ Λ0(K) then df = ∑D i=1 ∂f ∂xi\ndxi and ii) if α ∈ Λl(K) and β ∈ Λm(K) (Edelen 2011) then\nαβ = (−1)lmβα,\ndα = D∑ i=1 d(ri ∧ dxi) (19)\n= D∑ i,j=1 ∂ri ∂xj (dxj ∧ dxi) (20)\n= − ∑\n1≤i<j<D\n∂ri ∂xj\ndxi ∧ dxj + ∑\n1≤i<j<D\n∂rj ∂xi dxi ∧ dxj\n(21) = ∑\n1≤i<j<D\n( ∂ri ∂xj − ∂rj ∂xi ) dxi ∧ dxj (22)\nAccording to the Poincare’s theorem, which states that every exact form is closed and convsersely, if α is closed then it is exact in a simply connected region and α ∈ Λl(K), where α is closed if dα = 0. Then, by Poincare’s theorem, we see that\ndα = ∑\n1≤i<j<D\n( ∂ri ∂xj − ∂rj ∂xi ) dxi ∧ dxj = 0 (23)\nThis is equivalent to requiring the Jacobian to be symmetric for all x ∈ K."
    } ],
    "references" : [ {
      "title" : "and Bengio",
      "author" : [ "G. Alain" ],
      "venue" : "Y.",
      "citeRegEx" : "Alain and Bengio 2014",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "The helmtholz-hodge decomposition-a survey",
      "author" : [ "Bhatia" ],
      "venue" : "IEEE Transactions on visualization and computer graphics 19:1386–1404",
      "citeRegEx" : "Bhatia,? \\Q2013\\E",
      "shortCiteRegEx" : "Bhatia",
      "year" : 2013
    }, {
      "title" : "D",
      "author" : [ "Edelen" ],
      "venue" : "G.",
      "citeRegEx" : "Edelen 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "and Castro",
      "author" : [ "I. Macedo" ],
      "venue" : "R.",
      "citeRegEx" : "Macedo and Castro 2008",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "On autoencoders and score matching for energy based models",
      "author" : [ "Swersky" ],
      "venue" : "In International Conference on Machine Learning (ICML)",
      "citeRegEx" : "Swersky,? \\Q2011\\E",
      "shortCiteRegEx" : "Swersky",
      "year" : 2011
    }, {
      "title" : "Extracting and composing robust features with denoising autoencoders",
      "author" : [ "Vincent" ],
      "venue" : "In Proceedings of the 25th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "Vincent,? \\Q2008\\E",
      "shortCiteRegEx" : "Vincent",
      "year" : 2008
    } ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "We discuss necessary and sufficient conditions for an auto-encoder to define a conservative vector field, in which case it is associated with an energy function akin to the unnormalized log-probability of the data. We show that the conditions for conservativeness are more general than for encoder and decoder weights to be the same (“tied weights”), and that they also depend on the form of the hidden unit activation function, but that contractive training criteria, such as denoising, will enforce these conditions locally. Based on these observations, we show how we can use auto-encoders to extract the conservative component of a vector field. Introduction An auto-encoder is a feature learning model that learns to reconstruct its inputs by going though one or more capacityconstrained “bottleneck”-layers. Since it defines a mapping r : R → R, an auto-encoder can also be viewed as dynamical system, that is trained to have fixed points at the data (Seung 1998). Recent renewed interest in the dynamical systems perspective led to a variety of results that help clarify the role of auto-encoders and their relationship to probabilistic models. For example, (Vincent et al. 2008; Swersky et al. 2011) showed that training an auto-encoder to denoise corrupted inputs is closely related to performing score matching (Hyvärinen 2005) in an undirected model. Similarly, (Alain and Bengio 2014) showed that training the model to denoise inputs, or to reconstruct them under a suitable choice of regularization penalty, lets the autoencoder approximate the derivative of the empirical data density. And (Kamyshanska 2013) showed that, regardless of training criterion, any auto-encoder whose weights are tied (decoder-weights are identical to the encoder weights) can be written as the derivative of a scalar “potential-” or energy-function, which in turn can be viewed as unnormalized data log-probability. For sigmoid hidden units the potential function is exactly identical to the free energy of an RBM, which shows that there is tight link between these two types of model. The same is not true for untied auto-encoders, for which it has not been clear whether such an energy function exists. It has also not been clear under which conditions an ∗Authors constributed equally. energy function exists or does not exist, or even how to define it in the case where decoder-weights differ from encoder weights. In this paper, we describe necessary and sufficient conditions for the existence of an energy function and we show that suitable learning criteria will lead to an autoencoder that satisfies these conditions at least locally, near the training data. We verify our results experimentally. We also show how we can use an auto-encoder to extract the conservative part of a vector field. Background We will focus on auto-encoders of the form r(x) = Rh ( Wx + b ) + c (1) where x ∈ R is an observation, R and W are decoder and encoder weights, respectively, b and c are biases, and h(·) is an elementwise hidden activation function. An auto-encoder can be identified with its vector field, r(x) − x, which is the set of vectors pointing from observations to their reconstructions. The vector field is called conservative if it can be written as the gradient of a scalar function F (x), called potential or energy function: r(x)− x = ∇F (x) (2) The energy function corresponds to the unnormalized probability of data. In this case, we can integrate the vector field to find the energy function (Kamyshanska 2013). For an auto-encoder with tied weights and real-valued observations it takes the form F (x) = ∫ h(u)du− 1 2 ‖x− c‖2 + const (3) where u = Wx + b is an auxiliary variable and h(·) can be any elementwise activation function with known antiderivative. For example, the energy function of an autoencoder with sigmoid activation function is identical to the (Gaussian) RBM free energy (Hinton 2010):",
    "creator" : "LaTeX with hyperref package"
  }
}