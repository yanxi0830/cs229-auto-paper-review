{
  "name" : "1406.2582.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Probabilistic ODE Solvers with Runge-Kutta Means",
    "authors" : [ "Michael Schober", "David Duvenaud", "Philipp Hennig" ],
    "emails" : [ "mschober@tue.mpg.de", "dkd23@cam.ac.uk", "phennig@tue.mpg.de" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Differential equations are a basic feature of dynamical systems. Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8]. Here we address the latter, classic numerical problem. Runge-Kutta (RK) methods [9, 10] are standard tools for this purpose. Over more than a century, these algorithms have matured into a very well-understood, efficient framework [11].\nAs recently pointed out by Hennig and Hauberg [6], since Runge-Kutta methods are linear extrapolation methods, their structure can be emulated by Gaussian process (GP) regression algorithms. Such an algorithm was envisioned by Skilling in 1991 [5], and the idea has recently attracted both theoretical [8] and practical [6, 7] interest. By returning a posterior probability measure over the solution of the ODE problem, instead of a point estimate, Gaussian process solvers extend the functionality of RK solvers in ways that are particularly interesting for machine learning. Solution candidates can be drawn from the posterior and marginalized [7]. This can allow probabilistic solvers to stop earlier, and to deal (approximately) with probabilistically uncertain inputs and problem definitions [6]. However, current GP ODE solvers do not share the good theoretical convergence properties of Runge-Kutta methods. Specifically, they do not have high polynomial order, explained below.\nWe construct GP ODE solvers whose posterior mean functions exactly match those of the RK families of first, second and third order. This yields a probabilistic numerical method which combines the strengths of Runge-Kutta methods with the additional functionality of GP ODE solvers. It also provides a new interpretation of the classic algorithms, raising new conceptual questions.\nWhile our algorithm could be seen as a “Bayesian” version of the Runge-Kutta framework, a philosophically less loaded interpretation is that, where Runge-Kutta methods fit a single curve (a point estimate) to an IVP, our algorithm fits a probability distribution over such potential solutions, such that the mean of this distribution matches the Runge-Kutta estimate exactly. We find a family of models in the space of Gaussian process linear extrapolation methods with this property, and select a member of this family (fix the remaining degrees of freedom) through statistical estimation.\nar X\niv :1\n40 6.\n25 82\nv2 [\nst at\n.M L\n] 2\n4 O\nct 2"
    }, {
      "heading" : "2 Background",
      "text" : "An ODE Initial Value Problem (IVP) is to find a function x(t) ∶ R → RN such that the ordinary differential equation ẋ = f(x, t) (where ẋ = ∂x/∂t) holds for all t ∈ T = [t0, tH], and x(t0) = x0. We assume that a unique solution exists. To keep notation simple, we will treat x as scalar-valued; the multivariate extension is straightforward (it involves N separate GP models, explained in supp.).\nRunge-Kutta methods1 [9, 10] are carefully designed linear extrapolation methods operating on small contiguous subintervals [tn, tn + h] ⊂ T of length h. Assume for the moment that n = 0. Within [t0, t0 +h], an RK method of stage s collects evaluations yi = f(x̂i, t0 +hci) at s recursively defined input locations, i = 1, . . . , s, where x̂i is constructed linearly from the previously-evaluated yj<i as\nx̂i = x0 + h i−1\n∑ j=1 wijyj , (1)\nthen returns a single prediction for the solution of the IVP at t0 + h, as x̂(t0 + h) = x0 + h∑si=1 biyi (modern variants can also construct non-probabilistic error estimates, e.g. by combining the same observations into two different RK predictions [12]). In compact form,\nyi = f ⎛ ⎝ x0 + h i−1 ∑ j=1 wijyj , t0 + hci ⎞ ⎠ , i = 1, . . . , s, x̂(t0 + h) = x0 + h s ∑ i=1 biyi. (2)\nx̂(t0 +h) is then taken as the initial value for t1 = t0 +h and the process is repeated until tn +h ≥ tH . A Runge-Kutta method is thus identified by a lower-triangular matrix W = {wij}, and vectors c = [c1, . . . , cs], b = [b1, . . . , bs], often presented compactly in a Butcher tableau [13]:\nc1 0 c2 w21 0 c3 w31 w32 0 ⋮ ⋮ ⋮ ⋱ ⋱ cs ws1 ws2 ⋯ ws,s−1 0\nb1 b2 ⋯ bs−1 bs As Hennig and Hauberg [6] recently pointed out, the linear structure of the extrapolation steps in Runge-Kutta methods means that their algorithmic structure, the Butcher tableau, can be constructed naturally from a Gaussian process regression method over x(t), where the yi are treated as “observations” of ẋ(t0 + hci) and the x̂i are subsequent posterior estimates (more below). However, proper RK methods have structure that is not generally reproduced by an arbitrary Gaussian process prior on x: Their distinguishing property is that the approximation x̂ and the Taylor series of the true solution coincide at t0 + h up to the p-th term—their numerical error is bounded by ∣∣x(t0+h)− x̂(t0+h)∣∣ ≤Khp+1 for some constant K (higher orders are better, because h is assumed to be small). The method is then said to be of order p [11]. A method is consistent, if it is of order p = s. This is only possible for p < 5 [14, 15]. There are no methods of order p > s. High order is a strong desideratum for ODE solvers, not currently offered by Gaussian process extrapolators.\nTable 1 lists all consistent methods of order p ≤ 3 where s = p. For s = 1, only Euler’s method (linear extrapolation) is consistent. For s = 2, there exists a family of methods of order p = 2, parametrized\n1In this work, we only address so-called explicit RK methods (shortened to “Runge-Kutta methods” for simplicity). These are the base case of the extensive theory of RK methods. Many generalizations can be found in [11]. Extending the probabilistic framework discussed here to the wider Runge-Kutta class is not trivial.\nby a single parameter α ∈ (0,1], where α = 1/2 and α = 1 mark the midpoint rule and Heun’s method, respectively. For s = 3, third order methods are parameterized by two variables u, v ∈ (0,1]. Gaussian processes (GPs) are well-known in the NIPS community, so we omit an introduction. We will use the standard notation µ ∶ R → R for the mean function, and k ∶ R × R → R for the covariance function; kUV for Gram matrices of kernel values k(ui, vj), and analogous for the mean function: µT = [µ(t1), . . . , µ(tN)]. A GP prior p(x) = GP(x;µ, k) and observations (T,Y ) = {(t1, y1), . . . , (ts, ys)} having likelihood N (Y ;xT ,Λ) give rise to a posterior GPs(x;µs, ks) with\nµst = µt + ktT (kTT +Λ)−1(Y − µT ) and ksuv = kuv − kuT (kTT +Λ)−1kTv. (3)\nGPs are closed under linear maps. In particular, the joint distribution over x and its derivative is\np [(x ẋ )] = GP [(x ẋ ) ;( µ µ∂ ) ,( k k\n∂\nk∂ k∂ ∂ )] (4)\nwith µ∂ = ∂µ(t) ∂t , k∂ = ∂k(t, t ′) ∂t′ , k∂ = ∂k(t, t ′) ∂t , k∂ ∂ = ∂ 2k(t, t′) ∂t∂t′ . (5)\nA recursive algorithm analogous to RK methods can be constructed [5, 6] by setting the prior mean to the constant µ(t) = x0, then recursively estimating x̂i in some form from the current posterior over x. The choice in [6] is to set x̂i = µi(t0 + hci). “Observations” yi = f(x̂i, t0 + hci) are then incorporated with likelihood p(yi ∣x) = N (yi; ẋ(t0 + hci),Λ). This recursively gives estimates\nx̂(t0 + hci) = x0 + i−1\n∑ j=1\ni−1 ∑ `=1 k∂(t0 + hci, t0 + hc`)( K∂ ∂ +Λ)−1`j yj = x0 + h∑ j wijyj , (6)\nwith K∂ ∂ij = k∂ ∂(t0 + hci, t0 + hcj). The final prediction is the posterior mean at this point:\nx̂(t0 + h) = x0 + s\n∑ i=1\ns\n∑ j=1\nk∂(t0 + h, t0 + hcj)( K∂ ∂ +Λ)−1ji yi = x0 + h s\n∑ i biyi. (7)"
    }, {
      "heading" : "3 Results",
      "text" : "The described GP ODE estimate shares the algorithmic structure of RK methods (i.e. they both use weighted sums of the constructed estimates to extrapolate). However, in RK methods, weights and evaluation positions are found by careful analysis of the Taylor series of f , such that low-order terms cancel. In GP ODE solvers they arise, perhaps more naturally but also with less structure, by the choice of the ci and the kernel. In previous work [6, 7], both were chosen ad hoc, with no guarantee of convergence order. In fact, as is shown in the supplements, the choices in these two works—square-exponential kernel with finite length-scale, evaluations at the predictive mean—do not even give the first order convergence of Euler’s method. Below we present three specific regression models based on integrated Wiener covariance functions and specific evaluation points. Each model is the improper limit of a Gauss-Markov process, such that the posterior distribution after s evaluations is a proper Gaussian process, and the posterior mean function at t0 + h coincides exactly with the Runge-Kutta estimate. We will call these methods, which give a probabilistic interpretation to RK methods and extend them to return probability distributions, Gauss-Markov-Runge-Kutta (GMRK) methods, because they are based on Gauss-Markov priors and yield Runge-Kutta predictions."
    }, {
      "heading" : "3.1 Design choices and desiderata for a probabilistic ODE solver",
      "text" : "Although we are not the first to attempt constructing an ODE solver that returns a probability distribution, open questions still remain about what, exactly, the properties of such a probabilistic numerical method should be. Chkrebtii et al. [8] previously made the case that Gaussian measures are uniquely suited because solution spaces of ODEs are Banach spaces, and provided results on consistency. Above, we added the desideratum for the posterior mean to have high order, i.e. to reproduce the Runge-Kutta estimate. Below, three additional issues become apparent:\nMotivation of evaluation points Both Skilling [5] and Hennig and Hauberg [6] propose to put the “nodes” x̂(t0 + hci) at the current posterior mean of the belief. We will find that this can be made\nconsistent with the order requirement for the RK methods of first and second order. However, our third-order methods will be forced to use a node x̂(t0 + hci) that, albeit lying along a function w(t) in the reproducing kernel Hilbert space associated with the posterior GP covariance function, is not the mean function itself. It will remain open whether the algorithm can be amended to remove this blemish. However, as the nodes do not enter the GP regression formulation, their choice does not directly affect the probabilistic interpretation.\nExtension beyond the first extrapolation interval Importantly, the Runge-Kutta argument for convergence order only holds strictly for the first extrapolation interval [t0, t0 + h]. From the second interval onward, the RK step solves an estimated IVP, and begins to accumulate a global estimation error not bounded by the convergence order (an effect termed “Lady Windermere’s fan” by Wanner [16]). Should a probabilistic solver aim to faithfully reproduce this imperfect chain of RK solvers, or rather try to capture the accumulating global error? We investigate both options below.\nCalibration of uncertainty A question easily posed but hard to answer is what it means for the probability distribution returned by a probabilistic method to be well calibrated. For our Gaussian case, requiring RK order in the posterior mean determines all but one degree of freedom of an answer. The remaining parameter is the output scale of the kernel, the “error bar” of the estimate. We offer a relatively simple statistical argument below that fits this parameter based on observed values of f .\nWe can now proceed to the main results. In the following, we consider extrapolation algorithms based on Gaussian process priors with vanishing prior mean function, noise-free observation model (Λ = 0 in Eq. (3)). All covariance functions in question are integrals over the kernel k0(t̃, t̃′) = σ2 min(t̃ − τ, t̃′ − τ) (parameterized by scale σ2 > 0 and off-set τ ∈ R; valid on the domain t̃, t̃′ > τ ), the covariance of the Wiener process [17]. Such integrated Wiener processes are Gauss-Markov processes, of increasing order, so inference in these methods can be performed by filtering, at linear cost [18]. We will use the shorthands t = t̃ − τ and t′ = t̃′ − τ for inputs shifted by τ ."
    }, {
      "heading" : "3.2 Gauss-Markov methods matching Euler’s method",
      "text" : "Theorem 1. The once-integrated Wiener process prior p(x) = GP(x; 0, k1) with\nk1(t, t′) =∬ t̃,t̃′\nτ k0(u, v)dudv = σ2 (min 3(t, t′) 3 + ∣t − t′∣min 2(t, t′) 2 ) (8)\nchoosing evaluation nodes at the posterior mean gives rise to Euler’s method.\nProof. We show that the corresponding Butcher tableau from Table 1 holds. After “observing” the initial value, the second observation y1, constructed by evaluating f at the posterior mean at t0, is\ny1 = f (µ∣x0(t0), t0) = f ( k(t0, t0) k(t0, t0) x0, t0) = f(x0, t0), (9)\ndirectly from the definitions. The posterior mean after incorporating y1 is\nµ∣x0,y1(t0 + h) = [k(t0 + h, t0) k∂(t0 + h, t0)] [ k(t0, t0) k∂(t0, t0) k∂(t0, t0) k∂ ∂(t0, t0) ] −1 (x0 y1 ) = x0 + hy1.\n(10) An explicit linear algebraic derivation is available in the supplements."
    }, {
      "heading" : "3.3 Gauss-Markov methods matching all Runge-Kutta methods of second order",
      "text" : "Extending to second order is not as straightforward as integrating the Wiener process a second time. The theorem below shows that this only works after moving the onset −τ of the process towards infinity. Fortunately, this limit still leads to a proper posterior probability distribution. Theorem 2. Consider the twice-integrated Wiener process prior p(x) = GP(x; 0, k2) with\nk2(t, t′) =∬ t̃,t̃′\nτ k1(u, v)dudv = σ2 (min 5(t, t′) 20 + ∣t − t ′∣ 12 ((t + t′)min3(t, t′) − min 4(t, t′) 2 )) .\n(11) Choosing evaluation nodes at the posterior mean gives rise to the RK family of second order methods in the limit of τ →∞.\n(The twice-integrated Wiener process is a proper Gauss-Markov process for all finite values of τ and t̃, t̃′ > 0. In the limit of τ →∞, it turns into an improper prior of infinite local variance.)\nProof. The proof is analogous to the previous one. We need to show all equations given by the Butcher tableau and choice of parameters hold for any choice of α. The constraint for y1 holds trivially as in Eq. (9). Because y2 = f(x0 + hαy1, t0 + hα), we need to show µ∣x0,y1(t0 + hα) = x0 + hαy1. Therefore, let α ∈ (0,1] arbitrary but fixed:\nµ∣x0,y1(t0 + hα) = [k(t0 + h, t0) k∂(t0 + h, t0)] [ k(t0, t0) k∂(t0, t0) k∂ (t0, t0) k∂ ∂(t0, t0) ] −1 (x0 y1 )\n= [ t 3 0(10(hα) 2 +15hαt0+6t 2 0)\n120\nt20(6(hα) 2 +8hαt0+3t 2 0) 24 ] [ t50/20 t40/8 t40/8 t30/3]\n−1\n(x0 y1 )\n= [1 − 10(hα) 2\n3t20 hα + 2(hα)\n2 t0 ] (x0 y1 )\nÐÐÐ→ τ→∞ x0 + hαy1 (12)\nAs t0 = t̃0 − τ , the mismatched terms vanish for τ →∞. Finally, extending the vector and matrix with one more entry, a lengthy computation shows that limτ→∞ µ∣x0,y1,y2(t0 + h) = x0 + h(1 − 1/2α)y1 + h/2αy2 also holds, analogous to Eq. (10). Omitted details can be found in the supplements. They also include the final-step posterior covariance. Its finite values mean that this posterior indeed defines a proper GP."
    }, {
      "heading" : "3.4 A Gauss-Markov method matching Runge-Kutta methods of third order",
      "text" : "Moving from second to third order, additionally to the limit towards an improper prior, also requires a departure from the policy of placing extrapolation nodes at the posterior mean. Theorem 3. Consider the thrice-integrated Wiener process prior p(x) = GP(x; 0, k3) with\nk3(t, t′) =∬ t̃,t̃′\nτ k2(u, v)dudv\n= σ2 (min 7(t, t′) 252 + ∣t − t ′∣min4(t, t′) 720 (5 max2(t, t′) + 2tt′ + 3 min2(t, t′))) .\n(13)\nEvaluating twice at the posterior mean and a third time at a specific element of the posterior covariance functions’ RKHS gives rise to the entire family of RK methods of third order, in the limit of τ →∞.\nProof. The proof progresses entirely analogously as in Theorems 1 and 2, with one exception for the term where the mean does not match the RK weights exactly. This is the case for y3 = x0 + h[(v − v(v−u)/u(2−3u))y1 + v(v−u)/u(2−3u)y2] (see Table 1). The weights of Y which give the posterior mean at this point are given by kK−1 (cf. Eq. (3), which, in the limit, has value (see supp.):\nlim τ→∞\n[k(t0 + hv, t0) k∂(t0 + hv, t0) k∂(t0 + hv, t0 + hu)]K−1\n= [1 h(v − v 2\n2u ) h v\n2\n2u ]\n= [1 h (v − v(v−u) u(2−3u) −v(3v−2) 2(3u−2) ) h ( v(v−u) u(2−3u) +v(3v−2) 2(3u−2) )]\n= [1 h (v − v(v−u) u(2−3u) ) h ( v(v−u) u(2−3u) )] + [0 −h v(3v−2) 2(3u−2) h v(3v−2) 2(3u−2) ] (14)\nThis means that the final RK evaluation node does not lie at the posterior mean of the regressor. However, it can be produced by adding a correction term w(v) = µ(v) + ε(v)(y2 − y1) where\nε(v) = v 2 3v − 2 3u − 2\n(15)\nis a second-order polynomial in v. Since k is of third or higher order in v (depending on the value of u), w can be written as an element of the thrice integrated Wiener process’ RKHS [19, §6.1]. Importantly, the final extrapolation weights b under the limit of the Wiener process prior again match the RK weights exactly, regardless of how y3 is constructed.\nWe note in passing that Eq. (15) vanishes for v = 2/3. For this choice, the RK observation y2 is generated exactly at the posterior mean of the Gaussian process. Intriguingly, this is also the value for α for which the posterior variance at t0 + h is minimized."
    }, {
      "heading" : "3.5 Choosing the output scale",
      "text" : "The above theorems have shown that the first three families of Runge-Kutta methods can be constructed from repeatedly integrated Wiener process priors, giving a strong argument for the use of such priors in probabilistic numerical methods. However, requiring this match to a specific Runge-Kutta family in itself does not yet uniquely identify a particular kernel to be used: The posterior mean of a Gaussian process arising from noise-free observations is independent of the output scale (in our notation: σ2) of the covariance function (this can also be seen by inspecting Eq. (3)). Thus, the parameter σ2 can be chosen independent of the other parts of the algorithm, without breaking the match to Runge-Kutta. Several algorithms using the observed values of f to choose σ2 without major cost overhead have been proposed in the regression community before [e.g. 20, 21]. For this particular model an even more basic rule is possible: A simple derivation shows that, in all three families of methods defined above, the posterior belief over ∂sx/∂ts is a Wiener process, and the posterior mean function over the s-th derivative after all s steps is a constant function. The Gaussian model implies that the expected distance of this function from the (zero) prior mean should be the marginal standard deviation √ σ2. We choose σ2 such that this property is met, by setting σ2 = [∂sµs(t)/∂ts]2.\nFigure 1 shows conceptual sketches highlighting the structure of GMRK methods. Interestingly, in both the second- and third-order families, our proposed priors are improper, so the solver can not actually return a probability distribution until after the observation of all s gradients in the RK step.\nSome observations We close the main results by highlighting some non-obvious aspects. First, it is intriguing that higher convergence order results from repeated integration of Wiener processes. This repeated integration simultaneously adds to and weakens certain prior assumptions in the implicit (improper) Wiener prior: s-times integrated Wiener processes have marginal variance ks(t, t) ∝ t2s+1. Since many ODEs (e.g. linear ones) have solution paths of values O(exp(t)), it is tempting to wonder whether there exists a limit process of “infinitely-often integrated” Wiener processes giving natural coverage to this domain (the results on a linear ODE in Figure 1 show how the polynomial posteriors cannot cover the exponentially diverging true solution). In this context,\nit is also noteworthy that s-times integrated Wiener priors incorporate the lower-order results for s′ < s, so “highly-integrated” Wiener kernels can be used to match finite-order Runge-Kutta methods. Simultaneously, though, sample paths from an s-times integrated Wiener process are almost surely s-times differentiable. So it seems likely that achieving good performance with a Gauss-MarkovRunge-Kutta solver requires trading off the good marginal variance coverage of high-order Markov models (i.e. repeatedly integrated Wiener processes) against modelling non-smooth solution paths with lower degrees of integration. We leave this very interesting question for future work."
    }, {
      "heading" : "4 Experiments",
      "text" : "Since Runge-Kutta methods have been extensively studied for over a century [11], it is not necessary to evaluate their estimation performance again. Instead, we focus on an open conceptual question for the further development of probabilistic Runge-Kutta methods: If we accept high convergence order as a prerequisite to choose a probabilistic model, how should probabilistic ODE solvers continue after the first s steps? Purely from an inference perspective, it seems unnatural to introduce new evaluations of x (as opposed to ẋ) at t0 + nh for n = 1,2, . . . . Also, with the exception of the Euler case, the posterior covariance after s evaluations is of such a form that its renewed use in the next interval will not give Runge-Kutta estimates. Three options suggest themselves:\nNaïve Chaining One could simply re-start the algorithm several times as if the previous step had created a novel IVP. This amounts to the classic RK setup. However, it does not produce a joint “global” posterior probability distribution (Figure 2, left column).\nSmoothing An ad-hoc remedy is to run the algorithm in the “Naïve chaining” mode above, producing N × s gradient observations and N function evaluations, but then compute a joint posterior distribution by using the first s gradient observations and 1 function evaluation as described in Section 3, then using the remaining s(N − 1) gradients and (N − 1) function values as in standard GP inference. The appeal of this approach is that it produces a GP posterior whose mean goes through the RK points (Figure 2, center column). But from a probabilistic standpoint it seems contrived. In particular, it produces a very confident posterior covariance, which does not capture global error.\nContinuing after s evaluations Perhaps most natural from the probabilistic viewpoint is to break with the RK framework after the first RK step, and simply continue to collect gradient observations— either at RK locations, or anywhere else. The strength of this choice is that it produces a continuously growing marginal variance (Figure 2, right). One may perceive the departure from the established RK paradigm as problematic. However, we note again that the core theoretical argument for RK methods is only strictly valid in the first step, the argument for iterative continuation is a lot weaker.\nFigure 2 shows exemplary results for these three approaches on the (stiff) linear IVP ẋ(t) = −1/2x(t), x(0) = 1. Naïve chaining does not lead to a globally consistent probability distribution. Smoothing does give this global distribution, but the “observations” of function values create unnatural nodes of certainty in the posterior. The probabilistically most appealing mode of continuing inference directly offers a naturally increasing estimate of global error. At least for this simple test case, it also happens to work better in practice (note good match to ground truth in the plots). We have found similar results for other test cases, notably also for non-stiff linear differential equations. But of course, probabilistic continuation breaks with at least the traditional mode of operation for Runge-Kutta methods, so a closer theoretical evaluation is necessary, which we are planning for a follow-up publication.\nComparison to Square-Exponential kernel Since all theoretical guarantees are given in forms of upper bounds for the RK methods, the application of different GP models might still be favorable in practice. We compared the continuation method from Fig. 2 (right column) to the ad-hoc choice of a square-exponential (SE) kernel model, which was used by Hennig and Hauberg [6] (Fig. 3). For this test case, the GMRK method surpasses the SE-kernel algorithm both in accuracy and calibration: its mean is closer to the true solution than the SE method, and its error bar covers the true solution, while the SE method is over-confident. This advantage in calibration is likely due to the more natural choice of the output scale σ2 in the GMRK framework."
    }, {
      "heading" : "5 Conclusions",
      "text" : "We derived an interpretation of Runge-Kutta methods in terms of the limit of Gaussian process regression with integrated Wiener covariance functions, and a structured but nontrivial extrapolation model. The result is a class of probabilistic numerical methods returning Gaussian process posterior distributions whose means can match Runge-Kutta estimates exactly.\nThis class of methods has practical value, particularly to machine learning, where previous work has shown that the probability distribution returned by GP ODE solvers adds important functionality over those of point estimators. But these results also raise pressing open questions about probabilistic ODE solvers. This includes the question of how the GP interpretation of RK methods can be extended beyond the 3rd order, and how ODE solvers should proceed after the first stage of evaluations."
    }, {
      "heading" : "Acknowledgments",
      "text" : "The authors are grateful to Simo Särkkä for a helpful discussion."
    }, {
      "heading" : "A Multivariate extension",
      "text" : "The GMRK model can be extended to the multivariate case analogously to Runge-Kutta methods. All equations in the RK framework also work with vector-valued function values, and all derivations presented in the paper and in this supplement carry over to the non-scalar case without modification: Consider dimension j ∈ {1, . . . ,N}. The projected outputs are the same as if j were an independent one-dimensional problem, which can be modeled with a separate Gaussian process. For a joint notation, vectorize the N dimensions with a Kronecker product: if k(t, t′) is an one-dimensional covariance function, the function\nk̄(t, t′) =Dijk(ti, t′j), (16)\nwhere D is an N ×N positive semi-definite matrix, defines a covariance function over N dimensions, if t and t′ are N dimensional. Choosing D = I results in a N -dimensional GP model where output dimensions are independent of each other as required."
    }, {
      "heading" : "B Covariance functions of integrated Wiener processes",
      "text" : "It was observed that integrated Wiener processes generate RK methods of various order with higher number of integrations leading to RK methods of higher order.\nHere we present the derivation of the covariance functions of the applied Wiener process kernels as well as their derivatives as needed.\nB.1 The once integrated Wiener process\nThe Wiener process covariance function is given by\nkWP (t, t′) = σ2 min(t, t′) (17)\nIt is only defined for t, t′ > 0. Integration with respect to both arguments leads to the once integrated Wiener process which is once differentiable. Its covariance function is\nk1(t, t′) = ∫ t\n0 du∫\nt′\n0 dv σ2 min(u, v)\n= σ2 ∫ t\n0 du∫\nt′\n0 dv min(u, v)\nt>t′= σ2 (∫ t\nt′ du∫\nt′\n0 dv v + 2∫\nt′\n0 du∫\nu\n0 dv v)\n= σ2 (∫ t\nt′ du\n1 2 t′2 + 2∫\nt′\n0 du\n1 2 u2)\n= σ2 (1 2 (t − t′)t′2 + 1 3 (t′3))\n= σ2 (min 3(t, t′) 3 + ∣t − t′∣min 2(t, t′) 2 ) (18)\nwhere t, t′ were replaced with min(t, t′) and max(t, t′) at the last step.\n2http://probabilistic-numerics.org/ODEs.html\nThe necessary derivatives of this kernel are\nk∂(t, t′) = σ2 ⎧⎪⎪⎨⎪⎪⎩ t < t′ ∶ t 2 2 t > t′ ∶ (tt′ − t ′2 2 )\n(19)\nk∂ ∂(t, t′) = σ2 min(t, t′) = kWP (t, t′). (20)\nB.2 The twice integrated Wiener process\nIterating this process leads to the twice integrated Wiener process. Its covariance function is\nk2(t, t′) = σ2 (∫ t\n0 du∫\nt′\n0 dv min3(u, v) 3 + ∣u − v∣min 2(u, v) 2 )\nt>t′= σ2 ((∫ t\nt′ du∫\nt′\n0 dv (u − v)v\n2\n2 + v\n3\n3 ) + (∫\nt′\n0 du∫\nu\n0 dv (u − v)v\n2\n2 + v\n3\n3 )\n+ (∫ v\n0 du∫\nt′\n0 dv (v − u)u\n2\n2 + u\n3\n3 ))\n⋮\n= σ2 (min 5(t, t′) 20 + ∣t − t ′∣ 12 ((t + t′)min3(t, t′) − min 4(t, t′) 2 )) (21)\nDerivatives of this kernel are\nk∂(t, t′) = σ2 ⎧⎪⎪⎨⎪⎪⎩ t > t′ ∶ ( t ′2 24 (t′2 − 4tt′ + 6t2)) t ≤ t′ ∶ (− t 4 24 + t ′t3 6 ) (22)\nk∂ ∂(t, t′) = σ2 (min 3(t, t′) 3 + ∣t − t′∣min 2(t, t′) 2 ) = k1(t, t′). (23)\nB.3 The thrice integrated Wiener process\nSimilarly, the thrice integrated Wiener process is obtained by\nk3(t, t′) = σ2 (∫ t\n0 du∫\nt′\n0 dv min5(u, v) 20 + ∣u − v∣ 12 ((u + v)min3(u, v) − min 4(u, v) 2 ))\n⋮\n= σ2 (min 7(t, t′) 252 + ∣t − t ′∣min4(t, t′) 720 (5 max2(t, t′) + 2tt′ + 3 min2(t, t′))) (24)\nOmitted steps are similar as in the derivation of (18) and (21).\nIts derivatives are given by\nk∂(t, t′) = σ2 ⎧⎪⎪⎨⎪⎪⎩ t > t′ ∶ ( t ′3 720 (20t3 − 15t2t′ + 6tt′2 − t′3)) t ≤ t′ ∶ ( t 4 720 (15t′2 − 6tt′ + t2))\n(25)\nk∂ ∂(t, t′) = σ2 (min 5(t, t′) 20 + ∣t − t ′∣ 12 ((t + t′)min3(t, t′) − min 4(t, t′) 2 )) = k2(t, t′). (26)"
    }, {
      "heading" : "C Posterior predictive GP distributions",
      "text" : "In order to build GMRK methods it is necessary to compute closed forms of the resulting posterior mean and covariance functions after s evaluations. Forms are given below. In cases where a derivation is omitted, results were obtained with MATLAB’s Symbolic Math Toolbox. Code is available online.\nC.1 Posterior predictive mean and covariance functions of the once integrated WP\nBelow are the formulas of the posterior mean and covariance of the once integrated WP after each step.\nµ∣x0(t) = k(t, t0) k(t0, t0) x0\n= t30/3 + ∣t − t0∣t20/2\nt30/3 x0\n= (1 + ∣t − t0∣ 3\n2t0 )x0 (27)\nµ∣x0,y1(t) = [k(t, t0) k∂(t, t0)] [ k(t0, t0) k∂(t0, t0) k∂ (t0, t0) k∂ ∂(t0, t0) ] −1\n´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶ =∶K\n(x0 y1 )\n= ⎧⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎩ t ≥ t0 ∶ 1∣K∣ [t 2t0/2 − t3/6 t2/2] [ t0 − t20/2 −t20/2 t30/3 ]( x0 y1 ) t < t0 ∶ 1∣K∣ [tt 2 0/2 − t30/6 tt0 − t20/2] [ t0 −t20/2 −t20/2 t30/3 ]( x0 y1 )\n⋮\n= ⎧⎪⎪⎨⎪⎪⎩ t ≥ t0 ∶ x0 + (t − t0)y1 t < t0 ∶ 3t 2t0−2t 3 t30 x0 − t 2t0−t 3 t20 y1\n(28)\nEqs. (27) and (28) also complete the proof of Theorem 1 by observing that y1 = f(x0, t0) = f(µ∣x0(t0), t0) and x1 = x0 + hy1 = µ∣x0,y1(t0 + h), which match Euler’s method.\nWithout loss of generality, we can assume that t′ ≤ t. With this convention the posterior covariances functions are\nk∣x0(t, t ′) = k1(t, t′) − k 1(t, t0)k1(t0, t′) k1(t0, t0)\n=(min 3(t, t′) 3 + ∣t − t′∣min 2(t, t′) 2 )\n− 1 24t30\n(min2(t, t0)min2(t0, t′)(t + t0 + 2∣t − t0∣)(t′ + t0 + 2∣t′ − t0∣)) (29)\nk∣x0,y1(t, t ′) = k1(t, t′) − [k(t, t0) k∂(t, t0)]K−1 [ k(t0, t′) k∂ (t0, t′) ]\n⋮\n= ⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩ t, t′ > t0 ∶ (t0−t ′ ) 2 (3t−t′−2t0) 6 t > t0 ≥ t′ ∶ 0 t, t′ ≤ t0 ∶ t ′2 (t0−t) 2 (3tt0−t ′t0−2tt′) 6t30\n(30)\nC.2 Predictive mean and covariance of the twice integrated WP\nBelow are the formulas for the posterior mean for the twice integrated WP and the generic 2-stage RK method. Throughout, we write µ(t) = µ(t0 + s) with appropriate s ∈ R, which will simplify formulas significantly. Furthermore, we omit stating the generating formulas and intermediate steps as the former are analogous to the ones in Sec. C.1 and the latter were performed with MATLAB’s\nSymbolic Math Toolbox.\nµ∣x0(t0 + s) = [1 + 5s 2t0 + 5s\n2\n3t20 + I(−∞,s) (\ns5 6t50 )]x0 (31)\nµ∣x0,y1(t0 + s) = [1 − 10s\n2\n3t20 + I(−∞,s) (\n5s4\nt40 + 8s\n5\n3t50 )]x0\n+ [s + 2s 2\nt0 − I(−∞,s) (\n2s4\nt30 + s\n5\nt40 )] y0\n(32)\nlim t0→∞\nµ∣x0,y1,y2(t0 + s) = x0 + (s − s2\n2hα ) y1 +\ns2\n2hα y2 (33)\nAs was the case for the posterior mean, we will write the posterior covariance function as k(t, t′) = k(t0 + s, t0 + s′) while also assuming w.l.o.g. that s′ ≤ s. The posterior covariance functions are then given by:\nk∣x0(t0 + s, t0 + s ′) =ss\n′\n48 t30 + (ss′2 + s2s′) t20 24 + s 2s′2 9 t0\n+( ∣s∣ 5 240 + s 2s′3 24 + s 3s′2 24 − ss ′4 48 − s 4s′ 48 + ∣s ′∣5 240 − ∣s ′ − s∣5 240 ) t00\n− (ss′5 + s5s′ − s∣s′∣5 − s′∣s∣5) t −1 0 96 − (s2s′5 + s5s′2 − s2∣s′∣5 − s′2∣s∣5) t −2 0 144 − (s5 − ∣s∣5) (s′5 − ∣s′∣5) t −5 0\n2880 (34)\nÐÐÐ→ t0→∞ ∞\nk∣x0,y1(t0 + s, t0 + s ′) = ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ s, s′ > 0 ∶ s ′5 240 + s 2s′3 24 + s 3s′2 24 − ∣s ′ −s∣5 240 + s 5 240 − ss ′4 48 − s 4s′ 48 + s 2s′2 36 t0 s > 0 ≥ s′ ∶ s 2s′2(s′+t0)3 36t02 s, s′ ≤ 0 ∶ s 2s′3 24 − s ′5 240 + s 3s′2 24 − ∣s ′ −s∣5 240 − s 5 240 + ss ′4 48 + s 4s′ 48 + s 2s′2 36 t0 + s 2s′2(s2+s′2) 12t0 + s 2s′2(s3+s′3) 36t20 − s 4s′4(s′+s) 24t40 − s 4s′4 12t03 − s 5s′5 45t05\n(35) ÐÐÐ→ t0→∞ ∞\nFor the final posterior covariance, it is also necessary to distinguish between the cases whether s, s′ ≥ hα, s ≥ hα > s′ and s, s′ ≤ hα.\nk∣x0,y1,y2(t0 + s, t0 + s ′) = ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ s, s′ > (hα) ∶ [(8s′5 − 40ss′4 + 80(s2s′3 + (hα)2(s2s′ + ss′2)) −20(hα)3(s2 + s′2) − 160(hα)s2s′2) t0 −15(hα)6 + 60(hα)5(s + s′) − 90(hα)4(s2 + s′2) +24(hα)s′5 + 360(hα)3(ss′2 + s2s′) −120(hα)ss′4 − 540(hα)2s2s′2 + 240(hα)s2s′3 −240(hα)4ss′] [960t0 + 2880hα]−1 s > (hα) ≥ s′ > 0 ∶ [(20(s2s′4 − (hα)4s′2) + 80(hα)3ss′2 + 8(hα)s′5 −40((hα)2s2s′2 + (hα)ss′4)) t0 + 24(hα)2s′5 +15(hα)3s′4 − 60(hα)4s′3 − 180(hα)2ss′4 +240(hα)3ss′3 − 120(hα)2s2s′3 + 90(hα)s2s′4] [960t0hα + 2880(hα)2] −1 s > (hα) > 0 ≥ s′ ∶ [(hα)s′2(s′ + t0)3 (4(hα)s − 2s2 − (hα)2)] [48t20(t0 + 3(hα))] −1 (hα) ≥ s, s′ > 0 ∶ [(80(hα)2s2s′2((hα) − s) − 40(hα)2ss′4 +8(hα)2s′5 + 20(hα)s2s′2(s2 + s′2)) t0 −15s4s′4 + 24(hα)3s′5 − 120(hα)3ss′4 +240(hα)2s2s′3((hα) − s) +60(hα)s3s′3(s + s′)] [960t0(hα)2 + 2880(hα)3] −1 (hα) ≥ s > 0 ≥ s′ ∶ [s2s′2(s′ + t0)3(s − 2(hα))2] [48t20(hα)(t0 + 3(hα))] −1 s, s′ ≤ 0 ∶ − [s2(s′ + t0)3 (8s3s′2 − 9s3s′t0 + 3s3t20 +15s2s′t0(s′ − t0) − 10s′2t30)] [360t50] −1 − [s2s′2(s + t0)3(s′ + t0)3] [36t40(t0 + 3(hα))] −1\n(36)\nlim t0→∞\nk∣x0,y1,y2(t0 + s, t0 + s ′) = ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ s, s′ > (hα) ∶ [s′3/12 − (hα)s′2/6 + (hα)2s′/12 − (hα)3/48] s2 [(hα)2s′2/12 − s′4/24] s + s′5/120 − (hα)3s′2/48 s > (hα) ≥ s′ > 0 ∶ [s′2 (20(hα)3s − 10(hα)s((hα)s + s′2) +2(hα)s′3 + 5(s2s′2 − (hα)4))] [240(hα)]−1 s > (hα) > 0 ≥ s′ ∶ −1/48 [(hα)s′2((hα)2 − 4(hα)s + 2s2] (hα) ≥ s, s′ > 0 ∶ [s′2 (20(hα)s2((hα) − s) − 10(hα)ss′2 +2(hα)s′3 + 5s2(s2 + s′2))] [240(hα)]−1 (hα) ≥ s > 0 ≥ s′ ∶ [s2s′2(s − 2(hα))2] [48(hα)]−1\ns, s′ ≤ 0 ∶ −1/120 [s2(s3 − 5s2s′ + 10ss′2 − 10(hα)s′2] (37)\nEq. (37) concludes the proof of Theorem 2 as it shows that the covariance function after the RK step is finite for all values of s, s′.\nC.3 Posterior predictive mean and covariance of the thrice integrated WP\nHere we list the equations of posterior mean and covariance for the thrice integrated WP and the generic 3-stage RK method. The same structure as in Sec. C.2 was applied.\nlim t0→∞ µ∣x0(t0 + s) = x0 (38)\nlim t0→∞ µ∣x0,y1(t0 + s) = x0 + sy1 (39)\nlim t0→∞\nµ∣x0,y1,y2(t0 + s) = x0 + (s − s2\n2hu ) y1 +\ns2\n2hu y2 (40)\nlim t0→∞ µ∣x0,y1,y2,y3(t0 + s) = x0 + ⎛ ⎝ s −\nh( s 2u 2 + s 2v 2 ) − s 3 3\nh2uv\n⎞ ⎠ y1 (41)\n+ (s 2(2s − 3hv)\n6h2u(u − v) ) y2 + (− s2(2s − 3hu) 6h2v(u − v) ) y3 (42)\nAs in the case of the twice integrated Wiener process, the covariance function is infinite for limt0→∞. Therefore, we only list the final posterior covariance function.\nFor s, s′ > hv > hu > 0: lim t0→∞ k∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\n{[−21h5u(s2 + s′2) + 14h4(s3 + s′3)] v5 + [−21h5u2(s2 + s′2) + 14h4u(s3 + s′3) +126h4u(s2s′ + ss′2) − 84h3(s3s′ + ss′3)] v4 + [−21h5u3(s2 + s′2) + 14h4u2(s3 + s′3) +126h4u2(s2s′ + ss′2) − 84h3u(s3s′ + ss′3) − 630h3us2s′2 + 210h2(s3s′2 + s2s′3)] v3\n+ [−21h5u4(s2 + s′2) + 14h4u3(s3 + s′3) + 126h4u3(s2s′ + ss′2) − 84h3u2(s3s′ + ss′3) −252h3u2s2s′2 + 378h2u(s3s′2 + s2s′3) − 392hs3s′3] v2 + [14h4u4(s3 + s′3)\n− 84h3u3(s3s′ + ss′3) + 126h2u2(s3s′2 − s2s′2 + s2s′3) − 224hus3s′3 + 210s3s′4 − 126s2s′5\n+42ss′6 − 6s′7] v + 42h2u3(s3s′2 + s2s′3) −56hu2s3s′3} /(30240v) (43)\nFor s > hv ≥ s′ > hu > 0: lim t0→∞ k∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\n{ (21h7us′2 − 14h6s′3) v6 + (−126suh6s′2 + 84sh5s′3) v5\n+ (315uh5s2s′2 − 210h4s2s′3)v4\n+ (−378h5s2s′2u2 − 168h4s3s′2u + 252h4s2s′3u + 112h3s3s′3)v3\n+ (−21h7s2u5 − 21h7s′2u5 + 126h6s2s′u4 + 126h6ss′2u4 − 126h5s2s′2u3 + 252h4s3s′2u2\n+ 252h4s2s′3u2 − 168h3s3s′3u − 315h3s2s′4u + 126h2s2s′5 − 42h2ss′6 + 6h2s′7)v2\n+ (14h6s3u5 − 84h5s3s′u4 − 126h5s2s′2u4 − 84h5ss′3u4 + 84h4s3s′2u3\n+ 84h4s2s′3u3 − 168h3s3s′3u2 + 210h2s3s′4u + 42h2ss′6u − 6h2s′7u − 84hs3s′5)v +42h4s3s′2u4+42h4s2s′3u4−56h3s3s′3u3−21hs2s′6u+14s3s′6}/(−30240h2v2+30240uh2v)\n(44) For s > hv > hu ≥ s′ > 0:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\ns′2\n30240h2uv [ − 21h7(u5v2 + u4v3 + u3v4 + u2v5) − 21hs2s′4(u + v) − 126h4s2u3v(hu − s′)\n+ 126h6s(u4v2 + u3v3 + u2v4) + 14h6s′(u5v + u4v2 + u3v3 + u2v4 + uv5) + 14s3s′4\n+ 63h5u3v2s2 − 315h5u2v3s2 − 84h5ss′(u4v + u3v2 + u2v3 + uv4) − 84h4u3vs3\n+ 42h4u4s2(s + s′) − 42h4u2v2s2s′ + 42h2uvss′4 + 168h4u2v2s3 + 210h4uv3s2s′\n− 56h3u2s3s′(u − v) − 112h3uv2s3s′ − 6h2uvs′5] (45)\nFor s > hv > hu > 0 ≥ s′:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\nhs′2\n4320v [(−3h4u4v2 − 3h4u3v3 − 3h4u2v4 − 3h4uv5 + 18h3su3v2 + 18h3su2v3 + 18h3suv4\n+ 2s′h3u4v + 2s′h3u3v2 + 2s′h3u2v3 + 2s′h3uv4 + 2s′h3v5 − 18h2s2u3v + 9h2s2u2v2\n− 45h2s2uv3 − 12s′h2su3v − 12s′h2su2v2 − 12s′h2suv3 − 12s′h2sv4 + 6hs3u3\n− 12hs3u2v + 24hs3uv2 + 6s′hs2u3 + 18s′hs2u2v − 6s′hs2uv2 + 30s′hs2v3 − 8s′s3u2\n+ 8s′s3uv − 16s′s3v2)] (46)\nFor hv ≥ s, s′ > hu > 0:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\n{(378h5s2s′2u2 − 252h4s3s′2u − 252h4s2s′3u + 168h3s3s′3)v3\n+ (21h7s2u5 + 21h7s′2u5 − 126h6s2s′u4 − 126h6ss′2u4 + 126h5s2s′2u3\n− 252h4s3s′2u2 − 252h4s2s′3u2 + 315h3s4s′2u + 168h3s3s′3u + 315h3s2s′4u′\n− 210h2s4s′3 − 126h2s2s′5 + 42h2ss′6 − 6h2s′7)v2\n+ (−14h6s3u5 − 14h6s′3u5 + 84h5s3s′u4 + 126h5s2s′2u4 + 84h5ss′3u4\n− 84h4s3s′2u3 − 84h4s2s′3u3 + 168h3s3s′3u2 − 126h2s5s′2u − 126h2s5s′2u − 210h2s3s′4u − 42h2ss′6u + 6h2s′7u + 84hs5s′3 + 84hs3s′6)v\n− 42h4s3s′2u4 − 42h4s2s′3u4 + 56h3s3s′3u3 + 21hs6s′2u + 21hs2s′6u − 14s6s′3 − 14s3s′6}/(30240h2v2 − 30240uh2v) (47)\nFor hv ≥ s > hu ≥ s′ > 0:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\ns′2\n30240h2uv(u − v) [ − 21h7u6v2 − 21hu2s6 − 21hs2s′4(u2 − v2) + 126h2u2vs5\n+ 126h4u4vs(h2uv − hus − s2) + 14s′(h6u6v + s6u) + 14s3s′4(u − v) + 189h5u4v2s2\n− 378h5u3v3s2 − 84h4u4vss′(hu − s) − 84huvs5s′ + 42h4u5s2(s + s′) + 42h2ss′4(u2v − uv2) + 252h4u2v2s2(us + vs + vs′) − 168h3uv2s2s′(hu2 + us + vs) − 315h3u2v2s4 − 56h3u4s3s′ + 112h3u3vs3s′ + 210h4uv4s4s′ − 6h2s′5(u2v − uv2)]\n(48)\nFor hv ≥ s > hu > 0 ≥ s′:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\ns′2\n4320h2v(u − v) [ − 3h7u5v2 + 18h6su4v2 + 2s′h6u5v − 18h5s2u4v + 27h5s2u3v2\n− 54h5s2u2v3 − 12s′h5su4v + 6h4s3u4 − 18h4s3u3v + 36h4s3u2v2 + 36h4s3uv3\n+ 6s′h4s2u4 + 12s′h4s2u3v − 24s′h4s2u2v2 + 36s′h4s2uv3 − 45h3s4uv2 − 8s′h3s3u3\n+ 16s′h3s3u2v − 24s′h3s3uv2 − 24s′h3s3v3 + 18h2s5uv + 30s′h2s4s2 − 3hs6u − 12s′h5v + 2s′s6] (49)\nFor hv > hu ≥ s, s′ > 0:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\n− s ′2\n30240h2uv [126h5s2u4v − 378h5s2u3v2 − 42h4s3u4 + 84h4s3u3v + 252h4s3u2v2\n− 42h4s2s′u4 + 84h4s2s′u3v + 252h4s2s′u2v2 + 56h3s3s′u3 − 336h3s3s′u2v − 168h3s3s′uv2 − 126h2s5uv + 210h2s4s′uv − 42h2ss′4uv + 6h2s′5uv\n+ 21hs6v + 21hs2s′4u + 21hs2s′4v − 14s6s′ − 14s3s′4] (50) For hv > hu ≥ s > 0 ≥ s′:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\n− s 2s′2\n4320h2uv [18h5u4v − 54h5u3v2 − 6h4su4\n+ 12h4su3v + 36h4su2v2 − 6s′h4u4 + 12s′h4u3v + 36s′h4u2v2 + 8s′h3su3\n− 48s′h3su2v − 24s′h3suv2 − 18h2s3uv + 30s′h2s2uuv + 3hs4v − 2s′s4] (51) For hv > hu > 0 ≥ s, s′:\nlim t0→∞\nk∣x0,y1,y2,y3(t0 + s, t0 + s ′) =\nhs2s′2u2 (hsu − 4ss′ + 3hs′u) 2160v\n− s 2\n5040 [21h3s′2u3 − 63vh3s′2u2 + 14h2ss′2u2 + 42vh2ss′2\n+ 14h2s′3u2 + 42vh2s′3u − 56hss′3u − 28vhss′3\n− s5 + 7s4s′ − 21s3s′2 + 35s2 + s′3] (52)"
    }, {
      "heading" : "D Square-exponential kernel cannot yield Euler’s method",
      "text" : "We show that the square-exponetial (SE, aka. RBF, Gaussian) kernel cannot yield Euler’s method for finite length-scales.\nThe SE kernel and its derivatives are k(t, t′) = θ2 exp(−∣∣t−t′∣∣2/2λ2) (53)\nk∂(t, t′) = (t − t ′)\nλ2 k(t, t′) (54)\nk∂ ∂(t, t′) = ⎡⎢⎢⎢⎢⎣ 1 λ2 − ((t − t ′) λ2 ) 2⎤⎥⎥⎥⎥⎦ k(t, t′) (55)\nTo show that this choice does not yield Euler’s method, we proceed as in the case for the GMRK methods. The predictive mean after observing x0 and y1 is given by\nµ∣x0,y1(t0 + s) = [k(t0 + s, t0) k∂(t0 + s, t0)] [ k(t0, t0) k∂(t0, t0) k∂ (t0, t0) k∂ ∂(t0, t0) ] −1\n´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶ =∶K\n(x0 y1 )\n= [θ2 exp(−∣∣s∣∣2/2λ2) s θ 2 exp(−∣∣s∣∣2/2λ2) λ2 ] [θ 2 0 0 θ 2/λ2] −1 (x0 y1 )\n= [exp(−∣∣s∣∣2/2λ2) s exp(−∣∣s∣∣2/2λ2)] (x0 y1 )\n= exp(−∣∣s∣∣2/2λ2)x0 + s exp(−∣∣s∣∣2/2λ2)y1 (56)\nevaluated at h yields\n= exp(−∣∣h∣∣2/2λ2)x0 + h exp(−∣∣h∣∣2/2λ2)y1 (57)\nAn interesting observation, left out in the main paper to avoid confusion, is that Eq. (57) does indeed produce the weights for Euler’s method for the limit limλ→∞. In fact, it can even be used to derive second and third order Runge-Kutta means, too. Future work will provide more insight into this property. However, this limit in the length-scale yields a Gaussian process posterior that has little use as a probabilistic numerical method, because its posterior covariance vanishes everywhere. This is in contrast to the integrated Wiener processes discussed in the paper, which yield proper finite, interpretable posterior variances, even after in the limit in τ . Finally, SE kernel-GPs are not Markov. Inference in these models has cost cubic in the number of observations, reducing their utility as numerical methods."
    } ],
    "references" : [ {
      "title" : "Solving noisy linear operator equations by Gaussian processes: Application to ordinary and partial differential equations",
      "author" : [ "T. Graepel" ],
      "venue" : "In: International Conference on Machine Learning (ICML)",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2003
    }, {
      "title" : "Accelerating Bayesian inference over nonlinear differential equations with Gaussian processes.",
      "author" : [ "B. Calderhead", "M. Girolami", "N. Lawrence" ],
      "venue" : "Advances in Neural Information Processing Systems (NIPS)",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2008
    }, {
      "title" : "ODE parameter inference using adaptive gradient matching with Gaussian processes",
      "author" : [ "F. Dondelinger" ],
      "venue" : "Artificial Intelligence and Statistics (AISTATS)",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2013
    }, {
      "title" : "Gaussian Processes for Bayesian Estimation in Ordinary Differential Equations",
      "author" : [ "Y. Wang", "D. Barber" ],
      "venue" : "In: International Conference on Machine Learning (ICML)",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2014
    }, {
      "title" : "Bayesian solution of ordinary differential equations",
      "author" : [ "J. Skilling" ],
      "venue" : "In: Maximum Entropy and Bayesian Methods, Seattle ",
      "citeRegEx" : "5",
      "shortCiteRegEx" : null,
      "year" : 1991
    }, {
      "title" : "Probabilistic Solutions to Differential Equations and their Application to Riemannian Statistics",
      "author" : [ "P. Hennig", "S. Hauberg" ],
      "venue" : "In: Proc. of the 17th int. Conf. on Artificial Intelligence and Statistics (AISTATS). Vol. 33. JMLR, W&CP",
      "citeRegEx" : "6",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Probabilistic shortest path tractography in DTI using Gaussian Process ODE solvers",
      "author" : [ "M. Schober" ],
      "venue" : null,
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2014
    }, {
      "title" : "Bayesian Uncertainty Quantification for Differential Equations",
      "author" : [ "O. Chkrebtii" ],
      "venue" : "arXiv prePrint",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2013
    }, {
      "title" : "Über die numerische Auflösung von Differentialgleichungen",
      "author" : [ "C. Runge" ],
      "venue" : "In: Mathematische Annalen 46 ",
      "citeRegEx" : "9",
      "shortCiteRegEx" : null,
      "year" : 1895
    }, {
      "title" : "Beitrag zur näherungsweisen Integration totaler Differentialgleichungen",
      "author" : [ "W. Kutta" ],
      "venue" : "In: Zeitschrift für Mathematik und Physik 46 ",
      "citeRegEx" : "10",
      "shortCiteRegEx" : null,
      "year" : 1901
    }, {
      "title" : "Solving Ordinary Differential Equations I – Nonstiff Problems",
      "author" : [ "E. Hairer", "S. Nørsett", "G. Wanner" ],
      "venue" : "Springer",
      "citeRegEx" : "11",
      "shortCiteRegEx" : null,
      "year" : 1987
    }, {
      "title" : "A family of embedded Runge-Kutta formulae",
      "author" : [ "J.R. Dormand", "P.J. Prince" ],
      "venue" : "In: Journal of computational and applied mathematics 6.1 ",
      "citeRegEx" : "12",
      "shortCiteRegEx" : null,
      "year" : 1980
    }, {
      "title" : "Coefficients for the study of Runge-Kutta integration processes",
      "author" : [ "J. Butcher" ],
      "venue" : "In: Journal of the Australian Mathematical Society 3.02 ",
      "citeRegEx" : "13",
      "shortCiteRegEx" : null,
      "year" : 1963
    }, {
      "title" : "Problèmes différentiels de conditions initiales (méthodes numériques)",
      "author" : [ "F. Ceschino", "J. Kuntzmann" ],
      "venue" : "Dunod Paris",
      "citeRegEx" : "14",
      "shortCiteRegEx" : null,
      "year" : 1963
    }, {
      "title" : "Solutions of Differential Equations by Evaluations of Functions",
      "author" : [ "E.B. Shanks" ],
      "venue" : "In: Mathematics of Computation 20.93 ",
      "citeRegEx" : "15",
      "shortCiteRegEx" : null,
      "year" : 1966
    }, {
      "title" : "Numerical solution of ordinary differential equations",
      "author" : [ "E. Hairer", "C. Lubich" ],
      "venue" : "In: The Princeton Companion to Applied Mathematics, ed. by N. Higham. PUP",
      "citeRegEx" : "16",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Extrapolation",
      "author" : [ "N. Wiener" ],
      "venue" : "interpolation, and smoothing of stationary time series with engineering applications”. In: Bull. Amer. Math. Soc. 56 ",
      "citeRegEx" : "17",
      "shortCiteRegEx" : null,
      "year" : 1950
    }, {
      "title" : "Bayesian filtering and smoothing",
      "author" : [ "S. Särkkä" ],
      "venue" : "Cambridge University Press",
      "citeRegEx" : "18",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "Gaussian Processes for Machine Learning",
      "author" : [ "C. Rasmussen", "C. Williams" ],
      "venue" : "MIT",
      "citeRegEx" : "19",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "An approach to time series smoothing and forecasting using the EM algorithm",
      "author" : [ "R. Shumway", "D. Stoffer" ],
      "venue" : "In: Journal of time series analysis 3.4 ",
      "citeRegEx" : "20",
      "shortCiteRegEx" : null,
      "year" : 1982
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 172,
      "endOffset" : 184
    }, {
      "referenceID" : 1,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 172,
      "endOffset" : 184
    }, {
      "referenceID" : 2,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 172,
      "endOffset" : 184
    }, {
      "referenceID" : 3,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 172,
      "endOffset" : 184
    }, {
      "referenceID" : 4,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 275,
      "endOffset" : 287
    }, {
      "referenceID" : 5,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 275,
      "endOffset" : 287
    }, {
      "referenceID" : 6,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 275,
      "endOffset" : 287
    }, {
      "referenceID" : 7,
      "context" : "Hence, researchers in machine learning have repeatedly been interested in both the problem of inferring an ODE description from observed trajectories of a dynamical system [1, 2, 3, 4], and its dual, inferring a solution (a trajectory) for an ODE initial value problem (IVP) [5, 6, 7, 8].",
      "startOffset" : 275,
      "endOffset" : 287
    }, {
      "referenceID" : 8,
      "context" : "Runge-Kutta (RK) methods [9, 10] are standard tools for this purpose.",
      "startOffset" : 25,
      "endOffset" : 32
    }, {
      "referenceID" : 9,
      "context" : "Runge-Kutta (RK) methods [9, 10] are standard tools for this purpose.",
      "startOffset" : 25,
      "endOffset" : 32
    }, {
      "referenceID" : 10,
      "context" : "Over more than a century, these algorithms have matured into a very well-understood, efficient framework [11].",
      "startOffset" : 105,
      "endOffset" : 109
    }, {
      "referenceID" : 5,
      "context" : "As recently pointed out by Hennig and Hauberg [6], since Runge-Kutta methods are linear extrapolation methods, their structure can be emulated by Gaussian process (GP) regression algorithms.",
      "startOffset" : 46,
      "endOffset" : 49
    }, {
      "referenceID" : 4,
      "context" : "Such an algorithm was envisioned by Skilling in 1991 [5], and the idea has recently attracted both theoretical [8] and practical [6, 7] interest.",
      "startOffset" : 53,
      "endOffset" : 56
    }, {
      "referenceID" : 7,
      "context" : "Such an algorithm was envisioned by Skilling in 1991 [5], and the idea has recently attracted both theoretical [8] and practical [6, 7] interest.",
      "startOffset" : 111,
      "endOffset" : 114
    }, {
      "referenceID" : 5,
      "context" : "Such an algorithm was envisioned by Skilling in 1991 [5], and the idea has recently attracted both theoretical [8] and practical [6, 7] interest.",
      "startOffset" : 129,
      "endOffset" : 135
    }, {
      "referenceID" : 6,
      "context" : "Such an algorithm was envisioned by Skilling in 1991 [5], and the idea has recently attracted both theoretical [8] and practical [6, 7] interest.",
      "startOffset" : 129,
      "endOffset" : 135
    }, {
      "referenceID" : 6,
      "context" : "Solution candidates can be drawn from the posterior and marginalized [7].",
      "startOffset" : 69,
      "endOffset" : 72
    }, {
      "referenceID" : 5,
      "context" : "This can allow probabilistic solvers to stop earlier, and to deal (approximately) with probabilistically uncertain inputs and problem definitions [6].",
      "startOffset" : 146,
      "endOffset" : 149
    }, {
      "referenceID" : 10,
      "context" : "Table 1: All consistent Runge-Kutta methods of order p ≤ 3 and number of stages s = p (see [11]).",
      "startOffset" : 91,
      "endOffset" : 95
    }, {
      "referenceID" : 8,
      "context" : "Runge-Kutta methods1 [9, 10] are carefully designed linear extrapolation methods operating on small contiguous subintervals [tn, tn + h] ⊂ T of length h.",
      "startOffset" : 21,
      "endOffset" : 28
    }, {
      "referenceID" : 9,
      "context" : "Runge-Kutta methods1 [9, 10] are carefully designed linear extrapolation methods operating on small contiguous subintervals [tn, tn + h] ⊂ T of length h.",
      "startOffset" : 21,
      "endOffset" : 28
    }, {
      "referenceID" : 11,
      "context" : "by combining the same observations into two different RK predictions [12]).",
      "startOffset" : 69,
      "endOffset" : 73
    }, {
      "referenceID" : 12,
      "context" : ", bs], often presented compactly in a Butcher tableau [13]: c1 0 c2 w21 0 c3 w31 w32 0 ⋮ ⋮ ⋮ ⋱ ⋱ cs ws1 ws2 ⋯ ws,s−1 0 b1 b2 ⋯ bs−1 bs As Hennig and Hauberg [6] recently pointed out, the linear structure of the extrapolation steps in Runge-Kutta methods means that their algorithmic structure, the Butcher tableau, can be constructed naturally from a Gaussian process regression method over x(t), where the yi are treated as “observations” of ẋ(t0 + hci) and the x̂i are subsequent posterior estimates (more below).",
      "startOffset" : 54,
      "endOffset" : 58
    }, {
      "referenceID" : 5,
      "context" : ", bs], often presented compactly in a Butcher tableau [13]: c1 0 c2 w21 0 c3 w31 w32 0 ⋮ ⋮ ⋮ ⋱ ⋱ cs ws1 ws2 ⋯ ws,s−1 0 b1 b2 ⋯ bs−1 bs As Hennig and Hauberg [6] recently pointed out, the linear structure of the extrapolation steps in Runge-Kutta methods means that their algorithmic structure, the Butcher tableau, can be constructed naturally from a Gaussian process regression method over x(t), where the yi are treated as “observations” of ẋ(t0 + hci) and the x̂i are subsequent posterior estimates (more below).",
      "startOffset" : 157,
      "endOffset" : 160
    }, {
      "referenceID" : 10,
      "context" : "The method is then said to be of order p [11].",
      "startOffset" : 41,
      "endOffset" : 45
    }, {
      "referenceID" : 13,
      "context" : "This is only possible for p < 5 [14, 15].",
      "startOffset" : 32,
      "endOffset" : 40
    }, {
      "referenceID" : 14,
      "context" : "This is only possible for p < 5 [14, 15].",
      "startOffset" : 32,
      "endOffset" : 40
    }, {
      "referenceID" : 10,
      "context" : "Many generalizations can be found in [11].",
      "startOffset" : 37,
      "endOffset" : 41
    }, {
      "referenceID" : 4,
      "context" : "A recursive algorithm analogous to RK methods can be constructed [5, 6] by setting the prior mean to the constant μ(t) = x0, then recursively estimating x̂i in some form from the current posterior over x.",
      "startOffset" : 65,
      "endOffset" : 71
    }, {
      "referenceID" : 5,
      "context" : "A recursive algorithm analogous to RK methods can be constructed [5, 6] by setting the prior mean to the constant μ(t) = x0, then recursively estimating x̂i in some form from the current posterior over x.",
      "startOffset" : 65,
      "endOffset" : 71
    }, {
      "referenceID" : 5,
      "context" : "The choice in [6] is to set x̂i = μ(t0 + hci).",
      "startOffset" : 14,
      "endOffset" : 17
    }, {
      "referenceID" : 5,
      "context" : "In previous work [6, 7], both were chosen ad hoc, with no guarantee of convergence order.",
      "startOffset" : 17,
      "endOffset" : 23
    }, {
      "referenceID" : 6,
      "context" : "In previous work [6, 7], both were chosen ad hoc, with no guarantee of convergence order.",
      "startOffset" : 17,
      "endOffset" : 23
    }, {
      "referenceID" : 7,
      "context" : "[8] previously made the case that Gaussian measures are uniquely suited because solution spaces of ODEs are Banach spaces, and provided results on consistency.",
      "startOffset" : 0,
      "endOffset" : 3
    }, {
      "referenceID" : 4,
      "context" : "Motivation of evaluation points Both Skilling [5] and Hennig and Hauberg [6] propose to put the “nodes” x̂(t0 + hci) at the current posterior mean of the belief.",
      "startOffset" : 46,
      "endOffset" : 49
    }, {
      "referenceID" : 5,
      "context" : "Motivation of evaluation points Both Skilling [5] and Hennig and Hauberg [6] propose to put the “nodes” x̂(t0 + hci) at the current posterior mean of the belief.",
      "startOffset" : 73,
      "endOffset" : 76
    }, {
      "referenceID" : 15,
      "context" : "From the second interval onward, the RK step solves an estimated IVP, and begins to accumulate a global estimation error not bounded by the convergence order (an effect termed “Lady Windermere’s fan” by Wanner [16]).",
      "startOffset" : 210,
      "endOffset" : 214
    }, {
      "referenceID" : 16,
      "context" : "All covariance functions in question are integrals over the kernel k(t̃, t̃) = σ min(t̃ − τ, t̃ − τ) (parameterized by scale σ > 0 and off-set τ ∈ R; valid on the domain t̃, t̃ > τ ), the covariance of the Wiener process [17].",
      "startOffset" : 221,
      "endOffset" : 225
    }, {
      "referenceID" : 17,
      "context" : "Such integrated Wiener processes are Gauss-Markov processes, of increasing order, so inference in these methods can be performed by filtering, at linear cost [18].",
      "startOffset" : 158,
      "endOffset" : 162
    }, {
      "referenceID" : 10,
      "context" : "Since Runge-Kutta methods have been extensively studied for over a century [11], it is not necessary to evaluate their estimation performance again.",
      "startOffset" : 75,
      "endOffset" : 79
    }, {
      "referenceID" : 5,
      "context" : "Figure 3: Comparison of a 2nd order GMRK method and the method from [6].",
      "startOffset" : 68,
      "endOffset" : 71
    }, {
      "referenceID" : 5,
      "context" : "2 (right column) to the ad-hoc choice of a square-exponential (SE) kernel model, which was used by Hennig and Hauberg [6] (Fig.",
      "startOffset" : 118,
      "endOffset" : 121
    } ],
    "year" : 2014,
    "abstractText" : "Runge-Kutta methods are the classic family of solvers for ordinary differential equations (ODEs), and the basis for the state of the art. Like most numerical methods, they return point estimates. We construct a family of probabilistic numerical methods that instead return a Gauss-Markov process defining a probability distribution over the ODE solution. In contrast to prior work, we construct this family such that posterior means match the outputs of the Runge-Kutta family exactly, thus inheriting their proven good properties. Remaining degrees of freedom not identified by the match to Runge-Kutta are chosen such that the posterior probability measure fits the observed structure of the ODE. Our results shed light on the structure of Runge-Kutta solvers from a new direction, provide a richer, probabilistic output, have low computational cost, and raise new research questions.",
    "creator" : "LaTeX with hyperref package"
  }
}