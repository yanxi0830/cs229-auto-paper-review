{
  "name" : "1612.01859.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Combinatorial semi-bandit with known covariance",
    "authors" : [ "Rémy Degenne", "Vianney Perchet" ],
    "emails" : [ "degenne@cmla.ens-cachan.fr", "perchet@normalesup.org" ],
    "sections" : [ {
      "heading" : "1 Introduction and setting",
      "text" : "The multi-armed bandit problem (MAB) is a sequential learning task in which an algorithm takes at each stage a decision (or, “pulls an arm”). It then gets a reward from this choice, with the goal of maximizing the cumulative reward [15]. We consider here its stochastic combinatorial extension, in which the algorithm chooses at each stage a subset of arms [2, 5, 6, 9]. These arms could form, for example, the path from an origin to a destination in a network. In the combinatorial setting, contrary to the the classical MAB, the inter-dependencies between the arms can play a role (we consider that the distribution of rewards is invariant with time). We investigate here how the covariance structure of the arms affects the difficulty of the learning task and whether it is possible to design a unique algorithm capable of performing optimally in all cases from the\n∗V. Perchet is partially funded by the ANR grant ANR-13-JS01-0004-01, benefited from the support of the \"FMJH Program Gaspard Monge in optimization and operation research\" and from EDF, and also from the support of the CNRS.\nar X\niv :1\n61 2.\n01 85\n9v 1\n[ cs\n.L G\nsimple scenario with independent rewards to the more challenging scenario of general correlated rewards.\nFormally, at each stage t ∈ N, t ≥ 1, an algorithm pulls m ≥ 1 arms among d ≥ m. Such a set of m arms is called an “action” and will be denoted by At ∈ {0, 1}d, a vector with exactly m non-zero entries. The possible actions are restricted to an arbitrary fixed subset A ⊂ {0, 1}d. After choosing action At, the algorithm receives the reward A>t Xt, where Xt ∈ Rd is the vector encapsulating the reward of the d arms at stage t. The successive reward vectors (Xt)t≥1 are i.i.d with unknown mean µ ∈ Rd. We consider a semi-bandit feedback system: after choosing the action At, the algorithm observes the reward of each of the arms in that action, but not the other rewards. Other possible feedbacks previously studied include bandit (only A>t Xt is revealed) and full information (Xt is revealed). The goal of the algorithm is to maximize the cumulated reward up to stage T ≥ 1 or equivalently to minimize the expected regret, which is the difference of the reward that would have been gained by choosing the best action in hindsight A∗ and what was actually gained:\nERT = E T∑ t=1 (A∗>µ−A>t µ) .\nFor an action A ∈ A, the difference ∆A = (A∗>µ−A>µ) is called gap of A. We denote by ∆t the gap of At, so that regret rewrites as ERT = E ∑T t=1 ∆t. We also define the minimal gap of an arm, ∆i,min = min{A∈A:i∈A}∆A. This setting was already studied [5], most recently in [7, 12], where two different algorithms are used to tackle on one hand the case where the arms have independent rewards and on the other hand the general bounded case. The regret guaranties of the two algorithms are different and reflect that the independent case is easier. Another algorithm for the independent arms case based on Thompson Sampling was introduced in [11]. One of the main objectives of this paper is to design a unique algorithm that can adapt to the covariance structure of the problem when prior information is available.\nThe following notations will be used throughout the paper: given a matrix M (resp. vector v), its (i, j)th (resp. ith) coefficient is denoted by M (ij) (resp. v(i)). For a matrix M , the diagonal matrix with same diagonal as M is denoted by ΣM .\nWe denote by ηt the noise in the reward, i.e. ηt := Xt − µ. We consider a subgaussian setting, in which we suppose that there is a positive semi-definite matrix C such that for all t ≥ 1,\n∀u ∈ Rd,E[eu >ηt ] ≤ e 12u >Cu .\nThis is equivalent to the usual setting for bandits where we suppose that the individual arms are subgaussian. Indeed if we have such a matrix C then each η\n(i) t is\n√ C(ii)-subgaussian. And under a subgaussian arms assumption, such a\nmatrix always exists. This setting encompasses the case of bounded rewards.\nWe call C a subgaussian covariance matrix of the noise (see appendix A of the supplementary material). A good knowledge of C can simplify the problem greatly, as we will show. In the case of 1-subgaussian independent rewards, in which C can be chosen diagonal, a known lower bound on the regret appearing in [7] is d∆ log T , while [12] proves a dm ∆ log T lower bound in general. Our goal here is to investigate the spectrum of intermediate cases between these two settings, from the uninformed general case to the independent case in which one has much information on the relations between the arm rewards. We characterize the difficulty of the problem as a function of the subgaussian covariance matrix C. We suppose that we know a positive semi-definite matrix Γ such that for all vectors v with positive coordinates, v>Cv ≤ v>Γv, property that we denote by C + Γ. Γ reflects the prior information available about the possible degree of independence of the arms. We will study algorithms that enjoy regret bounds as functions of Γ.\nThe matrix Γ can be chosen such that all its coefficients are non-negative and verify for all i, j, Γ(ij) ≤ √ Γ(ii)Γ(jj). From now on, we suppose that it is the case. In the following, we will use t such that ηt = C 1/2 t and write for the reward: Xt = µ+ C 1/2 t."
    }, {
      "heading" : "2 Lower bound",
      "text" : "We first prove a lower bound on the regret of any algorithm, demonstrating the link between the subgaussian covariance matrix and the difficulty of the problem. It depends on the maximal off-diagonal correlation coefficient of the covariance matrix. This coefficient is γ = max{(i,j)∈[d],i6=j} C\n(ij) √ C(ii)C(jj)\n. The bound is valid for consistent algorithms [13], for which the regret on any problem verifies ERt = o(ta) as t→ +∞ for all a > 0.\nTheorem 1. Suppose to simplify that d is a multiple of m. Then, for any ∆ > 0, for any consistent algorithm, there is a problem with gaps ∆, σ-subgaussian arms and correlation coefficients smaller than γ ∈ [0, 1] on which the regret is such that\nlim inf t→+∞ ERt log t ≥ (1 + γ(m− 1))2σ 2(d−m) ∆\nThis bound is a consequence of the classical result of [13] for multi-armed bandits, applied to the problem of choosing one among d/m paths, each of which has m different successive edges (Figure 1). The rewards in the same path are correlated but the paths are independent. A complete proof can be found in appendix B.1 of the supplementary material."
    }, {
      "heading" : "3 OLS-UCB Algorithm and analysis",
      "text" : "Faced with the combinatorial semi-bandit at stage t ≥ 1, the observations from t − 1 stages form as many linear equations and the goal of an algorithm is to\nchoose the best action. To find the action with the highest mean, we estimate the mean of all arms. This can be viewed as a regression problem. The design of our algorithm stems from this observation and is inspired by linear regression in the fixed design setting, similarly to what was done in the stochastic linear bandit literature [16, 8]. There are many estimators for linear regression and we focus on the one that is simple enough and adaptive: Ordinary Least Squares (OLS)."
    }, {
      "heading" : "3.1 Fixed design linear regression and OLS-UCB algorithm",
      "text" : "For an action A ∈ A, let IA be the diagonal matrix with a 1 at line i if A(i) = 1 and 0 otherwise. For a matrix M , we also denote by MA the matrix IAMIA. At stage t, if all actions A1, . . . , At were independent of the rewards, we would have observed a set of linear equations\nIA1X1 = IA1µ+ IA1η1\n... IAt−1Xt−1 = IAt−1µ+ IAt−1ηt−1\nand we could use the OLS estimator to estimate µ, which is unbiased and has a known subgaussian constant controlling its variance. This is however not true in our online setting since the successive actions are not independent. At stage t, we define\nn (i) t = t−1∑ s=1 I{i ∈ As}, n(ij)t = t−1∑ s=1 I{i ∈ As}I{j ∈ As} and Dt = t−1∑ s=1 IAs ,\nwhere n(i)t is the number of times arm i has been pulled before stage t and Dt is a diagonal matrix of these numbers. The OLS estimator is, for an arm i ∈ [d],\nµ̂ (i) t =\n1\nn (i) t ∑ s<t:i∈As X(i)s = µ (i) + (D−1t t−1∑ s=1 IAsC 1/2 s) (i) .\nThen for allA ∈ A, A>(µ̂t−µ) in the fixed design setting has a subgaussian matrix equal to D−1t ( ∑t−1 s=1 CAs)D −1 t . We get confidence intervals for the estimates and can use an upper confidence bound strategy [13, 3]. In the online learning setting the actions are not independent but we will show that using this estimator still leads to estimates that are well concentrated around µ, with confidence intervals given by the same subgaussian matrix. The algorithm OLS-UCB (Algorithm 1) results from an application of an upper confidence bound strategy with this estimator.\nAlgorithm 1 OLS-UCB. Require: Positive semi-definite matrix Γ, real parameter λ > 0. 1: Choose actions such that each arm is pulled at least one time. 2: loop: at stage t, 3: At = arg maxAA >µ̂t + Et(A)\nwith Et(A) = √ 2f(t) √ A>D−1t (λΣΓDt + ∑t−1 s=1 ΓAs)D −1 t A.\n4: Choose action At, observe IAtXt. 5: Update µ̂t, Dt. 6: end loop\nWe now turn to an analysis of the regret of OLS-UCB. At any stage t ≥ 1 of the algorithm, let γt = max{(i,j)∈At,i6=j} Γ(ij)√ Γ(ii)Γ(jj)\nbe the maximal off-diagonal correlation coefficient of ΓAt and let γ = max{t∈[T ]} γt be the maximum up to stage T .\nTheorem 2. The OLS-UCB algorithm with parameter λ > 0 and f(t) = log t+ (m+ 2) log log t+ m2 log(1 + e λ ) enjoys for all times T ≥ 1 the regret bound\nE[RT ] ≤16f(T ) ∑ i∈[d] Γ(ii) ∆i,min\n( 5(λ+ 1− γ) ⌈ logm\n1.6\n⌉2 + 45γm )\n+ 8dm2 maxi{C(ii)}∆max\n∆2min + 4∆max ,\nwhere dxe stands for the smallest positive integer bigger than or equal to x. In particular, d0e = 1.\nThis bound shows the transition between a general case with a dm log T∆ regime and an independent case with a d log\n2m log T ∆ upper bound (we recall that the\nlower bound is of the order of d log T∆ ). The weight of each case is given by the maximum correlation parameter γ. The parameter λ seems to be an artefact of the analysis and can in practice be taken very small or even equal to 0.\nFigure 1 illustrates the regret of OLS-UCB on the parallel paths problem used to derive the lower bound. It shows a linear dependency in γ and supports the hypothesis that the true upper bound matches the lower bound with a dependency in m and γ of the form (1 + γ(m− 1)).\nCorollary 1. The OLS-UCB algorithm with matrix Γ and parameter λ > 0 has a regret bounded as\nE[RT ] ≤ O( √√√√dT log T max i∈[d] {Γ(ii)} ( 5(λ+ 1− γ) ⌈ logm 1.6 ⌉2 + 45γm ) ) .\nProof. We write that the regret up to stage T is bounded by ∆T for actions with gap smaller than some ∆ and bounded using theorem 2 for other actions (with ∆min ≥ ∆). Maximizing over ∆ then gives the result."
    }, {
      "heading" : "3.2 Comparison with other algorithms",
      "text" : "Previous works supposed that the rewards of the individual arms are in [0, 1], which gives them a 1/2-subgaussian property. Hence we suppose (∀i ∈ [d], C(ii) = 1/2) for our comparison.\nIn the independent case, our algorithm is the same as ESCB-2 from [7], up to the parameter λ. That paper shows that ESCB-2 enjoys an O(d √ m log T ∆ ) upper bound but our analysis tighten it to O(d log 2m log T ∆ ).\nIn the general (worst) case, [12] prove an O(dm log T∆ ) upper bound (which is tight) using CombUCB1, a UCB based algorithm introduced in [6] which at stage t uses the exploration term √ 1.5 log t ∑ i∈A 1/ √ n (i) t . Our exploration term\nalways verifies Et(A) ≤ √ f(t) ∑ i∈A 1/ √ n (i) t with f(t) ≈ log t (see section 3.6). Their exploration term is a worst-case confidence interval for the means. Their broader confidence intervals however have the desirable property that one can find the action that realizes the maximum index by solving a linear optimization problem, making their algorithm computationally efficient, quality that both ESCB and OLS-UCB are lacking.\nNone of the two former algorithms benefits from guaranties in the other regime. The regret of ESCB in the general possibly correlated case is unknown and the regret bound for CombUCB1 is not improved in the independent case. In contrast, OLS-UCB is adaptive in the sense that its performance gets better when more information is available on the independence of the arms."
    }, {
      "heading" : "3.3 Regret Decomposition",
      "text" : "Let Hi,t = {|µ̂(i)t − µ(i)| ≥ ∆t2m} and Ht = ∪ d i=1Hi,t. Ht is the event that at least one coordinate of µ̂t is far from the true mean. Let Gt = {A∗>µ ≥ A∗>µ̂t + Et(A\n∗)} be the event that the estimate of the optimal action is below its true mean by a big margin. We decompose the regret according to these events:\nRT ≤ T∑ t=1 ∆tI{Gt,Ht}+ T∑ t=1 ∆tI{Gt}+ T∑ t=1 ∆tI{Ht}\nEvents Gt and Ht are rare and lead to a finite regret (see below). We first simplify the regret due to Gt ∩Ht and show that it is bounded by the \"variance\" term of the algorithm.\nLemma 1. With the algorithm choosing at stage t the action At = arg maxA(A>µ̂t+ Et(A)), we have ∆tI{Gt,Ht} ≤ 2Et(At)I{∆t ≤ Et(At)}.\nProof in appendix B.2 of the supplementary material. Then the regret is cut into three terms,\nRT ≤ 2 T∑ t=1 Et(At)I{∆t ≤ 2Et(At)}+ T∑ t=1 ∆tI{Gt}+ T∑ t=1 ∆tI{Ht} .\nThe three terms will be bounded as follows:\n• The Ht term leads to a finite regret from a simple application of Hoeffding’s inequality.\n• The Gt term leads to a finite regret for a good choice of f(t). This is where we need to show that the exploration term of the algorithm gives a high probability upper confidence bound of the reward.\n• The Et(At) term, or variance term, is the main source of the regret and is bounded using ideas similar to the ones used in existing works on semi-bandits."
    }, {
      "heading" : "3.4 Expected regret from Ht",
      "text" : "Lemma 2. The expected regret due to the event Ht is E[ ∑T t=1 ∆tI{Ht}] ≤ 8dm2 maxi{C(ii)}∆max ∆2min .\nThe proof uses Hoeffding’s inequality on the arm mean estimates and can be found in appendix B.2 of the supplementary material."
    }, {
      "heading" : "3.5 Expected regret from Gt",
      "text" : "We want to bound the probability that the estimated reward for the optimal action is far from its mean. We show that it is sufficient to control a selfnormalized sum and do it using arguments from [14], or [1] who applied them to linear bandits. The analysis also involves a peeling argument, as was done in one dimension by [10] to bound a similar quantity.\nLemma 3. Let δt > 0. With f̃(δt) = log(1/δt)+m log log t+m2 log(1+ e λ ) and an algorithm given by the exploration term Et(A) = √ 2f̃(δt) √ A>D−1t (λΣΓDt + ∑t−1 s=1 ΓAs)D −1 t A, then the event Gt = {A∗>µ ≥ A∗>µ̂t + Et(A∗)} verifies P{Gt} ≤ δt . With δ1 = 1 and δt = 1t log2 t for t ≥ 2, such that f̃(δt) = f(t), the regret due to Gt is finite in expectation, bounded by 4∆max.\nProof. We use a peeling argument: let η > 0 and for a = (a1, . . . , am) ∈ Nm, let Da ⊂ [T ] be a subset of indices defined by (t ∈ Da ⇔ ∀i ∈ A∗, (1 + η)ai ≤ n(i)t < (1 + η)ai+1). For any Bt ∈ R,\nP { A∗>(µ− µ̂t) ≥ Bt } ≤ ∑ a P { A∗>(µ− µ̂t) ≥ Bt|t ∈ Da } .\nThe number of possible sets Da for t is bounded by (log t/ log(1 + η))m, since each number of pulls n(i)t for i ∈ A∗ is bounded by t. We now search a bound of the form P { A∗>(µ− µ̂t) ≥ Bt|t ∈ Da } . Suppose t ∈ Da and let D be a positive definite diagonal matrix (that depends on a). Let St = ∑t−1 s=1 IAs∩A∗C 1/2 s, Vt = ∑t−1 s=1 CAs∩A∗ and IVt+D( ) = 1 2 ‖St‖ 2 (Vt+D)−1\n. Lemma 4. Let δt > 0 and let f̃(δt) be a function of δt. With a choice of D such that IA∗D λIA∗ΣCDt for all t in Da,\nP { A∗>(µ−µ̂t)≥ √ 2f̃(δt)A∗>D −1 t (λΣCDt+Vt)D −1 t A ∗ ∣∣∣t∈Da} ≤ P{IVt+D( )≥f̃(δt)|t∈Da} .\nProof in appendix B.2 of the supplementary material. The self-normalized sum IVt( ) is an interesting quantity for the following\nreason: exp( 12IVt( )) = maxu∈Rd ∏t−1 s=1 exp(u >IAs∩A∗C 1/2 s − u>CAs∩A∗u). For a given u, the exponential is smaller that 1 in expectation, from the subgaussian hypothesis. The maximum of the expectation is then smaller than 1. To control IVt( ), we are however interested in the expectation of this maximum and cannot interchange max and E. The method of mixtures circumvents this difficulty: it provides an approximation of the maximum by integrating the exponential against a multivariate normal centered at the point V −1t St, where the maximum is attained. The integrals over u and can then be swapped by Fubini’s theorem to get an approximation of the expectation of the maximum using an integral of the expectations. Doing so leads to the following lemma, extracted from the proof of Theorem 1 of [1].\nLemma 5. Let D be a positive definite matrix that does not depend on t and Mt(D) =\n√ detD\ndet(Vt+D) exp(IVt+D( )). Then E[Mt(D)] ≤ 1. We rewrite P { IVt+D( ) ≥ f̃(δt) } to introduce Mt(D), P { IVt+D( ) ≥ f̃(δt)|t∈Da } = P { Mt(D) ≥\n1√ det(Id +D− 1/2VtD− 1/2)\nexp(f̃(δt)) ∣∣∣t∈Da} .\nThe peeling lets us bound Vt. Let Da be the diagonal matrix with entry (i, i) equal to (1 + η)ai for i ∈ A∗ and 0 elsewhere.\nLemma 6. With D = λΣCDa + I[d]\\A∗ , det(Id +D− 1/2VtD −1/2) ≤ (1 + 1+ηλ ) m .\nThe union bound on the sets Da and Markov’s inequality give P { A∗>(µ− µ̂t) ≥ √ 2f̃(δt) √ λA∗>ΣCD −1 t A ∗ +A∗>D−1t VtD −1 t A ∗ }\n≤ ∑ Da P { Mt(D) ≥ (1 + 1 + η λ )−m/2 exp(f̃(δt))|t ∈ Da }\n≤ ( log t\nlog(1 + η)\n)m (1 + 1 + η\nλ )m/2 exp(−f̃(δt))\nFor η = e− 1 and f̃(δt) as in lemma 3, this is bounded by δt. The result with Γ instead of C is a consequence of C + Γ. With δ1 = 1 and δt = 1/(t log2 t) for t ≥ 2, the regret due to Gt is\nE[ T∑ t=1 ∆tI{Gt}] ≤ ∆max(1 + T∑ t=2 1 t log2 t ) ≤ 4∆max ."
    }, {
      "heading" : "3.6 Bounding the variance term",
      "text" : "The goal of this section is to bound Et(At) under the event {∆t ≤ Et(At)}. Let γt ∈ [0, 1] such that for all i, j ∈ At with i 6= j, Γ(ij) ≤ γt √ Γ(ii)Γ(jj). From the\nCauchy-Schwartz inequality, n(ij)t ≤ √ n (i) t n (j) t . Using these two inequalities,\nA>t D −1 t ( t−1∑ s=1 ΓAs)D −1 t At = ∑ i,j∈At n (ij) t Γ (ij) n (i) t n (j) t ≤ (1− γt) ∑ i∈At Γ(ii) n (i) t + γt( ∑ i∈At\n√ Γ(ii)\nn (i) t\n)2 .\nWe recognize here the forms of the indexes used in [7] for independent arms (left term) and [12] for general arms (right term). Using ∆t ≤ Et(At) we get\n∆2t 8f(t) ≤ (λ+ 1− γt) ∑ i∈At Γ(ii) n (i) t + γt( ∑ i∈At\n√ Γ(ii)\nn (i) t\n)2 . (1)\nThe strategy from here is to find events that must happen when (1) holds and to show that these events cannot happen very often. For positive integers j and t and for e ∈ {1, 2}, we define the set of arms in At that were pulled less than a given threshold: Sjt,e = {i ∈ At, n (i) t ≤ αj,e\n8f(t)Γ(ii)ge(m,γt) ∆2t\n}, with ge(m, γt) to be stated later and (αi,e)i≥1 a decreasing sequence. Let also S0t,e = At. (S j t,e)j≥0 is decreasing for the inclusion of sets and we impose limj→+∞ αj,e = 0, such that there is an index j∅ with S j∅ t,e = ∅. We introduce another positive sequence (βj,e)j≥0 and consider the events that at least mβj,e arms in At are in the set S j t,e and that the same is false for k < j, i.e. for t ≥ 1, Ajt,e = {|S j t,e| ≥ mβj,e;∀k <\nj, |Skt,e| < mβk,e}. To avoid having some of these events being impossible we choose (βj,e)j≥0 decreasing. We also impose β0,e = 1, such that |S0t,e| = mβ0,e.\nLet then At,e = ∪+∞j=1A j t,e and At = At,1 ∪ At,2. We will show that At must happen for (1) to be true. First, remark that under a condition on (βj,e)j≥0, At is a finite union of events,\nLemma 7. For e ∈ {1, 2}, if there exists j0,e such that βj0,e,e ≤ 1/m, then At,e = ∪j0j=1A j t,e.\nWe now show that At is impossible by proving a contradiction in (1).\nLemma 8. Under the event At,1, if there exists j0 such that βj0,1 ≤ 1/m, then\n∑ i∈At Γ(ii) n (i) t < m∆2t 8f(t)g1(m, γt)  j0∑ j=1 βj−1,1 − βj,1 αj,1 + βj0,1 αj0,1  . Under the event At,2, if limj→+∞ βj,2/ √ αj,2 = 0 and ∑+∞ j=1 βj−1,2−βj,2√ αj,2\nexists, then\n∑ i∈At\n√ Γ(ii)\nn (i) t ≤ m∆t√ 8f(t)g2(m, γt) +∞∑ j=1 βj−1,2 − βj,2√ αj,2 .\nA proof can be found in appendix B.2 of the supplementary material. To ensure that the conditions of these lemmas are fulfilled, we impose that (βi,1)i≥0 and (βi,2)i≥0 have limit 0 and that limj→+∞ βj,2/ √ αj,2 = 0. Let j0,1 be the smallest integer such that βj0,1,1 ≤ 1/m. Let l1 = βj0,1,1 αj0,1,1 + ∑j0,1 j=1 βj−1,1−βj,1 αj,1 and\nl2 = ∑+∞ j=1 βj−1,2−βj,2√ αj,2\n. Using the two last lemmas with (1), we get that if At is true,\n∆2t 8f(t) < ∆2t 8f(t)\n( (λ+ 1− γt)\nml1 g1(m, γt) + γt m2l22 g2(m, γt)\n) .\nTaking g1(m, γt) = 2(λ+ 1− γt)ml1 and g2(m, γt) = 2γtm2l22, we get a contradiction. Hence with these choices At must happen. The regret bound will be obtained by a union bound on the events that form At. First suppose that all gaps are equal to the same ∆.\nLemma 9. Let γ = maxt≥1 γt. For j ∈ N∗, the event Ajt,e happens at most dαj,e8f(T ) maxi{Γ(ii)}ge(m,γ)\nmβj,e∆2 times.\nProof. Each time that Ajt,e happens, the counter of plays n (i) t of at least mβje arms is incremented. After αj,e8f(T ) maxi{Γ (ii)}ge(m,γ)\n∆2 increments, an arm cannot verify the condition on n(i)t any more. There are d arms, so the event can happen at most d 1mβje αj,e8f(T ) maxi{Γ(ii)}ge(m,γ) ∆2 times.\nIf all gaps are equal to ∆, an union bound for At gives\nE[ T∑ t=1 ∆I{Ht ∩Gt}] ≤ 16 max i∈[d] {Γ(ii)}f(T ) ∆ d (λ+ 1− γ)l1 j0,1∑ j=1 αj,1 βj,1 + γml22 +∞∑ j=1 αj,2 βj,2  . The general case requires more involved manipulations but the result is similar and no new important idea is used. The following lemma is proved in appendix B.2 of the supplementary material:\nLemma 10. Let γ(i) = max{t,i∈At} γt. The regret from the event Ht ∩ Gt is such that E[ T∑ t=1 ∆tI{Ht ∩Gt}] ≤ 16f(T ) ∑ i∈[d] Γ(ii) ∆i,min (λ+ 1− γ)l1 j0∑ j=1 αj,1 βj,1 + γml22 +∞∑ j=1 αj,2 βj,2  . Finally we can find sequences (αj,1)j≥1, (αj,2)j≥1, (βj,1)j≥0 and (βj,2)j≥0 such that E[ T∑ t=1 ∆I{Ht ∩Gt}] ≤ 16f(T ) ∑ i∈[d] Γ(ii) ∆i,min ( 5(λ+ 1− γ(i)) ⌈ logm 1.6 ⌉2 + 45γ(i)m )\nSee appendix C of the supplementary material. In [7], αi,1 and βi,1 were such that the log2m term was replaced by √ m. Our choice is also applicable to their ESCB algorithm. Our use of geometric sequences is only optimal among sequences such that βi,1 = αi,1 for all i ≥ 1. It is unknown to us if one can do better. With this control of the variance term, we finally proved Theorem 2."
    }, {
      "heading" : "4 Conclusion",
      "text" : "We defined a continuum of settings from the general to the independent arms cases which is suitable for the analysis of semi-bandit algorithms. We exhibited a lower bound scaling with a parameter that quantifies the particular setting in this continuum and proposed an algorithm inspired from linear regression with an upper bound that matches the lower bound up to a log2m term. Finally we showed how to use tools from the linear bandits literature to analyse algorithms for the combinatorial bandit case that are based on linear regression.\nIt would be interesting to estimate the subgaussian covariance matrix online to attain good regret bounds without prior knowledge. Also, our algorithm is not computationally efficient since it requires the computation of an argmax over the actions at each stage. It may be possible to compute this argmax less often and still keep the regret guaranty, as was done in [1] and [7].\nOn a broader scope, the inspiration from linear regression could lead to algorithms using different estimators, adapted to the structure of the problem. For example, the weighted least-square estimator is also unbiased and has smaller variance than OLS. Or one could take advantage of a sparse covariance matrix by using sparse estimators, as was done in the linear bandit case in [4]."
    }, {
      "heading" : "Acknowledgements",
      "text" : "The authors would like to acknowledge funding from the ANR under grant number ANR-13-JS01-0004 as well as EDF through the Program Gaspard Monge for Optimization And the Irsdi project Tecolere."
    }, {
      "heading" : "A The subgaussian covariance matrix",
      "text" : "Property 0. An α-subgaussian variable X verifies Var[X] ≤ α2.\nLet η be a noise in Rd with mean 0 and subgaussian covariance matrix C. The following properties are immediate consequences of property 0 and are presented as a justification for the name subgaussian \"covariance\" matrix.\nProperty 1. For all i ∈ [d], Var[η(i)] ≤ C(ii).\nProperty 2. For all (i, j) ∈ [d], Var[η(i)] +Var[η(j)] + 2Cov[η(i), η(j)] ≤ C(ii) + C(jj) + 2C(ij).\nProperty 3. If Var[η(i)] = C(ii) and Var[η(j)] = C(jj), Cov[η(i), η(j)] ≤ C(ij)."
    }, {
      "heading" : "B Missing proofs",
      "text" : "B.1 Lower bound Proof. We consider the problem where A is a set of d/m disjoint actions A1, . . . , Ad/m and suppose that these actions are independent. This is not more than a bandit problem with d/m arms, each with m sub-arms. We choose a noise ∼ N (0, σ2Id) (multivariate normal with mean 0 and covariance matrix Id) and a subgaussian matrix C = (1− γ)Id + γJblocs, where Jblocs is a bloc matrix such that each m×m bloc indexed by an action Aj contains only ones and other coefficients are 0. The actions are independent and the sub-arms are correlated with correlation γ. Then C1/2 = √ 1− γId + 1m ( √ 1 + γ(m− 1)− √ 1− γ)Jblocs. The mean of the best action is taken to be 0 and the mean of other actions is −∆. The algorithm has access to all these informations, except for the identity of the optimal action.\nSuppose for notational convenience that the first action is optimal. The reward of the best action is ν1 = √ 1 + γ(m− 1) ∑ i∈A1 i, while the reward of\na sub-optimal action Aj is νj = √ 1 + γ(m− 1) ∑ i∈Aj i −∆.\nWe use a result from [13] which states that in this bandit case,\nlim inf t→+∞ Rt log t ≥ d/m∑ j=2\n∆\nDKL(νj , ν1) . (2)\nIn our setting, the Kullback-Leibler divergence is DKL(νj , ν1) = DKL( √ 1 + γ(m− 1) ∑ i∈Aj i −∆, √ 1 + γ(m− 1) ∑ i∈A1 i)\n= DKL\n( N (−∆, σ2m(1 + γ(m− 1))),N (0, σ2m(1 + γ(m− 1))) ) = ∆2\n2σ2m(1 + γ(m− 1)) .\nThis together with (2) proves the theorem.\nB.2 Upper bound Proof. Lemma 1.\nI{Gt,Ht} = I{A∗>µ ≤ A∗>µ̂t + Et(A∗),Ht} ≤ I{A∗>µ ≤ A>t µ̂t + Et(At),Ht}\n≤ I{A∗>µ ≤ A>t µ+ ∆t 2 + Et(At)} = I{∆t ≤ 2Et(At)} ,\nwhere we used first that the algorithm chooses At = arg maxA(A>µ̂t + Et(A)), then that under Ht we have A>t µ̂t ≤ A>t µ+ ∆t2 . E[ T∑ t=1 ∆tI{Gt,Ht}] ≤ T∑ t=1 E[∆tI{∆t ≤ 2Et(At)}] ≤ 2 T∑ t=1 E[Et(At)I{∆t ≤ 2Et(At)}]\nProof. Lemma 2. T∑ t=1 ∆tP{Ht} ≤ T∑ t=1 ∑ i∈At ∆tP{Hi,t}\n= T∑ t=1 ∑ i∈At ∆tP{|µ̂(i)t − µ(i)| ≥ ∆t 2m }\n= d∑ i=1 T∑ t=1 ∆tP{i ∈ At, |µ̂(i)t − µ(i)| ≥ ∆t 2m }\n≤ ∆max d∑ i=1 T∑ t=1 P{i ∈ At, |µ̂(i)t − µ(i)| ≥ ∆min 2m }\n≤ ∆max d∑ i=1 T∑ t=1 exp(− ∆ 2 mint 8m2C(ii) )\n≤ 8dm 2 maxi{C(ii)}∆max\n∆2min .\nProof. Lemma 4.\nA∗>(µ− µ̂t) = −A∗>D−1t t−1∑ s=1 IAsC 1/2 s\n= −A∗>D−1t t−1∑ s=1 IAs∩A∗C 1/2 s\n= −A∗>D−1t (D + t−1∑ s=1 CAs∩A∗) 1/2(D + t−1∑ s=1 CAs∩A∗) −1/2 t−1∑ s=1 IAs∩A∗C 1/2 s\n≤ √√√√A∗>D−1t (D + t−1∑ s=1 CAs∩A∗)D −1 t A ∗ ∥∥∥∥∥ t−1∑ s=1 IAs∩A∗C 1/2 s ∥∥∥∥∥ (D+ ∑t−1 s=1 CAs∩A∗ ) −1\nwhere the last step is the Cauchy-Schwarz inequality. Since IA∗D λIA∗ΣCDt, A∗>(µ− µ̂t) ≤ √ λA∗>ΣCD −1 t A ∗ +A∗>D−1t VtD −1 t A ∗ √ 2IVt+D( ) .\nWe proved P { A∗>(µ−µ̂t)≥ √ 2f̃(δt)A∗>D −1 t (λΣCDt+Vt)D −1 t A ∗ ∣∣∣t∈Da} ≤ P{IVt+D( )≥f̃(δt)|t∈Da} .\nProof. Lemma 5. Let Ft be the σ-algebra σ(A1, 1, . . . , At−1, t−1, At). Let f(u) be the density of a multivariate normal random variable independent of all other variables with mean 0 and covariance D−1. Then from the proof of lemma 9 of [1],\nMt(D) =\n√ detD\ndet(D + Vt) exp(IVt+D( ))\n= ∫ Rd exp ( u> t−1∑ s=1 IAs∩A∗C 1/2 s − 1 2 u> t−1∑ s=1 CAs∩A∗u ) f(u)du\nWe define the following quantities, for u ∈ Rd,\nMut = exp\n( u>\nt−1∑ s=1 IAs∩A∗C 1/2 s − 1 2 u> t−1∑ s=1 CAs∩A∗u\n) ,\nDus = exp ( u>IAs∩A∗C 1/2 s − 1\n2 u>CAs∩A∗u ) such that Mut = ∏t−1 s=1D u s .\nFrom the subgaussian property of s, E[Dus |Fs] ≤ 1.\nE[Mut |Fs−1] = E[ t−1∏ s=1 Dus |Fs−1]\n= ( t−2∏ s=1 Dus )E[Dut−1|Ft−1] ≤Mut−1 .\nThus Mut is a supermartingale and E[Mu1 ] = E[Du1 ] ≤ 1. So for all t, E[Mut ] ≤ 1. Finally, E[Mt(D)] = EuE[Mut |u]] ≤ 1.\nProof. Lemma 6. We have 11+η IA∗Dt Da IA∗Dt. We use D = λΣCDa + I[d]\\A∗ . Then\nλ 1+η IA∗ΣCDt D. The I[d]\\A∗ part in D is there only to satisfy the positive definiteness and has no consequence.\nThese matrix inequalities show thatD−1/2VtD− 1/2 1+ηλ D −1/2 t Σ −1/2 C VtΣ −1/2 C D −1/2 t ,\nwhich is 1+ηλ times a matrix with m ones and d−m zeros on the diagonal. The determinant of a positive definite matrix is smaller than the product of its diagonal terms, so\ndet(Id +D −1/2VtD −1/2) ≤ det(Id + 1 + η λ D −1/2 t Σ −1/2 C VtΣ −1/2 C D −1/2 t )\n≤ (1 + 1 + η λ )m .\nProof. Lemma 7. Let j0 such that βj0,e ≤ 1/m. Then for all j > j0,\nAjt,e = {|S j t,e| ≥ 1;∀k < j0, |Skt,e| < mβk,e;∀k ∈ {j0, . . . , j − 1}, |Skt,e| = 0} .\nBut as the sequence of sets (Sjt,e)j is decreasing, {|S j0 t,e| = 0} and {|S j t,e| ≥ 1} cannot happen simultaneously. Ajt,e cannot happen for j > j0.\nProof. Lemma 8. First we rewrite At,1, following [12],\nAt,1 = ∩j0j=1A j t,1 = ∩j0j=1 [ {|Sjt,1| < mβj,1} ∪ (∪ j−1 k=1{|S k t,1| ≥ mβk,1}) ] = ∩j0j=1{|S j t,1| < mβj,1}\n= (∩j0−1j=1 {|S j t,1| < mβj,1}) ∩ {|S j0 t,1| = 0} .\nThe complementary set of Sjt,1 in At is S j t,1 = {i ∈ At, i /∈ S j t,1}. If we have At,1, then S j0 t,1 = At and thus\n∑ i∈At Γ(ii) n (i) t = j0∑ j=1 ∑ i∈Sjt,1\\S j−1 t,1 Γ(ii) n (i) t\n< j0∑ j=1 ∑ i∈Sjt,1\\S j−1 t,1 ∆2t 8f(t)g1(m, γt)αj,1\n= ∆2t\n8f(t)g1(m, γt) j0∑ j=1 |Sjt,1 \\ S j−1 t,1 | αj,1\n< m∆2t\n8f(t)g1(m, γt)  j0∑ j=1 βj−1,1 − βj,1 αj,1 + βj0,1 αj0,1  , (3) where (3) follows the same steps as lemma 4 of [12].\nProof of the second statement of the lemma: First, follow the same steps as before to get\n∑ i∈At\n√ Γ(ii)\nn (i) t\n< m∆t√\n8f(t)g2(m, γt)  j0∑ j=1 βj−1,2 − βj,2√ αj,2 + βj0,2√ αj0,2  . Then take the limit when j0 → +∞.\nProof. Lemma 10. We break the events Ajt,e into sub-events A j,a t,e = A j t,e ∩ {a ∈ At, n (a) t ≤ αj,e 8f(t)Γ(aa)ge(m,γt)\n∆2t } that at least mβj,e arms are not pulled often and that the\narm a is one of them. Since Ajt,e implies that at least βj,em arms are pulled less than the threshold, we have\nI{Ajt,e} ≤ 1\nmβj,e d∑ a=1 I{Aj,at,e} .\nThe regret that we want to bound is\nT∑ t=1 ∆tI{Ht ∩Gt} ≤ 2∑ e=1 T∑ t=1 j0∑ j=1 ∆tI{Ajt,e}\n≤ 2∑ e=1 T∑ t=1 j0∑ j=1 d∑ a=1 ∆t mβj,e I{Aj,at,e} .\nEach arm a is contained in Na actions. Let ∆a,1 ≥ . . . ≥ ∆a,Na be the gaps of these actions and let ∆a,0 = +∞. Then T∑ t=1 ∆tI{Ht ∩Gt} ≤ 2∑ e=1 T∑ t=1 j0∑ j=1 d∑ a=1 Na∑ n=1 ∆a,n mβj,e I{Aj,at,e ,∆t = ∆a,n}\n≤ 2∑ e=1 T∑ t=1 j0∑ j=1 d∑ a=1 Na∑ n=1 ∆a,n mβj,e I{a ∈ At, n(a)t ≤ αj,e 8f(t)Γ(aa)ge(m, γt) ∆2a,n ,∆t = ∆a,n}\nLet θj,e,a = αj,e8f(T )Γ(aa)ge(m, γ). In the following equations, changes between successive lines are highlighted in blue.\nT∑ t=1 Na∑ n=1 ∆a,nI{a ∈ At, n(a)t ≤ αj,e 8f(t)Γ(aa)ge(m, γt) ∆2a,n ,∆t = ∆a,n}\n≤ T∑ t=1 Na∑ n=1 ∆a,nI{a ∈ At, n(a)t ≤ θj,e,a ∆2a,n ,∆t = ∆a,n}\n= T∑ t=1 Na∑ n=1 n∑ p=1 ∆a,nI{a ∈ At, n(a)t ∈ ( θj,e,a ∆2a,p−1 , θj,e,a ∆2a,p ],∆t = ∆a,n} ≤ T∑ t=1 Na∑ n=1 n∑ p=1 ∆a,pI{a ∈ At, n(a)t ∈ ( θj,e,a ∆2a,p−1 , θj,e,a ∆2a,p ],∆t = ∆a,n} ≤ T∑ t=1 Na∑ n=1 Na∑ p=1 ∆a,pI{a ∈ At, n(a)t ∈ ( θj,e,a ∆2a,p−1 , θj,e,a ∆2a,p ],∆t = ∆a,n} ≤ T∑ t=1 Na∑ p=1 ∆a,pI{a ∈ At, n(a)t ∈ ( θj,e,a ∆2a,p−1 , θj,e,a ∆2a,p ],∆t > 0}\n≤ θj,e,a ∆a,1 + Na∑ p=2 θj,e,a∆a,p( 1 ∆2a,p − 1 ∆2a,p−1 )\n≤ θj,e,a ∆a,1 + θj,e,a ∫ ∆a,1 ∆a,Na x−2dx = θj,e,a ∆a,Na = θj,e,a ∆a,min .\nT∑ t=1 ∆tI{Ht ∩Gt} ≤ 2∑ e=1 ∑ a∈[d] j0∑ j=1 θj,e,a mβj,e∆a,min\n= 8f(T ) ∑ a∈[d] Γ(aa) ∆a,min 2∑ e=1 ge(m, γ) m  j0∑ j=1 αj,e βj,e  = 16f(T )\n∑ a∈[d] Γ(aa) ∆a,min (λ+ 1− γ)l1 j0∑ j=1 αj,1 βj,1 + γml22 j0∑ j=1 αj,2 βj,2  ."
    }, {
      "heading" : "C Finding the best sequences for the sums indexed by 1.",
      "text" : "The constraints on the four sequences (αi,1)i≥1, (αi,2)i≥1, (βi,1)i≥0 and (βi,2)i≥0 are that they must be positive decreasing with limit 0, β0,1 = β0,2 = 1 and limj→+∞ βj,2/ √ αj,2 = 0.\nFor i ≥ 1, we take βi,1 = αi,1 = βi with β ∈ (0, 1). Then j0,1 = d logmlog 1/β e and l1 ∑j0,1 j=1 αj,1 βj,1 = j20,1(1/β − 1) + j0,1 ≤ j20,1/β. We take βi,2 and αi,2 as in\n[12]: βi,2 = βi2 with β2 = 0.236; αi,2 = ( 1−β2√ α−β2 )2 αi, with α = 0.146. Then∑+∞\nj=1 αj,2 βj,2 ≤ 45 and l2 ≤ 1.\nThe optimal choice for β is close to 1/5, value for which we get the wanted regret bound.\nWe now show that the choice of αj,1 and βj,1 made previously is close to optimal among the sequences with αj,1 = βj,1.\nLemma 11. Suppose that for all j, αj = βj. Then the optimal value v of ( ∑j0 j=1 αj βj )( βj0 αj0 + ∑j0 j=1 βj−1−βj αj ) is such that\nv ≥ 1.54 log2m .\nProof. We want to minimize j0 ∑j0 j=1( βj−1 βj − 1) under the constraint that j0 = min{j : βj ≤ 1m}. Let hj = βj−1 βj − 1, then the decreasing constraint on the (βj) sequence imposes that for all j ≥ 1, hj ≥ 0. Also, βj0 ≤ 1m implies∏j0 j=1 1 hj+1 ≤ 1m .\nWe solve the following minimization problem:\nminimize over j0, (hj): j0(1 + j0∑ j=1 hj)\nsuch that: ∀j ≥ 1, hj ≥ 0 , j0∏ j=1 (hj + 1) ≥ m ,\nj0 ≥ 1 .\nFor a fixed j0, the minimum in (hj) is attained for all hj equal to m1/j0 − 1. Then we should minimize j20(m1/j0 − 1) + j0 with respect to j0. We will instead write that j20(m1/j0 − 1) + j0 ≥ j20(m1/j0 − 1) and find a lower bound with this latter expression.\nLet f(x) = x2(m1/x − 1) for x ∈ R+. Then with y = xlogm , f(x) = y 2(e1/y − 1) log2m. The function g(y) = y2(e1/y − 1) has a unique minimum and plotting g shows that this minimum x∗ is such that f(x∗) ≥ 1.54 log2m."
    } ],
    "references" : [ {
      "title" : "Improved Algorithms for Linear Stochastic Bandits",
      "author" : [ "Yasin Abbasi-Yadkori", "David Pal", "Csaba Szepesvari" ],
      "venue" : "Neural Information Processing Systems,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2011
    }, {
      "title" : "Regret in online combinatorial optimization",
      "author" : [ "Jean-Yves Audibert", "Sébastien Bubeck", "Gábor Lugosi" ],
      "venue" : "Mathematics of Operations Research,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2013
    }, {
      "title" : "Finite-time analysis of the multiarmed bandit problem",
      "author" : [ "Peter Auer", "Nicolo Cesa-Bianchi", "Paul Fischer" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 2002
    }, {
      "title" : "Bandit Theory meets Compressed Sensing for high dimensional Stochastic Linear Bandit",
      "author" : [ "Alexandra Carpentier", "Rémi Munos" ],
      "venue" : "Advances in Neural Information Processing Systems (NIPS),",
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2012
    }, {
      "title" : "Combinatorial bandits",
      "author" : [ "Nicolo Cesa-Bianchi", "Gábor Lugosi" ],
      "venue" : "Journal of Computer and System Sciences,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2012
    }, {
      "title" : "Combinatorial multi-armed bandit: General framework and applications",
      "author" : [ "Wei Chen", "Yajun Wang", "Yang Yuan" ],
      "venue" : "Proceedings of the 30th International Conference on Machine Learning (ICML),",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2013
    }, {
      "title" : "Combinatorial Bandits Revisited",
      "author" : [ "Richard Combes", "M. Sadegh Talebi", "Alexandre Proutiere", "Marc Lelarge" ],
      "venue" : "Neural Information Processing Systems,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2015
    }, {
      "title" : "Parametric Bandits: The Generalized Linear Case",
      "author" : [ "Sarah Filippi", "Olivier Cappé", "Aurélien Garivier", "Csaba Szepesvári" ],
      "venue" : "Neural Information Processing Systems,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2010
    }, {
      "title" : "Combinatorial network optimization with unknown variables: Multi-armed bandits with linear rewards and individual observations",
      "author" : [ "Yi Gai", "Bhaskar Krishnamachari", "Rahul Jain" ],
      "venue" : "IEEE/ACM Transactions on Networking,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2012
    }, {
      "title" : "Informational confidence bounds for self-normalized averages and applications",
      "author" : [ "Aurélien Garivier" ],
      "venue" : "IEEE Information Theory Workshop,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2013
    }, {
      "title" : "Optimal Regret Analysis of Thompson Sampling in Stochastic Multi-armed Bandit Problem with Multiple Plays",
      "author" : [ "Junpei Komiyama", "Junya Honda", "Hiroshi Nakagawa" ],
      "venue" : "Proceedings of the 32nd International Conference on Machine Learning,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2015
    }, {
      "title" : "Tight regret bounds for stochastic combinatorial semi-bandits",
      "author" : [ "Branislav Kveton", "Zheng Wen", "Azin Ashkan", "Csaba Szepesvari" ],
      "venue" : "Proceedings of the 18th International Conference on Artificial Intelligence and Statistics,",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2015
    }, {
      "title" : "Asymptotically efficient adaptive allocation rules",
      "author" : [ "Tze Leung Lai", "Herbert Robbins" ],
      "venue" : "Advances in applied mathematics,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 1985
    }, {
      "title" : "Self-normalized processes: Limit theory and Statistical Applications",
      "author" : [ "Victor H Peña", "Tze Leung Lai", "Qi-Man Shao" ],
      "venue" : "Springer Science & Business Media,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2008
    }, {
      "title" : "Some aspects of the sequential design of experiments",
      "author" : [ "Herbert Robbins" ],
      "venue" : "In Herbert Robbins Selected Papers,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 1985
    } ],
    "referenceMentions" : [ {
      "referenceID" : 14,
      "context" : "It then gets a reward from this choice, with the goal of maximizing the cumulative reward [15].",
      "startOffset" : 90,
      "endOffset" : 94
    }, {
      "referenceID" : 1,
      "context" : "We consider here its stochastic combinatorial extension, in which the algorithm chooses at each stage a subset of arms [2, 5, 6, 9].",
      "startOffset" : 119,
      "endOffset" : 131
    }, {
      "referenceID" : 4,
      "context" : "We consider here its stochastic combinatorial extension, in which the algorithm chooses at each stage a subset of arms [2, 5, 6, 9].",
      "startOffset" : 119,
      "endOffset" : 131
    }, {
      "referenceID" : 5,
      "context" : "We consider here its stochastic combinatorial extension, in which the algorithm chooses at each stage a subset of arms [2, 5, 6, 9].",
      "startOffset" : 119,
      "endOffset" : 131
    }, {
      "referenceID" : 8,
      "context" : "We consider here its stochastic combinatorial extension, in which the algorithm chooses at each stage a subset of arms [2, 5, 6, 9].",
      "startOffset" : 119,
      "endOffset" : 131
    }, {
      "referenceID" : 4,
      "context" : "This setting was already studied [5], most recently in [7, 12], where two different algorithms are used to tackle on one hand the case where the arms have independent rewards and on the other hand the general bounded case.",
      "startOffset" : 33,
      "endOffset" : 36
    }, {
      "referenceID" : 6,
      "context" : "This setting was already studied [5], most recently in [7, 12], where two different algorithms are used to tackle on one hand the case where the arms have independent rewards and on the other hand the general bounded case.",
      "startOffset" : 55,
      "endOffset" : 62
    }, {
      "referenceID" : 11,
      "context" : "This setting was already studied [5], most recently in [7, 12], where two different algorithms are used to tackle on one hand the case where the arms have independent rewards and on the other hand the general bounded case.",
      "startOffset" : 55,
      "endOffset" : 62
    }, {
      "referenceID" : 10,
      "context" : "Another algorithm for the independent arms case based on Thompson Sampling was introduced in [11].",
      "startOffset" : 93,
      "endOffset" : 97
    }, {
      "referenceID" : 6,
      "context" : "In the case of 1-subgaussian independent rewards, in which C can be chosen diagonal, a known lower bound on the regret appearing in [7] is d ∆ log T , while [12] proves a dm ∆ log T lower bound in general.",
      "startOffset" : 132,
      "endOffset" : 135
    }, {
      "referenceID" : 11,
      "context" : "In the case of 1-subgaussian independent rewards, in which C can be chosen diagonal, a known lower bound on the regret appearing in [7] is d ∆ log T , while [12] proves a dm ∆ log T lower bound in general.",
      "startOffset" : 157,
      "endOffset" : 161
    }, {
      "referenceID" : 12,
      "context" : "The bound is valid for consistent algorithms [13], for which the regret on any problem verifies ERt = o(t) as t→ +∞ for all a > 0.",
      "startOffset" : 45,
      "endOffset" : 49
    }, {
      "referenceID" : 0,
      "context" : "Then, for any ∆ > 0, for any consistent algorithm, there is a problem with gaps ∆, σ-subgaussian arms and correlation coefficients smaller than γ ∈ [0, 1] on which the regret is such that",
      "startOffset" : 148,
      "endOffset" : 154
    }, {
      "referenceID" : 12,
      "context" : "lim inf t→+∞ ERt log t ≥ (1 + γ(m− 1)) (d−m) ∆ This bound is a consequence of the classical result of [13] for multi-armed bandits, applied to the problem of choosing one among d/m paths, each of which has m different successive edges (Figure 1).",
      "startOffset" : 102,
      "endOffset" : 106
    }, {
      "referenceID" : 7,
      "context" : "The design of our algorithm stems from this observation and is inspired by linear regression in the fixed design setting, similarly to what was done in the stochastic linear bandit literature [16, 8].",
      "startOffset" : 192,
      "endOffset" : 199
    }, {
      "referenceID" : 12,
      "context" : "We get confidence intervals for the estimates and can use an upper confidence bound strategy [13, 3].",
      "startOffset" : 93,
      "endOffset" : 100
    }, {
      "referenceID" : 2,
      "context" : "We get confidence intervals for the estimates and can use an upper confidence bound strategy [13, 3].",
      "startOffset" : 93,
      "endOffset" : 100
    }, {
      "referenceID" : 0,
      "context" : "2 Comparison with other algorithms Previous works supposed that the rewards of the individual arms are in [0, 1], which gives them a 1/2-subgaussian property.",
      "startOffset" : 106,
      "endOffset" : 112
    }, {
      "referenceID" : 6,
      "context" : "In the independent case, our algorithm is the same as ESCB-2 from [7], up to the parameter λ.",
      "startOffset" : 66,
      "endOffset" : 69
    }, {
      "referenceID" : 11,
      "context" : "In the general (worst) case, [12] prove an O( log T ∆ ) upper bound (which is tight) using CombUCB1, a UCB based algorithm introduced in [6] which at stage t uses the exploration term √ 1.",
      "startOffset" : 29,
      "endOffset" : 33
    }, {
      "referenceID" : 5,
      "context" : "In the general (worst) case, [12] prove an O( log T ∆ ) upper bound (which is tight) using CombUCB1, a UCB based algorithm introduced in [6] which at stage t uses the exploration term √ 1.",
      "startOffset" : 137,
      "endOffset" : 140
    }, {
      "referenceID" : 13,
      "context" : "We show that it is sufficient to control a selfnormalized sum and do it using arguments from [14], or [1] who applied them to linear bandits.",
      "startOffset" : 93,
      "endOffset" : 97
    }, {
      "referenceID" : 0,
      "context" : "We show that it is sufficient to control a selfnormalized sum and do it using arguments from [14], or [1] who applied them to linear bandits.",
      "startOffset" : 102,
      "endOffset" : 105
    }, {
      "referenceID" : 9,
      "context" : "The analysis also involves a peeling argument, as was done in one dimension by [10] to bound a similar quantity.",
      "startOffset" : 79,
      "endOffset" : 83
    }, {
      "referenceID" : 0,
      "context" : "Doing so leads to the following lemma, extracted from the proof of Theorem 1 of [1].",
      "startOffset" : 80,
      "endOffset" : 83
    }, {
      "referenceID" : 0,
      "context" : "Let γt ∈ [0, 1] such that for all i, j ∈ At with i 6= j, Γ ≤ γt √ Γ(ii)Γ(jj).",
      "startOffset" : 9,
      "endOffset" : 15
    }, {
      "referenceID" : 6,
      "context" : "We recognize here the forms of the indexes used in [7] for independent arms (left term) and [12] for general arms (right term).",
      "startOffset" : 51,
      "endOffset" : 54
    }, {
      "referenceID" : 11,
      "context" : "We recognize here the forms of the indexes used in [7] for independent arms (left term) and [12] for general arms (right term).",
      "startOffset" : 92,
      "endOffset" : 96
    }, {
      "referenceID" : 6,
      "context" : "In [7], αi,1 and βi,1 were such that the logm term was replaced by √ m.",
      "startOffset" : 3,
      "endOffset" : 6
    }, {
      "referenceID" : 0,
      "context" : "It may be possible to compute this argmax less often and still keep the regret guaranty, as was done in [1] and [7].",
      "startOffset" : 104,
      "endOffset" : 107
    }, {
      "referenceID" : 6,
      "context" : "It may be possible to compute this argmax less often and still keep the regret guaranty, as was done in [1] and [7].",
      "startOffset" : 112,
      "endOffset" : 115
    }, {
      "referenceID" : 3,
      "context" : "Or one could take advantage of a sparse covariance matrix by using sparse estimators, as was done in the linear bandit case in [4].",
      "startOffset" : 127,
      "endOffset" : 130
    } ],
    "year" : 2016,
    "abstractText" : "The combinatorial stochastic semi-bandit problem is an extension of the classical multi-armed bandit problem in which an algorithm pulls more than one arm at each stage and the rewards of all pulled arms are revealed. One difference with the single arm variant is that the dependency structure of the arms is crucial. Previous works on this setting either used a worst-case approach or imposed independence of the arms. We introduce a way to quantify the dependency structure of the problem and design an algorithm that adapts to it. The algorithm is based on linear regression and the analysis develops techniques from the linear bandit literature. By comparing its performance to a new lower bound, we prove that it is optimal, up to a poly-logarithmic factor in the number of pulled arms.",
    "creator" : "LaTeX with hyperref package"
  }
}