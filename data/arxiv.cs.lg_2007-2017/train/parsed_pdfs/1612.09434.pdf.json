{
  "name" : "1612.09434.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Data driven estimation of Laplace-Beltrami operator",
    "authors" : [ "Frédéric Chazal", "Ilaria Giulini" ],
    "emails" : [ "frederic.chazal@inria.fr", "ilaria.giulini@me.com", "bertrand.michel@ec-nantes.fr" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "The Laplace-Beltrami operator is a fundamental and widely studied mathematical tool carrying a lot of intrinsic topological and geometric information about the Riemannian manifold on which it is defined. Its various discretizations, through graph Laplacians, have inspired many applications in data analysis and machine learning and led to popular tools such as Laplacian EigenMaps [BN03] for dimensionality reduction, spectral clustering [VL07], or semi-supervised learning [BN04], just to name a few.\nDuring the last fifteen years, many efforts, leading to a vast literature, have been made to understand the convergence of graph Laplacian operators built on top of (random) finite samples to LaplaceBeltrami operators. For example pointwise convergence results have been obtained in [BN05] (see also [BN08]) and [HAL07], and a (uniform) functional central limit theorem has been established in [GK06]. Spectral convergence results have also been proved by [BN07] and [VLBB08]. More recently, [THJ11] analyzed the asymptotic of a large family of graph Laplacian operators by taking the diffusion process approach previously proposed in [NLCK06].\nGraph Laplacians depend on scale or bandwidth parameters whose choice is often left to the user. Although many convergence results for various metrics have been established, little is known about how to rigorously and efficiently tune these parameters in practice. In this paper we address this problem in the case of unnormalized graph Laplacian. More precisely, given a Riemannian manifold M of known dimension d and a function f : M → R , we consider the standard unnormalized graph Laplacian operator defined by\n∆̂hf(y) = 1\nnhd+2 ∑ i K ( y −Xi h ) [f(Xi)− f(y)] , y ∈M,\n30th Conference on Neural Information Processing Systems (NIPS 2016), Barcelona, Spain.\nar X\niv :1\n61 2.\n09 43\n4v 1\n[ cs\n.C G\n] 3\nwhere h is a bandwidth, X1, . . . , Xn is a finite point cloud sampled on M on which the values of f can be computed, and K is the Gaussian kernel: for y ∈ Rm\nK(y) = 1\n(4π)d/2 e−‖y‖ 2 m/4, (1)\nwhere ‖y‖m is the Euclidean norm in the ambiant space Rm. In this case, previous results (see for instance [GK06]) typically say that the bandwidth parameter h in ∆̂h should be taken of the order of n− 1 d+2+α for some α > 0, but in practice, for a given point cloud, these asymptotic results are not sufficient to choose h efficiently. In the context of neighbor graphs [THJ11] proposes self-tuning graphs by choosing h locally in terms of the distances to the k-nearest neighbor, but note that k still need to be chosen and moreover as far as we know there is no guarantee for such method to be rate-optimal. More recently a data driven method for spectral clustering has been proposed in [Rie15]. Cross validation [AC+10] is the standard approach for tuning parameters in statistics and machine learning. Nevertheless, the problem of choosing h in ∆̂h is not easy to rewrite as a cross validation problem, in particular because there is no obvious contrast corresponding to the problem (see [AC+10]).\nThe so-called Lepski’s method is another popular method for selecting the smoothing parameter of an estimator. The method has been introduced by Lepski [Lep92b, Lep93, Lep92a] for kernel estimators and local polynomials for various risks and several improvements of the method have then been proposed, see [LMS97, GL09, GL+08]. In this paper we adapt Lepski’s method for selecting h in the graph Laplacian estimator ∆̂h. Our method is supported by mathematical guarantees: first we obtain an oracle inequality - see Theorem 3.1 - and second we obtain the correct rate of convergence - see Theorem 3.3 - already proved in the asymptotical studies of [BN05] and [GK06] for non data-driven choices of the bandwidth. Our approach follows the ideas recently proposed in [LM15], but for the specific problem of Laplacian operators on smooth manifolds. In this first work about the data-driven estimation of Laplace-Beltrami operator, we focus as in [BN05] and [GK06] on the pointwise estimation problem: we consider a smooth function f on M and the aim is to estimate ∆̂f for the L2-norm ‖ · ‖2,M on M ⊂ Rm. The data driven method presented here may be adapted and generalized for other types of risks (uniform norms on functional family and convergence of the spectrum) and other types of graph Laplacian operators, this will be the subject of future works.\nThe paper is organized as follows: Lepski’s method is introduced in Section 2. The main results are stated in Section 3 and a sketch of their proof is given in Section 4 (the complete proofs are given in the supplementary material). A numerical illustration and a discussion about the proposed method are given in Sections 5 and 6 respectively."
    }, {
      "heading" : "2 Lepski’s procedure for estimating the Laplace-Beltrami operator",
      "text" : "All the Riemannian manifolds considered in the paper are smooth compact d-dimensional submanifolds (without boundary) of Rm endowed with the Riemannian metric induced by the Euclidean structure of Rm. Recall that, given a compact d-dimensional smooth Riemannian manifold M with volume measure µ, its Laplace-Beltrami operator is the linear operator ∆ defined on the space of smooth functions on M as ∆(f) = −div(∇f) where ∇f is the gradient vector field and div the divergence operator. In other words, using the Stoke’s formula, ∆ is the unique linear operator satisfying ∫\nM ‖∇f‖2dµ = ∫ M ∆(f)fdµ.\nReplacing the volume measure µ by a distribution P which is absolutely continuous with respect to µ, the weighted Laplace-Beltrami operator ∆P is defined as\n∆Pf = ∆f + 1\np 〈∇p,∇f〉 , (2)\nwhere p is the density of P with respect to µ. The reader may refer to classical textbooks such as, e.g., [Ros97] or [Gri09] for a general and detailed introduction to Laplace operators on manifolds.\nIn the following, we assume that we are given n points X1, . . . , Xn sampled on M according to the distribution P. Given a smooth function f on M , the aim is to estimate ∆Pf , by selecting\nan estimator in a given finite family of graph Laplacian (∆̂hf)h∈H, where H is a finite family of bandwidth parameters.\nLepski’s procedure is generally presented as a method for selecting bandwidth in an adaptive way. More generally, this method can be seen as an estimator selection procedure."
    }, {
      "heading" : "2.1 Lepski’s procedure",
      "text" : "We first shortly explain the ideas of Lepski’s method. Consider a target quantity s, a collection of estimators (ŝh)h∈H and a loss function `(·, ·). A standard objective when selecting ŝh is trying to minimize the risk E`(s, ŝh) among the family of estimators. In most settings, the risk of an estimator can be decomposed into a bias part and a variance part. Of course neither the risk, the bias nor the variance of an estimator are known in practice. However in many cases, the variance term can be controlled quite precisely. Lepski’s method requires that the variance of each estimator ŝh can be tightly upper bounded by a quantity v(h). In most cases, the bias can be written as `(s, s̄h) where s̄h corresponds to some (deterministic) averaged version of ŝh. It thus seems natural to estimate `(s, s̄h) by `(ŝh′ , ŝh) for some h′ smaller than h. The later quantity incorporates some randomness while the bias does not. The idea is to remove the “random part\" of the estimation by considering [`(ŝh′ , ŝh)− v(h)− v(h′)]+, where [ ]+ denotes the positive part. The bias term is estimated by considering all pairs of estimators (sh, ŝh′) through the quantity suph′≤h [`(ŝh′ , ŝh)− v(h)− v(h′)]+. Finally, the estimator minimizing the sum of the estimated bias and variance is selected, see eq. (3) below.\nIn our setting, the control of the variance of the graph Laplacian estimators ∆̂h is not tight enough to directly apply the above described method. To overcome this issue, we use a more flexible version of Lepski’s method that involves some multiplicative coefficients a and b introduced in the variance and bias terms. More precisely, let V (h) = Vf (h) be an upper bound for E[‖(E[∆̂h]− ∆̂h)f‖22,M ]. The bandwidth ĥ selected by our Lepski’s procedure is defined by\nĥ = ĥf = arg min h∈H {B(h) + bV (h)} (3)\nwhere B(h) = Bf (h) = max\nh′≤h, h′∈H\n[ ‖(∆̂h′ − ∆̂h)f‖22,M − aV (h′) ] +\n(4)\nwith 0 < a ≤ b. The calibration of the constants a and b in practice is beyond the scope of this paper, but we suggest a heuristic procedure inspired from [LM15] in section 5."
    }, {
      "heading" : "2.2 Variance of the graph Laplacian for smooth functions",
      "text" : "In order to control the variance term, we consider for this paper the set F of smooth functions f : M → R uniformly bounded up to the third order. For some constant CF > 0 , let\nF = { f ∈ C3(M,R) , ‖f (k)‖∞ ≤ CF , k = 0, . . . , 3 } (5)\nHere, by ‖f (k)‖∞ ≤ CF we mean that in any normal coordinate systems all the partial derivatives of order k of f are bounded by CF .\nWe introduce some notation before giving the variance term for f ∈ F . Define\nDα = 1\n(4π)d ∫ Rd ( C‖u‖α+2d 2 + C1‖u‖αd ) e−‖u‖ 2 d/4 du (6)\nD̃α = 1\n(4π)d/2 ∫ Rd ( C‖u‖α+2d 4 + C1‖u‖αd ) e−‖u‖ 2 d/8 du (7)\nwhere ‖‖d is the euclidean norm in Rd and where C and C1 are geometric constants that only depend on the metric structure of M (see Lemma 6.1 in the appendices). We also introduce the d-dimensional Gaussian kernel on Rd:\nKd(u) = 1\n(4π)d/2 e−‖u‖ 2 d/4, u ∈ Rd\nand we denote by ‖ · ‖p,d the Lp-norm on Rd. The next proposition provides an explicit bound V (h) on the variance term. Let ωd = 3× 2d/2−1 (8) and\nαd(h) = h 2 ( D4 + 3\n2 ωd ‖Kd‖22,d +\n2µ(M)\n(4π)d\n) + h4\nD6 4 . (9)\nWe first need to control the variance of ∆̂hf over F . This will be possible by considering Taylor Young expansions of f in normal coordinates. For that purpose, for technical reasons following from Lemma 6.1, we constrain the parameter h to satisfy the following inequality\n2 √ d+ 4h log(h−1)1/2 ≤ ρ(M), (10)\nwhere ρ(M) is a geometric constant that only depends on the reach and the injectivity radius of M.\nProposition 2.1. Given h ∈ H and for any f ∈ F , we have\nV (h) := 2C2F nhd+2\n[ wd‖Kd‖22,d + αd(h) ] ≤ E[‖(E[∆̂h]− ∆̂h)f‖22,M ].\nFor the proof we refer to section 6.1."
    }, {
      "heading" : "3 Results",
      "text" : "We now give the main result of the paper: an oracle inequality for the estimator ∆̂ĥ, or in other words, a bound on the risk that shows that the performance of the estimator is almost as good as it would be if we knew the risks of each estimator. In particular it performs an (almost) optimal trade-off between the variance term V (h) and the approximation term\nD(h) = Df (h) = max { ‖(p∆P − E[∆̂h])f‖2,M , sup\nh′≤h ‖(E[∆̂h′ ]− E[∆̂h])f‖2,M } ≤ 2 sup\nh′≤h ‖(p∆P − E[∆̂h′ ])f‖2,M .\nTheorem 3.1. According to the notation introduced in the previous section, let = √ a/2− 1 and\nδ(h) = ∑ h′≤h max { exp ( −min{ 2, } √ n 24 ) , exp ( − 2 3 γd(h ′) )} and\nγd(h) = 1\nhd‖p‖∞\n[ ωd ‖Kd‖22,d + αd(h)\n(ωd ‖Kd‖1,d + βd(h))2 ] where αd is defined by (9) and where\nβd(h) = h ( ωd ‖Kd‖1,d + 2µ(M)\n(4π)d/2\n) + h2D̃3 +\nh3D̃4 2 . (11)\nGiven f ∈ C2(M,R), with probability at least 1− 2 ∑ h∈H δ(h),\n‖(p∆P − ∆̂ĥ)f‖2,M ≤ infh∈H\n{ 3D(h) + (1 + √ 2) √ bV (h) } .\nBroadly speaking, Theorem 3.1 says that there exists an event of large probability for which the estimator selected by Lepski’s method is almost as good as the best estimator in the collection. Note that the size of the bandwidth familyH has an impact on the probability term 1− 2 ∑ h∈H δ(h). If H is not too large, an oracle inequality for the risk of ∆̂ĥf can be easily deduced from the later result. Henceforth we assume that f ∈ F . We first give a control on the approximation term D(h).\nProposition 3.2. Assume that the density p is C2. It holds that D(h) ≤ γ CFh where CF is defined in eq. (5) and γ > 0 is a constant depending on M , ‖p‖∞, ‖p′‖∞ and ‖p′′‖∞, where ‖p(k)‖∞ denotes the supremum of the absolute value of the partial derivatives of p in any normal coordinates system.\nWe consider the following grid of bandwidths: H = { e−k , dlog log(n)e ≤ k ≤ blog(n)c } .\nNote that this choice ensures that Condition (10) is always satisfied for n large enough. The previous results lead to the pointwise rate of convergence of the graph Laplacian selected by Lepski’s method: Theorem 3.3. Assume that the density p is C2. For any f ∈ F , we have\nE [ ‖(p∆P − ∆̂ĥ)f‖2,M ] . n− 1 d+4 . (12)"
    }, {
      "heading" : "4 Sketch of the proof of Theorem 3.1",
      "text" : "We observe that the following inequality holds ‖(p∆P − ∆̂ĥ)f‖2,M ≤ D(h) + ‖(E[∆̂h]− ∆̂h)f‖2,M + √ 2 (B(h) + bV (h)). (13) Indeed, for h ∈ H, ‖(p∆P − ∆̂ĥ)f‖2,M ≤ ‖(p∆P − E[∆̂h])f‖2,M + ‖(E[∆̂h]− ∆̂h)f‖2,M + ‖(∆̂h − ∆̂ĥ)f‖2,M\n≤ D(h) + ‖(E[∆̂h]− ∆̂h)f‖2,M + ‖(∆̂h − ∆̂ĥ)f‖2,M .\nBy definition of B(h), for any h′ ≤ h,\n‖(∆̂h′ − ∆̂h)f‖22,M ≤ B(h) + aV (h′) ≤ B(max{h, h′}) + aV (min{h, h′}),\nso that, according to the definition of ĥ in eq. (3) and recalling that a ≤ b,\n‖(∆̂ĥ − ∆̂h)f‖ 2 2,M ≤ 2 [B(h) + aV (h)] ≤ 2 [B(h) + bV (h)]\nwhich proves eq. (13).\nWe are now going to bound the terms that appear in eq. (13). The bound for D(h) is already given in Proposition 3.2, so that in the following we focus on B(h) and ‖(E[∆̂h] − ∆̂h)f‖2,M . More precisely the bounds we present in the next two propositions are based on the following lemma from [LM15].\nLemma 4.1. Let X1, . . . , Xnbe an i.i.d. sequence of variables. Let S̃ a countable set of functions and let η(s) = 1n ∑ i [gs(Xi)− E[gs(Xi)]] for any s ∈ S̃. Assume that there exist constants θ and vg such that for any s ∈ S̃ ‖gs‖∞ ≤ θ and Var[gs(X)] ≤ vg. Denote H = E[sups∈S̃ η(s)]. Then for any > 0 and any H ′ ≥ H\nP [ sup s∈S̃ η(s) ≥ (1 + )H ′ ] ≤ max { exp ( − 2nH ′2 6vg ) , exp ( −min{ 2, }nH ′ 24 θ )} .\nProposition 4.2. Let = √ a 2 − 1. Given h ∈ H, define\nδ1(h) = ∑ h′≤h max { exp ( −min{ 2, } √ n 24 ) , exp ( − 2 3 γd(h ′) )} .\nWith probability at least 1− δ1(h) B(h) ≤ 2D(h)2.\nProposition 4.3. Let ̃ = √ a− 1. Given h ∈ H, define\nδ2(h) = max\n{ exp ( −min{̃ 2, ̃} √ n\n24\n) , exp ( − ̃ 2\n3 γd(h)\n)} .\nWith probability at least 1− δ2(h) ‖(E[∆̂h]− ∆̂h)f‖2,M ≤ √ aV (h).\nCombining the above propositions with eq. (13), we get that, for any h ∈ H, with probability at least 1− (δ1(h) + δ2(h)),\n‖(p∆P − ∆̂ĥ)f‖2,M ≤ D(h) + √ aV (h) + √ 4D(h)2 + 2bV (h)\n≤ 3D(h) + (1 + √ 2) √ bV (h)\nwhere we have used the fact that a ≤ b. Taking a union bound on h ∈ H we conclude the proof."
    }, {
      "heading" : "5 Numerical illustration",
      "text" : "In this section we illustrate the results of the previous section on a simple example. In section 5.1, we describe a practical procedure when the data set X is sampled according to the uniform measure on M . A numerical illustration us given in Section 5.2 when M is the unit 2-dimensional sphere in R3."
    }, {
      "heading" : "5.1 Practical application of the Lepksi’s method",
      "text" : "Lepski’s method presented in Section 2 can not be directly applied in practice for two reasons. First, we can not compute the L2-norm ‖ ‖2,M onM , the manifoldM being unknown. Second, the variance terms involved in Lepski’s method are not completely explicit.\nRegarding the first issue, we can approximate ‖ ‖2,M by splitting the data into two samples: an estimation sample X1 for computing the estimators and a validation sample X2 for evaluating this norm. More precisely, given two estimators ∆̂hf and ∆̂h′f computed using X1, the quantity ‖(∆̂h − ∆̂h′)f‖22,M/µ(M) is approximated by the averaged sum 1n2 ∑ x∈X2 |∆̂hf(x)− ∆̂h′f(x)|\n2, where n2 is the number of points in X2. We use these approximations to evaluate the bias terms B(h) defined by (4).\nThe second issue comes from the fact that the variance terms involved in Lepski’s method depend on the metric properties of the manifold and on the sampling density, which are both unknown. Theses variance terms are thus only known up to a multiplicative constant. This situation contrasts with more standard frameworks for which a tight and explicit control on the variance terms can be proposed, as in [Lep92b, Lep93, Lep92a]. To address this second issue, we follow the calibration strategy recently proposed in [LM15] (see also [LMR16]). In practice we remove all the multiplicative constants from V (h): all these constants are passed into the terms a and b. This means that we rewrite Lepski’s method as follows:\nĥ(a, b) = arg min h∈H\n{ B(h) + b 1\nnh4 } where\nB(h) = max h′≤h, h′∈H\n[ ‖(∆̂h′ − ∆̂h)f‖22,M − a 1\nnh′4 ] + .\nWe choose a and b according to the following heuristic:\n1. Take b = a and consider the sequence of selected models: ĥ(a, a), 2. Starting from large values of a, make a decrease and find the location a0 of the main\nbandwidth jump in the step function a 7→ ĥ(a, a), 3. Select the model ĥ(a0, 2a0).\nThe justification of this calibration method is currently the subject of mathematical studies ([LM15]). Note that a similar strategy called \"slope heuristic\" has been proposed for calibrating `0 penalties in various settings by strong mathematical results, see for instance [BM07, AM09, BMM12]."
    }, {
      "heading" : "5.2 Illustration on the sphere",
      "text" : "In this section we illustrate the complete method on a simple example with data points generated uniformly on the sphere S2 in R3. In this case, the weighted Laplace-Beltrami operator is equal to the (non weighted) Laplace-Beltrami operator on the sphere.\nWe consider the function f(x, y, z) = (x2 + y2 + z) sinx cosx. The restriction of this function on the sphere has the following representation in spherical coordinates:\nf̃(θ, φ) = (sin2 φ+ cosφ) sin(sinφ cos θ) cos(sinφ cos θ).\nIt is well known that the Laplace-Beltrami operator on the sphere satisfies (see Section 3 in [Gri09]):\n∆S2u = 1\nsin2 φ\n∂2u ∂θ2 + 1 sinφ ∂ ∂φ\n( sinφ ∂u\n∂φ ) for any smooth polar function u. This allows us to derive an analytic expression of ∆S2 f̃ .\nWe sample n1 = 106 points on the sphere for computing the graph Laplacians and we use n = 103 points for approximating the norms ‖(∆̂h − ∆̂h′)f̃‖22,M . We compute the graph Laplacians for bandwidths in a grid H between 0.001 and 0.8 (see fig. 1). The risk of each graph Laplacian is estimated by a standard Monte Carlo procedure (see fig. 2).\nFigure 3 illustrates the calibration method. On this picture, the x-axis corresponds to the values of a and the y-axis represents the bandwidths. The blue step function represents the function a 7→ ĥ(a, a). The red step function gives the model selected by the rule a 7→ ĥ(a, 2a). Following the heuristics given in Section 5.1, one could take for this example the value a0 ≈ 3.5 (location of the bandwidth jump for the blue curve) which leads to select the model ĥ(a0, 2a0) ≈ 0.2 (red curve)."
    }, {
      "heading" : "6 Discussion",
      "text" : "This paper is a first attempt for a complete and well-founded data driven method for inferring LaplaceBeltrami operators from data points. Our results suggest various extensions and raised some questions of interest. For instance, other versions of the graph Laplacian have been studied in the literature (see for instance [HAL07, BN08]), for instance when data is not sampled uniformly. It would be relevant to propose a bandwidth selection method for these alternative estimators also.\nFrom a practical point of view, as explained in section 5, there is a gap between the theory we obtain in the paper and what can be done in practice. To fill this gap, a first objective is to prove an oracle inequality in the spirit of Theorem 3.1 for a bias term defined in terms of the empirical norms\ncomputed in practice. A second objective is to propose mathematically well-founded heuristics for the calibration of the parameters a and b.\nTuning bandwidths for the estimation of the spectrum of the Laplace-Beltrami operator is a difficult but important problem in data analysis. We are currently working on the adaptation of our results to the case of operator norms and spectrum estimation."
    }, {
      "heading" : "Appendix: the geometric constants C and C1",
      "text" : "The following classical lemma (see, e.g. [GK06][Prop. 2.2 and Eq. 3.20]) relates the constants C and C1 introduced in Equations (6) and (7) to the geometric structure of M . Lemma 6.1. There exist constants C,C1 > 0 and a positive real number r > 0 such that for any x ∈M , and any v ∈ TxM such that ‖v‖ ≤ r,∣∣∣∣√det(gij)(v)− 1∣∣∣∣ ≤ C1‖v‖2d and 12‖v‖2d ≤ ‖v‖2d − C‖v‖4d ≤ ‖Ex(v)− x‖2m ≤ ‖v‖2d (14) where Ex : TxM →M is the exponential map and (gi,j)i,j ∈ {1, · · · , d} are the components of the metric tensor in any normal coordinate system around x.\nAlthough the proof of the lemma is beyond the scope of this paper, notice that one can indeed give explicit bounds on r and C in terms of the reach and injectivity radius of the submanifold M ."
    }, {
      "heading" : "Acknowledgments",
      "text" : "The authors are grateful to Pascal Massart for helpful discussions on Lepski’s method and to Antonio Rieser for his careful reading and for pointing a technical bug in a preliminary version of this work. This work was supported by the ANR project TopData ANR-13-BS01-0008 and ERC Gudhi No. 339025"
    }, {
      "heading" : "Appendix: Proofs",
      "text" : "For the sake of simplicity, we introduce the renormalized kernel\nHh(y) = 1\nhd+2 K (y/h) =\n1\nhd+2(4π)d/2 e−‖y‖ 2 m/4h 2 , y ∈ Rm,\nso that ∆̂h rewrites as\n∆̂hf(y) = 1\nn n∑ i=1 Hh(y −Xi) [f(Xi)− f(y)]\nwhere we recall that X1, . . . , Xn is a finite point cloud (i.i.d.) sampled on M . Note that the expectation ∆h of ∆̂h satisfies\n∆hf(y) = E∆̂hf(y) = ∫ Hh(y − x) [f(x)− f(y)] dP(x).\nWe present a technical result that is useful in the following and whose proof is postpone to section 6.5.\nLemma 6.2. Let x ∈ M and h ∈ H. According to the notation introduced in section 2.2 and in section 3∫\nM\n|Hh(y − x)(f(x)− f(y))| dµ(y) ≤ CF h\n[ wd‖Kd‖1,d + βd(h) ] =: I1(h) (15)\nMoreover∫ M |Hh(y − x)(f(x)− f(y))|2 dµ(y) ≤ 2C2F hd+2 [ wd‖Kd‖22,d + αd(h) ] =: I2(h). (16)\nWe also observe the following facts.\nRemark 6.3. Given t ∈ R and s, q > 0,\ntqe−t 2/s2 ≤ λe−t 2/2s2\nwhere λ = sqqq/2e−q/2.\nRemark 6.4. Given a, b > 0, e−(a−b) − e−a ≤ be−a/2\nso that, under the assumptions of Lemma 6.1, given s > 0,\ne−‖Ex(v)−x‖ 2 m/s 2 − e−‖v‖ 2 d/s 2 ≤ e−(‖v‖ 2 d−C‖v‖ 4 d)/s 2 − e−‖v‖ 2 d/s 2 ≤ C‖v‖ 4 d\ns2 e−‖v‖ 2 d/2s 2 ."
    }, {
      "heading" : "6.1 Proof of Proposition 2.1",
      "text" : "In order to get the bound V (h) for E[‖(E[∆̂h] − ∆̂h)f‖22,M ] we observe that, according to the definition of ∆̂h and using the fact that the sample is i.i.d.,\nE[‖(E[∆̂h]− ∆̂h)f‖22,M ] ≤ 1 n E [∫ |Hh(y −X)(f(X)− f(y)|2 dµ(y) ] ≤ 1 n I2(h)\nwhere the last line follows from Lemma 6.2."
    }, {
      "heading" : "6.2 Proof of Theorem 3.1",
      "text" : "According to the sketch of the proof provided in section 4, we only need to prove Proposition 4.2 and Proposition 4.3."
    }, {
      "heading" : "6.2.1 Proof of Proposition 4.2",
      "text" : "Recalling the definition of B(h), since, for any h′ ≤ h,\n‖(∆̂h′ − ∆̂h)f‖22,M ≤ 2 [ ‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖22,M + ‖(∆h′ −∆h)f‖22,M ] ≤ 2 [ ‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖22,M +D(h)2\n] we get\nB(h) ≤ max h′≤h\n[ 2‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖22,M + 2D(h)2 − aV (h′) ] + .\nThus it is sufficient to prove that\n2‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖22,M ≤ aV (h′).\nWe can write\n‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖2,M = sup t∈B2,M (1) η(f, t)\nwhere B2,M (1) = { t ∈ L2(M) | ‖t‖2,M = 1 } ,\nη(f, t) = 〈t, (∆̂h′ −∆h′ + ∆h − ∆̂h)f〉 = 1\nn n∑ i=1 gt,f (Xi)− E[gt,f (X)]\nand\ngt,f (x) = ∫ t(y) [Hh′(y − x)−Hh(y − x)] (f(x)− f(y)) dµ(y).\nSince the function t 7→ η(f, t) is continuous on B2,M (1), we consider t ∈ T where T is a countable set of B2,M (1). In order to apply Lemma 4.1 we need to compute the quantities θ, vg and H .\nLemma 6.5. Let t ∈ T . With the same notation as in Lemma 6.2\n‖gt,f‖∞ ≤ 2 I2(h′)1/2 =: θ\nVar[gt,f (X)] ≤ 4‖p‖∞ I1(h′)2 =: vg E [ sup t∈T η(f, t) ] ≤ 2√ n I2(h′)1/2 =: H.\nProof. Using the Cauchy-Schwarz inequality and the fact that t ∈ B2,M we get\n|gt,f (x)| ≤ ‖t‖2,M (∫ ∣∣∣ (Hh′(y − x)−Hh(y − x)) (f(x)− f(y))∣∣∣2 dµ(y))1/2\n≤ ( 2 ∫ ∣∣∣Hh′(y − x)(f(x)− f(y))∣∣∣2 dµ(y) + 2\n∫ ∣∣∣Hh(y − x)(f(x)− f(y))∣∣∣2 dµ(y))1/2. According to Lemma 6.2 and recalling that h′ ≤ h we get\n|gt,f (x)| ≤ ( 2I2(h′) + 2I2(h) )1/2 ≤ 2 I2(h′)1/2\nwhich proves the first bound. To prove the second inequality we observe that, by the Cauchy-Schwarz inequality,\nVar[gt,f (X)] ≤ E [ gt,f (X) 2 ]\n= E [(∫ t(y) [(Hh′ −Hh)(y −X)] (f(X)− f(y)) dµ(y) )2]\n≤ E [ ∣∣∣∣∫ t(y)2 ((Hh′ −Hh)(y −X)) (f(X)− f(y)) dµ(y)∣∣∣∣× × ∣∣∣∣∫ ((Hh′ −Hh)(y −X)) (f(X)− f(y)) dµ(y)∣∣∣∣ ] .\nAccording to Lemma 6.2∣∣∣∣∫ ((Hh′ −Hh)(y −X)) (f(X)− f(y)) dµ(y)∣∣∣∣ ≤ I1(h′) + I1(h) ≤ 2 I1(h′) so that, recalling that the distribution P has a density p with respect to µ,\nVar[gt,f (X)] ≤ 2 I1(h′) E [ ∣∣∣∣∫ t(y)2 ((Hh′ −Hh)(y −X)) (f(X)− f(y)) dµ(y)∣∣∣∣ ]\n≤ 2 I1(h′) ∫ ∣∣t(y)2 ((Hh′ −Hh)(y −X)) (f(X)− f(y))∣∣ p(x) dµ(x)dµ(y)\n≤ 2‖p‖∞ I1(h′) ∫ t(y)2 (∫ |(Hh′ −Hh)(y −X)(f(X)− f(y))| dµ(x) ) dµ(y).\nUsing again Lemma 6.2 and the fact that t ∈ B2,M we conclude that Var[gt,f (X)] ≤ 4‖p‖∞ I1(h′)2. To get the last inequality we follow the proof of Proposition 2.1. We observe that\nE [ sup t∈T η(f, t)2 ] = E [∥∥∥(∆̂h′ − ∆̂h)f − E [(∆̂h′ − ∆̂h)f]∥∥∥2 2,M ] ≤ 1 n E [∫ |(Hh′ −Hh)(y −X)(f(X)− f(y))|2 dµ(y) ] .\nAccording to Lemma 6.2, E [ sup t∈T η(f, t)2 ] ≤ 2 n (I2(h′) + I2(h)) ≤ 4 n I2(h′) which concludes the proof.\nAccording to Lemma 4.1, with probability at least 1 − max { exp ( − 2nH2\n6vg\n) , exp ( −min{\n2, }nH 24θ\n)} ,\n‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖2,M ≤ (1 + )H where\nH\nθ = 1√ n\nand H2 vg = I2(h′) nI1(h′) = 2 n‖p‖∞h′d\n[ ωd ‖Kd‖22,d + αd(h′)\n(ωd ‖Kd‖1,d + βd(h′))2\n] = 2γd(h ′)\nn .\nMoreover, by definition, H2 ≤ 4V (h′), so that choosing such that a ≥ 4(1 + )2 we get that with probability at least 1−max { exp ( −min{ 2, } √ n\n24\n) , exp ( − 2 3 γd(h ′) )}\n2‖(∆̂h′ −∆h′ + ∆h − ∆̂h)f‖22,M ≤ 4(1 + )2V (h′) ≤ aV (h′).\nIn particular we choose = √ a/2− 1. The result follows taking a union bound on h′."
    }, {
      "heading" : "6.2.2 Proof of Proposition 4.3",
      "text" : "The proof follows the one of Proposition 4.2. We can write\n‖(∆h − ∆̂h)f‖2,M = sup t∈B2,M (1) η̃(f, t)\nwhere\nη̃(f, t) = 1\nn n∑ i=1 ( g̃t,f (Xi)− E[g̃t,f (Xi)] ) and\ng̃t,f (x) = ∫ t(y)Hh(y − x)(f(x)− f(y)) dµ(y).\nMoreover we observe that we can consider t ∈ T where T ⊂ B2,M (1) is a countable set. Lemma 6.6. Let t ∈ T . With the notation of Lemma 6.2\n‖g̃t,f‖∞ ≤ I2(h)1/2 =: θ̃\nVar[g̃t,f (X)] ≤ ‖p‖∞ I1(h)2 =: ṽg E [ sup t∈T η̃(f, t) ] ≤ 1√ n I2(h)1/2 =: H̃.\nProof. We proceed as in the proof of Lemma 6.5. By the Cauchy-Schwarz inequality and Lemma 6.2, recalling that t ∈ B2,M , we get\n|g̃t,f (x)| ≤ ‖t‖2,M (∫ |Hh(y − x)(f(x)− f(y))|2 dµ(y) )1/2 ≤ I2(h)1/2\nwhich proves the first inequality. To get the second one, we observe that Var[g̃t,f (X)] ≤ E [ g̃t,f (X) 2 ]\n≤ E [ ∣∣∣∣∫ t(y)2Hh(y −X)(f(X)− f(y)) dµ(y)∣∣∣∣ × ∣∣∣∣∫ Hh(y −X)(f(X)− f(y)) dµ(y)∣∣∣∣\n] ≤ ‖p‖∞ I1(h)2.\nTo prove the last inequality we observe that E [ sup t∈T η̃(f, t)2 ] = E [∥∥∥∆̂hf − E [∆̂hf]∥∥∥2 2,M ] ≤ 1 n E [∫ |Hh(y −X)(f(X)− f(y))|2 dµ(y) ] ≤ 1 n I2(h).\nAccording to Lemma 4.1, with probability at least 1 − max { exp ( − ̃ 2nH̃2\n6ṽg\n) , exp ( −min{̃\n2,̃}nH̃ 24 θ̃\n)} , we have\n‖(∆h − ∆̂h)f‖2,M ≤ (1 + ̃)H̃\nwhere\nH̃/θ̃ = 1/ √ n and H̃2/ṽg = I2(h) n‖p‖∞I1(h) = 2 n‖p‖∞hd\n[ 2ωd ‖Kd‖22,d + αd(h)\n(2ωd ‖Kd‖1,d + βd(h))2\n] = 2γd(h)\nn .\nMoreover, since H̃2 = V (h), choosing such that a ≥ (1 + ̃)2 we get that with probability at least 1−max { exp ( −min{̃ 2,̃} √ n\n24\n) , exp ( − ̃ 2 3 γd(h) )}\n‖(∆h − ∆̂h)f‖22,M ≤ aV (h).\nIn particular choosing ̃ = √ a− 1 we conclude the proof."
    }, {
      "heading" : "6.3 Proof of Proposition 3.2",
      "text" : "We first prove that, given x ∈M , |p(x)∆Pf(x)−∆h′f(x)| ≤ ΦF (h′) (17) where\nΦF (h ′) = h′ CF [ 5τd ( ‖p‖∞\n3 + ‖p′‖∞ + ‖p′′‖∞\n) + ‖p‖∞D̃3 +\n2\n(4π)d/2 ] + h′2 CF [ 35\n4 ‖p′′‖∞τd +\n( ‖p′‖∞ + D̃4\n‖p‖∞ 2 )] + 1\n2 h′3 CFD̃5\n( ‖p‖∞\n3 + ‖p′‖∞ + ‖p′′‖∞\n) + 1\n4 h′4 CF‖p′′‖∞D̃6\n+ κd CF (‖p′‖∞ + ‖p‖∞/2)\n(4π)d/2 (4(d+ 3))d/2 log(h′−1)d/2h′d+3\n+ κd−1 CF‖p‖∞\n(4π)d/2 (4(d+ 3))(d−1)/2 log(h′−1)(d−1)/2h′d+2\nwith\nτd = 1\n(4π)d/2 ∫ Rd e−‖u‖ 2 d/8 du\nκd+σ = 2 Γ ( (d+ σ + 1)/2 )Fd+σ(√2(d+ σ)), σ ∈ Z, and\nFd+σ(x) =\n∫∞ x td+σ+1e−t 2/4 dt\nxd+σe−x2/4 . (18)\nIntroduce B = { y ∈M | ‖y − x‖m < Lh′ log(h′−1)1/2 } with L > 0 to be chosen and observe that\n∆h′f(x) = 1\nh′d+2(4π)d/2 (∫ B + ∫ Bc e−‖y−x‖ 2 m/4h ′2 (f(y)− f(x)) dP(y) ) =: IBf(x) + IBcf(x).\nWe first recall that the distribution P has a density p with respect to µ.Moreover on B, in the x-normal coordinates, µ has a density √ det(gij) and the Taylor expansion of f is\nf(Ex(v))− f(x) = f(Ex(v))− f(Ex(0)) = 〈f ′(x), v〉+ 1 2 〈f ′′(x)v, v〉+ 1 6 f ′′′(ξ)(v, v, v)\nfor a suitable ξ = ξ(x) ∈M and where f (k) denotes the k-th derivate with respect to v of f ◦ Ex(v). Thus we can write\nIBf(x) = 1\nh′d+2(4π)d/2 ∫ B e−‖y−x‖ 2 m/4h ′2 (f(y)− f(x)) dP(y)\n= 1\nh′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ( 〈f ′(x), v〉+ 1 2 〈f ′′(x)v, v〉 ) p(Ex(v)) √ det(gij)(v) dv\n+ 1\n6h′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 f ′′′(ξ)(v, v, v) p(Ex(v)) √ det(gij)(v) dv.\nUsing now the Taylor expansion of p in x-normal coordinates\np(Ex(v)) = p(x) + 〈p′(x), v〉+ 1\n2 〈p′′(ζ)v, v〉\nfor a suitable ζ = ζ(x) ∈M and where as before p(k) denotes k-th derivate of p ◦ Ex, we have that\n|∆h′f(x)− p(x)∆Pf(x)| ≤ I1f(x) + I2f(x) + I3f(x) + I4f(x) + I5f(x) + I6f(x) + IBcf(x)\nwhere, denoting by\nS(u) = 〈f ′(x), u〉〈p′(x), u〉+ p(x) 2 〈f ′′(x)u, u〉, (19)\nI1f(x) = ∣∣∣∣∣ 1h′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 S(v) √ det(gij)(v) dv − p(x)∆Pf(x) ∣∣∣∣∣ I2f(x) = 1\nh′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 p(x) 〈f ′(x), v〉 √ det(gij)(v) dv ∣∣∣∣∣ I3f(x) = 1\n2h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 〈f ′(x), v〉 〈p′′(ζ)v, v〉 √ det(gij)(v) dv ∣∣∣∣∣ I4f(x) = 1\n2h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 〈f ′′(x)v, v〉〈p′(x), v〉 √ det(gij)(v) dv ∣∣∣∣∣ I5f(x) = 1\n4h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 〈f ′′(x)v, v〉〈p′′(ζ)v, v〉 √ det(gij)(v) dv ∣∣∣∣∣ I6f(x) = 1\n6h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 f ′′′(ξ)(v, v, v) p(Ex(v)) √ det(gij)(v) dv ∣∣∣∣∣ . Let us now bound each term separately. We first observe that by definition\nIBcf(x) ≤ 2CF\nh′d+2−L2/4(4π)d/2 .\nFor the proofs of Lemma 6.7 and Lemma 6.8 we refer to section 6.6.\nLemma 6.7. It holds I1f(x) ≤ CF (‖p′‖∞ + ‖p‖∞/2) [\nκd (4π)d/2 Ld log(h′−1)d/2h′L 2/4 + D̃4 h\n′2 ] .\nLemma 6.8. It holds I2f(x) ≤ CF‖p‖∞ [ κd−1\n(4π)d/2 Ld−1 log(h′−1)(d−1)/2h′L\n2/4−1 + D̃3 h ′ ]\nI3f(x) ≤ CF‖p′′‖∞ h′ (\n5τd + D̃5 2 h′2\n)\nI4f(x) ≤ CF‖p′‖∞ h′ (\n5τd + D̃5 2 h′2\n)\nI5f(x) ≤ CF‖p′′‖∞ h′2 ( 35\n4 τd + D̃6 4 h′2\n)\nI6f(x) ≤ CF‖p‖∞h′ (\n5τd 3 + D̃5 6 h′2\n) .\nWe choose L = 2 √ d+ 3 and we note that Condition 10 is then satisfied. This concludes the proof."
    }, {
      "heading" : "6.4 Proof of Theorem 3.3",
      "text" : "We first prove the following lemma: Lemma 6.9. Assume that the density p of P is in C1(M,R+). For f ∈ F , we have\nE [ ‖(p∆P − ∆̂ĥ)f‖ 2 2,M ] ≤ 2 inf\nh∈H\n{ 9D(h)2 + (1 + √ 2)2bV (h) } + 2 C2F\n∑ h∈H δ(h) [ 1 hd+2min ( wd‖Kd‖22,d + αd(hmax) ) + 9 ( ‖p′‖∞ + ‖p‖∞/2 )2 µ(M)τ2d ] , (20)\nwhere we recall that τd = 1(4π)d/2 ∫ Rd e −‖u‖2d/8 du.\nProof. Let A be the set on which the oracle inequality in Theorem 3.1 holds true. Then E [ ‖(p∆P − ∆̂ĥ)f‖ 2 2,M ] ≤ E [ ‖(p∆P − ∆̂ĥ)f‖ 2 2,M1A ] + 2E [( ‖p∆Pf‖22,M + ‖∆̂ĥf‖ 2 2,M ) 1Ac ] . (21)\nObserve that to bound the first term, it is sufficient to use Theorem 3.1. Thus we only have to consider the second term. According to eq. (2), we can rewrite the weighted Laplace-Beltrami operator in x-normal coordinates as\n∆Pf(x) = 1\n(4π)d/2\n∫ e−‖u‖ 2 d/4 ( 〈p′(x), u〉 p(x) 〈f ′(x), u〉+ 1 2 〈f ′′(x)u, u〉 ) du,\nso that\n‖p∆Pf‖22,M = 1\n(4π)d\n∫ (∫ e−‖u‖ 2 d/4 ( 〈p′(x), u〉 〈f ′(x), u〉+ p(x)\n2 〈f ′′(x)u, u〉\n) du )2 dµ(x)\n≤ C 2 F (‖p′‖∞ + ‖p‖∞/2) 2 µ(M)\n(4π)d\n(∫ e−‖u‖\n2 d/4‖u‖2d du )2 ≤ 9C2F (‖p′‖∞ + ‖p‖∞/2) 2 µ(M)τ2d\nwhere in the last line we have used remark 6.3 with s = 2, q = 2 so that λ ≤ 3. Moreover for any h ∈ H by Lemma 6.2\n‖∆̂hf‖22,M ≤ 1\nn2 ( n∑ i=1 ‖Hh(· −Xi) (f(Xi)− f(·)) ‖2,M )2\n≤ I2(h) ≤ 2C2F hd+2min\n[ wd‖Kd‖22,d + αd(hmax) ] .\nHence E [( ‖p∆Pf‖22,M + ‖∆̂ĥf‖ 2 2,M ) 1Ac ] ≤ C2F [ 1\nhd+2min\n( wd‖Kd‖22,d + αd(hmax) ) + 9 ( ‖p′‖∞ + ‖p‖∞/2 )2 µ(M)τ2d ] ∑ h∈H δ(h).\nWe now prove Theorem 3.3. Note that γd(h′) ≥ Cdh′d with Cd = 1 ‖p‖∞\n[ ωd ‖Kd‖22,d+αd(hmin)\n(ωd ‖Kd‖1,d+βd(hmax))2\n] .\nThus,∑ h∈H δ(h) ≤ ∑ h∈H ∑ h′≤h max { exp ( −min{ 2, } √ n 24 ) , exp ( −Cd c 2 h′d )}\n≤ |H|2 exp ( −min{\n2, } C′d hdmax\n)\nwhere C′d > 0 is a constant and |H| denotes the cardinality of the bandwidth setH. For\nH = { e−k , dlog log(n)e ≤ k ≤ blog(n)c } ,\nwe get that the second term in eq. (20) is negligible with respect to the first one. Finally, observe that combining Proposition 3.2 with the definition of the variance term V (h), the optimal trade-off in Lemma 6.9 is given by h ∼ n− 1 d+4 , which concludes the proof."
    }, {
      "heading" : "6.5 Proof of Lemma 6.2",
      "text" : "In order to prove eq. (15), we consider\nB = Bx(h) = {y ∈M | ‖y − x‖m < Lh log(h−1)1/2} ⊂M\nwhere L > 0 has to be chosen and we observe that\n1\nhd+2(4π)d/2 ∫ B∪Bc e−‖y−x‖ 2 m/4h 2 |f(x)− f(y)|dµ(y).\nWe first look at the integral on B and we consider the x-normal coordinates. Taking into account that the measure µ has a density √ detgij in the x-normal coordinates, we get\n1\nhd+2(4π)d/2 ∫ B e−‖y−x‖ 2 m/4h 2 |f(x)− f(y)|dµ(y)\n= 1\nhd+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 |f(x)− f(Ex(v))| √ detgij(v) dv\n≤ 1 hd+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 |f(x)− f(Ex(v))| (1 + C1‖v‖2d) dv\nwhere in the last line we have used eq. (14). Using the Taylor expansion of f in x-normal coordinates\nf(Ex(v))− f(x) = f(Ex(v))− f(Ex(0)) = 〈f ′(x), v〉+ 1\n2 〈f ′′(ξ)v, v〉 (22)\nwhere ξ = ξ(x) ∈ M and f (k) denotes the k-th derivate with respect to v of f ◦ Ex(v) the above chain of inequalities is bounded by\n1\nhd+2(4π)d/2 [∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 |〈f ′(x), v〉| (1 + C1‖v‖2d) dv\n+ 1\n2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 |〈f ′′(ξ)v, v〉| (1 + C1‖v‖2d) dv ]\n≤ CF hd+2(4π)d/2 [∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖d (1 + C1‖v‖2d) dv\n+ 1\n2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖2d (1 + C1‖v‖2d) dv ]\nwhere in the last line we have used the fact f ∈ F is uniformly bounded up to the third order. We now consider the two terms separately. We write\n1\nhd+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖d (1 + C1‖v‖2d) dv\n= 1\nhd+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h 2 ‖v‖d dv +R1\nwhere, according to remark 6.4,\nR1 = 1\n(4π)d/2hd+2 ∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h 2 − e−‖v‖ 2 d/4h 2 ) ‖v‖d dv\n+ C1\n(4π)d/2hd+2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖3d dv\n≤ 1 (4π)d/2hd+2 ∫ Rd ( C‖v‖5d 4h2 + C1‖v‖3d ) e−‖v‖ 2 d/8h 2 dv = hD̃3\nand by remark 6.3\n1\n(4π)d/2hd+2 ∫ E−1x (B) e−‖v‖ 2 d/4h 2 ‖v‖d dv ≤ 3 2(4π)d/2hd+1 ∫ Rd e−‖v‖ 2 d/8h 2 dv\n= 3× 2d/2\n2(4π)d/2h ∫ Rd e−‖u‖ 2 d/4 dv = 3× 2d/2−1‖Kd‖1,d h .\nSimilarly, the second term can be written as\n1\nhd+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖2d (1 + C1‖v‖2d) dv\n= 1\nhd+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h 2 ‖v‖2d dv +R2\nwhere, according to remark 6.4,\nR2 = 1\n(4π)d/2hd+2 ∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h 2 − e−‖v‖ 2 d/4h 2 ) ‖v‖2d dv\n+ C1\n(4π)d/2hd+2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h 2 ‖v‖4d dv ≤ h2D̃4\nand by remark 6.3 1\n(4π)d/2hd+2 ∫ E−1x (B) e−‖v‖ 2 d/4h 2 ‖v‖2d dv ≤ 3× 2d/2‖Kd‖1,d.\nThis proves that, on B,\n1\nhd+2(4π)d/2 ∫ B e−‖y−x‖ 2 m/4h 2 |f(x)− f(y)|dµ(y)\n≤ CF\n[ ωd‖Kd‖1,d\nh + ωd‖Kd‖1,d + hD̃3 + h2D̃4 2 ] where we recall the definition of ωd = 3× 2d/2−1 in eq. (8). We now consider the integral on Bc. According to the definition of B\n1\nhd+2(4π)d/2 ∫ B e−‖y−x‖ 2 m/4h 2 |f(x)− f(y)|dµ(y) ≤ 2CFµ(M) (4π)d/2hd+2−L2/4 .\nChoosing L = 2 √ d+ 2 so that d+ 2− L2/4 = 0 we prove eq. (15). In a similar way we prove eq. (16). We consider again the ball B defined as above and we write 1\nh2d+4(4π)d ∫ B∪Bc e−‖y−x‖ 2 m/2h 2 |f(x)− f(y)|2 dµ(y).\nProceeding as above, on B we consider the x-normal coordinates and according to eq. (14) we get\n1\nh2d+4(4π)d ∫ B e−‖y−x‖ 2 m/2h 2 |f(x)− f(y)|2 dµ(y)\n≤ 1 h2d+4(4π)d ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 |f(x)− f(Ex(v))|2 (1 + C1‖v‖2d) dv.\nUsing the Taylor expansion of f in eq. (22) we bound the above quantity by\n2\nh2d+4(4π)d [∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 〈f ′(x), v〉2 (1 + C1‖v‖2d) dv\n+ 1\n4 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 〈f ′′(ξ)v, v〉2 (1 + C1‖v‖2d) dv ]\n≤ 2C 2 F\nh2d+4(4π)d [∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖2 (1 + C1‖v‖2d) dv\n+ 1\n4 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖4 (1 + C1‖v‖2d) dv ] where in the last line we have used the fact that f ∈ F . We observe that the first term can be written as\n1\nh2d+4(4π)d ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖2 (1 + C1‖v‖2d) dv\n= 1\nh2d+4(4π)d ∫ E−1x (B) e−‖v‖ 2 d/2h 2 ‖v‖2 dv + R̃1\nwhere, by remark 6.4,\nR̃1 = 1\n(4π)dh2d+4 ∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/2h 2 − e−‖v‖ 2 d/2h 2 ) ‖v‖2d dv\n+ C1\n(4π)dh2d+4 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖4d dv\n≤ 1 (4π)dh2d+4 ∫ E−1x (B) ( C‖v‖6d 2h2 + C1‖v‖4d ) e−‖v‖ 2 d/4h 2 dv ≤ D4 hd\nand according to remark 6.3 with s2 = 2h2 and q = 2 so that λ ≤ 3h 2\n2 ,\n1\n(4π)dh2d+4 ∫ E−1x (B) e−‖v‖ 2 d/2h 2 ‖v‖2d dv ≤ 3 2(4π)dh2d+2 ∫ Rd e−‖v‖ 2 d/4h 2 dv\n= 3× 2d/2\n2(4π)dhd+2 ∫ Rd e−‖u‖ 2 d/2 du = 3× 2d/2−1‖Kd‖22,d hd+2 .\nMoreover the second term writes\n1\nh2d+4(4π)d ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖4 (1 + C1‖v‖2d) dv\n= 1\nh2d+4(4π)d ∫ E−1x (B) e−‖v‖ 2 d/2h 2 ‖v‖4 dv + R̃2\nwhere, using again remark 6.4,\nR̃2 = 1\n(4π)dh2d+4 ∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/2h 2 − e−‖v‖ 2 d/2h 2 ) ‖v‖4d dv\n+ C1\n(4π)dh2d+4 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/2h 2 ‖v‖6d dv\n≤ 1 (4π)dh2d+4 ∫ Rd ( C‖v‖8d 2h2 + C1‖v‖6d ) e−‖v‖ 2 d/4h 2 dv = D6 hd−2\nand by remark 6.3 with λ ≤ 9h4,\n1\n(4π)dh2d+4 ∫ E−1x (B) e−‖v‖ 2 d/2h 2 ‖v‖4d dv ≤ 9× 2d/2‖Kd‖22,d hd .\nThen on B we have\n1\nh2d+4(4π)d ∫ B e−‖y−x‖ 2 m/2h 2 |f(x)− f(y)|2 dµ(y)\n≤ 2C2F [ ωd‖Kd‖22,d hd+2 + D4 + 3ωd‖Kd‖22,d/2 hd + D6 4hd−2 ] while on Bc\n1\nh2d+4(4π)d ∫ Bc e−‖y−x‖ 2 m/2h 2 |f(x)− f(y)|2 dµ(y) ≤ 4C 2 Fµ(M) (4π)dh2d+4−L2/2 .\nThus choosing L = √ 2(d+ 4) so that 2d+ 4− L2/2 = d we conclude the proof."
    }, {
      "heading" : "6.6 Proofs of the technical lemmas in section 6.3",
      "text" : ""
    }, {
      "heading" : "6.6.1 Proof of Lemma 6.7",
      "text" : "According to eq. (14),\nI1f(x) ≤ ∣∣∣∣∣ 1h′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 S(v) dv − p(x)∆Pf(x) ∣∣∣∣∣ +\nC1 h′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 S(v)‖v‖2d dv\n≤ ∣∣∣∣∣ 1h′d+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 S(v) dv − p(x)∆Pf(x) ∣∣∣∣∣+R1 where\nR1 ≤ 1\nh′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h ′2 − e−‖v‖ 2 d/4h ′2 ) S(v) dv ∣∣∣∣∣ +\nC1 h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ‖v‖2d S(v) dv ∣∣∣∣∣ . Since |S(t)| ≤ CF (‖p′‖∞ + ‖p‖∞/2) ‖t‖2d by remark 6.3\nR1 ≤ CF (‖p′‖∞ + ‖p‖∞/2)\nh′d+2(4π)d/2\n∫ E−1x (B) e−‖v‖ 2 d/8h ′2 ‖v‖2d ( C‖v‖4d 4h′2 + C1‖v‖2d ) dv\n≤ CF (‖p′‖∞ + ‖p‖∞/2) D̃4 h′2.\nMoreover according to eq. (2) we can rewrite the weighted Laplace-Beltrami operator in x-normal coordinates as\n∆Pf(x) = 1\n(4π)d/2\n∫ e−‖u‖ 2 d/4 ( 〈p′(x), u〉 p(x) 〈f ′(x), u〉+ 1 2 〈f ′′(x)u, u〉 ) du,\nso that\np(x)∆Pf(x) = 1\n(4π)d/2\n∫ e−‖u‖ 2 d/4S(u) du.\nHence, denoting\nB̃ := { v ∈ Rd | ‖v‖d < Lh′ log(h′−1)1/2 } ⊂ E−1x (B).\nwe get ∣∣∣∣ 1h′d+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 S(v) dv − p(x)∆Pf(x) ∣∣∣∣ = 1\nh′d+2(4π)d/2 ∣∣∣∣∣ ∫ (E−1x (B)) c e−‖v‖ 2 d/4h ′2 S(v) dv ∣∣∣∣∣ ≤ CF (‖p\n′‖∞ + ‖p‖∞/2) h′d+2(4π)d/2 ∫ B̃c e−‖v‖ 2 d/4h ′2 ‖v‖2d dv\n≤ CF (‖p ′‖∞ + ‖p‖∞/2) (4π)d/2 ∫ {‖u‖d>L log(h′−1)1/2} e−‖u‖ 2 d/4‖u‖2d du ≤ κd CF (‖p ′‖∞ + ‖p‖∞/2)\n(4π)d/2 Ld log(h′−1)d/2h′L 2/4\nwhich concludes the proof."
    }, {
      "heading" : "6.6.2 Proof of Lemma 6.8",
      "text" : "By eq. (14)\nI2f(x) ≤ ‖p‖∞\nh′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 〈f ′(x), v〉 ( 1 + C1‖v‖2d ) dv ∣∣∣∣∣ ≤ ‖p‖∞ h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 〈f ′(x), v〉dv\n∣∣∣∣∣+R2 where\nR2 = ‖p‖∞\nh′d+2(4π)d/2 [∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h ′2 − e−‖v‖ 2 d/4h ′2 ) 〈f ′(x), v〉dv\n+ C1 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ‖v‖2d 〈f ′(x), v〉dv ]\nObserve that, by remark 6.3 and eq. (14),\nR2 ≤ CF‖p‖∞\nh′d+2(4π)d/2 [∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h ′2 − e−‖v‖ 2 d/4h ′2 ) ‖v‖d dv\n+ C1 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ‖v‖3d dv ]\n≤ CF‖p‖∞ h′d+2(4π)d/2 ∫ E−1x (B) ‖v‖d e−‖v‖ 2 d/8h ′2 ( C‖v‖4d 4h′2 + C1‖v‖2d ) dv\n≤ CF‖p‖∞D̃3 h′\nwhere in the last line we have used the definition of D̃α introduced in eq. (7). Moreover, observe that∫ Rd e−‖v‖ 2 d/4h ′2 〈f ′(x), v〉dv = 0\nand define\nB̃ := { v ∈ Rd | ‖v‖d < Lh′ log(h′−1)1/2 } ⊂ E−1x (B).\nThen we get\n‖p‖∞ h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 〈f ′(x), v〉dv ∣∣∣∣∣ =\n‖p‖∞ h′d+2(4π)d/2 ∣∣∣∣∣ ∫ E−1x (B)c e−‖v‖ 2 d/4h ′2 〈f ′(x), v〉dv ∣∣∣∣∣ ≤ ‖p‖∞ h′d+2(4π)d/2 ∣∣∣∣∫ B̃c e−‖v‖ 2 d/4h ′2 〈f ′(x), v〉dv\n∣∣∣∣ ≤ CF‖p‖∞ h′d+2(4π)d/2 ∫ B̃c e−‖v‖ 2 d/4h ′2 ‖v‖d dv\n≤ CF‖p‖∞ h′(4π)d/2 ∫ {‖u‖d>L log(h′−1)1/2} e−‖u‖ 2 d/4‖u‖d dv\n≤ κd−1 CF‖p‖∞ (4π)d/2 Ld−1 log(h′−1)(d−1)/2h′L 2/4−1.\nSimilarly we can bound I3f(x). By eq. (14) we have\nI3f(x) ≤ CF‖p′′‖∞\n2h′d+2(4π)d/2 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ‖v‖3d ( 1 + C1‖v‖2d ) dv\n= CF‖p′′‖∞\n2h′d+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 ‖v‖3d dv +R3\nwhere, according to remark 6.3,\nR3 = CF‖p′′‖∞\n2h′d+2(4π)d/2 [∫ E−1x (B) ( e−‖Ex(v)−x‖ 2 m/4h ′2 − e−‖v‖ 2 d/4h ′2 ) ‖v‖3d dv\n+ C1 ∫ E−1x (B) e−‖Ex(v)−x‖ 2 m/4h ′2 ‖v‖5d dv ]\n≤ 1 2 CF‖p′′‖∞D̃5 h′3\nand by remark 6.3 with s = 2h′ and q = 3 so that λ ≤ 10h′3\nCF‖p′′‖∞ 2h′d+2(4π)d/2 ∫ E−1x (B) e−‖v‖ 2 d/4h ′2 ‖v‖3d dv ≤ 5CF‖p′′‖∞τd h′.\nThe bounds for I4f(x), I5f(x), I6f(x) are obtained in the same way."
    } ],
    "references" : [ {
      "title" : "A survey of cross-validation procedures for model selection",
      "author" : [ "Sylvain Arlot", "Alain Celisse" ],
      "venue" : "Statistics surveys,",
      "citeRegEx" : "Arlot and Celisse,? \\Q2010\\E",
      "shortCiteRegEx" : "Arlot and Celisse",
      "year" : 2010
    }, {
      "title" : "Data-driven calibration of penalties for least-squares regression",
      "author" : [ "Sylvain Arlot", "Pascal Massart" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "Arlot and Massart.,? \\Q2009\\E",
      "shortCiteRegEx" : "Arlot and Massart.",
      "year" : 2009
    }, {
      "title" : "Minimal penalties for gaussian model selection",
      "author" : [ "Lucien Birgé", "Pascal Massart" ],
      "venue" : "Probability theory and related fields,",
      "citeRegEx" : "Birgé and Massart.,? \\Q2007\\E",
      "shortCiteRegEx" : "Birgé and Massart.",
      "year" : 2007
    }, {
      "title" : "Slope heuristics: overview and implementation",
      "author" : [ "Jean-Patrick Baudry", "Cathy Maugis", "Bertrand Michel" ],
      "venue" : "Statistics and Computing,",
      "citeRegEx" : "Baudry et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Baudry et al\\.",
      "year" : 2012
    }, {
      "title" : "Laplacian eigenmaps for dimensionality reduction and data representation",
      "author" : [ "Mikhail Belkin", "Partha Niyogi" ],
      "venue" : "Neural computation,",
      "citeRegEx" : "Belkin and Niyogi.,? \\Q2003\\E",
      "shortCiteRegEx" : "Belkin and Niyogi.",
      "year" : 2003
    }, {
      "title" : "Semi-supervised learning on riemannian manifolds",
      "author" : [ "Mikhail Belkin", "Partha Niyogi" ],
      "venue" : "Machine learning,",
      "citeRegEx" : "Belkin and Niyogi.,? \\Q2004\\E",
      "shortCiteRegEx" : "Belkin and Niyogi.",
      "year" : 2004
    }, {
      "title" : "Towards a theoretical foundation for laplacian-based manifold methods",
      "author" : [ "Mikhail Belkin", "Partha Niyogi" ],
      "venue" : "In Learning theory,",
      "citeRegEx" : "Belkin and Niyogi.,? \\Q2005\\E",
      "shortCiteRegEx" : "Belkin and Niyogi.",
      "year" : 2005
    }, {
      "title" : "Convergence of laplacian eigenmaps",
      "author" : [ "Mikhail Belkin", "Partha Niyogi" ],
      "venue" : "Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Belkin and Niyogi.,? \\Q2007\\E",
      "shortCiteRegEx" : "Belkin and Niyogi.",
      "year" : 2007
    }, {
      "title" : "Towards a theoretical foundation for laplacian-based manifold methods",
      "author" : [ "Mikhail Belkin", "Partha Niyogi" ],
      "venue" : "Journal of Computer and System Sciences,",
      "citeRegEx" : "Belkin and Niyogi.,? \\Q2008\\E",
      "shortCiteRegEx" : "Belkin and Niyogi.",
      "year" : 2008
    }, {
      "title" : "Empirical graph laplacian approximation of laplace–beltrami operators: Large sample results",
      "author" : [ "E. Giné", "V. Koltchinskii" ],
      "venue" : "In High dimensional probability,",
      "citeRegEx" : "Giné and Koltchinskii.,? \\Q2006\\E",
      "shortCiteRegEx" : "Giné and Koltchinskii.",
      "year" : 2006
    }, {
      "title" : "Universal pointwise selection rule in multivariate function estimation",
      "author" : [ "Alexander Goldenshluger", "Oleg Lepski" ],
      "venue" : null,
      "citeRegEx" : "Goldenshluger and Lepski,? \\Q2008\\E",
      "shortCiteRegEx" : "Goldenshluger and Lepski",
      "year" : 2008
    }, {
      "title" : "Structural adaptation via lp-norm oracle inequalities",
      "author" : [ "A. Goldenshluger", "O. Lepski" ],
      "venue" : "Probability Theory and Related Fields,",
      "citeRegEx" : "Goldenshluger and Lepski.,? \\Q2009\\E",
      "shortCiteRegEx" : "Goldenshluger and Lepski.",
      "year" : 2009
    }, {
      "title" : "Heat kernel and analysis on manifolds, volume 47",
      "author" : [ "Alexander Grigoryan" ],
      "venue" : "American Mathematical Soc.,",
      "citeRegEx" : "Grigoryan.,? \\Q2009\\E",
      "shortCiteRegEx" : "Grigoryan.",
      "year" : 2009
    }, {
      "title" : "Graph laplacians and their convergence on random neighborhood graphs",
      "author" : [ "M. Hein", "JY Audibert", "U.von Luxburg" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Hein et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Hein et al\\.",
      "year" : 2007
    }, {
      "title" : "On problems of adaptive estimation in white gaussian noise",
      "author" : [ "Oleg V Lepski" ],
      "venue" : "Topics in nonparametric estimation,",
      "citeRegEx" : "Lepski.,? \\Q1992\\E",
      "shortCiteRegEx" : "Lepski.",
      "year" : 1992
    }, {
      "title" : "Asymptotically minimax adaptive estimation",
      "author" : [ "OV Lepskii" ],
      "venue" : "i: Upper bounds. optimally adaptive estimates. Theory of Probability & Its Applications,",
      "citeRegEx" : "Lepskii.,? \\Q1992\\E",
      "shortCiteRegEx" : "Lepskii.",
      "year" : 1992
    }, {
      "title" : "Asymptotically minimax adaptive estimation. ii. schemes without optimal adaptation: Adaptive estimators",
      "author" : [ "OV Lepskii" ],
      "venue" : "Theory of Probability & Its Applications,",
      "citeRegEx" : "Lepskii.,? \\Q1993\\E",
      "shortCiteRegEx" : "Lepskii.",
      "year" : 1993
    }, {
      "title" : "Minimal penalty for goldenshluger-lepski method",
      "author" : [ "Claire Lacour", "Pascal Massart" ],
      "venue" : "arXiv preprint arXiv:1503.00946,",
      "citeRegEx" : "Lacour and Massart.,? \\Q2015\\E",
      "shortCiteRegEx" : "Lacour and Massart.",
      "year" : 2015
    }, {
      "title" : "Estimator selection: a new method with applications to kernel density estimation",
      "author" : [ "Claire Lacour", "Pascal Massart", "Vincent Rivoirard" ],
      "venue" : "arXiv preprint arXiv:1607.05091,",
      "citeRegEx" : "Lacour et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Lacour et al\\.",
      "year" : 2016
    }, {
      "title" : "Optimal spatial adaptation to inhomogeneous smoothness: an approach based on kernel estimates with variable bandwidth selectors",
      "author" : [ "Oleg V Lepski", "Enno Mammen", "Vladimir G Spokoiny" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Lepski et al\\.,? \\Q1997\\E",
      "shortCiteRegEx" : "Lepski et al\\.",
      "year" : 1997
    }, {
      "title" : "Diffusion maps, spectral clustering and reaction coordinates of dynamical systems",
      "author" : [ "B. Nadler", "S. Lafon", "RR Coifman", "IG Kevrekidis" ],
      "venue" : "Applied and Computational Harmonic Analysis,",
      "citeRegEx" : "Nadler et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Nadler et al\\.",
      "year" : 2006
    }, {
      "title" : "A topological approach to spectral clustering",
      "author" : [ "Antonio Rieser" ],
      "venue" : null,
      "citeRegEx" : "Rieser.,? \\Q2015\\E",
      "shortCiteRegEx" : "Rieser.",
      "year" : 2015
    }, {
      "title" : "The Laplacian on a Riemannian manifold: an introduction to analysis on manifolds. Number 31",
      "author" : [ "Steven Rosenberg" ],
      "venue" : null,
      "citeRegEx" : "Rosenberg.,? \\Q1997\\E",
      "shortCiteRegEx" : "Rosenberg.",
      "year" : 1997
    }, {
      "title" : "An analysis of the convergence of graph laplacians",
      "author" : [ "Daniel Ting", "Ling Huang", "Michael Jordan" ],
      "venue" : "arXiv preprint arXiv:1101.5435,",
      "citeRegEx" : "Ting et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Ting et al\\.",
      "year" : 2011
    }, {
      "title" : "Consistency of spectral clustering",
      "author" : [ "Ulrike Von Luxburg", "Mikhail Belkin", "Olivier Bousquet" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Luxburg et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Luxburg et al\\.",
      "year" : 2008
    } ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "Approximations of Laplace-Beltrami operators on manifolds through graph Laplacians have become popular tools in data analysis and machine learning. These discretized operators usually depend on bandwidth parameters whose tuning remains a theoretical and practical problem. In this paper, we address this problem for the unnormalized graph Laplacian by establishing an oracle inequality that opens the door to a well-founded data-driven procedure for the bandwidth selection. Our approach relies on recent results by Lacour and Massart [LM15] on the so-called Lepski’s method.",
    "creator" : "LaTeX with hyperref package"
  }
}