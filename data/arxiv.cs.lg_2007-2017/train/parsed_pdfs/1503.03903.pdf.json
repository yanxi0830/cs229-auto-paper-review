{
  "name" : "1503.03903.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Approximating Sparse PCA from Incomplete Data",
    "authors" : [ "Abhisek Kundu", "Petros Drineas", "Malik Magdon-Ismail" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 3.\n03 90\n3v 1\n[ cs\n.L G\n] 1\n2 M\nar 2"
    }, {
      "heading" : "1 Introduction",
      "text" : "Principal components analysis constructs a low dimensional subspace of the data such that projection of the data onto this subspace preserves as much information as possible (or equivalently maximizes the variance of the projected data). The earliest reference to principal components analysis (PCA) is in Pearson [1901]. Since then, PCA has evolved into a classic tool for data analysis. A challenge for the interpretation of the principal components (or factors) is that they can be linear combinations of all the original variables. When the original variables have direct physical significance (e.g. genes in biological applications or assets in financial applications) it is desirable to have factors which have loadings on only a small number of the original variables. These interpretable factors are sparse principal components (SPCA).\nThe question we address is not how to better perform sparse PCA; rather, it is whether one can perform sparse PCA on incomplete data and be assured some degree of success. (Read: can one do sparse PCA when you have a small sample of data points and those data points have missing features?). Incomplete data is a situation that one is confronted with all too often in machine learning. For example, with userrecommendation data, one does not have all the ratings of any given user. Or in a privacy preserving setting, a client may not want to give you all entries in the data matrix. In such a setting, our goal is to show that if the samples that you do get are chosen carefully, the sparse PCA features of the data can be recovered within some provable error bounds. A significant part of this work is to demonstrate our algorithms on a variety of data sets.\nMore formally, The data matrix is A ∈ Rm×n (m data points in n dimensions). Data matrices often have low effective rank. Let Ak be the best rank-k approximation to A; in practice, it is often possible to choose a small value of k for which ‖A−Ak‖2 is small. The best rank-k approximation Ak is obtained by projecting A onto the subspace spanned by its top-k principal components Vk, which is the n× k matrix\n∗Department of Computer Science, Rensselaer Polytechnic Institute, Troy, NY, kundua2@rpi.edu. †Department of Computer Science, Rensselaer Polytechnic Institute, Troy, NY, drinep@cs.rpi.edu. ‡Department of Computer Science, Rensselaer Polytechnic Institute, Troy, NY, magdon@cs.rpi.edu.\ncontaining the top-k right singular vectors of A. These top-k principal components are the solution to the variance maximization problem:\nVk = argmax V∈Rn×k,VTV=I\ntrace(VTATAV).\nWe denote the maximum variance attainable by OPTk, which is the sum of squares of the top-k singular values of A. To get sparse principal components, you add a sparsity constraint to the optimization problem: every column of V should have at most r non-zero entries (the sparsity parameter r is an input),\nSk = argmax V∈Rn×k ,VTV=I,‖V(i)‖0≤r\ntrace(VTATAV). (1)\nThe sparse PCA problem is itself a very hard problem that is not only NP-hard, but also inapproximable [Magdon-Ismail, 2015] There are many heuristics for obtaining sparse factors [Cadima and Jolliffe, 1995, Trendafilov et al., 2003, Zou et al., 2006, d’Aspremont et al., 2007, 2008, Moghaddam et al., 2006, Shen and Huang, 2008] including some approximation algorithms with provable guarantees Asteris et al. [2014]. The existing research typically addresses the task of getting just the top principal component (k = 1). While the sparse PCA problem is hard and interesting, it is not the focus of this work.\nWe address the question: What if you do not know A, but only have a sparse sampling of some of the entries in A (incomplete data)? The sparse sampling is used to construct a sketch of A, denoted Ã. There is not much else to do but solve the sparse PCA problem with the sketch Ã instead of the full data A to get S̃k,\nS̃k = argmax V∈Rn×k ,VTV=I,‖V(i)‖0≤r\ntrace(VT Ã T ÃV). (2)\nWe study how S̃k performs as an approximation to Sk with respective to the objective that we are trying to optimize, namely trace(STATAS) — the quality of approximation is measured with respect to the true A. We show that the quality of approximation is controlled by how well Ã T Ã approximates ATA as measured by the spectral norm of the deviation ATA − ÃT Ã. This is a general result that does not rely on how one constructs the sketch Ã.\nTheorem 1 (Sparse PCA from a Sketch) Let Sk be a solution to the sparse PCA problem that solves (1), and S̃k a solution to the sparse PCA problem for the sketch Ã which solves (2). Then,\ntrace(S̃ T\nkA TAS̃k) ≥ trace(STkATASk)− 2k‖ATA− Ã T Ã‖2.\nTheorem 1 says that if we can closely approximate A with Ã, then we can compute, from Ã, sparse components which capture almost as much variance as the optimal sparse components computed from the full data A.\nIn our setting, the sketch Ã is computed from a sparse sampling of the data elements in A (incomplete data). To determine which elements to sample, and how to form the sketch, we leverage some recent results in elementwise matrix completion (Kundu et al. [2015]). In a nutshell, if one samples larger data elements with higher probability than smaller data elements, then, for the resulting sketch Ã, the error ‖ATA − ÃT Ã‖2 will be small. The details of the sampling scheme and how the error depends on the number of samples is given in Section 2.1. Combining the bound on ‖A − Ã‖2 from Theorem 4 in Section 2.1 with Theorem 1, we get our main result:\nTheorem 2 (Sampling Complexity for Sparse PCA) Sample s data-elements from A ∈ Rm×n to form the sparse sketch Ã using Algorithm 1. Let Sk be a solution to the sparse PCA problem that solves (1),\nand let S̃k, which solves (2), be a solution to the sparse PCA problem for the sketch Ã formed from the s sampled data elements. Suppose the number of samples s satisfies\ns ≥ 2k 2\nǫ2\n( ρ2 + ǫγ\n3k\n)\nlog\n(\nm+ n\nδ\n)\n(ρ2 and γ are dimensionless quantities that depend only on A). Then, with probability at least 1− δ\ntrace(S̃ T kA TAS̃k) ≥ trace(STkATASk)− ǫ(2 + ǫ/k)‖A‖22.\nThe dependence of ρ2 and γ on A are given in Section 2.1. Roughly speaking, we can ignore the term with γ since it is multiplied by ǫ/k, and ρ2 = O(k̃max{m,n}), where k̃ is the stable (numerical) rank of A. To paraphrase Theorem 2, when the stable rank is a small constant, with O(k2 max{m,n}) samples, one can recover almost as good sparse principal components as with all data (the price being a small fraction of the optimal variance, since OPTk ≥ ‖A‖22). As far as we know, this is the first result to show that it is possible to provably recover sparse PCA from incomplete data. We also give an application of Theorem 1 to running sparse PCA after “denoising” the data using a greedy thresholding algorithm that sets the small elements to zero (see Theorem 3). Such denoising is appropriate when the observed matrix has been element-wise perturbed by small noise, and the uncontaminated data matrix is sparse and contains large elements. We show that if an appropriate fraction of the (noisy) data is set to zero, one can still recover sparse principal components. This gives a principled approach to regularizing sparse PCA in the presence of small noise when the data is sparse.\nNot only do our algorithms preserve the quality of the sparse principal components, but iterative algorithms for sparse PCA, whose running time is proportional to the number of non-zero entries in the input matrix, benefit from the sparsity of Ã. Our experiments show about five-fold speed gains while producing near-comparable sparse components using less than 10% of the data.\nDiscussion. In summary, we show that one can recover sparse PCA from incomplete data while gaining computationally at the same time. Our result holds for the optimal sparse components from A versus from Ã. One cannot efficiently find these optimal components (since the problem is NP-hard to even approximate), so one runs a heuristic, in which case the approximation error of the heuristic would have to be taken into account. Our experiments show that using the incomplete data with the heuristics is just as good as those same heuristics with the complete data.\nIn practice, one may not be able to sample the data, but rather the samples are given to you. Our result establishes that if the samples are chosen with larger values being more likely, then one can recover sparse PCA. In practice one has no choice but to run the sparse PCA on these sampled elements and hope. Our theoretical results suggest that the outcome will be reasonable. This is because, while we do not have specific control over what samples we get, the samples are likely to represent the larger elements. For example, with user-product recommendation data, users are more likely to rate items they either really like (large positive value) or really dislike (large negative value).\nNotation. We use bold uppercase (e.g., X) for matrices and bold lowercase (e.g., x) for column vectors. The i-th row of X is X(i), and the i-th column of X is X\n(i). Let [n] denote the set {1, 2, ..., n}. E(X) is the expectation of a random variable X; for a matrix, E(X) denotes the element-wise expectation. For a matrix X ∈ Rm×n, the Frobenius norm ‖X‖F is ‖X‖ 2 F = ∑m,n i,j=1X 2 ij , and the spectral (operator) norm ‖X‖2 is ‖X‖2 = max‖y‖2=1 ‖Xy‖2. We also have the ℓ1 and ℓ0 norms: ‖X‖ℓ1 = ∑m,n\ni,j=1 |Xij| and ‖X‖0 (the number of non-zero entries in X). The k-th largest singular value of X is σk(X). and log x is the natural logarithm of x."
    }, {
      "heading" : "2 Sparse PCA from a Sketch",
      "text" : "In this section, we will prove Theorem 1 and give a simple application to zeroing small fluctuations as a way to regularize to noise. In the next section we will use a more sophisticated way to select the elements of the matrix allowing us to tolerate a sparser matrix (more incomplete data) but still recovering sparse PCA to reasonable accuracy.\nTheorem 1 will be a corollary of a more general result, for a class of optimization problems involving a Lipschitz objective function over an arbitrary (not necessarily convex) domain. Let f(V,X) be a function that is defined for a matrix variable V and a matrix parameter X. The optimization variable V is in some feasible set S which is arbitrary. The parameter X is also arbitrary. We assume that f is Lipschitz in X with Lipschitz constant γ. So,\n|f(V,X)− f(V, X̃)| ≤ γ(X)‖X− X̃‖2 ∀V ∈ S.\n(Note we allow the Lipschitz constant to depend on X but not V.) The next lemma is the key tool we need to prove Theorem 1 and it may be on independent interest in other optimization settings. We are interested in maximizing f(V,X) w.r.t. V to obtain V∗. But, we only have an approximation X̃ for X, and so we maximize f(V, X̃) to obtain Ṽ ∗ , which will be a suboptimal solution with respect to X. We wish to bound f(V∗,X)− f(Ṽ∗,X) which quantifies how suboptimal Ṽ∗ is w.r.t. X.\nLemma 1 (Surrogate optimization bound) Let f(V,X) be γ-Lipschitz w.r.t. X over the domain V ∈ S . Define\nV∗ = argmax V∈S\nf(V,X); Ṽ ∗ = argmax\nV∈S f(V, X̃).\nThen, f(V∗,X)− f(Ṽ∗,X) ≤ 2γ(X)‖X− X̃‖2.\nIn the lemma, the function f and the domain S are arbitrary. In our setting, X ∈ Rn×n, the domain S = {V ∈ Rn×k;VTV = Ik; ‖V(j)‖0 ≤ r}, and f(V,X) = trace(VTXV). We first show that f is Lipschitz w.r.t. X with γ = k (a constant independent of X). Let the representation of V by its columns be V = [v1, . . . ,vk]. Then,\n|trace(VTXV)− trace(VT X̃V)| = |trace((X− X̃)VVT )| ≤ k ∑\ni=1\nσi(X− X̃) ≤ k‖X− X̃‖2\nwhere, σi(A) is the i-th largest singular value of A (we used Von-neumann’s trace inequality and the fact that VVT is a k-dimensional projection). Now, by Lemma 1,\ntrace(V∗TXV∗)− trace(Ṽ∗TXṼ∗) ≤ 2k‖X− X̃‖2.\nTheorem 1 follows by setting X = ATA and X̃ = Ã T Ã.\nGreedy thresholding. We give the simplest scenario of incomplete data where Theorem 1 gives some reassurance that one can compute good sparse principal components. Suppose the smallest data elements have been set to zero. This can happen, for example, if only the largest elements are measured, or in a noisy setting if the small elements are treated as noise and set to zero. So\nÃij =\n{\nAij |Aij | ≥ δ; 0 |Aij | < δ.\nRecall k̃ = ‖A‖2F /‖A‖22 (stable rank of A), and define ‖Aδ‖2F = ∑ |Aij |<δ A2ij . Let A = Ã + ∆. By construction, ‖∆‖2F = ‖Aδ‖2F . Then,\n‖ATA− ÃT Ã‖2 = ‖AT∆+∆TA−∆T∆‖2 ≤ 2‖A‖2‖∆‖2 + ‖∆‖22. (3)\nSuppose the zeroing of elements only loses a fraction of the energy in A, i.e. δ is selected so that ‖Aδ‖2F ≤ ǫ2‖A‖2F /k̃; that is an ǫ/k̃ fraction of the total variance in A has been lost in the unmeasured (or zero) data. Then\n‖∆‖2 ≤ ‖∆‖F ≤ ǫ √\nk̃ ‖A‖F = ǫ‖A‖2.\nTheorem 3 Suppose that Ã is created from A by zeroing all elements that are less than δ, and δ is such that the truncated norm satisfies ‖Aδ‖22 ≤ ǫ2‖A‖2F /k̃. Then the sparse PCA solution Ṽ ∗ satisfies\ntrace(Ṽ ∗T AAṼ ∗ ) ≥ trace(V∗TAATV∗)− 2kǫ‖A‖22(2 + ǫ).\nTheorem 3 shows that it is possible to recover sparse PCA after setting small elements to zero. This is appropriate when most of the elements in A are small noise and a few of the elements in A contain large data elements. For example if your data consists of sparse O( √ nm) large elements (of magnitude, say, 1) and many nm−O(√nm) small elements whose magnitude is o(1/√nm) (high signal-to-noise setting), then ‖Aδ‖22/‖A‖22 → 0 and with just a sparse sampling of the O( √ nm) large elements (very incomplete data), one recovers near optimal sparse PCA. Greedily keeping only the large elements of the matrix requires a particular structure in A to work, and it is based on a crude Frobenius-norm bound for the spectral error. In Section 2.1, we use recent results in element-wise matrix sparsification to choose the elements in a randomized way, with a bias toward large elements. With high probability, one can directly bound the spectral error and hence get better performance. But first, let us prove Lemma 1\nA Proof of Lemma 1. We need the following lemma.\nLemma 2 Let f and g be functions on a domain S . Then,\nsup x∈S f(x)− sup y∈S g(y) ≤ sup x∈S (f(x)− g(x)).\nProof: sup x∈S (f(x)− g(x)) ≥ f(x)− g(x) ≥ f(x)− sup y∈S g(y), ∀x ∈ S.\nSince the RHS holds for all x, it follows that supx∈S(f(x) − g(x)) is an upper bound for f(x) − supy∈S g(U), and hence\nsup x∈S (f(x)− g(x)) ≥ sup x∈S\n(\nf(x)− sup y∈S g(y)\n)\n= sup x∈S f(x)− sup y∈S g(y).\n⋄\nAlgorithm 1 Hybrid (ℓ1, ℓ2)-Element Sampling Input: A ∈ Rm×n; # samples s; probabilities {pij}. 1: Set Ã = 0m×n. 2: for t = 1 . . . s (i.i.d. trials with replacement) do 3: Randomly sample indices (it, jt) ∈ [m]× [n] with P [(it, jt) = (i, j)] = pij. 4: Update Ã: Ãij ← Ãij + Aij\ns · pij .\n5: return Ã (with at most s non-zero entries).\nProof:(Lemma 1) Suppose that maxV∈S f(V,X) is attained at V∗ and maxV∈S f(V, X̃) is attained at Ṽ ∗ , and define ǫ = f(V∗,X)− f(Ṽ∗,X). We have that\nǫ = f(V∗,X)− f(Ṽ∗, X̃) + f(Ṽ∗, X̃)− f(Ṽ∗,X) = max\nV f(V,X)−max U f(U, X̃) + f(Ṽ\n∗ , X̃)− f(Ṽ∗,X)\n≤ max V\n( f(V,X)− f(V, X̃) ) + f(Ṽ ∗ , X̃)− f(Ṽ∗,X),\nwhere the last step follows from Lemma 2. Therefore,\n|ǫ| ≤ max V\n∣ ∣ ∣ f(V,X)− f(V, X̃) ∣ ∣ ∣ + |f(Ṽ∗, X̃)− f(Ṽ∗,X)|\n≤ max V γ(X)‖X− X̃‖2 + γ(X)‖X − X̃‖2 = 2γ(X)‖X− X̃‖2.\n(We used the Lipschitz condition in the second step.) ⋄"
    }, {
      "heading" : "2.1 An (ℓ1, ℓ2)-Sampling Based Sketch",
      "text" : "In the previous section, we created the sketch by deterministically setting the small data elements to zero. Instead, we could randomly select the data elements to keep. It is natural to bias this random sampling toward the larger elements. Therefore, we define sampling probabilities for each data element Aij which are proportional to a mixture of the absolute value and square of the data element:\npij = α |Aij | ‖A‖ℓ1 + (1− α) A2ij ‖A‖2F , (4)\nwhere α ∈ (0, 1] is a mixing parameter. Such a sampling probability was used in Kundu et al. [2015] to sample data elements in independent trials to get a sketch Ã. We repeat the prototypical algorithm for element-wise matrix sampling in Algorithm 1. Note that unlike with the deterministic zeroing of small elements, in this sampling scheme, one samples the element Aij with probability pij and then rescales it by 1/pij . To see the intuition for this rescaling, consider the expected outcome for a single sample:\nE[Ãij] = pij · (Aij/pij) + (1− pij) · 0 = Aij;\nthat is, Ã is a sparse but unbiased estimate for A. This unbiasedness holds for any choice of the sampling probabilities pij defined over the elements of A in Algorithm 1. However, for an appropriate choice of the sampling probabilities, we get much more than unbiasedness; we can control the spectral norm of the\ndeviation, ‖A − Ã‖2. In particular, the hybrid-(ℓ1, ℓ2) distribution in (4) was analyzed in Kundu et al. [2015], where they suggest an optimal choice for the mixing parameter α∗ which minimizes the theoretical bound on ‖A− Ã‖2. This algorithm to choose α∗ is summarized in Algorithm 2.\nUsing the probabilities in (4) to create the sketch Ã using Algorithm 1, with α∗ selected using Algorithm 2, one can prove a bound for ‖A−Ã‖2. We state a simplified version of the bound from Kundu et al. [2015] in Theorem 4.\nTheorem 4 (Kundu et al. [2015]) Let A ∈ Rm×n and let ǫ > 0 be an accuracy parameter. Define probabilities pij as in (4) with α∗ chosen using Algorithm 2. Let Ã be the sparse sketch produced using Algorithm 1 with a number of samples\ns ≥ 2 ǫ2 ( ρ2 + γǫ/3 ) log\n(\nm+ n\nδ\n)\n,\nwhere\nρ2 = k̃ ·max{m,n}\nα · k̃ · ‖A‖2‖A‖ℓ1 + (1− α)\n, and γ ≤ 1 + √ mnk̃\nα .\nThen, with probability at least 1− δ, ‖A− Ã‖2 ≤ ǫ ‖A‖2 .\nProof: Follows from the bound in Kundu et al. [2015]. ⋄ Recall that k̃ is the stable rank of A. In practice, α∗ is bounded away from 0 and 1, and so s = O(ǫ−2k̃max{m,n}) samples suffices to get a sketch Ã for which ‖A − Ã‖2 ≤ ǫ‖A‖. This is exactly what we need to prove Theorem 2.\nProof of Theorem 2. The number of samples s in Theorem 2 corresponds to the number of samples needed in Theorem 4 with the error tolerance ǫ/k. Using (3) (where ∆ = A − Ã) and Theorem 4, we have that\n‖ATA− ÃT Ã‖2 ≤ 2ǫ\nk ‖A‖22 +\nǫ2 k2 ‖A‖22. (5)\nUsing (5) in Theorem 1 gives Theorem 2."
    }, {
      "heading" : "3 Experiments",
      "text" : "We show the experimental performance of sparse PCA from a sketch using several real data matrices. As we mentioned, sparse PCA is NP-Hard, and so we must use heuristics. These heuristics are discussed next, followed by the data, the experimental design and finaly the results."
    }, {
      "heading" : "3.1 Algorithms for Sparse PCA",
      "text" : "Let G (ground truth) denote the algorithm which computes the principal components (which may not be sparse) of the full data matrix A; the optimal variance is OPTk. We consider six heuristics for getting sparce principal components.\nGmax,r The r largest-magnitude entries in each principal component generated by G. Gsp,r r-sparse components using the Spasm toolbox of Sjstrand et al. [2012] with A. Hmax,r The r largest entries of the principal components for the (ℓ1, ℓ2)-sampled sketch Ã. Hsp,r r-sparse components using Spasm with the (ℓ1, ℓ2)-sampled sketch Ã. Umax,r The r largest entries of the principal components for the uniformly sampled sketch Ã. Usp,r r-sparse components using Spasm with the uniformly sampled sketch Ã.\nAlgorithm 2 Optimal Mixing Parameter α∗ Input: A ∈ Rm×n. 1: Define two functions of α that depend on A:\nρ2(α) = max\n\n\n max i\nn ∑\nj=1\nξij,max j\nm ∑\ni=1\nξij\n\n\n\n− σ2min(A);\nγ(α) = max i,j:\nAij 6=0\n\n \n  ‖A‖ℓ1 α+ (1− α)‖A‖ℓ1 ·|Aij |\n‖A‖2F\n\n \n \n+ ‖A‖2 ;\nwhere,\nξij = ‖A‖2F/ ( α · ‖A‖2F |Aij | · ‖A‖ℓ1 + (1 − α) ) , for Aij 6= 0.\n2: Find α∗ ∈ (0, 1] to minimize ρ2(α) + γ(α)ǫ ‖A‖2 /3. 3: return α∗\nThe outputs of an algorithm Z are sparse principal components V, and the metric we are interested in is the variance, f(Z) = trace(VTATAV), where A is the original centered data. We consider the following statistics.\nf(Gmax,r) f(Gsp,r)\nRelative loss of greedy thresholding versus Spasm, illustrating the value of a good sparse PCA algorithm. Our sketch based algorithms do not address this loss.\nf(Hmax/sp,r) f(Gmax/sp,r)\nRelative loss of using the (ℓ1, ℓ2)-sketch Ã instead of complete data A. A ratio close to 1 is desired.\nf(Umax/sp,r) f(Gmax/sp,r)\nRelative loss of using the uniform sketch Ã instead of complete data A. A benchmark to highlight the value of a good sketch.\nWe also report on the computation time for the algorithms. We show results to confirm that sparse PCA algorithms using the (ℓ1, ℓ2)-sketch are nearly comparable to those same algorithms on the complete data; and, computing from a sparse sketch has a running time that is reduced proportionately to the sparsity."
    }, {
      "heading" : "3.2 Data Sets",
      "text" : "We show results on image, text, stock, and gene expression data. We briefly describe the datasets below.\nDigit Data (m = 2313, n = 256): We use the Hull [1994] handwritten zip-code digit images (300 pixels/inch in 8-bit gray scale). Each pixel is a feature (normalized to be in [−1, 1]). Each 16 × 16 digit image forms a row of the data matrix A. We focus on three digits: “6” (664 samples), “9” (644 samples), and “1” (1005 samples).\nTechTC Data (m = 139, n = 15170): We use the Technion Repository of Text Categorization Dataset (TechTC, see Gabrilovich and Markovitch [2004]) from the Open Directory Project (ODP). Each documents is represented as a probability distribution over a bag-of-words, with words being the features\n– we removed words with fewer than 5 letters. Each of the 139 documents forms a row in the data.\nStock Data (m = 7056, n = 1218): We use S&P100 stock market data of prices for 1218 stocks collected between 1983 and 2011. This temporal dataset has 7056 snapshots of stock prices. The prices of each day form a row of the data matrix and a principal component represents an “index” of sorts – each stock is a feature.\nGene Expression Data (m = 107, n = 22215): We use GSE10072 gene expression data for lung cancer from the NCBI Gene Expression Omnibus database. There are 107 samples (58 lung tumor cases and 49 normal lung controls) forming the rows of the data matrix, with 22,215 probes (features) from the GPL96 platform annotation table."
    }, {
      "heading" : "3.3 Results",
      "text" : "We report results for primarily the top principal component (k = 1) which is the case most considered in the literature. When k > 1, our results do not qualitatively change.\nHandwritten Digits. Using Algorithm 2, the optimal mixing parameter is α∗ = 0.42. We sample approximately 7% of the elements from the centered data using (ℓ1, ℓ2)-sampling, as well as uniform sampling. The performance for small of r is shown in Table 1, including the running time τ .\nFor this data, f(Gmax,r)/f(Gsp,r) ≈ 0.23 (r = 10), so it is important to use a good sparse PCA algorithm. We see from Table 1 that the (ℓ1, ℓ2)-sketch significantly outperforms the uniform sketch. A more extensive comparison of recovered variance is given in Figure 2(a). We also observe a speed-up of a factor of about 6 for the (ℓ1, ℓ2)-sketch. We point out that the uniform sketch is reasonable for the digits data because most data elements are close to either +1 or −1, since the pixels are either black or white.\nWe show a visualization of the principal components in Figure 1. We observe that the sparse components from the (ℓ1, ℓ2)-sketch are almost identical to the sparse components from the complete data.\nTechTC Data. Algorithm 2 gives optimal mixing parameter α∗ = 1. We sample approximately 5% of the elements from the centered data using our (ℓ1, ℓ2)-sampling, as well as uniform sampling. The performance for small r is shown in Table 2, including the running time τ .\nFor this data, f(Gmax,r)/f(Gsp,r) ≈ 0.84 (r = 10). We observe a very significant performance difference between the (ℓ1, ℓ2)-sketch and uniform sketch. A more extensive comparison of recovered variance is given in Figure 2(b). We also observe a speed-up of a factor of about 6 for the (ℓ1, ℓ2)-sketch. Unlike the digits data which is uniformly near ±1, the text data is “spikey” and now it is important to sample with a bias toward larger elements, which is why the uniform-sketch performs very poorly.\nAs a final comparison, we look at the actual sparse top component with sparsity parameter r = 10. The topic IDs in the TechTC data are 10567=”US: Indiana: Evansville” and 11346=”US: Florida”. The top-10 features (words) in the full PCA on the complete data are shown in Table 3.\nIn Table 4 we show which words appear in the top sparse principal component with sparsity r = 10 using various sparse PCA algorithms. We observe that the sparse PCA from the (ℓ1, ℓ2)-sketch with only 5% of the data sampled matches quite closely with the same sparse PCA algorithm using the complete data (Gmax/sp,r matches Hmax/sp,r).\nStock Data. Algorithm 2 gives optimal mixing parameter α∗ = 0.11. We sample about 2% of the non-zero elements from the centered data using our (ℓ1, ℓ2)-sampling, as well as uniform sampling. The performance for small r is shown in Table 5, including the running time τ .\nFor this data, f(Gmax,r)/f(Gsp,r) ≈ 0.96 (r = 10). We observe a very significant performance difference between the (ℓ1, ℓ2)-sketch and uniform sketch. A more extensive comparison of recovered variance is given in Figure 2(c). We also observe a speed-up of a factor of about 4 for the (ℓ1, ℓ2)-sketch. Similar to TechTC data this dataset is also “spikey”, and consequently biased sampling toward larger elements significantly outperforms the uniform-sketch.\nWe now look at the actual sparse top component with sparsity parameter r = 10. The top-10 features (stocks) in the full PCA on the complete data are shown in Table 6. In Table 7 we show which stocks appear in the top sparse principal component using various sparse PCA algorithms. We observe that the sparse PCA from the (ℓ1, ℓ2)-sketch with only 2% of the non-zero elements sampled matches quite closely with the same sparse PCA algorithm using the complete data (Gmax/sp,r matches Hmax/sp,r).\n1we computed α∗ numerically in the range [0.1, 1].\nGene Expression Data. Algorithm 2 gives optimal mixing parameter α∗ = 0.92. We sample about 9% of the elements from the centered data using our (ℓ1, ℓ2)-sampling, as well as uniform sampling. The performance for small r is shown in Table 8, including the running time τ .\nFor this data, f(Gmax,r)/f(Gsp,r) ≈ 0.05 (r = 10) which means a good sparse PCA algorithm is\nimperative. We observe a very significant performance difference between the (ℓ1, ℓ2)-sketch and uniform sketch. A more extensive comparison of recovered variance is given in Figure 2(d). We also observe a speed-up of a factor of about 4 for the (ℓ1, ℓ2)-sketch. Similar to TechTC data this dataset is also “spikey”, and consequently biased sampling toward larger elements significantly outperforms the uniform-sketch.\nAlso, we look at the actual sparse top component with sparsity parameter r = 10. The top-10 features (probes) in the full PCA on the complete data are shown in Table 9.\nIn Table 10 we show which probes appear in the top sparse principal component with sparsity r = 10 using various sparse PCA algorithms. We observe that the sparse PCA from the (ℓ1, ℓ2)-sketch with only 9% of the elements sampled matches reasonably with the same sparse PCA algorithm using the complete data (Gmax/sp,r matches Hmax/sp,r).\nFinally, we validate the genes corresponding to the top probes in the context of lung cancer. Table 11 lists the top twelve gene symbols in Table 9. Note that a gene can occure multiple times in principal component since genes can be associated with different probes.\nGenes like SFTPC, AGER, WIF1, and FABP4 are down-regulated in lung cancer, while SPP1 is upregulated (see the functional gene grouping at: www.sabiosciences.com/rt_pcr_product/HTML/PAHS-13\nCo-expression analysis on the set of eight genes for Hmax,r and Hsp,r using the tool ToppFun (toppgene.cchmc.org/ shows that all eight genes appear in a list of selected probes characterizing non-small-cell lung carcinoma (NSCLC) in [Hou et al., 2010, Table S1]. Further, AGER and FAM107A appear in the top five highly discriminative genes in [Hou et al., 2010, Table S3]. Additionally, AGER, FCN3, SPP1, and ADH1B appear among the 162 most differentiating genes across two subtypes of NSCLC and normal lung cancer in [Dracheva et al., 2007, Supplemental Table 1]. Such findings show that our method can identify, from incomplete data, important genes for complex diseases like cancer. Also, notice that our sampling-based method is able to identify additional important genes, such as, FCN3 and FAM107A in top ten genes."
    }, {
      "heading" : "3.4 Performance of Other Sketches",
      "text" : "We briefly report on other options for sketching A. First, we consider suboptimal α (not α∗ from Algorithm 2) in (4) to construct a suboptimal hybrid distribution. We use this distribution in proto-Algorithm 1 to construct a sparse sketch. Figure 3 reveals that a good sketch using the optimal α∗ is important.\nSecond, another popular sketching method using element wise sparsification is to sample elements not biasing toward larger elements but rather toward elements whose leverage scores are high. See Chen et al. [2014] for the detailed form of the leverage score sampling probabilities (which are known to work well\nin other settings can be plugged into our proto-Algorithm 1). Let A be a m× n matrix of rank ρ, and its SVD is given by A = UΣVT . Then, we define µi (row leverage scores), νj (column leverage scores), and element-wise leverage scores plev as follows:\nµi = ‖U(i)‖22, νj = ‖V(j)‖22, plev = 1\n2 · µi + νj (m+ n)ρ + 1 2mn , i ∈ [m], j ∈ [n]\nAt a high level, the leverage score of element (i, j) is proportional to the squared norms of the ith row of the left singular matrix and the jth row of the right singular matrix. Such leverage score sampling is different from uniform sampling only for low rank matrices or low rank approximations to matrices, so we used a low rank approximation to the data matrix. We construct such low-rank approximation by projecting a dataset onto a low dimensional subspace. We notice that the datasets projected onto the space spanned by top few principal components preserve the linear structure of the data. For example, Digit data show good separation of digits when projected onto the top three PCA’s. For TechTC and Gene data the top two respective PCA’s are good enough to form a low-dimensional subspace where the datasets show reasonable separation of two classes of samples. For the stock data we use top three PCA’s because the stable rank is close to 2.\nLet Lsp,r be the r-sparse components using Spasm for the leverage score sampled sketch Ã. Figure 4 shows that leverage score sampling is not as effective as the optimal hybrid (ℓ1, ℓ2)-sampling for sparse PCA of low-rank data.\nConclusion. It is possible to use a sparse sketch (incomplete data) to recover nearly as good sparse principal components as you would have gotten with the complete data. We mention that, while Gmax which uses the largest weights in the unconstrained PCA does not perform well with respect to the variance, it does identify good features. A simple enhancement to Gmax is to recalibrate the sparse component after identifying the features - this is an unconstrained PCA problem on just the columns of the data matrix corresponding to the features. This method of recalibrating can be used to improve any sparse PCA algorithm.\nOur algorithms are simple and efficient, and many interesting avenues for further research remain. Can the sampling complexity for the top-k sparse PCA be reduced from O(k2) to O(k). We suspect that this should be possible by getting a better bound on ∑k\ni=1 σi(A TA − ÃT Ã); we used the crude\nbound k‖ATA − ÃT Ã‖2. We also presented a general surrogate optimization bound which may be of interest in other applications. In particular, it is pointed out in Magdon-Ismail and Boutsidis [2015] that though PCA optimizes variance, a more natural way to look at PCA is as the linear projection of the data that minimizes the information loss. Magdon-Ismail and Boutsidis [2015] gives efficient algorithms to find sparse linear dimension reduction that minimizes information loss – the information loss of sparse PCA can be considerably higher than optimal. To minimize information loss, the objective to maximize is f(V) = trace(ATAV(AV)†A). It would be interesting to see whether one can recover sparse lowinformation-loss linear projectors from incomplete data."
    } ],
    "references" : [ {
      "title" : "Non-negative sparse PCA with provable guarantees",
      "author" : [ "M. Asteris", "D. Papailiopoulos", "A. Dimakis" ],
      "venue" : "In Proc. ICML,",
      "citeRegEx" : "Asteris et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Asteris et al\\.",
      "year" : 2014
    }, {
      "title" : "Loadings and correlations in the interpretation of principal components",
      "author" : [ "J. Cadima", "I. Jolliffe" ],
      "venue" : "Applied Statistics,",
      "citeRegEx" : "Cadima and Jolliffe.,? \\Q1995\\E",
      "shortCiteRegEx" : "Cadima and Jolliffe.",
      "year" : 1995
    }, {
      "title" : "Coherent Matrix Completion",
      "author" : [ "Y Chen", "S Bhojanapalli", "S Sanghavi", "R Ward" ],
      "venue" : "Proceedings of International Conference on Machine Learning,",
      "citeRegEx" : "Chen et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2014
    }, {
      "title" : "A direct formulation for sparse PCA using semidefinite programming",
      "author" : [ "Alexandre d’Aspremont", "Laurent El Ghaoui", "Michael I. Jordan", "Gert R.G. Lanckriet" ],
      "venue" : "SIAM Review,",
      "citeRegEx" : "d.Aspremont et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "d.Aspremont et al\\.",
      "year" : 2007
    }, {
      "title" : "Optimal solutions for sparse principal component analysis",
      "author" : [ "Alexandre d’Aspremont", "Francis Bach", "Laurent El Ghaoui" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "d.Aspremont et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "d.Aspremont et al\\.",
      "year" : 2008
    }, {
      "title" : "Distinguishing Lung Tumours From Normal Lung Based on a Small Set of Genes",
      "author" : [ "T. Dracheva", "R. Philip", "W. Xiao", "AG Gee" ],
      "venue" : "In Lung Cancer,",
      "citeRegEx" : "Dracheva et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Dracheva et al\\.",
      "year" : 2007
    }, {
      "title" : "Text categorization with many redundant features: using aggressive feature selection to make SVMs competitive with C4.5",
      "author" : [ "E. Gabrilovich", "S. Markovitch" ],
      "venue" : "In Proceedings of International Conference on Machine Learning,",
      "citeRegEx" : "Gabrilovich and Markovitch.,? \\Q2004\\E",
      "shortCiteRegEx" : "Gabrilovich and Markovitch.",
      "year" : 2004
    }, {
      "title" : "Gene Expression-Based Classification of Non-Small Cell Lung Carcinomas and Survival Prediction",
      "author" : [ "J. Hou", "J. Aerts", "B. den Hamer" ],
      "venue" : "In PLoS One, page 5(4):e10312,",
      "citeRegEx" : "Hou et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Hou et al\\.",
      "year" : 2010
    }, {
      "title" : "A database for handwritten text recognition research",
      "author" : [ "J.J. Hull" ],
      "venue" : "In IEEE Transactions on Pattern Analysis and Machine Intelligence,",
      "citeRegEx" : "Hull.,? \\Q1994\\E",
      "shortCiteRegEx" : "Hull.",
      "year" : 1994
    }, {
      "title" : "Recovering PCA from Hybrid-(l1, l2) Sparse Sampling of Data Elements",
      "author" : [ "A. Kundu", "P. Drineas", "M. Magdon-Ismail" ],
      "venue" : "In http://arxiv.org/pdf/1503.00547v1.pdf,",
      "citeRegEx" : "Kundu et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Kundu et al\\.",
      "year" : 2015
    }, {
      "title" : "NP-hardness and inapproximability of sparse pca",
      "author" : [ "M. Magdon-Ismail" ],
      "venue" : "arxiv report: http://arxiv.org/abs/1502.05675,",
      "citeRegEx" : "Magdon.Ismail.,? \\Q2015\\E",
      "shortCiteRegEx" : "Magdon.Ismail.",
      "year" : 2015
    }, {
      "title" : "Generalized spectral bounds for sparse LDA",
      "author" : [ "B. Moghaddam", "Y. Weiss", "S. Avidan" ],
      "venue" : "In Proc. ICML,",
      "citeRegEx" : "Moghaddam et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Moghaddam et al\\.",
      "year" : 2006
    }, {
      "title" : "On lines and planes of closest fit to systems of points in space",
      "author" : [ "K. Pearson" ],
      "venue" : "Philosophical Magazine,",
      "citeRegEx" : "Pearson.,? \\Q1901\\E",
      "shortCiteRegEx" : "Pearson.",
      "year" : 1901
    }, {
      "title" : "Sparse principal component analysis via regularized low rank matrix approximation",
      "author" : [ "Haipeng Shen", "Jianhua Z. Huang" ],
      "venue" : "Journal of Multivariate Analysis,",
      "citeRegEx" : "Shen and Huang.,? \\Q2008\\E",
      "shortCiteRegEx" : "Shen and Huang.",
      "year" : 2008
    }, {
      "title" : "Spasm: A matlab toolbox for sparse statistical modeling",
      "author" : [ "K. Sjstrand", "L.H. Clemmensen", "R. Larsen", "B. Ersbll" ],
      "venue" : "In Journal of Statistical Software (Accepted for publication),",
      "citeRegEx" : "Sjstrand et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Sjstrand et al\\.",
      "year" : 2012
    }, {
      "title" : "A modified principal component technique based on the lasso",
      "author" : [ "N. Trendafilov", "I.T. Jolliffe", "M. Uddin" ],
      "venue" : "Journal of Computational and Graphical Statistics,",
      "citeRegEx" : "Trendafilov et al\\.,? \\Q2003\\E",
      "shortCiteRegEx" : "Trendafilov et al\\.",
      "year" : 2003
    }, {
      "title" : "Sparse principal component analysis",
      "author" : [ "H. Zou", "T. Hastie", "R. Tibshirani" ],
      "venue" : "Journal of Computational & Graphical Statistics,",
      "citeRegEx" : "Zou et al\\.,? \\Q2006\\E",
      "shortCiteRegEx" : "Zou et al\\.",
      "year" : 2006
    } ],
    "referenceMentions" : [ {
      "referenceID" : 12,
      "context" : "The earliest reference to principal components analysis (PCA) is in Pearson [1901]. Since then, PCA has evolved into a classic tool for data analysis.",
      "startOffset" : 68,
      "endOffset" : 83
    }, {
      "referenceID" : 10,
      "context" : "The sparse PCA problem is itself a very hard problem that is not only NP-hard, but also inapproximable [Magdon-Ismail, 2015] There are many heuristics for obtaining sparse factors [Cadima and Jolliffe, 1995, Trendafilov et al.",
      "startOffset" : 103,
      "endOffset" : 124
    }, {
      "referenceID" : 0,
      "context" : ", 2006, Shen and Huang, 2008] including some approximation algorithms with provable guarantees Asteris et al. [2014]. The existing research typically addresses the task of getting just the top principal component (k = 1).",
      "startOffset" : 95,
      "endOffset" : 117
    }, {
      "referenceID" : 9,
      "context" : "To determine which elements to sample, and how to form the sketch, we leverage some recent results in elementwise matrix completion (Kundu et al. [2015]).",
      "startOffset" : 133,
      "endOffset" : 153
    }, {
      "referenceID" : 9,
      "context" : "Such a sampling probability was used in Kundu et al. [2015] to sample data elements in independent trials to get a sketch Ã.",
      "startOffset" : 40,
      "endOffset" : 60
    }, {
      "referenceID" : 9,
      "context" : "In particular, the hybrid-(l1, l2) distribution in (4) was analyzed in Kundu et al. [2015], where they suggest an optimal choice for the mixing parameter α∗ which minimizes the theoretical bound on ‖A− Ã‖2.",
      "startOffset" : 71,
      "endOffset" : 91
    }, {
      "referenceID" : 9,
      "context" : "In particular, the hybrid-(l1, l2) distribution in (4) was analyzed in Kundu et al. [2015], where they suggest an optimal choice for the mixing parameter α∗ which minimizes the theoretical bound on ‖A− Ã‖2. This algorithm to choose α∗ is summarized in Algorithm 2. Using the probabilities in (4) to create the sketch Ã using Algorithm 1, with α∗ selected using Algorithm 2, one can prove a bound for ‖A−Ã‖2. We state a simplified version of the bound from Kundu et al. [2015] in Theorem 4.",
      "startOffset" : 71,
      "endOffset" : 476
    }, {
      "referenceID" : 9,
      "context" : "In particular, the hybrid-(l1, l2) distribution in (4) was analyzed in Kundu et al. [2015], where they suggest an optimal choice for the mixing parameter α∗ which minimizes the theoretical bound on ‖A− Ã‖2. This algorithm to choose α∗ is summarized in Algorithm 2. Using the probabilities in (4) to create the sketch Ã using Algorithm 1, with α∗ selected using Algorithm 2, one can prove a bound for ‖A−Ã‖2. We state a simplified version of the bound from Kundu et al. [2015] in Theorem 4. Theorem 4 (Kundu et al. [2015]) Let A ∈ Rm×n and let ǫ > 0 be an accuracy parameter.",
      "startOffset" : 71,
      "endOffset" : 521
    }, {
      "referenceID" : 9,
      "context" : "Proof: Follows from the bound in Kundu et al. [2015]. ⋄ Recall that k̃ is the stable rank of A.",
      "startOffset" : 33,
      "endOffset" : 53
    }, {
      "referenceID" : 14,
      "context" : "Gsp,r r-sparse components using the Spasm toolbox of Sjstrand et al. [2012] with A.",
      "startOffset" : 53,
      "endOffset" : 76
    }, {
      "referenceID" : 8,
      "context" : "Digit Data (m = 2313, n = 256): We use the Hull [1994] handwritten zip-code digit images (300 pixels/inch in 8-bit gray scale).",
      "startOffset" : 43,
      "endOffset" : 55
    }, {
      "referenceID" : 6,
      "context" : "TechTC Data (m = 139, n = 15170): We use the Technion Repository of Text Categorization Dataset (TechTC, see Gabrilovich and Markovitch [2004]) from the Open Directory Project (ODP).",
      "startOffset" : 109,
      "endOffset" : 143
    }, {
      "referenceID" : 2,
      "context" : "See Chen et al. [2014] for the detailed form of the leverage score sampling probabilities (which are known to work well",
      "startOffset" : 4,
      "endOffset" : 23
    }, {
      "referenceID" : 10,
      "context" : "In particular, it is pointed out in Magdon-Ismail and Boutsidis [2015] that though PCA optimizes variance, a more natural way to look at PCA is as the linear projection of the data that minimizes the information loss.",
      "startOffset" : 36,
      "endOffset" : 71
    }, {
      "referenceID" : 10,
      "context" : "In particular, it is pointed out in Magdon-Ismail and Boutsidis [2015] that though PCA optimizes variance, a more natural way to look at PCA is as the linear projection of the data that minimizes the information loss. Magdon-Ismail and Boutsidis [2015] gives efficient algorithms to find sparse linear dimension reduction that minimizes information loss – the information loss of sparse PCA can be considerably higher than optimal.",
      "startOffset" : 36,
      "endOffset" : 253
    } ],
    "year" : 2015,
    "abstractText" : "We study how well one can recover sparse principal components of a data matrix using a sketch formed from a few of its elements. We show that for a wide class of optimization problems, if the sketch is close (in the spectral norm) to the original data matrix, then one can recover a near optimal solution to the optimization problem by using the sketch. In particular, we use this approach to obtain sparse principal components and show that for m data points in n dimensions, O(ǫ−2k̃max{m,n}) elements gives an ǫ-additive approximation to the sparse PCA problem (k̃ is the stable rank of the data matrix). We demonstrate our algorithms extensively on image, text, biological and financial data. The results show that not only are we able to recover the sparse PCAs from the incomplete data, but by using our sparse sketch, the running time drops by a factor of five or more.",
    "creator" : "LaTeX with hyperref package"
  }
}