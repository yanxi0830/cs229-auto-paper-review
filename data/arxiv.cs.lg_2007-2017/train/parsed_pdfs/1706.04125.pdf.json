{
  "name" : "1706.04125.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Online Learning for Structured Loss Spaces",
    "authors" : [ "Siddharth Barman", "Aditya Gopalan", "Aadirupa Saha" ],
    "emails" : [ "barman@csa.iisc.ernet.in", "aditya@ece.iisc.ernet.in", "aadirupa.saha@csa.iisc.ernet.in" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n70 6.\n04 12\n5v 1\n[ cs\n.L G\n] 1\n3 Ju\nn 20\n17\nWe consider prediction with expert advice when the loss vectors are assumed to lie in a set described by the sum of atomic norm balls. We derive a regret bound for a general version of the online mirror descent (OMD) algorithm that uses a combination of regularizers, each adapted to the constituent atomic norms. The general result recovers standard OMD regret bounds, and yields regret bounds for new structured settings where the loss vectors are (i) noisy versions of points from a low-rank subspace, (ii) sparse vectors corrupted with noise, and (iii) sparse perturbations of low-rank vectors. For the problem of online learning with structured losses, we also show lower bounds on regret in terms of rank and sparsity of the source set of the loss vectors, which implies lower bounds for the above additive loss settings as well."
    }, {
      "heading" : "1 Introduction",
      "text" : "Online learning problems, such as predictionwith expert advice [Cesa-Bianchi and Lugosi, 2006] and online convex optimization [Zinkevich, 2003], involve a learner who sequentially makes decisions from a decision set. The learner seeks to minimize her total loss over a sequence of loss functions, unknown at the beginning, but which is revealed causally. Specifically, she attempts to achieve low regret, for each sequence in a class of loss sequences, with respect to the best single decision point in hindsight.\nThe theory of online learning, by now, has yielded flexible and elegant algorithmic techniques that enjoy provably sublinear regret in the time horizon of plays. Regret bounds for online learning algorithms typically hold across inputs (loss function sequences) that have little or no structure. For instance, for the prediction with experts problem, the exponentially weighted forecaster [Cesa-Bianchi and Lugosi, 2006] is known to achieve an expected regret of O( √ T lnN) over any sequence of N -dimensional loss vectors with coordinates bounded in [0, 1]; here T is the number of rounds of play.\nThere is often, however, more geometric structure in the input in online learning problems, beyond elementary ℓ∞-type constraints, which a learner, with a priori knowledge, can hope to exploit and improve her performance. A notable example is when the loss vectors for the prediction with experts problem come from a low-dimensional subspace [Hazan et al., 2016]. This is often the case in recommender systems which are based on latent factor models [Koren et al., 2009], where users and items are represented in terms of their features or attribute vectors, typically of small dimension.\n∗Indian Institute of Science. barman@csa.iisc.ernet.in †Indian Institute of Science. aditya@ece.iisc.ernet.in ‡Indian Institute of Science. aadirupa.saha@csa.iisc.ernet.in\nUnder a bilinear model for the utility of a user-item pair, each user’s utility across all items becomes a vector from a subspace with dimension at most that of the feature vectors. Hazan et al. [2016] show that the learner can limit her regret to O( √ dT ) when each loss vector comes from a d-dimensional subspace of RN . If d ≪ N (in fact, d ≤ lnN ), then, this confers an advantage over using a more general best experts algorithm like Exponential Weights.\nThis example is interesting not only because it shows that geometric/structural properties known in advance can help the learner achieve order-wise better regret, but also because it opens up the possibility of studying whether other, arguably more realistic, forms of structure can be exploited, such as sparsity in the input (or more generally small norm) and, more importantly, “additive” combinations of such structures, e.g., low-rank losses added with losses of small ℓ2-norm, which expresses losses that are noisy perturbations of a low-dimensional subspace. In this paper, we take a step in this direction and develop a framework for online learning problems with structured losses.\nOur Results and Techniques: We consider the prediction with experts problemwith loss sequences in which each element (loss vector) belongs to a set that respects structural constraints. Specifically, we assume that the loss vectors belong to a sum of atomic norm balls1 [Chandrasekaran et al., 2012], say A + B, where the sum of sets is in the Minkowski sense.2 For this setup—which we call online learning with additive loss spaces—we show a general regret guarantee for an online mirror descent (OMD) algorithm that uses a combination of regularizer functions, each of which is adapted to a constituent atomic norms of A and B, respectively.\nSpecializing this result for a variety of loss function sets recovers standard OMD regret guarantees for strongly convex regularizers [Shalev-Shwartz, 2012b], and subsumes a result of Hazan et al. [2016] for the online low-rank problem. But more importantly, this allows us to obtain “new results from old”—regret guarantees for settings such as noisy low rank (where losses are perturbations from a low-dimensional subspace), noisy sparse (where losses are perturbations of sparse vectors), and sparse low-rank (where losses are sparse perturbations from a low-dimensional subspace); see Tables 1 and 2.\nAnother contribution of this work is to show lower bounds on regret for the online learning problem with structured losses. We derive a generic lower bound on regret, for any algorithm for the prediction with experts problem, using structured (in terms of sparsity and dimension) loss vectors. This result allows us to derive regret lower bounds in a variety of individual and additive loss space settings including sparse, noisy, low rank, noisy low-rank, and noisy sparse losses.\nRelated work. The work that is perhaps closest in spirit to ours is that of Hazan et al. [2016], who study the best experts problem when the loss vectors all come from a low-dimensional subspace of the ambient space. A key result of theirs is that the online mirror descent (OMD) algorithm, used with a suitable regularization, improves the regret to depend only on the low rank and not the ambient dimension. More broadly, OMD theory provides regret bounds depending on properties of the regularizer and the geometry of the loss and decision spaces [Shalev-Shwartz, 2012a]. In this work, we notably generalize this to the setup of additive losses.\nStructured online learning has been studied in the recent past from the point of view of overall sequence complexity or “hardness,” also informally called learning with “easy data.” This includes\n1centrally symmetric, convex, compact sets with their centroids at the origin. 2A+B = {a+ b : a ∈ A, b ∈ B}.\nwork that shows algorithms enjoying first- and second-order regret bounds [Cesa-Bianchi et al., 2007] and quadratic variation-based regret bounds [Hazan and Kale, 2010; Steinhardt and Liang, 2014]. There is also recent work on achieving regret scaling with the covering number of the sequence of observed loss vectors [Cohen and Mannor, 2017], which is another measure of easy data.\nOur problem formulation, it can be argued, explores a different formulation of learningwith “easy data,” in which the adversary, instead of being constrained to choose loss sequences with low total magnitude or variation, is limited to choosing loss vectors from sets with enough geometric structure (e.g., from particular atomic norm balls)."
    }, {
      "heading" : "2 Notation and Preliminaries",
      "text" : "For an integer n ∈ Z+, we use [n] to denote the set {1, 2, . . . n}. For a vector x ∈ Rn, xi denotes the ith component of x. The p-norm of x is defined as ‖x‖p = ( ∑n i=1 |xi|p)\n1/p, 0 ≤ p < ∞. Write ‖x‖∞ := maxni=1 |xi| and ‖x‖0 := |{i | xi 6= 0}|. If ‖· ‖ is a norm defined on a closed convex set Ω ⊆ Rn, then its corresponding dual norm is defined as\n‖u‖∗ = sup x∈Ω:‖x‖≤1 x · u ,\nwhere x · u = ∑i xiui is the standard inner product in Euclidean space. It follows that the dual of the standard p-norm (p ≥ 1) is the q-norm, where q is the Hölder conjugate of p, i.e., 1p + 1q = 1. The n-probability simplex is defined as ∆n = {x ∈ [0, 1]n | ∑n i=1 xi = 1}. Given any setA ⊆ Rn, we denote the convex hull ofA as conv(A). Clearly, when A = {e1, e2, . . . en}, conv (A) = ∆n, where ei ∈ [0, 1]n denotes ith standard basis vector of Rn."
    }, {
      "heading" : "2.1 Atomic Norm and its Dual [Chandrasekaran et al., 2012]",
      "text" : "Next we define the notion of an atomic norm along with its dual. These concepts will provide us with a unified framework for addressing structured loss spaces, and will be used extensively in the paper. Let A ⊆ Rn be a set which is convex, compact, and centrally symmetric about the origin (i.e., a ∈ A if and only if −a ∈ A).\nThe atomic norm induced by the set A is defined as\n||x||A := inf{t > 0 | x ∈ tA}, for x ∈ Rn.\nThe dual of the atomic norm induced byA becomes the support function ofA [Boyd and Vandenberghe, 2004]; formally,\n||x||∗A := sup{x.z | z ∈ A}, for x ∈ Rn.\nFor example, if the setA is the convex hull of all unit-norm one-sparse vectors, i.e.,A := conv ({±ei}ni=1), then the corresponding atomic norm is the standard ℓ1-norm ‖· ‖1."
    }, {
      "heading" : "2.2 Problem setup",
      "text" : "We consider the online learning problem of learning with expert advice from a collection ofN experts [Cesa-Bianchi and Lugosi, 2006]. In each round t = 1, 2, . . . , T , the learner receives advice from each\nof the N experts, following which the learner selects an expert from a distribution pt ∈ ∆N , maintained over the experts, whose advice is to be followed. Upon this, the adversary reveals the losses incurred by the N experts, lt = (lt(1), lt(2), . . . lt(N)) ∈ [0, 1]N , lt(i) being the loss incurred by the ith expert. The learner suffers an expected loss of EIt∼pt [lt(It)] = ∑N i=1 pt(i)lt(i). If the game is played for a total of T rounds, then the objective of the learner is to minimize the expected cumulative regret defined as:\nE [ RegretT ] = T∑\nt=1\npt.lt − min i∈[N ]\nT∑\nt=1\nlt(i).\nIt is well-known that without any further assumptions over the losses lt, the best achievable\nregret for this problem is Θ( √ T lnN) – the exponential weights algorithm or the Hedge algorithm achieves regret O( √ T lnN) [Arora et al., 2012, Theorem 2.3], and a matching lower bound exists as well [Cesa-Bianchi and Lugosi, 2006, Theorem 3.7].\nNow, a very natural question to ask is: can a better (smaller) regret be achieved if the loss sequence has more structure? Suppose the loss vectors (lt) T t=1 all belong to a common structured loss space L ⊆ [0, 1]N , such as: 1. Sparse loss space: L = {l ∈ [0, 1]N | ‖l‖0 = s}. Here, s ∈ [N ] is the sparsity parameter.\n2. Spherical loss space: L = {l ∈ [0, 1]N | ‖l‖A = l⊤Al ≤ ǫ}, where A is a positive definite matrix and ǫ > 0.\n3. Noisy loss space: L = {l ∈ [0, 1]N | ‖l‖22 = ǫ}, ǫ > 0}. Note that noisy losses are a special class of spherical losses whereA = IN , the identity matrix.\n4. Low-rank loss space: L = {l ∈ [0, 1]N | l = Uv }, where the rank of matrix U ∈ RN×d is equal to d ∈ [N ] and vector v ∈ Rd (as mentioned previously, such loss vectors were considered by Hazan et al. [2016]).\n5. Additive loss space: L = L1 + L2 (Minkowski Sum). More formally, L = {l = l1 + l2 | l1 ∈ L1 and l2 ∈ L2}, where L1 ⊆ [0, 1]N and L2 ⊆ [0, 1]N are structured loss spaces themselves.3 Examples include any combination of the previously described loss spaces, such as the low-\nrank + noisy space.\nClearly, using the Exponential Weight or Hedge algorithm, one can always achieve O( √ T lnN) regret in the above settings. The relevant question is whether the geometry of such loss spaces can be exploited, in a principled fashion, to achieve improved regret guarantees (possibly independent of lnN )? In other words, can we come up with algorithms for above cases such that the regret is O( √ ωT ), where ω < lnN?\nWe will show that, for all of the above loss spaces, we can obtain a regret factor ω which is orderwise better than lnN . In particular, we will establish these regret bounds by employing the Online Mirror Descent algorithm (described below) with a right choice of atomic norms. Furthermore, using this algorithm, we will also develop a framework to obtain new regret bounds from old. That is, we show that if we have an online mirror descent setup for L1 and L2, then we can in fact obtain a low-regret algorithm for the additive loss space L1 + L2.\n3Note that, in the problem setup at hand the learner observes only the loss vectors lt, and does not have access to the\nloss components l1t or l2t."
    }, {
      "heading" : "2.3 Online Mirror Descent",
      "text" : "In this section, we give a brief introduction to the Online Mirror Descent (OMD) algorithm [Bubeck, 2011; Shalev-Shwartz, 2012a], which is a subgradient descent based method for online convex optimization with a suitably chosen regularizer. A reader well-versed with the analysis of OMD may skip to the statement of Theorem 3 and proceed to Section 3.\nOMD generalizes the basic mirror descent algorithm used for offline optimization problems (see, e.g., Beck and Teboulle [2003]). Before detailing the algorithm, we will recall a few relevant definitions:\nDefinition 1. Bregman Divergence. Let Ω ∈ Rn be a convex set, and f : Ω→R be a strictly convex and differentiable function. Then the Bregman divergence associated with f , denoted by Bf : Ω × Ω→R, is defined as\nBf (u,v) := f(u)− f(v)− (u− v) · ∇f(v), for u,v ∈ Ω .\nDefinition 2. Strong Convexity (see, e.g., Shalev-Shwartz [2012a] and Bubeck [2011]) Let Ω ∈ Rn be a convex set, and f : Ω→R be a differentiable function. Then f is called α-strongly convex over Ω with respect to the norm ‖ · ‖ iff for all x,y ∈ Ω,\nf(x)− f(y)− (∇f(y))T (x− y) ≥ α 2 ‖x− y‖2.\nEquivalently, a continuous twice differentiable function, f , over Ω is said to be α-strongly convex iff for all x,w ∈ Ω we have\nxT∇2f(w)x ≥ α‖x‖2.\nWe now describe the OMD algorithm instantiated to the problem setup given in Section 2.2.\nAlgorithm 1 Online Mirror Descent (OMD)\n1: Parameters: Learning rate η > 0. 2: Convex set Ω ⊆ RN , such that∆N ⊆ Ω 3: Strictly convex, differentiable function R : Ω→R 4: Initialize: p1 = argmin\np∈∆N R(p)\n5: for t = 1, 2, · · · T do 6: Play pt ∈ ∆N 7: Receive loss vector lt ∈ [0, 1]N 8: Incur loss pt.lt 9: Update:\n10: ∇R(p̃t+1) ← ∇R(pt)− ηlt (Assume this yields p̃t+1 ∈ Ω) 11: pt+1 ← argmin\np∈∆N BR(p, p̃t+1)\n12: end for\nThe regret guarantee of the above algorithm is as follows:\nTheorem 3 (OMD regret bound (Theorem 5.2, Bubeck [2011])). Let the loss vectors, {lt}Tt=1, belong to a loss space L ⊆ [0, 1]N , which is bounded with respect to a (arbitrary) norm ‖· ‖; in particular, for any l ∈ L we have ‖l‖ ≤ G. Furthermore, let Ω ⊇ ∆N be a convex set, and R : Ω→R be a strictly convex, differentiable function that satisfies R(p) − R(p1) ≤ D2 for parameter D ∈ R and all p ∈ ∆N ; where p1 := argminp∈∆N R(p). Also, let the restriction of R to ∆N be α-strongly convex with respect to ‖· ‖∗, the dual norm of ‖· ‖.\nThen, the regret of OMD algorithm with set Ω, regularizer function R, and learning rate η > 0, for T\nrounds satisfies\nRegretT (OMD(η ∗)) =\nT∑\nt=1\npt.lt − N min i=1\nT∑\nt=1\nlt(i) ≤ 1\nη\n( D2 + η2G2T\n2α\n) ,\nwhere p1,p2, . . .pT denotes the sequential predictions of the algorithm in T rounds. Moreover, setting η ∗ = D G √ 2α T (i.e., minimizing the right-hand-side of the above bound), we have\nRegretT (OMD(η ∗)) ≤ DG\n√ 2T\nα .\nFor completeness, a proof of the above theorem appears in Appendix A."
    }, {
      "heading" : "3 Online Mirror Descent for Structured Losses",
      "text" : "This section shows that, for specific structured loss spaces, instantiating the OMD algorithm—with a right choice of the norm ‖ · ‖ and regularizer R—leads to improved (over the standard O( √ 2T lnN) bound) regret guarantees. The proofs of these results appear in Appendix B.\n1. Sparse loss space: L = {l ∈ [0, 1]N | ‖l‖0 = s}, s ∈ [N ] being the loss sparsity parameter. Then\nusing q-norm, R(x) = ‖x‖2q = (∑N i=1(x q i ) ) 2 q , where q = ln s ′ ln s′−1 , s ′ = (s + 1)2, as the regularizer, we get,\nRegretT ≤ 2 √ ln(s+ 1)T .\n2. Spherical loss space: L = {l ∈ [0, 1]N | ‖l‖2A = l⊤Al ≤ ǫ}, whereA is a positive definite matrix, ǫ > 0. Then using the square of the ellipsoidal norm as the regularizer, R(x) = ǫx⊤A−1x, we get,\nRegretT ≤ √ λmax(A−1)ǫT ,\nwhere λmax(A −1) denotes the maximum eigenvalue ofA−1.\n3. Noisy loss sapce: L = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ}, ǫ > 0. Then using the square of the standard Euclidean norm as the regularizer, R(x) = ǫ‖x‖22, we get,\nRegretT ≤ √ ǫT .\nNote that noisy loss is a special case of spherical loss whereA = A−1 = IN .\nHazan et al. [2016] have also usedOMD to address the loss vectors that belong to a low-dimensional\nsubspace. Specifically, if the loss space L = {l ∈ [0, 1]N | l = Uv }, where matrix U ∈ RN×d is of rank d and vector v ∈ Rd, with 1 ≤ d ≤ lnN . Then, Hazan et al. [2016] show that the regularizer R(x) = ‖x‖2H = x⊤Hx (whereH = IN +U⊤MU,M is the matrix corresponding to the Löwner-John ellipsoid of L and IN is the identity matrix) leads to the following regret bound:\nRegretT ≤ 4 √ dT .\nIn addition, for the standard loss space L = [0, 1]n, one can execute the OMD algorithm with the unnormalized negative entropy, R(x) = ∑N i=1 xi log xi − ∑N i=1 xi, as the regularizer, to obtain:\nRegretT ≤ √ 2T lnN .\nNote that the above regret bound is same as that given by Hedge algorithm. In fact, it can be verified that, with the above choice of regularizer, the OMD algorithm exactly reduces down to standard Hedge algorithm (see, e.g., Bubeck [2011])."
    }, {
      "heading" : "4 Online Learning for Additive Loss Spaces",
      "text" : "We now present a key result of this paper, which enables us to obtain new regret bounds from old. In particular, we will develop a framework that provides a low-regret OMD algorithm for an additive loss space L = L1+L2, using the OMD setup of the constituent loss spacesL1 andL2. Specifically, we detail how to choose an appropriate regularizer for losses from L and, hence, construct a low-regret OMD algorithm.\nTheorem 4. (Main Result) Let L1,L2 ⊆ [0, 1]N be two loss spaces, such that L1 ⊆ A1, L2 ⊆ A2, where A1, A2 ∈ RN are two centrally symmetric, convex, compact sets. We observe a sequence of loss vectors {lt}Tt=1, such that in any round t ∈ [T ], lt = l1t+l2t, where l1t ∈ L1 and l2t ∈ L2. Consider two differentiable, strictly convex functions R1 : Ω1 7→ R, R2 : Ω2 7→ R, where Ω1,Ω2 ⊇ ∆N are two convex sets. The restrictions of R1 and R2 to∆N are, respectively, α1- and α2-strongly convex with respect to the norms || · ||∗A1 and || · || ∗ A2 .\nAlso, let parameters D1 and D2 be such that R1(p) − R1(p1) ≤ D21 and R2(p) − R2(p1) ≤ D22 for all p ∈ ∆N ; where p1 := argminp∈∆N (R1(p) +R2(p)).\nThen (with learning rate η∗ = √ (D2 1 +D2\n2 )min(α1,α2) T , regularizer R := R1 + R2, and p1 as the initial\nprediction) the regret of the OMD algorithm is bounded as\nRegretT ≤ 2\n√( D21 +D 2 2 ) T\nmin(α1, α2) .\nA proof of the above theorem appears in Section 4.1.\nRemark 5. In general, the regret guarantee of Theorem 4 is essentially tight. That is, there exist loss spaces L1 and L2 such that OMD algorithm obtained via Theorem 4 provides an order-wise optimal regret bound for the additive loss space L = L1 + L2; see Appendix E for specific examples.\nThe above theorem immediately leads to the following corollary.\nCorollary 6. (New Regret Bounds from Old) Suppose L1,L2 ⊆ [0, 1]N are two loss spaces such that ‖l‖A1 ≤ 1, ∀l ∈ L1, and ‖l‖A2 ≤ 1, ∀l ∈ L2, where A1,A2 ∈ RN are two centrally symmetric, convex, compact sets. Also, suppose there exists two strictly convex, differentiable functions R1 : Ω1 7→ R and R2 : Ω2 7→ R, (Ω1,Ω2 ⊇ ∆N , convex) such that OMD with regularizer functions R1 and R2 gives the regret bounds ofD1 √ 2T α1 andD2 √ 2T α2\nover loss spaces L1 and L2, respectively. Here, α1 (α2) is the strong convexity parameter of R1 (R2) over ∆N , with respect to the atomic norm || · ||∗A1 (|| · || ∗ A2).\nIn addition let, D1 andD2 are parameters such that, for all p ∈ ∆N ,\nR1(p)−R1(p′1) ≤ D21 with p′1 := argminq∈∆N R1(q) and R2(p)−R2(p′2) ≤ D22 with p′2 = argminq∈∆N R2(q).\nThen, for the additive loss space L = L1+L2, the OMD algorithm with regularizer functionR = R1+R2, initial prediction p1 = argminp∈∆N (R1(p) +R2(p)) (and learning rate η ∗ = √ (D2 1 +D2 2 )min(α1,α2) T ) leads to the following regret bound:\nRegretT ≤ 2 √ (D21 +D 2 2)T\nmin(α1, α2) .\nNote that we can prove this corollary—using Theorem 4—by simlply verifying the following in-\nequalities: R1(p)−R1(p1) ≤ D21 andR2(p)−R2(p1) ≤ D22 , for all p ∈ ∆N and p1 := argminq∈∆N (R1(q) +R2(q)). This follows, since R1(p ′ 1) ≤ R1(p1) and R2(p′2) ≤ R2(p1); recall that p′1 := argminq∈∆N R1(q) and p′2 := argminq∈∆N R2(q)."
    }, {
      "heading" : "4.1 Proof of Theorem 4",
      "text" : "Before proceeding to prove the theorem, we will establish the following useful lemmas. Let A1,A2 be any two convex, compact, centrally symmetric subsets of Rn and A = A1 +A2 (Minkowski Sum). Then, note that A is also convex, compact, and centrally symmetric. This follows from the fact that conv(X ) + conv(Y) = conv(X + Y) for any X ,Y ⊂ Rn. In addition, we have\nLemma 7. ||x||A ≤ max{||x1||A1 , ||x2||A2}, where x = x1 + x2, x1 ∈ A1, x2 ∈ A2.\nProof. Recall the definition of atomic norm ‖ · ‖A from Section 2.1. Suppose for any x = (x1 + x2) ∈ R n, t1 = ||x1||A1 and t2 = ||x2||A2 . Clearly, x = x1 + x2 ∈ (t1A1 + t2A2) ⊆ t(A1 + A2), where t = max{t1, t2}. The proof now follows directly from the definition of atomic norm, ‖x‖A.\nLemma 8. ||x||∗A ≤ ||x||∗A1 + ||x|| ∗ A2 , for all x ∈ R n.\nProof. Consider any x ∈ Rn,\n||x||∗A = sup{x.z | z ∈ A} = sup{x.(z1 + z2) | z1 ∈ A1, z2 ∈ A2} ≤ sup{x.z1 | z1 ∈ A1}+ sup{x.z2 | z2 ∈ A2} ≤ ||x||∗A1 + ||x|| ∗ A2 .\nLemma 9. Suppose Ω̃ ∈ Rn be a convex set. Consider two differentiable functions R1 : Rn 7→ R and R2 : R n 7→ R, that are respectively α1 and α2-strongly convex with respect to || · ||∗A1 and || · || ∗ A2 over Ω̃. Then R = R1 +R2 is α = 1 2 min(α1, α2)-strongly convex with respect to || · ||∗A over Ω̃.\nProof. For any x,y ∈ Ω̃,\nR(x)−R(y)−∇R(y)(y)(x − y) = R1(x)−R1(y) −∇R1(y)(y)(x − y) +R2(x)−R2(y) −∇R2(y)(x − y)\n= α1 2 ‖x− y‖∗2A1 + α2 2 ‖x− y‖∗2A2 ≥ α 2 (2‖x− y‖∗2A1 + 2‖x‖ ∗2 A2), (α = 1 2 min(α1, α2)) ≥ α 2 (‖x− y‖∗A1 + ‖x− y‖ ∗ A2) 2 (since 2(a2 + b2) > (a+ b)2, ∀a, b ∈ R) ≥ α 2 (‖x− y‖∗2A ) (via Lemma 8) .\nHence, R = R1 + R2 is α = 1 2 min(α1, α2)-strongly convex with respect to || · ||∗A over Ω̃. Similarly, if R1 and R2 are twice continuously differentiable, then for any x,w ∈ Ω̃.\nxT∇2R(w)x = xT∇2(R1 +R2)(w)x = xT∇2R1(w)x+ xT∇2R2(w)x ≥ α1‖x‖∗2A1 + α2‖x‖ ∗2 A2\n≥ α(2‖x‖∗2A1 + 2‖x‖ ∗2 A2), (α =\n1 2 min(α1, α2))\n≥ α(‖x‖∗A1 + ‖x‖ ∗ A2) 2 (Since 2(a2 + b2) > (a+ b)2, ∀a, b ∈ R) ≥ α(‖x‖∗A)2 (via Lemma 8) .\nThus R is 12 min(α1, α2)-strongly convex with respect to || · ||∗A over Ω̃.\nProof. of Theorem 4 Consider the norm ‖ · ‖ = ‖ · ‖A, and its dual norm ‖ · ‖∗ = ‖ · ‖∗A. Note that:\n1. Lemma 7 along with the bounds ‖l1‖A1 ≤ 1 and ‖l2‖A2 ≤ 1 imply that ‖l‖A ≤ 1, for any l = l1 + l1 ∈ L. Hence, L ⊆ A.\n2. For any p ∈ ∆N , R(p) − R(p1) = (R1(p) − R1(p1)) + (R2(p) − R2(p1)) ≤ D21 + D22. Hence, D = √ D21 +D 2 2. 3. R(x) = R1(x) +R2(x) is min{α1,α2}\n2 -strongly convex with respect to ‖ · ‖∗A, ∀x ∈ ∆N (Lemma 9). Hence, α = min{α1,α2}2 .\nThe result now follows by applying Theorem 3."
    }, {
      "heading" : "4.2 Applications of Theorem 4",
      "text" : "In this section, we will derive novel regret bounds for additive loss spaces (L = L1 + L2) wherein the individual components (L1 and L2) are the loss spaces which were considered in Section 3. These results are derived by applying Theorem 4; details of the proofs appear in Appendix C.\nCorollary 10 (Noisy Low Rank). Suppose L1 = {l ∈ [0, 1]N | l = Uv } is a d rank loss space (1 ≤ d ≤ lnN), perturbed with noisy losses L2 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ, ǫ > 0}. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = x⊤Hx + ǫ‖x‖22 and learning rate η∗ = √ 2(16d+ǫ)\nT —is upper bounded as follows\nRegretT ≤ √ 2(16d + ǫ)T .\nCorollary 11 (Noisy Sparse). Suppose L1 = {l ∈ [0, 1]N | ‖l‖0 = s} is an s-sparse loss space (s ∈ [N ]), perturbed with noisy losses from L2 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ, ǫ > 0}. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = ‖x‖2q + ǫ‖x‖22 and learning rate η∗ = √ 1+ǫ\n(2 ln(s+1)−1)T —is upper bounded as follows\nRegretT ≤ 2 √ 2(1 + ǫ) ln(s+ 1)T .\nCorollary 12 (Low Rank with Sparse). Suppose L1 = {l ∈ [0, 1]N | l = Uv } is a d rank loss space (1 ≤ d ≤ lnN), perturbed with s-sparse losses L2 = {l ∈ [0, 1]N | ‖l‖0 = s}, s ∈ [N ]. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = x⊤Hx+ ‖x‖2q and learning rate η∗ = √ 16d+1\n(2 ln(s+1)−1)T —is upper bounded as follows\nRegretT ≤ 2 √ 2(16d + 1) ln(s + 1)T ."
    }, {
      "heading" : "5 Lower Bounds",
      "text" : "In this section we will derive lower bounds for online learning with experts’ advice problem for different structured loss spaces. We first state the lower bound for a general loss space L ⊆ RN ; see Theorem 13. The proof of this theorem appears in Appendix D and is based on a lower-bound result of Ben-David et al. [2009] for online learning of binary hypotheses classes in terms of its Littlestone’s dimension.\nTheorem 13 (Generic Lower Bound). Given parameters V > 0 and s > 0 along with any online learning algorithm, there exists a sequence of V -dimensional loss vectors l1, l2, . . . , lT ∈ {0,±s}N of sparsity 2V ≤ N (i.e., rank ([l1, l2, . . . , lT ]) = V and ‖lt‖0 = 2V , for all t ∈ [T ]) such that\nRegretT ≥ 2s √ V T\n8 .\nProof of the above theorem is deferred to Appendix D.1. The following corollary is a direct con-\nsequence of Theorem 13.\nCorollary 14. Given parameters V ∈ [lnN ] and s > 0 along with any online learning algorithm, there exists a sequence of loss vectors l1, l2, . . . , lT ∈ [−s, s]N of VC-dimension V (i.e., V C({l1, l2, . . . , lT }) = V ), such that\nRegretT ≥ 2s √ V T\n8 .\nProof. Consider the set of loss vectors L = {l ∈ {0,±s}N | ‖l‖0 ≤ 2V }. From the definition of VC dimension (see Definition 23, Appendix D), it follows that V C(L) = V . Hence, Theorem 13 implies the stated claim.\nNext we instantiate Theorem 13 to derive the regret lower bounds for the structured loss spaces\nintroduced in Section 3. In particular, we begin by stating a lower bound for sparse loss vectors.\nCorollary 15. (Lower Bound for Sparse losses) Given k ∈ [N ] and s > 0 along with any online learning algorithm, there exists a sequence of loss vectors l1, l2, . . . , lT ∈ [−s, s]N of sparsity k ∈ N (i.e. ‖lt‖0 = k for all t ∈ [T ]) such that\nRegretT ≥ 2s √ ⌊ln k⌋T 8 .\nAlong the same lines, Theorem 13 leads to a lower bound for losses with small ℓp norm.\nCorollary 16. (Lower Bound for ℓp losses) Given p ≤ [lnN ] and s > 0 along with any online learning algorithm, there exists a sequence of loss vectors l1, l2, . . . , lT ∈ [−s, s]N of ℓp norm at most s (i.e., ‖lt‖p ≤ s) such that\nRegretT ≥ s √ pT\n8 .\nProof. Consider the set of all 2p-sparse loss vectors in [− s2 , s2 ]N . Any such loss vector l ∈ [− s2 , s2 ]N has ‖l‖p ≤ s. The stated claim now follows by applying Theorem 13 with parameters s2 and V = p.\nCorollary 17. (Lower Bound for Noisy Losses) Given ǫ > 0 and any online learning algorithm, there exists a sequence of ǫ-noisy loss vectors l1, l2, . . . , lT ∈ [−ǫ, ǫ]N (i.e., ‖lt‖22 ≤ ǫ) such that\nRegretT ≥ √ ǫT\n4 .\nProof. Consider the set of all 2-sparse loss vectors in [− √ ǫ 2 , √ ǫ 2 ]\nN . Clearly any such loss vector l ∈ [− √ ǫ 2 , √ ǫ 2 ] N has ‖l‖22 ≤ ǫ. Hence with parameters s = √ ǫ 2 and V = 1, the result follows directly from theorem 13.\nRemark 18. Note that Theorem 13 (with parameter V = d, s = 1) recovers the lower bound for low rank loss spaces as established by Hazan et al. [2016]: given 1 ≤ d ≤ lnN and any online learning algorithm, there exists a sequence of d-rank loss vectors l1, l2, . . . , lT ∈ [−1, 1]N such that\nRegretT ≥ 2 √ dT\n8 .\nWe next derive the regret lower bounds for few instances of additive loss spaces.\nCorollary 19. (Lower Bound for Noisy Low Rank) Given parameters ǫ > 0 and d ∈ [lnN ] along with any online learning algorithm, there exists a sequence of loss vectors l1, l2, . . . , lT ∈ [−(1 + ǫ), (1 + ǫ)]N , where lt = lt1 + lt2, with lt1 ∈ {l ∈ [−1, 1]N | l = Uv} (U ∈ RN×d is a rank d matrix), and ‖lt2‖22 ≤ ǫ, such that\nRegretT ≥ 2 ( 1 + √ ǫ\n2d\n)√ dT\n8 .\nProof. Let N = 2d. Consider the matrix H ∈ {−1, 1}N×d where 2d rows of H represent 2d vertices of the d-hypercube in [−1, 1]N . Let,L1 = {H(:, 1), . . .H(:, d)}, andL2 = { l ∈ { − √ ǫ 2d , √ ǫ 2d }N | ‖l‖22 = ǫ } . Note that any loss vectors in L2 is 2d-sparse. Consider L = L1+L2. The result now follows from Theorem 13, noting that—with s = ( 1 +\n√ ǫ 2d ) and V = d—the lowering-bounding loss vectors assured\nin Theorem 13, l1, . . . , lT , are contained in L.\nCorollary 20. (Lower Bound for Noisy Sparse) Given parameters ǫ > 0 and k ∈ [N ] along with any online learning algorithm, there exists a sequence of loss vectors l1, l2, . . . , lT ∈ [−(1 + ǫ), (1 + ǫ)]N , where lt = lt1 + lt2, with lt1 ∈ {l ∈ [−1, 1]N | ‖l‖0 ≤ k}, and ‖lt2‖22 = ǫ, such that\nRegretT ≥ 2 ( 1 + √ ǫ\nk )√⌊ln k⌋T 8 .\nProof. Consider the following set of loss vectors: L1 = {l ∈ {−1, 1}N | ‖l‖0 = k}, and L2 ={ l ∈ { − √ ǫ k , √ ǫ k }N | ‖l‖22 = ǫ } . Note that any loss vectors in L2 is k-sparse. Write L = L1 + L2. The corollary now follows from Theorem 13, noting that—with s = ( 1 + √ ǫ k ) and V = ⌊ln k⌋—the lowering-bounding loss vectors assured in Theorem 13, l1, . . . , lT , are contained in L."
    }, {
      "heading" : "6 Conclusion",
      "text" : "In this paper, we have developed a theoretical framework for online learning with structured losses, namely the broad class of problems with additive loss spaces. The framework yields both algorithms that generalize standard online mirror descent and also novel regret upper bounds for relevant settings such as noisy + sparse, noisy + low-rank, and sparse + low-rank losses. In addition, we have derived lower bounds—i.e., fundamental limits—on regret for a variety of online learning problems with structured loss spaces. In light of these results, tightening the gap between the upper and lower bounds for structured loss spaces is a natural, open problem.\nAnother relevant thread of research is to study settings wherein the learner knows that the loss space is structured, but is oblivious to the exact instantiation of the loss space, e.g., the losses might be perturbations of vectors from a low-dimensional subspace, but, a priori, the learning algorithm might not know the underlying subspace.4 Addressing structured loss spaces in bandit settings also remains an interesting direction for future work.\n4The result of Hazan et al. [2016] address the noiseless version of this problem."
    }, {
      "heading" : "A Proof of Theorem 3",
      "text" : "Theorem 3 (OMD regret bound (Theorem 5.2, Bubeck [2011])). Let the loss vectors, {lt}Tt=1, belong to a loss space L ⊆ [0, 1]N , which is bounded with respect to a (arbitrary) norm ‖· ‖; in particular, for any l ∈ L we have ‖l‖ ≤ G. Furthermore, let Ω ⊇ ∆N be a convex set, and R : Ω→R be a strictly convex, differentiable function that satisfies R(p) − R(p1) ≤ D2 for parameter D ∈ R and all p ∈ ∆N ; where p1 := argminp∈∆N R(p). Also, let the restriction of R to ∆N be α-strongly convex with respect to ‖· ‖∗, the dual norm of ‖· ‖.\nThen, the regret of OMD algorithm with set Ω, regularizer function R, and learning rate η > 0, for T\nrounds satisfies\nRegretT (OMD(η ∗)) =\nT∑\nt=1\npt.lt − N min i=1\nT∑\nt=1\nlt(i) ≤ 1\nη\n( D2 + η2G2T\n2α\n) ,\nwhere p1,p2, . . .pT denotes the sequential predictions of the algorithm in T rounds. Moreover, setting η ∗ = D G √ 2α T (i.e., minimizing the right-hand-side of the above bound), we have\nRegretT (OMD(η ∗)) ≤ DG\n√ 2T\nα .\nProof. Consider p ∈ ∆N . We have for all t ∈ [T ]:\nlt.pt − lt.p ≤ lt.(pt − p) ,\n= (∇R(pt)−∇R(p̃t+1) η ) · (pt − p) = 1\nη\n( BR(p,pt)−BR(p, p̃t+1) +BR(pt, p̃t+1) )\n≤ 1 η\n( BR(p,pt)−BR(p,pt+1)−BR(pt+1, p̃t+1) +BR(pt, p̃t+1) ) ,\nwhere the last inequality follows from generalized pythagorean inequality (see Lemma 5.4, [Bubeck, 2011]). Summing over t = 1 . . . T , we thus get\nT∑\nt=1\n( lt.pt − lt.p ) ≤ 1\nη\n( BR(p,p1)−BR(p,pT+1) ) + 1\nη\nT∑\nt=1\n( BR(pt, p̃t+1)−BR (pt+1, p̃t+1) ) .\nNow, it can be shown that\nBR(p,p1) = R(p)−R(p1)−∇R(p1).(p − p1) ≤ R(p)−R(p1) ≤ D2 .\nThe last inequality holds since p1 := argminpin∆N R(p), which implies ∇R(p1).(p − p1) > 0 for all p ∈ ∆N . Also, we have T∑\nt=1\n( BR(pt, p̃t+1)−BR(pt+1, p̃t+1) )\n=\nT∑\nt=1\n( R(pt)−R(pt+1)−∇R(p̃t+1) · (pt − pt+1) )\n≤ T∑\nt=1\n(( ∇R(pt) · (pt − pt+1)− α\n2 ‖pt − pt+1‖∗2\n) −∇R(p̃t+1).(pt − pt+1) ) , (by strong convexity of R)\n=\nT∑\nt=1\n( − ηlt(pt) · (pt − pt+1)− α\n2 ‖pt − pt+1‖∗2\n)\n≤ T∑\nt=1\n( ηG‖pt − pt+1‖∗ − α\n2 ‖pt − pt+1‖∗2\n) , (by Hölders inequality)\n≤ T∑\nt=1\nη2G2\n2α , (since η 2G2 2α + α 2 ‖pt − pt+1‖∗2 − ηG‖pt − pt+1‖∗ = ( ηG√ 2α − √ α 2 ‖pt − pt+1‖∗ )2 ≥ 0)\n= η2G2T\n2α .\nThus, we get ∑T\nt=1\n( lt.pt − lt.p ) ≤ 1η ( D2 + η 2G2T 2α ) . Note that above bound holds for any p ∈ ∆N .\nTherefore,\nT∑\nt=1\n( lt.pt − inf\np∈∆N lt.p\n) = T∑\nt=1\n( lt.pt − N min i=1 lt(i) ) ≤ 1 η\n( D2 + η2G2T\n2α\n) .\nWhere the first equality holds since argminp∈∆N l.p ∈ {e1, e2, . . . , eN}. Note that the right-handside is minimized at η∗ = DG √ 2α T ; substituting this back in the above inequality gives the desired result."
    }, {
      "heading" : "B Proofs from Section 3",
      "text" : "1. Sparse loss space: L = {l ∈ [0, 1]N | ‖l‖0 = s}, s being the loss sparsity, 1 ≤ s ≤ N . Then using\nq-norm, R(x) = ‖x‖2q = (∑N i=1(x q i ) ) 2 q , where q = ln s ′ ln s′−1 , s ′ = (s + 1)2, as the regularizer, we get,\nRegretT ≤ 2 √ ln(s+ 1)T .\nProof. Note that 4 ≤ (s+1)2 ≤ (N +1)2. Let p = ln s′ = 2 ln(s+1). Clearly, 2 ≤ p ≤ 2 ln(N +1). Consider the norm ‖ · ‖ = 1√\n2 ‖ · ‖p, and it dual ‖ · ‖∗ = √ 2‖ · ‖q, where 1q = 1− 1p , or q = ln s ′\nln s′−1 ∈ (1, 2]. Note that:\n(a) For l ∈ L, ‖l‖ ≤ 1 (since l is at most s-sparse). Hence G = 1. (b) For any p ∈ ∆N , R(p)−R(p1) ≤ R(p) ≤ 1. HenceD = 1. (c) R(x) = ‖x‖2q is (q− 1)-strongly convex with respect to √ 2‖ · ‖q , for all x ∈ ∆N (see Lemma\n17 of Appendix A in [Shalev-Shwartz, 2007]). Hence α = (q − 1) = 1(2 ln(s+1)−1) .\nThe result now follows from an application of Theorem 3.\n2. Spherical loss space: L = {l ∈ [0, 1]N | ‖l‖A = l⊤Al ≤ ǫ}, whereA is a positive definite matrix, ǫ > 0. Then using the ellipsoidal norm R(x) = ǫx⊤A−1x, as the regularizer, we get,\nRegretT ≤ √ λmax(A−1)ǫT ,\nwhere λmax(A −1) denotes the maximum eigenvalue ofA−1.\nProof. Consider the norm ‖ · ‖ = 1√ ǫ ‖ · ‖A, where for any x ∈ RN , ‖x‖A =\n√ x⊤Ax. Note that\nthe dual norm is ‖ · ‖∗ = √ǫ‖ · ‖A−1 . In addition, we have\n(a) For any l ∈ L, ‖l‖ ≤ 1. Hence,G = 1. (b) For any p ∈ ∆N ,R(p)−R(p1) ≤ ǫp⊤A−1p ≤ ǫλmax(A−1); here, the first inequality follows\nfrom the fact thatA−1 is positive definite. HenceD = √ ǫ λmax(A−1).\n(c) R(x) = ǫx⊤A−1x is 2-strongly convex with respect to √ ǫ‖ · ‖A−1 , for all x ∈ ∆N . Hence\nα = 2.\nAs before, an application of Theorem 3 gives us the result.\n3. Noisy loss: L = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ}, ǫ > 0. Then using the standard euclidean norm R(x) = ǫ‖x‖22, as the regularizer, we get,\nRegretT ≤ √ ǫT .\nProof. Consider the norm ‖ · ‖ = 1√ ǫ ‖ · ‖2, and it dual ‖ · ‖∗ = √ ǫ‖ · ‖2. Note that:\n(a) For any l ∈ L, ‖l‖ ≤ 1. Hence G = 1. (b) For any p ∈ ∆N , R(p)−R(p1) = ǫ‖p‖22 − ǫ‖p1‖22 ≤ ǫ. HenceD = √ ǫ. (c) R(x) = ǫ‖x‖22 is 2-strongly convex with respect to √ ǫ‖ · ‖2, ∀x ∈ ∆N . Hence α = 2.\nAs before the result now follows applying Theorem 3. One can also recover this regret bound of noisy loss as a special case of spherical loss withA = A−1 = IN , since λmax(IN ) = 1.\n4. Standard loss space: L = [0, 1]n. Then using unnormalized negative entropy,R(x) = ∑Ni=1 xi log xi−∑N i=1 xi, as the regularizer, we get\nRegretT ≤ √ 2T lnN .\nProof. Consider the norm ‖ · ‖ = ‖ · ‖∞, and its dual norm ‖ · ‖∗ = ‖ · ‖1. Note that:\n(a) For any l ∈ L, ‖l‖ ≤ 1. Hence G = 1. (b) For any p ∈ ∆N , R(p)−R(p1) = ∑N i=1 pi ln ( pi p1i ) −∑Ni=1(pi − p1i) ≤ lnN (since p1 = 1N ,\nassuming 0 ln 0 = 0). HenceD = √ lnN .\n(c) R(x) = ∑N i=1 xi log xi − ∑N\ni=1 xi is 1-strongly convex with respect to ‖ · ‖1, ∀x ∈ ∆N (see example 2.5, Shalev-Shwartz [2012a]). Hence α = 1.\nThe result now follows via Theorem 3."
    }, {
      "heading" : "C Proofs from Section 4.2",
      "text" : "The proofs given in this section are based on the results given in Section B, which establish regret guarantees of the OMD algorithm for specific structured loss spaces.\nProof of Corollary 10\nCorollary 10 (Noisy Low Rank). Suppose L1 = {l ∈ [0, 1]N | l = Uv } is a d rank loss space (1 ≤ d ≤ lnN), perturbed with noisy losses L2 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ, ǫ > 0}. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = x⊤Hx + ǫ‖x‖22 and learning rate η∗ = √ 2(16d+ǫ)\nT —is upper bounded as follows\nRegretT ≤ √ 2(16d + ǫ)T .\nProof. Consider the following two convex, compact, bounded and centrally symmetric sets\nA1 = { x ∈ RN | √ x⊤H−1x ≤ 1 } , and A2 = { x ∈ RN | 1√\nǫ\n√ xTx ≤ 1 } .\nwhere H = IN + U ⊤MU, M being the matrix corresponding to the Löwner-John ellipsoid of L\n[Hazan et al., 2016]. We have ‖x‖A1 = √ x⊤H−1x, and ‖x‖A2 = 1√ǫ √ xTx, for any x ∈ RN . Clearly, L1 ⊆ A1, and L2 ⊆ A2. Consider the norm ‖ · ‖ = ‖ · ‖A, and its dual norm ‖ · ‖∗ = ‖ · ‖∗A, where A = A1 + A2. Note that, for any l ∈ L, ‖l‖A ≤ 1, since L ⊆ A. Let us choose R1(x) = x⊤Hx, and R2(x) = ǫ‖x‖22. Recall from Appendix B,\n1. R1(p)−R1(p1) ≤ D21 = 16d, and R2(p)−R2(p1) ≤ D22 = ǫ. HenceD = √ 16d + ǫ. 2. BothR1 andR2 are 2-strongly convex w.r.t. ‖x‖∗A1 = √ x⊤Hx, and ‖x‖∗A2 = √ ǫxTx respectively.\nHence α1 = α2 = 2, and α = min{α1,α2}\n2 = 1.\nThe result now follows applying Theorem 4.\nProof of Corollary 11\nCorollary 11 (Noisy Sparse). Suppose L1 = {l ∈ [0, 1]N | ‖l‖0 = s} is an s-sparse loss space (s ∈ [N ]), perturbed with noisy losses from L2 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ, ǫ > 0}. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = ‖x‖2q + ǫ‖x‖22 and learning rate η∗ = √ 1+ǫ\n(2 ln(s+1)−1)T —is upper bounded as follows\nRegretT ≤ 2 √ 2(1 + ǫ) ln(s+ 1)T .\nProof. Let s′ = (s+ 1)2, p = ln s′ = 2 ln(s+ 1). Note that 2 ≤ p ≤ 2 ln(N + 1). Consider the following two convex, compact, and centrally symmetric sets\nA1 = { x ∈ RN | 1√\n2 ‖x‖p ≤ 1\n} , and A2 = { x ∈ RN | 1√\nǫ\n√ xTx ≤ 1 } .\nWe have ‖x‖A1 = 1√2‖x‖p, and ‖x‖A2 = 1√ ǫ\n√ xTx, for any x ∈ RN . We have L1 ⊆ A1 and L2 ⊆ A2.\nConsider the norm ‖ · ‖ = ‖ · ‖A, and its dual norm ‖ · ‖∗ = ‖ · ‖∗A, where A = A1 +A2. Note that, for any l ∈ L, ‖l‖A ≤ 1, since L ⊆ A. Let us chooseR1(x) = ‖x‖2q , where 1q = 1− 1p , or q = ln s ′\nln s′−1 ∈ (1, 2], and R2(x) = ǫ‖x‖22. Recall from Appendix B,\n1. R1(p)−R1(p1) ≤ D21 = 1, and R2(p)−R2(p1) ≤ D22 = ǫ. HenceD = √ 1 + ǫ. 2. R1 is (q− 1)-strongly convex w.r.t. ‖x‖∗A1 = √ 2‖x‖q , and R2 is 2-strongly convex w.r.t. ‖x‖∗A2 =√\nǫxTx. Hence α1 = (q − 1), α2 = 2, and α = min{α1,α2}2 = (q − 1), since (q − 1) ∈ (0, 1].\nUsing Theorem 4, we get the desired claim.\nProof of Corollary 12\nCorollary 12 (Low Rank with Sparse). Suppose L1 = {l ∈ [0, 1]N | l = Uv } is a d rank loss space (1 ≤ d ≤ lnN), perturbed with s-sparse losses L2 = {l ∈ [0, 1]N | ‖l‖0 = s}, s ∈ [N ]. Then, the regret of the OMD algorithm over the loss space L = L1 + L2—with regularizer R(x) = x⊤Hx+ ‖x‖2q and learning rate η∗ = √ 16d+1\n(2 ln(s+1)−1)T —is upper bounded as follows\nRegretT ≤ 2 √ 2(16d + 1) ln(s + 1)T .\nProof. Let s′ = (s+1)2, p = ln s′ = 2 ln(s+1). Clearly, 2 ≤ p ≤ 2 ln(N+1). Also letH = IN +U⊤MU, M being the matrix corresponding to the Löwner-John ellipsoid of L; this regularizer was used in [Hazan et al., 2016]. Now consider the following two convex, compact, and centrally symmetric sets\nA1 = { x ∈ RN | √ x⊤H−1x ≤ 1 } and A2 = { x ∈ RN | 1√\nǫ\n√ xTx ≤ 1 } .\nWe have ‖x‖A1 = 1√2‖x‖p and ‖x‖A2 = 1√ ǫ\n√ xTx, for any x ∈ RN . Clearly, L1 ⊆ A1, and L2 ⊆ A2.\nConsider the norm ‖ · ‖ = ‖ · ‖A, and its dual norm ‖ · ‖∗ = ‖ · ‖∗A, where A = A1 +A2. Note that, for any l ∈ L, ‖l‖A ≤ 1, since L ⊆ A. Let us choose R1(x) = x⊤Hx, and R2(x) = ‖x‖2q , where 1q = 1− 1p , or q = ln s ′\nln s′−1 ∈ (1, 2]. Recall from Appendix B,\n1. R1(p)−R1(p1) ≤ D21 = 16d, and R2(p)−R2(p1) ≤ D22 = 2ǫ. HenceD = √ 16d+ 2ǫ. 2. R1 is 2-strongly convex w.r.t. ‖x‖∗A1 = √ x⊤Hx, andR2 is (q−1)-strongly convex w.r.t. ‖x‖∗A1 =√\n2‖x‖q . Hence α1 = 2, α2 = (q − 1), and α = min{α1,α2}2 = (q − 1), since (q − 1) ∈ (0, 1].\nAs in the previous corollaries, the claim follows by applying Theorem 4."
    }, {
      "heading" : "D Proofs from Section 5",
      "text" : "This section provides a simple generalization of a lower-bound result of Ben-David et al. [2009] for online learning of binary hypotheses classes. Then, using this generalization, it establishes Theorem 13.\nWe begin by defining the binary hypothesis learning problem and Littlestone’s dimension of a set\nof binary hypotheses.\nDefinition 21. Online Binary Hypothesis Learning Problem: For a given instance space X , binary label space Y = {0, 1}, and a class of binary hypothesis functions H = {h1, . . . , hn}, hi : X 7→ {0, 1} ∀i ∈ [n], the problem of online binary hypothesis learning is a sequential prediction game between the environment and a learner. At each iteration, the environment provides an instance xt ∈ X , and the learner’s objective is to predict its class label ŷt ∈ Ŷ = {0, 1}. At the end of T iterations, the performance of the learner is measured in terms of its number of mispredictions with respect to the best hypothesis in theH, termed as the regret of the learner, defined as follows:\nRegretT = T∑\nt=1\n|ŷt − yt| −min h∈H\nT∑\nt=1\n|h(xt)− yt|\nDefinition 22. Littlestone’s-dimension of a set of binary hypotheses (Ben-David et al. [2009]): For a binary hypothesis learning problem, letH be a non-empty class of binary hypotheses such that h : X 7→ {0, 1} for all h ∈ H, where X is the instance space. An instance-labeled tree is said to be shattered by the class H if for any root-to-leaf path (x1, y1), . . . , (xd, yd) there is some h ∈ H such that for all i ≤ d, h(xi) = yi for all i. The Littlestone’s dimension of H, Ldim(H) is the largest integer d such that there exist a full binary tree of depth d (i.e., any of its branch contains d-many non-leaf nodes) that is shattered byH.\nDefinition 23. VC-dimension of a set (Alon et al. [2014]): Let A = {a1,a2, . . . ,am} be a set of m, ddimensional vectors, ai ∈ Rd, ∀i ∈ [m]. Let C = {c1, . . . , ck} ⊆ [m] be a subset of vectors of set A. We say that A shatters C with respect to the real numbers (tc1 , . . . , tck), iff for anyD ⊆ C , there is a coordinate i ∈ [d] with A(i, c) < tc for all c ∈ D, and A(i, c) > tc for all c ∈ C \\D. Then the VC dimension of the set of vectors A, denoted by V C(A), is defined as the maximal size subset of vectors shattered by A. Clearly, V C(A) ≤ ln d.\nLet us first recall the lower-bound result of Ben-David et al. [2009] for online learning of binary\nhypotheses classes in terms of its Littlestone’s dimension.\nLemma 24. [Ben-David et al., 2009] Let X and Y = {0, 1} respectively denote the instance and label space for an online binary hypothesis learning problem, and H be a class of binary hypotheses such that h : X 7→ {0, 1} for all h ∈ H. Then for any (possibly randomized) algorithm for the classification problem, there exists a sequence of labeled instances (x1, y1), . . . , (xT , yT ) ∈ (X × Y) such that\nE\n[ T∑\nt=1\n|ŷt − yt| ] −min\nh∈H\nT∑\nt=1\n|h(xt)− yt| ≥ √\nLdim(H)T 8 ,\nwhere ŷt ∈ {0, 1} is the algorithm’s output at iteration t.\nNow suppose in the problem of binary hypothesis learning, the learner is allowed to make pre-\ndictions in { 0, 12 , 1 } , i.e. Ŷ = { 0, 12 , 1 } . We show that the lower bound guarantee of Lemma 24 holds as it is even for this problem. Formally,\nLemma 25. Let X and Y = {0, 1} respectively denote the instance and label space for an online binary hypothesis learning problem, andH be a class of binary hypotheses such that h : X 7→ { 0, 12 , 1 } for all h ∈ H. Then for any (possibly randomized) algorithm for the problem, there exists a sequence of labeled instances (x1, y1), . . . , (xT , yT ) ∈ (X × Y), such that\nE\n[ T∑\nt=1\n|ŷt − yt| ] −min\nh∈H\nT∑\nt=1\n|h(xt)− yt| ≥ √\nLdim(H)T 8 ,\nwhere ŷt ∈ { 0, 12 , 1 } is the algorithm’s output at iteration t.\nProof. Let d = Ldim(H) and, for simplicity, assume that T is an integer multiple of d, say, T = kd for some non-negative integer k. Consider a full binary H-shattered tree of depth d. We construct the sequence (x1, y1), (x2, y2), . . . , (xT , yT ) by following a root-to-leaf path (u1, z1), (u2, z2), . . . , (ud, zd) in the shattered tree. We pick the path in a top-down fashion starting at the root. The label zi ∈ {0, 1} determines whether the path moves to the left or to the right subtree of ui and it thus determines ui+1. Each node ui on the path, i ∈ [d], corresponds to a block (x(i−1)k+1, y(i−1)k+1), . . . , (xik, yik) of k examples. We define x(i−1)k+1 = x(i−1)k+2 = · · · = xik = ui, and we choose y(i−1)k+1, . . . , yik ∈ {0, 1}, independently uniformly at random. For each block, let Ti = {(i− 1)k + 1, ..., ik} be the time indices of the ith block. Denote r =\n∑ t∈Ti yt. Note that since yt ∈ {0, 1},\nmin zi∈{0, 12 ,1}\n∑ t∈Ti |zi − yt| = min zi∈{0,1} ∑ t∈Ti |zi − yt| = { k − r, if r ≥ k2 r, otherwise\nNote that the expected loss incurred by the learner in the ith block is k/2. Hence, k/2−minzi∈{0,1} ∑\nt∈Ti |zi− yt| = |r−k/2|. Taking expectations over the y’s and usingKhinchine’s inequality [Cesa-Bianchi and Lugosi, 2006], we obtain\nk/2−E   min zi∈{0,1} ∑\nt∈Ti |zi − yt|\n  = E[|r − k/2|] ≥ √ k\n8 .\nSince Ldim(H) = d, note that there exists h ∈ H, such that within each block we have h(ui) = zi. Thus by summing over the d blocks we get\ndk/2 −E [ min h∈H ∑\nt∈T |h(xt)− yt|\n] ≥ d √ k\n8 .\nFinally, since dk2 = T 2 = E[ ∑T t=1 |ŷt − yt|], we conclude that the expected regret, w.r.t. the randomness\nof choosing the labels, is at least d √\nk 8 = √ dT 8 . Therefore, there exists a particular sequence for which\nthe regret is at least √\ndT 8 , which concludes the proof.\nNote that the following corollary follows directly from Lemma 25:\nCorollary 26. Consider any s > 0. Let X and Y = {0, s} respectively denote the instance and label space for an online binary hypothesis learning problem, and H be a class of binary hypotheses such that h : X 7→\n{ 0, s2 , s } for all h ∈ H. Then for any (possibly randomized) algorithm for the problem, there exists a sequence of labeled instances (x1, y1), . . . , (xT , yT ), (xt, yt) ∈ (X × Y), for t ∈ [T ], such that\nE\n[ T∑\nt=1\n|ŷt − yt| ] −min\nh∈H\nT∑\nt=1\n|h(xt)− yt| ≥ s √\nLdim(H)T 8 ,\nwhere ŷt ∈ { 0, s2 , s } is the algorithm’s output at iteration t.\nD.1 Proof of Theorem 13\nTheorem 13 (Generic Lower Bound). Given parameters V > 0 and s > 0 along with any online learning algorithm, there exists a sequence of V -dimensional loss vectors l1, l2, . . . , lT ∈ {0,±s}N of sparsity 2V ≤ N (i.e., rank ([l1, l2, . . . , lT ]) = V and ‖lt‖0 = 2V , for all t ∈ [T ]) such that\nRegretT ≥ 2s √ V T\n8 .\nProof. We first construct a problem instance of an online binary hypothesis learning problem (see Definition 21) as follows: Let X = {e1, e2, . . . , eV } and Y = {0, s} respectively denote the instance and label space. Consider the 2V vertices of the V -dimensional binary hypercube u1,u2, . . .u2V , where ui ∈ {±1}V represents the ith vertex of the hypercube. We define a matrix U ∈ {±1, 0}N×V such that\nU(i, j) = { ui(j), ∀i ∈ [2V ], j ∈ [V ] 0, otherwise\nThat is, the first 2V rows of U are the uis and the remaining (N − 2V ) rows are all zeros. Now, let us consider the following class of hypothesis functionsH = {h1, h2, . . . hN} hi : X 7→ { 0, s2 , s } ∀i ∈ [N ], such that\nhi(ej) =    0, if U(i, j) = −1 s 2 , if U(i, j) = 0\ns, if U(i, j) = +1\nNote that Ldim(H) = V . Thus using Corollary 26 we get\nEhi∼pt\n[ T∑\nt=1\n|hi(vt)− yt| ] −min\nh∈H\nT∑\nt=1\n|h(vt)− yt| ≥ s √ V T\n8 ,\nwhere vt ∈ X is the observed instance, yt ∈ Y is the true label of vt, and pt ∈ ∆N is the distribution maintained by the algorithm over the set of N classifiers H, at iteration t. Let us denote algorithms expected prediction at time t as ŷt = ∑N i=1 pt(i)hi(vt). Note that for any y ∈ {0, s}, and v ∈ X , |hi(v)− y| = s−(2y−s).U(i,:).v2 . Now let us construct the sequence of loss vectors lt = ȳtUvt, where ȳt = (s − 2yt) ∈ {−s, s}. Note that lt ∈ { 0, s2 , s } . Since the columns of matrix U is 2V sparse and each instance vector vt ∈ {e1, . . . , eV }, we have ‖lt‖0 = 2V , for all t ∈ [T ]. In addition, since the rank of matrix U\nis V , the dimensionality constraint on the loss vectors is satisfied as well: rank ([l1, l2, . . . , lT ]) = V . Note that the regret incurred by the learner in this case is\nEhi∼pt\n[ T∑\nt=1\ns− (2yt − s)U(i, :)vt 2\n] − min\nhi∈H\nT∑\nt=1\ns− (2yt − s)U(i, :)vt 2\n≥ s √ V T\n8 .\nEquivalently,\nT∑\nt=1\nN∑\ni=1\npt(i)ȳtU(i, :)vt −min i∈N\nT∑\nt=1\nȳtU(i, :)vt ≥ 2s √ V T\n8 .\nSince lt = ȳtUvt, this further gives\nT∑\nt=1\nptlt −min i∈N\nT∑\nt=1\nlt(i) ≥ 2s √ V T\n8 .\nHence the desired result follows."
    }, {
      "heading" : "E Tight Examples for Theorem 4",
      "text" : "In this section we provide examples in which the regret guarantee of Theorem 4 is essentially tight. That is, we present loss spaces L1 and L2 such that OMD algorithm obtained via Theorem 4 provides an order-wise optimal regret guarantee for the additive loss space L = L1 + L2.\nComposition of LowRanks: LetL1 = {l ∈ [0, 1]N | l = U1v } and L2 = {l ∈ [0, 1]N | l = U2v} be loss spaces of rank d1 and d2, respectively (i.e., rank of the matricesU1 andU2 are respectively d1 and d2). Here (d1 + d2) ≤ lnN . Consider the regularizer R(x) = x⊤(H1 +H2)x, whereH1 = IN +U⊤1 M1U1, and H2 = IN +U ⊤ 2 M2U2, M1 and M2 being the Löwner John ellipsoid matrix for L1 and L2. That is, R(x) = R1(x) +R2(x), where R1(x) and R2(x) are the regularizers for L1 and L2 respectively. Theorem 4 assets that the OMD algorithm, with regularizer R, for the loss space L = L1 + L2 achieves the following regret bound:\nRegretT ≤ 4 √ 2(d1 + d2)T .\nThis regret guarantee is tight, since Rank(L) can be as high as (d1 + d2) and, hence, we get a nearly matching lower bound by applying the result of Hazan et al. [2016]; see also Remark 18 in Section 5.\nComposition of Noise Let loss spaces L1 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ1} and L2 = {l ∈ [0, 1]N | ‖l‖22 ≤ ǫ2}. Then, via an instantiation of Theorem 4, we get that the regret of the OMD algorithm over the loss space L = L1 + L2, with regularizer R(x) = (ǫ1 + ǫ2)‖x‖22 (and η∗ = √ 2(ǫ1+ǫ2) T ) is upper bounded as follows:\nRegretT ≤ √ 2(ǫ1 + ǫ2)T .\nAgain, modulo constants, this is the best possible regret guarantee for L; see Corollary 17."
    } ],
    "references" : [ {
      "title" : "Agnostic online learning",
      "author" : [ "Shai Ben-David", "Dávid Pál", "Shai Shalev-Shwartz" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Ben.David et al\\.,? \\Q2003\\E",
      "shortCiteRegEx" : "Ben.David et al\\.",
      "year" : 2003
    }, {
      "title" : "Introduction to online optimization",
      "author" : [ "NY York" ],
      "venue" : "Lecture Notes, Princeton University,",
      "citeRegEx" : "York,? \\Q2004\\E",
      "shortCiteRegEx" : "York",
      "year" : 2004
    }, {
      "title" : "Online learning with low rank experts",
      "author" : [ "Elad Hazan", "Tomer Koren", "Roi Livni", "Yishay Mansour" ],
      "venue" : null,
      "citeRegEx" : "Hazan et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Hazan et al\\.",
      "year" : 2010
    }, {
      "title" : "Online learning and online convex optimization",
      "author" : [ "Shai Shalev-Shwartz" ],
      "venue" : "Found. Trends Mach. Learn.,",
      "citeRegEx" : "Shalev.Shwartz.,? \\Q2012\\E",
      "shortCiteRegEx" : "Shalev.Shwartz.",
      "year" : 2012
    } ],
    "referenceMentions" : [ {
      "referenceID" : 2,
      "context" : "Hazan et al. [2016] show that the learner can limit her regret to O( √ dT ) when each loss vector comes from a d-dimensional subspace of RN .",
      "startOffset" : 0,
      "endOffset" : 20
    }, {
      "referenceID" : 2,
      "context" : "Specializing this result for a variety of loss function sets recovers standard OMD regret guarantees for strongly convex regularizers [Shalev-Shwartz, 2012b], and subsumes a result of Hazan et al. [2016] for the online low-rank problem.",
      "startOffset" : 184,
      "endOffset" : 204
    }, {
      "referenceID" : 2,
      "context" : "Specializing this result for a variety of loss function sets recovers standard OMD regret guarantees for strongly convex regularizers [Shalev-Shwartz, 2012b], and subsumes a result of Hazan et al. [2016] for the online low-rank problem. But more importantly, this allows us to obtain “new results from old”—regret guarantees for settings such as noisy low rank (where losses are perturbations from a low-dimensional subspace), noisy sparse (where losses are perturbations of sparse vectors), and sparse low-rank (where losses are sparse perturbations from a low-dimensional subspace); see Tables 1 and 2. Another contribution of this work is to show lower bounds on regret for the online learning problem with structured losses. We derive a generic lower bound on regret, for any algorithm for the prediction with experts problem, using structured (in terms of sparsity and dimension) loss vectors. This result allows us to derive regret lower bounds in a variety of individual and additive loss space settings including sparse, noisy, low rank, noisy low-rank, and noisy sparse losses. Related work. The work that is perhaps closest in spirit to ours is that of Hazan et al. [2016], who study the best experts problem when the loss vectors all come from a low-dimensional subspace of the ambient space.",
      "startOffset" : 184,
      "endOffset" : 1183
    }, {
      "referenceID" : 2,
      "context" : "Low-rank loss space: L = {l ∈ [0, 1]N | l = Uv }, where the rank of matrix U ∈ RN×d is equal to d ∈ [N ] and vector v ∈ Rd (as mentioned previously, such loss vectors were considered by Hazan et al. [2016]).",
      "startOffset" : 186,
      "endOffset" : 206
    }, {
      "referenceID" : 3,
      "context" : "In this section, we give a brief introduction to the Online Mirror Descent (OMD) algorithm [Bubeck, 2011; Shalev-Shwartz, 2012a], which is a subgradient descent based method for online convex optimization with a suitably chosen regularizer. A reader well-versed with the analysis of OMD may skip to the statement of Theorem 3 and proceed to Section 3. OMD generalizes the basic mirror descent algorithm used for offline optimization problems (see, e.g., Beck and Teboulle [2003]).",
      "startOffset" : 106,
      "endOffset" : 479
    }, {
      "referenceID" : 3,
      "context" : ", Shalev-Shwartz [2012a] and Bubeck [2011]) Let Ω ∈ Rn be a convex set, and f : Ω→R be a differentiable function.",
      "startOffset" : 2,
      "endOffset" : 25
    }, {
      "referenceID" : 3,
      "context" : ", Shalev-Shwartz [2012a] and Bubeck [2011]) Let Ω ∈ Rn be a convex set, and f : Ω→R be a differentiable function.",
      "startOffset" : 2,
      "endOffset" : 43
    }, {
      "referenceID" : 0,
      "context" : "The proof of this theorem appears in Appendix D and is based on a lower-bound result of Ben-David et al. [2009] for online learning of binary hypotheses classes in terms of its Littlestone’s dimension.",
      "startOffset" : 88,
      "endOffset" : 112
    }, {
      "referenceID" : 2,
      "context" : "Note that Theorem 13 (with parameter V = d, s = 1) recovers the lower bound for low rank loss spaces as established by Hazan et al. [2016]: given 1 ≤ d ≤ lnN and any online learning algorithm, there exists a sequence of d-rank loss vectors l1, l2, .",
      "startOffset" : 119,
      "endOffset" : 139
    }, {
      "referenceID" : 2,
      "context" : "The result of Hazan et al. [2016] address the noiseless version of this problem.",
      "startOffset" : 14,
      "endOffset" : 34
    } ],
    "year" : 2017,
    "abstractText" : "We consider prediction with expert advice when the loss vectors are assumed to lie in a set described by the sum of atomic norm balls. We derive a regret bound for a general version of the online mirror descent (OMD) algorithm that uses a combination of regularizers, each adapted to the constituent atomic norms. The general result recovers standard OMD regret bounds, and yields regret bounds for new structured settings where the loss vectors are (i) noisy versions of points from a low-rank subspace, (ii) sparse vectors corrupted with noise, and (iii) sparse perturbations of low-rank vectors. For the problem of online learning with structured losses, we also show lower bounds on regret in terms of rank and sparsity of the source set of the loss vectors, which implies lower bounds for the above additive loss settings as well.",
    "creator" : "LaTeX with hyperref package"
  }
}