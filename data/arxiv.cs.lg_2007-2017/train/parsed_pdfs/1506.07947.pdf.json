{
  "name" : "1506.07947.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Collaboratively Learning Preferences from Ordinal Data",
    "authors" : [ "Sewoong Oh", "Kiran K. Thekumparampil", "Jiaming Xu" ],
    "emails" : [ "swoh@illinois.edu", "thekump2@illinois.edu", "jxu18@illinois.edu" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "In many applications such as recommendation systems and revenue management, it is important to predict preferences on items that have not been seen by a user or predict outcomes of comparisons among those that have never been compared. Predicting such hidden preferences would be hopeless without further assumptions on the structure of the preference. Motivated by the success of matrix factorization models on collaborative filtering applications, we model hidden preferences with lowrank matrices to collaboratively learn preference matrices from ordinal data. In this paper, we consider the following two concrete scenarios:\n• Collaborative ranking. Consider an online market that collects each user’s preference as a ranking over a subset of items that are ‘seen’ by the user. Such data can be obtained by directly asking to compare some items, or by indirectly tracking online activities on which items are viewed, how much time is spent on the page, or how the user rated the items. In order to make personalized recommendations, we want (a) a model that captures how users who preferred similar items are also likely to have similar preferences on unseen items; and (b) to predict which items the user might prefer, by learning such models from ordinal data.\n∗Department of Industrial and Enterprise Systems Engineering, University of Illinois at Urbana-Champaign, email: swoh@illinois.edu †Department of Electrical and Computer Engineering, University of Illinois at Urbana-Champaign, e-mail: thekump2@illinois.edu ‡Statistics Department, University of Pennsylvania, e-mail: jxu18@illinois.edu\nar X\niv :1\n50 6.\n07 94\n7v 1\n[ cs\n.L G\n] 2\n6 Ju\nn 20\n• Bundled choice modeling. Discrete choice models describe how a user makes decisions on what to purchase. Typical choice models assume the willingness to buy an item is independent of what else the user bought. In many cases, however, we make ‘bundled’ purchases: we buy particular ingredients together for one recipe or we buy two connecting flights. One choice (the first flight) has a significant impact on the other (the connecting flight). In order to optimize the assortment (which flight schedules to offer) for maximum expected revenue, it is crucial to accurately predict the willingness of the consumers to purchase, based on past history. We consider a case where there are two types of products (e.g. jeans and shirts), and want (a) a model that captures such interacting preferences for pairs of items, one from each category; and (b) to predict the consumer’s choice probabilities on pairs of items, by learning such models from past purchase history.\nWe use a discrete choice model known as MultiNomial Logit (MNL) model (described in Section 2.1) to represent the preferences. In collaborative ranking context, MNL uses a low-rank matrix to represent the hidden preferences of the users. Each row corresponds to a user’s preference over all the items, and when presented with a subset of items the user provides a ranking over those items, which is a noisy version of the hidden true preference. the low-rank assumption naturally captures the similarities among users and items, by representing each on a low-dimensional space. In bundled choice modeling context, the low-rank matrix now represents how pairs of items are matched. Each row corresponds to an item from the first category and each column corresponds to an item from the second category. An entry in the matrix represents how much the pair is preferred by a randomly chosen user from a pool of users. Notice that in this case we do not model individual preferences, but the preference of the whole population. The purchase history of the population is the record of which pair was chosen among a subsets of items that were presented, which is again a noisy version of the hidden true preference. The low-rank assumption captures the similarities and dis-similarities among the items in the same category and the interactions across categories.\nContribution. A natural approach to learn such a low-rank model, from noisy observations, is to solve a convex relaxation of nuclear norm minimization (described in Section 2.2). We present such an approach for learning the MNL model from ordinal data, in two contexts: collaborative ranking and bundled choice modeling. In both cases, we analyze the sample complexity of the algorithm, and provide an upper bound on the resulting error with finite samples. We prove minimax-optimality of our approach by providing a matching information-theoretic lower bound (up to a poly-logarithmic factor). Technically, we utilize the Random Utility Model (RUM) interpretation (outlined in Section 2.1) of the MNL model to prove both the upper bound and the fundamental limit, which could be of interest to analyzing more general class of RUMs.\nRelated work. In the context of collaborative ranking, MNL models have been proposed to model partial rankings from a pool of users. Existing work is limited to the case when each user provides pair-wise comparisons [1, 2]. [2] proposes solving a convex relaxation of maximizing the likelihood over matrices with bounded nuclear norm. It is shown that this approach achieves statistically optimal generalization error rate. Our analysis techniques are inspired by [1], which proposed the convex relaxation similar to ours, but when the users provide only pair-wise comparisons. For pairwise comparisons, our main result in Theorem 3 matches those of [1], but our result is more general in the sense that we analyze more general sampling models beyond pairwise comparisons. In general, “collaborative ranking” has been used typically to refer to the problem of learning personal rankings when the data is ratings on items (as opposed to ordinal data). Matrix factorization approaches have been widely applied in practice [3, 4], but no theoretical guarantees\nare known. The remainder of the paper is organized as follows. In Section 2, we present the MNL model and propose a convex relaxation for learning the model, in the context of collaborative ranking. We provide theoretical guarantees for collaborative ranking in Section 3. In Section 4, we present the problem statement for bundled choice modeling, and analyze a similar convex relaxation approach. Notations. We use |||A|||Fand |||A|||∞to denote the Frobenius norm and the `∞ norm, |||A|||nuc =∑ i σi(A) to denote the nuclear norm where σi(A) denote the i-th singular value, and |||A|||2 = σ1(A)\nfor the spectral norm. We use 〈〈u, v〉〉 = ∑\ni uivi and ‖u‖ to denote the inner product and the Euclidean norm. All ones vector is denoted by 1 and I(A) is the indicator function of the event A. The set of the fist N integers are denoted by [N ] = {1, . . . , N}."
    }, {
      "heading" : "2 Model and Algorithm",
      "text" : "In this section, we present a discrete choice modeling for collaborative ranking, and propose an inference algorithm for learning the model from ordinal data."
    }, {
      "heading" : "2.1 MultiNomial Logit (MNL) model for comparative judgment",
      "text" : "In collaborative ranking, we want to model how people who have similar preferences on a subset of items are likely to have similar tastes on other items as well. When users provide ratings, as in collaborative filtering applications, matrix factorization models are widely used since the low-rank structure captures the similarities between users. When users provide ordered preferences, we use a discrete choice model known as MultiNomial Logit (MNL) model that has a similar low-rank structure that captures the similarities between users and items.\nLet Θ∗ be the d1×d2 dimensional matrix capturing the preference of d1users on d2 items, where the rows and columns correspond to users and items, respectively. Typically, Θ∗ is assumed to be low-rank, having a rank r that is much smaller than the dimensions. However, in the following we allow a more general setting where Θ∗ might be only approximately low rank. When a user i is presented with a set of alternatives Si ⊆ [d2], she reveals her preferences as a ranked list over those items. To simplify the notations we assume all users compare the same number k of items, but the analysis naturally generalizes to the case when the size might differ from a user to a user. Let vi,` ∈ Si denote the (random) `-th best choice of user i. Each user gives a ranking, independent of other users’ rankings, from\nP {vi,1, . . . , vi,k} = k∏ `=1 e Θ∗i,vi,`∑ j∈Si,` e Θ∗i,j , (1)\nwhere with Si,` ≡ Si \\ {vi,1, . . . , vi,`−1}. For a single user i, the i-th row of Θ∗ represents the underlying preference vector of the user, and the more preferred items are more likely to be ranked higher. The probabilistic nature of the model captures the noise in the users revealed preferences.\nThe random utility model (RUM), pioneered by [5, 6, 7], describes the choices of users as manifestations of the underlying utilities. The MNL models is a special case of RUM where each decision maker and each alternative are represented by a r-dimensional feature vectors ui and vj respectively, such that Θ∗ij = 〈〈ui, vj〉〉, resulting in a low-rank matrix. When presented with a set of\nalternatives Si, the decision maker i ranks the alternatives according to their random utility drawn from\nUij = 〈〈ui, vj〉〉+ ξij , (2)\nfor item j, where ξij follow the standard Gumbel distribution. Intuitively, this provides a justification for the MNL model as modeling the decision makers as rational being, seeking to maximize utility. Technically, this RUM interpretation plays a crucial role in our analysis, in proving restricted strong convexity in Appendix A.4 and also in proving fundamental limit in Appendix C.\nThere are a few cases where the Maximum Likelihood (ML) estimation for RUM is tractable. One notable example is the Plackett-Luce (PL) model, which is a special case of the MNL model where Θ∗ is rank-one and all users have the same features. PL model has been widely applied in econometrics [8], analyzing elections [9], and machine learning [10]. Efficient inference algorithms has been proposed [11, 12, 13], and the sample complexity has been analyzed for the MLE [14] and for the Rank Centrality [15]. Although PL is quite restrictive, in the sense that it assumes all users share the same features, little is known about inference in RUMs beyond PL. Recently, to overcome such a restriction, mixed PL models have been studied, where Θ∗ is rank-r but there are only r classes of users and all users in the same class have the same features. Efficient inference algorithms with provable guarantees have been proposed by applying recent advances in tensor decomposition methods [16, 17], directly clustering the users [18, 19], or using sampling methods [20]. However, this mixture PL is still restrictive, and both clustering and tensor based approaches rely heavily on the fact that the distribution is a “mixture” and require additional incoherence assumptions on Θ∗. For more general models, efficient inference algorithms have been proposed [21] but no performance guarantee is known for finite samples. Although the MLE for the general MNL model in (1) is intractable, we provide a polynomial-time inference algorithm with provable guarantees."
    }, {
      "heading" : "2.2 Nuclear norm minimization",
      "text" : "Assuming Θ∗ is well approximated by a low-rank matrix, we estimate Θ∗ by solving the following convex relaxation given the observed preference in the form of ranked lists {(vi,1, . . . , vi,k)}i∈[d1].\nΘ̂ ∈ arg min Θ∈Ω L(Θ) + λ|||Θ|||nuc, (3)\nwhere the (negative) log likelihood function according to (1) is\nL(Θ) = − 1 k d1 d1∑ i=1 k∑ `=1 〈〈Θ, eieTvi,`〉〉 − log ∑ j∈Si,` exp ( 〈〈Θ, eieTj 〉〉 ) , (4) with Si = {vi,1, . . . , vi,k} and Si,` ≡ Si \\ {vi,1, . . . , vi,`−1}, and appropriately chosen set Ω defined in (7). Since nuclear norm is a tight convex surrogate for the rank, the above optimization searches for a low-rank solution that maximizes the likelihood. Nuclear norm minimization has been widely used in rank minimization problems [22], but provable guarantees typically exists only for quadratic loss function L(Θ) [23, 24]. Our analysis extends such analysis techniques to identify the conditions under which restricted strong convexity is satisfied for a convex loss function that is not quadratic.\n3 Collaborative ranking from k-wise comparisons\nWe first provide background on the MNL model, and then present main results on the performance guarantees. Notice that the distribution (1) is independent of shifting each row of Θ∗ by a constant. Hence, there is an equivalent class of Θ∗ that gives the same distributions for the ranked lists:\n[Θ∗] = {A ∈ Rd1×d2 | A = Θ∗ + u1T for some u ∈ Rd1} . (5)\nSince we can only estimate Θ∗ up to this equivalent class, we search for the one whose rows sum to zero, i.e. ∑ j∈[d2] Θ ∗ i,j = 0 for all i ∈ [d1]. Let α ≡ maxi,j1,j2 |Θ∗ij1 −Θ ∗ ij2 | denote the dynamic range of the underlying Θ∗, such that when k items are compared, we always have\n1 k e−α ≤ P {vi,1 = j} ≤ 1 k eα , (6)\nfor all j ∈ Si, all Si ⊆ [d2] satisfying |Si| = k and all i ∈ [d1]. We do not make any assumptions on α other than that α = O(1) with respect to d1 and d2. The purpose of defining the dynamic range in this way is that we seek to characterize how the error scales with α. Given this definition, we solve the optimization in (3) over\nΩα = { A ∈ Rd1×d2 ∣∣ |||A|||∞ ≤ α, and ∀i ∈ [d1] we have ∑ j∈[d2] Aij = 0 } . (7)\nWhile in practice we do not require the `∞ norm constraint, we need it for the analysis. For a related problem of matrix completion, where the loss L(θ) is quadratic, either a similar condition on `∞ norm is required or a different condition on incoherence is required."
    }, {
      "heading" : "3.1 Performance guarantee",
      "text" : "We provide an upper bound on the resulting error of our convex relaxation, when a multi-set of items Si presented to user i is drawn uniformly at random with replacement. Precisely, for a given k, Si = {ji,1, . . . , ji,k} where ji,`’s are independently drawn uniformly at random over the d2 items. Further, if an item is sampled more than once, i.e. if there exists ji,`1 = ji,`2 for some i and `1 6= `2, then we assume that the user treats these two items as if they are two distinct items with the same MNL weights Θ∗i,ji,`1 = Θ∗i,ji,`2 .The resulting preference is therefore always over k items (with possibly multiple copies of the same item), and distributed according to (1). For example, if k = 3, it is possible to have Si = {ji,1 = 1, ji,2 = 1, ji,3 = 2}, in which case the resulting ranking can be (vi,1 = ji,1, vi,2 = ji,3, vi,3 = ji,2) with probability (e Θ∗i,1)/(2 eΘ ∗ i,1 + eΘ ∗ i,2) × (eΘ ∗ i,2)/(eΘ ∗ i,1 + eΘ ∗ i,2). Such sampling with replacement is necessary for the analysis, where we require independence in the choice of the items in Si in order to apply the symmetrization technique (e.g. [25]) to bound the expectation of the deviation (cf. Appendix A.4). Similar sampling assumptions have been made in existing analyses on learning low-rank models from noisy observations, e.g. [24]. Let d ≡ (d1 + d2)/2, and let σj(Θ∗) denote the j-th singular value of the matrix Θ∗. Define\nλ0 ≡ e2α √ d1 log d+ d2(log d)2\nk d21 d2 .\nTheorem 1. Under the described sampling model, assume 24 ≤ k ≤ min{d21, (d21 +d22)/(2d1)} log d, and λ ∈ [32λ0, c0λ0] with any constant c0 = O(1) larger than 32. Then, solving the optimization (3) achieves\n1\nd1d2\n∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣2 F ≤ 288 √ 2 e4αc0λ0 √ r ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F + 288e4αc0λ0 min{d1,d2}∑ j=r+1 σj(Θ ∗) , (8)\nfor any r ∈ {1, . . . ,min{d1, d2}} with probability at least 1− 2d−3 where d = (d1 + d2)/2.\nA proof is provided in Appendix A. The above bound shows a natural splitting of the error into two terms, one corresponding to the estimation error for the rank-r component and the second one corresponding to the approximation error for how well one can approximate Θ∗ with a rank-r matrix. This bound holds for all values of r and one could potentially optimize over r. We show such results in the following corollaries.\nCorollary 3.1 (Exact low-rank matrices). Suppose Θ∗ has rank at most r. Under the hypotheses of Theorem 1, solving the optimization (3) with the choice of the regularization parameter λ ∈ [32λ0, c0λ0] achieves with probability at least 1− 2d−3,\n1√ d1d2 ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ≤ 288 √ 2e6αc0\n√ r(d1 log d+ d2(log d)2)\nk d1 . (9)\nThe number of entries is d1d2 and we rescale the Frobenius norm error appropriately by 1/ √ d1d2. When Θ∗ is a rank-r matrix, then the degrees of freedom in representing Θ∗ is r(d1 + d2) − r2 = O(r(d1 + d2)). The above theorem shows that the total number of samples, which is (k d1), needs to scale as O(rd1(log d) + rd2(log d)\n2) in order to achieve an arbitrarily small error. This is only poly-logarithmic factor larger than the degrees of freedom. In Section 3.2, we provide a lower bound on the error directly, that matches the upper bound up to a logarithmic factor.\nThe dependence on the dynamic range α, however, is sub-optimal. It is expected that the error increases with α, since the Θ∗ scales as α, but the exponential dependence in the bound seems to be a weakness of the analysis, as seen from numerical experiments in the right panel of Figure 1. Although the error increase with α, numerical experiments suggests that it only increases at most linearly. However, tightening the scaling with respect to α is a challenging problem, and such sub-optimal dependence is also present in existing literature for learning even simpler models, such as the Bradley-Terry model [15] or the Plackett-Luce model [14], which are special cases of the MNL model studied in this paper. A practical issue in achieving the above rate is the choice of λ, since the dynamic range α is not known in advance. Figure 1 illustrates that the error is not sensitive to the choice of λ for a wide range.\nAnother issue is that the underlying matrix might not be exactly low rank. It is more realistic to assume that it is approximately low rank. Following [24] we formalize this notion with “`q-ball” of matrices defined as\nBq(ρq) ≡ {Θ ∈ Rd1×d2 | ∑\nj∈[min{d1,d2}]\n|σj(Θ∗)|q ≤ ρq} . (10)\nWhen q = 0, this is a set of rank-ρ0 matrices. For q ∈ (0, 1], this is set of matrices whose singular values decay relatively fast. Optimizing the choice of r in Theorem 1, we get the following result.\nCorollary 3.2 (Approximately low-rank matrices). Suppose Θ∗ ∈ Bq(ρq) for some q ∈ (0, 1] and ρq > 0. Under the hypotheses of Theorem 1, solving the optimization (3) with the choice of the regularization parameter λ ∈ [32λ0, c0λ0] achieves with probability at least 1− 2d−3,\n1√ d1d2 ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ≤ 2 √ ρq√ d1d2 288√2c0e6α √ d1d2(d1 log d+ d2(log d)2) k d1  2−q 2 . (11)\nThis is a strict generalization of Corollary 3.1. For q = 0 and ρ0 = r, this recovers the exact low-rank estimation bound up to a factor of two. For approximate low-rank matrices in an `q-ball, we lose in the error exponent, which reduces from one to (2 − q)/2. A proof of this Corollary is provided in Appendix B.\nThe left panel of Figure 1 confirms the scaling of the error rate as predicted by Corollary 3.1. The lines merge to a single line when the sample size is rescaled appropriately. We make a choice of λ = (1/2) √ (log d)/(kd2), This choice is independent of α and is smaller than proposed in Theorem 1. We generate random rank-r matrices of dimension d × d, where Θ∗ = UV T with U ∈ Rd×r and V ∈ Rd×r entries generated i.i.d from uniform distribution over [0, 1]. Then the row-mean is subtracted form each row, and then the whole matrix is scaled such that the largest entry is α = 5. The root mean squared error (RMSE) is plotted where RMSE = (1/d)|||Θ∗ − Θ̂|||F. We implement and solve the convex optimization (3) using proximal gradient descent method as analyzed in [26]. The right panel in Figure 1 illustrates that the actual error is insensitive to the choice of λ for a broad range of λ ∈ [ √ (log d)/(kd2), 28 √ (log d)/(kd2)], after which it increases with λ."
    }, {
      "heading" : "3.2 Information-theoretic lower bound for low-rank matrices",
      "text" : "For a polynomial-time algorithm of convex relaxation, we gave in the previous section a bound on the achievable error. We next compare this to the fundamental limit of this problem, by giving\na lower bound on the achievable error by any algorithm (efficient or not). A simple parameter counting argument indicates that it requires the number of samples to scale as the degrees of freedom i.e., kd1 ∝ r(d1 + d2), to estimate a d1 × d2 dimensional matrix of rank r. We construct an appropriate packing over the set of low-rank matrices with bounded entries in Ωα defined as (7), and show that no algorithm can accurately estimate the true matrix with high probability using the generalized Fano’s inequality. This provides a constructive argument to lower bound the minimax error rate, which in turn establishes that the bounds in Theorem 1 is sharp up to a logarithmic factor, and proves no other algorithm can significantly improve over the nuclear norm minimization.\nTheorem 2. Suppose Θ∗ has rank r. Under the described sampling model, for large enough d1 and d2 ≥ d1, there is a universal numerical constant c > 0 such that\ninf Θ̂ sup Θ∗∈Ωα\nE [ 1√\nd1d2\n∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ] ≥ c min { αe−α √ r d2 k d1 , αd2√ d1d2 log d } , (12)\nwhere the infimum is taken over all measurable functions over the observed ranked lists {(vi,1, . . . , vi,k)}i∈[d1].\nA proof of this theorem is provided in Appendix C. The term of primary interest in this bound is the first one, which shows the scaling of the (rescaled) minimax rate as √ r(d1 + d2)/(kd1) (when d2 ≥ d1), and matches the upper bound in (8). It is the dominant term in the bound whenever the number of samples is larger than the degrees of freedom by a logarithmic factor, i.e., kd1 > r(d1 + d2) log d, ignoring the dependence on α. This is a typical regime of interest, where the sample size is comparable to the latent dimension of the problem. In this regime, Theorem 2 establishes that the upper bound in Theorem 1 is minimax-optimal up to a logarithmic factor in the dimension d."
    }, {
      "heading" : "4 Choice modeling for bundled purchase history",
      "text" : "In this section, we use the MNL model to study another scenario of practical interest: choice modeling from bundled purchase history. In this setting, we assume that we have bundled purchase history data from n users. Precisely, there are two categories of interest with d1 and d2 alternatives in each category respectively. For example, there are d1 tooth pastes to choose from and d2 tooth brushes to choose from. For the i-th user, a subset Si ⊆ [d1] of alternatives from the first category is presented along with a subset Ti ⊆ [d2] of alternatives from the second category. We use k1 and k2 to denote the number of alternatives presented to a single user, i.e. k1 = |Si| and k2 = |Ti|, and we assume that the number of alternatives presented to each user is fixed, to simplify notations. Given these sets of alternatives, each user makes a ‘bundled’ purchase and we use (ui, vi) to denote the bundled pair of alternatives (e.g. a tooth brush and a tooth paste) purchased by the i-th user. Each user makes a choice of the best alternative, independent of other users’s choices, according to the MNL model as\nP {(ui, vi) = (j1, j2)} = e Θ∗j1,j2∑ j′1∈Si,j′2∈Ti e Θ∗ j′1,j ′ 2 , (13)\nfor all j1 ∈ Si and j2 ∈ Ti. The distribution (13) is independent of shifting all the values of Θ∗ by a constant. Hence, there is an equivalent class of Θ∗ that gives the same distribution for the choices: [Θ∗] ≡ {A ∈ Rd1×d2 |A = Θ∗ + c11T for some c ∈ R} . Since we can only estimate Θ∗ up to this equivalent class, we search for the one that sum to zero, i.e. ∑ j1∈[d1],j2∈[d2] Θ ∗ j1,j2\n= 0. Let α = maxj1,j′1∈[d1],j2,j′2∈[d2] |Θ ∗ j1,j2 −Θ∗j′1,j′2 |, denote the dynamic range of the underlying Θ ∗, such that when k1 × k2 alternatives are presented, we always have\n1\nk1k2 e−α ≤ P {(ui, vi) = (j1, j2)} ≤\n1\nk1k2 eα , (14)\nfor all (j1, j2) ∈ Si × Ti and for all Si ⊆ [d1] and Ti ⊆ [d2] such that |Si| = k1 and |Ti| = k2. We do not make any assumptions on α other than that α = O(1) with respect to d1 and d2. Assuming Θ∗ is well approximate by a low-rank matrix, we solve the following convex relaxation, given the observed bundled purchase history {(ui, vi, Si, Ti)}i∈[n]:\nΘ̂ ∈ arg min Θ∈Ω′α L(Θ) + λ|||Θ|||nuc , (15)\nwhere the (negative) log likelihood function according to (13) is\nL(Θ) = − 1 n n∑ i=1 〈〈Θ, euieTvi〉〉 − log  ∑ j1∈Si,j2∈Ti exp ( 〈〈Θ, ej1eTj2〉〉 ) , and (16) Ω′α ≡ { A ∈ Rd1×d2\n∣∣ |||A|||∞ ≤ α, and ∑ j1∈[d1],j2∈[d2] Aj1,j2 = 0 } . (17)\nCompared to collaborative ranking, (a) rows and columns of Θ∗ correspond to an alternative from the first and second category, respectively; (b) each sample corresponds to the purchase choice of a user which follow the MNL model with Θ∗; (c) each person is presented subsets Si and Ti of items from each category; (d) each sampled data represents the most preferred bundled pair of alternatives."
    }, {
      "heading" : "4.1 Performance guarantee",
      "text" : "We provide an upper bound on the error achieved by our convex relaxation, when the multi-set of alternatives Si from the first category and Ti from the second category are drawn uniformly at random with replacement from [d1] and [d2] respectively. Precisely, for given k1 and k2, we let Si = {j(i)1,1, . . . , j (i) 1,k1 } and Ti = {j(i)2,1, . . . , j (i) 2,k2 }, where j(i)1,`’s and j (i) 2,`’s are independently drawn uniformly at random over the d1 and d2 alternatives, respectively. Similar to the previous section, this sampling with replacement is necessary for the analysis. Define\nλ1 =\n√ e2α max{d1, d2} log d\nn d1 d2 . (18)\nTheorem 3. Under the described sampling model, assume 16e2α min{d1, d2} log d ≤ n ≤ min{d5, k1k2 max{d21, d22}} log d, and λ ∈ [8λ1, c1λ1] with any constant c1 = O(1) larger than max{8, 128/ √ min{k1, k2}}. Then,\nsolving the optimization (15) achieves\n1\nd1d2\n∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣2 F ≤ 48 √ 2 e2αc1λ1 √ r ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F + 48e2αc1λ1 min{d1,d2}∑ j=r+1 σj(Θ ∗) , (19)\nfor any r ∈ {1, . . . ,min{d1, d2}} with probability at least 1− 2d−3 where d = (d1 + d2)/2.\nA proof is provided in Appendix D. Optimizing over r gives the following corollaries.\nCorollary 4.1 (Exact low-rank matrices). Suppose Θ∗ has rank at most r. Under the hypotheses of Theorem 3, solving the optimization (15) with the choice of the regularization parameter λ ∈ [8λ1, c1λ1] achieves with probability at least 1− 2d−3,\n1√ d1d2 ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ≤ 48 √ 2e3αc1 √ r(d1 + d2) log d n . (20)\nThis corollary shows that the number of samples n needs to scale as O(r(d1 +d2) log d) in order to achieve an arbitrarily small error. This is only a logarithmic factor larger than the degrees of freedom. We provide a fundamental lower bound on the error, that matches the upper bound up to a logarithmic factor. For approximately low-rank matrices in an `1-ball as defined in (10), we show an upper bound on the error, whose error exponent reduces from one to (2− q)/2.\nCorollary 4.2 (Approximately low-rank matrices). Suppose Θ∗ ∈ Bq(ρq) for some q ∈ (0, 1] and ρq > 0. Under the hypotheses of Theorem 3, solving the optimization (15) with the choice of the regularization parameter λ ∈ [8λ1, c1λ1] achieves with probability at least 1− 2d−3,\n1√ d1d2 ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ≤ 2 √ ρq√ d1d2 ( 48 √ 2c1e 3α √ d1d2(d1 + d2) log d n ) 2−q 2 . (21)\nSince the proof is almost identical to the proof of Corollary 3.2 in Appendix B, we omit it.\nTheorem 4. Suppose Θ∗ has rank r. Under the described sampling model, there is a universal constant c > 0 such that\ninf Θ̂ sup Θ∗∈Ωα\nE [ 1√\nd1d2\n∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣ F ] ≥ c min {√ e−5α r (d1 + d2) n , α(d1 + d2)√ d1d2 log d } , (22)\nwhere the infimum is taken over all measurable functions over the observed purchase history {(ui, vi, Si, Ti)}i∈[n].\nA proof is provided in Appendix E.1. The first term is the dominant term, and when the sample size is comparable to the latent dimension of the problem, this theorem establishes that Theorem 3 is minimax optimal up to a logarithmic factor."
    }, {
      "heading" : "5 Discussion",
      "text" : "We list remaining challenges for future research. (a) Nuclear norm minimization, while polynomialtime, is still slow. We want first-order methods that are efficient with provable guarantees. The main challenge is providing a good initialization to start such non-convex approaches. (b) For simpler models, such as the PL model, more general sampling over a graph has been studied. We want analytical results for more general sampling."
    }, {
      "heading" : "Appendix",
      "text" : ""
    }, {
      "heading" : "A Proof of Theorem 1",
      "text" : "We first introduce some additional notations used in the proof. Recall that L(Θ) is the log likelihood function. Let ∇L(Θ) ∈ Rd1×d2 denote its gradient such that ∇ijL(Θ) = ∂L(Θ)∂Θij . Let ∇ 2L(Θ) ∈ Rd1d2×d1d2 denote its Hessian matrix such that ∇2ij,i′j′L(Θ) = ∂2L(Θ) ∂Θij∂Θi′j′ . By the definition of L(Θ) in (4), we have\n∇L(Θ∗) = − 1 k d1 d1∑ i=1 k∑ `=1 ei(evi,` − pi,`) T , (23)\nwhere pi,` denotes the conditional choice probability at `-th position. Precisely, pi,` = ∑\nj∈Si,` pj|(i,`)ej where pj|(i,`) is the probability that item j is chosen at `-th position from the top by the user i condi-\ntioned on the top `−1 choices such that pj|(i,`) ≡ P {vi,` = j|vi,1, . . . , vi,`−1, Si} = eΘ ∗ ij/( ∑ j′∈Si,` e Θij′ ) and Si,` ≡ Si \\ {vi,1, . . . , vi,`−1}, where Si is the set of alternatives presented to the i-th user and vi,` is the item ranked at the `-th position by the user i. Notice that for i 6= i′, ∂\n2L(Θ) ∂Θij∂Θi′j′ = 0 and\nthe Hessian is\n∂2L(Θ) ∂Θij∂Θij′ = 1 k d1 k∑ `=1 I ( j ∈ Si,` )∂pj|(i,`) ∂Θij′\n= 1\nk d1 k∑ `=1 I ( j, j′ ∈ Si,` ) ( pj|(i,`)I(j = j′)− pj|(i,`)pj′|(i,`) ) . (24)\nThis Hessian matrix is a block-diagonal matrix ∇2L(Θ) = diag(H(1)(Θ), . . . ,H(d1)(Θ)) with\nH(i)(Θ) = 1\nk d1 k∑ `=1 ( diag(pi,`)− pi,`pTi,` ) . (25)\nLet ∆ = Θ∗−Θ̂ where Θ̂ is the optimal solution of the convex program in (3). We first introduce three key technical lemmas. The first lemma follows from Lemma 1 of [24], and shows that ∆ is approximately low-rank.\nLemma A.1. If λ ≥ 2|||∇L(Θ∗)|||2, then we have\n|||∆|||nuc ≤ 4 √ 2r|||∆|||F + 4 min{d1,d2}∑ j=ρ+1 σj(Θ ∗) , (26)\nfor all ρ ∈ [min{d1, d2}].\nThe following lemma provides a bound on the gradient using the concentration of measure for sum of independent random matrices [27].\nLemma A.2. For any positive constant c ≥ 1 and log d ≥ 4(1 + c)/9, with probability at least 1− 2d−c,\n‖∇L(Θ∗)‖2 ≤\n√ 4(1 + c) log d\nk d21 max\n{√ d1/d2 , e 2α √ 4(1 + c) log d } . (27)\nSince we are typically interested in the regime where the number of samples is much smaller than the dimension d1 × d2 of the problem, the Hessian is typically not positive definite. However, when we restrict our attention to the vectorized ∆ with relatively small nuclear norm, then we can prove restricted strong convexity, which gives the following bound.\nLemma A.3 (Restricted Strong Convexity for collaborative ranking). Fix any Θ ∈ Ωα and assume 24 ≤ k ≤ min{d21, (d21 + d22)/(2d1)} log d. Under the random sampling model of the alternatives {ji`}i∈[d1],`∈[k] and the random outcome of the comparisons described in section 1, with probability larger than 1− 2d−218,\nVec(∆)T ∇2L(Θ) Vec(∆) ≥ e −4α\n24 d1d2 |||∆|||2F , (28)\nfor all ∆ in A where A = { ∆ ∈ Rd1×d2 ∣∣ |||∆|||∞ ≤ 2α , ∑\nj∈[d2]\n∆ij = 0 for all i ∈ [d1] and |||∆|||2F ≥ µ|||∆|||nuc } . (29)\nwith\nµ ≡ 210 e2α αd2\n√ d1 log d\nk min{d1, d2} . (30)\nBuilding on these lemmas, the proof of Theorem 1 is divided into the following two cases. In both cases, we will show that\n|||∆|||2F ≤ 72 e 4αc0λ0 d1d2 |||∆|||nuc , (31)\nwith high probability. Applying Lemma A.1 proves the desired theorem. We are left to show Eq. (31) holds.\nCase 1: Suppose |||∆|||2F ≥ µ |||∆|||nuc. With ∆ = Θ∗ − Θ̂, the Taylor expansion yields\nL(Θ̂) = L(Θ∗)− 〈〈∇L(Θ∗),∆〉〉+ 1 2 Vec(∆)∇2L(Θ)VecT (∆), (32)\nwhere Θ = aΘ̂ + (1− a)Θ∗ for some a ∈ [0, 1]. It follows from Lemma A.3 that with probability at least 1− 2d−218 ,\nL(Θ̂)− L(Θ∗) ≥ −〈〈∇L(Θ∗),∆〉〉+ e −4α\n48 d1 d2 |||∆|||2F\n≥ −|||∇L(Θ∗)|||2|||∆|||nuc + e−4α\n48 d1 d2 |||∆|||2F .\nFrom the definition of Θ̂ as an optimal solution of the minimization, we have L(Θ̂)− L(Θ∗) ≤ λ ( |||Θ∗|||nuc − ∣∣∣∣∣∣∣∣∣Θ̂∣∣∣∣∣∣∣∣∣ nuc ) ≤ λ|||∆|||nuc .\nBy the assumption, we choose λ ≥ 32λ0. In view of Lemma A.2, this implies that λ ≥ 2|||∇L(Θ∗)|||2 with probability at least 1− 2d−3. It follows that with probability at least 1− 2d−3 − 2d−218 ,\ne−4α\n48d1d2 |||∆|||2F ≤\n( λ+ |||∇L(Θ∗)|||2 ) |||∆|||nuc ≤ 3λ\n2 |||∆|||nuc .\nBy our assumption on λ ≤ c0λ0, this proves the desired bound in Eq. (31) Case 2: Suppose |||∆|||2F ≤ µ |||∆|||nuc. By the definition of µ and the fact that c0 ≥ 32, it follows that µ ≤ 72 e4αc0λ0 d1d2, and we get the same bound as in Eq. (31)."
    }, {
      "heading" : "A.1 Proof of Lemma A.1",
      "text" : "Denote the singular value decomposition of Θ∗ by Θ∗ = UΣV T , where U ∈ Rd1×d1 and V ∈ Rd2×d2 are orthogonal matrices. For a given r ∈ [min{d1, d2}], Let Ur = [u1, . . . , ur] and Vr = [v1, . . . , vr], where ui ∈ Rd1×1 and vi ∈ Rd2×1 are the left and right singular vectors corresponding to the i-th largest singular value, respectively. Define T to be the subspace spanned by all matrices in Rd1×d2 of the form UrA\nT or BV Tr for any A ∈ Rd2×r or B ∈ Rd1×r, respectively. The orthogonal projection of any matrix M ∈ Rd1×d2 onto the space T is given by PT (M) = UrUTr M +MVrV Tr −UrUTr MVrV Tr . The projection of M onto the complement space T⊥ is PT⊥(M) = (I − UrUTr )M(I − VrV Tr ). The subspace T and the respective projections onto T and T⊥ play crucial a role in the analysis of nuclear norm minimization, since they define the sub-gradient of the nuclear norm at Θ∗. We refer to [23] for more detailed treatment of this topic.\nLet ∆′ = PT (∆) and ∆′′ = PT⊥(∆). Notice that PT (Θ∗) = UrΣrV Tr , where Σr ∈ Rr×r is the diagonal matrix formed by the top r singular values. Since PT (Θ∗) and ∆′′ have row and column spaces that are orthogonal, it follows from Lemma 2.3 in [22] that∣∣∣∣∣∣PT (Θ∗)−∆′′∣∣∣∣∣∣nuc = |||PT (Θ∗)|||nuc + ∣∣∣∣∣∣∆′′∣∣∣∣∣∣nuc . Hence, in view of the triangle inequality,∣∣∣∣∣∣∣∣∣Θ̂∣∣∣∣∣∣∣∣∣ nuc = ∣∣∣∣∣∣PT (Θ∗) + PT⊥(Θ∗)−∆′ −∆′′∣∣∣∣∣∣nuc\n≥ ∣∣∣∣∣∣PT (Θ∗)−∆′′∣∣∣∣∣∣nuc − ∣∣∣∣∣∣PT⊥(Θ∗)−∆′∣∣∣∣∣∣nuc\n= |||PT (Θ∗)|||nuc + ∣∣∣∣∣∣∆′′∣∣∣∣∣∣ nuc − ∣∣∣∣∣∣PT⊥(Θ∗)−∆′∣∣∣∣∣∣nuc\n≥ |||PT (Θ∗)|||nuc + ∣∣∣∣∣∣∆′′∣∣∣∣∣∣ nuc − |||PT⊥(Θ∗)|||nuc − ∣∣∣∣∣∣∆′∣∣∣∣∣∣ nuc\n= |||Θ∗|||nuc + ∣∣∣∣∣∣∆′′∣∣∣∣∣∣ nuc − 2|||PT⊥(Θ∗)|||nuc − ∣∣∣∣∣∣∆′∣∣∣∣∣∣ nuc . (33)\nBecause Θ̂ is an optimal solution, we have\nλ (∣∣∣∣∣∣∣∣∣Θ̂∣∣∣∣∣∣∣∣∣\nnuc − |||Θ∗|||nuc\n) ≤ L(Θ∗)− L(Θ̂) (a) ≤ 〈〈∆,∇L(Θ∗)〉〉 (b)\n≤ |||∆|||nuc|||∇L(Θ ∗)|||2 ≤\nλ 2 |||∆|||nuc,\n(34)\nwhere (a) holds due to the concavity of L; (b) follows from the Cauchy-Schwarz inequality; the last inequality holds due to the assumption that λ ≥ 2|||∇L(Θ∗)|||2. Combining (33) and (34) yields\n2 (∣∣∣∣∣∣∆′′∣∣∣∣∣∣\nnuc − 2|||PT⊥(Θ∗)|||nuc − ∣∣∣∣∣∣∆′∣∣∣∣∣∣ nuc ) ≤ |||∆|||nuc ≤ ∣∣∣∣∣∣∆′∣∣∣∣∣∣ nuc + ∣∣∣∣∣∣∆′′∣∣∣∣∣∣ nuc .\nThus |||∆′′|||nuc ≤ 3|||∆′|||nuc + 4|||PT⊥(Θ∗)|||nuc. By triangle inequality,\n|||∆|||nuc ≤ 4 ∣∣∣∣∣∣∆′∣∣∣∣∣∣ nuc + 4|||PT⊥(Θ∗)|||nuc .\nNotice that ∆′ = UrU T r ∆ + (I − UrUTr )∆VrV Tr . Both UrUTr ∆ and (I − UrUTr )∆VrV Tr have rank\nat most r. Thus ∆′ has rank at most 2r. Hence, |||∆′|||nuc ≤ √ 2r|||∆′|||F ≤ √\n2r|||∆|||F. Then the theorem follows because |||PT⊥(Θ∗)|||nuc = ∑min{d1,d2} j=r+1 σj(Θ ∗)."
    }, {
      "heading" : "A.2 Proof of Lemma A.2",
      "text" : "Define Xi = −ei ∑k\n`=1(evi,` − pi,`)T such that ∇L(Θ∗) = 1 k d1 ∑d1 i=1Xi, which is a sum of d1 inde-\npendent random matrices. Note that since pi,` has (k + 1 − `) non-zero entries, each bounded in absolute value by e2α/(k + 1− `), we have the following bound deterministically:\n|||Xi|||2 = ∥∥∥ k∑ `=1 ( evi,` − pi,` )∥∥∥ ≤ √ k +\nk∑ `=1 ∥∥∥pi,`∥∥∥ ≤ √ k + e2α\nk∑ `=1 1√ k + 1− `\n≤ √ k + e2α2( √ k + 1− 1) ≤ 3e2α √ k ,\nand ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣∑ i E [ XiX T i ]∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ 2 ≤ 9e4αk ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ d1∑ i=1 E [ eie T i ]∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ 2 = 9e4αk|||Id1×d1 |||2 = 9e 4αk,\nand\nd1∑ i=1 E [ XTi Xi ] = d1∑ i=1 k∑ `,`′=1 E [ (ei,` − pi,`)(evi,`′ − pi,`′) T ]\n= d1∑ i=1 k∑ `=1 E [ (ei,` − pi,`)(evi,` − pi,`) T ]\n= d1∑ i=1 k∑ `=1 ( E [ evi,`e T vi,` ] − E [ pi,`p T i,` ])\nd1∑ i=1 k∑ `=1 E [ evi,`e T vi,` ]\n= d1∑ i=1 k d2 Id2×d2 .\nTherefore, ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ d1∑ i=1 E [ XTi Xi ]∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ 2 ≤ kd1 d2 .\nBy matrix Bernstein inequality [27],\nP ( |||∇L(Θ∗)|||2 > t ) ≤ (d1 + d2) exp ( −k2 d21 t2/2 (d1k/min{d2, d1/(9e4α)}) + (3e2αk3/2d1t/3) ) ,\nwhich gives the desired tail probability of 2d−c for the choice of\nt = max\n{√ 4(1 + c) log d\nk d1 min{d2, d1/(9e4α)} ,\n4(1 + c)e2α log d\nk1/2 d1\n}\n=\n√ 4(1 + c) log d\nk1/2 d1 max\n{√ d1/d2 , e 2α √ 4(1 + c) log d } ,\nwhere the last equality holds due to the assumption that log d ≥ 4(1 + c)/9."
    }, {
      "heading" : "A.3 Proof of Lemma A.3",
      "text" : "Recall that the Hessian matrix is a block-diagonal matrix with the i-th block H(i)(Θ) given by (25). We use the following remark from [14] to bound the Hessian.\nRemark A.4. [14, Claim 1] Given θ ∈ Rr, let p be the column probability vector with pi = eθi/(eθ1 + · · ·+ eθρ) for each i ∈ [ρ] and for any positive integer ρ. If |θi| ≤ α, for all i ∈ [ρ], then\ne2α ( diag(p)− ppT ) 1\nρ diag(1)− 1 ρ2 11T .\nBy letting 1Si,` = ∑ j∈Si,` ej and applying the above claim, we have\ne2αH(i)(Θ) 1 k d1 k∑ `=1 ( 1 k − `+ 1 diag(1Si,`)−\n1\n(k − `+ 1)2 1Si,`1\nT Si,`\n)\n= 1\n2 k d1 k∑ `=1\n1 (k − `+ 1)2 ∑\nj,j′∈Si,`\n(ej − ej′)(ej − ej′)T\n1 2 k3 d1 k∑ `=1 ∑ j,j′∈Si,` (ej − ej′)(ej − ej′)T .\nHence,\nVec(∆)∇2L(Θ)VecT (∆) = d1∑ i=1 (∆T ei) TH(i)(Θ)(∆T ei)\n≥ e −2α\n2 k3 d1 d1∑ i=1 k∑ `=1 ∑ j,j′∈Si,` ∣∣∣∣∣∣eTi ∆(ej − ej′)∣∣∣∣∣∣22. By changing the order of the summation, we get that\nk∑ `=1 ∑ j,j′∈Si,` ∣∣∣∣∣∣eTi ∆(ej − ej′)∣∣∣∣∣∣22 = k∑ `,`′=1 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2 k∑ `′′=1 I ( σi(ji,`′′ ) ≤ min{σi(ji,`), σi(ji,`′)} ) .\nDefine\nχi,`,`′,`′′ ≡ I ( σi(ji,`′′ ) ≤ min{σi(ji,`), σi(ji,`′)} ) , (35)\nand let\nH(∆) ≡ e −2α\n2 k3 d1 d1∑ i=1 k∑ `,`′=1 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2 k∑ `′′=1 χi,`,`′,`′′ .\nThen we have VecT (∆)∇2L(Θ)Vec(∆) ≥ H(∆). To prove the theorem, it suffices to bound H(∆) from the below. First, we prove a lower bound on the expectation E[H(∆)]. Notice that for ` 6= `′, the conditional expectation of χi,`,`′,`′′ ’s, given the set of alternatives presented to user i is\nE [ k∑ `′′=1 χi,`,`′,`′′ ∣∣ ji,1, . . . , ji,k] = 1 + ∑ `′′ 6=`,`′\nexp(θi,ji,`′′ )\nexp(θi,ji,`′′ ) + exp(θi,ji,`′ ) + exp(θi,ji,`)\n≥ 1 + k − 2 1 + 2e2α ≥ k 3e2α .\nThen,\nE[H(∆)] = e−2α\n2 k3 d1 ∑ i,`,`′ E [ 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2E [ k∑ `′′=1 χi,`,`′,`′′ ∣∣ ji,1, . . . , ji,k]]\n≥ e −4α\n6 k2 d1 d1∑ i=1 ∑ `,`′∈[k] E [ 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2 ]\n= e−4α\n6 k2 d1 d1∑ i=1 ∑ 6̀=`′∈[k]  2 d2 d2∑ j=1 ∆2ij − 2 d22 d2∑ j,j′=1 ∆ij∆ij′  =\ne−4α(k − 1) 3 k d1 d2 |||∆|||2F , (36)\nwhere the last equality holds because ∑\nj∈[d2] ∆ij = 0 for ∆ ∈ Ω2α and for all i ∈ [d1]. We are left to prove that H(∆) cannot deviate from its mean too much. Suppose there exists a ∆ ∈ A such that Eq. (28) is violated, i.e. H(∆) < (e−4α/(24 d1d2))|||∆|||2F. We will show this happens with a small probability. From Eq. (36), we get that for k ≥ 24,\nE[H(∆)]−H(∆) ≥ (7k − 8) 24k\ne−4α d1 d2 |||∆|||2F\n≥ (20/3) e −4α\n24 d1d2 |||∆|||2F . (37)\nWe use a peeling argument as in [24, Lemma 3], [28] to upper bound the probability that Eq. (37) is true. We first construct the following family of subsets to cover A such that A ⊆ ⋃∞ `=1 S`.\nRecall µ = 210e2ααd2 √\n(d1 log d)/(kmin{d1, d2}), define in (30). Notice that since for any ∆ ∈ A, |||∆|||2F ≥ µ|||∆|||nuc ≥ µ|||∆|||F, it follows that |||∆|||F ≥ µ. Then, we can cover A with the family of sets\nS` = { ∆ ∈ Rd1×d2 ∣∣∣ |||∆|||∞ ≤ 2α , β`−1µ ≤ |||∆|||F ≤ β`µ , ∑\nj∈[d2]\n∆ij = 0 for all i ∈ [d1], and |||∆|||nuc ≤ β 2`µ } ,\nwhere β = √\n10/9 and for ` ∈ {1, 2, 3, . . .}. This implies that when there exists a ∆ ∈ A such that (37) holds, then there exists an ` ∈ Z+ such that ∆ ∈ S` and\nE[H(∆)]−H(∆) ≥ (20/3) e −4α\n24 d1d2 β2(`−1)µ2\n≥ e −4α\n4 d1d2 β2`µ2 . (38)\nApplying the union bound over ` ∈ Z+, we get from (37) and (38) that\nP { ∃∆ ∈ A , H(∆) < e −4α\n24 d1d2 |||∆|||2F\n} ≤ ∞∑ `=1 P { sup ∆∈S` ( E[H(∆)]−H(∆) ) > e−4α 4 d1d2 (β`µ)2 }\n≤ ∞∑ `=1 P\n{ sup\n∆∈B(β`µ)\n( E[H(∆)]−H(∆) ) > e−4α\n4 d1d2 (β`µ)2\n} , (39)\nwhere we define a new set B(D) such that S` ⊆ B(β`µ):\nB(D) = { ∆ ∈ Rd1×d2 ∣∣ ‖∆‖∞ ≤ 2α, |||∆|||F ≤ D, ∑\nj∈[d2]\n∆ij = 0 for all i ∈ [d1], µ|||∆|||nuc ≤ D 2 } .\n(40)\nThe following key lemma provides the upper bound on this probability.\nLemma A.5. For (16 min{d1, d2} log d)/(3d1) ≤ k ≤ d21 log d,\nP { sup\n∆∈B(D)\n( E[H(∆)]−H(∆) ) ≥ e −4α\n4d1d2 D2\n} ≤ exp { − e −4α kD4\n219α4d1d22\n} . (41)\nLet η = exp ( − e −4α4k(β−1.002)µ4\n219α4d1d22\n) . Applying the tail bound to (39), we get\nP { ∃∆ ∈ A , H(∆) < e −4α\n24 d1d2 |||∆|||2F\n} ≤ ∞∑ `=1 exp { − e −4αk(β`µ)4 219α4d1d22 } (a)\n≤ ∞∑ `=1 exp { − e −4α4k`(β − 1.002)µ4 219α4d1d22 } ≤ η\n1− η ,\nwhere (a) holds because βx ≥ x log β ≥ x(β−1.002) for the choice of β = √\n10/9. By the definition of µ,\nη = exp { − 2 23 e4αd22d1(log d) 2(β − 1.002) k(min{d1, d2})2 } ≤ exp{− 218 log d} ,\nwhere the last inequality follows from the assumption that k ≤ max{d1, d22/d1} log d = (d22d1 log d)/(min{d1, d2})2, and β − 1.002 ≥ 2−5. Since for d ≥ 2, exp{−218 log d} ≤ 1/2 and thus η ≤ 1/2, the lemma follows by assembling the last two displayed inequalities."
    }, {
      "heading" : "A.4 Proof of Lemma A.5",
      "text" : "Recall that\nH(∆) = e−2α\n2 k3 d1 d1∑ i=1 k∑ `,`′=1 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2 k∑ `′′=1 χi,`,`′,`′′ ,\nwith χi,`,`′,`′′ = I ( σi(ji,`′′ ) ≤ min{σi(ji,`), σi(ji,`′)} ) . Let Z = sup∆∈B(D) E[H(∆)] −H(∆) be the worst-case random deviation of H(∆) form its mean. We prove an upper bound on Z by showing that Z − E[Z] ≤ e−4αD2/(64d1d2) with high probability, and E[Z] ≤ 9e−4αD2/(40d1d2). This proves the desired claim in Lemma A.5.\nTo prove the concentration of Z, we utilize the random utility model (RUM) theoretic interpretation of the MNL model. The random variable Z depends on the random choice of alternatives\n{ji,`}i∈[d1],`∈[k] and the random k-wise ranking outcomes {σi}i∈[d1]. The random utility theory, pioneered by [5, 6, 7], tells us that the k-wise ranking from the MNL model has the same distribution as first drawing independent (unobserved) utilities ui,`’s of the item ji,` for user i according to the standard Gumbel Cumulative Distribution Function (CDF) F (c − Θi,ji,`) with F (c) = e−e −c\n, and then ranking the k items for user i according to their respective utilities. Given this definition of the MNL model, we have χi,`,`′,`′′ = I ( ui,`′′ ≥ max{ui,`, ui,`′} ) . Thus Z is a function of independent choices of the items and their (unobserved) utilities, i.e. Z = f({(ji,`, ui,`)}i∈[d1],`∈[k]). Let xi,` = (ji,`, ui,`) and write H(∆) as H(∆, {xi,`}i∈[d1],`∈[k]). This allows us to bound the difference and apply McDiarmid’s tail bound. Note that for any i ∈ [d1], ` ∈ [k], x1,1, . . . , xd1,k, and x′i,`,∣∣ f(x1,1, . . . , xi,`, . . . , xd1,k )− f(x1,1, . . . , x′i,`, . . . , xd1,k ) ∣∣ = ∣∣ sup\n∆∈B(D) (E [H(∆)]−H(∆, x1,1, . . . , xi,`, . . . , xd1,k))− sup ∆∈B(D)\n( E [H(∆)]−H(∆, x1,1, . . . , x′i,`, . . . , xd1,k) ) ∣∣ ≤ sup\n∆∈B(D) ∣∣H(∆, x1,1, . . . , xi,`, . . . , xd1,k)−H(∆, x1,1, . . . , x′i,`, . . . , xd1,k)∣∣ (a)\n≤ e −2α\n2 k3 d1 sup ∆∈B(D) { 2 ∑ `′∈[k] 〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2 k∑ `′′=1 χi,`,`′,`′′ + ∑ `′,`′′∈[k] 〈〈∆, ei,ji,`′ − ei,ji,`′′ 〉〉 2χi,`′,`′′,` } (b)\n≤ 8α 2e−2α\nk3 d1\n{ 2 ∑ `′∈[k]\\{`} k∑ `′′=1 χi,`,`′,`′′ + ∑ `′,`′′∈[k],`′ 6=`′′, χi,`′,`′′,` } ≤ 16α 2e−2α\nk d1 ,\nwhere (a) follows because for a fixed i and `, the random variable xi,` = (ji,`, ui,`) can appear in three terms, i.e. ∑ `′,`′′〈〈∆, ei,ji,` − ei,ji,`′ 〉〉 2χi,`,`′,`′′ + ∑\n`′,`′′〈〈∆, ei,ji,`′ − ei,ji,`〉〉 2χi,`′,`,`′′ +∑\n`′,`′′〈〈∆, ei,ji,`′ − ei,ji,`′′ 〉〉 2χi,`′,`′′,`, and (b) follows because |∆ij | ≤ 2α for all i, j since ∆ ∈ B(D). The last inequality follows because in the worst case, ∑ `′∈[k]\\{`} ∑k\n`′′=1 χi,`,`′,`′′ ≤ k(k − 1)/2 and∑ `′,`′′∈[k],`′ 6=`′′ χi,`′,`′′,` ≤ k(k − 1). This holds with equality if σi(ji,`) = k and σi(ji,`) = 1, respectively. By bounded differences inequality, we have\nP {Z − E [Z] ≥ t} ≤ exp ( − k 2 d21 t 2\n27 α4e−4αd1k\n) ,\nIt follows that for the choice of t = e−4αD2/(64d1d2),\nP { Z − E [Z] ≥ e −4αD2\n64d1d2\n} ≤ exp ( − e −4αkD4\n219α4d1d22\n) .\nWe are left to prove the upper bound on E[Z] using symmetrization and contraction. Define random variables\nYi,`,`′,`′′(∆) ≡ (∆i,ji,` −∆i,ji,`′ ) 2χi,`,`′,`′′ , (42)\nwhere the randomness is in the choice of alternatives ji,`, ji,`′ , and ji,`′′ , and the outcome of the comparisons of those three alternatives.\nThe main challenge in applying the symmetrization to ∑\n`,`′,`′′∈[k] Yi,`,`′,`′′(∆) is that we need to partition the summation over the set [k]×[k]×[k] into subsets of independent random variables, such that we can apply the standard symmetrization argument. to this end, we prove in the following lemma a a generalization of the well-known problem of scheduling a round robin tournament to a tournament of matches involving three teams each. No teams are present in more than one triple in a single round, and we want to minimize the number of rounds to cover all combination of triples are matched. For example, when there are k = 6 teams, there is a simple construction of such a tournament: T1 = {(1, 2, 3), (4, 5, 6)}, T2 = {1, 2, 4), (3, 5, 6)}, T3 = {(1, 2, 5), (3, 4, 6)}, T4 = {(1, 2, 6), (3, 4, 5)}, T5 = {(1, 3, 4), (2, 5, 6)}, T6 = {(1, 3, 5), (2, 4, 6)}, T7 = {(1, 3, 6), (2, 4, 5)}, T8 = {(1, 4, 5), (2, 3, 6)}, T9 = {(1, 4, 6), (2, 3, 5)}, T10 = {(1, 5, 6), (2, 3, 4)}. This is a perfect scheduling of a tournament with three teams in each match. For a general k, the following lemma provides a construction with O(k2) rounds.\nLemma A.6. There exists a partition (T1, . . . , TN ) of [k]× [k]× [k] for some N ≤ 24k2 such that Ta’s are disjoint subsets of [k] × [k] × [k], ⋃ a∈[N ] Ta = [k] × [k] × [k], |Ta| ≤ bk/3c and for any a ∈ [N ] the set of random variables in Ta satisfy\n{Yi,`,`′,`′′}i∈[d1],(`,`′,`′′)∈Ta are mutually independent .\nNow, we are ready to partition the summation.\nE [ Z ] = e−2α 2 k3 d1 E [ sup ∆∈B(D) ∑ i∈[d1] ∑ `,`′,`′′∈[k] { E[Yi,`,`′,`′′(∆)]− Yi,`,`′,`′′(∆) }] = e−2α\n2 k3 d1 E [ sup ∆∈B(D) ∑ i∈[d1] ∑ a∈[N ] ∑ (`,`′,`′′)∈Ta { E[Yi,`,`′,`′′(∆)]− Yi,`,`′,`′′(∆) }] ≤ e −2α\n2 k3 d1 ∑ a∈[N ] E [ sup ∆∈B(D) ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta { E[Yi,`,`′,`′′(∆)]− Yi,`,`′,`′′(∆) }] ≤ e −2α\nk3 d1 ∑ a∈[N ] E [ sup ∆∈B(D) ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′Yi,`,`′,`′′(∆) ]\n= e−2α\nk3 d1 ∑ a∈[N ] E [ sup ∆∈B(D) ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′(∆i,ji,` −∆i,ji,`′ ) 2χi,`,`′,`′′ ] , (43)\nwhere the first inequality follows from the fact that sum of the supremum if no less than the supremum of the sum, and the second inequality follows from standard symmetrization argument applied to independent random variables {Yi,`,`′,`′′(∆)}i∈[d1],(`,`′,`′′)∈Ta with i.i.d. Rademacher random variables ξi,`,`′,`′′ ’s. Since (∆i,ji,` −∆i,ji,`′ )\n2χi,`,`′,`′′ ≤ 4α|∆i,ji,` −∆i,ji,`′ |χi,`,`′,`′′ , we have by the Ledoux-Talagrand contraction inequality that\nE [\nsup ∆∈B(D) ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′(∆i,ji,` −∆i,ji,`′ ) 2χi,`,`′,`′′ ] ≤ 8αE [ sup\n∆∈B(D) ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′ χi,`,`′,`′′ 〈〈∆, ei(eji,` − eji,`′ ) T 〉〉 ]\n(44)\nApplying Hölder’s inequality, we get that∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′ χi,`,`′,`′′ 〈〈∆, ei(eji,` − eji,`′ ) T 〉〉 ∣∣∣\n≤ |||∆|||nuc ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta ξi,`,`′,`′′ χi,`,`′,`′′ ( ei(eji,` − eji,`′ ) T )∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2 . (45)\nWe are left to prove that the expected value of the right-hand side of the above inequality is bounded by C|||∆|||nuc √ kd1 log d/min{d1, d2} for some numerical constant C. For i ∈ [d1] and\n(`, `′, `′′) ∈ Ta, let Wi,`,`′,`′′ = ξi,`,`′,`′′ χi,`,`′,`′′ ( ei(eji,` − eji,`′ ) T )\nbe independent zero-mean random matrices, such that∣∣∣∣∣∣Wi,`,`′,`′′∣∣∣∣∣∣2 = ∣∣∣∣∣∣∣∣∣ξi,`,`′,`′′ χi,`,`′,`′′ (ei(eji,` − eji,`′ )T )∣∣∣∣∣∣∣∣∣2 ≤ √2 , almost surely, and\nE[Wi,`,`′,`′′W Ti,`,`′,`′′ ] = E[ ( ei(eji,` − eji,`′ ) T (eji,` − eji,`′ )e T i ) χi,`,`′,`′′ ]\n= 2E [ χi,`,`′,`′′ ] eie T i\n2eieTi ,\nand\nE[W Ti,`,`′,`′′Wi,`,`′,`′′ ] = E[ ( (eji,` − eji,`′ )e T i ei(eji,` − eji,`′ ) T ) χi,`,`′,`′′ ]\nE[(eji,` − eji,`′ )e T i ei(eji,` − eji,`′ ) T ]\n= 2\nd2 Id2×d2 −\n2\nd22 11T .\nThis gives\nσ2 = max  ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta E[Wi,`,`′,`′′W Ti,`,`′,`′′ ] ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2 , ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta E[W Ti,`,`′,`′′Wi,`,`′,`′′ ] ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2  ≤ max { 2|Ta| ,\n2d1|Ta| d2\n} =\n2d1|Ta| min{d1, d2} ≤ 2d1k 3 min{d1, d2} ,\nsince we have designed Ta’s such that |Ta| ≤ k/3. Applying matrix Bernstein inequality [27] yields the tail bound\nP  ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta Wi,`,`′,`′′ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2 ≥ t  ≤ (d1 + d2) exp( −t2/2σ2 +√2t/3 ) .\nChoosing t = max {√ 32kd1 log d/(3 min{d1, d2}), (16 √ 2/3) log d }\n, we obtain with probability at least 1− 2d−3,∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta Wi,`,`′,`′′ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2 ≤ max {√ 32kd1 log d 3 min{d1, d2} , 16 √ 2 log d 3 } .\nIt follows from the fact ∣∣∣∣∣∣∣∣∣∑i∈[d1]∑(`,`′,`′′)∈TaWi,`,`′,`′′∣∣∣∣∣∣∣∣∣2 ≤∑i,(`,`′,`′′) ∣∣∣∣∣∣Wi,`,`′,`′′∣∣∣∣∣∣2 ≤ √2d1k/3 that\nE ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∑ i∈[d1] ∑ (`,`′,`′′)∈Ta Wi,`,`′,`′′ ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2  ≤ max{√ 32kd1 log d 3 min{d1, d2} , 16 √ 2 log d 3 } + 2 √ 2d1k 3d3\n≤ 2\n√ 32kd1 log d\n3 min{d1, d2} ,\nwhere the last inequality follows from the assumption that (16 min{d1, d2} log d)/(3d1) ≤ k ≤ d21 log d. Substituting this in the RHS of Eq. (45), and then together with Eqs. (44) and (43), this gives the following desired bound:\nE[Z] ≤ ∑ a∈[N ] sup ∆∈B(D) 16αe−2α k3 d1\n√ 32kd1 log d\n3 min{d1, d2} |||∆|||nuc\n≤ ∑ a∈[N ]\ne−4α √ 2\n16 √ 3k2 d1 d2\n( 210e2ααd2\n√ d1 log d\nkmin{d1, d2} ) ︸ ︷︷ ︸\n=µ\n|||∆|||nuc\n≤ 9e −4αD2\n40d1d2 ,\nwhere the last inequality holds because N ≤ 4k2 and µ|||∆|||nuc ≤ D2."
    }, {
      "heading" : "A.5 Proof of Lemma A.6",
      "text" : "Recall that Yi,`,`′,`′′(∆) = (∆i,ji,` − ∆i,ji,`′ ) 2χi,`,`′,`′′ , as defined in (42). From the random utility model (RUM) interpretation of the MNL model presented in Section 1, it is not difficult to show that Yi,`,`′,`′′ and Yi,˜̀,˜̀′,˜̀′′ are mutually independent if the two triples (`, `\n′, `′′) and (˜̀, ˜̀′, ˜̀′′) do not overlap, i.e., no index is present in both triples.\nNow, borrowing the terminologies from round robin tournaments, we construct a schedule for a tournament with k teams where each match involve three teams. Let Ta,b denote a set of triples playing at the same round, indexed by two integers a ∈ {3, . . . , 2k − 3} and b ∈ {5, . . . , 2k − 1}. Hence, there are total N = (2k − 5)2 rounds.\nEach round (a, b) consists of disjoint triples and is defined as Ta,b ≡ { (`, `′, `′′) ∈ [k]× [k]× [k] | ` < `′ < `′′, `+ `′ = a, and `′ + `′′ = b } .\nWe need to prove that (a) there is no missing triple; and (b) no team plays twice in a single round. First, for any ordered triple (`, `′, `′′), there exists a ∈ {3, . . . , 2k−3} and b ∈ {5, . . . , 2k−1} such that `+ `′ = a and `′ + `′′ = b. This proves that all ordered triples are covered by the above construction. Next, given a pair (a, b), no two triples in Ta,b can share the same team. Suppose there exists two distinct ordered triples (`, `′, `′′) and (˜̀, ˜̀′, ˜̀′′) both in Ta,b, and one of the triples are shared. Then, from the two equations ` + `′ = ˜̀+ ˜̀′ = a and `′ + `′′ = ˜̀′ + ˜̀′′ = b, it follows that all three indices must be the same, which is a contradiction. This proves the desired claim for ordered triples.\nOne caveat is that we wanted to cover the whole [k]× [k]× [k], and not just the ordered triples. In the above construction, for example, a triple (3, 2, 1) does not appear. This can be resolved by simply taking all Ta,b’s from the above construction, and make 6 copies of each round, and permuting all the triples in each copy according to the same permutation over {1, 2, 3}. This increases the total rounds to N = 6(2k − 5)2 ≤ 24k2. Note that |Ta,b| ≤ bk/3c since no item can be in more than one triple."
    }, {
      "heading" : "B Proof of estimating approximate low-rank matrices in Corollary",
      "text" : "3.2\nWe follow closely the proof of a similar corollary in [24]. First fix a threshold τ > 0, and set r = max{j|σj(Θ∗) > τ}. With this choice of r, we have\nmin{d1,d2}∑ j=r+1 σj(Θ ∗) = τ min{d1,d2}∑ j=r+1 σj(Θ ∗) τ ≤ τ min{d1,d2}∑ j=r+1 (σj(Θ∗) τ )q ≤ τ1−qρq .\nAlso, since rτ q ≤ ∑r\nj=1 σj(Θ ∗)q ≤ ρq, it follows that √ r ≤ √ρaτ−q/2. Using these bounds, Eq. (8)\nis now ∣∣∣∣∣∣∣∣∣Θ̂−Θ∣∣∣∣∣∣∣∣∣2 F ≤ 288 √ 2c0e\n4αd1d2λ0︸ ︷︷ ︸ =A\n(√ ρqτ −q/2 ∣∣∣∣∣∣∣∣∣Θ̂−Θ∣∣∣∣∣∣∣∣∣ F + τ1−qρq ) .\nWith the choice of τ = A, it follows after some algebra that∣∣∣∣∣∣∣∣∣Θ̂−Θ∣∣∣∣∣∣∣∣∣ F ≤ 2√ρqA(2−q)/2 ."
    }, {
      "heading" : "C Proof of the information-theoretic lower bound in Theorem 2",
      "text" : "The proof uses information-theoretic methods which reduces the estimation problem to a multiway hypothesis testing problem. to prove a lower bound on the expected error, it suffices to prove\nsup Θ∗∈Ωα\nP {∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣2\nF ≥ δ\n2\n4\n} ≥ 1\n2 . (46)\nTo prove the above claim, we follow the standard recipe of constructing a packing in Ωα. Consider a family {Θ(1), . . . ,Θ(M(δ)} of d1×d2 dimensional matrices contained in Ωα satisfying ∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣ F ≥ δ for all `1, `2,∈ [M(δ)]. We will use M to refer to M(δ) for simplify the notation. Suppose we draw an index L ∈ [M(δ)] uniformly at random, and we are given direct observations σi as per MNL model with Θ∗ = Θ(L) on a randomly chosen set of k items Si for each user i ∈ [d1]. It follows from triangular inequality that\nsup Θ∗∈Ωα\nP {∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣2\nF ≥ δ\n2\n4\n} ≥ P { L̂ 6= L } , (47)\nwhere L̂ is the resulting best estimate of the multiway hypothesis testing on L. The generalized Fano’s inequality gives\nP { L̂ 6= L|S(1), . . . , S(d1) } ≥ 1− I(L̂;L) + log 2\nlogM (48) ≥ 1− ( M 2 )−1∑ `1,`2∈[M ]DKL(Θ\n(`1)‖Θ(`2)) + log 2 logM , (49)\nwhere DKL(Θ (`1)‖Θ(`2)) denotes the Kullback-Leibler divergence between the distributions of the partial rankings P { σ1, . . . , σd1 |Θ(`1), S(1), . . . , S(d1) } and P { σ1, . . . , σd1 |Θ(`2), S(1), . . . , S(d1) } . The second inequality follows from a standard technique, which we repeat here for completeness. Let Σ = {σ1, . . . , σd1} denote the observed outcome of comparisons. Since L–Θ(L)–Σ–L̂ form a Markov chain, the data processing inequality gives I(L̂;L) ≤ I(Σ;L). For simplicity, we drop the conditioning on the set of alternatives {S(1), . . . , S(d1)}, and and let p(·) denotes joint, marginal, and conditional distribution of respective random variables. It follows that\nI(Σ;L) = ∑\n`∈[M ],Σ\np(Σ|`) 1 M log p(`,Σ) p(`)p(Σ)\n= 1\nM ∑ `∈[M ] ∑ Σ p(Σ|`) log p(Σ|`)1 M ∑ `′ p(Σ|`′)\n≤ 1 M2 ∑ `,`′∈[M ] ∑ Σ p(Σ|`) log p(Σ|`) p(Σ|`′)\n= 1\nM2 ∑ `,`′∈[M ] DKL(Θ (`1)‖Θ(`2)) , (50)\nwhere the first inequality follows from Jensen’s inequality. To compute the KL-divergence, recall that from the RUM interpretation of the MNL model (see Section 1), one can generate sample rankings Σ by drawing random variables with exponential distributions with mean eΘ ∗ ij ’s. Precisely, let X(`) = [X (`) ij ]i∈[d1],j∈Si denote the set of random variables, where X (`) ij is drawn from the exponential distribution with mean e−Θ (`) ij . The MNL ranking follows by ordering the alternatives in each Si according to this {X(`)ij }j∈Si by ranking the smaller ones on the top. This forms a Markov chain L–X(L)–Σ, and the standard data processing inequality gives\nDKL(Θ (`1)‖Θ(`2)) ≤ DKL(X(`1)‖X(`2)) (51) = ∑ i∈[d1] ∑ j∈Si { eΘ (`1) ij −Θ (`2) ij − (Θ(`1)ij −Θ (`2) ij )− 1 } (52)\n≤ e 2α\n4α2 ∑ i∈[d1] ∑ j∈Si (Θ (`1) ij −Θ (`2) ij ) 2 , (53)\nwhere the last inequality follows from the fact that ex−x−1 ≤ (e2α/(4α2))x2 for any x ∈ [−2α, 2α]. Taking expectation over the randomly chosen set of alternatives,\nES(1),...,S(d1)[DKL(Θ (`1)‖Θ(`2))] ≤ e\n2α k\n4α2 d2 ∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣2 F . (54)\nCombined with (49), we get that P { L̂ 6= L } = ES(1),...,S(d1)[P { L̂ 6= L|S(1), . . . , S(d1) } ] (55)\n≥ 1− ( M 2 )−1∑ `1,`2∈[M ](e 2αk/(4α2d2)) ∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣2 F + log 2\nlogM , (56)\nThe remainder of the proof relies on the following probabilistic packing.\nLemma C.1. Let d2 ≥ d1 ≥ 607 be positive integers. Then for each r ∈ {1, . . . , d1}, and for any positive δ > 0 there exists a family of d1 × d2 dimensional matrices {Θ(1), . . . ,Θ(M(δ))} with cardinality M(δ) = b(1/4) exp(rd2/576)c such that each matrix is rank r and the following bounds hold: ∣∣∣∣∣∣∣∣∣Θ(`)∣∣∣∣∣∣∣∣∣\nF ≤ δ , for all ` ∈ [M ] (57)∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣\nF ≥ δ , for all `1, `2 ∈ [M ] (58) Θ(`) ∈ Ωα̃ , for all ` ∈ [M ] , (59)\nwith α̃ = (8δ/d2) √ 2 log d for d = (d1 + d2)/2.\nSuppose δ ≤ αd2/(8 √ 2 log d) such that the matrices in the packing set are entry-wise bounded by α, then the above lemma implies that ∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣2\nF ≤ 4δ2, which gives\nP { L̂ 6= L } ≥ 1− e2αkδ2 α2d2 + log 2\nrd 576 − 2 log 2\n≥ 1 2 ,\nwhere the last inequality holds for δ2 ≤ (α2d2/(e2αk))((rd/1152)−2 log 2). If we assume rd ≥ 3195 for simplicity, this bound on δ can be simplified to δ ≤ αe−α √ r d2 d/(2304 k). Together with (46) and (47), this proves that for all δ ≤ min{αd2/(8 √ 2 log d), αe−α √ r d2 d/(2304 k)},\ninf Θ̂ sup Θ∗∈Ωα\nE [ ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣\nF\n] ≥ δ\n4 .\nChoosing δ appropriately to maximize the right-hand side finishes the proof of the desired claim."
    }, {
      "heading" : "C.1 Proof of Lemma C.1",
      "text" : "Following the construction in [24], we use probabilistic method to prove the existence of the desired family. We will show that the following procedure succeeds in producing the desired family with probability at least half, which proves its existence. Let d = (d1 + d2)/2, and suppose d2 ≥ d1 without loss of generality. For the choice of M ′ = erd2/576, and for each ` ∈ [M ′], generate a rank-r matrix Θ(`) ∈ Rd1×d2 as follows:\nΘ(`) = δ√ rd2\nU(V (`))T ( Id2×d2 − 1\nd2 11T\n) , (60)\nwhere U ∈ Rd1×r is a random orthogonal basis such that UTU = Ir×r and V (`) ∈ Rd2×r is a random matrix with each entry V\n(`) ij ∈ {−1,+1} chosen independently and uniformly at random.\nBy construction, notice that ∣∣∣∣∣∣Θ(`)∣∣∣∣∣∣\nF = (δ/\n√ rd2) ∣∣∣∣∣∣(V (`))T (I− (1/d2)11T )∣∣∣∣∣∣F ≤ δ, since ∣∣∣∣∣∣V (`)∣∣∣∣∣∣F =√ rd2 and (I− (1/d2)11T ) is a projection which can only decrease the norm.\nNow, consider ∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣2\nF = (δ2/(rd2)) ∣∣∣∣∣∣(I− (1/d2)11T )(V (`1) − V (`2))∣∣∣∣∣∣2F ≡ f(V (`1), V (`2)) which is a function over 2rd2 i.i.d. random Rademacher variables V (`1) and V (`2) which define Θ(`1) and Θ(`2) respectively. Since f is Lipschitz in the following sense, we can apply McDiarmid’s concentration inequality. For all (V (`1), V (`2)) and (Ṽ (`1), Ṽ (`2)) that differ in only one variable, say Ṽ (`1) = V (`1) + 2eij , for some standard basis matrix eij , we have∣∣f(V (`1), V (`2))− f(Ṽ (`1), Ṽ (`2))∣∣ =∣∣∣∣∣ δ2r d2 ∣∣∣∣∣∣∣∣∣∣∣∣(I− 1d211T )(V (`1) − V (`2)) ∣∣∣∣∣∣∣∣∣∣∣∣2\nF\n− δ 2\nr d2 ∣∣∣∣∣∣∣∣∣∣∣∣(I− 1d211T )(V (`1) − V (`2) + 2eij) ∣∣∣∣∣∣∣∣∣∣∣∣2\nF ∣∣∣∣∣ (61) = ∣∣∣∣∣ δ2r d2 ∣∣∣∣∣∣∣∣∣∣∣∣2(I− 1d211T )eij ∣∣∣∣∣∣∣∣∣∣∣∣2 F + δ2 r d2 〈〈(I− 1 d2 11T )(V (`1) − V (`2)), 2eij〉〉\n∣∣∣∣∣ (62) ≤ 4 δ 2\nr d2 +\nδ\nr d2 ∣∣∣∣∣∣∣∣∣∣∣∣(I− 1d211T )(V (`1) − V (`2)) ∣∣∣∣∣∣∣∣∣∣∣∣ ∞ |||2eij |||1 (63)\n≤ 12 δ 2\nr d2 , (64)\nwhere we used the fact that (I− 1d211 T )(V (`1) − V (`2)) is entry-wise bounded by four. The expectation E[f(V (`1), V (`2))] is\nδ2\nr d2 E [∣∣∣∣∣∣∣∣∣∣∣∣(I− 1d211T )(V (`1) − V (`2)) ∣∣∣∣∣∣∣∣∣∣∣∣2\nF\n] = 2δ2\nr d2 E [∣∣∣∣∣∣∣∣∣∣∣∣(I− 1d211T )V (`1) ∣∣∣∣∣∣∣∣∣∣∣∣2\nF\n] (65)\n= 2δ2 r d2 E [∣∣∣∣∣∣∣∣∣V (`1)∣∣∣∣∣∣∣∣∣2 F ] − 2δ 2 r d22 E [ ‖1TV (`1)‖2 ] (66) = 2 δ2 (d2 − 1)\nd2 . (67)\nApplying McDiarmid’s inequality with bounded difference 12δ2/(rd2), we get that\nP { f(V (`1), V (`2)) ≤ 2δ2(1− 1/d2)− t } ≤ exp { − t\n2 r d2 144 δ4\n} , (68)\nSince there are less than (M ′)2 pairs of (`1, `2), setting t = (1 − 2/d2)δ2 and applying the union bound gives\nP {\nmin `1,`2∈[M ′] ∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣2 F ≥ δ2 } ≥ 1− exp { − r d2 144 ( 1− 2 d2 )2 + 2 logM ′ } ≥ 7 8 , (69)\nwhere we used M ′ = exp{rd2/576} and d2 ≥ 607. We are left to prove that Θ(`)’s are in Ω(8δ/d2) √ 2 log d2 as defined in (7). Since we removed the mean such that Θ(`)1 = 0 by construction, we only need to show that the maximum entry is bounded by (8δ/d2) √ 2 log d2. We first prove an upper bound in (71) for a fixed ` ∈ [M ′], and use this to show that there exists a large enough subset of matrices satisfying this bound. From (125),\nconsider (UV T )ij = 〈〈ui, vj〉〉, where ui ∈ Rr is the first r entries of a random vector drawn uniformly from the d2-dimensional sphere, and vj ∈ Rr is drawn uniformly at random from {−1,+1}r with ‖vj‖ = √ r. Using Levy’s theorem for concentration on the sphere [29], we have\nP {|〈〈ui, vj〉〉| ≥ t} ≤ 2 exp { − d2 t 2\n8 r\n} . (70)\nNotice that by the definition (125), maxi,j |Θ(`)ij | ≤ (2δ/ √ rd2) maxi,j |〈〈ui, vj〉〉|. Setting t = √ (32r/d2) log d2 and taking the union bound over all d1d2 indices, we get\nP {\nmax i,j |Θ(`)ij | ≤\n2δ √\n32 log d2 d2\n} ≥ 1− 2d1d2 exp { − 4 log d2 } ≥ 1\n2 , (71)\nfor a fixed ` ∈ [M ′]. Consider the event that there exists a subset S ⊂ [M ′] of cardinality M = (1/4)M ′ with the same bound on maximum entry, then from (71) we get\nP { ∃S ⊂ [M ′] such that ∣∣∣∣∣∣∣∣∣Θ(`)∣∣∣∣∣∣∣∣∣ ∞ ≤ 2δ √ 32 log d2 d2 for all ` ∈ S } ≥ M ′∑ m=M ( M ′ m )(1 2 )m , (72)\nwhich is larger than half for our choice of M < M ′/2."
    }, {
      "heading" : "D Proof of Theorem 3",
      "text" : "We use similar notations and techniques as the proof of Theorem 1 in Appendix A. From the definition of L(Θ) in Eq. (17), we have for the true parameter Θ∗, the gradient evaluated at the true parameter is\n∇L(Θ∗) = − 1 n n∑ i=1 (euie T vi − pi) , (73)\nwhere pi denotes the conditional probability of the MNL choice for the i-th sample. Precisely, pi =∑ j1∈Si ∑ j2∈Ti pj1,j2|Si,Tiej1e T j2 where pj1,j2|Si,Ti is the probability that the pair of items (j1, j2) is chosen at the i-th sample such that pj1,j2|Si,Ti ≡ P {(ui, vi) = (j1, j2)|Si, Ti} = e Θ∗j1,j2/( ∑ j′1∈Si,j′2∈Ti e Θ∗ j′1,j ′ 2 ), where (ui, vi) is the pair of items selected by the i-th user among the set of pairs of alternatives Si × Ti. The Hessian can be computed as\n∂2L(Θ) ∂Θj1,j2 ∂Θj′1,j′2 = 1 n n∑ i=1 I ( (j1, j2) ∈ Si × Ti )∂pj1,j2|Si,Ti ∂Θj′1,j′2\n(74)\n= 1\nn n∑ i=1 I ( (j1, j2), (j ′ 1, j ′ 2) ∈ Si × Ti ) ( pj1,j2|Si,TiI((j1, j2) = (j ′ 1, j ′ 2))− pj1,j2|Si,Tipj′1,j′2|Si,Ti ) , (75)\nWe use ∇2L(Θ) ∈ Rd1d2×d1d2 to denote this Hessian. Let ∆ = Θ∗ − Θ̂ where Θ̂ is an optimal solution to the convex optimization in (15). We introduce the following key technical lemmas.\nLemma A.1 Eq. (26) The following lemma provides a bound on the gradient using the concentration of measure for\nsum of independent random matrices [27].\nLemma D.1. For any positive constant c ≥ 1 and n ≥ (4(1 + c)e2αd1d2 log d)/max{d1, d2}, with probability at least 1− 2d−c,\n|||∇L(Θ∗)|||2 ≤\n√ 4(1 + c)e2α max{d1, d2} log d\nd1 d2 n . (76)\nSince we are typically interested in the regime where the number of samples is much smaller than the dimension d1 × d2 of the problem, the Hessian is typically not positive definite. However, when we restrict our attention to the vectorized ∆ with relatively small nuclear norm, then we can prove restricted strong convexity, which gives the following bound.\nLemma D.2 (Restricted Strong Convexity for bundled choice modeling). Fix any Θ ∈ Ω′α and assume (min{d1, d2}/min{k1, k2}) log d ≤ n ≤ min{d5 log d, k1k2 max{d21, d22} log d}. Under the random sampling model of the alternatives {jia}i∈[n],a∈[k1] from the first set of items [d1], {jib}i∈[n],b∈[k1] from the second set of items [d2] and the random outcome of the comparisons described in section 1, with probability larger than 1− 2d−225,\nVec(∆)T ∇2L(Θ) Vec(∆) ≥ e −2α\n8 d1 d2 |||∆|||2F , (77)\nfor all ∆ in A′ where\nA′ = { ∆ ∈ Rd1×d2 ∣∣ |||∆|||∞ ≤ 2α , ∑\nj1∈[d1],j2∈[d2]\n∆j1j2 = 0 and |||∆||| 2 F ≥ µ̃|||∆|||nuc\n} . (78)\nwith\nµ̃ ≡ 210 αd1d2\n√ log d\nn min{d1, d2} min{k1, k2} . (79)\nBuilding on these lemmas, the proof of Theorem 3 is divided into the following two cases. In both cases, we will show that\n|||∆|||2F ≤ 12 e 2αc1λ1 d1d2 |||∆|||nuc , (80)\nwith high probability. Applying Lemma A.1 proves the desired theorem. We are left to show Eq. (80) holds.\nCase 1: Suppose |||∆|||2F ≥ µ̃ |||∆|||nuc. With ∆ = Θ∗ − Θ̂, the Taylor expansion yields\nL(Θ̂) = L(Θ∗)− 〈〈∇L(Θ∗),∆〉〉+ 1 2 Vec(∆)∇2L(Θ)VecT (∆), (81)\nwhere Θ = aΘ̂ + (1− a)Θ∗ for some a ∈ [0, 1]. It follows from Lemma D.2 that with probability at least 1− 2d−225 ,\nL(Θ̂)− L(Θ∗) ≥ −|||∇L(Θ∗)|||2|||∆|||nuc + e−2α\n8 d1 d2 |||∆|||2F .\nFrom the definition of Θ̂ as an optimal solution of the minimization, we have L(Θ̂)− L(Θ∗) ≤ λ ( |||Θ∗|||nuc − ∣∣∣∣∣∣∣∣∣Θ̂∣∣∣∣∣∣∣∣∣ nuc ) ≤ λ|||∆|||nuc .\nBy the assumption, we choose λ ≥ 8λ1. In view of Lemma D.1, this implies that λ ≥ 2|||∇L(Θ∗)|||2 with probability at least 1− 2d−3. It follows that with probability at least 1− 2d−3 − 2d−225 ,\ne−2α\n8d1d2 |||∆|||2F ≤\n( λ+ |||∇L(Θ∗)|||2 ) |||∆|||nuc ≤ 3λ\n2 |||∆|||nuc .\nBy our assumption on λ ≤ c1λ1, this proves the desired bound in Eq. (80) Case 2: Suppose |||∆|||2F ≤ µ̃ |||∆|||nuc. By the definition of µ and the fact that c1 ≥ 128/ √ min{k1, k2}, it follows that µ̃ ≤ 12 e2αc1λ1 d1d2, and we get the same bound as in Eq. (80)."
    }, {
      "heading" : "D.1 Proof of Lemma D.1",
      "text" : "Define Xi = −(euieTvi − pi) such that ∇L(Θ ∗) = (1/n) ∑n i=1Xi, which is a sum of n independent random matrices. Note that since pi is entry-wise bounded by e 2α/(k1k2),\n|||Xi|||2 ≤ 1 + e2α√ k1k2 ,\nand\nn∑ i=1 E[XiXTi ] = n∑ i=1 (E[euie T ui ]− pip T i ) (82)\nn∑ i=1 E[euie T ui ] (83) e 2α n\nd1 Id1×d1 , (84)\nwhere the last inequality follows from the fact that for any given Si, ui will be chosen with probability at most e2α/k1, if it is in the set Si which happens with probability k1/d1. Therefore,∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ n∑ i=1 E[XiXTi ] ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ 2 ≤ e 2α n d1 . (85)\nSimilarly, ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ n∑ i=1 E[XTi Xi] ∣∣∣∣∣ ∣∣∣∣∣ ∣∣∣∣∣ 2 ≤ e 2α n d2 . (86)\nApplying matrix Bernstein inequality [27], we get P {|||∇L(Θ∗)|||2 > t} ≤ (d1 + d2) exp { −n2t2/2\n(e2αnmax{d1, d2}/(d1d2)) + ((1 + (e2α/ √ k1k2))nt/3)\n} ,(87)\nwhich gives the desired tail probability of 2d−c for the choice of\nt = max {√4(1 + c)e2α max{d1, d2} log d\nd1d2n ,\n4(1 + c)(1 + e 2α\n√ k1k2 ) log d\n3n } = √ 4(1 + c)e2α max{d1, d2} log d\nd1d2n ,\nwhere the last equality follows from the assumption that n ≥ (4(1 + c)e2αd1d2 log d)/max{d1, d2}."
    }, {
      "heading" : "D.2 Proof of Lemma D.2",
      "text" : "Thee quadratic form of the Hessian defined in (75) can be lower bounded by\nVec(∆)T ∇2L(Θ) Vec(∆) ≥ e −2α\n2 k21 k 2 2 n n∑ i=1 ∑ j1,j′1∈Si ∑ j2,j′2∈Ti ( ∆j1,j2 −∆j′1,j′2 )2 ︸ ︷︷ ︸\n≡H̃(∆)\n, (88)\nwhich follows from Remark A.4. To lower bound H̃(∆), we first compute the mean:\nE[H̃(∆)] = e−2α\n2 k21 k 2 2 n n∑ i=1 E [ ∑ j1,j′1∈Si ∑ j2,j′2∈Ti ( ∆j1,j2 −∆j′1,j′2 )2] (89)\n= e−2α\nd1 d2 |||∆|||2F , (90)\nwhere we used the fact that E[ ∑ j1∈Si,j2∈Ti ∆j1,j2 ] = (k1k2/(d1d2)) ∑ j′1∈[d1],j′2∈[d2] ∆j′1,j′2 = 0 for ∆ ∈ Ω′2α in (17). We now prove that H̃(∆) does not deviate from its mean too much. Suppose there exists a ∆ ∈ A′ defined in (78) such that Eq. (77) is violated, i.e. H̃(∆) < (e−2α/(8k1k2d1d2))|||∆|||2F. In this case,\nE[H̃(∆)]− H̃(∆) ≥ 7 e −2α\n8d1d2 |||∆|||2F . (91)\nWe will show that this happens with a small probability. We use the same peeling argument as in Appendix A with\nS ′` = { ∆ ∈ Rd1×d2 | |||∆|||∞ ≤ 2α, β `−1µ̃ ≤ |||∆|||F ≤ β `µ̃, ∑\nj1∈[d1],j2∈[d2]\n∆j1,j2 = 0, and |||∆|||nuc ≤ β 2`µ̃ } ,\nwhere β = √\n10/9 and for ` ∈ {1, 2, 3, . . .}, and µ̃ is defined in (79). By the peeling argument, there exists an ` ∈ Z+ such that ∆ ∈ S ′` and\nE[H̃(∆)]− H̃(∆) ≥ 7 e −2α\n8d1d2 β2`−2(µ̃)2 ≥ 7 e\n−2α\n9 d1d2 β2`(µ̃)2 . (92)\nApplying the union bound over ` ∈ Z+,\nP { ∃∆ ∈ A′ , H̃(∆) < e −2α\n8 d1 d2 |||∆|||2F\n} ≤ ∞∑ `=1 P { sup ∆∈S′` ( E[H̃(∆)]− H̃(∆) ) > 7 e−2α 9d1d2 (β`µ̃)2 }\n≤ ∞∑ `=1 P\n{ sup\n∆∈B′(β`µ̃)\n( E[H̃(∆)]− H̃(∆) ) > 7e−2α\n9d1d2 (β`µ̃)2\n} , (93)\nwhere we define the set B′(D) such that S ′` ⊆ B′(β`µ̃):\nB′(D) = { ∆ ∈ Rd1×d2 ∣∣ ‖∆‖∞ ≤ 2α, |||∆|||F ≤ D, ∑\nj1∈[d1],j2∈[d2]\n∆j1j2 = 0, µ̃|||∆|||nuc ≤ D 2 } . (94)\nThe following key lemma provides the upper bound on this probability.\nLemma D.3. For (min{d1, d2}/min{k1, k2}) log d ≤ n ≤ d5 log d,\nP { sup\n∆∈B′(D)\n( E[H̃(∆)]− H̃(∆) ) ≥ e −2αD2\n2d1d2\n} ≤ exp { − n min{k 2 1, k 2 2} k1k2D4\n210α4d21d 2 2\n} . (95)\nLet η = exp ( −nk1k2 min{k 2 1 ,k 2 2}(β−1.002)(µ̃)4\n210α4d21d 2 2\n) . Applying the tail bound to (93), we get\nP { ∃∆ ∈ A′ , H̃(∆) < e −2α\n8 d1d2 |||∆|||2F\n} ≤ ∞∑ `=1 exp { − nk1k2 min{k 2 1, k 2 2} (β`µ̃)4 210α4d21d 2 2 } (a)\n≤ ∞∑ `=1 exp { − nk1k2 min{k 2 1, k 2 2}`(β − 1.002)(µ̃)4 210α4d21d 2 2 } ≤ η\n1− η ,\nwhere (a) holds because βx ≥ x log β ≥ x(β−1.002) for the choice of β = √\n10/9. By the definition of µ̃,\nη = exp { − 2\n30 k1k2 max{d22, d21}(log d)2(β − 1.002) n\n} ≤ exp{− 225 log d} ,\nwhere the last inequality follows from the assumption that n ≤ k1k2 max{d21, d22} log d, and β − 1.002 ≥ 2−5. Since for d ≥ 2, exp{−225 log d} ≤ 1/2 and thus η ≤ 1/2, the lemma follows by assembling the last two displayed inequalities."
    }, {
      "heading" : "D.3 Proof of Lemma D.3",
      "text" : "Let Z ≡ sup∆∈B′(D) E[H̃(∆)] − H̃(∆) and consider the tail bound using McDiarmid’s inequality. Note that Z has a bounded difference of (8α2e−2α max{k1, k2})/(k21k22n) when one of the k1k2n independent random variables are changed, which gives\nP {Z − E[Z] ≥ t} ≤ exp ( − k 4 1k 4 2n 2t2\n64α4e−4α max{k21, k22}k1k2n\n) . (96)\nWith the choice of t = D2/(4e2α d1d2), this gives\nP { Z − E[Z] ≥ e −2α 4d1d2 D2 } ≤ exp ( − k 3 1k 3 2nD 4 210α4d21d 2 2 max{k21, k22} ) . (97)\nWe first construct a partition of the space similar to Lemma A.6. Let\nk̃ ≡ min{k1, k2} . (98)\nLemma D.4. There exists a partition (T1, . . . , TN ) of {[k1] × [k2]} × {[k1] × [k2]} for some N ≤ 2k21k 2 2/k̃ such that T`’s are disjoint subsets, ⋃ `∈[N ] T` = {[k1] × [k2]} × {[k1] × [k2]}, |T`| ≤ k̃ and for any ` ∈ [N ] the set of random variables in T` satisfy\n{(∆ji,a,ji,b −∆ji,a′ ,ji,b′ ) 2}i∈[n],((a,b),(a′,b′))∈T` are mutually independent .\nwhere ji,a for i ∈ [n] and a ∈ [k1] denote the a-th chosen item to be included in the set Si.\nNow we prove an upper bound on E[Z] using the symmetrization technique. Recall that ji,a is independently and uniformly chosen from [d1] for i ∈ [n] and a ∈ [k1]. Similarly, ji,b is independently and uniformly chosen from [d1] for i ∈ [n] and b ∈ [k2].\nE[Z] = e−2α\n2 k21 k 2 2 n\nE  sup ∆∈B′(D) n∑ i=1 ∑ a,a′∈[k1] ∑ b,b′∈[k2] E [( ∆ji,a,ji,b −∆ji,a′ ,ji,b′ )2]− (∆ji,a,ji,b −∆ji,a′ ,ji,b′)2 (99) ≤ e −2α\n2 k21 k 2 2 n ∑ `∈[N ] E  sup ∆∈B′(D) n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` E [( ∆j1,j2 −∆j′1,j′2 )2]− (∆j1,j2 −∆j′1,j′2)2  (100) ≤ e −2α\nk21 k 2 2 n ∑ `∈[N ] E  sup ∆∈B′(D) n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ∆j1,j2 −∆j′1,j′2 )2 , (101) where the first inequality follows for the fact that the supremum of the sum is smaller than the sum of supremum, and the second inequality follows from standard symmetrization with i.i.d. Rademacher random variables ξi,j1,j2,j′1,j′2 ’s. It follows from Ledoux-Talagrand contraction inequality that\nE  sup ∆∈B′(D) n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ∆j1,j2 −∆j′1,j′2 )2 (102) ≤ 8αE  sup ∆∈B′(D) n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ∆j1,j2 −∆j′1,j′2\n) (103) ≤ 8αE  sup ∆∈B′(D) |||∆|||nuc ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ej1,j2 − ej′1,j′2 )∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2\n (104) ≤ 8αD 2\nµ̃ E ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ej1,j2 − ej′1,j′2 )∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2  , (105)\nwhere the second inequality follows for the Hölder’s inequality and the last inequality follows from µ̃|||∆|||nuc ≤ D2 for all ∆ ∈ B′(D). To bound the expected spectral norm of the random matrix, we use matrix Bernstein’s inequality. Note that ∣∣∣∣∣∣∣∣∣ξi,j1,j2,j′1,j′2c∣∣∣∣∣∣∣∣∣2 ≤ √2 almost surely, E[(ej1,j2−ej′1,j′2)(ej1,j2−ej′1,j′2) T ] (2/d1)Id1×d1 , and E[(ej1,j2−ej′1,j′2) T (ej1,j2−ej′1,j′2)] (2/d2)Id2×d2 . It follows that σ2 = 2n|T`|/min{d1, d2}, where |T`| ≤ min{k1, k2}. It follows that\nP  ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ej1,j2 − ej′1,j′2 )∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2 > t  ≤ (d1 + d2) exp{ −t2/22nmin{k1,k2} min{d1,d2} + √ 2t 3 } ,\nChoosing t = max{ √ 64n(min{k1, k2}/min{d1, d2}) log d, (16 √\n2/3) log d}, we obtain a bound on the spectral norm of t with probability at least 1−2d−7. From the fact that ∣∣∣∣∣∣∣∣∣∑ni=1∑(j1,j2,j′1,j′2)∈T` ξi,j1,j2,j′1,j′2(ej1,j2 − ej′1,j′2)∣∣∣∣∣∣∣∣∣2 ≤ (n/ √ 2) min{k1, k2}, it follows that\nE ∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ n∑ i=1 ∑ (j1,j2,j′1,j ′ 2)∈T` ξi,j1,j2,j′1,j′2 ( ej1,j2 − ej′1,j′2 )∣∣∣∣∣∣ ∣∣∣∣∣∣ ∣∣∣∣∣∣ 2  (106) ≤ max {√64n min{k1, k2} log d min{d1, d2} , (16 √ 2/3) log d } + 2nmin{k1, k2}√ 2d7 (107)\n≤\n√ 66n min{k1, k2} log d\nmin{d1, d2} (108)\nwhich follows form the assumption that nmin{k1, k2} ≥ min{d1, d2} log d and n ≤ d5 log d. Substituting this bound in (101), and (105), we get that\nE[Z] ≤ 16e −2ααD2\nµ̃\n√ 66 log d\nnmin{k1, k2}min{d1, d2} (109)\n≤ e −2αD2\n4 d1d2 . (110)"
    }, {
      "heading" : "E Proof of the information-theoretic lower bound in Theorem 4",
      "text" : "This proof follow closely the proof of Theorem 2 in Appendix C. We apply the generalized Fano’s inequality in the same way to get Eq. (49)\nP { L̂ 6= L } ≥ 1− ( M 2 )−1∑ `1,`2∈[M ]DKL(Θ\n(`1)‖Θ(`2)) + log 2 logM , (111)\nThe main challenge in this case is that we can no longer directly apply the RUM interpretation to compete DKL(Θ\n(`1)‖Θ(`2)). This will result in over estimating the KL-divergence, because this approach does not take into account that we only take the top winner, out of those k1k2 alternatives. Instead, we compute the divergence directly, and provide an appropriate bound. Let the set of k1\nrows and k2 columns chosen in one of the n sampling be S ⊂ [d1] and T ⊂ [d2] respectively. Then,\nDKL(Θ (`1)‖Θ(`2)) (a)= n(\nd1 k1 )( d2 k2 )∑ S,T ∑ i∈S j∈T eΘ (`1) ij∑\ni′∈S j′∈T\ne Θ\n(`1) i′j′ log\ne Θ (`1) ij ∑ i′∈S j′∈T e Θ (`2) i′j′\neΘ (`2) ij ∑\ni′∈S j′∈T\ne Θ\n(`1) i′j′\n (112)\n(b) ≤ n( d1 k1 )( d2 k2 )∑ S,T ∑ i,j e2Θ (`1) ij ∑ i′,j′ e Θ (`2) i′j′ − eΘ (`1) ij +Θ (`2) ij ∑ i′,j′ e Θ (`1) i′j′\neΘ (`2) ij (∑ i′,j′ e Θ (`1) i′j′\n)2  (113)\n(c) ≤ ne 2α\nk21k 2 2 ( d1 k1 )( d2 k2 )∑ S,T ∑ i,j e2Θ(`1)ij −Θ(`2)ij ∑ i′,j′ e Θ (`2) i′j′ − eΘ (`1) ij ∑ i′,j′ e Θ (`1) i′j′  (114)\n= ne2α\nk21k 2 2 ( d1 k1 )( d2 k2 )∑ S,T ∑ i′,j′ e Θ (`2) i′j′ ∑ i,j ( eΘ (`1) ij − eΘ (`2) ij )2 eΘ (`2) ij − (∑ i,j (eΘ (`1) ij − eΘ (`2) ij ) )2 (115)\n(d) ≤ ne 4α k1k2 ( d1 k1 )( d2 k2 )∑ S,T ∑ i,j ( eΘ (`1) ij − eΘ (`2) ij )2 (116)\n(e) ≤ ne 5α k1k2 ( d1 k1 )( d2 k2 )∑ S,T ∑ i,j ( Θ (`1) ij −Θ (`2) ij )2 (117)\n(f) =\nne5α\nd1d2\n∣∣∣∣∣∣∣∣∣Θ(`1)ij −Θ(`2)ij ∣∣∣∣∣∣∣∣∣2 F\n(118)\n(119)\nHere (a) is by definition of KL-distance and the fact that S, T are chosen uniformly from all possible such sets and (b) is due to the fact that log(x) ≤ x−1 with x = (eΘ (`1) ij ∑\ni′∈S,j′∈T e Θ\n(`2) i′j′ )/(eΘ (`2) ij ∑\ni′∈S,j′∈T e Θ\n(`1) i′j′ ).\nThe constants at (c) is due to the fact that each element of Θ(`1) is upper bounded by α and lower bounded by −α. We can get (d) by removing the second term which is always negative, and using the bond of α. (e) is obtained because ex where −α ≤ x ≤ α is Lipschitz continuous with Lipschitz constant eα. At last (f) is obtained by simple counting of the occurrences of each ij. Thus we have,\nP { L̂ 6= L } ≥ 1−\n( M 2 )−1∑ `1,`2∈[M ] ne5α d1d2 ∣∣∣∣∣∣∣∣∣Θ(`2)ij −Θ(`2)ij ∣∣∣∣∣∣∣∣∣2 F + log 2\nlogM , (120)\nThe remainder of the proof relies on the following probabilistic packing.\nLemma E.1. Let d2 ≥ d1 be sufficiently large positive integers. Then for each r ∈ {1, . . . , d1}, and for any positive δ > 0 there exists a family of d1×d2 dimensional matrices {Θ(1), . . . ,Θ(M(δ))} with cardinality M(δ) = b(1/4) exp(rd2/576)c such that each matrix is rank r and the following bounds\nhold: ∣∣∣∣∣∣∣∣∣Θ(`)∣∣∣∣∣∣∣∣∣ F ≤ δ , for all ` ∈ [M ] (121)∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣\nF ≥ 1 2 δ , for all `1, `2 ∈ [M ] (122) Θ(`) ∈ Ω′α̃ , for all ` ∈ [M ] , (123)\nwith α̃ = (8δ/d2) √ 2 log d for d = (d1 + d2)/2.\nSuppose δ ≤ αd2/(8 √ 2 log d) such that the matrices in the packing set are entry-wise bounded\nby α, then the above lemma E.1 implies that ∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣2\nF ≤ 4δ2, which gives\nP { L̂ 6= L } ≥ 1− e5αn4δ2 d1d2 + log 2\nrd2 576 − 2 log 2\n≥ 1 2 , (124)\nwhere the last inequality holds for δ2 ≤ (rd1d22/(1152e5αn)) and assuming rd2 ≥ 1600. Together with (124) and (122), this proves that for all δ ≤ min{αd2/(8 √ 2 log d), rd1d 2 2/(1152e 5αn)},\ninf Θ̂ sup Θ∗∈Ωα\nE [ ∣∣∣∣∣∣∣∣∣Θ̂−Θ∗∣∣∣∣∣∣∣∣∣\nF\n] ≥ δ/4 .\nChoosing δ appropriately to maximize the right-hand side finishes the proof of the desired claim. Also by symmetry, we can apply the same argument to get similar bound with d1 and d2 interchanged."
    }, {
      "heading" : "E.1 Proof of Lemma E.1",
      "text" : "We show that the following procedure succeeds in producing the desired family with probability at least half, which proves its existence. Let d = (d1 + d2)/2, and suppose d2 ≥ d1 without loss of generality. For the choice of M ′ = erd2/576, and for each ` ∈ [M ′], generate a rank-r matrix Θ(`) ∈ Rd1×d2 as follows:\nΘ(`) = δ√ rd2\nU(V (`))T ( Id2×d2 − 1TU(V (`))T1\nd1d2 11T\n) , (125)\nwhere U ∈ Rd1×r is a random orthogonal basis such that UTU = Ir×r and V (`) ∈ Rd2×r is a random matrix with each entry V\n(`) ij ∈ {−1,+1} chosen independently and uniformly at random. By construction, notice that ∣∣∣∣∣∣Θ(`)∣∣∣∣∣∣\nF ≤ (δ/\n√ rd2) ∣∣∣∣∣∣U(V (`))T ∣∣∣∣∣∣ F\n= δ. Now, by triangular inequality, we have∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣\nF ≥ δ√\nrd2\n∣∣∣∣∣∣∣∣∣U(V (`1) − V (`2))T ∣∣∣∣∣∣∣∣∣ F − δ |1 TU(V (`1) − V (`2))T1| d1d2 √ rd2 ∣∣∣∣∣∣11T ∣∣∣∣∣∣ F\n≥ δ√ rd2 ∣∣∣∣∣∣∣∣∣V (`1) − V (`2)∣∣∣∣∣∣∣∣∣ F︸ ︷︷ ︸\nA\n− δ√ r d1 d22 ( |1TU(V (`1))T1|︸ ︷︷ ︸\nB\n+|1TU(V (`2))T1| ) .\nWe will prove that the first term is bounded by A ≥ √ rd2 with probability at least 7/8 for all M ′ matrices, and we will show that we can find M matrices such that the second term is bounded\nby B ≤ 8 √\n2rd2 log(32r) log(32d) with probability at least 7/8. Together, this proves that with probability at least 3/4, there exists M matrices such that\n∣∣∣∣∣∣∣∣∣Θ(`1) −Θ(`2)∣∣∣∣∣∣∣∣∣ F ≥ δ ( 1−\n√ 27 log(32r) log(32d)\nd1d2\n) ≥ 1\n2 δ ,\nfor all `1, `2 ∈ [M ] and for sufficiently large d1 and d2. Applying similar McDiarmid’s inequality as Eq. (69) in Appendix C, it follows that A2 ≥ rd2 with probability at least 7/8 for M ′ = erd2/576 and a sufficiently large d2. To prove a bound on B, we will show that for a given `,\nP { |1TU(V (`))T1| ≤ 8 √ 2rd2 log(32r) log(32d) } ≥ 7\n8 . (126)\nThen using the similar technique as in (72), it follows that we can find M = (1/4)M ′ matrices all satisfying this bound and also the bound on the max-entry in (127). We are left to prove (126). We apply a series of concentration inequalities. Let H1 be the event that {|〈〈V (`)i ,1〉〉| ≤√ 2d2 log(32r) for all i ∈ [r]}. Then, applying the standard Hoeffding’s inequality, we get that P {H1} ≥ 15/16, where V (`)i is the i-th column of V (`). We next change the variables and represent 1TU as √ d1u\nT Ũ , where u is drawn uniformly at random from the unit sphere and Ũ is a r dimensional subspace drawn uniformly at random. By symmetry, √ d1u\nT Ũ have the same distribution as 1TU . Let H2 be the event that {|〈〈Ũi, (V (`))T1〉〉| ≤ √ 16r(d2/d1) log(32r) log(32d) for all i ∈ [d1]}, where Ũi is the i-th row of Ũ . Then, applying Levy’s theorem for concentration on the sphere [29], we have P {H2|H1} ≥ 15/16. Finally, let H3 be the event that {| √ d1〈〈u, Ũ(V (`))T 〉〉1| ≤\n8 √\n2rd2 log(32r) log(32d)}. Then, again applying Levy’s concentration, we get P {H3|H1, H2} ≥ 15/16. Collecting all three concentration inequalities, we get that with probability at least 13/16, |1TU(V (`))T1| ≤ 8 √ 2rd2 log(32r) log(32d), which proves Eq. (126).\nWe are left to prove that Θ(`)’s are in Ω(8δ/d2) √ 2 log d2 as defined in (17). Similar to Eq. (71),\napplying Levy’s concentration gives P {\nmax i,j |Θ(`)ij | ≤\n2δ √\n32 log d2 d2\n} ≥ 1− 2 exp { − 2 log d2 } ≥ 1\n2 , (127)\nfor a fixed ` ∈ [M ′]. Then using the similar technique as in (72), it follows that there exists M = (1/4)M ′ matrices all satisfying this bound and also the bound on B in Eq. (126)."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "<lb>In applications such as recommendation systems and revenue management, it is important to<lb>predict preferences on items that have not been seen by a user or predict outcomes of comparisons<lb>among those that have never been compared. A popular discrete choice model of multinomial<lb>logit model captures the structure of the hidden preferences with a low-rank matrix. In order to<lb>predict the preferences, we want to learn the underlying model from noisy observations of the<lb>low-rank matrix, collected as revealed preferences in various forms of ordinal data. A natural<lb>approach to learn such a model is to solve a convex relaxation of nuclear norm minimization.<lb>We present the convex relaxation approach in two contexts of interest: collaborative ranking<lb>and bundled choice modeling. In both cases, we show that the convex relaxation is minimax<lb>optimal. We prove an upper bound on the resulting error with finite samples, and provide a<lb>matching information-theoretic lower bound.",
    "creator" : "LaTeX with hyperref package"
  }
}