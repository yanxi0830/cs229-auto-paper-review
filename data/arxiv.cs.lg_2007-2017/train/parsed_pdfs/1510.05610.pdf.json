{
  "name" : "1510.05610.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Stochastically Transitive Models for Pairwise Comparisons: Statistical and Computational Issues",
    "authors" : [ "Nihar B. Shah", "Sivaraman Balakrishnan", "Adityanand Guntuboyina", "Martin J. Wainright" ],
    "emails" : [ "nihar@eecs.berkeley.edu,", "sbalakri@berkeley.edu,", "aditya@stat.berkeley.edu,", "wainwrig@berkeley.edu." ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Pairwise comparison data is ubiquitous and arises naturally in a variety of applications, including tournament play, voting, online search rankings, and ad placement problems. In rough terms, given a set of n objects, and a collection of possibly inconsistent comparisons between pairs of these objects, the goal is to aggregate these comparisons in order to perform effective statistical inference on various underlying properties of the population. Particular properties of interest include the ordering of the objects and the underlying pairwise comparison probabilities—that is, the probability that object i is preferred to object j in a pairwise comparison. The Bradley-Terry-Luce [BT52, Luc59] and Thurstone [Thu27] models are mainstays in analyzing this type of pairwise comparison data. These models are parametric in nature: more specifically, they assume the existence of an n-dimensional weight vector that measures the quality or strength of each item. The pairwise comparison probabilities are then determined via some fixed (parametric) function of the qualities of the pair of objects. Estimation in these models reduces to estimating the underlying weight vector, and a large body of\nAuthor email addresses: nihar@eecs.berkeley.edu, sbalakri@berkeley.edu, aditya@stat.berkeley.edu, wainwrig@berkeley.edu.\nar X\niv :1\n51 0.\n05 61\n0v 1\n[ st\nat .M\nL ]\n1 9\nO ct\nprior work has focused on these models (see, e.g., [NOS12, HOX14, SBB+15]). These models however, enforce strong relationships on the pairwise comparison probabilities that often fail to hold in real applications. Various papers [DM59, ML65, Tve72, BW97] have provided experimental results in which these parametric modeling assumptions fail to hold.\nOur focus in this paper is on models that have their roots in social science and psychology (e.g., see Fishburn [Fis73] for an overview), where the only coherence assumption made on the pairwise comparison probabilities is that of strong stochastic transitivity, or SST for short. These models include the parametric models as special cases but are considerably more general. The SST model has been validated by several empirical analyses, including those in a long line of work [DM59, ML65, Tve72, BW97]. The conclusion of Ballinger et al. [BW97] is especially strongly worded:\nAll of these parametric c.d.f.s are soundly rejected by our data. However, SST usually survives scrutiny.\nWe are thus provided with strong empirical motivation for studying the fundamental properties of pairwise comparison probabilities satisfying SST.\nIn this paper, we focus on the problem of estimating the matrix of pairwise comparison probabilities—that is, the probability that an item i will beat a second item j in any given comparison. Estimates of these comparison probabilities are useful in various applications. For instance, when the items correspond to players or teams in a sport, the predicted odds of one team beating the other are central to betting and bookmaking operations. In a supermarket or an ad display, an accurate estimate of the probability of a customer preferring one item over another, along with the respective profits for each item, can effectively guide the choice of which product to display. Accurate estimates of the pairwise comparison probabilities can also be used to infer partial or full rankings of the underlying items.\nOur contributions: We begin by studying the performance of optimal methods for estimating matrices in the SST class: our first main result (Theorem 1) characterizes the minimax rate in squared Frobenius norm up to logarithmic factors. This result reveals that even though the SST class of matrices is considerably larger than the classical parametric class, surprisingly, it is possible to estimate any SST matrix at the same rate as the classical parametric family. On the other hand, computing the least-squares solution over the SST class is non-trivial, as a brute force approach entails an exhaustive search over permutations. Accordingly, we turn to studying computationally tractable estimation procedures. Our second main result (Theorem 2) applies to a polynomial-time estimator based on thresholding the singular values of the data matrix. An estimator based on hard-thresholding was studied previously in this context by Chatterjee [Cha14]. We sharpen and generalize this previous analysis, and give a tight characterization of the rate achieved by both hard and soft thresholding estimators. Our third contribution, formalized in Theorems 3 and 4, is to show that for certain interesting subsets of the full SST class, a combination of parametric maximum likelihood [SBB+15] and noisy sorting algorithms [BM08] leads to a tractable two-stage method that achieves the minimax rate. Our fourth contribution is to supplement our minimax lower bound with lower bounds for various known estimators, including those based on thresholding singular values [Cha14], noisy sorting [BM08], and parametric methods [NOS12, HOX14, SBB+15]) based on parametric models. These lower bounds show that none of these tractable estimators achieve the minimax rate uniformly over the entire class. The lower bounds also show that the minimax rates for any of these subclasses is no better than the full SST class.\nRelated work: The literature on ranking and estimation from pairwise comparisons is vast and we refer the reader to various surveys [FV93, Mar96, Cat12] for a more detailed overview. We focus our literature review on papers that are closely related to the contributions of our work. Some recent work [NOS12, HOX14, SBB+15] studies procedures and minimax rates for estimating the latent quality vector that underlie such parametric models. Theorem 4 in this paper provides an extension of these results, in particular by showing that an optimal estimate of the latent quality vector can be used to construct an optimal estimate of the pairwise comparison probabilities. Chatterjee [Cha14] formally introduced the estimation problem considered in this paper, and analyzed an estimator based on singular value thresholding. In Theorem 2, we provide a sharper analysis of this estimator, and show that our upper bound is—in fact—unimprovable.\nIn past work, various authors [KMS07, BM08] have considered the noisy sorting problem, in which the goal is to infer the underlying order under the assumption that each pairwise comparison has a probability of agreeing with the underlying order that is bounded away from 12 by a fixed constant. These works provide polynomial-time algorithms to infer the true underlying order with a certain accuracy. Part of our analysis leverages an algorithm from the paper [BM08]; in particular, we extend their analysis in order to provide guarantees for estimating pairwise comparison probabilities as opposed to estimating the underlying order.\nAs will be clarified in the sequel, the assumption of strong stochastic transitivity, has close connections to the statistical literature on shape constrained inference (e.g., [SS11]), particularly to the problem of bi-variate isotonic regression. In our analysis of the leastsquares estimator, we leverage metric entropy bounds from past work in this area (e.g., [GW07, CGS15])."
    }, {
      "heading" : "2 Background and problem formulation",
      "text" : "Given a collection of n ≥ 2 items, suppose that we have a mechanism for making noisy comparisons between any pair i 6= j of distinct items. The full set of all possible pairwise comparisons can be described by a probability matrix M∗ ∈ [0, 1]n×n, in which M∗ij is the probability that item i is preferred to item j. The upper and lower halves of the probability matrix M∗ are related by the shifted-skew-symmetry condition M∗ji = 1−M∗ij for all i, j ∈ [n].1"
    }, {
      "heading" : "2.1 Estimation of pairwise comparison probabilities",
      "text" : "Given any matrix M∗ ∈ [0, 1]n×n with M∗ij = 1−M∗ji for every (i, j), suppose that we observe a random matrix Y ∈ {0, 1}n×n with (upper-triangular) independent Bernoulli entries, in particular, with P[Yij = 1] = M∗ij for every 1 ≤ i ≤ j ≤ n and Yji = 1 − Yij . Based on observing Y , our goal in this paper is to recover an accurate estimate, in the squared Frobenius norm, of the full matrix M∗.\nOur primary focus in this paper will be on the setting where for n items we observe the outcome of a single pairwise comparison for each pair. We will subsequently also address the more general case when we have partial observations, that is, when each pairwise comparison is observed with a fixed probability.2\n1In other words, the shifted matrix M∗ − 1 2\nis skew-symmetric. 2The extension to other observation models, with multiple and/or uneven observations across different pairs\nfor instance, is also interesting but beyond the scope of this work.\nFor future reference, note that we can always write the Bernoulli observation model in the linear form\nY = M∗ +W, (1)\nwhere W ∈ [−1, 1]n×n is a random matrix with independent zero-mean entries for every i ≥ j given by\nWij ∼ { 1−M∗ij with probability M∗ij −M∗ij with probability 1−M∗ij ,\n(2)\nand Wji = −Wij for every i < j. This linearized form of the observation model is convenient for subsequent analysis."
    }, {
      "heading" : "2.2 Strong stochastic transitivity",
      "text" : "Beyond the previously mentioned constraints on the matrix M∗—namely that M∗ij ∈ [0, 1] and that M∗ij = 1 −M∗ij—more structured and interesting models are obtained by imposing further restrictions on the entries of M∗. We now turn to one such condition, known as strong stochastic transitivity (SST), which reflects the natural transitivity of any complete ordering. Formally, suppose that the full collection of items [n] is endowed with a complete ordering π∗. We use the notation π∗(i) π∗(j) to convey that item i is preferred to item j in the total ordering π∗. Consider some triple (i, j, k) such that π∗(i) π∗(j). A matrix M∗ satisfies the SST condition if the inequality M∗ik ≥ M∗jk holds for every such triple. The intuition underlying this constraint is as follows: since i dominates j in the true underlying order, when we make noisy comparisons, the probability that i is preferred to k should be at least as large as the probability that j is preferred to k. The SST condition was first described3 in the psychology literature (e.g., [Fis73, DM59]).\nThe SST condition is characterized by the existence of a permutation such that the permuted matrix has entries that increase across rows and decrease down columns. More precisely, for a given permutation π∗, let us say that a matrix M is π∗-faithful if for every pair (i, j) such that π∗(i) π∗(j), we have Mik ≥Mjk for all k ∈ [n]. With this notion, the set of SST matrices is given by\nCSST = { M ∈ [0, 1]n×n | Mba = 1−Mab ∀ (a, b), and ∃ perm. π∗ s.t. M is π∗-faithful } . (3)\nNote that the stated inequalities also guarantee that for any pair with π∗(i) π∗(j), we have Mki ≤ Mkj for all k, which corresponds to a form of column ordering. The class CSST will be our primary focus in this paper."
    }, {
      "heading" : "2.3 Classical parametric models",
      "text" : "Let us now describe a family of classical parametric models, one which includes BradleyTerry-Luce and Thurstone (Case V) models [BT52, Luc59, Thu27]. As we will see, they can be understood as inducing a relatively small subclass of the SST matrices CSST.\nIn more detail, parametric models are described by a weight vector w∗ ∈ Rn that corresponds to the notional qualities of the n items. Moreover, consider any non-decreasing\n3We note that the psychology literature has also considered what are known as weak and moderate stochastic transitivity conditions. From a statistical standpoint, pairwise comparison probabilities cannot be consistently estimated in a minimax sense under these conditions. We establish this formally in Appendix C.\nfunction F : R 7→ [0, 1] such that F (t) = 1−F (−t) for all t ∈ R; we refer to any such function F as being valid. Any such pair (F,w∗) induces a particular pairwise comparison model in which\nM∗ij = F (w ∗ i − w∗j ) for all pairs (i, j). (4)\nFor each valid choice of F , we define CPAR(F ) = { M ∈ [0, 1]n×n |M induced by Equation (4) for some w∗ ∈ Rn } . (5)\nFor any choice of F , it is straightforward to verify that CPAR(F ) is a subset of CSST, meaning that any matrix M induced by the relation (4) satisfies all the constraints defining the set CSST. As particular important examples, we recover the Thurstone model by setting F (t) = Φ(t) where Φ is the Gaussian CDF, and the Bradley-Terry-Luce model by setting F (t) = e t\n1+et , corresponding to the sigmoid function.\nRemark: One can impose further constraints on the vector w∗ without reducing the size of the class {CPAR(F ), for some valid F}. In particular, since the pairwise probabilities depend only on the differences w∗i − w∗j , we can assume without loss of generality that 〈w∗, 1〉 = 0. Moreover, since the choice of F can include rescaling its argument, we can also assume that ‖w∗‖∞ ≤ 1. Accordingly, we assume in our subsequent analysis that w∗ belongs to the set{ w ∈ Rn | such that 〈w, 1〉 = 0 and ‖w‖∞ ≤ 1. } ."
    }, {
      "heading" : "2.4 Inadequacies of parametric models",
      "text" : "As noted in the introduction, a large body of past work (e.g., [DM59, ML65, Tve72, BW97]) has shown that parametric models, of the form (5) for some choice of F , often provide poor fits to real-world data. What might be a reason for this phenomenon? Roughly, parametric models impose the very restrictive assumption that the choice of an item depends on the value of a single latent factor (as indexed by w∗)—e.g., that our preference for cars depends only on their fuel economy, or that the probability that one hockey team beats another depends only on the skills of the goalkeepers.\nThis intuition can be formalized to construct matrices M∗ ∈ CSST that are far away from every valid parametric approximation as summarized in the following result:\nProposition 1. For every n ≥ 4, there exist matrices M∗ ∈ CSST such that\ninf valid F inf M∈CPAR(F )\n|||M −M∗|||2F ≥ Kn2, (6)\nfor some universal constant K > 0.\nGiven the interval constraints [0, 1], the Frobenius norm diameter of the class CSST is at most n2, so that the quadratic scaling of the lower bound (6) cannot be sharpened.\nWhat sort of matrices M∗ are “bad” in the sense of satisfying a lower bound of the form (6)? Panel (a) of Figure 1 describes the construction of one “bad” matrix M∗. To provide some intuition, let us return to the analogy of rating cars. A key property of any parametric model is that if we prefer car 1 to car 2 more than we prefer car 3 to car 4, then we must also prefer car 1 to car 3 more than we prefer car 2 to car 4.4 This condition is\n4This condition follows from the proof of Proposition 1.\npotentially satisfied if there is a single determining factor across all cars, for instance, the fuel economy.\nThis ordering condition is, however, violated by the pairwise matrix M∗ from Figure 1(a). In this example, we have M∗12 = 6 8 > 5 8 = M ∗ 34 and M ∗ 13 = 7 8 < 8 8 = M ∗ 24. Such an occurrence can be explained by a simple two-factor model: suppose the fuel economies of cars 1, 2, 3 and 4 are 20, 18, 12 and 6 kilometers per liter respectively, and the comfort levels of the four cars are also ordered as 1 2 3 4. Suppose that in a pairwise comparison of two cars, if one car is more fuel efficient by at least 10 kilometers per liter, it is always chosen. Otherwise the choice is governed by a parametric choice model acting on the respective comfort levels of the two cars. Observe that while the comparisons between the pairs (1, 2), (3, 4) and (1, 3) of cars can be explained by this parametric model acting on their respective comfort levels, the preference between cars 1 and 4, as well as between cars 2 and 4, is governed by their fuel economies. This two-factor model accounts for the said values of M∗12, M ∗ 34, M ∗ 24 and M ∗ 13, which violate parametric requirements. While this was a simple hypothetical example, there is a more ubiquitous phenomenon underlying our example. It is often the case that our preferences are decided by comparing items on a multitude of dimensions. In any situation where a single (latent) parameter per item does not adequately explain our preferences, one can expect that the class of parametric models to provide a poor fit to the pairwise preference probabilities.\nThe lower bound on approximation quality guaranteed by Proposition 1 means that any parametric estimator of the matrix M∗ should perform poorly. This expectation is confirmed by the simulation results in panel (b) of Figure 1. After generating observations from a “bad matrix” over a range of n, then fit the data set using either the maximum likelihood estimate in the Thurstone model, or the singular value thresholding (SVT) estimator, to be discussed in Section 3.2. For each estimator M̂ , we plot the rescaled Frobenius norm error |||M̂−M∗|||2F\nn2\nversus the sample size. Consistent with the lower bound (6), the error in the Thurstone-based estimator stays bounded above a universal constant. In contrast, the SVT error goes to zero with n, and as our theory in the sequel shows, the rate at which the error decays is at least\nas fast as 1/ √ n."
    }, {
      "heading" : "3 Main results",
      "text" : "Thus far, we have introduced two classes of models for matrices of pairwise comparison probabilities. Our main results provide characterizations of the estimation error associated with different subsets of these classes, using either optimal estimators (that we suspect are not polynomial-time computable), or more computationally efficient estimators that can be computed in polynomial-time."
    }, {
      "heading" : "3.1 Characterization of the minimax risk",
      "text" : "We begin by providing a result that characterizes the minimax risk in squared Frobenius norm over the class CSST of SST matrices. It involves taking an infimum over the set of all possible estimators, which are measurable functions Y 7→ M̃ ∈ [0, 1]n×n. Here the data matrix Y ∈ {0, 1}n×n is drawn from the observation model (1).\nTheorem 1. There are universal constants 0 < K` < Ku such that\nK` n ≤ inf M̃ sup M∗∈CSST 1 n2 E[|||M̃ −M∗|||2F] ≤ Ku\nlog2(n)\nn , (7)\nwhere the infimum ranges over all measurable functions M̃ of the data matrix.\nWe prove this theorem in Section 5.1. The proof of the lower bound is based on extracting a particular subset of CSST such that any matrix in this subset has at least n positions that are unconstrained, apart from having to belong to the interval [12 , 1]. We can thus conclude that estimation of the full matrix is at least as hard as estimating n numbers belonging to the interval [12 , 1] based on a single observation per number, and this leads to an Ω(n\n−1) lower bound, as stated.\nProving an upper bound requires substantially more effort. In particular, we establish it via careful analysis of the constrained least-squares estimator\nM̂ ∈ arg min M∈CSST |||Y −M |||2F. (8a)\nIn particular, we prove that there are universal constants (c0, c1, c2) such that, for any matrix M∗ ∈ CSST, this estimator satisfies the high probability bound\nP [ 1 n2 |||M̂ −M∗|||2F ≥ c0 log2(n) n ] ≤ c1e−c2n. (8b)\nSince the entries of M̂ and M∗ all lie in the interval [0, 1], this tail bound implies the upper bound on the expected mean-squared error stated in Equation (7). Proving the high probability bound (8b) requires sharp control on a quantity known as the localized Gaussian complexity of the class CSST. We use Dudley’s entropy integral in order to derive an upper bound that is sharp up to a logarithmic factor; doing so in turn requires deriving upper bounds on the metric entropy of the class CSST for which we leverage the prior work of Gao and Wellner [GW07].\nWe do not know whether the constrained least-squares estimator (8a) is computable in time polynomial in n, but we suspect not. This complexity is a consequence of the fact that\nthe set CSST is not convex, but is a union of n! convex sets. Given this issue, it becomes interesting to consider the performance of alternative estimators that can be computed in polynomial-time."
    }, {
      "heading" : "3.2 Sharp analysis of singular value thresholding (SVT)",
      "text" : "The first polynomial-time estimator that we consider is a simple estimator based on thresholding singular values of the observed matrix Y , and reconstructing its truncated SVD. For the full class CSST, Chatterjee [Cha14] analyzed the performance of such an estimator and proved that the squared Frobenius error decays as O(n− 1 4 ) uniformly over CSST. In this section, we prove that its error decays as O(n− 1 2 ), again uniformly over CSST, and moreover, that this upper bound is unimprovable. Let us begin by describing the estimator. Given the observation matrix Y ∈ Rn×n, we can write its singular value decomposition as Y = UDV T , where the (n×n) matrix D is diagonal, whereas the (n× n) matrices U and V are orthonormal. Given a threshold level λn > 0, the soft-thresholded version of a diagonal matrix D is the diagonal matrix Tλn(D) with values\n[Tλn(D)]jj = max{0, Djj − λn} for every integer j ∈ [1, n]. (9)\nWith this notation, the soft singular-value-thresholded (soft-SVT) version of Y is given by Tλn(Y ) = UTλn(D)V\nT . The following theorem provides a bound on its squared Frobenius error:\nTheorem 2. There are universal positive constants (Ku, c0, c1) such that the soft-SVT estimator M̂λn = Tλn(Y ) with λn = 2.1 √ n satisfies the bound\nP [ 1 n2 |||M̂λn −M∗|||2F ≥ Ku√ n ] ≤ c0e−c1n (10a)\nfor any M∗ ∈ CSST. Moreover, there is a universal constant K` > 0 such that for any choice of λn, we have\nsup M∗∈CSST\n1\nn2 |||M̂λn −M∗|||2F ≥ K`√ n . (10b)\nA few comments on this result are in order. Since the matrices M̂λn and M ∗ have entries in the unit interval [0, 1], the normalized squared error 1 n2 |||M̂λn −M∗|||2F is at most 1. Consequently, tail bound (10a) guarantees that\nsup M∗∈CSST\nE[ 1\nn2 |||M̂λn −M∗|||2F] ≤ Ku√ n + c0e −c1n ≤ K ′ u√ n . (11)\nOn the other hand, the matching lower bound (10b) holds with probability one, meaning that the soft-SVT estimator incurs an error of the order 1/ √ n irrespective of the realization of the noise. To be clear, Chatterjee [Cha14] actually analyzed the hard-SVT estimator, which is based on the hard-thresholding operator\n[Hλn(D)]jj = Djj 1{Djj ≥ λn}.\nHere 1{·} denotes the 0-1-valued indicator function. In this setting, the hard-SVT estimator is simply, Hλn(Y ) = UHλn(D)V T . With essentially the same choice of λn as above, Chatterjee\nshowed that the estimate Hλn(Y ) has a mean-squared error of O(n−1/4). One can verify that the proof of Theorem 2 in our paper goes through for the hard-SVT estimator as well. Consequently the performance of the hard-SVT estimator is of the order Θ(n−1/2), and is identical to that of the soft-thresholded version up to universal constants.\nTogether the upper and lower bounds of Theorem 2 provide a sharp characterization of the behavior of the soft/hard SVT estimators. On the positive side, these are easily implementable estimators that achieve a mean-squared error bounded by O(1/ √ n) uniformly over the entire class CSST. On the negative side, this rate is slower than the O(log2 n/n) rate achieved by the least-squares estimator, as in Theorem 1.\nIn conjunction, Theorems 1 and 2 raise a natural open question: is there a polynomialtime estimator that achieves the minimax rate uniformly over the family CSST? We do not know the answer to this question, but the following subsections provide some partial answers by analyzing some polynomial-time estimators that (up to logarithmic factors) achieve the optimal Õ(1/n)-rate over some interesting sub-classes of CSST. In the next two sections, we turn to results of this type."
    }, {
      "heading" : "3.3 Optimal rates for high SNR subclass",
      "text" : "In this section, we describe a multi-step polynomial-time estimator that (up to logarithmic factors) can achieve the optimal Õ(1/n) rate over an interesting subclass of CSST. This subset corresponds to matrices M that have a relatively high signal-to-noise ratio (SNR), meaning that no entries of M fall within a certain window of 1/2. More formally, for some γ ∈ (0, 12), we define the class\nCHIGH(γ) = {M ∈ CSST | max(Mij ,Mji) ≥ 1/2 + γ ∀ i 6= j} . (12)\nFor any matrix CHIGH(γ), the amount of information contained in each observation is bounded away from zero uniformly in n, as opposed to matrices in which some large subset of entries have values equal (or arbitrarily close) to 12 . In terms of estimation difficulty, this SNR restriction does not make the problem substantially easier: as the following theorem shows, the minimax mean-squared error remains lower bounded by a constant multiple of 1/n. Moreover, we can demonstrate a polynomial-time algorithm that achieves this optimal mean squared error up to logarithmic factors.\nThe following theorem applies to any fixed γ ∈ (0, 12 ] independent of n, and involves constants (K`,Ku, c) that may depend on γ but are independent of n.\nTheorem 3. There is a constant K` > 0 such that\ninf M̃ sup M∗∈CHIGH(γ)\n1 n2 E [ |||M̃ −M∗|||2F] ≥ K` n , (13a)\nwhere the infimum ranges over all estimators. Moreover, there is a two-stage estimator M̂ , computable in polynomial-time, for which\nP [ 1 n2 |||M̂ −M∗|||2F ≥ Ku log 2(n) n ] ≤ c n2 , (13b)\nvalid for any M∗ ∈ CHIGH(γ).\nAs before, since the ratio 1 n2 |||M̂ −M∗|||2F is at most 1, so the tail bound (13b) implies that\nsup M∗∈CHIGH(γ)\nE [ |||M̂ −M∗|||2F\nn2\n] ≤ Ku log 2(n)\nn +\nc n2 ≤ K\n′ u log 2(n)\nn . (14)\nWe provide the proof of this theorem in Section 5.3. As with our proof of the lower bound in Theorem 1, we prove the lower bound by considering the sub-class of matrices that are free only on the two diagonals just above and below the main diagonal. We now provide a brief sketch for the proof of the upper bound (13b) which is based on analyzing the following two-step procedure:\n1. In the first step of algorithm, we find a permutation π̂FAS of the n items that minimizes the total number of disagreements with the observations. (For a given ordering, we say that any pair of items (i, j) are in disagreement with the observation if either i is rated higher than j in the ordering and Yij = 0, or if i is rated lower than j in the ordering and Yij = 1.) The problem of finding such a disagreement-minimizing permutation π̂FAS is commonly known as the minimum feedback arc set (FAS) problem. It is known to be NP-hard in the worst-case [ACN08, Alo06], but our set-up has additional probabilistic structure that allows for polynomial-time solutions with high probability. In particular, we call upon a polynomial-time algorithm due to Braverman and Mossel [BM08] that, under the model (12), is guaranteed to find the exact solution to the FAS problem with high probability. Viewing the FAS permutation π̂FAS as an approximation to the true permutation π∗, the novel technical work in this first step is show that π̂FAS is “good enough” for Frobenius norm estimation, in the sense that for any M∗ ∈ CHIGH(γ), it satisfies the bound\n1\nn2 |||π∗(M∗)− π̂FAS(M∗)|||2F ≤\nK log n\nn (15a)\nwith high probability. In this statement, for any given permutation π, we have used π(M∗) to denote the matrix obtained by permuting the rows and columns of M∗ by π. The term 1 n2 |||π∗(M∗) − π̂FAS(M∗)|||2F can be viewed in some sense as the bias in estimation incurred from using π̂FAS in place of π ∗.\n2. Define CBISO be the class of matrices M ∈ [0, 1]n×n that satisfy the linear constraints Mij = 1 −Mji for all (i, j) ∈ [n]2, and Mk` ≥ Mij whenever k ≤ i and ` ≥ j. This class corresponds to the subset of matrices CSST that are faithful with respect to the identity permutation. Letting π̂FAS(CBISO) = {π̂FAS(M), M ∈ CBISO} denote the image of this set under π̂FAS, the second step involves computing the constrained least-squares estimate\nM̂ ∈ arg min M∈π̂FAS(CBISO) |||Y −M |||2F. (15b)\nSince the set π̂FAS(CBISO) is a convex polytope, with a number of facets that grows polynomially in n, the constrained quadratic program (15b) can be solved in polynomial-time. The\nfinal step in the proof of Theorem 3 is to show that the estimator M̂ also has mean-squared error that is upper bounded by a constant multiple of log 2(n) n with high probability.\nOur analysis shows that for any fixed γ ∈ (0, 12 ], the proposed two-step estimator works well for any matrix M∗ ∈ CHIGH(γ). Since this two-step estimator is based on finding a minimum feedback arc set (FAS) in the first step, it is natural to wonder whether an FASbased estimator works well over the full class CSST. Somewhat surprisingly the answer to this question turns out to be negative: we refer the reader to Appendix B for more intuition and details on why the minimal FAS estimator does not perform well over the full class."
    }, {
      "heading" : "3.4 Optimal rates for parametric subclasses",
      "text" : "Let us now return to the class of parametric models CPAR(F ) introduced earlier in Section 2.3. As shown previously in Proposition 1, this class is much smaller than the class CSST, in the sense that there are models in CSST that cannot be well-approximated by any parametric model. Nonetheless, in terms of minimax rates of estimation, these classes differ only by logarithmic factors. An advantage of the parametric class is that it is possible to achieve the 1/n minimax rate by using a simple, polynomial-time estimator. In particular, for any log concave function F , the maximum likelihood estimate ŵML can be obtained by solving a convex program. This MLE induces a matrix estimate M(ŵML) via Equation (4), and the following result shows that this estimator is minimax-optimal up to constant factors.\nTheorem 4. Suppose that F is strictly increasing, strongly log-concave and twice differentiable. Then there is a constant K` > 0, depending only on F , such that the minimax risk over CPAR(F ) is lower bounded as\ninf M̃ sup M∗∈CPAR(F )\n1\nn2 E[|||M̃ −M∗|||2F] ≥ K` n , (16a)\nConversely, there is a constant Ku ≥ K`, depending only on F , such that the matrix estimate M(ŵML) induced by the MLE satisfies the bound\nsup M∗∈CPAR(F )\n1\nn2 E[|||M(ŵML)−M∗|||2F] ≤ Ku n . (16b)\nTo be clear, the constants (K`,Ku) in this theorem are independent of n, but they do depend on the specific properties of a given function F . We note that the stated conditions on F are true for many popular parametric models, including (for instance) the Thurstone and BTL models.\nWe provide the proof of Theorem 4 in Section 5.4. The lower bound (16a) is, in fact, stronger than the the lower bound in Theorem 1, since the supremum is taken over a smaller class. The proof of the lower bound in Theorem 1 relies on matrices that cannot be realized by any parametric models, so that we pursue a different route to establish the bound (16a). On the other hand, in order to prove the upper bound (16b), we make use of bounds on the accuracy of the MLE ŵML from our own past work (see the paper [SBB +15])."
    }, {
      "heading" : "3.5 Extension to partial observations",
      "text" : "We now consider the extension of our results to the setting in which not all entries of Y are observed. Suppose instead that every entry of Y is observed independently with probability pobs. In other words, the set of pairs compared is the set of edges of an Erdős-Rényi graph G(n, pobs) that has the n items as its vertices. In this setting, we obtain upper bounds by setting Yij = 1 2 whenever the pair (i, j) is not compared, and applying the algorithms studied earlier to the resulting matrix Y .\nTheorem 5. In the partial observation setting described above:\n(a) There are positive universal constants K` and Ku such that the minimax risk is sandwiched as\nK` max { 1 pobsn , 1 n2 } ≤ inf M̃ sup M∗∈CSST 1 n2 E[|||M̂ −M∗|||2F] ≤ Ku min {(log n)2 p2obsn , 1 pobs √ n } .\n(17a)\n(b) The soft-SVT estimator M̂λn,pobs with λn,pobs = 2.1 √ n pobs satisfies the bound:\nsup M∗∈CSST\n1\nn2 E[|||M̂λn,pobs −M\n∗|||2F] ≤ Ku\npobs √ n . (17b)\n(c) For a parametric sub-class based on a strongly log-concave and smooth F , there is a\npolynomial-time estimator M̂ such that\nsup M∗∈CPAR(F )\n1\nn2 E[|||M̂ −M∗|||2F] ≤ Ku pobsn , valid when pobs ≥ K (logn) 2 n , (17c)\nwhere K > 0 is a universal constant.\nProving the lower bound in Equation (17a) requires a nuanced construction of a packing set of matrices in CSST that depends on pobs. The upper bound in Equation (17a) follows from a modification of the analysis of the least-squares estimator (8a) in the proof of Theorem 1. Apart from the logarithmic factors, the main difference between the upper and lower bounds is the (pobsn) −1 scaling of the lower bound as compared to the (p2obsn) −1 scaling of the upper bound. Since the expected number of observed entries scales proportionally with pobs (as opposed to p2obs), we conjecture that the lower bound is tight (up to logarithmic factors).\nThe proof of the upper bound (17c) for the parametric models is based on an extension of corresponding proof from the case of complete observations. In general, we are interested in scalings of pobs, which allow pobs → 0 as n→∞. We note that we do not have an analogue of the high-SNR result in the partial observations case since having partial observations reduces the SNR; the noisy-sorting algorithm of Braverman and Mossel [BM08] for the high-SNR case requires a computational complexity of eγ −4 and hence is not computable in time polynomial in n when γ < (log n)− 1 4 , and this disallows most interesting scalings of pobs with n."
    }, {
      "heading" : "4 Simulations",
      "text" : "In this section, we present results from simulations to gain a further understanding of the problem at hand, in particular to understand the rates of estimation under specific generative models. We investigate the performance of the soft-SVT estimator (Section 3.2) and the maximum likelihood estimator under the Thurstone model (Section 2.3).5 The output of the SVT estimator need not lie in the set [0, 1]n×n of matrices; in our implementation, we take a projection of the output of the SVT estimator on this set, which gives a constant factor reduction in the error.\nIn our simulations, we generate the ground truth M∗ in the following five ways: • Uniform: The matrix M∗ is generated by drawing ( n 2 ) values independently and uniformly\nat random in [12 , 1] and sorting them in descending order. The items are then inserted above the diagonal of an (n×n) matrix such that the entries decrease down a column or left along a row. We then make the matrix skew-symmetric and permute the rows and columns.\n5We could not compare the algorithm that underlies Theorem 3, since it is not easily implementable. In particular, it relies on the algorithm due to Braverman and Mossel [BM08] to compute the feedback arc set minimizer. The computational complexity of this algorithm, though polynomial in n, has a very large polynomial degree which precludes it from being implemented for matrices of any reasonable size.\nThe simulations in this section add to the simulation results of Section 2.4 (Figure 1) demonstrating a large class of matrices in the SST class that cannot be represented by any parametric class.\n• Thurstone: The weight vector M∗ is generated by first choosing w∗ uniformly at random from the set satisfying 〈w∗, 1〉 = 0 and ‖w∗‖∞ ≤ 1, and then setting M∗ij = Φ(w∗i − w∗j ) where Φ is the CDF of the standard normal distribution. The matrix M∗ is then generated from w∗ via Equation (4).\n• Bradley-Terry-Luce (BTL): Identical to the Thurstone case, except that F is given by the sigmoid function.\n• High SNR: A setting studied previously by Braverman and Mossel [BM08], in which the noise is independent of the items being compared. Some global order is fixed over the n items, and the comparison matrix M∗ takes the values M∗ij = 0.9 = 1−M∗ji for every pair (i, j) where i is ranked above j in the underlying ordering. The entries on the diagonal are 0.5.\n• Independent bands: The matrix M∗ is chosen with diagonal entries all equal to 12 . Entries on diagonal band immediately above the diagonal itself are chosen i.i.d. and uniformly at random from [12 , 1]\nn−1. The band above is then chosen uniformly at random from the allowable set, and so on. The choice of any entry in this process is only constrained to be upper bounded by 1 and lower bounded by the entries to its left and below. The entries below the diagonal are chosen to make the matrix skew-symmetric.\nFigure 2 depicts the results of the simulations based on observations of the entire matrix Y . Each point is an average across T = 20 trials. The error bars in most cases are too small and hence not visible. We see that the uniform case (Figure 2a) is favorable for both estimators, with the error scaling as O( 1√\nn ). With data generated from the Thurstone model, both\nestimators continue to perform well, and the Thurstone MLE yields an error of the order 1n (Figure 2b). Interestingly, the Thurstone model also fits relatively well when data is generated via the BTL model (Figure 2c). This behavior is likely a result of operating in the near-linear regime of the logistic and the Gaussian CDF where the two curves are similar. In these two parametric settings, the SVT estimator incurs an error strictly worse than order 1n but better than 1√\nn . The Thurstone model, however, yields a poor fit for the model in the high-\nSNR (Figure 2d) and the independent bands (Figure 2e) cases, incurring a constant error as compared to an error scaling as O( 1√\nn ) for the SVT estimator. We recall that the poor\nperformance of the Thurstone estimator was also described previously in Proposition 1. In summary, we see that while the Thurstone MLE estimator gives minimax optimal rates of estimation when the underlying model is parametric, it can be inconsistent when the parametric assumptions are violated. On the other hand, the SVT estimator is robust to violations of parametric assumptions, and while it does not necessarily give minimax-optimal rates, it remains consistent across the entire SST class."
    }, {
      "heading" : "5 Proofs of main results",
      "text" : "This section is devoted to the proofs of our main results–namely, Theorems 1 through 5. Throughout these and other proofs, we use the notation {c, c′, c0, C, C ′} and so on to denote positive constants whose values may change from line to line. In addition, we assume throughout that n is lower bounded by a universal constant so as to avoid degeneracies. For any square matrix A ∈ Rn×n, we let {σ1(A), . . . , σn(A)} denote its singular values (ordered from largest to smallest), and similarly, for any symmetric matrix M ∈ Rn×n, we let {λ1(M), . . . , λn(M)} denote its ordered eigenvalues."
    }, {
      "heading" : "5.1 Proof of Theorem 1",
      "text" : "This section is devoted to the proof of Theorem 1, including both the upper and lower bounds on the minimax risk in squared Frobenius norm."
    }, {
      "heading" : "5.1.1 Proof of upper bound",
      "text" : "Define the difference ∆̂ = M̂−M∗ between M∗ and the optimal solution M̂ to the constrained least-squares problem. Since M̂ is optimal andM∗ is feasible, we have |||Y −M̂ |||2F ≤ |||Y −M∗|||2F, and hence following some algebra, we arrive at the basic inequality\n1 2 |||∆̂|||2F ≤ 〈〈∆̂, W 〉〉,\nwhere W ∈ Rn×n is the noise matrix in the observation model (1), and 〈〈A, B〉〉 = trace(ATB) is the trace inner product.\nWe introduce some additional objects that are useful in our analysis. First, we recall our earlier definition of the class of bivariate isotonic matrices under the identity permutation, CBISO ∈ [0, 1]n×n, is the set:\nCBISO : = { M ∈ [0, 1]n×n | |Mk` ≥Mij whenever k ≤ i and ` ≥ j } . (18)\nFor a given permutation π and matrix M , we let π(M) denote the matrix obtained by applying π to its rows and columns. Now let CDIFF ∈ [−1, 1]n×n be the set of differences between pairs of matrices in CBISO, that is,\nCDIFF : = { π1(M1)− π2(M2) | for some M1, M2 ∈ CBISO, and perm. π1 and π2 } . (19)\nOne can verify that for any M∗ ∈ CSST, we are guaranteed the inclusion\n{M −M∗ |M ∈ CSST, |||M −M∗|||F ≤ t} ⊂ {D ∈ CDIFF | |||D|||F ≤ t}.\nNow for each choice of radius t > 0, define the random variable\nZ(t) : = sup D∈CDIFF,|||D|||F≤t\n〈〈D, W 〉〉. (20)\nUsing our earlier basic inequality, the Frobenius norm error |||∆̂|||F then satisfies the bound\n1 2 |||∆̂|||2F ≤ 〈〈∆̂, W 〉〉 ≤ Z\n( |||∆̂|||F ) . (21)\nThus, in order to obtain a high probability bound, we need to understand the behavior of the random quantity Z(δ).\nOne can verify that the set CDIFF is star-shaped, meaning that αD ∈ CDIFF for every α ∈ [0, 1] and every D ∈ CDIFF. Using this star-shaped property, we are guaranteed that there is a non-empty set of scalars δn > 0 satisfying the critical inequality\nE[Z(δn)] ≤ δ2n 2 . (22)\nOur interest is in the smallest (strictly) positive solution δn to the critical inequality (22), and moreover, our goal is to show that for every t ≥ δn, we have |||∆̂|||F ≤ c √ tδn with probability at least 1− c1e−c2ntδn . Define a “bad” event At as\nAt = { ∃∆ ∈ CDIFF | |||∆|||F ≥ √ tδn and 〈〈∆, W 〉〉 ≥ 2|||∆|||F √ tδn } . (23)\nUsing the star-shaped property of CDIFF, it follows by a rescaling argument that P[At] ≤ P[Z(δn) ≥ 2δn √ tδn] for all t ≥ δn.\nThe entries of W lie in [−1, 1] and hence are 1-sub-Gaussian, are i.i.d. on and above the diagonal, are zero-mean, and satisfy skew-symmetry. Moreover, the function W 7→ Z(t) is convex and Lipschitz with parameter t. Consequently, by Ledoux’s concentration theorem [Led01, Theorem 5.9], we have\nP [ Z(δn) ≥ E[Z(δn)] + √ tδnδn ] ≤ 2e−c1tδn for all t ≥ δn.\nBy the definition of δn, we have E[Z(δn)] ≤ δ2n ≤ δn √ tδn for any t ≥ δn, and consequently\nP[At] ≤ P[Z(δn) ≥ 2δn √ tδn ] ≤ 2e−c1tδn for all t ≥ δn.\nConsequently, either |||∆̂|||F ≤ √ tδn, or we have |||∆̂|||F > √ tδn. In the latter case, conditioning on the complement Act , our basic inequality implies that 12 |||∆̂||| 2 F ≤ 2|||∆̂|||F √ tδn, and hence\n|||∆̂|||F ≤ 4 √ tδn with probability at least 1 − 2e−c1n logn. Putting together the pieces yields that\n|||∆̂|||F ≤ c0 √ tδn (24)\nwith probability at least 1− 2e−c1tδn for every t ≥ δn. In order to determine a feasible δn satisfying the critical inequality (22), we need to bound the expectation E[Z(δn)]. We do using Dudley’s entropy integral and bounding the metric entropies of certain sub-classes of matrices. In particular, the remainder of this section is devoted to proving the following claim:\nLemma 1. There is a universal constant C such that for all t ∈ [0, 2n], E[Z(t)] ≤ C { n log2(n) + t √ n log n } . (25)\nTaking this lemma as given for the moment, we see that the critical inequality (22) is satisfied for δn = C ′√n log n, and hence from our bound (24), we have\n|||∆̂|||2F n2 ≤ C ′′ log 2(n) n ,\nwith probability at least 1 − 2e−c1n(logn)2 , where C ′′ and c1 are positive universal constants. This argument completes the proof of the upper bound.\nIt remains to prove Lemma 1, and we do so by using Dudley’s entropy integral, as well as some auxiliary results on metric entropy. We use the notation logN( ,C, ρ) to denote the metric entropy of the class C in the metric ρ. Our proof requires the following auxiliary lemma:\nLemma 2. For every > 0, we have the metric entropy bound\nlogN( ,CDIFF, |||.|||F) ≤ 8 n2 2 ( log n )2 + 8n log n.\nSee the end of this section for the proof of this claim. Taking it as given for the moment, let us now prove Lemma 1. Letting BF (t) denote the Frobenius norm ball of radius t, the truncated form of Dudley’s entropy integral inequality yields\nE[Z(t)]] ≤ c inf δ∈[0,n]\n{ nδ + ∫ t δ 2 √ logN( ,CDIFF ∩ BF (t), |||.|||F)d } ≤ c { n−8 +\n∫ t 1 2 n−9 √ logN( ,CDIFF, |||.|||F)d } , (26)\nwhere the second step follows by setting δ = n−9, and making use of the set inclusion (CDIFF ∩ BF (t)) ⊆ CDIFF. For any ≥ 12n\n−9, applying Lemma 2 yields the upper bound√ logN( ,CDIFF, |||.|||F) ≤ c {n log n + √ n log n } .\nOver the range ≥ n−9/2, we have log n ≤ c log n, and hence√ logN( ,CDIFF, |||.|||F) ≤ c {n log n+ √ n log n } .\nSubstituting this bound into our earlier inequality (26) yields E[Z(t)] ≤ c { n−8 + ( n log n ) log(nt) + t √ n log n } (i)\n≤ c {( n log n ) log(n2) + t √ n log n } ≤ c { n log2(n) + t √ n log n } ,\nwhere step (i) uses the upper bound t ≤ 2n.\nThe only remaining detail is to prove Lemma 2.\nProof of Lemma 2: We first derive an upper bound on the metric entropy of the class CBISO (defined in (18)). Let F denote the set of all bivariate monotonic functions [0, 1]2 → [0, 1]2. For any matrix M ∈ CBISO, choose gM ∈ F as\ngM (x, y) = Mdn(1−x)e,dnye,\nwhere to handle corner conditions we define M0,i = M1,i and Mi,0 = Mi,1 for all i. Then we have\n‖gM‖22 = ∫ 1 x=0 ∫ 1 y=0 (gM (x, y)) 2dxdy = 1 n2 n∑ i=1 n∑ j=1 M2i,j = 1 n2 |||M |||2F.\nThus, we have\nlogN( ,CBISO, |||.|||F) ≤ logN ( n ,F , ‖.‖2 ) ≤ n 2 2 ( log n )2 , (27)\nwhere the last inequality (27) follows from Theorem 1.1. of Gao and Wellner [GW07]. We now bound the metric entropy of CDIFF in terms of the metric entropy of CBISO. For any\n> 0, let C BISO denote an -covering set in CBISO that satisfies the inequality (27). Consider the set\nC DIFF : = {π1(M1)− π2(M2) | for some permutations π1, π2 and some M1,M2 ∈ C / √ 2 BISO }.\nFor any D ∈ CDIFF, we can write D = π1(M ′1) − π2(M ′2) for some permutations π1 and π2 and some matrices M ′1 and M ′ 2 ∈ CBISO. We know there exist some M1,M2 ∈ C / √ 2 BISO such that\n|||M ′1 −M1|||F ≤ / √ 2 and |||M ′2 −M2|||F ≤ / √\n2. Then we have π1(M1)− π2(M2) ∈ C DIFF, and moreover\n|||D − (π1(M1)− π2(M2))|||2F ≤ |||π1(M1)− π1(M ′1)|||2F + |||π2(M2)− π1(M ′2)|||2F ≤ 2.\nThus the set C DIFF forms an -covering set for the class CDIFF. One can now count the number of elements in this set to get\nN( ,CDIFF, |||.|||F) ≤ ( n!N( / √ 2,CBISO, |||.|||F) )2 .\nSome straightforward algebraic manipulations yield the claimed result."
    }, {
      "heading" : "5.1.2 Proof of lower bound",
      "text" : "We now turn to the proof of the lower bound in Theorem 1. We may assume that the correct row/column ordering is fixed and known to be 1 2 · · · n. Here we are using the fact that revealing the knowledge of this ordering cannot make the estimation problem any harder. Recalling the definition (18) of the bivariate isotonic class CBISO, consider the subclass\nC′SST : = {M ∈ CBISO |Mi,j = 1 when j > i+ 1 and Mi,j = 1−Mj,i when j ≤ i}\nAny matrix M is this subclass can be identified with the vector q = q(M) ∈ Rn−1 with elements qi : = Mi,i+1. The only constraint imposed on q(M) by the inclusion M ∈ CSST is that qi ∈ [12 , 1] for all i = 1, . . . , n− 1.\nIn this way, we have shown that the difficulty of estimating M∗ ∈ C′SST is at least as hard as that of estimating a vector q ∈ [12 , 1]\nn−1 based on observing the random vector Y = {Y1,2, . . . , Yn−1,n} with independent coordinates, and such that each Yi,i+1 ∼ Ber(qi). For this problem, it is easy to show that there is a universal constant K` > 0 such that\ninf q̂ sup q∈[ 1\n2 ,1]n−1\nE [ ‖q̂ − q‖22 ] ≥ K`\n2 n,\nwhere the infimum is taken over all measurable functions Y 7→ q̂. Putting together the pieces, we have shown that\ninf M̂ sup M∗∈CSST\n1\nn2 E[|||M̂ −M∗|||2F] ≥\n2\nn2 inf q̂ sup q∈[0.5,1]n−1 E[‖q̂ − q‖22] ≥ K` n ,\nas claimed."
    }, {
      "heading" : "5.2 Proof of Theorem 2",
      "text" : "Recall from (1) that we can write our observation model as Y = M∗+W , where W ∈ Rn×n is a zero-mean matrix with entries that are drawn independently (except for the skew-symmetry condition) from the interval [−1, 1]."
    }, {
      "heading" : "5.2.1 Proof of upper bound",
      "text" : "Our proof of the upper bound hinges upon the following two lemmas.\nLemma 3. If λn ≥ 1.01|||W |||op, then\n|||Tλn(Y )−M∗|||2F ≤ c n∑ j=1 min { λ2n, σ 2 j (M ∗) }\nwith probability at least 1− c1e−c ′n, where c, c1 and c ′ are positive universal constants.\nOur second lemma is an approximation-theoretic result:\nLemma 4. For any matrix M∗ ∈ CSST and any s ∈ {1, 2, . . . , n− 1}, we have\n1\nn2 n∑ j=s+1 σ2j (M ∗) ≤ 1 s .\nSee the end of this section for the proofs of these two auxiliary results.\nBased on these two lemmas, it is easy to complete the proof of the theorem. The entries of W lie in [−1, 1] and hence are 1-sub-Gaussian, are i.i.d. on and above the diagonal, are zero-mean, and satisfy skew-symmetry. Consequently, we may apply Theorem 3.4 of Chatterjee [Cha14], which guarantees that\nP [ |||W |||op > (2 + t) √ n ] ≤ ce−f(t)n,\nwhere c is a universal constant, and the quantity f(t) is strictly positive for each t > 0. Thus, the choice λn = 2.1 √ n guarantees that λn ≥ 1.01|||W |||op with probability at least 1 − ce−cn, as is required for applying Lemma 3. Applying this lemma then yields the upper bound\n|||Tλn(Y )−M∗|||2F ≤ c n∑ j=1 min { n, σ2j (M ∗) }\nwith probability at least 1− c1e−c2n. Applying Lemma 4 yields that for any s ∈ {1, . . . , n},\n1\nn2 |||Tλn(Y )−M∗|||2F ≤ c { s n + 1 s } ,\nwith probability at least 1 − c1e−c2n. Setting s = d √ ne and performing some algebra shows that\nP [ 1 n2 |||Tλn(Y )−M∗|||2F > Ku√ n ] ≤ c1e−c2n,\nas claimed. Since 1 n2 |||Tλn(Y )−M∗|||2F ≤ 1, we are also guaranteed that\n1\nn2 E[|||Tλn(Y )−M∗|||2F] ≤ Ku√ n + c1e −c2n ≤ K ′ u√ n .\nProof of Lemma 3 Fix δ = 0.01. Let b be the number of singular values of M∗ above δ\n1+δλn, and let M ∗ b be the version of M ∗ truncated to its top b singular values. We then have\n|||Tλn(Y )−M∗|||2F ≤ 2|||Tλn(Y )−M∗b |||2F + 2|||M∗b −M∗|||2F\n≤ 2 rank(Tλn(Y )−M∗b )|||Tλn(Y )−M∗b |||2op + 2 n∑\nj=b+1\nσ2j (M ∗).\nWe claim that Tλn(Y ) has rank at most b. Indeed, for any j ≥ b+ 1, we have\nσj(Y ) ≤ σj(M∗) + |||W |||op ≤ λn,\nwhere we have used the facts that σj(M ∗) ≤ δ1+δλn for every j ≥ b+1 and λn ≥ (1+δ)|||W |||op. As a consequence we have σj(Tλn(Y )) = 0, and hence rank(Tλn(Y ) −M∗b ) ≤ 2b. Moreover, we have\n|||Tλn(Y )−M∗b |||op ≤ |||Tλn(Y )− Y |||op + |||Y −M∗|||op + |||M∗ −M∗b |||op\n≤ λn + |||W |||op + δ\n1 + δ λn\n≤ 2λn.\nPutting together the pieces, we conclude that\n|||Tλn(Y )−M∗|||2F ≤ 16bλ2n + 2 n∑\nj=b+1\nσ2j (M ∗)\n(i) ≤ C n∑ j=1 min{σ2j (M∗), λ2n},\nfor some constant6 C. Here inequality (i) follows since σj(M ∗) ≤ δ1+δλn whenever j ≥ b + 1 and σj(M ∗) > δ1+δλn whenever j ≤ b.\nProof of Lemma 4 In this proof, we make use of a construction due to Chatterjee [Cha14]. For a given matrix M∗, we can define the vector t ∈ Rn of row sums—namely, with entries ti = ∑n j=1M ∗ ij for i ∈ [n]. Using this vector, we can define a rank s approximation M to the\noriginal matrix M∗ by grouping the rows according to the vector t according to the following procedure: • Observing that each ti ∈ [0, n], let us divide the full interval [0, n] into s groups—say of the\nform [0, n/s), [n/s, 2n/s), . . . [(s − 1)n/s, n]. If ti falls into the interval α for some α ∈ [s], we then map row i to the group Gα of indices. • For each group Gα, we choose a particular row index k = k(α) ∈ Gα in an arbitrary fashion. For every other row index i ∈ Gα, we set Mij = Mkj for all j ∈ [n].\nBy construction, the matrix M has at most s distinct rows, and hence rank at most s. Let us now bound the Frobenius norm error in this rank s approximation. Fixing an arbitrary group index α ∈ [s] and an arbitrary row in i ∈ Gα, we then have\nn∑ j=1 (M∗ij −Mij)2 ≤ n∑ j=1 |M∗ij −Mij |.\nBy construction, we either have M∗ij ≥ Mij for every j ∈ [n], or M∗ij ≤ Mij for every j ∈ [n]. Thus, letting k ∈ Gα denote the chosen row, we are guaranteed that\nn∑ j=1 |M∗ij −Mij | ≤ |ti − tk| ≤ n s ,\nwhere we have used the fact the pair (ti, tk) must lie in an interval of length at most n/s. Putting together the pieces yields the claim."
    }, {
      "heading" : "5.2.2 Proof of lower bound",
      "text" : "We now turn to the proof of the lower bound in Theorem 2. We split our analysis into two cases, depending on the magnitude of λn.\nCase 1: First suppose that λn ≤ √ n 3 . In this case, we consider the matrix M ∗ : = 1211 T in which all items are equally good, so any comparison is simply a fair coin flip. Let the observation matrix Y ∈ {0, 1}n×n be arbitrary. By definition of the singular value thresholding operation, we have |||Y − Tλn(Y )|||op ≤ λn, and hence the SVT estimator M̂λn = Tλn(Y ) has Frobenius norm at most\n|||Y − M̂λn |||2F ≤ nλ2n ≤ n2\n9 .\n6To be clear, the precise value of the constant C is determined by δ, which has been fixed as δ = 0.01.\nSince M∗ ∈ {12} n×n and Y ∈ {0, 1}n×n, we are guaranteed that |||M∗ − Y |||F = n2 . Applying the triangle inequality yields the lower bound\n|||M̂λn −M∗|||F ≥ |||M∗ − Y |||F − |||M̂λn − Y |||F ≥ n 2 − n 3 = n 6 .\nCase 2: Otherwise, we may assume that λn > √ n 3 . Consider the matrix M ∗ ∈ Rn×n with entries\n[M∗]ij =  1 if i > j 1 2 if i = j\n0 if i < j.\n(28)\nBy construction, the matrix M∗ corresponds to the degenerate case of noiseless comparisons. Consider the matrix Y ∈ Rn×n generated according to the observation model (1). (To be clear, all of its off-diagonal entries are deterministic, whereas the diagonal is population with i.i.d. Bernoulli variates.) Our proof requires the following auxiliary result regarding the singular values of Y :\nLemma 5. The singular values of the observation matrix Y ∈ Rn×n generated by the noiseless comparison matrix M∗ satisfy the bounds\nn 4π(i+ 1) − 1 2 ≤ σn−i−1(Y ) ≤\nn\nπ(i− 1) +\n1 2 for all integers i ∈ [1, n6 − 1].\nWe prove this lemma at the end of this section.\nTaking it as given, we get that σn−i−1(Y ) ≤ √ n 3 for every integer i ≥ 2 √ n, and σn−i(Y ) ≥\nn 50i for every integer i ∈ [1, n 25 ]. It follows that\nn∑ i=1 (σi(Y )) 21{σi(Y ) ≤ √ n 3 } ≥ n 2 2500 n 25∑ i=2 √ n 1 i2 ≥ cn 3 2 ,\nfor some universal constant c > 0. Recalling that λn ≥ √ n\n3 , we have the lower bound\n|||Y − M̂λn |||2F ≥ cn 3 2 . Furthermore, since the observations (apart from the diagonal entries) are noiseless, we have |||Y −M∗|||2F ≤ n4 . Putting the pieces together yields the lower bound\n|||M̂λn −M∗|||F ≥ |||M̂λn − Y |||F − |||M∗ − Y |||F ≥ cn 3 4 − √ n\n2 ≥ c′n 3 4 ,\nwhere the final step holds when n is large enough (i.e., larger than a universal constant).\nProof of Lemma 5: Instead of working with the original observation matrix Y , it is convenient to work with a transformed version. Define the matrix Ȳ = Y −diag(Y ) + In, so that the matrix Ȳ is identical to Y except that all its diagonal entries are set to 1. Using this intermediate object, define the (n× n) matrix\nỸ : = (Ȳ (Ȳ )T )−1 − eneTn , (29)\nwhere en denotes the n th standard basis vector. One can verify that this matrix has entries\n[Ỹ ]ij =  1 if i = j = 1 or i = j = n 2 if 1 < i = j < n −1 if i = j + 1 or i = j − 1 0 otherwise.\nConsequently, it is equal to the graph Laplacian7 of an undirected chain graph on n nodes. Consequently, from standard results in spectral graph theory [BH11], the eigenvalues of Ỹ are given by {4 sin2(πin )} n−1 i=0 . Recall the elementary sandwich relationship x 2 ≤ sinx ≤ x, valid for every x ∈ [0, π6 ]. Using this fact, we are guaranteed that\nπ2i2\nn2 ≤ λi+1(Ỹ ) ≤\n4π2i2\nn2 for all integers i ∈ [1, n6 ]. (30)\nWe now use this intermediate result to establish the claimed bounds on the singular values of Y . Observe that the matrices Ỹ and (Ȳ (Ȳ )T )−1 differ only by the rank one matrix ene T n . Standard results in matrix perturbation theory [Tho76] guarantee that a rank-one perturbation can shift the position (in the large-to-small ordering) of any eigenvalue by at most one. Consequently, the eigenvalues of the matrix (Ȳ (Ȳ )T )−1 must be sandwiched as\nπ2(i− 1)2\nn2 ≤ λi+1((Ȳ (Ȳ )T )−1) ≤\n4π2(i+ 1)2\nn2 for all integers i ∈ [1, n6 − 1].\nIt follows that the singular values of Ȳ are sandwiched as\nn\n4π(i+ 1) ≤ σn−i−1(Ȳ ) ≤\nn\nπ(i− 1) for all integers i ∈ [1, n6 − 1].\nObserve that Ȳ − Y is a {0, 12}-valued diagonal matrix, and hence |||Ȳ − Y |||op ≤ 1 2 , which\nimplies that maxi=1,...,n |σi(Y )− σi(Ȳ )| ≤ 12 , and hence\nn 4π(i+ 1) − 1 2 ≤ σn−i−1(Y ) ≤\nn\nπ(i− 1) +\n1 2 for all integers i ∈ [1, n6 − 1],\nas claimed."
    }, {
      "heading" : "5.3 Proof of Theorem 3",
      "text" : "We now prove our results on the high SNR subclass of CSST, in particular establishing a lower bound and then analyzing the two-stage estimator described in Section 3.3 so as to obtain the upper bound."
    }, {
      "heading" : "5.3.1 Proof of lower bound",
      "text" : "In order to prove the lower bound, we follow the proof of the lower bound of Theorem 1, with the only difference being that the vector q ∈ Rn−1 is restricted to lie in the interval [12 + γ, 1] n−1.\n7In particular, the Laplacian of a graph is given by L = D − A, where A is the graph adjacency matrix, and D is the diagonal degree matrix."
    }, {
      "heading" : "5.3.2 Proof of upper bound",
      "text" : "Without loss of generality, assume that the true matrix M∗ is associated to the identity permutation. Recall that the second step of our procedure involves performing constrained regression over the set CBISO(π̂FAS). The error in such an estimate is necessarily of two types: the usual estimation error induced by the noise in our samples, and in addition, some form of approximation error that is induced by the difference between π̂FAS and the correct identity permutation.\nIn order to formalize this notion, for any fixed permutation π, consider the constrained least-squares estimator\nM̂π ∈ arg min M∈CBISO(π) |||Y −M |||2F. (31)\nOur first result provides an upper bound on the error matrix ∆̂ = M̂π −M∗ that involves both approximation and estimation error terms.\nLemma 6. There is a universal constant c0 > 0 such that error in the constrained LS estimate (31) satisfies the upper bound\n|||∆̂|||2F c0 ≤ |||M∗ − π(M∗)|||2F︸ ︷︷ ︸\nApprox. error + n log2(n)︸ ︷︷ ︸ Estimation error\n(32)\nwith probability at least 1− c1e−c2n.\nThere are two remaining challenges in the proof. Since the second step of our estimator involves the FAS-minimizing permutation π̂FAS, we cannot simply apply Lemma 6 to it directly. (The permutation π̂FAS is random, whereas this lemma applies to any fixed permutation). Consequently, we first need to extend the bound (32) to one that is uniform over a set that includes π̂FAS with high probability. Our second challenge is to upper bound the approximation error term |||M∗ − π̂FAS(M∗)|||2F that is induced by using the permutation π̂FAS instead of the correct identity permutation.\nIn order to address these challenges, for any constant c > 0, define the set\nΠ̂(c) : = {π | max i∈[n] |i− π(i)| ≤ c log n}.\nThis set corresponds to permutations that are relatively close to the identity permutation in the sup-norm sense. Our second lemma shows that any permutation in Π̂(c) is “good enough” in the sense that the approximation error term in the upper bound (32) is well-controlled:\nLemma 7. For any M∗ ∈ CBISO and any permutation π ∈ Π̂(c), we have\n|||M∗ − π(M∗)|||2F ≤ 2c′′n log n, (33)\nwhere c′′ is a positive constant that may depend only on c.\nTaking these two lemmas as given, let us now complete the proof of Theorem 3. (We return to prove these lemmas at the end of this section.) Braverman and Mossel [BM08] showed that for the class CHIGH(γ), there exists a positive constant c—depending on γ but independent of n—such that\nP [ π̂FAS ∈ Π̂(c) ] ≥ 1− c3\nn2 . (34)\nFrom the definition of class Π̂(c), there is a positive constant c′ (whose value may depend only on c) such that its cardinality is upper bounded as card(Π̂(c)) ≤ n2c′ logn. Consequently, by combining the union bound with Lemma 6 we conclude that, with probability at least 1 − c′1e−c ′ 2n − c3 n2 , the error matrix ∆̂FAS : = M̂π̂FAS − M∗ satisfies the upper bound (32). Combined with the approximation-theoretic guarantee from Lemma 7, we find that\n|||∆̂FAS|||2F c0 ≤ |||M∗ − π̂FAS(M∗)|||2F + n log2(n)\n≤ c′′n log n+ +n log2(n),\nfrom which the claim follows.\nIt remains to prove the two auxiliary lemmas, and we do so in the following subsections.\nProof of Lemma 6: The proof of this lemma involves a slight generalization of the proof of the upper bound in Theorem 1 (see Section 5.1.1 for this proof). From the optimality of M̂π and feasibility of π(M∗) for the constrained least-squares program (31), we are guaranteed that |||Y − M̂π|||2F ≤ |||Y − π(M∗)|||2F. Introducing the error matrix ∆̂π : = M̂π −M∗, some algebraic manipulations yield the modified basic inequality\n|||∆̂π|||2F ≤ |||M∗ − π(M∗)|||2F + 2〈〈W, M̂π − π(M∗)〉〉.\nLet us define ∆̂ : = M̂π−π(M∗). Further, for each choice of radius t > 0, recall the definitions of the random variable Z(t) and event At from equations (20) and (23), respectively. With these definitions, we have the upper bound\n|||∆̂π|||2F ≤ |||M∗ − π(M∗)|||2F + 2Z ( |||∆̂|||F ) . (35)\nLemma 2 proved earlier shows that the inequality E[Z(δn)] ≤ δ 2 n 2 is satisfied by δn = c\n√ n log n.\nIn a manner identical to the proof in Section 5.1.1, one can show that P[At] ≤ P[Z(δn) ≥ 2δn √ tδn ] ≤ 2e−c1tδn for all t ≥ δn.\nGiven these results, we break the next step into two cases depending on the magnitude of ∆̂. Case I: Suppose |||∆̂|||F ≤ √ tδn. In this case, we have\n|||∆̂π|||2F ≤ 2|||M∗ − π(M∗)|||2F + 2|||∆̂|||2F ≤ 2|||M∗ − π(M∗)|||2F + tδn.\nCase II: Or otherwise we will have |||∆̂|||F > √ tδn. Conditioning on the complement Act , our basic inequality (35) implies that\n|||∆̂π|||2F ≤ |||M∗ − π(M∗)|||2F + 4|||∆̂|||F √ tδn\n≤ |||M∗ − π(M∗)|||2F + |||∆̂|||2F\n8 + 32tδn,\n≤ |||M∗ − π(M∗)|||2F + 2|||∆̂π|||2F + 2|||M∗ − π(M∗)|||2F\n8 + 32tδn,\nwith probability at least 1− 2e−c1tδn . Finally, setting t = δn = c √ n log(n) in either case and re-arranging yields the bound (32).\nProof of Lemma 7: For any matrix M and any value i, let Mi denote its i th row. Also define the clipping function b : Z → [n] via b(x) = min{max{1, x}, n}. Using this notation, we have\n|||M∗ − π(M∗)|||2F = n∑ i=1 ‖M∗i −M∗π−1(i)‖ 2 2\n≤ n∑ i=1 max 0≤j≤c logn {‖M∗i −M∗b(i−j)‖ 2 2, ‖M∗i −M∗b(i+j)‖ 2 2},\nwhere we have used the definition of the set Π̂(c) to obtain the final inequality. Since M∗ corresponds to the identity permutation, we have M∗1 ≥M∗2 ≥ · · · ≥M∗n, where the inequalities are in the pointwise sense. Consequently, we have\n|||M∗ − π(M∗)|||2F ≤ n∑ i=1 max { ‖M∗i −M∗b(i−c logn)‖ 2 2, ‖M∗i −M∗b(i+c logn)‖ 2 2 }\n≤ 2 n−c logn∑ i=1 ‖M∗i −M∗i+c logn‖22.\nOne can verify that the inequality ∑k−1\ni=1 (ai − ai+1)2 ≤ (a1 − ak)2 holds for all ordered sequences of real numbers a1 ≥ a2 ≥ · · · ≥ ak. As stated earlier, the rows of M∗ dominate each other pointwise, and hence we conclude that\n|||M∗ − π(M∗)|||2F ≤ 2c log n‖M∗1 −M∗n‖22 ≤ 2cn log n,\nwhich establishes the claim (33)."
    }, {
      "heading" : "5.4 Proof of Theorem 4",
      "text" : "We now turn to our theorem giving upper and lower bounds on estimating pairwise probability matrices for parametric models. Let us begin with a proof of the claimed lower bound."
    }, {
      "heading" : "5.4.1 Lower bound",
      "text" : "We prove our lower bound by constructing a set of matrices that are well-separated in Frobenius norm. Using this set, we then use an argument based on Fano’s inequality to lower bound the minimax risk. Underlying our construction of the matrix collection is a collection of Boolean vectors. For any two Boolean vectors b, b′ ∈ {0, 1}n, let dH(b, b′) = ∑n j=1 1[bj 6= b′j ] denote their Hamming distance.\nLemma 8. For any fixed α ∈ (0, 1/4), there is a collection of Boolean vectors {b1, . . . , bT } such that\nmin { dH(b j , bk), dH(b j , 0) } ≥ dαne for all distinct j 6= k ∈ {1, . . . , T}, and (36a)\nT ≡ T (α) ≥ exp ( (n− 1)DKL(2α‖ 1 2 ) ) − 1. (36b)\nGiven the collection {bj , j ∈ [T (α)]} guaranteed by this lemma, we then define the collection of real vectors {wj , j ∈ [T (α)]} via\nwj = δ ( I − 1\nn 11T\n) bj for each j ∈ [T (α)],\nwhere δ ∈ (0, 1) is a parameter to be specified later in the proof. By construction, for each index j ∈ [T (α)], we have 〈1, wj〉 = 0 and ‖wj‖∞ ≤ δ. Based on these vectors, we then define the collection of matrices { M j , j ∈ [T (α)] } via\n[Mk]ij : = F ([w k]i − [wk]j).\nBy construction, this collection of matrices is contained within our parametric family. We also claim that they are well-separated in Frobenius norm:\nLemma 9. For any distinct pair j, k ∈ [T (α)], we have\n|||M j −Mk|||2F n2 ≥ α 2 4 (F (δ)− F (0))2. (37)\nIn order to apply Fano’s inequality, our second requirement is an upper bound on the mutual information I(Y ; J), where J is a random index uniformly distributed over the set [T ] = {1, . . . , T}. By Jensen’s inequality, we have I(Y ; J) ≤ 1\n(T2)\n∑ j 6=kDKL(Pj‖Pk), where Pj\ndenotes the distribution of Y when the true underlying matrix is M j . Let us upper bound these KL divergences.\nFor any pair of distinct indices u, v ∈ [n]2, let xuv be a differencing vector—that is, a vector in components u and v are set equal are 1 and −1, respectively, with all remaining components equal to 0. We are then guaranteed that\n〈xuv, wj〉 = δ〈xuv, bj〉, and F (〈xuv, wj〉) ∈ { F (−δ), F (0), F (δ) } ,\nwhere F (δ) ≥ F (0) ≥ F (−δ) by construction. Using these facts, we have\nDKL(Pj‖Pk) ≤ 1\n2 ∑ u,v∈[n]\n( F (〈xuv, wj〉)− F (〈xuv, wk〉) )2 min{F (〈xuv, wk〉), 1− F (〈xuv, wk〉)}\n≤ 1 2 n2\n(F (δ)− F (−δ))2\nF (−δ)\n≤ 2n2 (F (δ)− F (0)) 2\nF (−δ) . (38)\nThis upper bound on the KL divergence (38) and lower bound on the Frobenius norm (37),\nwhen combined with Fano’s inequality, imply that any estimator M̂ has its worst-case risk over our family lower bounded as\nsup j∈[T (α)]\n1 n2 E [ |||M̂ −M(wj)|||2F ] ≥ 1 8 α2(F (δ)− F (0))2 ( 1− 2 F (−δ)n 2(F (δ)− F (0))2 + log 2 n ) .\nChoosing a value of δ > 0 such that (F (δ)−F (0))2 = F (−δ)20n gives the claimed result. (Such a value of δ is guaranteed to exist with F (−δ) ∈ [14 , 1 2 ] given our assumption that F is continuous and strictly increasing.)\nThe only remaining details are to prove Lemmas 8 and 9.\nProof of Lemma 8: The Gilbert-Varshamov bound [Gil52, Var57] guarantees the existence of a collection of vectors {b0, . . . , bT̄−1} contained with the Boolean hypercube {0, 1}n such that T̄ ≥ 2n−1 (∑dαne−1 `=0 ( n−1 ` ))−1 , and\ndH(b j , bk) ≥ dαne for all j 6= k, j, k ∈ [T̄ − 1].\nMoreover, their construction allows loss of generality that the all-zeros vector is a member of the set—say b0 = 0. We are thus guaranteed that dH(b\nj , 0) ≥ dαne for all j ∈ {1, . . . , T̄ − 1}. Since n ≥ 2 and α ∈ (0, 14), we have dαne−1 n−1 ≤ 2α ≤ 1 2 . Applying standard bounds on the\ntail of the binomial distribution yields\n1\n2n−1 dαne−1∑ `=0 ( n− 1 ` ) ≤ exp ( − (n− 1)DKL( dαne − 1 n− 1 ‖1 2 ) ) ≤ exp ( − (n− 1)DKL(2α‖ 1 2 ) ) .\nConsequently, the number of non-zero code words T : = T̄ − 1 is at least\nT (α) : = exp ( (n− 1)DKL(2α‖ 1 2 ) ) − 1.\nThus, the collection {b1, . . . , bT } has the desired properties.\nProof of Lemma 9: By definition of the matrix ensemble, we have |||M(wj)−M(wk)|||2F = ∑\nu,v∈[n]\n(F (〈xuv, wj〉)− F (〈xuv, wk〉))2. (39)\nBy construction, the Hamming distances between the triplet of vectors {wj , wk, 0} are lower bounded dH(w\nj , 0) ≥ αn, dH(wk, 0) ≥ αn and dH(wj , wk) ≥ αn. We claim that this implies that\ncard { u 6= v ∈ [n]2 | 〈xuv, wj〉 6= 〈xuv, wk〉 } ≥ α 2\n4 n2. (40)\nTaking this auxiliary claim as given for the moment, applying it to Equation (39) yields the lower bound |||M(w1)−M(w2)|||2F ≥ 14α 2n2(F (δ)− F (0))2, as claimed.\nIt remains to prove the auxiliary claim (40). We relabel j = 1 and k = 2 for simplicity in notation. For (y, z) ∈ {0, 1} × {0, 1}, let set Iyz ⊆ [n] denote the set of indices on which w1 takes value y and w2 takes value z. We then split the proof into two cases:\nCase 1: Suppose | I00 ∪ I11 |≥ αn2 . The minimum distance condition dH(w 1, w2) ≥ αn implies that | I01 ∪ I10 |≥ αn. For any i ∈ I00 ∪ I11 and any j ∈ I01 ∪ I10, it must be that 〈xuv, w1〉 6= 〈xuv, w2〉. Thus there are at least α 2 2 n 2 such pairs of indices.\nCase 2: Otherwise, we may assume that | I00 ∪ I11 |< αn2 . This condition, along with the minimum Hamming weight conditions dH(w\n1, 0) ≥ αn and dH(w2, 0) ≥ αn, gives I10 ≥ αn2 and I01 ≥ αn2 . For any i ∈ I01 and any j ∈ I10, it must be that 〈xuv, w\n1〉 6= 〈xuv, w2〉. Thus there are at least α 2\n4 n 2 such pairs of indices."
    }, {
      "heading" : "5.4.2 Upper bound",
      "text" : "In our earlier work [SBB+15, Theorem 2b] we prove that when F is strongly log-concave and twice differentiable, then there is a universal constant Ku such that the maximum likelihood estimator ŵML has mean squared error at most\nsup w∗∈[−1,1]n,〈w∗, 1〉=0\nE[‖ŵML − w∗‖22] ≤ Ku. (41)\nMoreover, given the log-concavity assumption, the MLE is computable in polynomial-time. Let M(ŵML) and M(w\n∗) denote the pairwise comparison matrices induced, via Equation (4), by ŵML and w\n∗. It suffices to bound the Frobenius norm |||M(ŵML)−M(w∗)|||F. Consider any pair of vectors w1 and w2 that lie in the hypercube [−1, 1]n. For any pair\nof indices (i, j) ∈ [n]2, we have\n((M(w1))ij − (M(w2))ij)2 = (F (w1i − w1j )− F (w2i − w2j ))2 ≤ ζ2((w1i − w1j )− (w2i − w2j ))2,\nwhere we have defined ζ : = max z∈[−1,1]\nF ′(z). Putting together the pieces yields\n|||M(w1)−M(w2)|||2F ≤ ζ2(w1 − w2)T (nI − 11T )(w1 − w2) = nζ2‖w1 − w2‖22. (42)\nApplying this bound with w1 = ŵML and w 2 = w∗ and combining with the bound (41) yields the claim."
    }, {
      "heading" : "5.5 Proof of Theorem 5",
      "text" : "We now turn to the proof of Theorem 5, which characterizes the behavior of different estimators for the partially observed case."
    }, {
      "heading" : "5.5.1 Proof of part (a)",
      "text" : "In this section, we prove the lower and upper bounds stated in Equation (17a) in part (a).\nProof of lower bound: We begin by proving the lower bound in Equation (17a). The Gilbert-Varshamov bound [Gil52, Var57] guarantees the existence of a set of vectors {b1, . . . , bT } in the Boolean cube {0, 1} n 2 with cardinality at least T : = 2cn, and such that\ndH(b j , bk) ≥ d n\n10 e for all distinct pairs j, k ∈ [T ] : = {1, . . . , T}.\nFixing some δ ∈ (0, 14) whose value will be specified later, for each k ∈ [T ], we define a matrix Mk ∈ CSST with entries\n[Mk]uv =\n{ 1 2 + δ if u ≤ n 2 , [b\nk]u = 1 and v ≥ n2 1 2 otherwise.\nBy construction, for each distinct pair j, k ∈ [T ], we have the lower bound\n‖M j −Mk‖22 = 1\n2 nδ2‖bj − bk‖22 ≥ c0n2δ2.\nLet Pj and Pjuv denote (respectively) the distributions of the matrix Y and entry Yuv when the underlying matrix is M j . Since the entries of Y are generated independently, we have DKL(Pj‖Pk) =\n∑ 1≤u<v≤n DKL(Pjuv‖Pkuv). Matrix entry Yuv is generated according to the model\nYuv =  1 w.p. pobsM ∗ uv\n0 w.p. pobs(1−M∗uv) not observed w.p. 1− pobs,\nso that\nDKL(Pjuv‖Pkuv) = pobs ( M juv log\nM juv Mkuv + (1−M juv) log (1−M juv) (1−Mkuv) ) (i) ≤ pobs { M juv (M juv −Mkuv Mkuv ) + (1−M juv) (Mkuv −M juv 1−Mkuv )}\n= pobs (M juv −Mkuv)2 Mkuv(1−Mkuv) (ii) ≤ 16pobs (M juv −Mkuv)2,\nwhere inequality (i) follows from the fact that log(t) ≤ t − 1 for all t > 0; and inequality (ii) follows since the numbers {M juv,Mkuv} both lie in the interval [14 , 3 4 ]. Putting together the pieces, we conclude that\nDKL(Pj‖Pk) ≤ c1pobs|||M j −Mk|||2F ≤ c′1 pobsnδ2‖bj − bk‖2 ≤ c′1pobsn2δ2.\nThus, applying Fano’s inequality to the packing set {M1, . . . ,MT } yields that any estimator M̂ has mean squared error lower bounded by\nsup k∈[T ]\n1\nn2 |||M̂ −Mk|||2F ≥ c0δ2\n( 1− c ′ 1pobsn 2δ2 + log 2\ncn\n) .\nFinally, choosing δ2 = c22c1pobsn yields the lower bound supk∈[T ] 1 n2 |||M̂ −Mk|||2F ≥ c3 1npobs . Note that in order to satisfy the condition δ ≤ 14 , we must have pobs ≥ 16c2 2c1n .\nOtherwise, if pobs < 16c2 2c1n then simply consider the “better” case when pobs = 16c2 2c1n\n; applying the argument above then yields a lower bound of order one, which is the best obtainable in this regime.\nProof of upper bound: In this section, we prove the upper bound of the order O( (logn) 2\np2obsn ).\nThe upper bound of the order O( 1 pobs √ n ) follows as a consequence of our proof of part (b).\nGiven our subset of observed matrix entries, suppose that we form a full observation matrix Y ∈ Rn×n by assigning any unobserved entry the value 1/2. Define the matrix Ȳ : = 1pobsY − 1−pobs 2pobs 11T . One can verify that we can write\nȲ = M∗ + 1\npobs W ′, (43)\nwhere the noise matrix W ′ has entries\nW ′uv =  pobs( 1 2 −M ∗ uv) + 1 2 with probability pobsM ∗ uv pobs( 1 2 −M ∗ uv)− 12 with probability pobs(1−M ∗ uv)\npobs( 1 2 −M ∗ uv) with probability 1− pobs.\n(44)\nWe now analyze the error ∆̂ : = M̂ −M∗ associated with the constrained least-squares estimator applied to the observation matrix Ȳ :\nM̂ ∈ arg min M∈CSST |||Ȳ −M |||2F.\nIn order to do so, we follow the analysis of the fully observed model, given in Section 5.1.1. In particular, the same argument yields the modified basic inequality 12 |||∆̂||| 2 F ≤ 1pobs 〈〈W\n′, ∆̂〉〉. Note that all entries of the matrix W ′ are zero-mean and lie in the interval [−1, 1] and hence are 1-sub-Gaussian; in addition, they are i.i.d. above the diagonal, and satisfy skew-symmetry. Thus, the argument from Section 5.1.1 yields that the upper bounds\n|||∆̂|||F ≤ 1\npobs\n√ n log n, and hence\n1\nn2 |||∆̂|||2F ≤\n(log n)2\np2obsn ,\nhold with the stated probability, which completes the proof."
    }, {
      "heading" : "5.5.2 Proof of part (b)",
      "text" : "In order to prove the bound (17b), we analyze the SVT estimator Tλn,pobs (Y ) with the threshold λn,pobs = 2.1 √ n\npobs . Naturally then, our analysis is similar to that of complete observations\ncase from Section 5.2. Recall our formulation of the problem in terms of the observation matrix Ȳ along with the noise matrix W ′ from equations (43) and (44). Observe that Lemma 3 and Lemma 4 continue to hold in the partial observations case, but with W replaced by\n1 pobs W ′ in the case of Lemma 3. The entries of W ′ lie in [−1, 1] and hence are 1-sub-Gaussian, are i.i.d. on and above the diagonal, are zero-mean, and satisfy skew-symmetry. As before, Theorem 3.4 of Chatterjee [Cha14] then implies that\nP [ |||W ′|||op > (2 + t) √ n ] ≤ c1e−f(t)n\nwhere c1 is a universal constant and f(t) is strictly positive for each t > 0. With our choice λn,pobs = 2.1 √ n pobs , the event {λn,pobs ≥ 1.01|||W ′|||op} holds with probability at least 1− c1e−c2n. Conditioned on this event, we may apply Lemma 4. Combined with the approximationtheoretic result from Lemma 4, we find that\n1\nn2 |||Tλn(Y )−M∗|||2F ≤ c (sλ2n n2 + 1 s ) with probability at least 1 − c1e−c2n. Substituting λn,pobs = 2.1 √ n\npobs in this bound and setting\ns = pobs √ n gives the claimed result."
    }, {
      "heading" : "5.5.3 Proof of part (c)",
      "text" : "As in our of proof of the fully observed case from Section 5.4.2, we consider the two-stage estimator based on first computing the MLE ŵML of w\n∗, and then constructing the matrix estimate M(ŵML) via Equation (4). Let us now upper bound the mean-squared error associated with this estimator.\nOur observation model can be (re)described in the following way. Consider an Erdős-Rényi graph on n vertices with each edge drawn independently with a probability pobs. For each edge in this graph, we obtain one observation of the pair of vertices at the end-points of that edge. Let L be the (random) Laplacian matrix of this graph. From Theorem 2(b) from our paper [SBB+15] on estimating parametric models, for this graph, there is a universal constant c1 such that the maximum likelihood estimator ŵML has mean squared error upper bounded as\nE[‖ŵML − w∗‖22 | L] ≤ c1 n\nλ2(L) ,\nThe estimator is computable in a time polynomial in n.\nLet λ2(L) denote the second largest eigenvalue. Since pobs ≥ c0 (logn) 2\nn , known results on the eigenvalues of random graphs [Oli09, CR11, KOVB14] imply that\nP [ λ2(L) ≥ c1npobs ] ≥ 1− 1\nn4 (45)\nfor a universal constant c1 (that may depend on c0). As shown earlier in Equation (42), for any valid score vectors w1, w2, we have |||M(w1) − M(w2)|||2F ≤ nζ2‖w1 − w2‖22 where ζ : = maxz∈[−1,1] F\n′(z). Putting these results together and performing some simple algebraic manipulations leads to the upper bound\n1 n2 E [ |||M(ŵML)−M∗|||2F ] ≤ c3ζ 2 npobs ,\nthus proving our claim."
    }, {
      "heading" : "6 Discussion",
      "text" : "In this paper, we analyzed a flexible model for pairwise comparison data that includes various parametric models, including the BTL and Thurstone models, as special cases. We analyzed various estimators for this broader matrix family, ranging from optimal estimators through to various polynomial-time estimators, including forms of singular value thresholding, as well as multi-stage method based on a noisy sorting routine. All of the results in this paper focused on estimation of the matrix of pairwise comparison probabilities in the Frobenius norm. Estimation of probabilities in other metrics, such as the KL divergence or `1-norm, can be desirable. We suspect that the results given here will be useful in establishing results in these metrics. Establishing the best possible rates for polynomial-time algorithms over the full class CSST is a challenging open problem.\nWe evaluated a computationally efficient estimator based on thresholding the singular values of the observation matrix that is consistent, but achieves a suboptimal rate. In our analysis of this estimator, we have so far been conservative in our choice of the regularization parameter, in that it is a fixed choice. Such a fixed choice has been prescribed in various\ntheoretical works on the soft or hard-thresholded singular values (see, for instance, the papers [Cha14, GD13]). In practice, the entries of the effective noise matrix W have variances that depend on the unknown matrix, and the regularization parameter may be obtained via cross-validation. The effect of allowing a data-dependent choice of the regularization parameter remains to be studied, although we suspect it may improve the minimax risk by a constant factor at best.\nFinally, in some applications, choices can be systematically intransitive, for instance when objects have multiple features and different features dominate different pairwise comparisons. In these situations, the SST assumption may be weakened to one where the underlying pairwise comparison matrix is a mixture of a small number of SST matrices. The results of this work may form building blocks to address this general setting; we defer a detailed analysis to future work.\nAcknowledgments: This work was partially supported by ONR-MURI grant DOD-002888, AFOSR grant FA9550-14-1-0016, NSF grant CIF-31712-23800, and ONR MURI grant N0001411-1-0688. The work of NBS was also supported in part by a Microsoft Research PhD fellowship."
    }, {
      "heading" : "A Proof of Proposition 1",
      "text" : "We will show that the matrix M∗ specified in Figure 1a satisfies the conditions required by the proposition. It is easy to verify that M∗ ∈ CSST, so that it remains to prove the approximation-theoretic lower bound (6). In order to do so, we require the following auxiliary result:\nLemma 10. Consider any matrix M that belongs to CPAR(F ) for a valid function F . Suppose for some collection of four distinct items {i1, . . . , i4}, the matrix M satisfies the inequality Mi1i2 > Mi3i4. Then it must also satisfy the inequality Mi1i3 ≥Mi2i4.\nWe return to prove this lemma at the end of this section. Taking it as given, let us now proceed to prove the lower bound (6). For any valid F , fix an arbitrary member M of a class CPAR(F ), and let w ∈ Rn be the underlying weight vector (see the definition (4)).\nPick any item in the set of first n4 items (corresponding to the first n 4 rows of M ∗) and call this item as “1”; pick an item from the next set of n4 items (rows) and call it item “2”; item “3” from the next set and item “4” from the final set. Our analysis proceeds by developing some relations between the pairwise comparison probabilities for these four items that must hold for every parametric model, that are strongly violated by M∗. We divide our analysis into two possible relations between the entries of M . Case I: First suppose that M12 ≤M34. Since M∗12 = 6/8 and M∗34 = 5/8 in our construction, it follows that\n(M12 −M∗12)2 + (M34 −M∗34)2 ≥ 1\n256 .\nCase II: Otherwise, we may assume thatM12 < M34. Then Lemma 10 implies thatM13 ≥M24. Moreover, since M∗13 = 7/8 and M ∗ 24 = 1 in our construction, it follows that\n(M13 −M∗13)2 + (M24 −M∗24)2 ≥ 1\n256 .\nAggregating across these two exhaustive cases, we find that∑ (u,v)∈{1,2,3,4} (Muv −M∗uv)2 ≥ 1 256 .\nSince this bound holds for any arbitrary selection of items from the four sets, we conclude that 1\nn2 |||M −M∗|||2F is lower bounded by a universal constant c > 0 as claimed.\nFinally, it is easy to see that upon perturbation of any of the entries of M∗ by at most 132— while still ensuring that the resulting matrix lies in CSST—the aforementioned results continue to hold, albeit with a worse constant. Every element in this class satisfies the claim of this proposition.\nProof of Lemma 10: It remains to prove Lemma 10. Since M belongs to the parametric family, there must exist some valid function F and some vector w that induce M (see Equation (4)). Since F is non-decreasing, the condition Mi1i2 > Mi3i4 implies that\nwi1 − wi2 > wi3 − wi4 .\nAdding wi2−wi3 to both sides of this inequality yields wi1−wi3 > wi2−wi4 . Finally, applying the non-decreasing function F to both sides of this inequality gives yields Mi1i3 ≥ Mi2i4 as claimed, thereby completing the proof."
    }, {
      "heading" : "B Minimizing feedback arc set over entire SST class",
      "text" : "Our analysis in Theorem 3 shows that the two-step estimator proposed in Section 3.3 works well under the stated bounds on the entries of M∗, i.e., for M∗ ∈ CHIGH(γ) for a fixed γ. This two-step estimator is based on finding a minimum feedback arc set (FAS) in the first step. In this section, we investigate the efficacy of estimators based on minimum FAS over the full class CSST. We show that minimizing the FAS does not work well over CSST.\nThe intuition is that although minimizing the feedback arc set appears to minimize disagreements at a global scale, it makes only local decisions: if it is known that items i and j are in adjacent positions, the order among these two items is decided based solely on the outcome of the comparison between items i and j, and is independent of the outcome of the comparisons of i and j with all other items.\nHere is a concrete example to illustrate this property. Suppose n is divisible by 3, and consider the following (n× n) block matrix M ∈ CSST:\nM =  1 2\n1 2 1\n1 2\n1 2\n3 4\n0 14 1 2  , where each block is of size (n3 × n 3 ). Let π\n1 be the identity permutation, and let π2 be the permutation [n3 + 1, . . . , 2n 3 , 1, . . . , n 3 , 2n 3 + 1, . . . , n], that is, π\n2 swaps the second block of n3 items with the first block. For any permutation π of the n items and any M ∈ CSST, let π(M) denote the (n× n) matrix resulting from permuting both the rows and the columns by π.\nOne can verify that |||π1(M) − π2(M)|||2F ≥ cn2, for some universal constant c > 0. Now suppose an observation Y is generated from π1(M) as per the model (1). Then the distribution\nof the size of the feedback arc set of π1 is identical to the distribution of the size of the feedback arc set of π2. Minimizing FAS will not be able to distinguish between π1(M) and π2(M) at least 50% of the time, and due to this problem an estimator that is based on the minimum FAS result will not perform well over the SST class."
    }, {
      "heading" : "C Relation to other models",
      "text" : "We put things in perspective to the other models considered in the literature. We begin with two weaker versions of stochastic transitivity that are also investigated in the literature on psychology and social science.\nC.1 Moderate and weak stochastic transitivity\nThe model CSST that we consider is called strong stochastic transitivity in the literature on psychology and social science [Fis73, DM59]. The two other popular (and weaker) models are those of moderate stochastic transitivity CMST defined as\nCMST : = { M ∈ [0, 1]n×n | Mik ≥ min{Mij ,Mjk} for every (i, j, k) satisfying Mij ≥ 12 and Mjk ≥ 1 2 } ,\nand weak stochastic transitivity CWST defined as\nCWST : = { M ∈ [0, 1]n×n | Mik ≥ 12 for every (i, j, k) satisfying Mij ≥ 1 2 and Mjk ≥ 1 2 } .\nClearly, we have the inclusions CSST ⊆ CMST ⊆ CWST. In Theorem 1, we prove that the minimax rates of estimation under the strong stochastic transitivity assumption are Θ̃(n−1). It turns out, however, that the two weaker transitivity conditions do not permit meaningful estimation.\nProposition 2. There exists a universal constant c > 0 such that under the moderate CMST stochastic transitivity model,\ninf M̃ sup M∗∈CMST\n1\nn2 E[|||M̃ −M∗|||2F] > c.\nwhere the infimum is taken over all measurable mappings from the observations Y to [0, 1]n×n. Consequently, for the weak stochastic transitivity model CWST, we also have\ninf M̃ sup M∗∈CWST\n1\nn2 E[|||M̃ −M∗|||2F] > c,\nThe minimax risk incurred under these two classes is clearly the worst possible (up to a universal constant) since for any two arbitrary matrices M and M ′ in [0, 1]n×n, we have 1 n2 |||M − M ′|||2F ≤ 1. For this reason, in the paper we restrict our analysis to the strong stochastic transitivity condition.\nC.2 Comparison with statistical models\nLet us now investigate relationship of the strong stochastic transitivity model considered in this paper with two other popular models in the literature on statistical learning from\ncomparative data. Perhaps the most popular model in this regard is the class of parametric models CPAR: recall that this class is defined as\nCPAR : = {M |Mij = F (w∗i − w∗j ) for some non-decreasing function F : R→ [0, 1], and vector w∗ ∈ Rn}.\nThe parametric class of models assumes that the function F is fixed and known. Statistical estimation under the parametric class is studied in several recent papers [NOS12, HOX14, SBB+15]. The setting where the function F is fixed, but unknown leads to a semi-parametric variant. The results presented in this section also readily apply to the semi-parametric class.\nThe second class is that generated from distributions over complete rankings [Dia89, FJS13, DIS15]. Specifically, every element in this class is generated as the pairwise marginal of an arbitrary probability distribution over all possible permutations of the n items. We denote this class as CFULL.\nThe following result characterizes the relation between the classes.\nProposition 3. Consider any value of n > 10. The parametric class CPAR is a strict subset of the strong stochastic transitivity class CSST. The class CFULL of marginals of a distribution on total rankings is neither a subset nor a superset of either of the classes CSST, CPAR, and CSST\\CPAR.\nThe various relationships in Proposition 3 are depicted pictorially in Figure 3. These relations are derived by first establishing certain conditions that matrices in the classes considered must satisfy, and then constructing matrices that satisfy or violate one or more of these conditions. The conditions on CFULL arise from the observation that the class is the convex hull of all SST matrices that have their non-diagonal elements in {0, 1}; we derive conditions on this convex hull that leads to properties of the CFULL class. To handle the parametric class CPAR, we employ a necessary condition discussed earlier in Section 2.4 and defined formally in Lemma 10. The SST class CSST is characterized using the insights derived throughout the paper.\nC.3 Proof of Proposition 2\nWe will derive an order one lower bound under the moderate stochastic transitivity condition. This result automatically implies the order one lower bound for weak stochastic transitivity.\nThe proof imposes a certain structure on a subset of the entries of M∗ in a manner that Θ(n2) remaining entries are free to take arbitrary values within the interval [12 , 1]. This flexibility then establishes a minimax error of Θ(1) as claimed.\nLet us suppose M∗ corresponds to the identity permutation of the n items, and that this information is public knowledge. Set the entries of M∗ above the diagonal in the following manner. For every i ∈ [n] and every odd j ∈ [n], set M∗ij = 12 . For every i ∈ [n] and every even j ∈ [n], set M∗ji = 12 . This information is also assumed to be public knowledge. Let S ⊂ [n] 2 denote the set of all entries of M∗ above the diagonal whose values were not assigned in the previous step. Let |S| denote the size of set S. The entries below the diagonal are governed by the skew-symmetry constraints.\nWe first argue that every entry in S can take arbitrary values in the interval [12 , 1], and are not constrained by each other under the moderate stochastic transitivity condition. To this end, consider any entry (i, k) ∈ S. Recall that the moderate stochastic transitivity condition imposes the following set of restrictions in M∗ik: for every j, M ∗ ik ≥ min{M∗ij ,M∗jk}. From our earlier construction we have that for every odd value of j, M∗ij = 1 2 and hence the restriction simply reduces to M∗ik ≥ 1 2 . On the other hand, for every even value of j, our construction gives M∗jk = 1 2 , and hence the restriction again reduces to M ∗ ik ≥ 1 2 . Given the absence of any additional restrictions, the error E[|||M̂ −M∗|||2F] ≥ c|S|. Finally, observe that every entry (i, k) where i < k, i is odd and k is even belongs to the set S. It follows that |S| ≥ n28 , thus proving our claim.\nC.4 Proof of Proposition 3\nThe constructions governing the claimed relations are enumerated in Figure 3 and the details are provided below.\nIt is easy to see that since F is non-decreasing, the parametric class CPAR is contained in the strong stochastic transitivity class CSST. We provide a formal proof of this statement for the sake of completeness. Suppose without loss of generality that w1 ≥ · · · ≥ wn. Then we claim that the distribution of pairwise comparisons generated through this model result in a matrix, say M , that lies in the SST model with the ordering 1 2 · · · n. This is because for any i > j > k,\nwi − wk ≥ wi − wj F (wi − wk) ≥ F (wi − wj)\nMik ≥Mij .\nWe now show the remaining relations with the four constructions indicated in Figure 3. While these constructions target some specific value of n, the results hold for any value n greater than that specific value. To see this, suppose we construct a matrix M for some n = n0, and show that it lies inside (or outside) one of these classes. Consider any n > n0, and define a (n×n) matrix M ′ as having M as the top-left (n0×n0) block, 12 on the remaining diagonal entries, 1 on the remaining entries above the diagonal and 0 on the remaining entries below the diagonal. This matrix M ′ will retain the properties of M in terms of lying inside (or outside, respectively) the claimed class.\nC.4.1 Construction 1\nWe construct a matrix M such that M ∈ CFULL but M /∈ CSST. Let n = 3. Consider the following distribution over permutations of 3 items (1, 2, 3):\nP(1 2 3) = 25 , P(3 1 2) = 15 , P(2 3 1) = 25 .\nThis distribution induces the pairwise marginals\nP(1 2) = 35 , P(2 3) = 45 , P(3 1) = 35 .\nSet Mij = P(i j) for every pair. By definition of the class CFULL, we have M ∈ CFULL. A necessary condition for a matrix M to belong to the class CSST is that there must exist at least one item, say item i, such that Mij ≥ 12 for every item j. One can verify that the pairwise marginals enumerated above do not satisfy this condition, and hence M /∈ CSST.\nC.4.2 Construction 2\nWe construct a matrix M such that M ∈ CSST ∩ CFULL but M /∈ CPAR. Let n = 4 and consider the following distribution over permutations of 4 items (1, 2, 3, 4):\nP(3 1 2 4) = 1 8 , P(1 2 4 3) = 1 8\nP(2 1 4 3) = 2 8 and P(1 2 3 4) = 4 8 .\nOne can verify that this distribution leads to the following pairwise comparison matrix M (with the ordering of the rows and columns respecting the permutation 1 2 3 4):\nM : = 1\n8  4 6 7 8 2 4 7 8 1 1 4 5 0 0 3 4  . It is easy to see that this matrix M ∈ CSST, and by construction M ∈ CFULL. Finally, the proof of Proposition 2 shows that M /∈ CPAR, thereby completing the proof.\nC.4.3 Construction 3\nWe construct a matrix M such that M ∈ CPAR (and hence M ∈ CSST) but M /∈ CFULL. First observe that any total ordering on n items can be represented as an (n×n) matrix in the SST class such that all its off-diagonal entries take values in {0, 1}. The class CFULL is precisely the convex hull of all such binary SST matrices.\nLetB1, . . . , Bn! denote all (n×n) matrices in CSST whose off-diagonal elements are restricted to take values in the set {0, 1}. The following lemma derives a property that any matrix in the convex hull of B1, . . . , Bn! must satisfy.\nLemma 11. Consider any M ∈ CSST, and consider three items i, j, k ∈ [n] such that M respects the ordering i j k. Suppose Mij = Mjk = 12 and Mik = 1. Further suppose that M can be written as\nM = ∑ `∈[n!] α`B`, (46)\nwhere α` ≥ 0 ∀ ` and ∑n!\n`=1 α ` = 1. Then for any ` ∈ [n!] such that α` > 0, it must be that\nB`ij 6= B`jk.\nThe proof of the lemma is provided at the end of this section. Now consider the following (7× 7) matrix M ∈ CSST:\nM : =  1 2 1 2 1 1 1 1 1 1 2 1 2 1 2 1 2 1 1 1 0 12 1 2 1 2 1 2 1 1 0 12 1 2 1 2 1 2 1 2 1 0 0 12 1 2 1 2 1 2 1\n0 0 0 12 1 2 1 2 1 2 0 0 0 0 0 12 1 2\n . (47)\nWe will now show via proof by contradiction that M cannot be represented as a convex combination of the matrices B1, . . . , Bn!. We will then show that M ∈ CPAR. Suppose one can representM as a convex combinationM = ∑\n`∈[n!] α `B`, where α1, . . . , αn!\nare non-negative scalars that sum to one. Consider any ` such that α` 6= 0. Let B`12 = b ∈ {0, 1}. Let us derive some more constraints on B`. Successively applying Lemma 11 for the following values of i, j, k implies that B` must necessarily have the form (48) shown below. Here b̄ : = 1 − b and ‘∗’ denotes some arbitrary value that is irrelevant to the discussion at hand.\n• i = 1, j = 2, k = 3 gives B`23 = b̄\n• i = 1, j = 2, k = 4 gives B`24 = b̄\n• i = 2, j = 3, k = 5 gives B`35 = b\n• i = 2, j = 4, k = 6 gives B`46 = b\n• i = 3, j = 5, k = 6 gives B`56 = b̄\n• i = 4, j = 6, k = 7 gives B`67 = b̄.\nThus B` must be of the form\nM : =  1 2 b 1 1 1 1 1 1 2 1 2 b̄ b̄ 1 1 1 0 b 12 ∗ b 1 1 0 b ∗ 12 ∗ b 1 0 0 b̄ ∗ 12 b̄ 1 0 0 0 b̄ b 12 b̄\n0 0 0 0 0 b 12\n . (48)\nFinally, applying Lemma 11 with i = 5, j = 6, k = 7 necessitates B`67 = b, which contradicts the necessary condition of (48). We have thus shown that M /∈ CFULL.\nWe will now show that the matrix M constructed in (47) is contained in the class CPAR. Consider the following function F : [−1, 1]→ [0, 1] in the definition of a parametric class:\nF (x) =  0 if x < −0.25 1 2 if −0.25 ≤ x ≤ 0.25 1 if x > 0.25.\nLet n = 7 with w1 = .9, w2 = .7, w3 = .6, w4 = .5, w5 = .4, w6 = .3 and w7 = .1. One can verify that under this construction, the matrix of pairwise comparisons is identical to that in Equation (47). Proof of Lemma 11 In what follows, we will show that ∑\n`:B`ij=1,B ` jk=1\nα` = ∑\n`:B`ij=1,B ` jk=1\nα` =\n0. The result then follows immediately. Consider some `′ ∈ [n!] such that α`′ > 0 and B`′ij = 0. Since Mik = 1, we must have B` ′ ik = 1. Given that B `′ represents a total ordering of the n items, that is, B` ′ is an SST matrix with boolean-valued its off-diagonal elements, B` ′ ij = 0 and B `′ ik = 1 imply that B `′ jk = 1. We have thus shown that B` ′ jk = 1 whenever B `′ ij = 0. This result has two consequences. The first\nconsequence is that ∑\n`:B`ij=0,B ` jk=0\nα` = 0. The second consequence employs the additional\nfact that Mij = 1 2 and hence ∑ `:B`ij=0 α` = 12 , and then gives ∑ `:B`ij=0,B ` jk=1 α` = 12 . Building on, we have\n1 2 = Mjk = ∑ `:B`ij=0,B ` jk=1 α` + ∑ `:B`ij=1,B ` jk=1 α`,\nand hence we have ∑\n`:B`ij=1,B ` jk=1\nα` = 0, thus completing the proof.\nC.4.4 Construction 4\nWe construct a matrix M such that M ∈ CSST but M /∈ CFULL and M /∈ CPAR. Consider n = 11. Let M2 denote the (4× 4) matrix of Construction 2 and let M3 denote the (7× 7) matrix of construction 3. Consider the (11× 11) matrix M of the form\nM : = [ M2 1 0 M3 ] .\nSince M2 ∈ CSST and M3 ∈ CSST, it is easy to see that M ∈ CSST. Since M2 /∈ CPAR and M /∈ CFULL, it follows that M /∈ CPAR and M /∈ CFULL. This construction completes the proof of Proposition 3."
    } ],
    "references" : [ {
      "title" : "Aggregating inconsistent information: ranking and clustering",
      "author" : [ "N. Ailon", "M. Charikar", "A. Newman" ],
      "venue" : "Journal of the ACM (JACM), 55(5):23",
      "citeRegEx" : "ACN08",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "SIAM Journal on Discrete Mathematics",
      "author" : [ "N. Alon. Ranking tournaments" ],
      "venue" : "20(1):137–142,",
      "citeRegEx" : "Alo06",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "Spectra of graphs",
      "author" : [ "A.E. Brouwer", "W.H. Haemers" ],
      "venue" : "Springer",
      "citeRegEx" : "BH11",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Noisy sorting without resampling",
      "author" : [ "M. Braverman", "E. Mossel" ],
      "venue" : "Proc. ACMSIAM symposium on Discrete algorithms, pages 268–276",
      "citeRegEx" : "BM08",
      "shortCiteRegEx" : null,
      "year" : 2008
    }, {
      "title" : "Rank analysis of incomplete block designs: I",
      "author" : [ "R.A. Bradley", "M.E. Terry" ],
      "venue" : "The method of paired comparisons. Biometrika, pages 324–345",
      "citeRegEx" : "BT52",
      "shortCiteRegEx" : null,
      "year" : 1952
    }, {
      "title" : "Decisions",
      "author" : [ "T.P. Ballinger", "N.T. Wilcox" ],
      "venue" : "error and heterogeneity. The Economic Journal, 107(443):1090–1105",
      "citeRegEx" : "BW97",
      "shortCiteRegEx" : null,
      "year" : 1997
    }, {
      "title" : "Models for paired comparison data: A review with emphasis on dependent data",
      "author" : [ "M. Cattelan" ],
      "venue" : "Statistical Science, 27(3):412–433",
      "citeRegEx" : "Cat12",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "On matrix estimation under monotonicity constraints",
      "author" : [ "S. Chatterjee", "A. Guntuboyina", "B. Sen" ],
      "venue" : "arXiv:1506.03430",
      "citeRegEx" : "CGS15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Matrix estimation by universal singular value thresholding",
      "author" : [ "S. Chatterjee" ],
      "venue" : "The Annals of Statistics, 43(1):177–214",
      "citeRegEx" : "Cha14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "On the spectra of general random graphs",
      "author" : [ "F. Chung", "M. Radcliffe" ],
      "venue" : "The electronic journal of combinatorics, 18(1):P215",
      "citeRegEx" : "CR11",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "A generalization of spectral analysis with application to ranked data",
      "author" : [ "P. Diaconis" ],
      "venue" : "The Annals of Statistics, 17(3):949–979",
      "citeRegEx" : "Dia89",
      "shortCiteRegEx" : null,
      "year" : 1989
    }, {
      "title" : "A topic modeling approach to ranking",
      "author" : [ "W. Ding", "P. Ishwar", "V. Saligrama" ],
      "venue" : "Proceedings of the Eighteenth International Conference on Artificial Intelligence and Statistics",
      "citeRegEx" : "DIS15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Experimental tests of a stochastic decision theory",
      "author" : [ "D. Davidson", "J. Marschak" ],
      "venue" : "Measurement: Definitions and theories, pages 233–69",
      "citeRegEx" : "DM59",
      "shortCiteRegEx" : null,
      "year" : 1959
    }, {
      "title" : "Binary choice probabilities: on the varieties of stochastic transitivity",
      "author" : [ "P.C. Fishburn" ],
      "venue" : "Journal of Mathematical psychology, 10(4):327–352",
      "citeRegEx" : "Fis73",
      "shortCiteRegEx" : null,
      "year" : 1973
    }, {
      "title" : "A nonparametric approach to modeling choice with limited data",
      "author" : [ "V.F. Farias", "S. Jagabathula", "D. Shah" ],
      "venue" : "Management Science, 59(2):305–322",
      "citeRegEx" : "FJS13",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "Probability models and statistical analyses for ranking data",
      "author" : [ "M.A. Fligner", "J.S. Verducci" ],
      "venue" : "volume 80. Springer",
      "citeRegEx" : "FV93",
      "shortCiteRegEx" : null,
      "year" : 1993
    }, {
      "title" : "Donoho",
      "author" : [ "M. Gavish", "D. L" ],
      "venue" : "The optimal hard threshold for singular values is 4/sqrt(3),",
      "citeRegEx" : "GD13",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "A comparison of signalling alphabets",
      "author" : [ "E.N. Gilbert" ],
      "venue" : "Bell System Technical Journal, 31(3):504–522",
      "citeRegEx" : "Gil52",
      "shortCiteRegEx" : null,
      "year" : 1952
    }, {
      "title" : "Entropy estimate for high-dimensional monotonic functions",
      "author" : [ "F. Gao", "J.A. Wellner" ],
      "venue" : "Journal of Multivariate Analysis, 98(9):1751–1764",
      "citeRegEx" : "GW07",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "Minimax-optimal inference from partial rankings",
      "author" : [ "B. Hajek", "S. Oh", "J. Xu" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 1475–1483",
      "citeRegEx" : "HOX14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "How to rank with few errors",
      "author" : [ "C. Kenyon-Mathieu", "W. Schudy" ],
      "venue" : "Symposium on Theory of computing (STOC), pages 95–103. ACM",
      "citeRegEx" : "KMS07",
      "shortCiteRegEx" : null,
      "year" : 2007
    }, {
      "title" : "Algebraic connectivity of Erdös-Rényi graphs near the connectivity threshold",
      "author" : [ "T. Kolokolnikov", "B. Osting", "J. Von Brecht" ],
      "venue" : "Available online http://www.mathstat.dal.ca/ tkolokol/papers/braxton-james.pdf",
      "citeRegEx" : "KOVB14",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "The Concentration of Measure Phenomenon",
      "author" : [ "M. Ledoux" ],
      "venue" : "Mathematical Surveys and Monographs. American Mathematical Society, Providence, RI",
      "citeRegEx" : "Led01",
      "shortCiteRegEx" : null,
      "year" : 2001
    }, {
      "title" : "Individual choice behavior: A theoretical analysis",
      "author" : [ "R.D. Luce" ],
      "venue" : "New York: Wiley",
      "citeRegEx" : "Luc59",
      "shortCiteRegEx" : null,
      "year" : 1959
    }, {
      "title" : "Analyzing and modeling rank data",
      "author" : [ "J.I. Marden" ],
      "venue" : "CRC Press",
      "citeRegEx" : "Mar96",
      "shortCiteRegEx" : null,
      "year" : 1996
    }, {
      "title" : "Stochastic transitivity and cancellation of preferences between bitter-sweet solutions",
      "author" : [ "D.H. McLaughlin", "R.D. Luce" ],
      "venue" : "Psychonomic Science, 2(1-12):89–90",
      "citeRegEx" : "ML65",
      "shortCiteRegEx" : null,
      "year" : 1965
    }, {
      "title" : "Iterative ranking from pair-wise comparisons",
      "author" : [ "S. Negahban", "S. Oh", "D. Shah" ],
      "venue" : "Advances in Neural Information Processing Systems, pages 2474–2482",
      "citeRegEx" : "NOS12",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Concentration of the adjacency matrix and of the Laplacian in random graphs with independent edges",
      "author" : [ "R.I. Oliveira" ],
      "venue" : "arXiv preprint:0911.0600",
      "citeRegEx" : "Oli09",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "Estimation from pairwise comparisons: Sharp minimax bounds with topology dependence",
      "author" : [ "N.B. Shah", "S. Balakrishnan", "J. Bradley", "A. Parekh", "K. Ramchandran", "M. Wainwright" ],
      "venue" : "Conference on Artificial Intelligence and Statistics, pages 856–865",
      "citeRegEx" : "SBB+15",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Constrained statistical inference: Order",
      "author" : [ "M.J. Silvapulle", "P.K. Sen" ],
      "venue" : "inequality, and shape constraints, volume 912. John Wiley & Sons",
      "citeRegEx" : "SS11",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "The behavior of eigenvalues and singular values under perturbations of restricted rank",
      "author" : [ "R. Thompson" ],
      "venue" : "Linear Algebra and its Applications, 13(1):69–78",
      "citeRegEx" : "Tho76",
      "shortCiteRegEx" : null,
      "year" : 1976
    }, {
      "title" : "A law of comparative judgment",
      "author" : [ "L.L. Thurstone" ],
      "venue" : "Psychological Review, 34(4):273",
      "citeRegEx" : "Thu27",
      "shortCiteRegEx" : null,
      "year" : 1927
    }, {
      "title" : "Elimination by aspects: A theory of choice",
      "author" : [ "A. Tversky" ],
      "venue" : "Psychological review, 79(4):281",
      "citeRegEx" : "Tve72",
      "shortCiteRegEx" : null,
      "year" : 1972
    }, {
      "title" : "Estimate of the number of signals in error correcting codes",
      "author" : [ "R. Varshamov" ],
      "venue" : "Dokl. Akad. Nauk SSSR",
      "citeRegEx" : "Var57",
      "shortCiteRegEx" : null,
      "year" : 1957
    } ],
    "referenceMentions" : [ {
      "referenceID" : 31,
      "context" : "The Bradley-Terry-Luce [BT52, Luc59] and Thurstone [Thu27] models are mainstays in analyzing this type of pairwise comparison data.",
      "startOffset" : 51,
      "endOffset" : 58
    }, {
      "referenceID" : 13,
      "context" : ", see Fishburn [Fis73] for an overview), where the only coherence assumption made on the pairwise comparison probabilities is that of strong stochastic transitivity, or SST for short.",
      "startOffset" : 15,
      "endOffset" : 22
    }, {
      "referenceID" : 5,
      "context" : "[BW97] is especially strongly worded:",
      "startOffset" : 0,
      "endOffset" : 6
    }, {
      "referenceID" : 8,
      "context" : "An estimator based on hard-thresholding was studied previously in this context by Chatterjee [Cha14].",
      "startOffset" : 93,
      "endOffset" : 100
    }, {
      "referenceID" : 3,
      "context" : "Our third contribution, formalized in Theorems 3 and 4, is to show that for certain interesting subsets of the full SST class, a combination of parametric maximum likelihood [SBB+15] and noisy sorting algorithms [BM08] leads to a tractable two-stage method that achieves the minimax rate.",
      "startOffset" : 212,
      "endOffset" : 218
    }, {
      "referenceID" : 8,
      "context" : "Our fourth contribution is to supplement our minimax lower bound with lower bounds for various known estimators, including those based on thresholding singular values [Cha14], noisy sorting [BM08], and parametric methods [NOS12, HOX14, SBB+15]) based on parametric models.",
      "startOffset" : 167,
      "endOffset" : 174
    }, {
      "referenceID" : 3,
      "context" : "Our fourth contribution is to supplement our minimax lower bound with lower bounds for various known estimators, including those based on thresholding singular values [Cha14], noisy sorting [BM08], and parametric methods [NOS12, HOX14, SBB+15]) based on parametric models.",
      "startOffset" : 190,
      "endOffset" : 196
    }, {
      "referenceID" : 8,
      "context" : "Chatterjee [Cha14] formally introduced the estimation problem considered in this paper, and analyzed an estimator based on singular value thresholding.",
      "startOffset" : 11,
      "endOffset" : 18
    }, {
      "referenceID" : 3,
      "context" : "Part of our analysis leverages an algorithm from the paper [BM08]; in particular, we extend their analysis in order to provide guarantees for estimating pairwise comparison probabilities as opposed to estimating the underlying order.",
      "startOffset" : 59,
      "endOffset" : 65
    }, {
      "referenceID" : 29,
      "context" : ", [SS11]), particularly to the problem of bi-variate isotonic regression.",
      "startOffset" : 2,
      "endOffset" : 8
    }, {
      "referenceID" : 18,
      "context" : "We use Dudley’s entropy integral in order to derive an upper bound that is sharp up to a logarithmic factor; doing so in turn requires deriving upper bounds on the metric entropy of the class CSST for which we leverage the prior work of Gao and Wellner [GW07].",
      "startOffset" : 253,
      "endOffset" : 259
    }, {
      "referenceID" : 8,
      "context" : "For the full class CSST, Chatterjee [Cha14] analyzed the performance of such an estimator and proved that the squared Frobenius error decays as O(n− 1 4 ) uniformly over CSST.",
      "startOffset" : 36,
      "endOffset" : 43
    }, {
      "referenceID" : 8,
      "context" : "To be clear, Chatterjee [Cha14] actually analyzed the hard-SVT estimator, which is based on the hard-thresholding operator",
      "startOffset" : 24,
      "endOffset" : 31
    }, {
      "referenceID" : 3,
      "context" : "In particular, we call upon a polynomial-time algorithm due to Braverman and Mossel [BM08] that, under the model (12), is guaranteed to find the exact solution to the FAS problem with high probability.",
      "startOffset" : 84,
      "endOffset" : 90
    }, {
      "referenceID" : 3,
      "context" : "We note that we do not have an analogue of the high-SNR result in the partial observations case since having partial observations reduces the SNR; the noisy-sorting algorithm of Braverman and Mossel [BM08] for the high-SNR case requires a computational complexity of eγ −4 and hence is not computable in time polynomial in n when γ < (log n)− 1 4 , and this disallows most interesting scalings of pobs with n.",
      "startOffset" : 199,
      "endOffset" : 205
    }, {
      "referenceID" : 3,
      "context" : "In particular, it relies on the algorithm due to Braverman and Mossel [BM08] to compute the feedback arc set minimizer.",
      "startOffset" : 70,
      "endOffset" : 76
    }, {
      "referenceID" : 3,
      "context" : "• High SNR: A setting studied previously by Braverman and Mossel [BM08], in which the noise is independent of the items being compared.",
      "startOffset" : 65,
      "endOffset" : 71
    }, {
      "referenceID" : 18,
      "context" : "of Gao and Wellner [GW07].",
      "startOffset" : 19,
      "endOffset" : 25
    }, {
      "referenceID" : 8,
      "context" : "4 of Chatterjee [Cha14], which guarantees that",
      "startOffset" : 16,
      "endOffset" : 23
    }, {
      "referenceID" : 8,
      "context" : "Proof of Lemma 4 In this proof, we make use of a construction due to Chatterjee [Cha14].",
      "startOffset" : 80,
      "endOffset" : 87
    }, {
      "referenceID" : 2,
      "context" : "Consequently, from standard results in spectral graph theory [BH11], the eigenvalues of Ỹ are given by {4 sin2( n )} n−1 i=0 .",
      "startOffset" : 61,
      "endOffset" : 67
    }, {
      "referenceID" : 30,
      "context" : "Standard results in matrix perturbation theory [Tho76] guarantee that a rank-one perturbation can shift the position (in the large-to-small ordering) of any eigenvalue by at most one.",
      "startOffset" : 47,
      "endOffset" : 54
    }, {
      "referenceID" : 3,
      "context" : ") Braverman and Mossel [BM08] showed that for the class CHIGH(γ), there exists a positive constant c—depending on γ but independent of n—such that",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 8,
      "context" : "4 of Chatterjee [Cha14] then implies that",
      "startOffset" : 16,
      "endOffset" : 23
    } ],
    "year" : 2017,
    "abstractText" : "There are various parametric models for analyzing pairwise comparison data, including the Bradley-Terry-Luce (BTL) and Thurstone models, but their reliance on strong parametric assumptions is limiting. In this work, we study a flexible model for pairwise comparisons, under which the probabilities of outcomes are required only to satisfy a natural form of stochastic transitivity. This class includes several parametric models including the BTL and Thurstone models as special cases, but is considerably more general. We provide various examples of models in this broader stochastically transitive class for which classical parametric models provide poor fits. Despite this greater flexibility, we show that the matrix of probabilities can be estimated at the same rate as in standard parametric models. On the other hand, unlike in the BTL and Thurstone models, computing the least-squares estimate in the stochastically transitive model is non-trivial, and we explore various computationally tractable alternatives. We show that a simple singular value thresholding algorithm is statistically consistent but does not achieve the minimax rate. We then propose and study algorithms that achieve the minimax rate over interesting sub-classes of the full stochastically transitive class. We complement our theoretical results with thorough numerical simulations.",
    "creator" : "LaTeX with hyperref package"
  }
}