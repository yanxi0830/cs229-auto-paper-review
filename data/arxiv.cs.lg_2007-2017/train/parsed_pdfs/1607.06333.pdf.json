{
  "name" : "1607.06333.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Uncovering Causality from Multivariate Hawkes Integrated Cumulants",
    "authors" : [ "Massil Achab", "Emmanuel Bacry", "Stéphane Gaiffas", "Iacopo Mastromatteo", "Jean-François Muzy" ],
    "emails" : [ "massil.achab@m4x.org" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Keywords. Hawkes Process, Causality Inference, Cumulants, Generalized Method of Moments"
    }, {
      "heading" : "1 Introduction",
      "text" : "In many applications, one needs to deal with data containing a very large number of irregular timestamped events that are recorded in continuous time. These events can reflect, for instance, the activity of users on a social network, see Subrahmanian et al. (2016), the high-frequency variations of signals in finance, see Bacry et al. (2015), the earthquakes and aftershocks in geophysics, see Ogata (1998), the crime activity, see Mohler et al. (2011) or the position of genes in genomics, see Reynaud-Bouret and Schbath (2010). The succession of the precise timestamps carries a great deal of information about the dynamics of the underlying systems. In this context, multidimensional counting processes based models play a paramount role. Within this framework, an important task is to recover the mutual influence of the nodes (i.e., the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al. (2013a); Gomez-Rodriguez et al. (2013); Farajtabar et al. (2015); Xu et al. (2016).\nConsider a set of nodes I = {1, . . . , d}. For each i ∈ I , we observe a set Zi of events, where each τ ∈ Zi labels the occurrence time of an event related to the activity of i. The events of all nodes can ∗massil.achab@m4x.org\nar X\niv :1\n60 7.\n06 33\n3v 3\n[ st\nat .M\nL ]\n3 0\nM ay\nbe represented as a vector of counting processes N t = [N1t · · ·Ndt ]>, where N it counts the number of events of node i until time t ∈ R+, namely N it = ∑ τ∈Zi 1{τ≤t}. The vector of stochastic intensities λt = [λ 1 t · · ·λdt ]> associated with the multivariate counting processN t is defined as\nλit = lim dt→0 P(N it+dt −N it = 1|Ft) dt\nfor i ∈ I , where the filtration Ft encodes the information available up to time t. The coordinate λit gives the expected instantaneous rate of event occurrence at time t for node i. The vector λt characterizes the distribution of N t, see Daley and Vere-Jones (2003), and patterns in the events time-series can be captured by structuring these intensities.\nThe Hawkes process introduced in Hawkes (1971) corresponds to an autoregressive structure of the intensities in order to capture self-excitation and cross-excitation of nodes, which is a phenomenon typically observed, for instance, in social networks, see for instance Crane and Sornette (2008). Namely, N t is called a Hawkes point process if the stochastic intensities can be written as\nλit = µ i + d∑ j=1 ∫ t 0 φij(t− t′)dN jt′ ,\nwhere µi ∈ R+ is an exogenous intensity and φij are positive, integrable and causal (with support in R+) functions called kernels encoding the impact of an action by node j on the activity of node i. Note that when all kernels are zero, the process is a simple homogeneous multivariate Poisson process.\nMost of the litterature uses a parametric approach for estimating the kernels. With no doubt, the most popular parametrization form is the exponential kernel φij(t) = αijβije−βijt because it definitely simplifies the inference algorithm (e.g., the complexity needed for computing the likelihood is much smaller). When d is large, in order to reduce the number of parameters, some authors choose to arbitrarily share the kernel shapes across the different nodes. Thus, for instance, in Yang and Zha (2013); Zhou et al. (2013b); Farajtabar et al. (2015), they choose φij(t) = αijh(t) with αij ∈ R+ quantifies the intensity of the influence of j on i and h(t) a (normalized) function that characterizes the time-profile of this influence and that is shared by all couples of nodes (i, j) (most often, it is chosen to be either exponential h(t) = βe−βt or power law h(t) = βt−(β+1)). Both approaches are, most of the time, highly non-realistic. On the one hand there is a priori no reason for assuming that the time-profile of the influence of a node j on a node i does not depend on the pair (i, j). On the other hand, assuming an exponential shape or a power law shape for a kernel arbitrarily imposes an event impact that is always instantly maximal and that can only decrease with time, while in practice, there may exist a latency between an event and its maximal impact.\nIn order to have more flexibility on the shape of the kernels, nonparametric estimation can be considered. Expectation-Maximization algorithms can be found in Lewis and Mohler (2011) (for d = 1) or in Zhou et al. (2013a) (d > 1). An alternative method is proposed in Bacry and Muzy (2016) where the nonparametric estimation is formulated as a numerical solving of a Wiener-Hopf equation. Another nonparametric strategy considers a decomposition of kernels on a dictionary of function h1, . . . , hK , namely φij(t) = ∑K k=1 a ij k hk(t), where the coefficients a ij k are estimated, see Hansen et al. (2015); Lemonnier and Vayatis (2014) and Xu et al. (2016), where group-lasso is used to induce a sparsity pattern on the coefficients aijk that is shared across k = 1, . . . ,K.\nSuch methods are heavy when d is large, since they rely on likelihood maximization or least squares minimization within an over-parametrized space in order to gain flexibility on the shape of the kernels. This is problematic, since the original motivation for the use of Hawkes processes is to estimate the influence and causality of nodes, the knowledge of the full parametrization of the model being of little\ninterest for causality purpose.\nOur paper solves this problem with a different and more direct approach. Instead of trying to estimate the kernels φij , we focus on the direct estimation of their integrals. Namely, we want to estimate the matrixG = [gij ] where\ngij = ∫ +∞ 0 φij(u) du ≥ 0 for 1 ≤ i, j ≤ d. (1)\nAs it can be seen from the cluster representation of Hawkes processes (Hawkes and Oakes (1974)), this integral represents the mean total number of events of type i directly triggered by an event of type j, and then encodes a notion of causality. Actually, as detailed below (see Section 2.1), such integral can be related to the Granger causality (Granger (1969)).\nThe main idea of the method we developed in this paper is to estimate the matrixG directly using a matching cumulants (or moments) method. Apart from the mean, we shall use second and third-order cumulants which correspond respectively to centered second and third-order moments. We first compute an estimation M̂ of these centered moments M(G) (they are uniquely defined byG). Then, we look for a matrix Ĝ that minimizes the L2 error ‖M(Ĝ)− M̂‖2. Thus the integral matrix Ĝ is directly estimated without making hardly any assumptions on the shape the involved kernels. As it will be shown, this approach turns out to be particularly robust to the kernel shapes, which is not the case of all previous Hawkes-based approaches that aim causality recovery. We call this method NPHC (Non Parametric Hawkes Cumulant), since our approach is of nonparametric nature. We provide a theoretical analysis that proves the consistency of the NPHC estimator. Our proof is based on ideas from the theory of Generalized Method of Moments (GMM) but requires an original technical trick since our setting strongly departs from the standard parametric statistics with i.i.d observations. Note that moment and cumulant matching techniques proved particularly powerful for latent topic models, in particular Latent Dirichlet Allocation, see Podosinnikova et al. (2015). A small set of previous works, namely Da Fonseca and Zaatour (2014); Aït-Sahalia et al. (2010), already used method of moments with Hawkes processes, but only in a parametric setting. Our work is the first to consider such an approach for a nonparametric counting processes framework.\nThe paper is organized as follows: in Section 2, we provide the background on the integrated kernels and the integrated cumulants of the Hawkes process. We then introduce the method, investigate its complexity and explain the consistency result we prove. In Section 3, we estimate the matrix of Hawkes kernels’ integrals for various simulated datasets and for real datasets, namely the MemeTracker database and financial order book data. We then provide in Section 4 the technical details skipped in the previous parts and the proof of our consistency result. Section 5 contains concluding remarks."
    }, {
      "heading" : "2 NPHC: The Non Parametric Hawkes Cumulant method",
      "text" : "In this Section, we provide the background on integrals of Hawkes kernels and integrals of Hawkes cumulants. We then explain how the NPHC method enables estimatingG."
    }, {
      "heading" : "2.1 Branching structure and Granger causality",
      "text" : "From the definition of Hawkes process as a Poisson cluster process, see Jovanović et al. (2015) or Hawkes and Oakes (1974), gij can be simply interpreted as the average total number of events of node i whose direct ancestor is a given event of node j (by direct we mean that interactions mediated by any other intermediate event are not counted). In that respect,G not only describes the mutual influences between\nnodes, but it also quantifies their direct causal relationships. Namely, introducing the counting function N i←jt that counts the number of events of i whose direct ancestor is an event of j, we know from Bacry et al. (2015) that\nE[dN i←jt ] = g ijE[dN jt ] = g ijΛjdt, (2)\nwhere we introduced Λi as the intensity expectation, namely satisfying E[dN it ] = Λidt. Note that Λi does not depend on time by stationarity ofN t, which is known to hold under the stability condition ‖G‖ < 1, where ‖G‖ stands for the spectral norm ofG. In particular, this condition implies the non-singularity of Id −G.\nSince the question of a real causality is too complex in general, most econometricians agreed on the simpler definition of Granger causality Granger (1969). Its mathematical formulation is a statistical hypothesis test: X causes Y in the sense of Granger causality if forecasting future values of Y is more successful while taking X past values into account. In Eichler et al. (2016), it is shown that for N t a multivariate Hawkes process, N jt does not Granger-cause N i t w.r.t N t if and only if φ\nij(u) = 0 for u ∈ R+. Since the kernels take positive values, the latter condition is equivalent to ∫∞ 0 φ\nij(u)du = 0. In the following, we’ll refer to learning the kernels’ integrals as uncovering causality since each integral encodes the notion of Granger causality, and is also linked to the number of events directly caused from a node to another node, as described above at Eq. (2)."
    }, {
      "heading" : "2.2 Integrated cumulants of the Hawkes process",
      "text" : "A general formula for the integral of the cumulants of a multivariate Hawkes process is provided in Jovanović et al. (2015). As explained below, for the purpose of our method, we only need to consider cumulants up to the third order. Given 1 ≤ i, j, k ≤ d, the first three integrated cumulants of the Hawkes process can be defined as follows thanks to stationarity:\nΛidt = E(dN it ) (3)\nCijdt = ∫ τ∈R ( E(dN itdN j t+τ )− E(dN it )E(dN j t+τ ) ) (4)\nKijkdt = ∫ ∫ τ,τ ′∈R2 ( E(dN itdN j t+τdN k t+τ ′) + 2E(dN i t )E(dN j t+τ )E(dN k t+τ ′)\n− E(dN itdN j t+τ )E(dN k t+τ ′)− E(dN itdNkt+τ ′)E(dN j t+τ )− E(dN j t+τdN k t+τ ′)E(dN i t ) ) ,\n(5)\nwhere Eq. (3) is the mean intensity of the Hawkes process, the second-order cumulant (4) refers to the integrated covariance density matrix and the third-order cumulant (5) measures the skewness ofN t. Using the martingale representation from Bacry and Muzy (2016) or the Poisson cluster process representation from Jovanović et al. (2015), one can obtain an explicit relationship between these integrated cumulants and the matrixG. If one sets R = (Id −G)−1, (6) straightforward computations (see Section 4) lead to the following identities:\nΛi = d∑\nm=1\nRimµm (7)\nCij = d∑ m=1 ΛmRimRjm (8)\nKijk = d∑ m=1 (RimRjmCkm +RimCjmRkm + CimRjmRkm − 2ΛmRimRjmRkm). (9)\nEquations (8) and (9) are proved in Section 4. Our strategy is to use a convenient subset of Eqs. (3), (4) and (5) to define M , while we use Eqs. (7), (8) and (9) in order to construct the operator that maps a candidate matrix R to the corresponding cumulants M(R). By looking for R̂ that minimizes R 7→ ‖M(R) − M̂‖2, we obtain, as illustrated below, good recovery of the ground truth matrix G using Equation (6).\nThe simplest case d = 1 has been considered in Hardiman and Bouchaud (2014), where it is shown that one can choose M = {C11} in order to compute the kernel integral. Eq. (8) then reduces to a simple second-order equation that has a unique solution inR (and consequently a uniqueG) that accounts for the stability condition (‖G‖ < 1).\nUnfortunately, for d > 1, the choice M = {Cij}1≤i≤j≤d is not sufficient to uniquely determine the kernels integrals. In fact, the integrated covariance matrix provides d(d+ 1)/2 independent coefficients, while d2 parameters are needed. It is straightforward to show that the remaining d(d− 1)/2 conditions can be encoded in an orthogonal matrixO, reflecting the fact that Eq. (8) is invariant under the change R→ OR, so that the system is under-determined.\nOur approach relies on using the third order cumulant tensorK = [Kijk] which contains (d3 + 3d2 + 2d)/6 > d2 independent coefficients that are sufficient to uniquely fix the matrixG. This can be justified intuitively as follows: while the integrated covariance only contains symmetric information, and is thus unable to provide causal information, the skewness given by the third order cumulant in the estimation procedure can break the symmetry between past and future so as to uniquely fixG. Thus, our algorithm consists of selecting d2 third-order cumulant components, namely M = {Kiij}1≤i,j≤d. In particular, we define the estimator ofR as R̂ ∈ argminRL(R), where\nL(R) = (1− κ)‖Kc(R)− K̂c‖22 + κ‖C(R)− Ĉ‖22, (10)\nwhere ‖ ·‖2 stands for the Frobenius norm,Kc = {Kiij}1≤i,j≤d is the matrix obtained by the contraction of the tensorK to d2 indices,C is the covariance matrix, while K̂c and Ĉ are their respective estimators, see Equations (12), (13) below. It is noteworthy that the above mean square error approach can be seen as a peculiar Generalized Method of Moments (GMM), see Hall (2005). This framework allows us to determine the optimal weighting matrix involved in the loss function. However, this approach is unusable in practice, since the associated complexity is too high. Indeed, since we have d2 parameters, this matrix has d4 coefficients and GMM calls for computing its inverse leading to a O(d6) complexity. In this work, we use the coefficient κ to scale the two terms, as\nκ = ‖K̂c‖22\n‖K̂c‖22 + ‖Ĉ‖22 ,\nsee Section 4.4 for an explanation about the link between κ and the weighting matrix. Finally, the estimator ofG is straightforwardly obtained as\nĜ = Id − R̂ −1 ,\nfrom the inversion of Eq. (6). Let us mention an important point: the matrix inversion in the previous formula is not the bottleneck of the algorithm. Indeed, its has a complexity O(d3) that is cheap compared to the computation of the cumulants when n = maxi |Zi| d, which is the typical scaling satisfied in applications. Solving the considered problem on a larger scale, say d 103, is an open question, even with state-of-the-art parametric and nonparametric approaches, see for instance Zhou et al. (2013a); Xu et al. (2016); Zhou et al. (2013b); Bacry and Muzy (2016), where the number of components d in experiments is always around 100 or smaller. Note that, actually, our approach leads to a much faster algorithm than the considered state-of-the-art baselines, see Tables 1–4 from Section 3 below."
    }, {
      "heading" : "2.3 Estimation of the integrated cumulants",
      "text" : "In this section we present explicit formulas to estimate the three moment-based quantities listed in the previous section, namely, Λ, C and K. We first assume there exists H > 0 such that the truncation from (−∞,+∞) to [−H,H] of the domain of integration of the quantities appearing in Eqs. (4) and (5), introduces only a small error. In practice, this amounts to neglecting border effects in the covariance density and in the skewness density that is a good approximation if the support of the kernel φij(t) is smaller than H and the spectral norm ‖G‖ satisfies ‖G‖ < 1. In this case, given a realization of a stationary Hawkes process {N t : t ∈ [0, T ]}, as shown in Section 4, we can write the estimators of the first three cumulants (3), (4) and (5) as\nΛ̂i = 1\nT ∑ τ∈Zi 1 = N iT T\n(11)\nĈij = 1\nT ∑ τ∈Zi ( N jτ+H −N j τ−H − 2HΛ̂ j )\n(12)\nK̂ijk = 1\nT ∑ τ∈Zi ( N jτ+H −N j τ−H − 2HΛ̂ j ) · ( Nkτ+H −Nkτ−H − 2HΛ̂k ) − Λ̂ i\nT ∑ τ∈Zj ∑ τ ′∈Zk (2H − |τ ′ − τ |)+ + 4H2Λ̂iΛ̂jΛ̂k. (13)\nLet us mention the following facts.\nBias. While the first cumulant Λ̂i is an unbiased estimator of Λi, the other estimators Ĉij and K̂ijk introduce a bias. However, as we will show, in practice this bias is small and hardly affects numerical estimations (see Section 3). This is confirmed by our theoretical analysis, which proves that if H does not grow too fast compared to T , then these estimated cumulants are consistent estimators of the theoretical cumulants (see Section 2.6).\nComplexity. The computations of all the estimators of the first, second and third-order cumulants have complexity respectively O(nd), O(nd2) and O(nd3), where n = maxi |Zi|. However, our algorithm requires a lot less than that: it computes only d2 third-order terms, of the form K̂iij , leaving us with only O(nd2) operations to perform.\nSymmetry. While the values of Λi, Cij and Kijk are symmetric under permutation of the indices, their estimators are generally not symmetric. We have thus chosen to symmetrize the estimators by averaging their values over permutations of the indices. Worst case is for the estimator of Kc, which involves only an extra factor of 2 in the complexity."
    }, {
      "heading" : "2.4 The NPHC algorithm",
      "text" : "The objective to minimize in Equation (10) is non-convex. More precisely, the loss function is a polynomial ofR of degree 6. However, the expectations of cumulants Λ andC defined in Eq. (4) and (5) that appear in the definition of L(R) are unknown and should be replaced with Λ̂ and Ĉ. We denote L̃(R) the objective function, where the expectations of cumulants Λi and Cij have been replaced with their estimators in the right-hand side of Eqs. (8) and (9):\nL̃(R) = (1− κ)‖R 2Ĉ >\n+ 2[R (Ĉ −RL̂)]R> − K̂c‖22 + κ‖RL̂R> − Ĉ‖22 (14)\nAs explained in Choromanska et al. (2015), the loss function of a typical multilayer neural network with simple nonlinearities can be expressed as a polynomial function of the weights in the network,\nwhose degree is the number of layers. Since the loss function of NPHC writes as a polynomial of degree 6, we expect good results using optimization methods designed to train deep multilayer neural networks. We used the AdaGrad from Duchi et al. (2011), a variant of the Stochastic Gradient Descent with adaptive learning rates. AdaGrad scales the learning rates coordinate-wise using the online variance of the previous gradients, in order to incorporate second-order information during training. The NPHC method is summarized schematically in Algorithm 1.\nAlgorithm 1 Non Parametric Hawkes Cumulant method Input: N t Output: Ĝ\n1: Estimate Λ̂i, Ĉij , K̂iij from Eqs. (11, 12, 13) 2: Design L̃(R) using the computed estimators. 3: Minimize numerically L̃(R) so as to obtain R̂ 4: Return Ĝ = Id − R̂ −1 .\nOur problem being non-convex, the choice of the starting point has a major effect on the convergence. Here, the key is to notice that the matrices R that match Equation (8) writes C1/2OL−1/2, with L = diag(Λ) andO an orthogonal matrix. Our starting point is then simply chosen by settingO = Id in the previous formula, leading to nice convergence results. Even though our main concern is to retrieve the matrixG, let us notice we can also obtain an estimation of the baseline intensities’ from Eq. (3), which leads to µ̂ = R̂ −1 Λ̂. An efficient implementation of this algorithm with TensorFlow, see Abadi et al. (2016), is available on GitHub: https://github.com/achab/nphc."
    }, {
      "heading" : "2.5 Complexity of the algorithm",
      "text" : "Compared with existing state-of-the-art methods to estimate the kernel functions, e.g., the ordinary differential equations-based (ODE) algorithm in Zhou et al. (2013a), the Granger Causality-based algorithm in Xu et al. (2016), the ADM4 algorithm in Zhou et al. (2013b), and the Wiener-Hopf-based algorithm in Bacry and Muzy (2016), our method has a very competitive complexity. This can be understood by the fact that those methods estimate the kernel functions, while in NPHC we only estimate their integrals. The ODE-based algorithm is an EM algorithm that parametrizes the kernel function with M basis functions, each being discretized to L points. The basis functions are updated after solving M Euler-Lagrange equations. If n denotes the maximum number of events per component (i.e. n = max1≤i≤d |Zi|) then the complexity of one iteration of the algorithm isO(Mn3d2 +ML(nd+n2)). The Granger Causality-based algorithm is similar to the previous one, without the update of the basis functions, that are Gaussian kernels. The complexity per iteration is O(Mn3d2). The algorithm ADM4 is similar to the two algorithms above, as EM algorithm as well, with only one exponential kernel as basis function. The complexity per iteration is then O(n3d2). The Wiener-Hopf-based algorithm is not iterative, on the contrary to the previous ones. It first computes the empirical conditional laws on many points, and then invert the Wiener-Hopf system, leading to a O(nd2L+ d4L3) computation. Similarly, our method first computes the integrated cumulants, then minimize the objective function with Niter iterations, and invert the resulting matrix R̂ to obtain Ĝ. In the end, the complexity of the NPHC method is O(nd2 +Niterd3). According to this analysis, summarized in Table 1 below, one can see that in the regime n d, the NPHC method outperforms all the other ones."
    }, {
      "heading" : "2.6 Theoretical guarantee: consistency",
      "text" : "The NPHC method can be phrased using the framework of the Generalized Method of Moments (GMM). GMM is a generic method for estimating parameters in statistical models. In order to apply GMM,\nwe have to find a vector-valued function g(X, θ) of the data, where X is distributed with respect to a distribution Pθ0 , which satisfies the moment condition: E[g(X, θ)] = 0 if and only if θ = θ0, where θ0 is the “ground truth” value of the parameter. Based on i.i.d. observed copies x1, . . . , xn of X , the GMM method minimizes the norm of the empirical mean over n samples, ‖ 1n ∑n i=1 g(xi, θ)‖, as a function of θ, to obtain an estimate of θ0. In the theoretical analysis of NPHC, we use ideas from the consistency proof of the GMM, but the proof actually relies on very different arguments. Indeed, the integrated cumulants estimators used in NPHC are not unbiased, as the theory of GMM requires, but asymptotically unbiased. Moreover, the setting considered here, where data consists of a single realization {N t} of a Hawkes process strongly departs from the standard i.i.d setting. Our approach is therefore based on the GMM idea but the proof is actually not using the theory of GMM.\nIn the following, we use the subscript T to refer to quantities that only depend on the process (Nt) in the interval [0, T ] (e.g., the truncation term HT , the estimated integrated covariance ĈT or the estimated kernel norm matrix ĜT ). In the next equation, stands for the Hadamard product and 2 stands for the entrywise square of a matrix. We denoteG0 = Id −R−10 the true value ofG, and the R2d×d valued vector functions\ng0(R) =\n[ C −RLR> Kc −R 2C> − 2[R (C −RL)]R> ]\nĝT (R) =\n[ ĈT −RL̂TR>\nK̂cT −R 2Ĉ > T − 2[R (ĈT −RL̂T )]R> .\n]\nUsing these notations, L̃T (R) can be seen as the weighted squared Frobenius norm of ĝT (R). Moreover, when T → +∞, one has ĝT (R) P→ g0(R) under the conditions of the following theorem, where P→ stands for convergence in probability.\nTheorem 2.1 (Consistency of NPHC). Suppose that (Nt) is observed on R+ and assume that\n1. g0(R) = 0 if and only ifR = R0;\n2. R ∈ Θ, where Θ is a compact set;\n3. the spectral radius of the kernel norm matrix satisfies ‖G0‖ < 1;\n4. HT →∞ and H2T /T → 0.\nThen\nĜT = Id − (\narg min R∈Θ L̃T (R)\n)−1 P→ G0.\nThe proof of the Theorem is given in Section 4.5 below. Assumption 3 is mandatory for stability of the Hawkes process, and Assumptions 3 and 4 are sufficient to prove that the estimators of the integrated cumulants defined in Equations (11), (12) and (13) are asymptotically consistent. Assumption 2 is a very mild standard technical assumption allowing to prove consistency for estimators based on moments. Assumption 1 is a standard asymptotic moment condition, that allows to identity parameters from the integrated cumulants."
    }, {
      "heading" : "3 Numerical Experiments",
      "text" : "In this Section, we provide a comparison of NPHC with the state-of-the art, on simulated datasets with different kernel shapes, the MemeTracker dataset (social networks) and the order book dynamics dataset (finance).\nSimulated datasets. We simulated several datasets with Ogata’s Thinning algorithm Ogata (1981) using the open-source library tick1, each corresponding to a shape of kernel: rectangular, exponential or power law kernel, see Figure 1 below.\nThe integral of each kernel on its support equals α, 1/β can be regarded as a characteristic time-scale and γ is the scaling exponent for the power law distribution and a delay parameter for the rectangular one. We consider a non-symmetric block-matrix G to show that our method can effectively uncover causality between the nodes, see Figure 3. The matrix G has constant entries α on the three blocks - α = gij = 1/6 for dimension 10 and α = gij = 1/10 for dimension 100 -, and zero outside. The two other parameters’ values are the same for dimensions 10 and 100. The parameter γ is set to 1/2 on the three blocks as well, but we set three very different β0, β1 and β2 from one block to the other, with ratio βi+1/βi = 10 and β0 = 0.1. The number of events is roughly equal to 105 on average over the nodes. We ran the algorithm on three simulated datasets: a 10-dimensional process with rectangular kernels named Rect10, a 10-dimensional process with power law kernels named PLaw10 and a 100-dimensional process with exponential kernels named Exp100.\nMemeTracker dataset. We use events of the most active sites from the MemeTracker dataset2. This dataset contains the publication times of articles in many websites/blogs from August 2008 to April 2009, and hyperlinks between posts. We extract the top 100 media sites with the largest number of documents, with about 7 million of events. We use the links to trace the flow of information and establish an estimated ground truth for the matrixG. Indeed, when an hyperlink j appears in a post in website i, the link j can be regarded as a direct ancestor of the event. Then, Eq. (2) shows gij can be estimated by N i←jT /N j T = #{links j → i}/N j T .\n1https://github.com/X-DataInitiative/tick 2https://www.memetracker.org/data.html\nOrder book dynamics. We apply our method to financial data, in order to understand the self and crossinfluencing dynamics of all event types in an order book. An order book is a list of buy and sell orders for a specific financial instrument, the list being updated in real-time throughout the day. This model has first been introduced in Bacry et al. (2016), and models the order book via the following 8-dimensional point process: Nt = (P (a) t , P (b) t , T (a) t , T (b) t , L (a) t , L (b) t , C (a) t , C (b) t ), where P\n(a) (resp. P (b)) counts the number of upward (resp. downward) price moves, T (a) (resp. T (b)) counts the number of market orders at the ask3 (resp. at the bid) that do not move the price, L(a) (resp. L(b)) counts the number of limit orders at the ask4 (resp. at the bid) that do not move the price, and C(a) (resp. C(b)) counts the number of cancel orders at the ask5 (resp. at the bid) that do not move the price. The financial data has been provided by QuantHouse EUROPE/ASIA, and consists of DAX future contracts between 01/01/2014 and 03/01/2014.\nBaselines. We compare NPHC to state-of-the art baselines: the ODE-based algorithm (ODE) by Zhou et al. (2013a), the Granger Causality-based algorithm (GC) by Xu et al. (2016), the ADM4 algorithm (ADM4) by Zhou et al. (2013b), and the Wiener-Hopf-based algorithm (WH) by Bacry and Muzy (2016).\nMetrics. We evaluate the performance of the proposed methods using the computing time, the Relative Error\nRelErr(A,B) = 1\nd2 ∑ i,j |aij − bij | |aij | 1{aij 6=0} + |bij |1{aij=0}\nand the Mean Kendall Rank Correlation\nMRankCorr(A,B) = 1\nd d∑ i=1 RankCorr([ai•], [bi•]),\nwhere RankCorr(x, y) = 2d(d−1)(Nconcordant(x, y) −Ndiscordant(x, y)) with Nconcordant(x, y) the number of pairs (i, j) satisfying xi > xj and yi > yj or xi < xj and yi < yj and Ndiscordant(x, y) the number of pairs (i, j) for which the same condition is not satisfied.\nNote that RankCorr score is a value between −1 and 1, representing rank matching, but can take smaller values (in absolute value) if the entries of the vectors are not distinct.\n3i.e. buy orders that are executed and removed from the list 4i.e. buy orders added to the list 5i.e. the number of times a limit order at the ask is canceled: in our dataset, almost 95% of limit orders are canceled before\nexecution.\nDiscussion. We perform the ADM4 estimation, with exponential kernel, by giving the exact value β = β0 of one block. Let us stress that this helps a lot this baseline, in comparison to NPHC where nothing is specified on the shape of the kernel functions. We used M = 10 basis functions for both ODE and GC algorithms, and L = 50 quadrature points for WH. We did not run WH on the 100-dimensional datasets, for computing time reasons, because its complexity scales with d4. We ran multi-processed versions of the baseline methods on 56 cores, to decrease the computing time.\nOur method consistently performs better than all baselines, on the three synthetic datasets, on MemeTracker and on the financial dataset, both in terms of Kendall rank correlation and estimation error. Moreover, we observe that our algorithm is roughly 50 times faster than all the considered baselines.\nOn Rect10, PLaw10 and Exp100 our method gives very impressive results, despite the fact that it does not uses any prior shape on the kernel functions, while for instance the ADM4 baseline do. On Figure 3, we observe that the matrix Ĝ estimated with ADM4 recovers well the block for which β = β0, i.e. the value we gave to the method, but does not perform well on the two other blocks, while the matrix Ĝ estimated with NPHC approximately reaches the true value for each of the three blocks. On these simulated datasets, NPHC obtains a comparable or slightly better Kendall rank correlation, but improves a lot the relative error.\nOn MemeTracker, the baseline methods obtain a high relative error between 9% and 19% while our method achieves a relative error of 7% which is a strong improvement. Moreover, NPHC reaches a much better Kendall rank correlation, which proves that it leads to a much better recovery of the relative order of estimated influences than all the baselines. Indeed, it has been shown in Zhou et al. (2013a) that kernels of MemeTracker data are not exponential, nor power law. This partly explains why our approach behaves\nbetter. On the financial data, the estimated kernel norm matrix obtained via NPHC, see Figure 3, gave some interpretable results (see also Bacry et al. (2016)):\n1. Any 2× 2 sub-matrix with same kind of inputs (i.e. Prices changes, Trades, Limits or Cancels) is symmetric. This shows empirically that ask and bid have symmetric roles.\n2. The prices are mostly cross-excited, which means that a price increase is very likely to be followed by a price decrease, and conversely. This is consistent with the wavy prices we observe on financial markets.\n3. The market, limit and cancel orders are strongly self-excited. This can be explained by the persistence of order flows, and by the splitting of meta-orders into sequences of smaller orders. Moreover, we observe that orders impact the price without changing it. For example, the increase of cancel orders at the bid causes downward price moves."
    }, {
      "heading" : "4 Technical details",
      "text" : "We show in this section how to obtain the equations stated above, the estimators of the integrated cumulants and the scaling coefficient κ that appears in the objective function. We then prove the theorem of the paper.\n4.1 Proof of Equation (8)\nWe denote ν(z) the matrix\nνij(z) = Lz ( t→ E(dN iudN j u+t)\ndudt − ΛiΛj\n) ,\nwhere Lz(f) is the Laplace transform of f , and ψt = ∑ n≥1 φ (?n) t , where φ (?n) t refers to the n\nth autoconvolution of φt. Then we use the characterization of second-order statistics, first formulated in Hawkes (1971) and fully generalized in Bacry and Muzy (2016),\nν(z) = (Id + L−z(Ψ))L(Id + Lz(Ψ))>,\nwhere Lij = Λiδij with δij the Kronecker symbol. Since Id +Lz(Ψ) = (Id −Lz(Φ))−1, taking z = 0 in the previous equation gives\nν(0) = (Id −G)−1L(Id −G>)−1, C = RLR>,\nwhich gives us the result since the entry (i, j) of the last equation gives Cij = ∑\nm Λ mRimRjm.\n4.2 Proof of Equation (9)\nWe start from Jovanović et al. (2015), cf. Eqs. (48) to (51), and group some terms:\nKijk = ∑ m ΛmRimRjmRkm\n+ ∑ m RimRjm ∑ n ΛnRknL0(ψmn)\n+ ∑ m RimRkm ∑ n ΛnRjnL0(ψmn)\n+ ∑ m RjmRkm ∑ n ΛnRinL0(ψmn).\nUsing the relations L0(ψmn) = Rmn − δmn and Cij = ∑ m Λ mRimRjm, proves Equation (9)."
    }, {
      "heading" : "4.3 Integrated cumulants estimators",
      "text" : "For H > 0 let us denote ∆HN it = N i t+H −N it−H . Let us first remark that, if one restricts the integration domain to (−H,H) in Eqs. (4) and (5), one gets by permuting integrals and expectations:\nΛidt = E(dN it ) Cijdt = E ( dN it (∆HN j t − 2HΛj) ) Kijkdt = E ( dN it (∆HN j t − 2HΛj)(∆HNkt − 2HΛk)\n) − dtΛiE ( (∆HN j t − 2HΛj)(∆HNkt − 2HΛk) ) .\nThe estimators (11) and (12) are then naturally obtained by replacing the expectations by their empirical counterparts, notably\nE(dN itf(t)) dt → 1 T ∑ τ∈Zi f(τ).\nFor the estimator (13), we shall also notice that\nE((∆HN jt − 2HΛj)(∆HNkt − 2HΛk))\n= ∫ ∫ 1[−H,H](t)1[−H,H](t ′)Cjkt−t′dtdt ′\n= ∫ (2H − |t|)+Cjkt dt.\nWe estimate the last integral with the remark above."
    }, {
      "heading" : "4.4 Choice of the scaling coefficient κ",
      "text" : "Following the theory of GMM, we denote m(X, θ) a function of the data, where X is distributed with respect to a distribution Pθ0 , which satisfies the moment conditions g(θ) = E[m(X, θ)] = 0 if and only if θ = θ0, the parameter θ0 being the ground truth. For x1, . . . , xN observed copies of X , we denote ĝi(θ) = m(xi, θ), the usual choice of weighting matrix is ŴN (θ) = 1N ∑N i=1 ĝi(θ)ĝi(θ)\n>, and the objective to minimize is then(\n1\nN N∑ i=1 ĝi(θ)\n)( ŴN (θ1) )−1( 1 N N∑ i=1 ĝi(θ) ) , (15)\nwhere θ1 is a constant vector. Instead of computing the inverse weighting matrix, we rather use its projection on {αId : α ∈ R}. It can be shown that the projection choses α as the mean eigenvalue of ŴN (θ1). We can easily compute the sum of its eigenvalues:\nTr(ŴN (θ1)) = 1\nN N∑ i=1 Tr(ĝi(θ1)ĝi(θ1)>) = 1 N N∑ i=1 Tr(ĝi(θ1)>ĝi(θ1)) = 1 N N∑ i=1 ||ĝi(θ1)||22.\nIn our case, ĝ(R) = [ vec[K̂c −Kc(R)], vec[Ĉ −C(R)] ]> ∈ R2d2 . Considering a block-wise\nweighting matrix, one block for K̂c−Kc(R) and the other for Ĉ−C(R), the sum of the eigenvalues of the first block becomes ‖K̂c −Kc(R)‖22, and ‖Ĉ −C(R)‖22 for the second. We compute the previous terms withR1 = 0. All together, the objective function to minimize is\n1\n‖K̂c‖22 ‖Kc(R)− K̂c‖22 +\n1\n‖Ĉ‖22 ‖C(R)− Ĉ‖22. (16)\nDividing this function by ( 1/‖K̂c‖22 + 1/‖Ĉ‖22 )−1\n, and setting κ = ‖K̂c‖22/(‖K̂c‖22 + ‖Ĉ‖22), we obtaind the loss function given in Equation (10)."
    }, {
      "heading" : "4.5 Proof of the Theorem",
      "text" : "The main difference with the usual Generalized Method of Moments, see Hansen (1982), relies in the relaxation of the moment conditions, since we have E[ĝT (θ0)] = mT 6= 0. We adapt the proof of consistency given in Newey and McFadden (1994).\nWe can relate the integral of the Hawkes process’s kernels to the integrals of the cumulant densities, from Jovanović et al. (2015). Our cumulant matching method would fall into the usual GMM framework if we could estimate - without bias - the integral of the covariance on R, and the integral of the skewness on R2. Unfortunately, we can’t do that easily. We can however estimate without bias ∫ fTt C ij t dt\nand ∫ fTt K ijk t dt with f\nT a compact supported function on [−HT , HT ] that weakly converges to 1, with HT −→ ∞. In most cases we will take fTt = 1[−HT ,HT ](t). Denoting Ĉ\nij,(T ) the estimator of∫ fTt C ij t dt, the term |E[Ĉij,(T )]−Cij | = | ∫ fTt C ij t dt−Cij | can be considered a proxy to the distance to the classical GMM. This distance has to go to zero to make the rest of GMM’s proof work: the estimator Ĉij,(T ) is then asymptotically unbiased towards Cij when T goes to infinity."
    }, {
      "heading" : "4.5.1 Notations",
      "text" : "We observe the multivariate point process (N t) on R+, with Zi the events of the ith component. We will often write covariance / skewness instead of integrated covariance / skewness. In the rest of the document, we use the following notations. Hawkes kernels’ integrals Gtrue = ∫ Φtdt = ( ∫ φijt dt)ij = Id − (Rtrue)−1\nTheoretical mean matrix L = diag(Λ1, . . . ,Λd)\nTheoretical covariance C = RtrueL(Rtrue)>\nTheoretical skewness Kc = (Kiij)ij = (Rtrue) 2 C> + 2[Rtrue (C −RtrueL)](Rtrue)> Filtering function fT ≥ 0 supp(fT ) ⊂ [−HT , HT ] F T = ∫ fTs ds f̃ T t = f T −t\nEvents sets Zi,T,1 = Zi ∩ [HT , T +HT ] Zj,T,2 = Zj ∩ [0, T + 2HT ]\nEstimators of the mean Λ̂i = N iT+HT −N iHT T Λ̃ j = NjT+2HT T+2HT\nEstimator of the covariance Ĉij,(T ) = 1T ∑ τ∈Zi,T,1 (∑ τ ′∈Zj,T,2 fτ ′−τ − Λ̃jF T )\nEstimator of the skewness6\nK̂ijk,(T ) = 1\nT ∑ τ∈Zi,T,1  ∑ τ ′∈Zj,T,2 fτ ′−τ − Λ̃jF T  ∑ τ ′′∈Zk,T,2 fτ ′−τ − Λ̃kF T  − Λ̂ i\nT + 2HT ∑ τ ′∈Zj,T,2  ∑ τ ′′∈Zk,T,2 (fT ? f̃T )τ ′−τ ′′ − Λ̃k(F T )2 \n6When fTt = 1[−HT ,HT ](t), we remind that (f T ? f̃T )t = (2HT − |t|)+. This leads to the estimator we showed in the\narticle.\nGMM related notations\nθ = R and θ0 = Rtrue g0(θ) = vec [ C −RLR>\nKc −R 2C> − 2[R (C −RL)]R>\n] ∈ R2d2\nĝT (θ) = vec\n[ Ĉ (T ) −RL̂R>\nK̂c (T ) −R 2(Ĉ (T ) )> − 2[R (Ĉ (T ) −RL̂)]R>\n] ∈ R2d2\nQ0(θ) = g0(θ) >Wg0(θ) Q̂T (θ) = ĝT (θ) >ŴT ĝT (θ)"
    }, {
      "heading" : "4.5.2 Consistency",
      "text" : "First, let’s remind a useful theorem for consistency in GMM from Newey and McFadden (1994).\nTheorem 4.1. If there is a function Q0(θ) such that (i) Q0(θ) is uniquely maximized at θ0; (ii) Θ is compact; (iii) Q0(θ) is continuous; (iv) Q̂T (θ) converges uniformly in probability to Q0(θ), then θ̂T = arg max Q̂T (θ) P−→ θ0.\nWe can now prove the consistency of our estimator.\nTheorem 4.2. Suppose that (Nt) is observed on R+, ŴT P−→W , and\n1. W is positive semi-definite and Wg0(θ) = 0 if and only if θ = θ0,\n2. θ ∈ Θ, which is compact,\n3. the spectral radius of the kernel norm matrix satisfies ||Φ||∗ < 1, 4. ∀i, j, k ∈ [d], ∫ fTu C ij u du→ ∫ Ciju du and ∫ fTu f T v K ijk u,vdudv → ∫ Kijku,vdudv,\n5. (F T )2/T P−→ 0 and ||f ||∞ = O(1).\nThen\nθ̂T P−→ θ0.\nRemark 1. In practice, we use a constant sequence of weighting matrices: ŴT = Id.\nProof. Proceed by verifying the hypotheses of Theorem 2.1 from Newey and McFadden (1994). Condition 2.1(i) follows by (i) and by Q0(θ) = [W 1/2g0(θ)]>[W 1/2g0(θ)] > 0 = Q0(θ0). Indeed, there exists a neighborhood N of θ0 such that θ ∈ N\\{θ0} and g0(θ) 6= 0 since g0(θ) is a polynom. Condition 2.1(ii) follows by (ii). Condition 2.1(iii) is satisfied since Q0(θ) is a polynom. Condition 2.1(iv) is harder to prove. First, since ĝT (θ) is a polynom of θ, we prove easily that E[supθ∈Θ |ĝT (θ)|] <∞. Then, by Θ compact, g0(θ) is bounded on Θ, and by the triangle and Cauchy-Schwarz inequalities,∣∣Q̂T (θ)−Q0(θ)∣∣\n≤ ∣∣(ĝT (θ)− g0(θ))>ŴT (ĝT (θ)− g0(θ))∣∣\n+ ∣∣g0(θ)>(ŴT + Ŵ>T )(ĝT (θ)− g0(θ))∣∣+ ∣∣g0(θ)>(ŴT −W )g0(θ)∣∣ ≤ ‖ĝT (θ)− g0(θ)‖2‖ŴT ‖+ 2‖g0(θ)‖‖ĝT (θ)− g0(θ)‖‖ŴT ‖+ ‖g0(θ)‖2‖ŴT −W‖.\nTo prove supθ∈Θ ∣∣Q̂T (θ)−Q0(θ)∣∣ P−→ 0, we should now prove that supθ∈Θ‖ĝT (θ)− g0(θ)‖ P−→ 0. By Θ compact, it is sufficient to prove that ‖L̂−L‖ P−→ 0, ‖Ĉ (T ) −C‖ P−→ 0, and ‖K̂c (T ) −Kc‖ P−→ 0.\nProof that ‖L̂−L‖ P−→ 0\nThe estimator of L is unbiased so let’s focus on the variance of L̂.\nE[(Λ̂i − Λi)2] = E\n[( 1\nT ∫ T+HT HT (dN it − Λidt) )2]\n= 1\nT 2 ∫ T+HT HT ∫ T+HT HT E[(dN it − Λidt)(dN it′ − Λidt′)]\n= 1\nT 2 ∫ T+HT HT ∫ T+HT HT Ciit′−tdtdt ′\n≤ 1 T 2 ∫ T+HT HT Ciidt = Cii T −→ 0\nBy Markov inequality, we have just proved that ‖L̂−L‖ P−→ 0.\nProof that ‖Ĉ (T ) −C‖ P−→ 0\nFirst, let’s remind that E(Ĉ (T ) ) 6= C. Indeed,\nE ( Ĉij,(T ) ) = E ( 1\nT ∫ T+HT HT dN it ∫ T+2HT 0 dN jt′ft′−t − Λ̂ iΛ̃jF T ) = E ( 1\nT ∫ T+HT HT dN it ∫ T+2HT−t −t dN jt+sfs − ΛiΛjF T ) + ij,T,HTF T\n= 1\nT ∫ T+HT HT ∫ HT −HT fsE ( dN itdN j t+s − ΛiΛjds ) + ij,T,HTF T\n= ∫ fsC ij s ds+ ij,T,HTF T\nNow,\nij,T,HT = E ( ΛiΛj − Λ̂iΛ̃j )\n= − 1 T 2 ∫ T+HT HT ∫ T+2HT 0 E ( dN itdN j t′ − Λ iΛjdtdt′ )\n= − 1 T 2 ∫ T+HT HT ∫ T+2HT 0 Cijt−t′dtdt ′\n= − 1 T\n∫ ( 1 + ( HT − |t|\nT\n)−)+ Cijt dt\nSince f satisfies F T = o(T ), we have E(Ĉ (T ) ) −→ C. It remains now to prove that ‖Ĉ (T ) − E(Ĉ (T )\n)‖ P−→ 0. Let’s now focus on the variance of Ĉij,(T ) : V(Ĉij,(T )) = E ( (Ĉij,(T ))2 ) − E(Ĉij,(T ))2.\nNow, E ( (Ĉij,(T ))2 )\n= E  1 T 2 ∑ (τ,η,τ ′,η′)∈(Zi,T,1)2×(Zj,T,2)2 (fτ ′−τ − F T /(T + 2HT ))(fη′−η − F T /(T + 2HT ))  = E ( 1\nT 2 ∫ t,s∈[HT ,T+HT ] ∫ t′,s′ dN itdN j t′dN i sdN j s′(ft′−t − F T /(T + 2HT ))(fs′−s − F T /(T + 2HT )) )\n= 1\nT 2 ∫ t,s∈[HT ,T+HT ] ∫ t′,s′∈[0,T+2HT ] E ( dN itdN j t′dN i sdN j s′ ) · (ft′−t − F T /(T + 2HT ))(fs′−s − F T /(T + 2HT ))\nAnd,\nE(Ĉij,(T ))2\n= 1\nT 2 ∫ t,s∈[HT ,T+HT ] ∫ t′,s′∈[0,T+2HT ] E ( dN itdN j t′ ) E ( dN isdN j s′ ) · (ft′−t − F T /(T + 2HT ))(fs′−s − F T /(T + 2HT ))\nThen, the variance involves the integration towards the difference of moments µr,s,t,u − µr,sµt,u. Let’s write it as a sum of cumulants, since cumulants density are integrable.\nµr,s,t,u − µr,sµt,u = κr,s,t,u + κr,s,tκu[4] + κr,sκt,u[3] + κr,sκtκu[6] + κrκsκtκu − (κr,s + κrκs)(κt,u + κtκu) = κr,s,t,u\n+ κr,s,tκu + κu,r,sκt + κt,u,rκs + κs,t,uκr\n+ κr,tκs,u + κr,uκs,t\n+ κr,tκsκu + κr,uκsκt + κs,tκrκu + κs,tκrκu\nIn the rest of the proof, we denote at = 1t∈[HT ,T+HT ], bt = 1t∈[0,T+2HT ], ct = 1t∈[−HT ,HT ], gt = ft − 1T+2HT F T Before starting the integration of each term, let’s remark that:\n1. Ψt = ∑ n≥1 Φ (?n) t ≥ 0 since Φt ≥ 0.\n2. The regular parts ofCiju ,K ijk u,v (skewness density) andM ijkl u,v,w (fourth cumulant density) are positive\nas polynoms of integrals of ψab· with positive coefficients. The integrals of the singular parts are positive as well.\n3. (a) ∫ atbt′ft′−tdtdt ′ = TF T\n(b) ∫ atbt′gt′−tdtdt ′ = 0\n(c) ∫ atbt′ |gt′−t|dtdt′ ≤ 2TF T\n4. ∀t ∈ R, at(b ? g̃)t = 0, where g̃s = g−s.\nFourth cumulant We want here to compute ∫ κi,j,i,jt,t′,s,s′atbt′asbs′gt′−tgs′−sdtdt\n′dsds′. We remark that |gt′−tgs′−s| ≤ (||f ||∞(1 + 2HT /T ))2 ≤ 4||f ||2∞.∣∣∣ 1 T 2 ∫ κi,j,i,jt,t′,s,s′atbt′asbs′gt′−tgs′−sdtdt ′dsds′ ∣∣∣ ≤ (2||f ||∞ T )2 ∫ dtat ∫ dt′bt′ ∫ dsas ∫ ds′bs′M ijij t′−t,s−t,s′−t\n≤ (\n2||f ||∞ T\n)2 ∫ dtat ∫ dt′bt′ ∫ dsas ∫ dwM ijijt′−t,s−t,w\n≤ (\n2||f ||∞ T\n)2 ∫ dtat ∫ M ijiju,v,wdudvdw\n≤ 4||f || 2 ∞\nT M ijij −→ T→∞ 0\nThird × First We have four terms, but only two different forms since the roles of (s, s′) and (t, t′) are symmetric. First form ∫\nκi,j,it,t′,sΛ jGtdt =\nΛj\nT 2\n∫ κi,j,it,t′,satbt′asbs′gt′−tgs′−sdtdt ′dsds′\n= Λj\nT 2\n∫ κi,j,it,t′,satbt′as(b ? g̃)sgt′−tdtdt ′ds\n= 0 since as(b ? g̃)s = 0\nSecond form∣∣∣ ∫ κi,j,jt,t′,s′ΛiGtdt∣∣∣ = ∣∣∣ΛiT 2 ∫ κi,j,jt,t′,s′atbt′asbs′gt′−tgs′−sdtdt ′dsds′ ∣∣∣\n= ∣∣∣Λi T 2 ∫ κi,j,jt,t′,s′atbt′gt′−tbs′(a ? g)s′dtdt ′ds′ ∣∣∣ ≤ Λ i\nT 2 2||f ||∞\n∫ ds′bs′(a ? |g|)s′ ∫ dtat ∫ dt′bt′K ijj t′−s′,t−s′\n≤ 4||f ||∞KijjΛi F T\nT −→ T→∞ 0\nSecond × Second First form ∣∣∣ ∫ κi,it,sκj,jt′,s′Gtdt∣∣∣ ≤ 2||f ||∞T 2 ∫ Ciit−sC jj t′−s′atbt′ |gt′−t|asbs′dtdt ′dsds′\n≤ 2||f ||∞ T 2\nCiiCjj ∫ atbt′ |gt′−t|dtdt′\n≤ 4||f ||∞CiiCjj F T\nT −→ T→∞ 0\nSecond form ∣∣∣ ∫ κi,jt,s′κi,jt′,sGtdt∣∣∣ ≤ 4||f ||∞(Cij)2F TT −→T→∞ 0 Second × First × First First form ∫\nκi,jt,t′Λ iΛjGtdt =\nΛiΛj\nT 2\n∫ κi,jt,t′atbt′gt′−tdtdt ′ ∫ asbs′gs′−sdsds ′ = 0\nSecond form ∫ κi,it,sΛ jΛjGtdt = ( Λj\nT\n)2 ∫ κi,it,satbt′gt′−tas(b ? g̃)sdtdt ′ds = 0\nWe have just proved that V(Ĉ (T ) ) P−→ 0. By Markov inequality, it ensures us that ‖Ĉ (T ) −E(Ĉ (T ) )‖ P−→ 0, and finally that ‖Ĉ (T ) −C‖ P−→ 0.\nProof that ‖K̂c (T ) −Kc‖ P−→ 0\nThe scheme of the proof is similar to the previous one. The upper bounds of the integrals involve the same kind of terms, plus the new term (F T )2/T that goes to zero thanks to the assumption 5 of the theorem."
    }, {
      "heading" : "5 Conclusion",
      "text" : "In this paper, we introduce a simple nonparametric method (the NPHC algorithm) that leads to a fast and robust estimation of the matrixG of the kernel integrals of a Multivariate Hawkes process that encodes Granger causality between nodes. This method relies on the matching of the integrated order 2 and order 3 empirical cumulants, which represent the simplest set of global observables containing sufficient information to recover the matrixG. Since this matrix fully accounts for the self- and cross- influences of the process nodes (that can represent agents or users in applications), our approach can naturally be used to quantify the degree of endogeneity of a system and to uncover the causality structure of a network.\nBy performing numerical experiments involving very different kernel shapes, we show that the baselines, involving either parametric or non-parametric approaches are very sensible to model misspecification, do not lead to accurate estimation, and are numerically expensive, while NPHC provides fast, robust and reliable results. This is confirmed on the MemeTracker database, where we show that NPHC outperforms classical approaches based on EM algorithms or the Wiener-Hopf equations. Finally, the NPHC algorithm provided very satisfying results on financial data, that are consistent with well-known stylized facts in finance."
    }, {
      "heading" : "Acknowledgements",
      "text" : "This work benefited from the support of the chair “Changing markets”, CMAP École Polytechnique and École Polytechnique fund raising - Data Science Initiative.\nThe authors want to thank Marcello Rambaldi for fruitful discussions on order book data’s experiments."
    } ],
    "references" : [ {
      "title" : "Tensorflow: Large-scale machine learning on heterogeneous distributed systems",
      "author" : [ "M. Abadi", "A. Agarwal", "P. Barham", "E. Brevdo", "Z. Chen", "C. Citro", "G.S. Corrado", "A. Davis", "J. Dean", "M. Devin" ],
      "venue" : "arXiv preprint arXiv:1603.04467,",
      "citeRegEx" : "Abadi et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Abadi et al\\.",
      "year" : 2016
    }, {
      "title" : "Modeling financial contagion using mutually exciting jump processes",
      "author" : [ "Y. Aït-Sahalia", "J. Cacho-Diaz", "R. JA Laeven" ],
      "venue" : "Technical report, National Bureau of Economic Research,",
      "citeRegEx" : "Aït.Sahalia et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Aït.Sahalia et al\\.",
      "year" : 2010
    }, {
      "title" : "First- and second-order statistics characterization of hawkes processes and non-parametric estimation",
      "author" : [ "E. Bacry", "J.-F. Muzy" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "Bacry and Muzy.,? \\Q2016\\E",
      "shortCiteRegEx" : "Bacry and Muzy.",
      "year" : 2016
    }, {
      "title" : "Muzy. Hawkes processes in finance",
      "author" : [ "E. Bacry", "I. Mastromatteo", "J.-F" ],
      "venue" : "Market Microstructure and Liquidity,",
      "citeRegEx" : "Bacry et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Bacry et al\\.",
      "year" : 2015
    }, {
      "title" : "Estimation of slowly decreasing hawkes kernels: application to high-frequency order book dynamics",
      "author" : [ "E. Bacry", "T. Jaisson", "J.-F. Muzy" ],
      "venue" : "Quantitative Finance,",
      "citeRegEx" : "Bacry et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Bacry et al\\.",
      "year" : 2016
    }, {
      "title" : "The loss surfaces of multilayer networks",
      "author" : [ "A. Choromanska", "M. Henaff", "M. Mathieu", "G. Ben Arous", "Y. LeCun" ],
      "venue" : "In AISTATS,",
      "citeRegEx" : "Choromanska et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Choromanska et al\\.",
      "year" : 2015
    }, {
      "title" : "Robust dynamic classes revealed by measuring the response function of a social system",
      "author" : [ "R. Crane", "D. Sornette" ],
      "venue" : "Proceedings of the National Academy of Sciences,",
      "citeRegEx" : "Crane and Sornette.,? \\Q2008\\E",
      "shortCiteRegEx" : "Crane and Sornette.",
      "year" : 2008
    }, {
      "title" : "Zaatour. Hawkes process: Fast calibration, application to trade clustering, and diffusive limit",
      "author" : [ "R.J. Da Fonseca" ],
      "venue" : "Journal of Futures Markets,",
      "citeRegEx" : "Fonseca,? \\Q2014\\E",
      "shortCiteRegEx" : "Fonseca",
      "year" : 2014
    }, {
      "title" : "An Introduction to the Theory of Point Processes Volume I: Elementary Theory and Methods",
      "author" : [ "D.J. Daley", "D. Vere-Jones" ],
      "venue" : "Springer Science & Business Media,",
      "citeRegEx" : "Daley and Vere.Jones.,? \\Q2003\\E",
      "shortCiteRegEx" : "Daley and Vere.Jones.",
      "year" : 2003
    }, {
      "title" : "Adaptive subgradient methods for online learning and stochastic optimization",
      "author" : [ "J. Duchi", "E. Hazan", "Y. Singer" ],
      "venue" : "The Journal of Machine Learning Research,",
      "citeRegEx" : "Duchi et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Duchi et al\\.",
      "year" : 2011
    }, {
      "title" : "Graphical modeling for multivariate hawkes processes with nonparametric link functions",
      "author" : [ "M. Eichler", "R. Dahlhaus", "J. Dueck" ],
      "venue" : "Journal of Time Series Analysis, pages n/a–n/a,",
      "citeRegEx" : "Eichler et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Eichler et al\\.",
      "year" : 2016
    }, {
      "title" : "Coevolve: A joint point process model for information diffusion and network co-evolution",
      "author" : [ "M. Farajtabar", "Y. Wang", "M. Rodriguez", "S. Li", "H. Zha", "L. Song" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Farajtabar et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Farajtabar et al\\.",
      "year" : 2015
    }, {
      "title" : "Modeling information propagation with survival theory",
      "author" : [ "M. Gomez-Rodriguez", "J. Leskovec", "B. Schölkopf" ],
      "venue" : "Proceedings of the International Conference on Machine Learning,",
      "citeRegEx" : "Gomez.Rodriguez et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Gomez.Rodriguez et al\\.",
      "year" : 2013
    }, {
      "title" : "Investigating causal relations by econometric models and cross-spectral methods",
      "author" : [ "C.W.J. Granger" ],
      "venue" : "URL http://www.jstor",
      "citeRegEx" : "Granger.,? \\Q1969\\E",
      "shortCiteRegEx" : "Granger.",
      "year" : 1969
    }, {
      "title" : "Generalized Method of Moments",
      "author" : [ "A.R. Hall" ],
      "venue" : "Oxford university press,",
      "citeRegEx" : "Hall.,? \\Q2005\\E",
      "shortCiteRegEx" : "Hall.",
      "year" : 2005
    }, {
      "title" : "Large sample properties of generalized method of moments estimators",
      "author" : [ "L.P. Hansen" ],
      "venue" : "Econometrica: Journal of the Econometric Society,",
      "citeRegEx" : "Hansen.,? \\Q1982\\E",
      "shortCiteRegEx" : "Hansen.",
      "year" : 1982
    }, {
      "title" : "Lasso and probabilistic inequalities for multivariate point processes",
      "author" : [ "N.R. Hansen", "P. Reynaud-Bouret", "V. Rivoirard" ],
      "venue" : null,
      "citeRegEx" : "Hansen et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Hansen et al\\.",
      "year" : 2015
    }, {
      "title" : "Branching-ratio approximation for the self-exciting Hawkes process",
      "author" : [ "S.J. Hardiman", "J.-P. Bouchaud" ],
      "venue" : "Phys. Rev. E,",
      "citeRegEx" : "Hardiman and Bouchaud.,? \\Q2014\\E",
      "shortCiteRegEx" : "Hardiman and Bouchaud.",
      "year" : 2014
    }, {
      "title" : "Point spectra of some mutually exciting point processes",
      "author" : [ "A.G. Hawkes" ],
      "venue" : "Journal of the Royal Statistical Society. Series B (Methodological),",
      "citeRegEx" : "Hawkes.,? \\Q1971\\E",
      "shortCiteRegEx" : "Hawkes.",
      "year" : 1971
    }, {
      "title" : "A cluster process representation of a self-exciting process",
      "author" : [ "A.G. Hawkes", "D. Oakes" ],
      "venue" : "Journal of Applied Probability,",
      "citeRegEx" : "Hawkes and Oakes.,? \\Q1974\\E",
      "shortCiteRegEx" : "Hawkes and Oakes.",
      "year" : 1974
    }, {
      "title" : "Cumulants of Hawkes point processes",
      "author" : [ "S. Jovanović", "J. Hertz", "S. Rotter" ],
      "venue" : "Phys. Rev. E,",
      "citeRegEx" : "Jovanović et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Jovanović et al\\.",
      "year" : 2015
    }, {
      "title" : "Nonparametric markovian learning of triggering kernels for mutually exciting and mutually inhibiting multivariate hawkes processes",
      "author" : [ "R. Lemonnier", "N. Vayatis" ],
      "venue" : "In Machine Learning and Knowledge Discovery in Databases,",
      "citeRegEx" : "Lemonnier and Vayatis.,? \\Q2014\\E",
      "shortCiteRegEx" : "Lemonnier and Vayatis.",
      "year" : 2014
    }, {
      "title" : "A nonparametric em algorithm for multiscale hawkes processes",
      "author" : [ "E. Lewis", "G. Mohler" ],
      "venue" : "Journal of Nonparametric Statistics,",
      "citeRegEx" : "Lewis and Mohler.,? \\Q2011\\E",
      "shortCiteRegEx" : "Lewis and Mohler.",
      "year" : 2011
    }, {
      "title" : "Self-exciting point process modeling of crime",
      "author" : [ "G.O. Mohler", "M.B. Short", "P.J. Brantingham", "F.P. Schoenberg", "G.E. Tita" ],
      "venue" : "Journal of the American Statistical Association,",
      "citeRegEx" : "Mohler et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Mohler et al\\.",
      "year" : 2011
    }, {
      "title" : "Large sample estimation and hypothesis testing",
      "author" : [ "W. K Newey", "D. McFadden" ],
      "venue" : "Handbook of econometrics,",
      "citeRegEx" : "Newey and McFadden.,? \\Q1994\\E",
      "shortCiteRegEx" : "Newey and McFadden.",
      "year" : 1994
    }, {
      "title" : "On lewis’ simulation method for point processes",
      "author" : [ "Y. Ogata" ],
      "venue" : "Information Theory, IEEE Transactions on,",
      "citeRegEx" : "Ogata.,? \\Q1981\\E",
      "shortCiteRegEx" : "Ogata.",
      "year" : 1981
    }, {
      "title" : "Space-time point-process models for earthquake occurrences",
      "author" : [ "Y. Ogata" ],
      "venue" : "Annals of the Institute of Statistical Mathematics,",
      "citeRegEx" : "Ogata.,? \\Q1998\\E",
      "shortCiteRegEx" : "Ogata.",
      "year" : 1998
    }, {
      "title" : "Rethinking lda: moment matching for discrete ica",
      "author" : [ "A. Podosinnikova", "F. Bach", "S. Lacoste-Julien" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Podosinnikova et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Podosinnikova et al\\.",
      "year" : 2015
    }, {
      "title" : "Adaptive estimation for hawkes processes; application to genome analysis",
      "author" : [ "P. Reynaud-Bouret", "S. Schbath" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Reynaud.Bouret and Schbath.,? \\Q2010\\E",
      "shortCiteRegEx" : "Reynaud.Bouret and Schbath.",
      "year" : 2010
    }, {
      "title" : "Learning granger causality for hawkes processes",
      "author" : [ "H. Xu", "M. Farajtabar", "H. Zha" ],
      "venue" : "In Proceedings of The 33rd International Conference on Machine Learning,",
      "citeRegEx" : "Xu et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Xu et al\\.",
      "year" : 2016
    }, {
      "title" : "Mixture of mutually exciting processes for viral diffusion",
      "author" : [ "S.-H. Yang", "H. Zha" ],
      "venue" : "In Proceedings of the International Conference on Machine Learning,",
      "citeRegEx" : "Yang and Zha.,? \\Q2013\\E",
      "shortCiteRegEx" : "Yang and Zha.",
      "year" : 2013
    }, {
      "title" : "Learning triggering kernels for multi-dimensional hawkes processes",
      "author" : [ "K. Zhou", "H. Zha", "L. Song" ],
      "venue" : "In Proceedings of the International Conference on Machine Learning,",
      "citeRegEx" : "Zhou et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Zhou et al\\.",
      "year" : 2013
    }, {
      "title" : "Learning social infectivity in sparse low-rank networks using multidimensional hawkes processes",
      "author" : [ "K. Zhou", "H. Zha", "L. Song" ],
      "venue" : null,
      "citeRegEx" : "Zhou et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Zhou et al\\.",
      "year" : 2013
    } ],
    "referenceMentions" : [ {
      "referenceID" : 2,
      "context" : "(2016), the high-frequency variations of signals in finance, see Bacry et al. (2015), the earthquakes and aftershocks in geophysics, see Ogata (1998), the crime activity, see Mohler et al.",
      "startOffset" : 65,
      "endOffset" : 85
    }, {
      "referenceID" : 2,
      "context" : "(2016), the high-frequency variations of signals in finance, see Bacry et al. (2015), the earthquakes and aftershocks in geophysics, see Ogata (1998), the crime activity, see Mohler et al.",
      "startOffset" : 65,
      "endOffset" : 150
    }, {
      "referenceID" : 2,
      "context" : "(2016), the high-frequency variations of signals in finance, see Bacry et al. (2015), the earthquakes and aftershocks in geophysics, see Ogata (1998), the crime activity, see Mohler et al. (2011) or the position of genes in genomics, see Reynaud-Bouret and Schbath (2010).",
      "startOffset" : 65,
      "endOffset" : 196
    }, {
      "referenceID" : 2,
      "context" : "(2016), the high-frequency variations of signals in finance, see Bacry et al. (2015), the earthquakes and aftershocks in geophysics, see Ogata (1998), the crime activity, see Mohler et al. (2011) or the position of genes in genomics, see Reynaud-Bouret and Schbath (2010). The succession of the precise timestamps carries a great deal of information about the dynamics of the underlying systems.",
      "startOffset" : 65,
      "endOffset" : 272
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al.",
      "startOffset" : 115,
      "endOffset" : 137
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al.",
      "startOffset" : 115,
      "endOffset" : 167
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al.",
      "startOffset" : 115,
      "endOffset" : 192
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al. (2013a); Gomez-Rodriguez et al.",
      "startOffset" : 115,
      "endOffset" : 213
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al. (2013a); Gomez-Rodriguez et al. (2013); Farajtabar et al.",
      "startOffset" : 115,
      "endOffset" : 244
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al. (2013a); Gomez-Rodriguez et al. (2013); Farajtabar et al. (2015); Xu et al.",
      "startOffset" : 115,
      "endOffset" : 270
    }, {
      "referenceID" : 2,
      "context" : ", the different components of the counting process), by leveraging on their timestamp patterns, see, for instance, Bacry and Muzy (2016); Lemonnier and Vayatis (2014); Lewis and Mohler (2011); Zhou et al. (2013a); Gomez-Rodriguez et al. (2013); Farajtabar et al. (2015); Xu et al. (2016). Consider a set of nodes I = {1, .",
      "startOffset" : 115,
      "endOffset" : 288
    }, {
      "referenceID" : 8,
      "context" : "The vector λt characterizes the distribution of N t, see Daley and Vere-Jones (2003), and patterns in the events time-series can be captured by structuring these intensities.",
      "startOffset" : 57,
      "endOffset" : 85
    }, {
      "referenceID" : 17,
      "context" : "The Hawkes process introduced in Hawkes (1971) corresponds to an autoregressive structure of the intensities in order to capture self-excitation and cross-excitation of nodes, which is a phenomenon typically observed, for instance, in social networks, see for instance Crane and Sornette (2008).",
      "startOffset" : 4,
      "endOffset" : 47
    }, {
      "referenceID" : 6,
      "context" : "The Hawkes process introduced in Hawkes (1971) corresponds to an autoregressive structure of the intensities in order to capture self-excitation and cross-excitation of nodes, which is a phenomenon typically observed, for instance, in social networks, see for instance Crane and Sornette (2008). Namely, N t is called a Hawkes point process if the stochastic intensities can be written as",
      "startOffset" : 269,
      "endOffset" : 295
    }, {
      "referenceID" : 22,
      "context" : "Thus, for instance, in Yang and Zha (2013); Zhou et al.",
      "startOffset" : 23,
      "endOffset" : 43
    }, {
      "referenceID" : 22,
      "context" : "Thus, for instance, in Yang and Zha (2013); Zhou et al. (2013b); Farajtabar et al.",
      "startOffset" : 23,
      "endOffset" : 64
    }, {
      "referenceID" : 10,
      "context" : "(2013b); Farajtabar et al. (2015), they choose φij(t) = αijh(t) with αij ∈ R+ quantifies the intensity of the influence of j on i and h(t) a (normalized) function that characterizes the time-profile of this influence and that is shared by all couples of nodes (i, j) (most often, it is chosen to be either exponential h(t) = βe−βt or power law h(t) = βt−(β+1)).",
      "startOffset" : 9,
      "endOffset" : 34
    }, {
      "referenceID" : 10,
      "context" : "(2013b); Farajtabar et al. (2015), they choose φij(t) = αijh(t) with αij ∈ R+ quantifies the intensity of the influence of j on i and h(t) a (normalized) function that characterizes the time-profile of this influence and that is shared by all couples of nodes (i, j) (most often, it is chosen to be either exponential h(t) = βe−βt or power law h(t) = βt−(β+1)). Both approaches are, most of the time, highly non-realistic. On the one hand there is a priori no reason for assuming that the time-profile of the influence of a node j on a node i does not depend on the pair (i, j). On the other hand, assuming an exponential shape or a power law shape for a kernel arbitrarily imposes an event impact that is always instantly maximal and that can only decrease with time, while in practice, there may exist a latency between an event and its maximal impact. In order to have more flexibility on the shape of the kernels, nonparametric estimation can be considered. Expectation-Maximization algorithms can be found in Lewis and Mohler (2011) (for d = 1) or in Zhou et al.",
      "startOffset" : 9,
      "endOffset" : 1038
    }, {
      "referenceID" : 10,
      "context" : "(2013b); Farajtabar et al. (2015), they choose φij(t) = αijh(t) with αij ∈ R+ quantifies the intensity of the influence of j on i and h(t) a (normalized) function that characterizes the time-profile of this influence and that is shared by all couples of nodes (i, j) (most often, it is chosen to be either exponential h(t) = βe−βt or power law h(t) = βt−(β+1)). Both approaches are, most of the time, highly non-realistic. On the one hand there is a priori no reason for assuming that the time-profile of the influence of a node j on a node i does not depend on the pair (i, j). On the other hand, assuming an exponential shape or a power law shape for a kernel arbitrarily imposes an event impact that is always instantly maximal and that can only decrease with time, while in practice, there may exist a latency between an event and its maximal impact. In order to have more flexibility on the shape of the kernels, nonparametric estimation can be considered. Expectation-Maximization algorithms can be found in Lewis and Mohler (2011) (for d = 1) or in Zhou et al. (2013a) (d > 1).",
      "startOffset" : 9,
      "endOffset" : 1076
    }, {
      "referenceID" : 2,
      "context" : "An alternative method is proposed in Bacry and Muzy (2016) where the nonparametric estimation is formulated as a numerical solving of a Wiener-Hopf equation.",
      "startOffset" : 37,
      "endOffset" : 59
    }, {
      "referenceID" : 2,
      "context" : "An alternative method is proposed in Bacry and Muzy (2016) where the nonparametric estimation is formulated as a numerical solving of a Wiener-Hopf equation. Another nonparametric strategy considers a decomposition of kernels on a dictionary of function h1, . . . , hK , namely φij(t) = ∑K k=1 a ij k hk(t), where the coefficients a ij k are estimated, see Hansen et al. (2015); Lemonnier and Vayatis (2014) and Xu et al.",
      "startOffset" : 37,
      "endOffset" : 378
    }, {
      "referenceID" : 2,
      "context" : "An alternative method is proposed in Bacry and Muzy (2016) where the nonparametric estimation is formulated as a numerical solving of a Wiener-Hopf equation. Another nonparametric strategy considers a decomposition of kernels on a dictionary of function h1, . . . , hK , namely φij(t) = ∑K k=1 a ij k hk(t), where the coefficients a ij k are estimated, see Hansen et al. (2015); Lemonnier and Vayatis (2014) and Xu et al.",
      "startOffset" : 37,
      "endOffset" : 408
    }, {
      "referenceID" : 2,
      "context" : "An alternative method is proposed in Bacry and Muzy (2016) where the nonparametric estimation is formulated as a numerical solving of a Wiener-Hopf equation. Another nonparametric strategy considers a decomposition of kernels on a dictionary of function h1, . . . , hK , namely φij(t) = ∑K k=1 a ij k hk(t), where the coefficients a ij k are estimated, see Hansen et al. (2015); Lemonnier and Vayatis (2014) and Xu et al. (2016), where group-lasso is used to induce a sparsity pattern on the coefficients a k that is shared across k = 1, .",
      "startOffset" : 37,
      "endOffset" : 429
    }, {
      "referenceID" : 17,
      "context" : "As it can be seen from the cluster representation of Hawkes processes (Hawkes and Oakes (1974)), this integral represents the mean total number of events of type i directly triggered by an event of type j, and then encodes a notion of causality.",
      "startOffset" : 53,
      "endOffset" : 95
    }, {
      "referenceID" : 13,
      "context" : "1), such integral can be related to the Granger causality (Granger (1969)).",
      "startOffset" : 40,
      "endOffset" : 74
    }, {
      "referenceID" : 16,
      "context" : "As it will be shown, this approach turns out to be particularly robust to the kernel shapes, which is not the case of all previous Hawkes-based approaches that aim causality recovery. We call this method NPHC (Non Parametric Hawkes Cumulant), since our approach is of nonparametric nature. We provide a theoretical analysis that proves the consistency of the NPHC estimator. Our proof is based on ideas from the theory of Generalized Method of Moments (GMM) but requires an original technical trick since our setting strongly departs from the standard parametric statistics with i.i.d observations. Note that moment and cumulant matching techniques proved particularly powerful for latent topic models, in particular Latent Dirichlet Allocation, see Podosinnikova et al. (2015). A small set of previous works, namely Da Fonseca and Zaatour (2014); Aït-Sahalia et al.",
      "startOffset" : 131,
      "endOffset" : 778
    }, {
      "referenceID" : 6,
      "context" : "A small set of previous works, namely Da Fonseca and Zaatour (2014); Aït-Sahalia et al.",
      "startOffset" : 41,
      "endOffset" : 68
    }, {
      "referenceID" : 1,
      "context" : "A small set of previous works, namely Da Fonseca and Zaatour (2014); Aït-Sahalia et al. (2010), already used method of moments with Hawkes processes, but only in a parametric setting.",
      "startOffset" : 69,
      "endOffset" : 95
    }, {
      "referenceID" : 13,
      "context" : "1 Branching structure and Granger causality From the definition of Hawkes process as a Poisson cluster process, see Jovanović et al. (2015) or Hawkes and Oakes (1974), gij can be simply interpreted as the average total number of events of node i whose direct ancestor is a given event of node j (by direct we mean that interactions mediated by any other intermediate event are not counted).",
      "startOffset" : 26,
      "endOffset" : 140
    }, {
      "referenceID" : 13,
      "context" : "1 Branching structure and Granger causality From the definition of Hawkes process as a Poisson cluster process, see Jovanović et al. (2015) or Hawkes and Oakes (1974), gij can be simply interpreted as the average total number of events of node i whose direct ancestor is a given event of node j (by direct we mean that interactions mediated by any other intermediate event are not counted).",
      "startOffset" : 26,
      "endOffset" : 167
    }, {
      "referenceID" : 3,
      "context" : "Namely, introducing the counting function N i←j t that counts the number of events of i whose direct ancestor is an event of j, we know from Bacry et al. (2015) that E[dN i←j t ] = g E[dN j t ] = g Λdt, (2) where we introduced Λi as the intensity expectation, namely satisfying E[dN i t ] = Λidt.",
      "startOffset" : 141,
      "endOffset" : 161
    }, {
      "referenceID" : 3,
      "context" : "Namely, introducing the counting function N i←j t that counts the number of events of i whose direct ancestor is an event of j, we know from Bacry et al. (2015) that E[dN i←j t ] = g E[dN j t ] = g Λdt, (2) where we introduced Λi as the intensity expectation, namely satisfying E[dN i t ] = Λidt. Note that Λi does not depend on time by stationarity ofN t, which is known to hold under the stability condition ‖G‖ < 1, where ‖G‖ stands for the spectral norm ofG. In particular, this condition implies the non-singularity of Id −G. Since the question of a real causality is too complex in general, most econometricians agreed on the simpler definition of Granger causality Granger (1969). Its mathematical formulation is a statistical hypothesis test: X causes Y in the sense of Granger causality if forecasting future values of Y is more successful while taking X past values into account.",
      "startOffset" : 141,
      "endOffset" : 687
    }, {
      "referenceID" : 3,
      "context" : "Namely, introducing the counting function N i←j t that counts the number of events of i whose direct ancestor is an event of j, we know from Bacry et al. (2015) that E[dN i←j t ] = g E[dN j t ] = g Λdt, (2) where we introduced Λi as the intensity expectation, namely satisfying E[dN i t ] = Λidt. Note that Λi does not depend on time by stationarity ofN t, which is known to hold under the stability condition ‖G‖ < 1, where ‖G‖ stands for the spectral norm ofG. In particular, this condition implies the non-singularity of Id −G. Since the question of a real causality is too complex in general, most econometricians agreed on the simpler definition of Granger causality Granger (1969). Its mathematical formulation is a statistical hypothesis test: X causes Y in the sense of Granger causality if forecasting future values of Y is more successful while taking X past values into account. In Eichler et al. (2016), it is shown that for N t a multivariate Hawkes process, N j t does not Granger-cause N i t w.",
      "startOffset" : 141,
      "endOffset" : 915
    }, {
      "referenceID" : 18,
      "context" : "2 Integrated cumulants of the Hawkes process A general formula for the integral of the cumulants of a multivariate Hawkes process is provided in Jovanović et al. (2015). As explained below, for the purpose of our method, we only need to consider cumulants up to the third order.",
      "startOffset" : 30,
      "endOffset" : 169
    }, {
      "referenceID" : 2,
      "context" : "Using the martingale representation from Bacry and Muzy (2016) or the Poisson cluster process representation from Jovanović et al.",
      "startOffset" : 41,
      "endOffset" : 63
    }, {
      "referenceID" : 2,
      "context" : "Using the martingale representation from Bacry and Muzy (2016) or the Poisson cluster process representation from Jovanović et al. (2015), one can obtain an explicit relationship between these integrated cumulants and the matrixG.",
      "startOffset" : 41,
      "endOffset" : 138
    }, {
      "referenceID" : 16,
      "context" : "The simplest case d = 1 has been considered in Hardiman and Bouchaud (2014), where it is shown that one can choose M = {C11} in order to compute the kernel integral.",
      "startOffset" : 47,
      "endOffset" : 76
    }, {
      "referenceID" : 14,
      "context" : "It is noteworthy that the above mean square error approach can be seen as a peculiar Generalized Method of Moments (GMM), see Hall (2005). This framework allows us to determine the optimal weighting matrix involved in the loss function.",
      "startOffset" : 126,
      "endOffset" : 138
    }, {
      "referenceID" : 29,
      "context" : "Solving the considered problem on a larger scale, say d 103, is an open question, even with state-of-the-art parametric and nonparametric approaches, see for instance Zhou et al. (2013a); Xu et al.",
      "startOffset" : 167,
      "endOffset" : 187
    }, {
      "referenceID" : 28,
      "context" : "(2013a); Xu et al. (2016); Zhou et al.",
      "startOffset" : 9,
      "endOffset" : 26
    }, {
      "referenceID" : 28,
      "context" : "(2013a); Xu et al. (2016); Zhou et al. (2013b); Bacry and Muzy (2016), where the number of components d in experiments is always around 100 or smaller.",
      "startOffset" : 9,
      "endOffset" : 47
    }, {
      "referenceID" : 2,
      "context" : "(2013b); Bacry and Muzy (2016), where the number of components d in experiments is always around 100 or smaller.",
      "startOffset" : 9,
      "endOffset" : 31
    }, {
      "referenceID" : 5,
      "context" : "(8) and (9): L̃(R) = (1− κ)‖R Ĉ > + 2[R (Ĉ −RL̂)]R> − K̂‖2 + κ‖RL̂R> − Ĉ‖2 (14) As explained in Choromanska et al. (2015), the loss function of a typical multilayer neural network with simple nonlinearities can be expressed as a polynomial function of the weights in the network,",
      "startOffset" : 96,
      "endOffset" : 122
    }, {
      "referenceID" : 9,
      "context" : "We used the AdaGrad from Duchi et al. (2011), a variant of the Stochastic Gradient Descent with adaptive learning rates.",
      "startOffset" : 25,
      "endOffset" : 45
    }, {
      "referenceID" : 0,
      "context" : "An efficient implementation of this algorithm with TensorFlow, see Abadi et al. (2016), is available on GitHub: https://github.",
      "startOffset" : 67,
      "endOffset" : 87
    }, {
      "referenceID" : 28,
      "context" : ", the ordinary differential equations-based (ODE) algorithm in Zhou et al. (2013a), the Granger Causality-based algorithm in Xu et al.",
      "startOffset" : 63,
      "endOffset" : 83
    }, {
      "referenceID" : 12,
      "context" : "(2013a), the Granger Causality-based algorithm in Xu et al. (2016), the ADM4 algorithm in Zhou et al.",
      "startOffset" : 13,
      "endOffset" : 67
    }, {
      "referenceID" : 12,
      "context" : "(2013a), the Granger Causality-based algorithm in Xu et al. (2016), the ADM4 algorithm in Zhou et al. (2013b), and the Wiener-Hopf-based algorithm in Bacry and Muzy (2016), our method has a very competitive complexity.",
      "startOffset" : 13,
      "endOffset" : 110
    }, {
      "referenceID" : 2,
      "context" : "(2013b), and the Wiener-Hopf-based algorithm in Bacry and Muzy (2016), our method has a very competitive complexity.",
      "startOffset" : 48,
      "endOffset" : 70
    }, {
      "referenceID" : 29,
      "context" : "Method Total complexity ODE Zhou et al. (2013a) O(NiterM(nd + L(nd+ n))) GC Xu et al.",
      "startOffset" : 28,
      "endOffset" : 48
    }, {
      "referenceID" : 28,
      "context" : "(2013a) O(NiterM(nd + L(nd+ n))) GC Xu et al. (2016) O(NiterMnd) ADM4 Zhou et al.",
      "startOffset" : 36,
      "endOffset" : 53
    }, {
      "referenceID" : 28,
      "context" : "(2013a) O(NiterM(nd + L(nd+ n))) GC Xu et al. (2016) O(NiterMnd) ADM4 Zhou et al. (2013b) O(Niternd) WH Bacry and Muzy (2016) O(ndL+ dL) NPHC O(nd +Niterd)",
      "startOffset" : 36,
      "endOffset" : 90
    }, {
      "referenceID" : 2,
      "context" : "(2013b) O(Niternd) WH Bacry and Muzy (2016) O(ndL+ dL) NPHC O(nd +Niterd)",
      "startOffset" : 22,
      "endOffset" : 44
    }, {
      "referenceID" : 25,
      "context" : "We simulated several datasets with Ogata’s Thinning algorithm Ogata (1981) using the open-source library tick1, each corresponding to a shape of kernel: rectangular, exponential or power law kernel, see Figure 1 below.",
      "startOffset" : 35,
      "endOffset" : 75
    }, {
      "referenceID" : 3,
      "context" : "This model has first been introduced in Bacry et al. (2016), and models the order book via the following 8-dimensional point process: Nt = (P (a) t , P (b) t , T (a) t , T (b) t , L (a) t , L (b) t , C (a) t , C (b) t ), where P (a) (resp.",
      "startOffset" : 40,
      "endOffset" : 60
    }, {
      "referenceID" : 28,
      "context" : "We compare NPHC to state-of-the art baselines: the ODE-based algorithm (ODE) by Zhou et al. (2013a), the Granger Causality-based algorithm (GC) by Xu et al.",
      "startOffset" : 80,
      "endOffset" : 100
    }, {
      "referenceID" : 12,
      "context" : "(2013a), the Granger Causality-based algorithm (GC) by Xu et al. (2016), the ADM4 algorithm (ADM4) by Zhou et al.",
      "startOffset" : 13,
      "endOffset" : 72
    }, {
      "referenceID" : 12,
      "context" : "(2013a), the Granger Causality-based algorithm (GC) by Xu et al. (2016), the ADM4 algorithm (ADM4) by Zhou et al. (2013b), and the Wiener-Hopf-based algorithm (WH) by Bacry and Muzy (2016).",
      "startOffset" : 13,
      "endOffset" : 122
    }, {
      "referenceID" : 2,
      "context" : "(2013b), and the Wiener-Hopf-based algorithm (WH) by Bacry and Muzy (2016).",
      "startOffset" : 53,
      "endOffset" : 75
    }, {
      "referenceID" : 31,
      "context" : "Indeed, it has been shown in Zhou et al. (2013a) that kernels of MemeTracker data are not exponential, nor power law.",
      "startOffset" : 29,
      "endOffset" : 49
    }, {
      "referenceID" : 3,
      "context" : "On the financial data, the estimated kernel norm matrix obtained via NPHC, see Figure 3, gave some interpretable results (see also Bacry et al. (2016)): 1.",
      "startOffset" : 131,
      "endOffset" : 151
    }, {
      "referenceID" : 17,
      "context" : "Then we use the characterization of second-order statistics, first formulated in Hawkes (1971) and fully generalized in Bacry and Muzy (2016),",
      "startOffset" : 81,
      "endOffset" : 95
    }, {
      "referenceID" : 2,
      "context" : "Then we use the characterization of second-order statistics, first formulated in Hawkes (1971) and fully generalized in Bacry and Muzy (2016),",
      "startOffset" : 120,
      "endOffset" : 142
    }, {
      "referenceID" : 20,
      "context" : "2 Proof of Equation (9) We start from Jovanović et al. (2015), cf.",
      "startOffset" : 38,
      "endOffset" : 62
    }, {
      "referenceID" : 15,
      "context" : "5 Proof of the Theorem The main difference with the usual Generalized Method of Moments, see Hansen (1982), relies in the relaxation of the moment conditions, since we have E[ĝT (θ0)] = mT 6= 0.",
      "startOffset" : 93,
      "endOffset" : 107
    }, {
      "referenceID" : 15,
      "context" : "5 Proof of the Theorem The main difference with the usual Generalized Method of Moments, see Hansen (1982), relies in the relaxation of the moment conditions, since we have E[ĝT (θ0)] = mT 6= 0. We adapt the proof of consistency given in Newey and McFadden (1994).",
      "startOffset" : 93,
      "endOffset" : 264
    }, {
      "referenceID" : 18,
      "context" : "We can relate the integral of the Hawkes process’s kernels to the integrals of the cumulant densities, from Jovanović et al. (2015). Our cumulant matching method would fall into the usual GMM framework if we could estimate - without bias - the integral of the covariance on R, and the integral of the skewness on R2.",
      "startOffset" : 34,
      "endOffset" : 132
    }, {
      "referenceID" : 24,
      "context" : "2 Consistency First, let’s remind a useful theorem for consistency in GMM from Newey and McFadden (1994). Theorem 4.",
      "startOffset" : 79,
      "endOffset" : 105
    }, {
      "referenceID" : 24,
      "context" : "2 Consistency First, let’s remind a useful theorem for consistency in GMM from Newey and McFadden (1994). Theorem 4.1. If there is a function Q0(θ) such that (i) Q0(θ) is uniquely maximized at θ0; (ii) Θ is compact; (iii) Q0(θ) is continuous; (iv) Q̂T (θ) converges uniformly in probability to Q0(θ), then θ̂T = arg max Q̂T (θ) P −→ θ0. We can now prove the consistency of our estimator. Theorem 4.2. Suppose that (Nt) is observed on R+, ŴT P −→W , and 1. W is positive semi-definite and Wg0(θ) = 0 if and only if θ = θ0, 2. θ ∈ Θ, which is compact, 3. the spectral radius of the kernel norm matrix satisfies ||Φ||∗ < 1, 4. ∀i, j, k ∈ [d], ∫ fT u C ij u du→ ∫ C u du and ∫ fT u f T v K ijk u,vdudv → ∫ K u,vdudv, 5. (F T )2/T P −→ 0 and ||f ||∞ = O(1). Then θ̂T P −→ θ0. Remark 1. In practice, we use a constant sequence of weighting matrices: ŴT = Id. Proof. Proceed by verifying the hypotheses of Theorem 2.1 from Newey and McFadden (1994). Condition 2.",
      "startOffset" : 79,
      "endOffset" : 942
    } ],
    "year" : 2017,
    "abstractText" : "We design a new nonparametric method that allows one to estimate the matrix of integrated kernels of a multivariate Hawkes process. This matrix not only encodes the mutual influences of each node of the process, but also disentangles the causality relationships between them. Our approach is the first that leads to an estimation of this matrix without any parametric modeling and estimation of the kernels themselves. As a consequence, it can give an estimation of causality relationships between nodes (or users), based on their activity timestamps (on a social network for instance), without knowing or estimating the shape of the activities lifetime. For that purpose, we introduce a moment matching method that fits the second-order and the third-order integrated cumulants of the process. A theoretical analysis allows us to prove that this new estimation technique is consistent. Moreover, we show, on numerical experiments, that our approach is indeed very robust with respect to the shape of the kernels and gives appealing results on the MemeTracker database and on financial order book data.",
    "creator" : "LaTeX with hyperref package"
  }
}