{
  "name" : "1704.00445.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "On Kernelized Multi-armed Bandits",
    "authors" : [ "Sayak Ray Chowdhury", "Aditya Gopalan" ],
    "emails" : [ "SRCHOWDHURY@ECE.IISC.ERNET.IN", "ADITYA@ECE.IISC.ERNET.IN" ],
    "sections" : [ {
      "heading" : null,
      "text" : "over the arms assumed to be fixed but unknown. We provide two new Gaussian process-based algorithms for continuous bandit optimization – Improved GP-UCB (IGP-UCB) and GP-Thomson sampling (GP-TS), and derive corresponding regret bounds. Specifically, the bounds hold when the expected reward function belongs to the reproducing kernel Hilbert space (RKHS) that naturally corresponds to a Gaussian process kernel used as input by the algorithms. Along the way, we derive a new self-normalized concentration inequality for vectorvalued martingales of arbitrary, possibly infinite, dimension. Finally, experimental evaluation and comparisons to existing algorithms on synthetic and real-world environments are carried out that highlight the favorable gains of the proposed strategies in many cases."
    }, {
      "heading" : "1. Introduction",
      "text" : "Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al. (2008). A typical feature of such problems is a large, or potentially infinite, domain of decision points or covariates (prices, actions, transmit powers), together with only partial and noisy observability of the associated outcomes (demand, state/reward, communication rate); reward/loss information is revealed only for decisions that are chosen. This often makes it hard to balance exploration and exploitation, as available knowledge must be transferred efficiently from a finite set of observations so far to estimates of the values of infinitely many decisions. A classic case in point is that of the canonical stochastic MAB with finitely many arms, where the effort to optimize scales with the total number of arms or decisions; the effect of this is catastrophic for large or infinite arm sets.\nWith suitable structure in the values or rewards of arms, however, the challenge of sequential optimization can be efficiently addressed. Parametric bandits, especially linearly parameterized bandits Rusmevichientong and Tsitsiklis (2010), represent a well-studied class of structured decision making settings. Here, every arm corresponds to a known, finite dimensional vector (its feature vector), and its expected reward is assumed to be an unknown linear function of its feature vector. This allows for a large, or even infinite, set of arms all lying in space of finite dimension, say d, and a rich line of work gives algorithms that attain sublinear regret with a polynomial dependence on the dimension, e.g., Confidence Ball Dani et al. (2008), OFUL Abbasi-Yadkori et al. (2011) (a strengthening of Confidence Ball) and Thompson sampling for linear bandits\nar X\niv :1\n70 4.\n00 44\n5v 1\n[ cs\n.L G\n] 3\nAgrawal and Goyal (2013)1 The insight here is that even though the number of arms can be large, the number of unknown parameters (or degrees of freedom) in the problem is really only d, which makes it possible to learn about the values of many other arms by playing a single arm.\nA different approach to modelling bandit problems with a continuum of arms is via the framework of Gaussian processes (GPs) Rasmussen and Williams (2006). GPs are a flexible class of nonparametric models for expressing uncertainty over functions on rather general domain sets, which generalize multivariate Gaussian random vectors. GPs allow tractable regression for estimating an unknown function given a set of (noisy) measurements of its values at chosen domain points. The fact that GPs, being distributions on functions, can also help quantify function uncertainty makes it attractive for basing decision making strategies on them. This has been exploited to great advantage to build nonparametric bandit algorithms, such as GP-UCB Srinivas et al. (2009), GP-EI and GP-PI Wang et al. (2016). In fact, GP models for bandit optimization, in terms of their kernel maps, can be viewed as the parametric linear bandit paradigm pushed to the extreme, where each feature vector associated to an arm can have infinite dimension 2.\nAgainst this backdrop, our work revisits the problem of bandit optimization with stochastic rewards. Specifically, we consider stochastic multiarmed bandit (MAB) problems with a continuous arm set, and whose (unknown) expected reward function is assumed to lie in a reproducing kernel Hilbert space (RKHS), with bounded RKHS norm – this effectively enforces smoothness on the function3. We make the following contributions-\n• We design a new algorithm – Improved Gaussian Process-Upper Confidence Bound (IGP-UCB) – for stochastic bandit optimization. The algorithm can be viewed as a variant of GP-UCB Srinivas et al. (2009), but uses a significantly reduced confidence interval width resulting in an order-wise improvement in regret compared to GP-UCB. IGP-UCB also shows a markedly improved numerical performance over GP-UCB.\n• We develop a nonparametric version of Thompson sampling, called Gaussian Process Thompson sampling (GP-TS), and show that enjoys a regret bound of Õ ( γT √ dT )\n. Here, T is the total time horizon and γT is a quantity depending on the RKHS containing the reward function. This is, to our knowledge, the first known regret bound for Thompson sampling in the agnostic setup with nonparametric structure.\n• We prove a new self-normalized concentration inequality for infinite-dimensional vector-valued martingales, which is not only key to the design and analysis of the IGP-UCB and GP-TS algorithms, but also potentially of independent interest. The inequality generalizes a corresponding self-normalized bound for martingales in finite dimension proven by Abbasi-Yadkori et al. (2011).\n• Empirical comparisons of the algorithms developed above, with other GP-based algorithms, are presented, over both synthetic and real-world setups, demonstrating performance improvements of the proposed algorithms, as well as their performance under misspecification."
    }, {
      "heading" : "2. Problem Statement",
      "text" : "We consider the problem of sequentially maximizing a fixed but unknown reward function f : D → R over a (potentially infinite) set of decisions D ⊂ Rd, also called actions or arms. An algorithm for this problem chooses, at each round t, an action xt ∈ D, and subsequently observes a reward yt = f(xt) + εt, which is a noisy version of the function value at xt. The action xt is chosen causally depending upon the arms played and rewards obtained upto round t − 1, denoted by the history Ht−1 = {(xs, ys) : s = 1, . . . , t − 1}. We\n1. Roughly, for rewards bounded in [−1, 1], these algorithms achieve optimal regret Õ ( d √ T )\n, where Õ (·) hides polylog(T ) factors. 2. The completion of the linear span of all feature vectors (images of the kernel map) is precisely the reproducing kernel Hilbert space\n(RKHS) that characterizes the GP. 3. Kernels, and their associated RKHSs,\nassume that the noise sequence {εt}∞t=1 is conditionally R-sub-Gaussian for a fixed constant R ≥ 0, i.e.,\n∀t ≥ 0, ∀λ ∈ R, E [ eλεt ∣∣ Ft−1] ≤ exp(λ2R2 2 ) , (1)\nwhere Ft−1 is the σ-algebra generated by the random variables {xs, εs}t−1s=1 and xt.This is a mild assumption on the noise (it holds, for instance, for distributions bounded in [−R,R]) and is standard in the bandit literature Abbasi-Yadkori et al. (2011); Agrawal and Goyal (2013).\nRegret. The goal of an algorithm is to maximize its cumulative reward or alternatively minimize its cumulative regret – the loss incurred due to not knowing f ’s maximum point beforehand. Let x? ∈ argmaxx∈D f(x) be a maximum point of f (assuming the maximum is attained). The instantaneous regret incurred at time t is rt = f(x\n?)−f(xt), and the cumulative regret in a time horizon T (not necessarily known a priori) is defined to be RT = ∑T t=1 rt. A sub-linear growth of RT in T signifies that RT /T → 0 as T → ∞, or vanishing per-round regret. Regularity Assumptions. Attaining sub-linear regret is impossible in general for arbitrary reward functions f and domains D, and thus some regularity assumptions are in order. In what follows, we assume that D is compact. The smoothness assumption we make on the reward function f is motivated by Gaussian processes4 and their associated reproducing kernel Hilbert spaces (RKHSs, see Schölkopf and Smola (2002)). Specifically, we assume that f has small norm in the RKHS of functions D → R, with positive semi-definite kernel function k : D × D → R. This RKHS, denoted by Hk(D), is completely specified by its kernel function k(·, ·) and vice-versa, with an inner product 〈·, ·〉k obeying the reproducing property: f(x) = 〈f, k(x, ·)〉k for all f ∈ Hk(D). In other words, the kernel plays the role of delta functions to represent the evaluation map at each point x ∈ D via the RKHS inner product. The RKHS norm ‖f‖k = √ 〈f, f〉 k is a measure of the smoothness5 of f , with respect to the kernel function k, and satisfies: f ∈ Hk(D) if and only if ‖f‖k <∞.\nWe assume a known bound on the RKHS norm of the unknown target function6: ‖f‖k ≤ B. Moreover, we assume bounded variance by restricting k(x, x) ≤ 1, for all x ∈ D. Two common kernels that satisfy bounded variance property are Squared Exponential and Matérn, defined as\nkSE(x, x ′) = exp ( − s2/2l2 ) ,\nkMatérn(x, x ′) =\n21−ν\nΓ(ν) (s√2ν l )ν Bν (s√2ν l ) ,\nwhere l > 0 and ν > 0 are hyperparameters, s = ‖x− x′‖2 encodes the similarity between two points x, x′ ∈ D, and Bν(·) is the modified Bessel function. Generally the bounded variance property holds for any stationary kernel, i.e. kernels for which k(x, x′) = k(x − x′) for all x, x′ ∈ Rd. These assumptions are required to make the regret bounds scale-free and are standard in the literature Agrawal and Goyal (2013). Instead if k(x, x) ≤ c or ‖f‖k ≤ cB, then our regret bounds would increase by a factor of c."
    }, {
      "heading" : "3. Algorithms",
      "text" : "Design philosophy. Both the algorithms we propose use Gaussian likelihood models for observations, and Gaussian process (GP) priors for uncertainty over reward functions. A Gaussian process over D, denoted by GPD(µ(·), k(·, ·)), is a collection of random variables (f(x))x∈D, one for each x ∈ D, such that every finite sub-collection of random variables (f(xi))mi=1 is jointly Gaussian with mean E [f(xi)] = µ(xi) and covariance E [(f(xi)− µ(xi))(f(xj)− µ(xj))] = k(xi, xj), 1 ≤ i, j ≤ m, m ∈ N. The algorithms use\n4. Other work has also studied continuum-armed bandits with weaker smoothness assumptions such as Lipschitz continuity – see Related work for details and comparison. 5. One way to see this is that for every element g in the RKHS, |g(x)−g(y)| = |〈g, k(x, ·)−k(y, ·)〉| 6 ‖g‖k ‖k(x, ·)− k(y, ·)‖k by Cauchy-Schwarz. 6. This is analogous to the bound on the weight θ typically assumed in regret analyses of linear parametric bandits.\nGPD(0, v 2k(·, ·)), v > 0, as an initial prior distribution for the unknown reward function f over D, where k(·, ·) is the kernel function associated with the RKHS Hk(D) in which f is assumed to have ‘small’ norm at mostB. The algorithms also assume that the noise variables εt = yt−f(xt) are drawn independently, across t, from N (0, λv2), with λ ≥ 0. Thus, the prior distribution for each f(x), is assumed to be N(0, v2k(x, x)), x ∈ D. Moreover, given a set of sampling points At = (x1, . . . , xt) within D, it follows under the assumption that the corresponding vector of observed rewards y1:t = [y1, . . . , yt]T has the multivariate Gaussian distribution N (0, v2(Kt + λI)), where Kt = [k(x, x′)]x,x′∈At is the kernel matrix at time t. Then, by the properties of GPs, we have that y1:t and f(x) are jointly Gaussian given At:[\nf(x) y1:t\n] ∼ N ( 0, [ v2k(x, x) v2kt(x) T\nv2kt(x) v 2(Kt + λI)\n]) ,\nwhere kt(x) = [k(x1, x), . . . , k(xt, x)]T . Therefore conditioned on the historyHt, the posterior distribution over f is GPD(µt(·), v2kt(·, ·)), where\nµt(x) = kt(x) T (Kt + λI) −1y1:t, (2) kt(x, x\n′) = k(x, x′)− kt(x)T (Kt + λI)−1kt(x′), (3) σ2t (x) = kt(x, x). (4)\nThus for every x ∈ D, the posterior distribution of f(x), givenHt, is N (µt(x), v2σ2t (x)). Remark. Note that the GP prior and Gaussian likelihood model described above is only an aid to algorithm design, and has nothing to do with the actual reward distribution or noise model as in the problem statement (Section 2). The reward function f is a fixed, unknown, member of the RKHS Hk(D), and the true sequence of noise variables εt is allowed to be a conditionally R-sub-Gaussian martingale difference sequence (Equation 1). In general, thus, this represents a misspecified prior and noise model, also termed the agnostic setting by Srinivas et al. (2009).\nThe proposed algorithms, to follow, assume the knowledge of only the sub-Gaussianity parameter R, kernel function k and upper bound B on the RKHS norm of f . Note that v, λ are free parameters (possibly time-dependent) that can be set specific to the algorithm."
    }, {
      "heading" : "3.1 Improved GP-UCB (IGP-UCB) algorithm",
      "text" : "We introduce the IGP-UCB algorithm (Algorithm 1), that uses a combination of the current posterior mean µt−1(x) and standard deviation vσt−1(x) to (a) construct an upper confidence bound (UCB) envelope for the actual function f over D, and (b) choose an action to maximize it. Specifically it chooses, at each round t, the action\nxt = argmax x∈D µt−1(x) + βtσt−1(x), (5)\nwith the scale parameter v set to be 1. Such a rule trades off exploration (picking points with high uncertainty σt−1(x)) with exploitation (picking points with high reward µt−1(x)), with βt = B+R √ 2(γt−1 + 1 + ln(1/δ)) being the parameter governing the tradeoff, which we later show is related to the width of the confidence interval for f at round t. δ ∈ (0, 1) is a free confidence parameter used by the algorithm, and γt is the maximum information gain at time t, defined as:\nγt := max A⊂D:|A|=t I(yA; fA).\nHere, I(yA; fA) denotes the mutual information between fA = [f(x)]x∈A and yA = fA + εA, where εA ∼ N (0, λv2I) and quantifies the reduction in uncertainty about f after observing yA at points A ⊂ D. γt is a problem dependent quantity and can be found given the knowledge of domain D and kernel function k. For a compact subset D of Rd, γT is O((lnT )d+1) and O(T d(d+1)/(2ν+d(d+1)) lnT ), respectively, for the Squared Exponential and Matérn kernels (Srinivas et al. (2009)), depending only polylogarithmically on the time T .\nAlgorithm 1 Improved-GP-UCB (IGP-UCB) Input: Prior GP (0, k), parameters B, R, λ, δ. for t = 1, 2, 3 . . . T do\nSet βt = B +R √\n2(γt−1 + 1 + ln(1/δ)). Choose xt = argmax\nx∈D µt−1(x) + βtσt−1(x).\nObserve reward yt = f(xt) + εt. Perform update to get µt and σt using 2, 3 and 4.\nend for\nDiscussion. Srinivas et al. (2009) have proposed the GP-UCB algorithm, and Valko et al. (2013) the KernelUCB algorithm, for sequentially optimizing reward functions lying in the RKHS Hk(D). Both algorithms play an arm at time t using the rule: xt = argmaxx∈D µt−1(x) + β̃tσt−1(x). GP-UCB uses the\nexploration parameter β̃t = √ 2B2 + 300γt−1 ln 3(t/δ), with λ set to σ2, where σ is additionally assumed to be a known, uniform (i.e., almost-sure) upper bound on all noise variables εt (see Theorem 3 in Srinivas et al. (2009)). Compared to GP-UCB, IGP-UCB (Algorithm 1) reduces the width of the confidence interval by a factor roughly O(ln3/2 t) at every round t, and, as we will see, this small but critical adjustment leads to much better theoretical and empirical performance compared to GP-UCB. In KernelUCB, β̃t is set as η/λ1/2, where η is the exploration parameter and λ is the regularization constant. Thus IGP-UCB can be viewed as a special case of KernelUCB where η = βt."
    }, {
      "heading" : "3.2 Gaussian Process Thompson sampling (GP-TS)",
      "text" : "Our second algorithm, GP-TS (Algorithm 2), inspired by the success of Thompson sampling for standard and parametric bandits (Agrawal and Goyal, 2012; Kaufmann et al., 2012; Gopalan et al., 2014; Agrawal and Goyal, 2013), uses the time-varying scale parameter vt = B +R √ 2(γt−1 + 1 + ln(2/δ)) and operates as follows. At each round t, GP-TS samples a random function ft(·) from the GP with mean function µt−1(·) and covariance function v2t kt−1(·, ·). Next, it chooses a decision set Dt ⊂ D, and plays the arm xt ∈ Dt that maximizes ft7. We call it GP-Thompson-Sampling as it falls under the general framework of Thompson Sampling, i.e., (a) assume a prior on the underlying parameters of the reward distribution, (b) play the arm according to the prior probability that it is optimal, and (c) observe the outcome and update the prior. However, note that the prior is nonparametric in this case.\nAlgorithm 2 GP-Thompson-Sampling (GP-TS) Input: Prior GP (0, k), parameters B, R, λ, δ. for t = 1, 2, 3 . . . , do\nSet vt = B +R √\n2(γt−1 + 1 + ln(2/δ)). Sample ft(·) from GPD(µt−1(·), v2t kt−1(·, ·)). Choose the current decision set Dt ⊂ D. Choose xt = argmax\nx∈Dt ft(x).\nObserve reward yt = f(xt) + εt. Perform update to get µt and kt using 2 and 3.\nend for\n7. If Dt = D for all t, then this is simply exact Thompson sampling. For technical reasons, however, our regret bound is valid when Dt is chosen as a suitable discretization of D, so we include Dt as an algorithmic parameter."
    }, {
      "heading" : "4. Main Results",
      "text" : "We begin by presenting two key concentration inequalities which are essential in bounding the regret of the proposed algorithms.\nTheorem 1 Let {xt}∞t=1 be an Rd-valued discrete time stochastic process predictable with respect to the filtration {Ft}∞t=0, i.e., xt is Ft−1-measurable ∀t ≥ 1. Let {εt}∞t=1 be a real-valued stochastic process such that for some R ≥ 0 and for all t ≥ 1, εt is (a) Ft-measurable, and (b) R-sub-Gaussian conditionally on Ft−1. Let k : Rd × Rd → R be a symmetric, positive-semidefinite kernel, and let 0 < δ ≤ 1. For a given η > 0, with probability at least 1− δ, the following holds simultaneously over all t ≥ 0:\n‖ε1:t‖2((Kt+ηI)−1+I)−1 ≤ 2R 2 ln\n√ det((1 + η)I +Kt)\nδ . (6)\n(Here, Kt denotes the t × t matrix Kt(i, j) = k(xi, xj), 1 ≤ i, j ≤ t.) Moreover, if Kt is positive definite ∀t ≥ 1 with probability 1, then the conclusion above holds with η = 0.\nTheorem 1 represents a self-normalized concentration inequality: the ‘size’ of the increasing-length sequence {εt}t of martingale differences is normalized by the growing quantity ((Kt + ηI)−1 + I)−1 that explicitly depends on the sequence. The following lemma helps provide an alternative, abstract, view of the self-normalized process of Theorem 1, based on the feature space representation induced by a kernel.\nLemma 1 Let k : Rd × Rd → R be a symmetric, positive-semidefinite kernel, with associated feature map ϕ : Rd → H and the reproducing kernel Hilbert space8 (RKHS) H . Letting St = ∑t s=1 εsϕ(xs) and the\n(possibly infinite dimensional) matrix9 Vt = I + ∑t s=1 ϕ(xs)ϕ(xs)\nT , we have, whenever Kt is positive definite, that\n‖ε1:t‖(K−1t +I)−1 = ‖St‖V −1t , where ‖St‖V −1t := ∥∥∥V −1/2t St∥∥∥ H denotes the norm of V −1/2t St in the RKHS H .\nObserve that St is Ft-measurable and also E [ St ∣∣ Ft−1] = St−1. The process {St}t≥0 is thus a martingale with values10 in the RKHS H , which can possibly be infinite-dimensional, and moreover, whose deviation is measured by the norm weighted by V −1t , which is itself derived from St. Theorem 1 represents the kernelized generalization of the finite-dimensional result of Abbasi-Yadkori et al. (2011), and we recover their result under the special case of a linear kernel: ϕ(x) = x for all x ∈ Rd.\nWe remark that when ϕ is a mapping to a finite-dimensional Hilbert space, the argument of AbbasiYadkori et al. (2011, Theorem 1) can be lifted to establish Theorem 1, but it breaks down in the generalized, infinite-dimensional RKHS setting, as the self-normalized bound in their paper has an explicit, growing dependence on the feature dimension. Specifically, the method of mixtures (de la Pena et al., 2009) or Laplace method, as dubbed by Maillard (2016) (Lemma 5.2), fails to hold in infinite dimension. The primary reason for this is that the mixture distribution for finite dimensional spaces can be chosen independently of time, but in a nonparametric setup like ours, where the dimensionality of the self-normalizing factor ( K−1t + I\n)−1 itself grows with time, the use of (random) stopping times, precludes using time-dependent mixtures. We get around this difficulty by applying a novel ‘double mixture’ construction, in which a pair of mixtures on (a) the space of real-valued functions on Rd, i.e., the support of a Gaussian process, and (b) on real sequences is simultaneously used to obtain a more general result, of potentially independent interest (see Section 5 and the appendix for details).\nOur next result shows that how the posterior mean is concentrated around the unknown reward function f .\n8. Such a pair (ϕ,H) always exists, see e.g., Rasmussen and Williams (2006). 9. More formally, Vt : H → H is the linear operator defined by Vt(z) = z + ∑t s=1 ϕ(xs)〈ϕ(xs), z〉 ∀z ∈ H .\n10. We ignore issues of measurability here.\nTheorem 2 Under the same hypotheses as those of Theorem 1, let D ∈ Rd, and f : D → R be a member of the RKHS of real-valued functions on D with kernel k, with RKHS norm bounded by B. Then, with probability at least 1− δ, the following holds for all x ∈ D and t ≥ 1:\n|µt−1(x)− f(x)| ≤ ( B +R √ 2(γt−1 + 1 + ln(1/δ)) ) σt−1(x),\nwhere γt−1 is the maximum information gain after t−1 rounds and µt−1(x), σ2t−1(x) are mean and variance of posterior distribution defined as in Equation 2, 3, 4, with λ set to 1 + η and η = 2/T .\nTheorem 3.5 of Maillard (2016) states a similar result on the estimation of the unknown reward function from the RKHS. We improve upon it in the sense that the confidence bound in Theorem 2 is simultaneous over all x ∈ D, while the bound has been shown only for a single, fixed x in the Kernel Least-squares setting. We are able to achieve this result by virtue of Theorem 1."
    }, {
      "heading" : "4.1 Regret Bound of IGP-UCB",
      "text" : "Theorem 3 Let δ ∈ (0, 1), ‖f‖k ≤ B and εt is conditionally R-sub-Gaussian. Running IGP-UCB for a function f lying in the RKHS Hk(D), we obtain a regret bound of O (√ T (B √ γT + γT ) ) with high\nprobability. More precisely, with probability at least 1− δ, RT = O ( B √ TγT + √ TγT (γT + ln(1/δ)) ) .\nImprovement over GP-UCB. Srinivas et al. (2009), in the course of analyzing the GP-UCB algorithm, show that when the reward function lies in the RKHS Hk(D), GP-UCB obtains regret O (√ T (B √ γT +\nγT ln 3/2(T )) ) with high probability (see Theorem 3 therein for the exact bound). Furthermore, they assume\nthat the noise εt is uniformly bounded by σ, while our sub-Gaussianity assumption (see Equation 1) is slightly more general, and we are able to obtain a O(ln3/2 T ) multiplicative factor improvement in the final regret bound thanks to the new self-normalized inequality (Theorem 1). Additionally, in our numerical experiments, we observe a significantly improved performance of IGP-UCB over GP-UCB, both on synthetically generated function, and on real-world sensor measurement data (see Section 6).\nComparison with KernelUCB. Valko et al. (2013) show that the cumulative regret of KernelUCB is Õ( √ d̃T ), where d̃, defined as the effective dimension, measures, in a sense, the number of principal directions over which the projection of the data in the RKHS is spread. They show that d̃ is at least as good as γT , precisely γT ≥ Ω(d̃ ln lnT ) and thus the regret bound of KernelUCB is roughly Õ( √ TγT ), which is √ γT factor better than IGP-UCB. However, KernelUCB requires the number of actions to be finite, so the regret bound is not applicable for infinite or continuum action spaces."
    }, {
      "heading" : "4.2 Regret Bound of GP-TS",
      "text" : "For technical reasons, we will analyze the following version of GP-TS. At each round t, the decision set used by GP-TS is restricted to be a unique discretization Dt of D with the property that |f(x)− f([x]t)| ≤ 1/t2 for all x ∈ D, where [x]t is the closest point to x in Dt. (This can always be achieved by choosing a compact and convex domain D ⊂ [0, r]d and discretization Dt with size |Dt| = (BLrdt2)d such that\n‖x− [x]t‖1 ≤ rd/BLrdt2 = 1/BLt2 for all x ∈ D, where L = sup x∈D sup j∈[d]\n( ∂2k(p,q) ∂pj∂qj |p=q=x )1/2 ). This\nimplies, for every x ∈ D,\n|f(x)− f([x]t)| ≤ ‖f‖k L ‖x− [x]t‖1 ≤ 1/t 2, (7)\nas any f ∈ Hk(D) is Lipschitz continuous with constant ‖f‖k L (De Freitas et al., 2012, Lemma 1).\nTheorem 4 (Regret bound for GP-TS) Let δ ∈ (0, 1), D ⊂ [0, r]d be compact and convex, ‖f‖k ≤ B and {εt}t a conditionally R-sub-Gaussian sequence. Running GP-TS for a function f lying in the RKHS Hk(D)\nand with decision sets Dt chosen as above, with probability at least 1 − δ, the regret of GP-TS satisfies RT = O (√ (γT + ln(2/δ))d ln(BdT ) (√ TγT +B √ T ln(2/δ) )) .\nComparison with IGP-UCB. Observe that regret scaling of GP-TS is Õ(γT √ dT ) which is a multiplica-\ntive √ d factor away from the bound Õ(γT √ T ) obtained for IGP-UCB and similar behavior is reflected in our simulations on synthetic data. The additional multiplicative factor of √\nln(BdT ) in the regret bound of GP-TS is essentially a consequence of discretization. How to remove this extra logarithmic dependency, and make the analysis discretization-independent, remains an open question.\nRemark. The regret bound for GP-TS is inferior compared to IGP-UCB in terms of the dependency on dimension d, but to the best of our knowledge, Theorem 4 is the first (frequentist) regret guarantee of Thompson Sampling in the agnostic, non-parametric setting of infinite action spaces.\nLinear Models and a Matching Lower Bound. If the mean rewards are perfectly linear, i.e. if there exists a θ ∈ Rd such that f(x) = θTx for all x ∈ D, then we are in the parametric setup, and one way of casting this in the kernelized framework is by using the linear kernel k(x, x′) = xTx′. For this kernel, γT = O(d lnT ), and the regret scaling of IGP-UCB is Õ(d √ T ) and that of GP-TS is Õ(d3/2 √ T ), which recovers the regret bounds of their linear, parametric analogues OFUL (Abbasi-Yadkori et al., 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively. Moreover, in this case d̃ = d, thus the regret of IGP-UCB is √ d factor away from that of KernelUCB. But the regret bound of KernelUCB also depends on the number of arms N , and if N is exponential in d, then it also suffers Õ(d √ T ) regret. We remark that a similar O(ln3/2 T ) factor improvement, as obtained by IGP-UCB over GP-UCB, was achieved in the linear parametric setting by Abbasi-Yadkori et al. (2011) in the OFUL algorithm, over its predecessor ConfidenceBall Dani et al. (2008). Finally we see that the for linear bandit problem with infinitely many actions, IGP-UCB attains the information theoretic lower bound of Ω(d √ T ) (see Dani et al. (2008)), but GP-TS is a factor of √ d away from it."
    }, {
      "heading" : "5. Overview of techniques",
      "text" : "We briefly outline here the key arguments for all the theorems in Section 4. Formal proofs and auxiliary lemmas required are given in the supplementary material.\nProof Sketch for Theorem 1. It is convenient to assume that Kt, the induced kernel matrix at time t, is invertible, since this is where the crux of the argument lies. First we show that for any function g : D → R and for all t ≥ 0, thanks to the sub-Gaussian property (1), the process { Mgt := exp(ε T 1:tg1:t − 12 ‖g1:t‖ 2 ) } t is a non-negative super-martingale with respect to the filtration Ft, where g1:t := [g(x1), . . . , g(xt)]T and in fact satisfies E [Mgt ] ≤ 1. The chief difficulty is to handle the behavior of Mt at a (random) stopping time, since the sizes of quantities such as ε1:t at the stopping time will be random.\nWe next construct a mixture martingale Mt by mixing M g t over g drawn from an independent GPD(0, k) Gaussian process, which is a measure over a large space of functions, i.e., the space RD. Then, by a change of measure argument, we show that this induces a mixture distribution which is essentially N (0,Kt) over any desired finite dimension t, thus obtaining Mt = 1√\ndet(I+Kt) exp\n( 1 2 ‖ε1:t‖ 2 (I+K−1t ) −1 ) . Next from the\nfact that E [Mτ ] ≤ 1 and from Markov’s inequality, for any δ ∈ (0, 1), we obtain\nP [ ‖ε1:τ‖2(K−1τ +I)−1 > 2 ln (√ det(I +Kτ )/δ )] ≤ δ.\nFinally, we lift this bound simultaneously for all t through a standard stopping time construction as in AbbasiYadkori et al. (2011).\nProof Sketch for Theorem 2. Here we sketch the special case of η = 0, i.e. λ = 1. Observe that |µt(x)− f(x)| is upper bounded by sum of two terms, P := ∣∣kt(x)T (Kt + I)−1ε1:t∣∣ and Q :=∣∣kt(x)T (Kt + I)−1f1:t − f(x)∣∣. Now we observe that σ2t (x) = ϕ(x)T (ΦTt Φt + I)−1ϕ(x) and use this observation to show that P = ∣∣ϕ(x)T (ΦTt Φt + I)−1ΦTt ε1:t∣∣ and Q = ∣∣ϕ(x)T (ΦTt Φt + I)−1f ∣∣, which are\nin turn upper bounded by the terms σt(x) ‖St‖V −1t and ‖f‖k σt(x) respectively. Then the result follows using Theorem 1, along with the assumption that ‖f‖k ≤ B and the fact that 1 2 ln(det(I+Kt)) ≤ γt almost surely (see Lemma 3) when Kt is invertible. Proof Sketch for Theorem 3. First from Theorem 2 and the choice of xt in Algorithm 1, we show that the instantaneous regret rt at round t is upper bounded by 2βtσt−1(xt) with probability at least 1− δ. Then the result follows by essentially upper bounding the term ∑T t=1 σt−1(xt) by O( √ TγT ) (Lemma 4 in the appendix). Proof Sketch for Theorem 4. We follow a similar approach given in Agrawal and Goyal (2013) to prove the regret bound of GP-TS. First observe that from our choice of discretization sets Dt, the instantaneous regret at round t is given by rt = f(x?) − f([x?]t) + f([x?]t) − f(xt) ≤ 1t2 + ∆t(xt), where ∆t(x) := f([x?]t)− f(x) and [x?]t is the closest point to x? in Dt. Now at each round t, after an action is chosen, our algorithm improves the confidence about true reward function f , via an update of µt(·) and kt(·, ·). However, if we play a suboptimal arm, the regret suffered can be much higher than the improvement of our knowledge. To overcome this difficulty, at any round t, we divide the arms (in the present discretization Dt) into two groups: saturated arms, St, defined as those with ∆t(x) > ctσt−1(x) and unsaturated otherwise, where ct is an appropriate constant (see Definition 1, 3). The idea is to show that the probability of playing a saturated arm is small and then bound the regret of playing an unsaturated arm in terms of standard deviation. This is useful because the inequality ∑T t=1 σt−1(xt) ≤ O( √ TγT ) (Lemma 4) allows us to bound the total regret due to unsaturated arms. First we lower bound the probability of playing an unsaturated arm at round t. We define a filtration F ′t−1 as the history Ht−1 up to round t − 1 and prove that for “most” (in a high probability sense) F ′t−1, P [ xt ∈ Dt \\ St\n∣∣ F ′t−1] ≥ p − 1/t2, where p = 1/4e√π ( Lemma 9). This observation, along with concentration bounds for ft(x) and f(x) (Lemma 6) and “smoothness” of f (Equation 7), allow us to show that the expected regret at round t is upper bounded in terms of σt−1(xt), i.e. in terms of regret due to playing an unsaturated arm. More precisely, we show that for “most” F ′t−1, E [ rt ∣∣ F ′t−1] ≤\n11ct p E [ σt−1(xt) ∣∣ F ′t−1]+ 2B+1t2 (Lemma 10), and use it to prove thatXt ' rt− 11ctp σt−1(xt)− 2B+1t2 ; t ≥ 1 is a super-martingale difference sequence adapted to filtration {F ′t}t≥1 (Lemma 12). Now, using the AzumaHoeffding inequality (Lemma 13), along with the bound on ∑T t=1 σt−1(xt), we obtain the desired highprobability regret bound."
    }, {
      "heading" : "6. Experiments",
      "text" : "In this section we provide numerical results on both synthetically generated test functions and functions from real-world data. We compare GP-UCB, IGP-UCB and GP-TS with GP-EI and GP-PI11.\nSynthetic Test Functions. We use the following procedure to generate test functions from the RKHS. First we sample 100 points uniformly from the interval [0, 1] and use that as our decision set. Then we compute a kernel matrix K on those points and draw reward vector y ∼ N(0,K). Finally, the mean of the resulting posterior distribution is used as the test function f . We set noise parameter R2 to be 1% of function range and use λ = R2. We used Squared Exponential kernel with lengthscale parameter l = 0.2 and Matérn kernel with parameters ν = 2.5, l = 0.2. Parameters βt, β̃t, vt of IGP-UCB, GP-UCB and GP-TS are chosen as given in Section 3, with δ = 0.1, B2 = fTKf and γt set according to theoretical upper bounds for corresponding kernels. We run each algorithm for T = 30000 iterations, over 25 independent trials (samples from the RKHS) and plot the average cumulative regret along with standard deviations (Figure 1). We see a significant improvement in the performance of IGP-UCB over GP-UCB. In fact IGP-UCB performs the best in the pool of competitors, while GP-TS also fares reasonably well compared to GP-UCB and GP-EI/GP-PI.\nWe next sample 25 random functions from the GP (0,K) and perform the same experiment (Figure 2) for both kernels with exactly same set of parameters. The relative performance of all methods is similar to\n11. GP-EI and PI perform similarly and thus are not separately distinguishable in the plots.\nthat in the previous experiment, which is the arguably harder “agnostic” setting of a fixed, unknown target function.\nStandard Test Functions. We consider 2 well-known synthetic benchmark functions for Bayesian Optimization: Rosenbrock and Hartman3 (see Azimi et al. (2012) for exact analytical expressions). We sample 100 d points uniformly from the domain of each benchmark function, d being the dimension of respective domain, as the decision set. We consider the Squared Exponential kernel with l = 0.2 and set all parameters exactly as in previous experiment. The cumulative regret for 25 independent trials on Rosenbrock and Hartman3 benchmarks is shown in Figure 3. We see GP-EI/PI perform better than the rest, while IGP-UCB and GP-TS show competitive performance. Here no algorithm is aware of the underlying kernel function, hence\nwe conjecture that the UCB- and TS- based algorithms are somewhat less robust on the choice of kernel than EI/PI.\nTemperature Sensor Data. We use temperature data12 collected from 54 sensors deployed in the Intel Berkeley Research lab between February 28th and April 5th, 2004 with samples collected at 30 second intervals. We tested all algorithms in the context of learning the maximum reading of the sensors collected between 8 am to 9 am. We take measurements of first 5 consecutive days (starting Feb. 28th 2004) to learn algorithm parameters. Following Srinivas et al. (2009), we calculate the empirical covariance matrix of the sensor measurements and use it as the kernel matrix in the algorithms. Here R2 is set to be 5% of the average empirical variance of sensor readings and other algorithm parameters is set similarly as in the previous experiment with γt = 1 (found via cross-validation). The functions for testing consist of one set of measurements from all sensors in the two following days and the cumulative regret is plotted over all such test functions. From Figure 4, we see that IGP-UCB and GP-UCB performs the same, while GP-TS outperforms all its competitors.\nLight Sensor Data. We take light sensor data collected in the CMU Intelligent Workplace in Nov 2005, which is available online as Matlab structure13 and contains locations of 41 sensors, 601 train samples and 192 test samples. We compute the kernel matrix, estimate the noise and set other algorithm parameters exactly as in the previous experiment. Here also GP-TS is found to perform better than the others, with IGP-UCB performing better than GP-EI/PI (Figure 4).\nRelated work. An alternative line of work pertaining toX -armed bandits Kleinberg et al. (2008); Bubeck et al. (2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in Rd. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al. (2013) and noise-free De Freitas et al. (2012) settings. Other relevant work focuses on best arm identification problem in the Bayesian setup considering pure exploration Grünewälder et al. (2010). For Thompson sampling (TS), Russo and Van Roy (2014) analyze the Bayesian\n12. http://db.csail.mit.edu/labdata/labdata.html 13. http://www.cs.cmu.edu/˜guestrin/Class/10708-F08/projects/lightsensor.zip\nregret of TS, which includes the case where the target function is sampled from a GP prior. Our work obtains the first frequentist regret of TS for unknown, fixed functions from an RKHS."
    }, {
      "heading" : "7. Conclusion",
      "text" : "For bandit optimization, we have improved upon the existing GP-UCB algorithm, and introduced a new GPTS algorithm. The proposed algorithms perform well in practice both on synthetic and real-world data. An interesting case is when the kernel function is also not known to the algorithms a priori and needs to be learnt adaptively. Moreover, one can consider classes of time varying functions from the RKHS, and general reinforcement learning with GP techniques. There are also important questions on computational aspects of optimizing functions drawn from GPs."
    }, {
      "heading" : "A. Proof of Theorem 1",
      "text" : "For a function g : D → R and a sequence of reals n ≡ (nt)∞t=1, define for any t ≥ 0\nMg,nt = exp ( εT1:tg1:t,n − R2\n2 ‖g1:t,n‖2\n) ,\nwhere the vector g1:t,n := [g(x1) + n1, . . . , g(xt) + nt]T . We first establish the following technical result, which resembles Abbasi-Yadkori et al. (2011, Lemma 8).\nLemma 2 For fixed g and n, {Mg,nt }∞t=0 is a super-martingale with respect to the filtration {Ft}∞t=0.\nProof First, define\n∆g,nt := exp ( εt(g(xt) + nt)− R2\n2 (g(xt) + nt)\n2 ) .\nSince xt is Ft−1-measurable and εt is Ft-measurable, Mg,nt as well as ∆ g,n t are Ft measurable. Also, by the conditional R-sub-Gaussianity of εt, we have\n∀λ ∈ R, E [ eλεt ∣∣ Ft−1] ≤ exp(λ2R2 2 ) ,\nwhich in turn implies E [ ∆g,nt ∣∣ Ft−1] ≤ 1. We also have E [ Mg,nt\n∣∣ Ft−1] = E [ Mg,nt−1∆ g,n t ∣∣ Ft−1] = Mg,nt−1E [∆g,nt ∣∣ Ft−1] ≤Mg,nt−1,\nshowing that {Mg,nt }∞t=0 is a non-negative super-martingale and proving the lemma.\nNow, let τ be a stopping time with respect to the filtration {Ft}∞t=0. By the convergence theorem for nonnegative super-martingales (Durrett, 2005), Mg∞ = lim\nt→∞ Mgt exists almost surely, and thus M g τ is well-defined.\nNow let Qgt = M g min{τ,t}, t ≥ 0, be a stopped version of {M g t }t. By Fatou’s lemma (Durrett, 2005),\nE [Mgτ ] = E [\nlim t→∞\nQgt\n] = E [ lim inf t→∞ Qgt ] ≤ lim inf\nt→∞ E [Qgt ]\n= lim inf t→∞\nE [ Mgmin{τ,t} ] ≤ 1, (8)\nsince the stopped super-martingale ( Mgmin{τ,t} ) t is also a super-martingale (Durrett, 2005).\nNow, let F∞ be the σ-algebra generated by {Ft}∞t=0, and let N ≡ (Nt)∞t=1 be a sequence of independent and identically distributed Gaussian random variables with mean 0 and variance η, independent of F∞. Let h : D → R be a random function distributed according to the Gaussian process measure GPD(0, k), and independent of both F∞ and (Nt)∞t=1.\nFor each t ≥ 0, define Mt = E [ Mh,Nt ∣∣ F∞]. In words, (Mt)t is a mixture of super-martingales of the form Mg,nt , and it is not hard to see that (Mt)t is also a (non-negative) super-martingale w.r.t. the filtration {Ft}t, hence M∞ = lim\nt→∞ Mt is well-defined almost surely. We can write\nE [Mt] = E [ Mh,Nt ] = E [ E [ Mh,Nt ∣∣ h,N]] ≤ E [1] = 1 ∀t. An argument similar to (8) also shows that E [Mτ ] ≤ 1 for any stopping time τ . Now, without loss of generality, we assume R = 1 (this can always be achieved through appropriate scaling), and compute\nMt = E [ exp ( εT1:th1:t,N − 1\n2 ‖h1:t,N‖2 ) ∣∣ F∞] =\n∫ RD ∫ Rt exp ( εT1:t([h(x1) . . . h(xt)] T + z)− 1 2 ∥∥[h(x1) . . . h(xt)]T + z∥∥2 )dµ1(h)dµ2(z) =\n∫ Rt exp ( εT1:tλ− 1 2 ‖λ‖2 ) f(λ)dλ,\nwhere µ1 is the Gaussian process measure GPD(0, k) over the function space RD ≡ {g : D → R}, µ2 is the multivariate Gaussian distribution on Rt with mean 0 and covariance ηI where I is the identify, du is standard Lebesgue measure on Rt, and f is the density of the random vector [h(x1) . . . h(xt)]T + z, which is distributed as the multivariate Gaussian N (0,Kt + ηI) given the sampled points x1, . . . , xt up to round t, where Kt is the induced kernel matrix at time t given by Kt(i, j) = k(xi, xj), 1 ≤ i, j ≤ t. (Note: Kt is not positive definite and invertible when there are repetitions among (x1, . . . , xt), but Kt + ηI is.)\nThus, we have\nMt = 1√\n(2π)t det(Kt + ηI) ∫ Rt exp ( εT1:tλ− ‖λ‖2 2 − ‖λ‖2(Kt+ηI)−1 2 ) dλ\n= exp\n( ‖ε1:t‖2\n2 ) √\n(2π)t det(Kt + ηI) ∫ Rt exp ( − ‖λ− ε1:t‖ 2 2 − ‖λ‖2(Kt+ηI)−1 2 ) dλ.\nNow for positive-definite matrices P and Q\n‖x− a‖2P + ‖x‖ 2 Q = ∥∥x− (P +Q)−1Pa∥∥2 P+Q + ‖a‖2P − ‖Pa‖ 2 (P+Q)−1 .\nTherefore,\n‖λ− ε1:t‖2I + ‖λ‖ 2 (Kt+ηI)−1 = ∥∥λ− (I + (Kt + ηI)−1)−1Iε1:t∥∥2I+(Kt+ηI)−1 + ‖ε1:t‖2I − ‖Iε1:t‖2(I+(Kt+ηI)−1)−1 ,\nwhich yields\nMt = 1√\n(2π)t det(Kt + ηI) exp (1 2 ‖ε1:t‖2(I+(Kt+ηI)−1)−1 ) × ∫ Rt exp ( − 1 2\n∥∥λ− (I + (Kt + ηI)−1)−1ε1:t∥∥2I+(Kt+ηI)−1 )dλ =\n1√ det(Kt + ηI) det((Kt + ηI)−1 + I)\nexp (1\n2 ‖ε1:t‖2(I+(Kt+ηI)−1)−1 ) =\n1√ det(I +Kt + ηI)\nexp (1\n2 ‖ε1:t‖2(I+(Kt+ηI)−1)−1\n) ,\nsince for any positive definite matrix A ∈ Rt,∫ Rt exp ( − 1 2 (x− a)TA(x− a) ) dx = ∫ Rt exp ( − 1 2 ‖x− a‖2A ) dx = √ (2π)t/ det(A).\nNow as E [Mτ ] ≤ 1, using Markov’s inequality gives, for any δ ∈ (0, 1), P [ ‖ε1:τ‖2((Kτ+ηI)−1+I)−1 > 2 ln (√ det((1 + η)I +Kτ )/δ )] = P [Mτ > 1/δ] < δE [Mτ ] ≤ δ. (9)\nTo complete the proof, we now employ a stopping time construction as in Abbasi-Yadkori et al. (2011). For each t ≥ 0, define the ‘bad’ event\nBt(δ) = { ω ∈ Ω : ‖ε1:t‖2((Kt+ηI)−1+I)−1 > 2 ln (√ det((1 + η)I +Kt)/δ )} ,\nso that\nP ⋃ t≥0 Bt(δ)  = P [ ∃t ≥ 0 : ‖ε1:t‖2((Kt+ηI)−1+I)−1 ≤ 2 ln (√ det((1 + η)I +Kt)/δ )] ,\nwhich is the probability required to be bounded by δ in the statement of the theorem. Let τ ′ be the first time when the bad event Bt(δ) happens, i.e., τ ′(ω) := min{t ≥ 0 : ω ∈ Bt(δ)}, with min{∅} :=∞ by convention. Clearly, τ ′ is a stopping time, and⋃ t≥0 Bt(δ) = {ω ∈ Ω : τ ′(ω) <∞}.\nTherefore, we can write\nP ⋃ t≥0 Bt(δ)  = P [τ ′ <∞]\n= P [ ‖ε1:τ ′‖2((Kτ′+ηI)−1+I)−1 > 2 ln (√ det((1 + η)I +Kτ ′)/δ ) , τ ′ <∞ ] ≤ P [ ‖ε1:τ ′‖2((Kτ′+ηI)−1+I)−1 > 2 ln (√ det((1 + η)I +Kτ ′)/δ )] ≤ δ,\nby the inequality (9). When Kt is positive definite (and hence invertible) for each t ≥ 1, one can use a similar construction as in Part 1, with η = 0 (i.e., N is the all-zeros sequence with probability 1), to recover the corresponding conclusion (6) with η = 0.\nProof of Lemma 1 Define, for each time t, the t ×∞ matrix Φt := [ϕ(x1) · · ·ϕ(xt)]T , and observe that Vt = I + ΦTt Φt and Kt = ΦtΦ T t . With this, we can compute\n‖St‖V −1t = S T t V −1 t St = t∑ s=1 εsϕ(xs) T ( I + ΦTt Φt )−1 t∑ s=1 εsϕ(xs)\n= εT1:tΦt ( I + ΦTt Φt )−1 ΦTt ε1:t\n= εT1:tΦtΦ T t ( ΦtΦ T t + I )−1 ε1:t = εT1:tKt (Kt + I) −1 ε1:t\n= εT1:t ( K−1t + I )−1 ε1:t = ‖ε1:t‖(K−1t +I)−1 ,\ncompleting the proof.\nB. Information Theoretic Results Lemma 3 For every t ≥ 0, the maximum information gain γt, for the points chosen by Algorithm 1 and 2 satisfy, almost surely, the following :\nγt ≥ 1\n2 ln(det(I + λ−1Kt)),\nγt ≥ 1\n2 t∑ s=1 ln(1 + λ−1σ2s−1(xs)).\nProof At round t after observing the reward vector y1:t at points At = {x1, . . . , xt} ⊂ D, the information gain - by the algorithm - about the unknown reward function f is given by the mutual information between f1:t and y1:t sampled at points At:\nI(y1:t; f1:t) = H(y1:t)−H(y1:t ∣∣ f1:t),\nwhere y1:t = f1:t + ε1:t = [y1, . . . , yt]T , f1:t = [f(x1), . . . , f(xt)]T and ε1:t = [ε1, . . . , εt]T . Clearly, given f1:t the randomness - as perceived by the algorithm - in y1:t are only in the noise vector ε1:t and thus\nH(y1:t ∣∣ f1:t) = 1\n2 ln(det(2πeλv2I)) =\nt 2 log(2πeλv2),\nas ε1:t is assumed to follow the distributionN (0, λv2I) andH(N (µ,Σ)) = 12 ln(det(2πeΣ)). Now y1:t sampled at pointsAt is believed to be distributed asN (0, v2(Kt+λI)), which givesH(y1:t) = 12 ln(det(2πev\n2(λI+ Kt))) = t 2 log(2πeλv 2) + 12 ln(det(I + λ −1Kt)), and therefore\nI(y1:t; f1:t) = 1\n2 ln(det(I + λ−1Kt)). (10)\nAgain, conditioned on reward vector y1:s−1 observed at points As−1, the reward ys at round s observed at xs is believed to follow the distribution N (µs−1(xs), v2(λ + σ2s−1(xs))), which gives H(ys ∣∣ y1:s−1) = 1 2 ln(2πev 2(λ + σ2s−1(xs))) = 1 2 ln(2πeλv\n2) + 12 ln(1 + λ −1σ2s−1(xs)). Now by chain rule H(y1:t) =∑t s=1H(ys ∣∣ y1:s−1) = t2 ln(2πeλv2) + 12 ∑ts=1 ln(1 + λ−1σ2s−1(xs)), and therefore\nI(y1:t; f1:t) = 1\n2 t∑ s=1 ln(1 + λ−1σ2s−1(xs)). (11)\nNow I(y1:t; f1:t) is a function of At ⊂ D, the random points chosen by the algorithm and thus\nI(y1:t; f1:t) ≤ max A⊂D:|A|=t I(yA; fA) = γt, a.s.,\nNow the proof follows from Equation 10 and 11.\nLemma 4 Let x1, . . . xt be the points selected by the algorithms. The sum of predictive standard deviation at those points can be expressed in terms of the maximum information gain. More precisely,\nT∑ t=1 σt−1(xt) ≤ √ 4(T + 2)γT .\nProof First note that, by Cauchy-Schwartz inequality, ∑T t=1 σt−1(xt) ≤ √ T ∑t t=1 σ 2 t−1(xt). Now since 0 ≤ σ2t−1(x) ≤ 1 for all x ∈ D and by our choice of λ = 1 + η, η ≥ 0, we have λ−1σ2t−1(xt) ≤ 2 ln(1+λ−1σ2t−1(xt)), where in the last inequality we used the fact that for any 0 ≤ α ≤ 1, ln(1+α) ≥ α/2. Thus we get σ2t−1(xt) ≤ 2λ ln(1 + λ−1σ2t−1(xt)). This implies\nT∑ t=1 σt−1(xt) ≤ √√√√2T T∑ t=1 λ ln(1 + λ−1σ2t−1(xt)) ≤ √√√√4Tλ T∑ t=1 1 2 ln(1 + σ2t−1(xt)) ≤ √ 4T (1 + η)γT ,\nwhere the last inequality follows from Lemma 3. Now the result follows by choosing η = 2/T ."
    }, {
      "heading" : "C. Proof of Theorem 2",
      "text" : "First define ϕ(x) as k(x, ·), where ϕ : Rd → H maps any point x in the primal space Rd to the RKHS H associated with kernel function k. For any two functions g, h ∈ H , define the inner product 〈g, h〉k as gTh and the RKHS norm ‖g‖k as √ gT g. Now as the unknown reward function f lies in the RKHS Hk(D), these definitions along with reproducing property of the RKHS imply f(x) = 〈f, k(x, ·)〉k = 〈f, ϕ(x)〉k = fTϕ(x) and k(x, x′) = 〈k(x, ·), k(x′, ·)〉k = 〈ϕ(x), ϕ(x′)〉k = ϕ(x)Tϕ(x′) for all x, x′ ∈ D. Now defining Φt := [ ϕ(x1) T , . . . , ϕ(xt) T ]T\n, we get the kernel matrix Kt = ΦtΦTt , kt(x) = Φtϕ(x) for all x ∈ D and f1:t = Φtf . Since the matrices (ΦTt Φt + I) and (ΦtΦ T t + λI) are strictly positive definite and (Φ T t Φt + λI)ΦTt = Φ T t (ΦtΦ T t + λI), we have\nΦTt (ΦtΦ T t + λI) −1 = (ΦTt Φt + λI) −1ΦTt . (12)\nAlso from the definitions above (ΦTt Φt + λI)ϕ(x) = Φ T t kt(x) + λϕ(x), and thus from 12 we deduce that\nϕ(x) = ΦTt (ΦtΦ T t + λI) −1kt(x) + λ(Φ T t Φt + λI) −1ϕ(x),\nwhich gives\nϕ(x)Tϕ(x) = kt(x) T (ΦtΦ T t + λI) −1kt(x) + λϕ(x) T (ΦTt Φt + λI) −1ϕ(x).\nThis implies\nλϕ(x)T (ΦTt Φt + λI) −1ϕ(x) = k(x, x)− kt(x)T (Kt + λI)−1kt(x) = σ2t (x) (13)\nNow observe that∣∣f(x)− kt(x)T (Kt + λI)−1f1:t∣∣ = ∣∣ϕ(x)T f − ϕ(x)TΦTt (ΦtΦTt + λI)−1Φtf ∣∣ =\n∣∣ϕ(x)T f − ϕ(x)T (ΦTt Φt + λI)−1ΦTt Φtf ∣∣ =\n∣∣λϕ(x)T (ΦTt Φt + λI)−1f ∣∣ ≤\n∥∥λ(ΦTt Φt + λI)−1ϕ(x)∥∥k ‖f‖k = ‖f‖k √ λϕ(x)T (ΦTt Φt + λI) −1λI(ΦTt Φt + λI) −1ϕ(x)\n≤ B √ λϕ(x)T (ΦTt Φt + λI) −1(ΦTt Φt + λI)(Φ T t Φt + λI) −1ϕ(x)\n= B σt(x),\nwhere the second equality uses 12, the first inequality is by Cauchy-Schwartz and the final equality is from 13. Again see that∣∣kt(x)T (Kt + λI)−1ε1:t∣∣ = ∣∣ϕ(x)TΦTt (ΦtΦTt + λI)−1ε1:t∣∣\n= ∣∣ϕ(x)T (ΦTt Φt + λI)−1ΦTt ε1:t∣∣\n≤ ∥∥∥(ΦTt Φt + λI)−1/2ϕ(x)∥∥∥\nk ∥∥∥(ΦTt Φt + λI)−1/2ΦTt ε1:t∥∥∥ k\n= √ ϕ(x)T (ΦTt Φt + λI) −1ϕ(x) √ (ΦTt ε1:t) T (ΦTt Φt + λI) −1ΦTt ε1:t\n= λ−1/2σt(x) √ εT1:tΦtΦ T t (ΦtΦ T t + λI) −1ε1:t\n= λ−1/2σt(x) √ εT1:tKt(Kt + λI) −1ε1:t\nwhere the second equality is from 12, the first inequality is by Cauchy-Schwartz and the fourth inequality uses both 12 and 13. Now recall that, at round t, the posterior mean function µt(x) = kt(x)T (Kt + λI)−1y1:t = kt(x) T (Kt +λI) −1(f1:t + ε1:t), where f1:t = [ f(x1), . . . , f(xt) ]T and ε1:t = [ ε1, . . . , εt ]T . Thus we have\n|µt(x)− f(x)| ≤ ∣∣kt(x)T (Kt + λI)−1ε1:t∣∣+ ∣∣f(x)− kt(x)T (Kt + λI)−1f1:t∣∣\n≤ σt(x) ( B + (1 + η)−1/2 √ εT1:tKt(Kt + (1 + η)I) −1ε1:t ) ,\nwhere we have used λ = 1 + η, where η ≥ 0 as stated in Theorem 1. Now observe that when K is invertible, K(K + I)−1 = ((K + I)K−1)−1 = (I +K−1)−1. Using K = Kt + ηI , we get\n(Kt + ηI)(Kt + (1 + η)I) −1 = ((Kt + ηI) −1 + I)−1.\nNow see that\nεT1:tKt(Kt + (1 + η)I) −1ε1:t ≤ εT1:t(Kt + ηI)(Kt + (1 + η)I)−1ε1:t = εT1:t((Kt + ηI)−1 + I)−1ε1:t\nNow using Theorem 1, for any δ ∈ (0, 1), with probability at least 1− δ, ∀t ≥ 0,∀x ∈ D, we obtain\n|µt(x)− f(x)| ≤ σt(x) ( B + ‖ε1:t‖(Kt+ηI)−1+I)−1 ) ≤ σt(x) ( B +R √ 2 ln √ det((1 + η)I +Kt)\nδ\n) .\nNow observe that det((1 + η)I +Kt) = det(I + (1 + η)−1Kt) det((1 + η)I). Thus we have\nln(det((1 + η)I +Kt)) = ln(det(I + (1 + η) −1Kt)) + t ln(1 + η) ≤ 2γt + ηt,\nfrom lemma 3. Now choosing η = 2/T we have |µt(x)− f(x)| ≤ σt(x) ( B + R √ 2 ( γt + 1 + ln(1/δ) )) and hence the result follows."
    }, {
      "heading" : "D. Analysis of IGP-UCB (Theorem 3)",
      "text" : "Observe that at each round t ≥ 1, by the choice of xt in Algorithm 1, we have µt−1(xt) + βtσt−1(xt) ≥ µt−1(x ?) + βtσt−1(x ?) and from Lemma 2, we have f(x?) ≤ µt−1(x?) + βtσt−1(x?) and µt−1(xt) − f(xt) ≤ βtσt−1(xt). Therefore for all t ≥ 1 with probability at least 1− δ,\nrt = f(x ?)− f(xt)\n≤ βtσt−1(xt) + µt−1(xt)− f(xt) ≤ 2βtσt−1(xt),\nand hence T∑ t=1 rt ≤ 2βT T∑ t=1 σt−1(xt). Now from Lemma 4, T∑ t=1 σt−1(xt) = O( √ TγT ) and by definition\nβT ≤ B +R √ 2(γT + 1 + ln(1/δ)). Hence with probability at least 1− δ,\nRT = T∑ t=1 rt = O ( B √ TγT + √ TγT (γT + ln(1/δ)) ) ,\nand thus with high probability, RT = O (√ T (B √ γT + γT ) ) ."
    }, {
      "heading" : "E. Analysis of GP-TS (Theorem 4)",
      "text" : "Lemma 5 For any δ ∈ (0, 1) and any finite subset D′ of D,\nP [ ∀x ∈ D′, |ft(x)− µt−1(x)| ≤ vt √ 2 ln(|D′| t2) σt−1(x) ∣∣ Ht−1] ≥ 1− 1/t2, for all possible realizations of historyHt−1.\nProof Fix x ∈ D and t ≥ 1. Given historyHt−1, ft(x) ∼ N (µt−1(x), v2t σ2t−1(x)). Thus using Lemma B4 of Hoffman et al. (2013), for any δ ∈ (0, 1), with probability at least 1− δ\n|ft(x)− µt−1(x)| ≤ √ 2 ln(1/δ) vtσt−1(x),\nand now applying union bound, |ft(x)− µt−1(x)| ≤ vt √ 2 ln(|D′| /δ) σt−1(x) ∀x ∈ D′\nholds with probability at least 1− δ, given any possible realizations of history Ht−1. Now setting δ = 1/t2, the result follows.\nDefinition 1 Define For all t ≥ 1, c̃t = √\n4 ln t+ 2d ln(BLrdt2) and ct = vt(1 + c̃t), where vt = B + R √\n2(γt−1 + 1 + ln(2/δ)). Clearly, ct increases with t.\nDefinition 2 Define Ef (t) as the event that for all x ∈ D,\n|µt−1(x)− f(x)| ≤ vtσt−1(x),\nand Eft(t) as the event that for all x ∈ Dt,\n|ft(x)− µt−1(x)| ≤ vtc̃tσt−1(x).\nDefinition 3 Define the set of saturated points St in discretization Dt at round t as\nSt := {x ∈ Dt : ∆t(x) > ctσt−1(x)},\nwhere ∆t(x) := f([x?]t)− f(x), the difference between function values at the closest point to x? in Dt and at x. Clearly ∆t([x?]t) = 0 for all t, and hence [x?]t ∈ Dt is unsaturated at every t.\nDefinition 4 Define filtration F ′t−1 as the history until time t, i.e., F ′ t−1 = Ht−1. By definition, F ′ 1 ⊆ F ′2 ⊆ · · · . Observe that given F ′t−1, the set St and the event Ef (t) are completely deterministic.\nLemma 6 Given any δ ∈ (0, 1), P [ ∀t ≥ 1, Ef (t) ] ≥ 1−δ/2 and for all possible filtrationsF ′t−1, P [ Eft(t) ∣∣ F ′t−1] ≥ 1− 1/t2.\nProof The probability bound for the event Ef (t) follows from Theorem 2 by replacing δ with δ2 and for the event Eft(t) follows from Lemma 5 by setting D′ = Dt andHt−1 = F ′ t−1.\nLemma 7 (Gaussian Anti-concentration) For a Gaussian random variable X with mean µ and standard deviation σ, for any β > 0,\nP [ X − µ σ > β ] ≥ e −β2 4 √ πβ .\nLemma 8 For any filtration F ′t−1 such that Ef (t) is true,\nP [ ft(x) > f(x) ∣∣ F ′t−1] ≥ p, for any x ∈ D, where p = 1\n4e √ π .\nProof Fix any x ∈ D. Given filtration F ′t−1, ft(x) is a Gaussian random variable with mean µt−1(x) and standard deviation vtσt−1(x) and since event Ef (t) is true, |µt−1(x)− f(x)| ≤ c1,tσt−1(x). Now using the anti-concentration inequality in Lemma 7, we have\nP [ ft(x) > f(x) ∣∣ F ′t−1] = P [ft(x)− µt−1(x)vtσt−1(x) > f(x)− µt−1(x)vtσt−1(x) ∣∣ F ′t−1 ]\n≥ P [ ft(x)− µt−1(x)\nvtσt−1(x) > |f(x)− µt−1(x)| vtσt−1(x) ∣∣ F ′t−1] ≥ 1\n4 √ πβt\ne−θ 2 t ,\nwhere, from Definition 2, θt = |f(x)−µt−1(x)| vtσt−1(x)\n≤ 1. Therefore P [ ft(x) > f(x) ∣∣ F ′t−1] ≥ 14e√π , and hence the result follows.\nLemma 9 For any filtration F ′t−1 such that Ef (t) is true,\nP [ xt ∈ Dt \\ St ∣∣ F ′t−1] ≥ p− 1/t2. Proof At round t our algorithm chooses the point xt ∈ Dt, at which the highest value of ft, within current decision set Dt, is attained. Now if ft([x?]t) is greater than ft(x) for all saturated points at round t, i.e.,ft([x?]t) > ft(x),∀x ∈ St, then one of the unsaturated points (which includes [x?]t) in Dt must be played and hence xt ∈ Dt \\ St. This implies\nP [ xt ∈ Dt \\ St ∣∣ F ′t−1] ≥ P [ft([x?]t) > ft(x),∀x ∈ St ∣∣ F ′t−1] . (14) Now form Definition 3, ∆t(x) > ctσt−1(x), for all x ∈ St. Also if both the events Ef (t) and Eft(t) are true, then from Definition 1 and 2, ft(x) ≤ f(x) + ctσt−1(x), for all x ∈ Dt. Thus for all x ∈ St, ft(x) < f(x) + ∆t(x). Therefore, for any filtration F ′ t−1 such that E f (t) is true, either Eft(t) is false, or else for all x ∈ St, ft(x) < f([x?]t). Hence, for any F ′ t−1 such that E f (t) is true,\nP [ ft([x ?]t) > ft(x),∀x ∈ St ∣∣ F ′t−1] ≥ P [ft([x?]t) > f([x?]t) ∣∣ Ft−1]−P [Eft(t) ∣∣ F ′t−1] ≥ p−1/t2,\nwhere we have used Lemma 6 and Lemma 8. Now the proof follows from Equation 14.\nLemma 10 For any filtration F ′t−1 such that Ef (t) is true,\nE [ rt ∣∣ F ′t−1] ≤ 11ctp E [σt−1(xt) ∣∣ F ′t−1]+ 2B + 1t2 ,\nwhere rt is the instantaneous regret at round t.\nProof Let x̄t be the unsaturated point in Dt with smallest σt−1(x), i.e.,\nx̄t = argmin x∈Dt\\St σt−1(x). (15)\nSince σt−1(·) and St are deterministic given F ′ t−1, so is x̄t. Now for any F ′ t−1 such that E f (t) is true,\nE [ σt−1(xt) ∣∣ F ′t−1] ≥ E [σt−1(xt) ∣∣ F ′t−1, xt ∈ Dt \\ St]P [xt ∈ Dt \\ St ∣∣ F ′t−1] ≥ σt−1(x̄t)(p− 1/t2), (16)\nwhere we have used Equation 15 and Lemma 9. Now, if both the events Ef (t) and Eft(t) are true, then from Definition 1 and 2, f(x) − ctσt−1(x) ≤ ft(x) ≤ f(x) + ctσt−1(x), for all x ∈ Dt. Using this observation along with Definition 3 and the facts that ft(xt) ≥ ft(x) for all x ∈ Dt and x̄t ∈ Dt \\ St, we have\n∆t(xt) = f([x ?]t)− f(x̄t) + f(x̄t)− f(xt)\n≤ ∆t(x̄t) + ft(x̄t) + ctσt−1(x̄t)− ft(xt) + ctσt−1(xt) ≤ ctσt−1(x̄t) + ctσt−1(x̄t) + ctσt−1(xt) ≤ ct ( 2σt−1(x̄t) + ctσt−1(xt) ) .\nTherefore, for any F ′t−1 such that Ef (t) is true, either ∆t(xt) ≤ ct ( 2σt−1(x̄t) + ctσt−1(xt) ) , or Eft(t) is false. Now from our assumption of bounded variance, for all x ∈ D, |f(x)| ≤ ‖f‖k k(x, x) ≤ B, and hence\n∆t(x) ≤ 2 sup x∈D |f(x)| ≤ 2B. Thus, using Equation 16, we get\nE [ ∆t(xt) ∣∣ F ′t−1] ≤ E [ct(2σt−1(x̄t) + ctσt−1(xt)) ∣∣ F ′t−1]+ 2BP [Eft(t) ∣∣ F ′t−1] ≤ 2ct p− 1/t2 E [ σt−1(xt)\n∣∣ F ′t−1]+ ctE [σt−1(xt) ∣∣ F ′t−1]+ 2Bt2 ≤ 11ct p E [ σt−1(xt)\n∣∣ F ′t−1]+ 2Bt2 , (17) where in the last inequality we used that 1/(p− 1/t2) ≤ 5/p, which holds trivially for t ≤ 4 and also holds for t ≥ 5, as t2 > 5e √ π. Now using Equation 7, we have the instantaneous regret at round t,\nrt = f(x ?)− f([x?]t) + f([x?]t)− f(xt) ≤\n1 t2 + ∆t(xt),\nand then taking conditional expectation on both sides, the result follows from Equation 17.\nDefinition 5 Let us define Y0 = 0, and for all t = 1, . . . , T :\nr̄t = rt · I{Ef (t)},\nXt = r̄t − 11ct p σt−1(xt)− 2B + 1 t2 ,\nYt = t∑ s=1 Xs.\nDefinition 6 A sequence of random variables (Zt; t ≥ 0) is called a super-martingale corresponding to a filtration Ft, if for all t, Zt is Ft-measurable, and for t ≥ 1,\nE [ Zt ∣∣ Ft−1] ≤ Zt−1.\nLemma 11 (Azuma-Hoeffding Inequality) If a super-martingale (Zt; t ≥ 0), corresponding to filtration Ft, satisfies |Zt − Zt−1| ≤ αt for some constant αt, for all t = 1, . . . , T , then for any δ ≥ 0,\nP ZT − Z0 ≤ √√√√2 ln(1/δ) T∑\nt=1\nα2t\n ≥ 1− δ.\nLemma 12 (Yt; t = 0, ..., T ) is a super-martingale process with respect to filtration F ′ t .\nProof From Definition 6, we need to prove that for all t ∈ {1, . . . , T} and any possibleF ′t−1, E [ Yt − Yt−1 ∣∣ F ′t−1] ≤ 0, i.e.\nE [ r̄t|F ′\nt−1\n] ≤ 11ct p E [ σt−1(xt)|F ′ t−1 ] + 2B + 1 t2 . (18)\nNow if F ′t−1 such thatEf (t) is false, then r̄t = rt ·I{Ef (t)} = 0, and Equation 18 holds trivially. Moreover, for F ′t−1 such that both Ef (t) is true, Equation 18 follows from Lemma 10.\nLemma 13 Given any δ ∈ (0, 1), with probability at least 1− δ,\nRT = T∑ t=1 r(t) = 11cT p T∑ t=1 σt−1(xt) + (2B + 1)π2 6 + (4B + 11)cT p √ 2T ln(2/δ),\nwhere T is the total number of rounds played.\nProof First note that from Definition 5 for all t = 1, . . . , T ,\n|Yt − Yt−1| = |Xt| ≤ |r̄t|+ 11ct p σt−1(xt) + 2B + 1 t2 .\nNow as r̄t ≤ rt ≤ 2 sup x∈D |f(x)| ≤ 2B and σ2t−1(xt) ≤ σ20(xt) ≤ 1, we have\n|Yt − Yt−1| ≤ 2B + 11ct p + 2B + 1 t2 ≤ (4B + 11)ct p ,\nwhich follows from the fact that 2B ≤ 2Bct/p and also (2B + 1)/t2 ≤ 2Bct/p. Thus, we can apply Azuma-Hoeffding inequality (Lemma 11) to obtain that with probability at least 1− δ/2,\nT∑ t=1 r̄t ≤ T∑ t=1 11ct p σt−1(xt) + T∑ t=1 2B + 1 t2 + √√√√2 ln(2/δ) T∑ t=1 (4B + 11)2c2t p2\n≤ 11cT p T∑ t=1 σt−1(xt) + (2B + 1)π2 6 + (4B + 11)cT p √ 2T ln(2/δ),\nas by definition ct ≤ cT for all t ∈ {1, . . . , T}. Now, as the event Ef (t) holds holds for all t with probability at least 1 − δ/2 (see Lemma 6), then from Definition 5, r̄t = rt for all t with probability at least 1 − δ/2. Now by applying union bound, the result follows.\nProof of Theorem 4 From Lemma 4 we have, T∑ t=1 σt−1(xt) = O( √ TγT ). Also from Definition 1,\nCT ≤ B +R √ 2(γT + 1 + ln(2/δ)) + ( B +R √ 2(γT + 1 + ln(2/δ)) )√ 4 lnT + 2d ln(BLrdT 2)\n= O (√ (γT + ln(2/δ))(lnT + d ln(BdT )) +B √ d ln(BdT ) ) = O (√ (γT + ln(2/δ))d ln(BdT ) ) .\nHence, from Lemma 13, with probability at least 1− δ,\nRT = O (√ (γT + ln(2/δ))d ln(BdT ) · (√ TγT +B √ T ln(2/δ) )) and thus with high probability,\nRT = O (√ Tγ2T d ln(BdT ) +B √ TγT d ln(BdT ) ) = O (√ Td ln(BdT ) ( B √ γT + γT )) ."
    }, {
      "heading" : "F. Recursive Updates of Posterior Mean and Covariance",
      "text" : "We now describe a procedure to update the posterior mean and covariance function in a recursive fashion through the properties of Schur complement (Zhang (2006)) rather than evaluating Equation 2 and 3 at each round. Specifically for all t ≥ 1 we show the following:\nµt(x) = µt−1(x) + kt−1(x, xt)\nλ+ σ2t−1(xt) (yt − µt−1(xt)), (19)\nkt(x, x ′) = kt−1(x, x ′)− kt−1(x, xt)kt−1(xt, x ′)\nλ+ σ2t−1(xt) , (20)\nσ2t (x) = σ 2 t−1(x)−\nk2t−1(x, xt)\nλ+ σ2t−1(xt) . (21)\nThese update rules make our algorithms easy to implement and we are not aware of any literature which explicitly states or uses these relations. First we write the matrix Kt + λI as [ A B C D ] , where A = Kt−1 + λI , B = kt−1(xt), C = BT and D = λ+ k(xt, xt). Now using Schur’s complement we get[ A B C D ]−1 = [ A−1 +A−1BβCA−1 −A−1Bβ −βCA−1 β\n] = [ A−1 + βA−1BBTA−1 −βA−1B\n−βBTA−1 β ] = [ A−1 + βγ −βα −βαT β ] ,\nwhere β = (D − CA−1B)−1 = 1/(D − BTA−1B), γ = A−1BBTA−1 and α = A−1B. Therefore we have\nµt(x) = kt(x) T (Kt + λI) −1y1:t\n= [ kt−1(x) T k(xt, x) ] [A−1 + βγ −βα −βαT β ] [ y1:t−1 yt ] = kt−1(x) T (A−1 + βγ)y1:t−1 − βk(xt, x)αT y1:t−1 − βytαT kt−1(x) + βytk(xt, x)\n= kt−1(x) TA−1y1:t−1 + β ( kt−1(x) T γy1:t−1 − k(xt, x)αT y1:t−1 − ytαT kt−1(x) + ytk(xt, x) ) ,\nwhere\nkt−1(x) TA−1y1:t−1 = kt−1(x) T (Kt−1 + λI) −1y1:t−1 = µt−1(x),\nkt−1(x) T γy1:t−1 = kt−1(x) TA−1kt−1(xt)kt−1(xt) TA−1y1:t−1 = ( kt−1(xt) TA−1kt−1(x) ) µt−1(xt),\nαT y1:t−1 = kt−1(xt) TA−1y1:t−1 = µt−1(xt),\nαT kt−1(x) = kt−1(xt) TA−1kt−1(x).\nThus we have µt(x) = µt−1(x) + β ( kt−1(xt) TA−1kt−1(x) (µt−1(xt)− yt) + k(xt, x) (yt − µt−1(xt)) )\n= µt−1(x) + β (yt − µt−1(xt)) ( k(xt, x)− kt−1(xt)TA−1kt−1(x) ) = µt−1(x) + βkt−1(xt, x)(yt − µt−1(xt)).\nNow as\nD −BTA−1B = λ+ k(xt, xt)− kt−1(xt)T (Kt−1 + λI)−1kt−1(xt) = λ+ σ2t−1(xt),\nputting β = 1/(λ+ σ2t−1(xt)), we obtain Equation 19. Again observe that\nkt(x, x ′) = k(x, x′)− kt(x)T (Kt + λI)−1kt(x′) = k(x, x′)− kt−1(x)TA−1kt−1(x′) + β ( kt−1(x) T γkt−1(x ′)− k(xt, x)αT kt−1(x′)− k(xt, x′)αT kt−1(x) + k(xt, x)k(xt, x′) ) .\nNow we have\nk(x, x′)− kt−1(x)TA−1kt−1(x′) = k(x, x′)− kt−1(x)T (Kt−1 + λI)−1kt−1(x′) = kt−1(x, x′),\nalso\nkt−1(x) T γkt−1(x ′)− k(xt, x)αT kt−1(x′) = kt−1(x)TA−1kt−1(xt)kt−1(xt)TA−1kt−1(x′)− k(xt, x)kt−1(xt)TA−1kt−1(x′) = (kt−1(x)\nTA−1kt−1(xt)− k(xt, x))kt−1(xt)TA−1kt−1(x′) = −kt−1(xt, x)kt−1(xt)TA−1kt−1(x′),\nand\nk(xt, x)k(xt, x ′)− k(xt, x′)αT kt−1(x) = k(xt, x′)(k(xt, x)− kt−1(xt)TA−1kt−1(x))\n= k(xt, x ′)kt−1(xt, x).\nPutting all these together we get\nkt(x, x ′) = kt−1(x, x ′)− β ( k(xt, x ′)kt−1(xt, x)− kt−1(xt, x)kt−1(xt)TA−1kt−1(x′) )\n= kt−1(x, x ′)− β ( kt−1(xt, x) ( k(xt, x ′)− kt−1(xt)TA−1kt−1(x′) ))\n= kt−1(x, x ′)− βkt−1(xt, x)kt−1(xt, x′).\nNow Equation 20 and 21 follows by using β = 1/(λ+ σ2t−1(x)) and σ 2 t (x) = kt(x, x)."
    } ],
    "references" : [ {
      "title" : "Improved algorithms for linear stochastic bandits",
      "author" : [ "Yasin Abbasi-Yadkori", "Dávid Pál", "Csaba Szepesvári" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Abbasi.Yadkori et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Abbasi.Yadkori et al\\.",
      "year" : 2011
    }, {
      "title" : "Analysis of thompson sampling for the multi-armed bandit problem",
      "author" : [ "Shipra Agrawal", "Navin Goyal" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Agrawal and Goyal.,? \\Q2012\\E",
      "shortCiteRegEx" : "Agrawal and Goyal.",
      "year" : 2012
    }, {
      "title" : "Thompson sampling for contextual bandits with linear payoffs",
      "author" : [ "Shipra Agrawal", "Navin Goyal" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Agrawal and Goyal.,? \\Q2013\\E",
      "shortCiteRegEx" : "Agrawal and Goyal.",
      "year" : 2013
    }, {
      "title" : "Online stochastic optimization under correlated bandit feedback",
      "author" : [ "Mohammad Gheshlaghi Azar", "Alessandro Lazaric", "Emma Brunskill" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Azar et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Azar et al\\.",
      "year" : 2014
    }, {
      "title" : "Hybrid batch bayesian optimization",
      "author" : [ "Javad Azimi", "Ali Jalali", "Xiaoli Fern" ],
      "venue" : "arXiv preprint arXiv:1202.5597,",
      "citeRegEx" : "Azimi et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Azimi et al\\.",
      "year" : 2012
    }, {
      "title" : "Dynamic pricing without knowing the demand function: Risk bounds and near-optimal algorithms",
      "author" : [ "Omar Besbes", "Assaf Zeevi" ],
      "venue" : "Operations Research,",
      "citeRegEx" : "Besbes and Zeevi.,? \\Q2009\\E",
      "shortCiteRegEx" : "Besbes and Zeevi.",
      "year" : 2009
    }, {
      "title" : "Time-varying gaussian process bandit optimization",
      "author" : [ "Ilija Bogunovic", "Jonathan Scarlett", "Volkan Cevher" ],
      "venue" : "arXiv preprint arXiv:1601.06650,",
      "citeRegEx" : "Bogunovic et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Bogunovic et al\\.",
      "year" : 2016
    }, {
      "title" : "Simple regret for infinitely many armed bandits",
      "author" : [ "Alexandra Carpentier", "Michal Valko" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Carpentier and Valko.,? \\Q2015\\E",
      "shortCiteRegEx" : "Carpentier and Valko.",
      "year" : 2015
    }, {
      "title" : "Power control in wireless cellular networks",
      "author" : [ "Mung Chiang", "Prashanth Hande", "Tian Lan", "Chee Wei Tan" ],
      "venue" : "Foundations and Trends in Networking,",
      "citeRegEx" : "Chiang et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Chiang et al\\.",
      "year" : 2008
    }, {
      "title" : "Stochastic linear optimization under bandit feedback",
      "author" : [ "Varsha Dani", "Thomas P Hayes", "Sham M Kakade" ],
      "venue" : "In COLT,",
      "citeRegEx" : "Dani et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Dani et al\\.",
      "year" : 2008
    }, {
      "title" : "Exponential regret bounds for gaussian process bandits with deterministic observations",
      "author" : [ "Nando De Freitas", "Alex Smola", "Masrour Zoghi" ],
      "venue" : "arXiv preprint arXiv:1206.6457,",
      "citeRegEx" : "Freitas et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Freitas et al\\.",
      "year" : 2012
    }, {
      "title" : "High-dimensional gaussian process bandits",
      "author" : [ "Josip Djolonga", "Andreas Krause", "Volkan Cevher" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Djolonga et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Djolonga et al\\.",
      "year" : 2013
    }, {
      "title" : "Probability: Theory and Examples",
      "author" : [ "Rick Durrett" ],
      "venue" : null,
      "citeRegEx" : "Durrett.,? \\Q2005\\E",
      "shortCiteRegEx" : "Durrett.",
      "year" : 2005
    }, {
      "title" : "Thompson sampling for complex online problems",
      "author" : [ "Aditya Gopalan", "Shie Mannor", "Yishay Mansour" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Gopalan et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Gopalan et al\\.",
      "year" : 2014
    }, {
      "title" : "Safe exploration for optimization with gaussian processes",
      "author" : [ "Alkis Gotovos", "ETHZ CH", "Joel W Burdick" ],
      "venue" : null,
      "citeRegEx" : "Gotovos et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Gotovos et al\\.",
      "year" : 2015
    }, {
      "title" : "Regret bounds for gaussian process bandit problems",
      "author" : [ "Steffen Grünewälder", "Jean-Yves Audibert", "Manfred Opper", "John Shawe-Taylor" ],
      "venue" : "In AISTATS,",
      "citeRegEx" : "Grünewälder et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Grünewälder et al\\.",
      "year" : 2010
    }, {
      "title" : "Exploiting correlation and budget constraints in bayesian multi-armed bandit optimization",
      "author" : [ "Matthew W Hoffman", "Bobak Shahriari", "Nando de Freitas" ],
      "venue" : "arXiv preprint arXiv:1303.6746,",
      "citeRegEx" : "Hoffman et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Hoffman et al\\.",
      "year" : 2013
    }, {
      "title" : "Reinforcement learning: A survey",
      "author" : [ "Leslie Pack Kaelbling", "Michael L Littman", "Andrew W Moore" ],
      "venue" : "Journal of artificial intelligence research,",
      "citeRegEx" : "Kaelbling et al\\.,? \\Q1996\\E",
      "shortCiteRegEx" : "Kaelbling et al\\.",
      "year" : 1996
    }, {
      "title" : "Thompson sampling: An asymptotically optimal finite-time analysis",
      "author" : [ "Emilie Kaufmann", "Nathaniel Korda", "Rémi Munos" ],
      "venue" : "In International Conference on Algorithmic Learning Theory,",
      "citeRegEx" : "Kaufmann et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Kaufmann et al\\.",
      "year" : 2012
    }, {
      "title" : "Multi-armed bandits in metric spaces",
      "author" : [ "Robert Kleinberg", "Aleksandrs Slivkins", "Eli Upfal" ],
      "venue" : "In Proceedings of the fortieth annual ACM symposium on Theory of computing,",
      "citeRegEx" : "Kleinberg et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Kleinberg et al\\.",
      "year" : 2008
    }, {
      "title" : "Contextual gaussian process bandit optimization",
      "author" : [ "Andreas Krause", "Cheng S Ong" ],
      "venue" : "In Advances in Neural Information Processing Systems,",
      "citeRegEx" : "Krause and Ong.,? \\Q2011\\E",
      "shortCiteRegEx" : "Krause and Ong.",
      "year" : 2011
    }, {
      "title" : "A new method of locating the maximum point of an arbitrary multipeak curve in the presence of noise",
      "author" : [ "Harold J Kushner" ],
      "venue" : "Journal of Basic Engineering,",
      "citeRegEx" : "Kushner.,? \\Q1964\\E",
      "shortCiteRegEx" : "Kushner.",
      "year" : 1964
    }, {
      "title" : "Self-normalization techniques for streaming confident regression. 2016",
      "author" : [ "Odalric-Ambrym Maillard" ],
      "venue" : null,
      "citeRegEx" : "Maillard.,? \\Q2016\\E",
      "shortCiteRegEx" : "Maillard.",
      "year" : 2016
    }, {
      "title" : "On bayesian methods for seeking the extremum",
      "author" : [ "J Močkus" ],
      "venue" : "In Optimization Techniques IFIP Technical Conference,",
      "citeRegEx" : "Močkus.,? \\Q1975\\E",
      "shortCiteRegEx" : "Močkus.",
      "year" : 1975
    }, {
      "title" : "Gaussian processes for machine learning",
      "author" : [ "Carl Edward Rasmussen", "Christopher KI Williams" ],
      "venue" : null,
      "citeRegEx" : "Rasmussen and Williams.,? \\Q2006\\E",
      "shortCiteRegEx" : "Rasmussen and Williams.",
      "year" : 2006
    }, {
      "title" : "Linearly parameterized bandits",
      "author" : [ "Paat Rusmevichientong", "John N. Tsitsiklis" ],
      "venue" : "Math. Oper. Res.,",
      "citeRegEx" : "Rusmevichientong and Tsitsiklis.,? \\Q2010\\E",
      "shortCiteRegEx" : "Rusmevichientong and Tsitsiklis.",
      "year" : 2010
    }, {
      "title" : "Learning to optimize via posterior sampling",
      "author" : [ "Daniel Russo", "Benjamin Van Roy" ],
      "venue" : "Mathematics of Operations Research,",
      "citeRegEx" : "Russo and Roy.,? \\Q2014\\E",
      "shortCiteRegEx" : "Russo and Roy.",
      "year" : 2014
    }, {
      "title" : "Learning with kernels: support vector machines, regularization, optimization, and beyond",
      "author" : [ "Bernhard Schölkopf", "Alexander J Smola" ],
      "venue" : "MIT press,",
      "citeRegEx" : "Schölkopf and Smola.,? \\Q2002\\E",
      "shortCiteRegEx" : "Schölkopf and Smola.",
      "year" : 2002
    }, {
      "title" : "Practical reinforcement learning in continuous spaces",
      "author" : [ "William D Smart", "Leslie Pack Kaelbling" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Smart and Kaelbling.,? \\Q2000\\E",
      "shortCiteRegEx" : "Smart and Kaelbling.",
      "year" : 2000
    }, {
      "title" : "Gaussian process optimization in the bandit setting: No regret and experimental design",
      "author" : [ "Niranjan Srinivas", "Andreas Krause", "Sham M Kakade", "Matthias Seeger" ],
      "venue" : "arXiv preprint arXiv:0912.3995,",
      "citeRegEx" : "Srinivas et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Srinivas et al\\.",
      "year" : 2009
    }, {
      "title" : "Finite-time analysis of kernelised contextual bandits",
      "author" : [ "Michal Valko", "Nathaniel Korda", "Rémi Munos", "Ilias Flaounas", "Nelo Cristianini" ],
      "venue" : "arXiv preprint arXiv:1309.6869,",
      "citeRegEx" : "Valko et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Valko et al\\.",
      "year" : 2013
    }, {
      "title" : "Optimization as estimation with gaussian processes in bandit settings",
      "author" : [ "Zi Wang", "Bolei Zhou", "Stefanie Jegelka" ],
      "venue" : "In International Conf. on Artificial and Statistics (AISTATS),",
      "citeRegEx" : "Wang et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Wang et al\\.",
      "year" : 2016
    }, {
      "title" : "Bayesian optimization in high dimensions via random embeddings",
      "author" : [ "Ziyu Wang", "Masrour Zoghi", "Frank Hutter", "David Matheson", "N Freitas" ],
      "venue" : "AAAI Press/International Joint Conferences on Artificial Intelligence,",
      "citeRegEx" : "Wang et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Wang et al\\.",
      "year" : 2013
    }, {
      "title" : "The Schur complement and its applications, volume 4",
      "author" : [ "Fuzhen Zhang" ],
      "venue" : "Springer Science & Business Media,",
      "citeRegEx" : "Zhang.,? \\Q2006\\E",
      "shortCiteRegEx" : "Zhang.",
      "year" : 2006
    } ],
    "referenceMentions" : [ {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al.",
      "startOffset" : 188,
      "endOffset" : 212
    }, {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al.",
      "startOffset" : 188,
      "endOffset" : 296
    }, {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al.",
      "startOffset" : 188,
      "endOffset" : 324
    }, {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al. (2008). A typical feature of such problems is a large, or potentially infinite, domain of decision points or covariates (prices, actions, transmit powers), together with only partial and noisy observability of the associated outcomes (demand, state/reward, communication rate); reward/loss information is revealed only for decisions that are chosen.",
      "startOffset" : 188,
      "endOffset" : 390
    }, {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al. (2008). A typical feature of such problems is a large, or potentially infinite, domain of decision points or covariates (prices, actions, transmit powers), together with only partial and noisy observability of the associated outcomes (demand, state/reward, communication rate); reward/loss information is revealed only for decisions that are chosen. This often makes it hard to balance exploration and exploitation, as available knowledge must be transferred efficiently from a finite set of observations so far to estimates of the values of infinitely many decisions. A classic case in point is that of the canonical stochastic MAB with finitely many arms, where the effort to optimize scales with the total number of arms or decisions; the effect of this is catastrophic for large or infinite arm sets. With suitable structure in the values or rewards of arms, however, the challenge of sequential optimization can be efficiently addressed. Parametric bandits, especially linearly parameterized bandits Rusmevichientong and Tsitsiklis (2010), represent a well-studied class of structured decision making settings.",
      "startOffset" : 188,
      "endOffset" : 1427
    }, {
      "referenceID" : 4,
      "context" : "Introduction Optimization over large domains under uncertainty is an important subproblem arising in a variety of sequential decision making problems, such as dynamic pricing in economics Besbes and Zeevi (2009), reinforcement learning with continuous state/action spaces Kaelbling et al. (1996); Smart and Kaelbling (2000), and power control in wireless communication Chiang et al. (2008). A typical feature of such problems is a large, or potentially infinite, domain of decision points or covariates (prices, actions, transmit powers), together with only partial and noisy observability of the associated outcomes (demand, state/reward, communication rate); reward/loss information is revealed only for decisions that are chosen. This often makes it hard to balance exploration and exploitation, as available knowledge must be transferred efficiently from a finite set of observations so far to estimates of the values of infinitely many decisions. A classic case in point is that of the canonical stochastic MAB with finitely many arms, where the effort to optimize scales with the total number of arms or decisions; the effect of this is catastrophic for large or infinite arm sets. With suitable structure in the values or rewards of arms, however, the challenge of sequential optimization can be efficiently addressed. Parametric bandits, especially linearly parameterized bandits Rusmevichientong and Tsitsiklis (2010), represent a well-studied class of structured decision making settings. Here, every arm corresponds to a known, finite dimensional vector (its feature vector), and its expected reward is assumed to be an unknown linear function of its feature vector. This allows for a large, or even infinite, set of arms all lying in space of finite dimension, say d, and a rich line of work gives algorithms that attain sublinear regret with a polynomial dependence on the dimension, e.g., Confidence Ball Dani et al. (2008), OFUL Abbasi-Yadkori et al.",
      "startOffset" : 188,
      "endOffset" : 1938
    }, {
      "referenceID" : 0,
      "context" : "(2008), OFUL Abbasi-Yadkori et al. (2011) (a strengthening of Confidence Ball) and Thompson sampling for linear bandits",
      "startOffset" : 13,
      "endOffset" : 42
    }, {
      "referenceID" : 0,
      "context" : "The inequality generalizes a corresponding self-normalized bound for martingales in finite dimension proven by Abbasi-Yadkori et al. (2011). • Empirical comparisons of the algorithms developed above, with other GP-based algorithms, are presented, over both synthetic and real-world setups, demonstrating performance improvements of the proposed algorithms, as well as their performance under misspecification.",
      "startOffset" : 111,
      "endOffset" : 140
    }, {
      "referenceID" : 0,
      "context" : "This is a mild assumption on the noise (it holds, for instance, for distributions bounded in [−R,R]) and is standard in the bandit literature Abbasi-Yadkori et al. (2011); Agrawal and Goyal (2013).",
      "startOffset" : 142,
      "endOffset" : 171
    }, {
      "referenceID" : 0,
      "context" : "This is a mild assumption on the noise (it holds, for instance, for distributions bounded in [−R,R]) and is standard in the bandit literature Abbasi-Yadkori et al. (2011); Agrawal and Goyal (2013). Regret.",
      "startOffset" : 142,
      "endOffset" : 197
    }, {
      "referenceID" : 0,
      "context" : "This is a mild assumption on the noise (it holds, for instance, for distributions bounded in [−R,R]) and is standard in the bandit literature Abbasi-Yadkori et al. (2011); Agrawal and Goyal (2013). Regret. The goal of an algorithm is to maximize its cumulative reward or alternatively minimize its cumulative regret – the loss incurred due to not knowing f ’s maximum point beforehand. Let x ∈ argmaxx∈D f(x) be a maximum point of f (assuming the maximum is attained). The instantaneous regret incurred at time t is rt = f(x )−f(xt), and the cumulative regret in a time horizon T (not necessarily known a priori) is defined to be RT = ∑T t=1 rt. A sub-linear growth of RT in T signifies that RT /T → 0 as T → ∞, or vanishing per-round regret. Regularity Assumptions. Attaining sub-linear regret is impossible in general for arbitrary reward functions f and domains D, and thus some regularity assumptions are in order. In what follows, we assume that D is compact. The smoothness assumption we make on the reward function f is motivated by Gaussian processes4 and their associated reproducing kernel Hilbert spaces (RKHSs, see Schölkopf and Smola (2002)).",
      "startOffset" : 142,
      "endOffset" : 1154
    }, {
      "referenceID" : 1,
      "context" : "These assumptions are required to make the regret bounds scale-free and are standard in the literature Agrawal and Goyal (2013). Instead if k(x, x) ≤ c or ‖f‖k ≤ cB, then our regret bounds would increase by a factor of c.",
      "startOffset" : 103,
      "endOffset" : 128
    }, {
      "referenceID" : 29,
      "context" : "In general, thus, this represents a misspecified prior and noise model, also termed the agnostic setting by Srinivas et al. (2009). The proposed algorithms, to follow, assume the knowledge of only the sub-Gaussianity parameter R, kernel function k and upper bound B on the RKHS norm of f .",
      "startOffset" : 108,
      "endOffset" : 131
    }, {
      "referenceID" : 29,
      "context" : "For a compact subset D of R, γT is O((lnT )) and O(T d(d+1)/(2ν+d(d+1)) lnT ), respectively, for the Squared Exponential and Matérn kernels (Srinivas et al. (2009)), depending only polylogarithmically on the time T .",
      "startOffset" : 141,
      "endOffset" : 164
    }, {
      "referenceID" : 29,
      "context" : "Srinivas et al. (2009) have proposed the GP-UCB algorithm, and Valko et al.",
      "startOffset" : 0,
      "endOffset" : 23
    }, {
      "referenceID" : 29,
      "context" : "Srinivas et al. (2009) have proposed the GP-UCB algorithm, and Valko et al. (2013) the KernelUCB algorithm, for sequentially optimizing reward functions lying in the RKHS Hk(D).",
      "startOffset" : 0,
      "endOffset" : 83
    }, {
      "referenceID" : 29,
      "context" : "Srinivas et al. (2009) have proposed the GP-UCB algorithm, and Valko et al. (2013) the KernelUCB algorithm, for sequentially optimizing reward functions lying in the RKHS Hk(D). Both algorithms play an arm at time t using the rule: xt = argmaxx∈D μt−1(x) + β̃tσt−1(x). GP-UCB uses the exploration parameter β̃t = √ 2B2 + 300γt−1 ln (t/δ), with λ set to σ, where σ is additionally assumed to be a known, uniform (i.e., almost-sure) upper bound on all noise variables εt (see Theorem 3 in Srinivas et al. (2009)).",
      "startOffset" : 0,
      "endOffset" : 510
    }, {
      "referenceID" : 1,
      "context" : "2 Gaussian Process Thompson sampling (GP-TS) Our second algorithm, GP-TS (Algorithm 2), inspired by the success of Thompson sampling for standard and parametric bandits (Agrawal and Goyal, 2012; Kaufmann et al., 2012; Gopalan et al., 2014; Agrawal and Goyal, 2013), uses the time-varying scale parameter vt = B +R √ 2(γt−1 + 1 + ln(2/δ)) and operates as follows.",
      "startOffset" : 169,
      "endOffset" : 264
    }, {
      "referenceID" : 18,
      "context" : "2 Gaussian Process Thompson sampling (GP-TS) Our second algorithm, GP-TS (Algorithm 2), inspired by the success of Thompson sampling for standard and parametric bandits (Agrawal and Goyal, 2012; Kaufmann et al., 2012; Gopalan et al., 2014; Agrawal and Goyal, 2013), uses the time-varying scale parameter vt = B +R √ 2(γt−1 + 1 + ln(2/δ)) and operates as follows.",
      "startOffset" : 169,
      "endOffset" : 264
    }, {
      "referenceID" : 13,
      "context" : "2 Gaussian Process Thompson sampling (GP-TS) Our second algorithm, GP-TS (Algorithm 2), inspired by the success of Thompson sampling for standard and parametric bandits (Agrawal and Goyal, 2012; Kaufmann et al., 2012; Gopalan et al., 2014; Agrawal and Goyal, 2013), uses the time-varying scale parameter vt = B +R √ 2(γt−1 + 1 + ln(2/δ)) and operates as follows.",
      "startOffset" : 169,
      "endOffset" : 264
    }, {
      "referenceID" : 2,
      "context" : "2 Gaussian Process Thompson sampling (GP-TS) Our second algorithm, GP-TS (Algorithm 2), inspired by the success of Thompson sampling for standard and parametric bandits (Agrawal and Goyal, 2012; Kaufmann et al., 2012; Gopalan et al., 2014; Agrawal and Goyal, 2013), uses the time-varying scale parameter vt = B +R √ 2(γt−1 + 1 + ln(2/δ)) and operates as follows.",
      "startOffset" : 169,
      "endOffset" : 264
    }, {
      "referenceID" : 0,
      "context" : "Theorem 1 represents the kernelized generalization of the finite-dimensional result of Abbasi-Yadkori et al. (2011), and we recover their result under the special case of a linear kernel: φ(x) = x for all x ∈ R.",
      "startOffset" : 87,
      "endOffset" : 116
    }, {
      "referenceID" : 0,
      "context" : "Theorem 1 represents the kernelized generalization of the finite-dimensional result of Abbasi-Yadkori et al. (2011), and we recover their result under the special case of a linear kernel: φ(x) = x for all x ∈ R. We remark that when φ is a mapping to a finite-dimensional Hilbert space, the argument of AbbasiYadkori et al. (2011, Theorem 1) can be lifted to establish Theorem 1, but it breaks down in the generalized, infinite-dimensional RKHS setting, as the self-normalized bound in their paper has an explicit, growing dependence on the feature dimension. Specifically, the method of mixtures (de la Pena et al., 2009) or Laplace method, as dubbed by Maillard (2016) (Lemma 5.",
      "startOffset" : 87,
      "endOffset" : 670
    }, {
      "referenceID" : 24,
      "context" : ", Rasmussen and Williams (2006). 9.",
      "startOffset" : 2,
      "endOffset" : 32
    }, {
      "referenceID" : 22,
      "context" : "5 of Maillard (2016) states a similar result on the estimation of the unknown reward function from the RKHS.",
      "startOffset" : 5,
      "endOffset" : 21
    }, {
      "referenceID" : 29,
      "context" : "Srinivas et al. (2009), in the course of analyzing the GP-UCB algorithm, show that when the reward function lies in the RKHS Hk(D), GP-UCB obtains regret O (√ T (B √ γT + γT ln (T )) ) with high probability (see Theorem 3 therein for the exact bound).",
      "startOffset" : 0,
      "endOffset" : 23
    }, {
      "referenceID" : 29,
      "context" : "Srinivas et al. (2009), in the course of analyzing the GP-UCB algorithm, show that when the reward function lies in the RKHS Hk(D), GP-UCB obtains regret O (√ T (B √ γT + γT ln (T )) ) with high probability (see Theorem 3 therein for the exact bound). Furthermore, they assume that the noise εt is uniformly bounded by σ, while our sub-Gaussianity assumption (see Equation 1) is slightly more general, and we are able to obtain a O(ln T ) multiplicative factor improvement in the final regret bound thanks to the new self-normalized inequality (Theorem 1). Additionally, in our numerical experiments, we observe a significantly improved performance of IGP-UCB over GP-UCB, both on synthetically generated function, and on real-world sensor measurement data (see Section 6). Comparison with KernelUCB. Valko et al. (2013) show that the cumulative regret of KernelUCB is Õ( √ d̃T ), where d̃, defined as the effective dimension, measures, in a sense, the number of principal directions over which the projection of the data in the RKHS is spread.",
      "startOffset" : 0,
      "endOffset" : 821
    }, {
      "referenceID" : 0,
      "context" : "For this kernel, γT = O(d lnT ), and the regret scaling of IGP-UCB is Õ(d √ T ) and that of GP-TS is Õ(d √ T ), which recovers the regret bounds of their linear, parametric analogues OFUL (Abbasi-Yadkori et al., 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively.",
      "startOffset" : 188,
      "endOffset" : 217
    }, {
      "referenceID" : 2,
      "context" : ", 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively.",
      "startOffset" : 37,
      "endOffset" : 62
    }, {
      "referenceID" : 0,
      "context" : "For this kernel, γT = O(d lnT ), and the regret scaling of IGP-UCB is Õ(d √ T ) and that of GP-TS is Õ(d √ T ), which recovers the regret bounds of their linear, parametric analogues OFUL (Abbasi-Yadkori et al., 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively. Moreover, in this case d̃ = d, thus the regret of IGP-UCB is √ d factor away from that of KernelUCB. But the regret bound of KernelUCB also depends on the number of arms N , and if N is exponential in d, then it also suffers Õ(d √ T ) regret. We remark that a similar O(ln T ) factor improvement, as obtained by IGP-UCB over GP-UCB, was achieved in the linear parametric setting by Abbasi-Yadkori et al. (2011) in the OFUL algorithm, over its predecessor ConfidenceBall Dani et al.",
      "startOffset" : 189,
      "endOffset" : 699
    }, {
      "referenceID" : 0,
      "context" : "For this kernel, γT = O(d lnT ), and the regret scaling of IGP-UCB is Õ(d √ T ) and that of GP-TS is Õ(d √ T ), which recovers the regret bounds of their linear, parametric analogues OFUL (Abbasi-Yadkori et al., 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively. Moreover, in this case d̃ = d, thus the regret of IGP-UCB is √ d factor away from that of KernelUCB. But the regret bound of KernelUCB also depends on the number of arms N , and if N is exponential in d, then it also suffers Õ(d √ T ) regret. We remark that a similar O(ln T ) factor improvement, as obtained by IGP-UCB over GP-UCB, was achieved in the linear parametric setting by Abbasi-Yadkori et al. (2011) in the OFUL algorithm, over its predecessor ConfidenceBall Dani et al. (2008). Finally we see that the for linear bandit problem with infinitely many actions, IGP-UCB attains the information theoretic lower bound of Ω(d √ T ) (see Dani et al.",
      "startOffset" : 189,
      "endOffset" : 777
    }, {
      "referenceID" : 0,
      "context" : "For this kernel, γT = O(d lnT ), and the regret scaling of IGP-UCB is Õ(d √ T ) and that of GP-TS is Õ(d √ T ), which recovers the regret bounds of their linear, parametric analogues OFUL (Abbasi-Yadkori et al., 2011) and Linear Thompson sampling (Agrawal and Goyal, 2013), respectively. Moreover, in this case d̃ = d, thus the regret of IGP-UCB is √ d factor away from that of KernelUCB. But the regret bound of KernelUCB also depends on the number of arms N , and if N is exponential in d, then it also suffers Õ(d √ T ) regret. We remark that a similar O(ln T ) factor improvement, as obtained by IGP-UCB over GP-UCB, was achieved in the linear parametric setting by Abbasi-Yadkori et al. (2011) in the OFUL algorithm, over its predecessor ConfidenceBall Dani et al. (2008). Finally we see that the for linear bandit problem with infinitely many actions, IGP-UCB attains the information theoretic lower bound of Ω(d √ T ) (see Dani et al. (2008)), but GP-TS is a factor of √ d away from it.",
      "startOffset" : 189,
      "endOffset" : 949
    }, {
      "referenceID" : 1,
      "context" : "We follow a similar approach given in Agrawal and Goyal (2013) to prove the regret bound of GP-TS.",
      "startOffset" : 38,
      "endOffset" : 63
    }, {
      "referenceID" : 4,
      "context" : "We consider 2 well-known synthetic benchmark functions for Bayesian Optimization: Rosenbrock and Hartman3 (see Azimi et al. (2012) for exact analytical expressions).",
      "startOffset" : 111,
      "endOffset" : 131
    }, {
      "referenceID" : 17,
      "context" : "Following Srinivas et al. (2009), we calculate the empirical covariance matrix of the sensor measurements and use it as the kernel matrix in the algorithms.",
      "startOffset" : 10,
      "endOffset" : 33
    }, {
      "referenceID" : 11,
      "context" : "An alternative line of work pertaining toX -armed bandits Kleinberg et al. (2008); Bubeck et al.",
      "startOffset" : 58,
      "endOffset" : 82
    }, {
      "referenceID" : 11,
      "context" : "An alternative line of work pertaining toX -armed bandits Kleinberg et al. (2008); Bubeck et al. (2011); Carpentier and Valko (2015); Azar et al.",
      "startOffset" : 58,
      "endOffset" : 104
    }, {
      "referenceID" : 5,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al.",
      "startOffset" : 8,
      "endOffset" : 36
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure.",
      "startOffset" : 37,
      "endOffset" : 56
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R.",
      "startOffset" : 37,
      "endOffset" : 150
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al.",
      "startOffset" : 37,
      "endOffset" : 400
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al.",
      "startOffset" : 37,
      "endOffset" : 422
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al.",
      "startOffset" : 37,
      "endOffset" : 449
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al.",
      "startOffset" : 37,
      "endOffset" : 508
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al.",
      "startOffset" : 37,
      "endOffset" : 549
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al.",
      "startOffset" : 37,
      "endOffset" : 569
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al.",
      "startOffset" : 37,
      "endOffset" : 607
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al.",
      "startOffset" : 37,
      "endOffset" : 642
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al. (2013) and noise-free De Freitas et al.",
      "startOffset" : 37,
      "endOffset" : 683
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al. (2013) and noise-free De Freitas et al. (2012) settings.",
      "startOffset" : 37,
      "endOffset" : 723
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al. (2013) and noise-free De Freitas et al. (2012) settings. Other relevant work focuses on best arm identification problem in the Bayesian setup considering pure exploration Grünewälder et al. (2010). For Thompson sampling (TS), Russo and Van Roy (2014) analyze the Bayesian",
      "startOffset" : 37,
      "endOffset" : 873
    }, {
      "referenceID" : 3,
      "context" : "(2011); Carpentier and Valko (2015); Azar et al. (2014) studies continuum-armed bandits with smoothness structure. For instance, Bubeck et al. (2011) show that with a Lipschitzness assumption on the reward function, algorithms based on discretizing the domain yield nontrivial regret guarantees, of order Ω(T d+1 d+2 ) in R. Other Bayesian approaches to function optimization are GP-EI Močkus (1975), GP-PI Kushner (1964), GP-EST Wang et al. (2016) and GP-UCB, including the contextual Krause and Ong (2011), high-dimensional Djolonga et al. (2013); Wang et al. (2013), time-varying Bogunovic et al. (2016) safety-aware Gotovos et al. (2015), budget-constraint Hoffman et al. (2013) and noise-free De Freitas et al. (2012) settings. Other relevant work focuses on best arm identification problem in the Bayesian setup considering pure exploration Grünewälder et al. (2010). For Thompson sampling (TS), Russo and Van Roy (2014) analyze the Bayesian",
      "startOffset" : 37,
      "endOffset" : 927
    }, {
      "referenceID" : 12,
      "context" : "By the convergence theorem for nonnegative super-martingales (Durrett, 2005), M ∞ = lim t→∞ M t exists almost surely, and thus M g τ is well-defined.",
      "startOffset" : 61,
      "endOffset" : 76
    }, {
      "referenceID" : 12,
      "context" : "By Fatou’s lemma (Durrett, 2005), E [M τ ] = E [ lim t→∞ Qgt ] = E [ lim inf t→∞ Qgt ]",
      "startOffset" : 17,
      "endOffset" : 32
    }, {
      "referenceID" : 12,
      "context" : "t is also a super-martingale (Durrett, 2005).",
      "startOffset" : 29,
      "endOffset" : 44
    }, {
      "referenceID" : 0,
      "context" : "(9) To complete the proof, we now employ a stopping time construction as in Abbasi-Yadkori et al. (2011). For each t ≥ 0, define the ‘bad’ event",
      "startOffset" : 76,
      "endOffset" : 105
    }, {
      "referenceID" : 16,
      "context" : "Thus using Lemma B4 of Hoffman et al. (2013), for any δ ∈ (0, 1), with probability at least 1− δ |ft(x)− μt−1(x)| ≤ √ 2 ln(1/δ) vtσt−1(x), and now applying union bound,",
      "startOffset" : 23,
      "endOffset" : 45
    }, {
      "referenceID" : 33,
      "context" : "Recursive Updates of Posterior Mean and Covariance We now describe a procedure to update the posterior mean and covariance function in a recursive fashion through the properties of Schur complement (Zhang (2006)) rather than evaluating Equation 2 and 3 at each round.",
      "startOffset" : 199,
      "endOffset" : 212
    } ],
    "year" : 2017,
    "abstractText" : "We consider the stochastic bandit problem with a continuous set of arms, with the expected reward function over the arms assumed to be fixed but unknown. We provide two new Gaussian process-based algorithms for continuous bandit optimization – Improved GP-UCB (IGP-UCB) and GP-Thomson sampling (GP-TS), and derive corresponding regret bounds. Specifically, the bounds hold when the expected reward function belongs to the reproducing kernel Hilbert space (RKHS) that naturally corresponds to a Gaussian process kernel used as input by the algorithms. Along the way, we derive a new self-normalized concentration inequality for vectorvalued martingales of arbitrary, possibly infinite, dimension. Finally, experimental evaluation and comparisons to existing algorithms on synthetic and real-world environments are carried out that highlight the favorable gains of the proposed strategies in many cases.",
    "creator" : "LaTeX with hyperref package"
  }
}