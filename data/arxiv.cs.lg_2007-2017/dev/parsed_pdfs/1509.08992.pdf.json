{
  "name" : "1509.08992.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Maximum Likelihood Learning With Arbitrary Treewidth via Fast-Mixing Parameter Sets",
    "authors" : [ "Justin Domke" ],
    "emails" : [ "justin.domke@nicta.com.au" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 9.\n08 99\n2v 1\n[ cs\n.L G\n] 3\n0 Se"
    }, {
      "heading" : "1 Introduction",
      "text" : "In undirected graphical models, maximum likelihood learning is intractable in general. For example, Jerrum and Sinclair [17] show that evaluation of the partition function (which can easily be computed from the likelihood) for an Ising model is #P-complete, and that even the existence of a fullypolynomial time randomized approximation scheme (FPRAS) for the partition function would imply that RP = NP.\nIf the model is well-specified (meaning that the target distribution falls in the assumed family) then there exist several methods that can efficiently recover correct parameters, among them the pseudolikelihood [3], score matching [16, 22], composite likelihoods [20, 30], Mizrahi et al.’s [23] method based on parallel learning in local clusters of nodes and Abbeel et al.’s [1] method based on matching local probabilities. While often useful, these methods have some drawbacks. First, these methods typically have inferior sample complexity to the likelihood. Second, these all assume a well-specified model. If the target distribution is not in the assumed class, the maximum-likelihood solution will converge to the M-projection (minimum of the KL-divergence), but these estimators do not have similar guarantees. Third, even when these methods succeed, they typically yield a distribution in which inference is still intractable, and so it may be infeasible to actually make use of the learned distribution.\nGiven these issues, a natural approach is to restrict the graphical model parameters to a tractable set Θ, in which learning and inference can be performed efficiently. The gradient of the likelihood is determined by the marginal distributions, whose difficulty is typically determined by the treewidth of the graph. Thus, probably the most natural tractable family is the set of tree-structured distri-\nbutions, where Θ = {θ : ∃tree T, ∀(i, j) 6∈ T, θij = 0}. The Chow-Liu algorithm [6] provides an efficient method for finding the maximum likelihood parameter vector θ in this set, by computing the mutual information of all empirical pairwise marginals, and finding the maximum spanning tree. Similarly, Heinemann and Globerson [13] give a method to efficiently learn high-girth models where correlation decay limits the error of approximate inference, though this will not converge to the M-projection when the model is mis-specified.\nThis paper considers a fundamentally different notion of tractability, namely a guarantee that Markov chain Monte Carlo (MCMC) sampling will quickly converge to the stationary distribution. Our fundamental result is that if Θ is such a set, and one can project onto Θ, then there exists a FPRAS for the maximum likelihood solution inside Θ. While inspired by graphical models, this result works entirely in the exponential family framework, and applies generally to any exponential family with bounded sufficient statistics.\nThe existence of a FPRAS is established by analyzing a common existing strategy for maximum likelihood learning of exponential families, namely gradient descent where MCMC is used to generate samples and approximate the gradient. It is natural to conjecture that, if the Markov chain is fast mixing, is run long enough, and enough gradient descent iterations are used, this will converge to nearly the optimum of the likelihood inside Θ, with high probability. This paper shows that this is indeed the case. A separate analysis is used for the ridge-regularized case (using strong convexity) and the unregularized case (which is merely convex)."
    }, {
      "heading" : "2 Setup",
      "text" : "Though notation is introduced when first used, the most important symbols are given here for more reference.\n• θ - parameter vector to be learned • Mθ - Markov chain operator corresponding to θ • θk - estimated parameter vector at k-th gradient descent iteration • qk = Mvθk−1r - approximate distribution sampled from at iteration k. (v iterations of the\nMarkov chain corresponding to θk−1 from arbitrary starting distribution r.)\n• Θ - constraint set for θ • f - negative log-likelihood on training data • L - Lipschitz constant for the gradient of f . • θ∗ = argminθ∈Θ f(θ) - minimizer of likelihood inside of Θ • K - total number of gradient descent steps • M - total number of samples drawn via MCMC • N - length of vector x. • v - number of Markov chain transitions applied for each sample • C,α - parameters determining the mixing rate of the Markov chain. (Equation 3) • Ra - sufficient statistics norm bound. • ǫf - desired optimization accuracy for f • ǫθ - desired optimization accuracy for θ • δ - permitted probability of failure to achieve a given approximation accuracy\nThis paper is concerned with an exponential family of the form\npθ(x) = exp(θ · t(x)−A(θ)), where t(x) is a vector of sufficient statistics, and the log-partition function A(θ) ensures normalization. An undirected model can be seen as an exponential family where t consists of indicator functions for each possible configuration of each clique [32]. While such graphical models motivate this work, the results are most naturally stated in terms of an exponential family and apply more generally.\nWe are interested in performing maximum-likelihood learning, i.e. minimizing, for a dataset z1, ..., zD,\nf(θ) = − 1 D\nD ∑\ni=1\nlog pθ(zi) + λ\n2 ‖θ‖22 = A(θ)− θ · t̄+\nλ 2 ‖θ‖22, (1)\nwhere we define t̄ = 1D ∑D i=1 t(zi). It is easy to see that the gradient of f takes the form\nf ′(θ) = Epθ [t(X)]− t̄+ λθ.\nIf one would like to optimize f using a gradient-based method, computing the expectation of t(X) with respect to pθ can present a computational challenge. With discrete graphical models, the expected value of t is determined by the marginal distributions of each factor in the graph. Typically, the computational difficulty of computing these marginal distributions is determined by the treewidth of the graph– if the graph is a tree, (or close to a tree) the marginals can be computed by the junction-tree algorithm [18]. One option, with high treewidth, is to approximate the marginals with a variational method. This can be seen as exactly optimizing a “surrogate likelihood” approximation of Eq. 1 [31].\nAnother common approach is to use Markov chain Monte Carlo (MCMC) to compute a sample {xi}Mi=1 from a distribution close to pθ, and then approximate Epθ [t(X)] by (1/M) ∑M i=1 t(xi). This strategy is widely used, varying in the model type, the sampling algorithm, how samples are initialized, the details of optimization, and so on [10, 25, 27, 24, 7, 33, 11, 2, 29, 5]. Recently, Steinhardt and Liang [28] proposed learning in terms of the stationary distribution obtained from a chain with a nonzero restart probability, which is fast-mixing by design.\nWhile popular, such strategies generally lack theoretical guarantees. If one were able to exactly sample from pθ, this could be understood simply as stochastic gradient descent. But, with MCMC, one can only sample from a distribution approximating pθ, meaning the gradient estimate is not only noisy, but also biased. In general, one can ask how should the step size, number of iterations, number of samples, and number of Markov chain transitions be set to achieve a convergence level.\nThe gradient descent strategy analyzed in this paper, in which one updates a parameter vector θk using approximate gradients is outlined and shown as a cartoon in Figure 1. Here, and in the rest of the paper, we use pk as a shorthand for pθk , and we let ek denote the difference between the estimated gradient and the true gradient f ′(θk−1). The projection operator is defined by ΠΘ[φ] = argminθ∈Θ ||θ − φ||2. We assume that the parameter set θ is constrained to a set Θ such that MCMC is guaranteed to mix at a certain rate (Section 3.1). With convexity, this assumption can bound the mean and variance\nof the errors at each iteration, leading to a bound on the sum of errors. With strong convexity, the error of the gradient at each iteration is bounded with high probability. Then, using results due to [26] for projected gradient descent with errors in the gradient, we show a schedule the number of iterations K , the number of samples M , and the number of Markov transitions v such that with high probability,\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f (θ∗) ≤ ǫf or ‖θK − θ∗‖2 ≤ ǫθ,\nfor the convex or strongly convex cases, respectively, where θ∗ ∈ argminθ∈Θ f(θ). The total number of Markov transitions applied through the entire algorithm, KMv grows as (1/ǫf)3 log(1/ǫf) for the convex case, (1/ǫ2θ) log(1/ǫ 2 θ) for the strongly convex case, and polynomially in all other parameters of the problem."
    }, {
      "heading" : "3 Background",
      "text" : ""
    }, {
      "heading" : "3.1 Mixing times and Fast-Mixing Parameter Sets",
      "text" : "This Section discusses some background on mixing times for MCMC. Typically, mixing times are defined in terms of the total-variation distance ‖p−q‖TV = maxA |p(A)−q(A)|, where the maximum ranges over the sample space. For discrete distributions, this can be shown to be equivalent to ‖p− q‖TV = 12 ∑\nx |p(x)− q(x)|. We assume that a sampling algorithm is known, a single iteration of which can be thought of an operator Mθ that transforms some starting distribution into another. The stationary distribution is pθ, i.e. limv→∞ Mvθq = pθ for all q. Informally, a Markov chain will be fast mixing if the total variation distance between the starting distribution and the stationary distribution decays rapidly in the length of the chain. This paper assumes that a convex set Θ and constants C and α are known such that for all θ ∈ Θ and all distributions q,\n‖Mvθq − pθ‖TV ≤ Cαv. (2) This means that the distance between an arbitrary starting distribution q and the stationary distribution pθ decays geometrically in terms of the number of Markov iterations v. This assumption is justified by the Convergence Theorem [19, Theorem 4.9], which states that if M is irreducible and aperiodic with stationary distribution p, then there exists constants α ∈ (0, 1) and C > 0 such that\nd(v) := sup q\n‖Mvq − p‖TV ≤ Cαv. (3)\nMany results on mixing times in the literature, however, are stated in a less direct form. Given a constant ǫ, the mixing time is defined by τ(ǫ) = min{v : d(v) ≤ ǫ}. It often happens that bounds on mixing times are stated as something like τ(ǫ) ≤ ⌈\na+ b ln 1ǫ ⌉\nfor some constants a and b. It follows from this that ‖Mvq − p‖TV ≤ Cαv with C = exp(a/b) and α = exp(−1/b). A simple example of a fast-mixing exponential family is the Ising model, defined for x ∈ {−1,+1}N as\np(x|θ) = exp\n\n\n∑\n(i,j)∈Pairs θijxixj +\n∑\ni\nθixi −A(θ)\n\n .\nA simple result for this model is that, if the maximum degree of any node is ∆ and |θij | ≤ β for all (i, j), then for univariate Gibbs sampling with random updates, τ(ǫ) ≤ ⌈ N log(N/ǫ)1−∆tanh(β)⌉ [19]. The algorithm discussed in this paper needs the ability to project some parameter vector φ onto Θ to find argminθ∈Θ ||θ−φ||2. Projecting a set of arbitrary parameters onto this set of fast-mixing parameters is trivial– simply set θij = β for θij > β and θij ← −β for θij < −β. For more dense graphs, it is known [12, 9] that, for a matrix norm ‖·‖ that is the spectral norm ‖·‖2, or induced 1 or infinity norms,\nτ(ǫ) ≤ ⌈ N log(N/ǫ)\n1− ‖R(θ)‖\n⌉\n(4)\nwhere Rij(θ) = |θij |. Domke and Liu [8] show how to perform this projection for the Ising model when ‖ · ‖ is the spectral norm ‖ · ‖2 with a convex optimization utilizing the singular value decomposition in each iteration.\nLoosely speaking, the above result shows that univariate Gibbs sampling on the Ising model is fastmixing, as long as the interaction strengths are not too strong. Conversely, Jerrum and Sinclair [17] exhibited an alternative Markov chain for the Ising model that is rapidly mixing for arbitrary interaction strengths, provided the model is ferromagnetic, i.e. that all interaction strengths are positive with θij ≥ 0 and that the field is unidirectional. This Markov chain is based on sampling in different “subgraphs world” state-space. Nevertheless, it can be used to estimate derivatives of the Ising model log-partition function with respect to parameters, which allows estimation of the gradient of the log-likelihood. Huber [15] provided a simulation reduction to obtain an Ising model sample from a subgraphs world sample.\nMore generally, Liu and Domke [21] consider a pairwise Markov random field, defined as\np(x|θ) = exp\n\n\n∑\ni,j\nθij(xi, xj) + ∑\ni\nθi(xi)−A(θ)\n\n ,\nand show that, if one defines Rij(θ) = maxa,b,c 12 |θij(a, b)−θij(a, c)|, then again Equation 4 holds. An algorithm for projecting onto the set Θ = {θ : ‖R(θ)‖ ≤ c} exists. There are many other mixing-time bounds for different algorithms, and different types of models [19]. The most common algorithms are univariate Gibbs sampling (often called Glauber dynamics in the mixing time literature) and Swendsen-Wang sampling. The Ising model and Potts models are the most common distributions studied, either with a grid or fully-connected graph structure. Often, the motivation for studying these systems is to understand physical systems, or to mathematically characterize phase-transitions in mixing time that occur as interactions strengths vary. As such, many existing bounds assume uniform interaction strengths. For all these reasons, these bounds typically require some adaptation for a learning setting."
    }, {
      "heading" : "4 Main Results",
      "text" : ""
    }, {
      "heading" : "4.1 Lipschitz Gradient",
      "text" : "For lack of space, detailed proofs are postponed to the appendix. However, informal proof sketches are provided to give some intuition for results that have longer proofs. Our first main result is that the regularized log-likelihood has a Lipschitz gradient.\nTheorem 1. The regularized log-likelihood gradient is L-Lipschitz with L = 4R22 + λ, i.e.\n‖f ′(θ)− f ′(φ)‖2 ≤ (4R22 + λ)‖θ − φ‖2.\nProof sketch. It is easy, by the triangle inequality, that ‖f ′(θ)−f ′(φ)‖2 ≤ ‖ dAdθ − dAdφ ‖2+λ‖θ−φ‖2. Next, using the assumption that ‖t(x)‖2 ≤ R2, one can bound that ‖ dAdθ − dAdφ ‖2 ≤ 2R2‖pθ−pφ‖TV . Finally, some effort can bound that ‖pθ − pφ‖TV ≤ 2R2‖θ − φ‖2."
    }, {
      "heading" : "4.2 Convex convergence",
      "text" : "Now, our first major result is a guarantee on the convergence that is true both in the regularized case where λ > 0 and the unregularized case where λ = 0.\nTheorem 2. With probability at least 1− δ, at long as M ≥ 3K/ log(1δ ), Algorithm 1 will satisfy\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ 8R 2 2\nKL\n( L‖θ0 − θ∗‖2 4R2 + log 1 δ + K√ M +KCαv )2 .\nProof sketch. First, note that f is convex, since the Hessian of f is the covariance of t(X) when λ = 0 and λ > 0 only adds a quadratic. Now, define the quantity dk = 1M ∑M m=1 t(X k m) −\nEqk [t(X)] to be the difference between the estimated expected value of t(X) under qk and the true value. An elementary argument can bound the expected value of ‖dk‖, while the Efron-Stein inequality can bounds its variance. Using both of these bounds in Bernstein’s inequality can then show that, with probability 1 − δ,\n∑K k=1 ‖dk‖ ≤ 2R2(K/ √ M + log 1δ ). Finally, we can observe\nthat ∑K k=1 ‖ek‖ ≤ ∑K k=1 ‖dk‖+ ∑K k=1 ‖Eqk [t(X)]−Epθk [t(X)]‖2. By the assumption on mixing speed, the last term is bounded by 2KR2Cαv . And so, with probability 1 − δ, ∑K k=1 ‖ek‖ ≤\n2R2(K/ √ M + log 1δ ) + 2KR2Cα\nv. Finally, a result due to Schmidt et al. [26] on the convergence of gradient descent with errors in estimated gradients gives the result.\nIntuitively, this result has the right character. If M grows on the order of K2 and v grows on the order of logK/(− logα), then all terms inside the quadratic will be held constant, and so if we set K of the order 1/ǫ, the sub-optimality will on the order of ǫ with a total computational effort roughly on the order of (1/ǫ)3 log(1/ǫ). The following results pursue this more carefully. Firstly, one can observe that a minimum amount of work must be performed.\nTheorem 3. For a, b, c, α > 0, if K,M, v > 0 are set so that 1K (a+ b K√ M +Kcαv)2 ≤ ǫ, then\nKMv ≥ a 4b2 ǫ3 log acǫ (− logα) .\nSince it must be true that a/ √ K + b √ K/M + √ Kcαv ≤ √ǫ, each of these three terms must also be at most √ ǫ, giving lower-bounds on K , M , and v. Multiplying these gives the result.\nNext, an explicit schedule for K, M , and v is possible, in terms of a convex set of parameters β1, β2, β3. Comparing this to the lower-bound above shows that this is not too far from optimal.\nTheorem 4. Suppose that a, b, c, α > 0. If β1 + β2 + β3 = 1, β1, β2, β3 > 0, then setting K = a 2\nβ2 1 ǫ , M = ( abβ1β2ǫ ) 2, v = log acβ1β3ǫ/(− logα) is sufficient to guarantee that 1 K (a + b K√ M +\nKcαv)2 ≤ ǫ with a total work of\nKMv = 1\nβ41β 2 2\na4b2\nǫ3 log acβ1β3ǫ (− logα) .\nSimply verify that the ǫ bound holds, and multiply the terms together.\nFor example, setting β1 = 0.66, β2 = 0.33 and β3 = 0.01 gives that KMv ≈ 48.4a 4b2 ǫ3 log ac ǫ +5.03 (− logα) . Finally, we can give an explicit schedule for K , M , and v, and bound the total amount of work that needs to be performed.\nTheorem 5. If D ≥ max ( ‖θ0 − θ∗‖2, 4R2L log 1δ ) , then for all ǫ there is a setting of K,M, v such that f( 1K ∑K k=1 θk)− f(θ∗) ≤ ǫf with probability 1− δ and\nKMv ≤ 32LR 2 2D 4\nβ41β 2 2ǫ 3 f(1 − α)\nlog 4DR2C\nβ1β3ǫf .\n[Proof sketch] This follows from setting K , M , and v as in Theorem 4 with a = L‖θ0 − θ∗‖2/(4R2) + log 1δ , b = 1, c = C, and ǫ = ǫfL/(8R22)."
    }, {
      "heading" : "4.3 Strongly Convex Convergence",
      "text" : "This section gives the main result for convergence that is true only in the regularized case where λ > 0. Again, the main difficulty in this proof is showing that the sum of the errors of estimated gradients at each iteration is small. This is done by using a concentration inequality to show that the error of each estimated gradient is small, and then applying a union bound to show that the sum is small. The main result is as follows.\nTheorem 6. When the regularization constant obeys λ > 0, with probability at least 1−δ Algorithm 1 will satisfy\n‖θK − θ∗‖2 ≤ (1− λ L )K‖θ0 − θ∗‖2 + L λ\n( √\nR2 2M\n(\n1 +\n√\n2 log K\nδ\n)\n+ 2R2Cα v\n)\n.\nProof sketch. When λ = 0, f is convex (as in Theorem 2) and so is strongly convex when λ > 0. The basic proof technique here is to decompose the error in a particular step as ‖ek+1‖2 ≤ ‖ 1M ∑M i=1 t(x k i )− Eqk [t(X)]‖2 + ‖Eqk [t(X)]− Epθk [t(X)]‖2. A multidimensional variant of Hoeffding’s inequality can bound the first term, with probability 1 − δ′ by R2(1 + √ 2 log 1δ )/ √ M , while our assumption on mixing speed can bound the second term by 2R2Cαv . Applying this to all iterations using δ′ = δ/K gives that all errors are simultaneously bounded as before. This can then be used in another result due to Schmidt et al. [26] on the convergence of gradient descent with errors in estimated gradients in the strongly convex case.\nA similar proof strategy could be used for the convex case where, rather than directly bounding the sum of the norm of errors of all steps using the Efron-Stein inequality and Bernstein’s bound, one could simply bound the error of each step using a multidimensional Hoeffding-type inequality, and then apply this with probability δ/K to each step. This yields a slightly weaker result than that shown in Theorem 2. The reason for applying a uniform bound on the errors in gradients here is that Schmidt et al.’s bound [26] on the convergence of proximal gradient descent on strongly convex functions depends not just on the sum of the norms of gradient errors, but a non-uniform weighted variant of these.\nAgain, we consider how to set parameters to guarantee that θK is not too far from θ∗ with a minimum amount of work. Firstly, we show a lower-bound.\nTheorem 7. Suppose a, b, c > 0. Then for anyK,M, v such that γKa+ b√ M\n√\nlog(K/δ)+cαv ≤ ǫ. it must be the case that\nKMv ≥ b 2 ǫ2 log aǫ log c ǫ (− log γ)(− logα) log ( log aǫ δ(− log γ) ) .\n[Proof sketch] This is established by noticing that γKa, b√ M\n√\nlog Kδ , and cα v must each be less\nthan ǫ, giving lower bounds on K , M , and v.\nNext, we can give an explicit schedule that is not too far off from this lower-bound. Theorem 8. Suppose that a, b, c, α > 0. If β1 + β2 + β3 = 1, βi > 0, then setting K =\nlog( aβ1ǫ)/(− log γ), M = b2\nǫ2β2 2\n(\n1 + √ 2 log(K/δ) )2 and v = log (\nc β3ǫ\n)\n/(− logα) is sufficient to guarantee that γKa+ b√\nM (1 +\n√\n2 log(K/δ)) + cαv ≤ ǫ with a total work of at most\nKMV ≤ b 2\nǫ2β22\nlog (\na β1ǫ\n) log (\nc β3ǫ\n)\n(− log γ)(− logα)\n\n1 +\n√\n2 log log( aβ1ǫ )\nδ(− log γ)\n\n\n2\n.\nFor example, if you choose β2 = 1/ √ 2 and β1 = β3 = (1 − 1/ √ 2)/2 ≈ 0.1464, then this varies from the lower-bound in Theorem 7 by a factor of two, and a multiplicative factor of 1/β3 ≈ 6.84 inside the logarithmic terms.\nCorollary 9. If we choose K ≥ Lλ log ( ‖θ0−θ‖2 β1ǫ ) , M ≥ L2R2 2ǫ2β2\n2 λ2\n(\n1 + √ 2 log(K/δ) )2\n, and v ≥ 1\n1−α log (2LR2C/(β3ǫλ)), then ‖θK − θ∗‖2 ≤ ǫθ with probability at least 1 − δ, and the total amount of work is bounded by\nKMv ≤ L 3R2\n2ǫ2θβ 2 2λ\n3(1 − α) log (‖θ0 − θ‖2\nβ1ǫθ\n)\n(\n1 +\n√\n2 log\n(\nL λδ log (‖θ0 − θ‖2 β1ǫθ ))\n)2\n."
    }, {
      "heading" : "5 Discussion",
      "text" : "An important detail in the previous results is that the convex analysis gives convergence in terms of the regularized log-likelihood, while the strongly-convex analysis gives convergence in terms of the parameter distance. If we drop logarithmic factors, the amount of work necessary for ǫf - optimality in the log-likelihood using the convex algorithm is of the order 1/ǫ3f , while the amount of work necessary for ǫθ - optimality using the strongly convex analysis is of the order 1/ǫ2θ. Though these quantities are not directly comparable, the standard bounds on sub-optimality for λ-strongly convex functions with L-Lipschitz gradients are that λǫ2θ/2 ≤ ǫf ≤ Lǫ2θ/2. Thus, roughly speaking, when regularized for the strongly-convex analysis shows that ǫf optimality in the log-likelihood can be achieved with an amount of work only linear in 1/ǫf ."
    }, {
      "heading" : "6 Example",
      "text" : "While this paper claims no significant practical contribution to practice, it is useful to visualize an example. Take an Ising model p(x) ∝ exp(∑(i,j)∈Pairs θijxixj) for xi ∈ {−1, 1} on a 4 × 4 grid with 5 random vectors as training data. The sufficient statistics are t(x) = {xixj |(i, j) ∈ Pairs}, and with 24 pairs, ‖t(x)‖2 ≤ R2 = √ 24. For a fast-mixing set, constrain |θij | ≤ .2 for all pairs. Since the maximum degree is 4, τ(ǫ) ≤ ⌈ N log(N/ǫ)1−4 tanh(.2)⌉ . Fix λ = 1, ǫθ = 2 and δ = 0.1. Though the theory above suggests the Lipschitz constant L = 4R22 + λ = 97, a lower value of L = 10 is used, which converged faster in practice (with exact or approximate gradients). Now, one can derive that ‖θ0 − θ∗‖2 ≤ D = √\n24× (2× .2)2, C = log(16) and α = exp(−(1 − 4 tanh .2)/16). Applying Corollary 9 with β1 = .01, β2 = .9 and β3 = .1 gives K = 46, M = 1533 and v = 561. Fig. 2 shows the results. In practice, the algorithm finds a solution tighter than the specified ǫθ, indicating a degree of conservatism in the theoretical bound."
    }, {
      "heading" : "7 Conclusions",
      "text" : "This section discusses some weaknesses of the above analysis, and possible directions for future work. Analyzing complexity in terms of the total sampling effort ignores the complexity of projection itself. Since projection only needs to be done K times, this time will often be very small in comparison to sampling time. (This is certainly true in the above example.) However, this might not be the case if the projection algorithm scales super-linearly in the size of the model.\nAnother issue to consider is how the samples are initialized. As far as the proof of correctness goes, the initial distribution r is arbitrary. In the above example, a simple uniform distribution was used. However, one might use the empirical distribution of the training data, which is equivalent to contrastive divergence [5]. It is reasonable to think that this will tend to reduce the mixing time when the pθ is close to the model generating the data. However, the number of Markov chain transitions v prescribed above is larger than typically used with contrastive divergence, and Algorithm 1 does not reduce the step size over time. While it is common to regularize to encourage fast mixing with contrastive divergence [14, Section 10], this is typically done with simple heuristic penalties. Further, contrastive divergence is often used with hidden variables. Still, this provides a bound for how closely a variant of contrastive divergence could approximate the maximum likelihood solution.\nThe above analysis does not encompass the common strategy for maximum likelihood learning where one maintains a “pool” of samples between iterations, and initializes one Markov chain at each iteration from each element of the pool. The idea is that if the samples at the previous iteration were close to pk−1 and pk−1 is close to pk, then this provides an initialization close to the current solution. However, the proof technique used here is based on the assumption that the samples xki at each iteration are independent, and so cannot be applied to this strategy."
    }, {
      "heading" : "Acknowledgements",
      "text" : "Thanks to Ivona Bezáková, Aaron Defazio, Nishant Mehta, Aditya Menon, Cheng Soon Ong and Christfried Webers. NICTA is funded by the Australian Government through the Dept. of Communications and the Australian Research Council through the ICT Centre of Excellence Program."
    }, {
      "heading" : "8 Background",
      "text" : ""
    }, {
      "heading" : "8.1 Optimization",
      "text" : "The main results in this paper rely strongly on the work of Schmidt et al. [26] on the convergence of proximal gradient methods with errors in estimated gradients. The first result used is the following theorem for the convergence of gradient descent on convex functions with errors in the estimated gradients.\nTheorem 10. (Special case of [26, Proposition 1]) Suppose that a function f is convex with an L-Lipshitz gradient (meaning ‖f ′(φ) − f ′(θ)‖2 ≤ L‖φ− θ‖2). If Θ is a closed convex set and one iterates\nθk ← ΠΘ [ θk−1 − 1\nL (f ′(θk−1) + ek)\n]\n,\nthen, defining θ∗ ∈ argminθ∈Θ f(θ), for all K ≥ 1, we have, for AK := ∑K k=1 ‖ek‖ L , that\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ L 2K (‖θ0 − θ∗‖2 + 2AK)2 .\nThis section will show that this is indeed a special case of .[26] To start with, we simply restate exactly the previous result [26, Proposition 1], with only trivial changes in notation.\nTheorem 11. Assume that:\n• f is convex and has L-Lipschitz continuous gradient\n• h is a lower semi-continuous proper convex function.\n• The function r = f + h attains it’s minimum at a certain θ∗ ∈ Rn.\n• θk is an ǫk-optimal solution, i.e. that L\n2 ‖θk − y‖2 + h(θk) ≤ ǫk + min θ∈Rn L 2 ‖θ − y‖2 + h(θ)\nwhere\ny = θk−1 − 1 L (f ′(θk−1) + ek) .\nThen, for all K ≥ 1, one has that\nr\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− r(θ∗) ≤ L 2K ( ‖θ0 − θ∗‖+ 2AK + √ 2BK\n)2\nwith\nAK =\nK ∑\nk=1\n(\n‖ek‖ L +\n√\n2ǫk L\n)\n, BK =\nK ∑\nk=1\nǫk K .\nThe first theorem follows from this one by setting h to be the indicator function for the set Θ, i.e.\nh(θ) =\n{\n0 θ ∈ Θ ∞ θ 6∈ Θ\nand assuming that ǫk = 0. By the convexity of Θ, h will be a lower semi-continuous proper convex function. Further, from the fact that Θ is closed, r will attain its minimum. Now, we verify that this\nresults in the theorem statement at the start of this section. θk takes the form\nθk = arg min θ∈Rn\nL 2 ‖θ − y‖2 + h(θ)\n= argmin θ∈Θ\n‖θ − y‖\n= argmin θ∈Θ\n‖θ − θk−1 + 1 L (f ′(θk−1) + ek) ‖\n= ΠΘ\n[\nθk−1 − 1 L (f ′(θk−1) + ek)\n]\n.\nWe will also use the following result for strongly-convex optimzation. The special case follows from the same construction used above.\nNext, consider the following result on optimization of strongly convex functions, which follows from [26] by a very similar argument.\nTheorem 12. (Special case of [26, Proposition 3]) Suppose that a function f is λ-strongly convex with an L-Lipshitz gradient (meaning ‖f ′(φ) − f ′(θ)‖2 ≤ L‖φ− θ‖2). If Θ is a closed convex set and one iterates\nθk ← ΠΘ [ θk−1 − 1\nL (f ′(θk−1) + ek)\n]\n,\nThen, defining θ∗ = argminθ∈Θ f(θ), for all K ≥ 1, we have, for Āk = ∑K k=1(1− λL )−k ‖ek‖ L that\n‖θK − θ∗‖2 ≤ (1 − λ\nL )K\n( ‖θ0 − θ∗‖2 + Āk )\nCorollary 13. Under the same conditions, if ‖ek‖ ≤ r for all k, then\n‖θK − θ∗‖2 ≤ (1− λ L )K‖θ0 − θ∗‖2 + rL λ\nProof. Using the fact that ∑K k=1 a −k = a−K ∑K−1 k=0 a k ≤ a−K ∑∞k=0 ak = a −K 1−a , we get that\nĀK ≤ r K ∑\nk=1\n(1 − λ L )−k ≤ rL λ (1− λ L )−K ,\nand therefore that\n‖θK − θ∗‖2 ≤ (1 − λ\nL )K\n(\n‖θ0 − θ∗‖2 + r L λ (1 − λ L )−K\n)\n."
    }, {
      "heading" : "8.2 Concentration Results",
      "text" : "Three concentration inequalities, are stated here for reference. The first is Bernstein’s inequality.\nTheorem 14. (Bernstein’s inequality) SupposeZ1, ..., ZK are independent with mean 0, that |Zk| ≤ c and that σ2i = V[Zi]. Then, if we define σ 2 = 1K ∑K k=1 σ 2 k,\nP\n[\n1\nK\nK ∑\nk=1\nZk > ǫ\n]\n≤ exp ( − Kǫ 2\n2σ2 + 2cǫ/3\n)\n.\nThe second is the following Hoeffding-type bound to control the difference between the expected value of t(X) and the estimated value using M samples.\nTheorem 15. If X1, ..., XM are independent variables with mean µ, and ‖Xi − µ‖ ≤ c, then for all ǫ ≥ 0, with probability at least 1− δ,\n‖X̄ − µ‖ ≤ √ c\n4M\n(\n1 +\n√\n2 log 1\nδ\n)\n.\nProof. Boucheron et al. [4, Ex. 6.3] show that, under the same conditions as stated, for all s ≥ √v,\nP\n[ ‖X̄ − µ‖ > s M ] ≤ exp (\n− (s− √ v)2\n2v\n)\n,\nwhere v = cM4 . We will fix δ, and solve for the appropriate s. If we set δ = exp(− (s−√v)2 2v ), then we have that s = √ 2v log 1δ + √ v, meaning that, with probability at least 1− δ,\n‖X̄ − µ‖ ≤ 1 M\n( √\n2 cM\n4 log\n1 δ +\n√\ncM\n4\n)\n,\nwhich is equivalent to the result with a small amount of manipulation.\nThe third is the Efron-Stein inequality [4, Theorem 3.1].\nTheorem 16. If X = (X1, ..., Xm) is a vector of independent random variables and f(X) is a square-integrable function, then\nV[f(X)] ≤ 1 2\nM ∑\ni=1\nE\n[\n( (f(X)− f(X(i)) )2\n]\n,\nwhere X(i) is X with Xi independently re-drawn, i.e.\nX(i) = (X1, ..., Xi−1, X ′ i′ , Xi+1, ..., Xm)."
    }, {
      "heading" : "9 Preliminary Results",
      "text" : "A result that we will use several times below is that, for 0 < α < 1, − 1log(α) ≤ 11−α . This bound is tight in the limit that α → 1. Lemma 17. The difference of two estimated mean vectors is bounded by\n‖Eq[t(X)]− Ep[t(X)]‖2 ≤ 2R2‖q − p‖TV .\nProof. Let the distribution functions of p and q be P and Q, respectively. Then, we have that\n‖E p [t(X)]− E q [t(X)]‖2 =\n∥ ∥ ∥ ∥ ˆ\nx\nt(x) (dP (x)− dQ(x)) ∥ ∥ ∥\n∥\n2\n≤ ˆ\nx\n|dP (x)− dQ(x)| · ‖t(x)‖2.\nUsing the definition of total-variation distance, and the bound that ‖t(x)‖2 ≤ R2 gives the result.\nLemma 18. If 1/a+ 1/b = 1, then the difference of two log-partition functions is bounded by\n|A(θ) −A(φ)| ≤ Ra‖θ − φ‖b.\nProof. By the Lagrange remainder theorem, there must exist some γ on the line segment between θ and φ such that A(φ) = A(θ)+ (φ− θ)T∇γA(γ). Thus, applying Hölder’s inequality, we have that\n|A(φ) −A(θ)| = |(φ− θ)T∇γA(γ)| ≤ ‖φ− θ‖b · ‖∇γA(γ)‖a. The result follows from the fact that ‖∇γA(γ)‖a = ‖Epγ t(X)‖a ≤ Ra.\nNext, we observe that the total variation distance between pθ and pφ is bounded by the distance between θ and φ.\nTheorem 19. If 1/a+ 1/b = 1, then the difference of distributions is bounded by\n‖pθ − pφ‖TV ≤ 2Ra‖θ − φ‖b.\nProof. If we assume that pθ is a density, we can decompose the total-variation distance as\n||pθ − pφ||TV\n= 1\n2\nˆ\nx\npθ(x)|1 − pφ(x)\npθ(x) |\n= 1\n2\nˆ\nx\npθ(x) |1− exp ((φ− θ) · t(x)−A(φ) +A(θ))|\n≤ 1 2\nˆ\nx\npθ(x) |1− exp |(φ− θ) · t(x)−A(φ) +A(θ)|| .\nIf pθ is a distribution, the analogous expression is true, replacing the integral over x with a sum.\nWe can upper-bound the quantity inside exp by applying Hölder’s inequality and the previous Lemma as\n|(φ − θ) · t(x) −A(φ) +A(θ))| ≤ |(φ− θ) · t(x)|+ |A(φ) −A(θ))| ≤ 2Ra‖θ − φ‖b.\nFrom which we have that\n‖pθ − pφ‖TV ≤ 1\n2 |1− exp (2Ra‖θ − φ‖b)| .\nIf 2Ra‖θ − φ‖b > 1, the theorem is obviously true, since ‖ · ‖TV ≤ 1. Suppose instead that that 2Ra‖θ− φ‖b ≤ 1. If 0 ≤ c ≤ 1, then 12 |1− exp(c)| ≤ c e−12 . Applying this with c = 2Ra‖θ− φ‖b gives that ||pθ−pφ||TV ≤ (e−1)R2||θ−φ||b. The result follows from the fact that 2 > (e−1)."
    }, {
      "heading" : "10 Lipschitz Continuity",
      "text" : "This section shows that the ridge-regularized empirical log-likelihood does indeed have a Lipschitz continuous gradient.\nTheorem 20. The regularized log-likelihood function is L-Lipschitz with L = 4R22 + λ, i.e.\n‖f ′(θ)− f ′(φ)‖2 ≤ (4R22 + λ)‖θ − φ‖2.\nProof. We start by the definition of the gradient, with\n‖f ′(θ)− f ′(φ)‖2 = ∥ ∥ ∥\n∥\n(\ndA dθ − t̄+ λθ\n) − ( dA\ndφ − t̄+ λφ\n)∥\n∥ ∥ ∥\n2\n= ‖dA dθ − dA dφ + λ(θ − φ)‖2.\n≤ ‖dA dθ − dA dφ ‖2 + λ‖θ − φ‖2.\nNow, looking at the first two terms, we can apply Lemma 17 to get that ∥\n∥ ∥ ∥\ndA dθ − dA dφ\n∥ ∥ ∥ ∥\n2\n= ∥ ∥Epθ [t(X)]− Epφ [t(X)] ∥ ∥\n2\n≤ 2R2‖pθ − pφ‖TV .\nObserving by Theorem 19 that ‖pθ − pφ‖TV ≤ 2R2‖θ − φ‖2 gives that\n‖f ′(θ)− f ′(φ)‖2 ≤ 4R22‖θ − φ‖2 + λ‖θ − φ‖2"
    }, {
      "heading" : "11 Convex Convergence",
      "text" : "This section gives the main result for convergence this is true both in the regularized case where λ > 0 and the unregularized case where λ = 0. The main difficulty in this proof is showing that the sum of the norms of the errors of estimated gradients is small.\nTheorem 21. Assuming that X1, ..., XM are independent and identically distributed with mean µ and that ‖Xm‖2 ≤ R2, then\nE\n[\n‖ 1 M\nM ∑\nm=1\nXm − µ‖2 ]\n≤ 2R2√ M\nProof. Using that E [ Z2 ] = V [Z] +E [Z]2and the fact that the variance is non-negative (Or simply Jensen’s inequality), we have\nE\n[\n‖ 1 M\nM ∑\nm=1\nXm − µ‖2 ]2 ≤ E [\n‖ 1 M\nM ∑\nm=1\nXm − µ‖22\n]\n= 1\nM E [ ‖Xm − µ‖22 ]\n≤ 1 M (2R2) 2 = 4R22 M .\nTaking the square-root gives the result.\nTheorem 22. Assuming that X1, ..., XM are iid with mean µ and that ‖Xm‖ ≤ R2, then\nV\n[\n‖ 1 M\nM ∑\nm=1\nXm − µ‖ ] ≤ 2R 2 2\nM .\nProof.\nV\n[\n‖ 1 M\nM ∑\nm=1\nXm − µ‖ ] = V [\n‖ 1 M\nM ∑\nm=1\n(Xm − µ)‖ ]\n= 1\nM2 V\n[\n‖ M ∑\nm=1\n(Xm − µ)‖ ]\nNow, the Efron-Stein inequality tells us that\nV[f(X1, ..., Xm)] ≤ 1\n2\nM ∑\nm′=1\nE\n[\n( (f(X)− f(X(m′)) )2\n]\nwhere X(m ′) is X with Xm′ independently re-drawn. Now, we identify f(X1, ..., Xm) = ‖∑Mm=1(Xm − µ)‖ to obtain that\nV\n[\n‖ M ∑\nm=1\n(Xm − µ)‖ ]\n≤ 1 2\nM ∑\nm′=1\nE\n\n\n(\n‖ M ∑\nm=1\n(Xm − µ)‖ − ‖ M ∑\nm=1\n(X(m ′) m − µ)‖ )2\n\n .\nFurther, since we know that\nM ∑\nm=1\n(X(m ′) m − µ) = M ∑\nm=1\n(Xm − µ) +X(m ′) m′ −Xm′ ,\nwe can apply that that (‖a+ b‖ − ‖a‖)2 ≤ ‖b‖2 to obtain that (\n‖ M ∑\nm=1\n(Xm − µ)‖ − ‖ M ∑\nm=1\n(X(m ′) m − µ)‖ )2 = ‖X(m ′) m′ −Xm′‖2,\nand so\nV\n[\n‖ M ∑\nm=1\n(Xm − µ)‖ ]\n≤ 1 2\nM ∑\nm′=1\nE\n[\n‖X(m ′) m′ −Xm′‖2 ] .\nAnd, since we assume that ‖Xm‖ ≤ R2, ‖X(m ′) m′ −Xm′‖ ≤ 2R2, which leads to\nV\n[\n‖ M ∑\nm=1\n(Xm − µ)‖ ] ≤ 2MR22,\nfrom which it follows that\nV\n[\n‖ 1 M\nM ∑\nm=1\nXm − µ‖ ] ≤ 2R 2 2\nM .\nTheorem 23. With probability at least 1− δ, K ∑\nk=1\n‖ 1 M\nM ∑\ni=1\nt(xki )− Eqk [t(X)]‖2 ≤ Kǫ(δ) + 2R2K√\nM ,\nwhere ǫ(δ) is the solution to\nδ = exp\n(\n− Kǫ 2\n4R22/M + 4R2ǫ/3\n)\n. (5)\nProof. Let dk = 1M ∑M i=1 t(x k i ) − Eqk [t(X)]. Applying Bernstein’s inequality immediately gives us that\nP\n[\n1\nK\nK ∑\nk=1\n(‖dk‖2 − E‖dk‖2) > ǫ ] ≤ exp ( − Kǫ 2\n2σ2 + 2cǫ/3\n)\n.\nHere, we can bound σ2 by\nσ2 = 1\nK\nK ∑\nk=1\nσ2k = 1\nK\nK ∑\nk=1\nV [‖dk‖2 − E‖dk‖2] = 1\nK\nK ∑\nk=1\nV [‖dk‖2] ≤ 2R22 M ,\nwhere the final inequality follows from Theorem 22. We also know that ‖dk‖ ≤ 2R2 = c, from which we get that\nP\n[\n1\nK\nK ∑\nk=1\n‖dk‖2 − E[‖dk‖2] > ǫ ] ≤ exp ( − Kǫ 2\n4R22/M + 4R2ǫ/3\n)\n.\nSo we have that, with probability 1− δ\n1\nK\nK ∑\nk=1\n‖dk‖2 − E[‖dk‖2] ≤ ǫ(δ)\n1\nK\nK ∑\nk=1\n‖dk‖2 ≤ ǫ(δ) + E[‖dk‖2]\n≤ ǫ(δ) + 2R2√ M ,\nwhere the final inequality follows from Theorem 21.\nCorollary 24. If M ≥ 3K/ log(1δ ), then with probability at least 1− δ, K ∑\nk=1\n‖ 1 M\nM ∑\ni=1\nt(xki )− Eqk [t(X)]‖2 ≤ 2R2 ( K√ M + log 1 δ ) .\nProof. Solving Equation 5 for ǫ yields that\nǫ(δ) = 2R2 3K\n\nlog 1\nδ +\n√\n(\nlog 1\nδ\n)2\n+ 9K log 1δ\nM\n\n .\nNow, suppose that 3KM ≤ log 1δ , as assumed here. Then,\nǫ(δ) ≤ 2R2 3K\n\nlog 1\nδ +\n√\n(\nlog 1\nδ\n)2\n+ 3(log 1\nδ )2\n\n\n≤ 2R2 3K\n(\nlog 1\nδ + 2 log(\n1 δ )\n)\n= 2R2 K log 1 δ .\nSubstituting this bound into the result of Theorem 23 gives the result.\nNow, we can prove the main result.\nTheorem 25. With probability at least 1− δ, at long as M ≥ 3K/ log(1δ ),\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ 8R 2 2\nKL\n( L‖θ0 − θ∗‖2 4R2 + log 1 δ + K√ M +KCαv )2 .\nProof. Applying Theorem 10 gives that\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ L 2K (‖θ0 − θ∗‖2 + 2AK)2 ,\nfor AK = 1L ∑K k=1 ‖ek‖, where\nek = 1\nM\nM ∑\ni=1\nt(xk−1i )− t̄+ λθk−1 − f ′(θk−1)\n= 1\nM\nM ∑\ni=1\nt(xk−1i )− Epk−1 [t(X)].\nNow, we know that\nK ∑\nk=1\n‖ek‖ ≤ K ∑\nk=1\n‖ 1 M\nM ∑\ni=1\nt(xk−1i )− Eqk−1 [t(X)]‖2 + K ∑\nk=1\n‖Eqk−1 [t(X)]− Epk−1 [t(X)]‖2.\nWe have by Lemma 17 and the assumption of mixing speed that\n‖Eqk−1 [t(X)]− Epk−1 [t(X)]‖2 ≤ 2R2‖qk−1 − pk−1‖TV ≤ 2R2Cαv . Meanwhile, the previous Corollary tells us that, with probability 1− δ,\nK ∑\nk=1\n‖ 1 M\nM ∑\ni=1\nt(xk−1i )− Eqk−1 [t(X)]‖2 ≤ 2R2 ( K√ M + log 1 δ )\nThus, we have that\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ L 2K\n(\n‖θ0 − θ∗‖2 + 2\nL\n(\n2R2\n(\nK√ M + log 1 δ\n)\n+ 2R2KCα v\n))2\n= L\n2K\n(\n‖θ0 − θ∗‖2 + 4R2 L\n(\nK√ M + log 1 δ +KCαv\n))2\n= 8R22 KL\n( L‖θ0 − θ∗‖2 4R2 + log 1 δ + K√ M +KCαv )2 .\nNow, what we really want to do is guarantee that f (\n1 K ∑K k=1 θk\n)\n− f(θ∗) ≤ ǫ, while ensuring the the total work MKv is not too large. Our analysis will use the following theorem.\nTheorem 26. Suppose that a, b, c, α > 0. If β1 + β2 + β3 = 1, β1, β2, β3 > 0, then setting\nK = a2\nβ21ǫ , M = (\nab\nβ1β2ǫ )2, v = log acβ1β3ǫ (− logα)\nis sufficient to guarantee that 1K\n(\na+ b K√ M\n+Kcαv )2 ≤ ǫ with a total work of\nKMv = 1\nβ41β 2 2\na4b2\nǫ3 log acβ1β3ǫ (− logα) .\nProof. Firstly, we should verify the ǫ bound. We have that\na+ b K√ M +Kcαv = a+ b a2 β21ǫ β1β2ǫ ab + a2 β21ǫ c β1β3ǫ ac\n= a+ a β2 β1 + a β3 β1 ,\nand hence that\n1\nK\n(\na+ b K√ M\n+Kcαv )2 = a2\nK\n(\n1 + β2 β1 + β3 β1\n)2\n= 1\nK\na2 β21 (β1 + β2 + β3) 2\n≤ ǫ.\nMultiplying together th terms gives the second part of the result.\nWe can also show that this solution is not too sub-optimal.\nTheorem 27. Suppose that a, b, c, α > 0. If K,M, v > 0 are set so that 1 K ( a+ b K√ M +Kcαv )2 ≤ ǫ, then\nKMv ≥ a 4b2 ǫ3 log acǫ (− logα) .\nProof. The starting condition is equivalent to stating that\na√ K + b\n√\nK M + √ Kcαv ≤ √ ǫ.\nSince all terms are positive, clearly each is less than √ ǫ. From this follows that\nK ≥ a 2\nǫ\nM ≥ b 2a2\nǫ2\nv ≥ log ac ǫ\n(− logα) .\nMultiplying these together gives the result.\nTheorem 28. If D ≥ max ( ‖θ0 − θ∗‖2, 4R2L log 1δ ) , then for all ǫ there is a setting of KMv such that f (\n1 K ∑K k=1 θk\n)\n− f(θ∗) ≤ ǫf with probability 1− δ and\nKMv ≤ 32LR 2 2D 4\nβ41β 2 2ǫ 3 f (1− α)\nlog 4DR2C\nβ1β3ǫf\n= O ( LR22D 4\nǫ3f (1− α) log\n1\nǫf\n)\n= Õ ( LR22D 4\nǫ3f (1− α)\n)\n.\nProof. So, we apply this to the original theorem. Our settings are\nf\n(\n1\nK\nK ∑\nk=1\nθk\n)\n− f(θ∗) ≤ 8R 2 2\nKL\n( L‖θ0 − θ∗‖2 4R2 + log 1 δ + K√ M +KCαv )2 .\na = L‖θ0 − θ∗‖2\n4R2 + log\n1\nδ\nb = 1\nc = C ǫ = ǫfL\n8R22\nNote that, by the definition of D, a ≤ LD2R2 and so ac ≤ LDC 2R2 . Thus, the total amount of work is\nKMv = 1\nβ41β 2 2\na4b2 ǫ3 log β1β3ǫac logα\n= 1\nβ41β 2 2\na4b2\nǫ3 log acβ1β3ǫ − logα\n≤ 1 β41β 2 2 1 ǫ3\n(\nLD\n2R2\n)4 log LDCβ1β32R2ǫ logα\n= 1\nβ41β 2 2 83R62 ǫ3fL 3\n(\nLD\n2R2\n)4 log LDC8R2 2\nβ1β32R2ǫfL\nlogα\n= 1\nβ41β 2 2 32LD4R22 ǫ3f log 4DR2Cβ1β3ǫf logα\n≤ 32LD 4R22\nβ41β 2 2ǫ\n3(1− α) log 4DR2C β1β3ǫ ."
    }, {
      "heading" : "12 Strongly Convex Convergence",
      "text" : "This section gives the main result for convergence this is true both only in the regularized case where λ > 0. Again, the main difficulty in this proof is showing that the sum of the norms of the errors of estimated gradients is small. This proof is relatively easier, as we simply bound all errors to be small with high probability, rather than jointly bounding the sum of errors.\nLemma 29. With probability at least 1− δ,\n‖ek+1‖2 ≤ R2√ M\n(\n1 +\n√\n2 log 1\nδ\n)\n+ 2R2Cα v\nProof. Once we have the difference of the distributions, we can go after the error in the gradient estimate. By definition,\n‖ek+1‖2 = ‖ 1\nM\nM ∑\ni=1\nt(xki )− Epθk [t(X)]‖2\n≤ ‖ 1 M\nM ∑\ni=1\nt(xki )− Eqk [t(X)]‖2\n+ ‖Eqk [t(X)]− Epθk [t(X)]‖2.\nConsider the second term. We know by Lemma 17 and the assumption of mixing speed\n‖Eqk [t(X)]− Epk [t(X)]‖2 ≤ 2R2‖qk − pk‖TV ≤ 2R2Cαv. (6)\nNow, consider the first term. We know that Eqk [t(X)] is the expected value of 1 M ∑M i=1 t(x k i ). We also know that ||t(xki ) − Eqk [t(X)]|| ≤ 2R2. Thus, we can apply Theorem 15 to get that, with probability 1− δ,\n∥ ∥ ∥ ∥ ∥ 1 M M ∑\ni=1\nt ( xki ) − Eqk [t(X)] ∥ ∥ ∥ ∥\n∥ ≤ R2√ M\n(\n1 +\n√\n2 log 1\nδ\n)\n. (7)\nAdding together Equations 6 and 7 gives the result.\nTheorem 30. With probability at least 1− δ,\n‖θK − θ∗‖2 ≤ (1 − λ L )K‖θ0 − θ∗‖2 + L λ\n( √\nR2 2M\n(\n1 +\n√\n2 log K\nδ\n)\n+ 2R2Cα v\n)\nProof. Apply the previous Lemma to bound bound on ‖ek+1‖2 with probability at least 1−δ′ where δ′ = δ/K . Then, plug this into the main optimization result in Corollary 13.\nTheorem 31. Suppose a, b, c > 0. Then for any K,M, v such that γKa+ b√ M\n√\nlog Kδ + cα v ≤ ǫ.\nit must be the case that\nKMv ≥ b 2 ǫ2 log aǫ log c ǫ (− log γ)(− logα) log ( log aǫ δ(− log γ) )\nProof. Clearly, we must have that each term is at most ǫ, yielding that\nK ≥ log ǫ a\nlog γ\nM ≥ b 2\nǫ2 log\nK δ ≥ b\n2\nǫ2 log log ǫa δ log γ\nv ≥ log(c/ǫ) (− logα)\nFrom this we obtain that\nKMv ≥ b 2 ǫ2 log aǫ log(c/ǫ) (− log γ)(− logα) log ( log aǫ δ(− log γ) ) .\nTheorem 32. Suppose that a, b, c, α > 0. If β1 + β2 + β3 = 1, βi > 0, then setting\nK = log( a\nβ1ǫ )/(− log γ)\nM = b2\nǫ2β22\n(\n1 +\n√\n2 log K\nδ\n)2\nv = log\n(\nc\nβ3ǫ\n)\n/(− logα)\nis sufficient to guarantee that γKa+ b√ M (1 +\n√\n2 log Kδ ) + cα v ≤ ǫ with a total work of at most\nKMV ≤ b 2\nǫ2β22\nlog (\na β1ǫ\n) log (\nc β3ǫ\n)\n(− log γ)(− logα)\n\n1 +\n√\n2 log log( aβ1ǫ)\nδ(− log γ)\n\n\n2\nProof. We define the errors so that\nγKa = ǫβ1\nb√ M (1 +\n√\n2 log K\nδ ) = ǫβ2\ncαv = ǫβ3.\nSolving, we obtain that\nK = log( a\nβ1ǫ )/(− log γ)\nM = b2\nǫ2β22\n(\n1 +\n√\n2 log K\nδ\n)2\nv = log\n(\nc\nβ3ǫ\n)\n/(− logα).\nThis yields that the final amount of work is\nKMv ≤ log\n(\na β1ǫ\n) log (\nc β3ǫ\n)\n(− log γ)(− logα) b2\nǫ2β22\n\n1 +\n√\n2 log log( aβ1ǫ)\nδ(− log γ)\n\n\n2\nRemark 33. For example, you might choose β2 = 12 , β1 = 1 4 and β3 = 1 4 , in which case the total amount of work is bounded by\nKMv ≤ 4b 2 ǫ2 log\n(\n4a ǫ\n) log ( 4c ǫ )\n(− log γ)(− logα)\n\n1 +\n√\n2 log log(4aǫ )\nδ(− log γ)\n\n\n2\n= 4b2\nǫ2\n( log ( a ǫ ) + log 4 ) (log ( 4c ǫ ) + log 4)\n(− log γ)(− logα)\n(\n1 +\n√\n2 log log(aǫ ) + log 4\nδ(− log γ)\n)2\nOr, if you choose β2 = 1/ √ 2 and β1 = β3 = (1− 1/ √ 2)/2 ≈ 0.1464, then you get the bound of\nKMV ≤ 2b 2\nǫ2\n(log ( a ǫ )\n+ 1.922)(log (\nc β3\n)\n+ 1.922)\n(− log γ)(− logα)\n(\n1 +\n√\n2 log log(aǫ ) + 1.922\nδ(− log γ)\n)2\nwhich is not too much worse than the lower-bound.\nCorollary 34. If we choose\nK ≥ L λ log (‖θ0 − θ‖2 β1ǫ )\nM ≥ L 2R2\n2ǫ2β22λ 2\n(\n1 +\n√\n2 log K\nδ\n)2\nv ≥ 1 1− α log\n(\n2LR2C\nβ3ǫλ\n)\nthen ‖θK − θ∗‖2 ≤ ǫ with probability at least 1− δ, and the total amount of work is bounded by\nKMv ≤ 1 ǫ2\n(\nL\nλ\n)3 R2\n2β22(1− α) log (‖θ0 − θ‖2 β1ǫ )\n(\n1 +\n√\n2 log\n(\nL λδ log (‖θ0 − θ‖2 β1ǫ ))\n)2\nProof. Apply the previous convergence theory to our setting. We equate\n(1−λ L )K‖θ0−θ∗‖2+ L λ\n( √\nR2 2M\n(\n1 +\n√\n2 log K\nδ\n)\n+ 2R2Cα v\n)\n= γKa+ b√ M (1+\n√\n2 log K\nδ )+cαv.\nThis requires the constants\nγ = 1− λ L a = ‖θ0 − θ‖2\nb = L\nλ\n√\nR2 2\nc = 2LR2C/λ\nThus, we will make the choices\nK = log( a\nβ1ǫ )/(− log γ)\n≤ log(‖θ0 − θ‖2 β1ǫ )/(1− γ)\n= L\nλ log( ‖θ0 − θ‖2 β1ǫ )\nM = b2\nǫ2β22\n(\n1 +\n√\n2 log K\nδ\n)2\n= L2R2\n2ǫ2β22λ 2\n(\n1 +\n√\n2 log K\nδ\n)2\nv = log\n(\nc\nβ3ǫ\n)\n/(− logα)\n= log\n(\n2LR2C\nβ3ǫλ\n)\n/(− logα)\n≤ 1 1− α log\n(\n2LR2C\nβ3ǫλ\n)\nThis means a total amount of work of\nKMv = = L\nλ log( ‖θ0 − θ‖2 β1ǫ ) L2R2 2ǫ2β22λ 2(1 − α)\n(\n1 +\n√\n2 log\n(\nL λδ log (‖θ0 − θ‖2 β1ǫ ))\n)2\nlog\n(\n2LR2C\nβ3ǫλ\n)\n= 1\nǫ2\n(\nL\nλ\n)3 R2\n2β22(1 − α) log (‖θ0 − θ‖2 β1ǫ )\n(\n1 +\n√\n2 log\n(\nL λδ log (‖θ0 − θ‖2 β1ǫ ))\n)2\n."
    } ],
    "references" : [ {
      "title" : "Learning factor graphs in polynomial time and sample complexity",
      "author" : [ "P. Abbeel", "D. Koller", "A. Ng" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2006
    }, {
      "title" : "Learning with blocks composite likelihood and contrastive divergence",
      "author" : [ "A. Asuncion", "Q. Liu", "A. Ihler", "P. Smyth" ],
      "venue" : "In AISTATS,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2010
    }, {
      "title" : "Statistical analysis of non-lattice data",
      "author" : [ "J. Besag" ],
      "venue" : "Journal of the Royal Statistical Society. Series D (The Statistician),",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 1975
    }, {
      "title" : "Concentration Inequalities: A Nonasymptotic Theory of Independence",
      "author" : [ "S. Boucheron", "G. Lugosi", "P. Massart" ],
      "venue" : null,
      "citeRegEx" : "4",
      "shortCiteRegEx" : "4",
      "year" : 2013
    }, {
      "title" : "On contrastive divergence learning",
      "author" : [ "M.A. Carreira-Peripiñán", "G. Hinton" ],
      "venue" : "In AISTATS,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2005
    }, {
      "title" : "Approximating discrete probability distributions with dependence trees",
      "author" : [ "C.I. Chow", "C.N. Liu" ],
      "venue" : "IEEE Transactions on Information Theory,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 1968
    }, {
      "title" : "Estimation of markov Random field prior parameters using Markov chain Monte Carlo maximum likelihood",
      "author" : [ "X. Descombes", "J.Z. Robin Morris", "M. Berthod" ],
      "venue" : "IEEE Transactions on Image Processing,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 1996
    }, {
      "title" : "Projecting Ising model parameters for fast mixing",
      "author" : [ "J. Domke", "X. Liu" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 2013
    }, {
      "title" : "Matrix norms and rapid mixing for spin systems",
      "author" : [ "M.E. Dyer", "L.A. Goldberg", "M. Jerrum" ],
      "venue" : "Ann. Appl. Probab.,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 2009
    }, {
      "title" : "Markov chain Monte Carlo maximum likelihood",
      "author" : [ "C. Geyer" ],
      "venue" : "In Symposium on the Interface,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 1991
    }, {
      "title" : "Maximum likelihood estimation for spatial models by Markov chain Monte Carlo stochastic approximation",
      "author" : [ "M.G. Gu", "Zhu", "H.-T" ],
      "venue" : "Journal of the Royal Statistical Society: Series B (Statistical Methodology),",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2001
    }, {
      "title" : "A simple condition implying rapid mixing of single-site dynamics on spin systems",
      "author" : [ "T. Hayes" ],
      "venue" : "In FOCS,",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2006
    }, {
      "title" : "Inferning with high girth graphical models",
      "author" : [ "U. Heinemann", "A. Globerson" ],
      "venue" : "In ICML,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2014
    }, {
      "title" : "A practical guide to training restricted boltzmann machines",
      "author" : [ "G. Hinton" ],
      "venue" : "Technical report, University of Toronto,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2010
    }, {
      "title" : "Simulation reductions for the ising model",
      "author" : [ "M. Huber" ],
      "venue" : "Journal of Statistical Theory and Practice,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2012
    }, {
      "title" : "Estimation of non-normalized statistical models by score matching",
      "author" : [ "A. Hyvärinen" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2005
    }, {
      "title" : "Polynomial-time approximation algorithms for the ising model",
      "author" : [ "M. Jerrum", "A. Sinclair" ],
      "venue" : "SIAM Journal on Computing,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 1993
    }, {
      "title" : "Probabilistic Graphical Models: Principles and Techniques",
      "author" : [ "D. Koller", "N. Friedman" ],
      "venue" : null,
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 2009
    }, {
      "title" : "Composite likelihood methods",
      "author" : [ "B. Lindsay" ],
      "venue" : "Contemporary Mathematics,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 1988
    }, {
      "title" : "Projecting Markov random field parameters for fast mixing",
      "author" : [ "X. Liu", "J. Domke" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2014
    }, {
      "title" : "Asymptotic efficiency of deterministic estimators for discrete energy-based models: Ratio matching and pseudolikelihood",
      "author" : [ "B. Marlin", "N. de Freitas" ],
      "venue" : "In UAI,",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 2011
    }, {
      "title" : "Linear and parallel learning of markov random fields",
      "author" : [ "Y. Mizrahi", "M. Denil", "N. de Freitas" ],
      "venue" : "In ICML,",
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2014
    }, {
      "title" : "Perturb-and-map random fields: Using discrete optimization to learn and sample from energy models",
      "author" : [ "G. Papandreou", "A.L. Yuille" ],
      "venue" : "In ICCV,",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2011
    }, {
      "title" : "Learning in Markov random fields using tempered transitions",
      "author" : [ "R. Salakhutdinov" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 2009
    }, {
      "title" : "Convergence rates of inexact proximal-gradient methods for convex optimization",
      "author" : [ "M. Schmidt", "N.L. Roux", "F. Bach" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "26",
      "shortCiteRegEx" : "26",
      "year" : 2011
    }, {
      "title" : "A generative perspective on MRFs in low-level vision",
      "author" : [ "U. Schmidt", "Q. Gao", "S. Roth" ],
      "venue" : "In CVPR,",
      "citeRegEx" : "27",
      "shortCiteRegEx" : "27",
      "year" : 2010
    }, {
      "title" : "Learning fast-mixing models for structured prediction",
      "author" : [ "J. Steinhardt", "P. Liang" ],
      "venue" : "In ICML,",
      "citeRegEx" : "28",
      "shortCiteRegEx" : "28",
      "year" : 2015
    }, {
      "title" : "Training restricted Boltzmann machines using approximations to the likelihood gradient",
      "author" : [ "T. Tieleman" ],
      "venue" : "In ICML,",
      "citeRegEx" : "29",
      "shortCiteRegEx" : "29",
      "year" : 2008
    }, {
      "title" : "An overview of composite likelihood methods",
      "author" : [ "C. Varin", "N. Reid", "D. Firth" ],
      "venue" : "Statistica Sinica,",
      "citeRegEx" : "30",
      "shortCiteRegEx" : "30",
      "year" : 2011
    }, {
      "title" : "Estimating the \"wrong\" graphical model: Benefits in the computation-limited setting",
      "author" : [ "M. Wainwright" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "31",
      "shortCiteRegEx" : "31",
      "year" : 2006
    }, {
      "title" : "Graphical models, exponential families, and variational inference",
      "author" : [ "M. Wainwright", "M. Jordan" ],
      "venue" : "Found. Trends Mach. Learn.,",
      "citeRegEx" : "32",
      "shortCiteRegEx" : "32",
      "year" : 2008
    }, {
      "title" : "Filters, random fields and maximum entropy (FRAME): Towards a unified theory for texture modeling",
      "author" : [ "S.C. Zhu", "Y. Wu", "D. Mumford" ],
      "venue" : "International Journal of Computer Vision,",
      "citeRegEx" : "33",
      "shortCiteRegEx" : "33",
      "year" : 1998
    } ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "Inference is typically intractable in high-treewidth undirected graphical models, making maximum likelihood learning a challenge. One way to overcome this is to restrict parameters to a tractable set, most typically the set of tree-structured parameters. This paper explores an alternative notion of a tractable set, namely a set of “fast-mixing parameters” where Markov chain Monte Carlo (MCMC) inference can be guaranteed to quickly converge to the stationary distribution. While it is common in practice to approximate the likelihood gradient using samples obtained from MCMC, such procedures lack theoretical guarantees. This paper proves that for any exponential family with bounded sufficient statistics, (not just graphical models) when parameters are constrained to a fast-mixing set, gradient descent with gradients approximated by sampling will approximate the maximum likelihood solution inside the set with high-probability. When unregularized, to find a solution ǫ-accurate in log-likelihood requires a total amount of effort cubic in 1/ǫ, disregarding logarithmic factors. When ridge-regularized, strong convexity allows a solution ǫ-accurate in parameter distance with effort quadratic in 1/ǫ. Both of these provide of a fully-polynomial time randomized approximation scheme.",
    "creator" : "LaTeX with hyperref package"
  }
}