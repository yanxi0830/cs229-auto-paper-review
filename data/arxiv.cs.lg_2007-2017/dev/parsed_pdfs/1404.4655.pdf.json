{
  "name" : "1404.4655.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Hierarchical Quasi-Clustering Methods for Asymmetric Networks",
    "authors" : [ "Gunnar Carlsson", "Facundo Mémoli", "Alejandro Ribeiro", "Santiago Segarra" ],
    "emails" : [ "GUNNAR@MATH.STANFORD.EDU", "MEMOLI@MATH.OSU.EDU", "ARIBEIRO@SEAS.UPENN.EDU", "SSEGARRA@SEAS.UPENN.EDU" ],
    "sections" : [ {
      "heading" : "1. Introduction",
      "text" : "Given a network of interactions, hierarchical clustering methods determine a dendrogram, i.e. a family of nested partitions indexed by a resolution parameter. Clusters that arise at a given resolution correspond to sets of nodes that are more similar to each other than to the rest and, as such, can be used to study the formation of groups and communities (Shi & Malik, 2000; Newman & Girvan, 2002; 2004; Von Luxburg, 2007; Ng et al., 2002; Lance & Williams, 1967; Jain & Dubes, 1988). For asymmetric networks, in which the dissimilarity from node x to node x′ may differ from the one from x′ to x (Saito & Yadohisa, 2004), the determination of said clusters is not a straightforward generalization of the methods used to cluster symmetric\nProceedings of the 31 st International Conference on Machine Learning, Beijing, China, 2014. JMLR: W&CP volume 32. Copyright 2014 by the author(s).\ndatasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).\nThis difficulty motivates formal developments whereby hierarchical clustering methods are constructed as those that are admissible with respect to some reasonable properties (Carlsson & Mémoli, 2010; 2013; Carlsson et al., 2013). A fundamental distinction between symmetric and asymmetric networks is that while it is easy to obtain uniqueness results for the former (Carlsson & Mémoli, 2010), there are a variety of methods that are admissible for the latter (Carlsson et al., 2013). Although one could conceive of imposing further restrictions to winnow the space of admissible methods for clustering asymmetric networks, it is actually reasonable that multiple methods should exist. Since dendrograms are symmetric structures one has to make a decision as to how to derive symmetry from an asymmetric dataset and there are different stages of the clustering process at which such symmetrization can be carried out (Carlsson et al., 2013). In a sense, there is a fundamental mismatch between having a network of asymmetric relations as input and a symmetric dendrogram as output.\nThis paper develops a generalization of dendrograms and hierarchical clustering methods to allow for asymmetric output structures. We refer to these asymmetric structures as quasi-dendrograms and to the procedures that generate them as hierarchical quasi-clustering methods. Since the symmetry in dendrograms can be traced back to the symmetry of equivalence relations we start by defining a quasi-equivalence relation as one that is reflexive and transitive but not necessarily symmetric (Section 3). We then define a quasi-partition as the structure induced by a quasi-equivalence relation, a quasi-dendrogram as a nested collection of quasi-partitions, and a hierarchical quasiclustering method as a map from the space of networks to the space of quasi-dendrograms (Section 3.1). Quasi-\nar X\niv :1\n40 4.\n46 55\nv1 [\ncs .L\nG ]\n1 7\nA pr\npartitions are similar to regular partitions in that they contain disjoint blocks of nodes but they also include an influence structure between the blocks derived from the asymmetry in the original network. This influence structure defines a partial order over the blocks (Harzheim, 2005).\nWe proceed to study admissibility of quasi-clustering methods with respect to the directed axioms of value and transformation. The Directed Axiom of Value states that the quasi-clustering of a network of two nodes is the network itself. The Directed Axiom of Transformation states that reducing dissimilarities cannot lead to looser quasiclusters. We show that there is a unique quasi-clustering method admissible with respect to these axioms and that this method is an asymmetric version of the single linkage clustering method (Section 3.4). The analysis in this section hinges upon an equivalence between quasidendrograms and quasi-ultrametrics (Section 3.2) that generalizes the well-known equivalence between dendrograms and ultrametrics (Jardine & Sibson, 1971).\nExploiting the fact that quasi-dendrograms can be represented by quasi-ultrametrics, we propose a quantitative notion of stability of quasi-clustering methods (Section 3.5). We prove that the unique method from Section 3.4 is stable in the sense that we propose. We also establish several invariance properties enjoyed by this method.\nIn order to apply the quasi-clustering method to real data, we derive an algorithm based on matrix powers in a dioid algebra (Gondran & Minoux, 2008) (Section 3.6). As an example, we cluster a network that contains information about the internal migration between states of the United States for the year 2011 (Section 4). The quasi-clustering output unveils that migration is dominated by geographical proximity. Moreover, by exploiting the asymmetric influence between clusters, one can show the migrational influence of California over the West Coast.\nProofs of results in this paper not contained in the main body can be found in the supplementary material."
    }, {
      "heading" : "2. Preliminaries",
      "text" : "A network N is a pair (X,AX) where X is a finite set of points or nodes and AX : X × X → R+ is a dissimilarity function. The value AX(x, x′) is assumed to be nonnegative for all pairs (x, x′) ∈ X × X and 0 if and only if x = x′. However, AX need not satisfy the triangle inequality and, more consequential for the problem considered here, may be asymmetric in that it is possible to have AX(x, x\n′) 6= AX(x′, x) for some x 6= x′. We further define N as the set of all networks. Networks N ∈ N can have different node setsX and different dissimilaritiesAX .\nA conventional non-hierarchical clustering of the set X is\na partition P , i.e., a collection of sets P = {B1, . . . , BJ} which are pairwise disjoint, Bi ∩Bj = ∅ for i 6= j, and required to cover X , ∪Ji=1Bi = X . The sets B1, B2, . . . BJ are called the blocks of P and represent clusters. A partition P = {B1, . . . , BJ} of X induces and is induced by an equivalence relation∼ onX such that for all x, x′, x′′ ∈ X we have that x ∼ x, x ∼ x′ if and only if x′ ∼ x, and x ∼ x′ combined with x′ ∼ x′′ implies x ∼ x′′. In hierarchical clustering methods the output is not a single partition P but a nested collection DX of partitions DX(δ) of X indexed by a resolution parameter δ ≥ 0. For a given DX , we say that two nodes x and x′ are equivalent at resolution δ ≥ 0 and write x ∼DX(δ) x′ if and only if nodes x and x′ are in the same cluster of DX(δ). The nested collection DX is termed a dendrogram (Jardine & Sibson, 1971). The interpretation of a dendrogram is that of a structure which yields different clusterings at different resolutions. At resolution δ = 0 each point is in a cluster of its own and as the resolution parameter δ increases, nodes start forming clusters. We denote by [x]δ the equivalence class to which the node x ∈ X belongs at resolution δ, i.e. [x]δ := {x′ ∈ X\n∣∣x ∼DX(δ) x′}. In our development of hierarchical quasi-clustering methods, the concepts of chain and chain cost are important. Given a network (X,AX) and x, x′ ∈ X , a chain C(x, x′) is an ordered sequence of nodes in X ,\nC(x, x′) = [x = x0, x1, . . . , xl−1, xl = x ′], (1)\nwhich starts at x and ends at x′. We say that C(x, x′) links or connects x to x′. The links of a chain are the edges connecting consecutive nodes of the chain in the direction given by the chain. We define the cost of a chain (1) as the maximum dissimilarity maxi|xi∈C(x,x′)AX(xi, xi+1) encountered when traversing its links in order."
    }, {
      "heading" : "3. Quasi-Clustering methods",
      "text" : "A partition P = {B1, . . . , BJ} of a set X can be interpreted as a reduction in data complexity in which variations between elements of a group are neglected in favor of the larger dissimilarities between elements of different groups. This is natural when clustering datasets endowed with symmetric dissimilarities because the concepts of a node x ∈ X being close to another node x′ ∈ X and x′ being close to x are equivalent. In an asymmetric network these concepts are different and this difference motivates the definition of structures more general than partitions.\nConsidering that a partition P = {B1, . . . , BJ} of X is induced by an equivalence relation ∼ on X we search for the equivalent of an asymmetric partition by removing the symmetry property in the definition of the equivalence relation. Thus, we define a quasi-equivalence as a binary relation that satisfies the reflexivity and transitivity proper-\nties but is not necessarily symmetric as stated next.\nDefinition 1 A binary relation between elements of a set X is a quasi-equivalence if and only if the following properties hold true for all x, x′, x′′ ∈ X:\n(i) Reflexivity. Points are quasi-equivalent to themselves, x x. (ii) Transitivity. If x x′ and x′ x′′ then x x′′.\nQuasi-equivalence relations are more often termed preorders or quasi-orders in the literature (Harzheim, 2005). We choose the term quasi-equivalence to emphasize that they are a modified version of an equivalence relation.\nWe define a quasi-partition of the set X as a directed, unweighted graph P̃ = (P,E) with no self-loops where the vertex set P is a partition P = {B1, . . . , BJ} of the space X and the edge set E ⊆ P × P is such that the following properties are satisfied (see Fig. 1):\n(QP1) Unidirectionality. For any given pair of distinct blocks Bi, Bj ∈ P we have at most one edge between them. Thus, if for some i 6= j we have (Bi, Bj) ∈ E then (Bj , Bi) /∈ E.\n(QP2) Transitivity. If there are edges between blocks Bi and Bj and between blocks Bj and Bk, then there is an edge between blocks Bi and Bk.\nThe vertex set P of a quasi-partition P̃ = (P,E) represents sets of nodes that can influence each other, whereas the edges inE capture the notion of directed influence from one group to the next. In the example in Fig. 1, nodes which are drawn together can exert influence on each other. This gives rise to the blocks Bi which form the vertex set P of the quasi-partition. Additionally, some blocks have influence over others in only one direction. E.g., block B1\ncan influence B4 but not vice versa. This latter fact motivates keeping B1 and B4 as separate blocks in the partition whereas the former motivates the addition of the directed influence edge (B1, B4). Likewise, B1 can influence B3, B2 can influence B3 and B4 can influence B5 but none of these influences are true in the opposite direction. Block B1 need not be able to directly influence B5, but can influence it through B4, hence the edge from B1 to B5, in accordance with (QP2). All other influence relations are not meaningful, justifying the lack of connections between the other blocks. Observe that there are no bidirectional edges as required by (QP1).\nRequirements (QP1) and (QP2) in the definition of quasipartition represent the relational structure that emerges from quasi-equivalence relations as we state in the following proposition.\nProposition 1 Given a node set X and a quasiequivalence relation on X [cf. Definition 1] define the relation↔ on X as\nx↔ x′ ⇐⇒ x x′ and x′ x, (2)\nfor all x, x′ ∈ X . Then,↔ is an equivalence relation. Let P = {B1, . . . , BJ} be the partition of X induced by ↔. Define E ⊆ P × P such that for all distinct Bi, Bj ∈ P\n(Bi, Bj) ∈ E ⇐⇒ xi xj , (3)\nfor some xi ∈ Bi and xj ∈ Bj . Then, P̃ = (P,E) is a quasi-partition of X . Conversely, given a quasi-partition P̃ = (P,E) of X , define the binary relation on X so that for all x, x′ ∈ X\nx x′ ⇐⇒ [x] = [x′] or ([x], [x′]) ∈ E, (4)\nwhere [x] ∈ P is the block of the partition P that contains the node x and similarly for [x′]. Then, is a quasiequivalence on X .\nProof: See Theorem 4.9, Ch. 1.4 in (Harzheim, 2005).\nIn the same way that an equivalence relation induces and is induced by a partition on a given node set X , Proposition 1 shows that a quasi-equivalence relation induces and is induced by a quasi-partition on X . We can then adopt the construction of quasi-partitions as the natural generalization of clustering problems when given asymmetric data. Further, observe that if the edge set E contains no edges, P̃ = (P,E) is equivalent to the regular partition P when ignoring the empty edge set. In this sense, partitions are particular cases of quasi-partitions having the generic form P̃ = (P, ∅). To allow generalizations of hierarchical clustering methods with asymmetric outputs we introduce the notion of quasi-dendrogram in the following section."
    }, {
      "heading" : "3.1. Quasi-dendrograms",
      "text" : "Given that a dendrogram is defined as a nested set of partitions, we define a quasi-dendrogram D̃X of the set X as a collection of nested quasi-partitions D̃X(δ) = (DX(δ), EX(δ)) indexed by a resolution parameter δ ≥ 0. Recall the definition of [x]δ from Section 2. Formally, for D̃X to be a quasi-dendrogram we require the following conditions:\n(D̃1) Boundary conditions. At resolution δ = 0 all nodes are in separate clusters with no edges between them and for some δ0 sufficiently large all elements of X are in a single cluster,\nD̃X(0) = ({ {x}, x ∈ X } , ∅ ) ,\nD̃X(δ0) = ( {X}, ∅ ) for some δ0 ≥ 0. (5)\n(D̃2) Equivalence hierarchy. For any pair of points x, x′ for which x ∼DX(δ1) x′ at resolution δ1 we must have x ∼DX(δ2) x′ for all resolutions δ2 > δ1.\n(D̃3) Influence hierarchy. If there is an edge ([x]δ1 , [x\n′]δ1) ∈ EX(δ1) between the equivalence classes [x]δ1 and [x ′]δ1 of nodes x and x ′ at resolution δ1, at any resolution δ2 > δ1 we either have ([x]δ2 , [x ′]δ2) ∈ EX(δ2) or [x]δ2 = [x ′]δ2 .\n(D̃4) Right continuity. For all δ ≥ 0 there exists > 0 such that D̃X(δ) = D̃X(δ′) for all δ′ ∈ [δ, δ + ].\nRequirement (D̃1) states that for resolution δ = 0 there should be no influence between any pair of nodes and that, for a large enough resolution δ = δ0, there should be enough influence between the nodes for all of them to belong to the same cluster. According to (D̃2), nodes become ever more clustered since once they join together in a cluster, they stay together in the same cluster for all larger resolutions. Condition (D̃3) states for the edge set the analogous requirement that (D̃2) states for the node set. If there is an edge present at a given resolution δ1, that edge should persist at coarser resolutions δ2 > δ1 except if the groups linked by the edge merge in a single cluster. Requirement (D̃4) is a technical condition that ensures the correct definition of a hierarchical structure [cf. (8) below].\nComparison of (D̃1), (D̃2), and (D̃4) with the three properties defining a dendrogram (Carlsson & Mémoli, 2010) implies that given a quasi-dendrogram D̃X = (DX , EX) on a node set X , the component DX is a dendrogram on X . I.e, the vertex sets DX(δ) of the quasi-partitions (DX(δ), EX(δ)) for varying δ form a nested set of parti-\ntions. Hence, if the edge set EX(δ) = ∅ for every resolution parameter, D̃X recovers the structure of the dendrogramDX . Thus, quasi-dendrograms are a generalization of dendrograms, or, equivalently, dendrograms are particular cases of quasi-dendrograms with empty edge sets. Regarding dendrograms DX as quasi-dendrograms (DX , ∅) with empty edge sets, we have that the set of all dendrograms D is a subset of D̃, the set of all quasi-dendrograms.\nA hierarchical clustering methodH : N → D is defined as a map from the space of networks N to the space of dendrograms D. This motivates the definition of a hierarchical quasi-clustering method as follows.\nDefinition 2 A hierarchical quasi-clustering method H̃ is defined as a map from the space of networksN to the space of quasi-dendrograms D̃,\nH̃ : N → D̃. (6)\nSince D ⊂ D̃ we have that every clustering method is a quasi-clustering method but not vice versa. Our goal here is to study quasi-clustering methods satisfying desirable axioms that define the concept of admissibility. In order to facilitate this analysis, we introduce quasi-ultrametrics as asymmetric versions of ultrametrics and show their equivalence to quasi-dendrograms in the following section.\nRemark 1 Unidirectionality (QP1) ensures that no cycles containing exactly two nodes can exist in any quasipartition P̃ = (P,E). If there were longer cycles, transitivity (QP2) would imply that every two distinct nodes in a longer cycle would have to form a two-node cycle, contradicting (QP1). Thus, conditions (QP1) and (QP2) imply that every quasi-partition P̃ = (P,E) is a directed acyclic graph (DAG). The fact that a DAG represents a partial order shows that our construction of a quasi-partition from a quasi-equivalence relation is consistent with the known set theoretic construction of a partial order on a partition of a set given a preorder on the set (Harzheim, 2005)."
    }, {
      "heading" : "3.2. Quasi-ultrametrics",
      "text" : "Given a node setX , a quasi-ultrametric ũX onX is a function ũX : X×X → R+ satisfying the identity property and the strong triangle inequality as we formally define next.\nDefinition 3 Given a node set X , a quasi-ultrametric ũX is a non-negative function ũX : X × X → R+ satisfying the following properties for all x, x′, x′′ ∈ X.:\n(i) Identity. ũX(x, x′) = 0 if and only if x = x′. (ii) Strong triangle inequality. ũX satisfies\nũX(x, x ′) ≤ max(ũX(x, x′′), ũX(x′′, x′)). (7)\nQuasi-ultrametrics may be regarded as ultrametrics where the symmetry property is not imposed. In particular, the space Ũ of quasi-ultrametric networks, i.e. networks with quasi-ultrametrics as dissimilarity functions, is a superset of the space of ultrametric networks U ⊂ Ũ . See (Gurvich & Vyalyi, 2012) for a study of some structural properties of quasi-ultrametrics.\nThe following constructions and theorem establish a structure preserving equivalence between quasi-dendrograms and quasi-ultrametrics.\nConsider the map Ψ : D̃ → Ũ defined as follows: for a given quasi-dendrogram D̃X = (DX , EX) over the set X write Ψ(D̃X) = (X, ũX), where we define ũX(x, x′) for each x, x′ ∈ X as the smallest resolution δ at which either both nodes belong to the same equivalence class [x]δ = [x\n′]δ , i.e. x ∼DX(δ) x′, or there exists an edge in EX(δ) from the equivalence class [x]δ to the equivalence class [x′]δ ,\nũX(x, x ′) := min { δ ≥ 0 ∣∣∣ (8) [x]δ = [x ′]δ or ([x]δ, [x′]δ) ∈ EX(δ) } .\nWe also consider the map Υ : Ũ → D̃ constructed as follows: for a given quasi-ultrametric ũX on the set X and each δ ≥ 0 define the relation ∼ũX(δ) on X as\nx ∼ũX(δ) x ′ ⇐⇒ max ( ũX(x, x ′), ũX(x ′, x) ) ≤ δ. (9)\nDefine further DX(δ) := { X mod ∼ũX(δ) } and the edge set EX(δ) for every δ ≥ 0 as follows: B1 6= B2 ∈ DX(δ) are such that\n(B1, B2) ∈ EX(δ) ⇐⇒ min x1∈B1 x2∈B2 ũX(x1, x2) ≤ δ. (10)\nFinally, Υ(X, ũX) := D̃X , where D̃X := (DX , EX).\nTheorem 1 The maps Ψ : D̃ → Ũ and Υ : Ũ → D̃ are both well defined. Furthermore, Ψ ◦Υ is the identity on Ũ and Υ ◦Ψ is the identity on D̃.\nTheorem 1 implies that every quasi-dendrogram D̃X has an equivalent representation as a quasi-ultrametric network defined on the same underlying node set X . This result allows us to reinterpret hierarchical quasi-clustering methods [cf. (6)] as maps H̃ : N → Ũ , (11) from the space of networks to the space of quasi-ultrametric networks. Apart from the theoretical importance of Theorem 1, this equivalence result is of practical importance since quasi-ultrametrics are mathematically more convenient to handle than quasi-dendrograms. Indeed, the results in this paper are derived in terms of quasi-ultrametrics.\nHowever, quasi-dendrograms are more convenient for representing data as illustrated in Section 4.\nGiven a quasi-dendrogram D̃X = (DX , EX), the value ũX(x, x\n′) of the associated quasi-ultrametric for x, x′ ∈ X is given by the minimum resolution δ at which x can influence x′. This may occur when x and x′ belong to the same block of DX(δ) or when they belong to different blocks B,B′ ∈ DX(δ), but there is an edge from the block containing x to the block containing x′, i.e. (B,B′) ∈ EX(δ). Conversely, given a quasi-ultrametric network (X, ũX), for a given resolution δ the graph D̃X(δ) has as a vertex set the classes of nodes whose quasi-ultrametric is less than δ in both directions. Furthermore, D̃X(δ) contains a directed edge between two distinct equivalence classes if the quasiultrametric from some node in the first class to some node in the second is not greater than δ.\nIn Fig. 2 we present an example of the equivalence between quasi-dendrograms and quasi-ultrametric networks stated by Theorem 1. At the top left of the figure, we present a quasi-ultrametric ũX defined on a three-node set X = {x1, x2, x3}. At the top right, we depict the dendrogram component DX of the quasi-dendrogram D̃X = (DX , EX) equivalent to (X, ũX) as given by Theorem 1. At the bottom of the figure, we present graphs D̃X(δ) for a range of resolutions δ ≥ 0.\nTo obtain D̃X from ũX , we first obtain the dendrogram component DX by symmetrizing ũX to the maximum [cf. (9)], nodes x1 and x2 merge at resolution 2 and x3 merges with {x1, x2} at resolution 3. To see how the edges in D̃X are obtained, at resolutions 0 ≤ δ < 1, there are no edges since there is no quasi-ultrametric value between distinct nodes in this range [cf. (10)]. At resolution δ = 1, we reach the first non-zero values of ũX and hence the corresponding edges appear in D̃X(1). At resolution δ = 2, nodes x1 and x2 merge and become the same vertex in graph D̃X(2). Finally, at resolution δ = 3 all the nodes belong to the same equivalence class and hence D̃X(3) contains only one vertex. Conversely, to obtain ũX from D̃X as depicted in the figure, note that at resolution δ = 1 two edges ([x1]1, [x2]1) and ([x3]1, [x2]1) appear in D̃X(1), thus the corresponding values of the quasi-ultrametric are fixed to be ũX(x1, x2) = ũ(x3, x2) = 1. At resolution δ = 2, when x1 and x2 merge into the same vertex in D̃X(2), an edge is generated from [x3]2 to [x1]2 the equivalence class of x1 at resolution δ = 2 which did not exist before, implying that ũX(x3, x1) = 2. Moreover, we have that [x2]2 = [x1]2, hence ũX(x2, x1) = 2. Finally, at D̃X(3) there is only one equivalence class, thus the values of ũX that have not been defined so far must equal 3."
    }, {
      "heading" : "3.3. Admissible quasi-clustering methods",
      "text" : "We encode desirable properties of quasi-clustering methods into axioms which we use as a criterion for admissibility. The Directed Axiom of Value (Ã1) and the Directed Axiom of Transformation (Ã2) winnow the space of quasi-clustering methods by imposing conditions on their output quasi-ultrametrics which, by Theorem 1, is equivalent to imposing conditions on the output quasidendrograms. Defining an arbitrary two-node network ~∆2(α, β) := ({p, q}, Ap,q) with Ap,q(p, q) = α and Ap,q(q, p) = β for some α, β > 0,\n(Ã1) Directed Axiom of Value. H̃(~∆2(α, β)) = ~∆2(α, β) for every two-node network ~∆2(α, β).\n(Ã2) Directed Axiom of Transformation. Consider two networks NX = (X,AX) and NY = (Y,AY ) and a dissimilarity-reducing map φ : X → Y , i.e. a map φ such that for all x, x′ ∈ X it holds AX(x, x′) ≥ AY (φ(x), φ(x\n′)). Then, for all x, x′ ∈ X , the outputs (X, ũX) = H̃(X,AX) and (Y, ũY ) = H̃(Y,AY ) satisfy\nũX(x, x ′) ≥ ũY (φ(x), φ(x′)). (12)\nThe Directed Axiom of Transformation (Ã2) states that no influence relation can be weakened by a dissimilarity reducing transformation. That is, if relations in the network are strengthened, the tendency of nodes to cluster cannot decrease. The Directed Axiom of Value (Ã1) simply recognizes that in any two-node network, the dissimilarity function is itself a quasi-ultrametric and that there is no valid justification to output a different quasi-ultrametric."
    }, {
      "heading" : "3.4. Existence and uniqueness of admissible quasi-clustering methods: directed single linkage",
      "text" : "We call a quasi-clustering method H̃ admissible if it satisfies axioms (Ã1) and (Ã2) and we want to find methods that are admissible with respect to these axioms. This is not difficult. Define the directed minimum chain cost ũ∗X(x, x\n′) between nodes x and x′ as the minimum chain cost among all chains connecting x to x′. Formally, for all x, x′ ∈ X ,\nũ∗X(x, x ′) = min\nC(x,x′) max i|xi∈C(x,x′) AX(xi, xi+1). (13)\nDefine the directed single linkage (DSL) hierarchical quasi-clustering method H̃∗ as the one with output quasiultrametrics (X, ũ∗X) = H̃∗(X,AX) given by the directed minimum chain cost function ũ∗X . The DSL method is valid and admissible as we show in the following proposition.\nProposition 2 The hierarchical quasi-clustering method H̃∗ is valid and admissible. I.e., ũ∗X defined by (13) is a quasi-ultrametric and H̃∗ satisfies axioms (Ã1)-(Ã2).\nWe next ask which other methods satisfy (Ã1)-(Ã2) and what special properties DSL has. As it turns out, DSL is the unique quasi-clustering method that is admissible with respect to (Ã1)-(Ã2) as we assert in the following theorem.\nTheorem 2 Let H̃ be a valid hierarchical quasi-clustering method satisfying axioms (Ã1) and (Ã2). Then, H̃ ≡ H̃∗ where H̃∗ is the DSL method with output quasiultrametrics as in (13).\nIn (Carlsson & Mémoli, 2010), it was shown that single linkage is the only admissible hierarchical clustering method for finite metric spaces. Admissibility was defined by three axioms, two of which are undirected versions of (Ã1) and (Ã2). In (Carlsson et al., 2013), they show that when replacing metric spaces by more general asymmetric networks, the uniqueness result is lost and an infinite number of methods satisfy the admissibility axioms. In our paper, by considering the more general framework of quasi-clustering methods, we recover the uniqueness result even for asymmetric networks. Moreover, Theorem 2 shows that the only admissible method is a directed version of single linkage. In this way, it becomes clear that the non-uniqueness result for asymmetric networks in (Carlsson et al., 2013) is originated in the symmetry mismatch between the input asymmetric network and the output symmetric dendrogram. When we allow the more general asymmetric quasi-dendrogram as output, the uniqueness result is recovered.\nDSL was identified as a natural extension of single linkage hierarchical clustering to asymmetric networks in (Boyd, 1980). In our paper, by developing a framework to study\nhierarchical quasi-clustering methods and leveraging the equivalence result in Theorem 1, we show that DSL is the unique admissible way of quasi-clustering asymmetric networks. Furthermore, stability and invariance properties are established in the following section.\nRemark 2 (Axiomatic strength and directed chaining effect) DSL, having a strong resemblance to single linkage hierarchical clustering on finite metric spaces, is likely to be sensitive to a directed version of the so called chaining effect (Jain & Dubes, 1988). By requiring a weaker version of (Ã2), the most stringent of our two axioms, the uniqueness result in Theorem 2 is lost and density aware methods, that do not suffer from the chaining effect, become admissible. This direction, shown to be successful for finite metric spaces (Carlsson & Mémoli, 2013), appears to be an interesting research avenue."
    }, {
      "heading" : "3.5. Stability and invariance properties of DSL",
      "text" : "DSL is stable in the sense that if it is applied to similar networks then it outputs similar quasi-dendrograms. This notion has been used to study stability of clustering methods for finite metric spaces (Carlsson & Mémoli, 2010). In order to formalize this concept, we define a notion of distance between networks. We define an analogue to the GromovHausdorff distance (Gromov, 2007) between metric spaces, which we denote dN and defines a legitimate metric on N (see A.4 in supplementary material for details). Since we may regard DSL as a map N −→ Ũ and Ũ is a subset of N , we are in a position in which we can use dN to express the stability of H̃∗.\nTheorem 3 For all NX , NY ∈ N ,\ndN ( H̃∗(NX), H̃∗(NY ) ) ≤ dN (NX , NY ).\nTheorem 3 states that the distance between the output quasi-ultrametrics is upper bounded by the distance between the input networks. Thus, for DSL, nearby networks yield nearby quasi-ultrametrics. This is important when we consider noisy dissimilarity data. Theorem 3 ensures that noise has limited effect on output quasi-dendrograms. Furthermore, the theorem implies that DSL is permutation invariant; see A.7 in supplementary material.\nFor a non-decreasing function ψ : [0,∞) → [0,∞) such that ψ(a) = 0 if and only if a = 0, and NX = (X,AX) ∈ N we write ψ(NX) to denote the network (X,ψ(AX)). Any such ψ will be referred to as a change of scale function. Then, DSL is a scale invariant method as the following proposition asserts.\nProposition 3 For all NX ∈ N and all change of scale functions ψ one has ψ ( H̃∗(NX) ) = H̃∗ ( ψ(NX) ) .\nSince Proposition 3 asserts that the quasi-ultrametric outcome is transformed by the same function ψ that alters the dissimilarity function in the original network, DSL is invariant to change of units. More precisely, in terms of quasi-dendrograms, a transformation of dissimilarities through ψ results in a transformed quasi-dendrogram where the order in which influences between nodes arise is the same as in the original one while the resolution at which they appear changes according toψ. For further invariances of DSL, see A.7 in the supplementary materials."
    }, {
      "heading" : "3.6. Algorithms",
      "text" : "In this section we interpret AX as a matrix of dissimilarities and ũ∗X as a symmetric matrix with entries corresponding to the quasi-ultrametric values ũ∗X(x, x\n′) for all x, x′ ∈ X . By (13), DSL quasi-clustering searches for directed chains of minimum infinity norm cost in AX to construct the matrix ũ∗X . This operation can be performed algorithmically using matrix powers in the dioid algebra (R+ ∪ {+∞},min,max) (Gondran & Minoux, 2008).\nIn the dioid algebra (R+ ∪ {+∞},min,max) the regular sum is replaced by the minimization operator and the regular product by maximization. Using ⊕ and ⊗ to denote sum and product on this dioid algebra we have a ⊕ b := min(a, b) and a ⊗ b := max(a, b) for all a, b ∈ R+∪{+∞}. The matrix product A⊗B is therefore given by the matrix with entries[ A⊗B ] ij = n⊕ k=1 ( Aik⊗Bkj ) = min k∈[1,n] max ( Aik, Bkj ) . (14) Dioid powers A(k)X := AX ⊗A (k−1) X with A (1) X = AX of a dissimilarity matrix are related to quasi-ultrametric matrices ũ. For instance, the elements of the dioid power ũ(2) of a given quasi-ultrametric matrix ũ are given by[\nũ(2) ] ij\n= min k∈[1,n]\nmax ( ũik, ũkj ) . (15)\nSince ũ satisfies the strong triangle inequality we have that ũij ≤ max(ũik, ũkj) for all k. And for k = j in particular we further have that max(ũik, ũkj) = max(ũij , ũjj) = max(ũij , 0) = ũij . Combining these two observations it follows that the result of the minimization in (15) is [ũ(2)]ij = ũij since none of its arguments is smaller that ũij and one of them is exactly ũij . This being valid for all i, j implies ũ(2) = ũ. Furthermore, a matrix satisfying ũ(2) = ũ is such that ũij = [ũ(2)]ij = mink∈[1,n] max(ũik, ũkj) ≤ max(ũik, ũkj) for all k, which is just a restatement of the strong triangle inequality. Therefore, a non-negative matrix ũ represents a finite quasi-ultrametric space if and only if ũ(2) = ũ and only the diagonal elements are null. Building on this fact, we state the following algorithm to compute the quasi-ultrametric output by the DSL method.\nProposition 4 For every network (X,AX) with |X| = n, the quasi-ultrametric ũ∗X is given by\nũ∗X = A (n−1) X , (16)\nwhere the operation (·)(n−1) denotes the (n − 1)st matrix power in the dioid algebra (R+ ∪ {+∞},min,max) with matrix product as defined in (14).\nMatrix powers in dioid algebras are tractable operations. Indeed, there exist sub cubic dioid power algorithms (Vassilevska et al., 2009; Duan & Pettie, 2009) of complexity O(n2.688). Thus, Proposition 4 shows computational tractability of the DSL quasi-clustering method. There exist related methods with lower complexity. For instance, Tarjan’s method (Tarjan, 1983), which takes as input an asymmetric network but in contrast to our method enforces symmetry in its output, runs in time O(n2 log n) for complete networks. It seems of interest to ascertain whether one might be able to modify his algorithm to suit our (asymmetric) output construction. In the following section we use (16) to quasi-cluster a real-world network."
    }, {
      "heading" : "4. Applications",
      "text" : "The number of migrants from state to state is published yearly by the geographical mobility section of the U.S. census bureau (United States Census Bureau, 2011). We denote as S the set containing every state plus the District of Columbia and as AS : S × S → R+ a migrational dissimilarity such that AS(s, s) = 0 for all s ∈ S and AS(s, s′) for all s 6= s′ ∈ S is a monotonically decreasing function of the fraction of immigrants to state s′ that come from s (see A.9 in supplementary material for details). A small dissimilarity from state s to state s′ implies that, among all the immigrants into s′, a high percentage comes from s. We then construct the asymmetric networkNS = (S,AS) with node set S and dissimilarities AS . The application of hierarchical clustering to migration data has been extensively investigated by Slater, see (Slater, 1976; 1984).\nThe outcome of applying DSL with output quasiultrametric defined in (13) to the migration network NS is computed via (16). By Theorem 1, the output quasiultrametric is equivalent to a quasi-dendrogram D̃∗S = (D∗S , E ∗ S). By analyzing the dendrogram component D ∗ S of the quasi-dendrogram D̃∗S , the influence of geographical proximity in migrational preference is evident; see Fig. 4 in Section A.9 of the supplementary material.\nTo facilitate display and understanding, we do not present quasi-partitions for all the nodes and resolutions. Instead, we restrict the quasi-ultrametric to a subset of states representing an extended West Coast including Arizona and Nevada. In Fig. 3, we depict quasi-partitions at four relevant resolutions of the quasi-dendrogram equivalent to the\nrestricted quasi-ultrametric. States represented with the same color in the maps in Fig. 3 are part of the same cluster at the given resolution and states in white form singleton clusters. Arrows between clusters for a given resolution δ represent the edge set E∗S(δ) which we interpret as a migrational influence relation between the blocks of states.\nThe DSL quasi-clustering method H̃∗ captures not only the formation of clusters but also the asymmetric influence between them. E.g. the quasi-partition in Fig. 3 for resolution δ = 0.859 is of little interest since every state forms a singleton cluster. The influence structure, however, reveals a highly asymmetric migration pattern. At this resolution California has migrational influence over every other state in the region as depicted by the four arrows leaving California and entering each of the other states. This influence can be explained by the fact that California contains the largest urban areas of the region such as Los Angeles. Hence, these urban areas attract immigrants from all over the country, reducing the proportional immigration into California from its neighbors and generating the asymmetric influence structure observed. Since this influence structure defines a partial order over the clusters, the quasi-partition at resolution δ = 0.859 permits asserting the reasonable fact that California is the dominant migration force in the region.\nAt larger resolutions we can ascertain the relative importance of clusters. At resolution δ = 0.921 we can say that California is more important than the cluster formed by Oregon and Washington as well as more important than Arizona and Nevada. We can also see that Arizona precedes Nevada in the migration ordering at this resolution\nwhile the remaining pairs of the ordering are undefined. At resolution δ = 0.922 there is an interesting pattern as we can see the cluster formed by the three West Coast states preceding Arizona and Nevada in the partial order. At this resolution the partial order also happens to be a total order as Arizona is seen to precede Nevada. This is not true in general as we have already seen.\nHierarchical quasi-clustering methods can also be used to study, e.g., the relations between sectors of an economy. Due to space restrictions, we include this second application in A.9 in the supplementary material."
    }, {
      "heading" : "5. Conclusion",
      "text" : "When clustering asymmetric networks, requiring the output to be symmetric – as in hierarchical clustering – might be undesirable. Hence, we defined quasi-dendrograms, a generalization of dendrograms that admits asymmetric relations, and developed a theory for quasi-clustering methods. We formalized the notion of admissibility by introducing two axioms. Under this framework, we showed that DSL is the unique admissible method. We pointed out that less stringent frameworks that give rise to new admissible methods can be explored by weakening the Directed Axiom of Transformation. Furthermore, we proved an equivalence between quasi-dendrograms and quasi-ultrametrics that generalizes the well-known equivalence between dendrograms and ultrametrics, and established the stability and invariance properties of the DSL method. Finally, we illustrated the application of DSL to a migration network."
    }, {
      "heading" : "Acknowledgments",
      "text" : "Work in this paper is supported by NSF CCF0952867, AFOSR MURI FA9550-10-1-0567, DARPA GRAPHS FA9550-12-1-0416, AFOSR FA9550-09-0-10531, AFOSR FA9550-09-1-0643, NSF DMS 0905823, and NSF DMS-0406992."
    }, {
      "heading" : "A. Supplementary Material",
      "text" : ""
    }, {
      "heading" : "A.1. Proof of Theorem 1",
      "text" : "In order to show that Ψ is a well-defined map, we must show that Ψ(D̃X) is a quasi-ultrametric network for every quasi-dendrogram D̃X . Given an arbitrary quasidendrogram D̃X = (DX , EX), for a particular δ′ ≥ 0 consider the quasi-partition D̃X(δ′). Consider the range of resolutions δ associated with such quasi-partition. I.e.,\n{δ ≥ 0 ∣∣ D̃X(δ) = D̃X(δ′)}. (17)\nRight continuity (D̃4) of D̃X ensures that the minimum of the set in (17) is well-defined and hence definition (8) is valid. To prove that ũX in (8) is a quasi-ultrametric we need to show that it attains non-negative values as well as the identity and strong triangle inequality properties. That ũX attains non-negative values is clear from the definition (8). The identity property is implied by the first boundary condition in (D̃1). Since [x]0 = [x]0 for all x ∈ X , we must have ũX(x, x) = 0. Conversely, since for all x 6= x′ ∈ X , ([x]0, [x\n′]0) 6∈ EX(0) and [x]0 6= [x′]0 we must have that ũX(x, x\n′) > 0 for x 6= x′ and the identity property is satisfied. To see that ũX satisfies the strong triangle inequality in (7), consider nodes x, x′, and x′′ such that the lowest resolution for which [x]δ = [x′′]δ or ([x]δ, [x′′]δ) ∈ EX(δ) is δ1 and the lowest resolution for which [x′′]δ = [x′]δ or ([x′′]δ, [x\n′]δ) ∈ EX(δ) is δ2. Right continuity (D̃4) ensures that these lowest resolutions are well-defined. According to (8) we then have\nũX(x, x ′′) = δ1,\nũX(x ′′, x′) = δ2. (18)\nDenote by δ0 := max(δ1, δ2). From the equivalence hierarchy (D̃2) and influence hierarchy (D̃3) properties, it follows that [x]δ0 = [x ′′]δ0 or ([x]δ0 , [x ′′]δ0) ∈ EX(δ0) and [x′′]δ0 = [x ′]δ0 or ([x ′′]δ0 , [x ′]δ0) ∈ EX(δ0). Furthermore, from transitivity (QP2) of the quasi-partition D̃X(δ0), it follows that [x]δ0 = [x ′]δ0 or ([x]δ0 , [x ′]δ0) ∈ EX(δ0). Using the definition in (8) for x, x′ we conclude that\nũX(x, x ′) ≤ δ0. (19)\nBy definition δ0 := max(δ1, δ2), hence we substitute this expression in (19) and compare with (18) to obtain\nũX(x, x ′)≤max(δ1, δ2)=max ( ũX(x, x ′′), ũX(x ′′, x′) ) .\n(20) Consequently, ũX satisfies the strong triangle inequality and is therefore a quasi-ultrametric, proving that the map Ψ is well-defined.\nFor the converse result, we need to show that Υ is a welldefined map. Given a quasi-ultrametric ũX on a node set\nX and a resolution δ ≥ 0, we first define the relation\nx ũX(δ) x ′ ⇐⇒ ũX(x, x′) ≤ δ, (21)\nfor all x, x′ ∈ X . Notice that ũX(δ) is a quasiequivalence relation as defined in Definition 1 for all δ ≥ 0. The reflexivity property is implied by the identity property of the quasi-ultrametric ũX and transitivity is implied by the fact that ũX satisfies the strong triangle inequality. Furthermore, definitions (9) and (10) are just reformulations of (2) and (3) respectively, for the special case of the quasiequivalence defined in (21). Hence, Proposition 1 guarantees that Υ(X, ũX) = D̃X(δ) = (DX(δ), EX(δ)) is a quasi-partition for every resolution δ ≥ 0. In order to show that Υ is well-defined, we need to show that these quasipartitions are nested, i.e. that D̃X satisfies (D̃1)-(D̃4).\nThe first boundary condition in (D̃1) is implied by (9) and the identity property of ũX . The second boundary condition in (D̃1) is implied by the fact that ũX takes finite real values on a finite domain since the node set X is finite. Hence, any δ0 satisfying\nδ0 ≥ max x,x′∈X ũX(x, x ′), (22)\nis a valid candidate to show fulfillment of (D̃1).\nTo see that D̃X satisfies (D̃2) assume that for a resolution δ1 we have two nodes x, x′ ∈ X such that x ∼ũX(δ1) x′ as in (9), then it follows that max ( ũX(x, x ′), ũX(x ′, x) ) ≤ δ1. Thus, if we pick any δ2 > δ1 it is immediate that max ( ũX(x, x ′), ũX(x ′, x) ) ≤ δ2 which by (9) implies that x ∼ũX(δ2) x′.\nFulfillment of (D̃3) can be shown in a similar way as fulfillment of (D̃2). Given a scalar δ1 ≥ 0 and x, x′ ∈ X , if ([x]δ1 , [x ′]δ1) ∈ EX(δ1) then by (10) we have that\nmin x1∈[x]δ1 ,x2∈[x′]δ1\nũX(x1, x2) ≤ δ1. (23)\nFrom property (D̃2), we know that for all x ∈ X , [x]δ1 ⊂ [x]δ2 for all δ2 > δ1. Hence, two things might happen. Either max(ũX(x, x′), ũX(x′, x)) ≤ δ2 in which case [x]δ2 = [x ′]δ2 or it might be that [x]δ2 6= [x′]δ2 but\nmin x1∈[x]δ2 ,x2∈[x′]δ2\nũX(x1, x2) ≤ δ1 < δ2, (24)\nwhich implies that ([x]δ2 , [x ′]δ2) ∈ EX(δ2). Consequently, (D̃3) is satisfied.\nFinally, to see that D̃X satisfies the right continuity condition (D̃4), for each δ ≥ 0 such that D̃X(δ) 6= ({X}, ∅) we may define (δ) as any positive scalar satisfying\n0 < (δ) < min x,x′∈X\ns.t. ũX(x,x′)>δ\nũX(x, x ′)− δ, (25)\nwhere the finiteness of X ensures that (δ) is well-defined. Hence, (9) and (10) guarantee that D̃X(δ) = D̃X(δ′) for δ′ ∈ [δ, δ + (δ)]. For all other resolutions δ such that D̃X(δ) = ({X}, ∅), right continuity is trivially satisfied since the quasi-dendrogram remains unchanged for increasing resolutions. Consequently, Υ(X, ũX) is a valid quasi-dendrogram for every quasi-ultrametric network (X, ũX), proving that Υ is well-defined.\nIn order to conclude the proof, we need to show that Ψ ◦Υ and Υ ◦ Ψ are the identities on Ũ and D̃, respectively. To see why the former is true, pick any quasi-ultrametric network (X, ũX) and consider an arbitrary pair of nodes x, x′ ∈ X such that ũX(x, x′) = δ0. Also, consider the ultrametric network Ψ ◦ Υ(X, ũX) := (X, ũ∗X). From (9) and (10), in the quasi-dendrogram Υ(X, ũX) there is no influence from x to x′ for resolutions δ < δ0 and at resolution δ = δ0 either an edge appears from [x]δ0 to [x\n′]δ0 , or both nodes merge into one single cluster. In any case, when we apply Ψ to the resulting quasi-dendrogram, we obtain ũ∗X(x, x\n′) = δ0. Since x, x′ ∈ X were chosen arbitrarily, we have that ũX = ũ∗X , showing that Ψ ◦ Υ is the identity on Ũ . A similar argument shows that Υ ◦ Ψ is the identity on D̃."
    }, {
      "heading" : "A.2. Proof of Proposition 2",
      "text" : "For this proof, we introduce the concept of chain concatenation. Given two chains C(x, x′) = [x = x0, x1, ..., xl = x′] and C(x′, x′′) = [x′ = x′0, x ′ 1, ..., x ′ l′ = x\n′′] such that the end point x′ of the first one coincides with the starting point of the second one, define the concatenated chain C(x, x′) ] C(x′, x′′) as\nC(x, x′) ] C(x′, x′′) := [x = x0, . . . , xl = x ′ = x′0, . . . , x ′ l′ = x\n′′]. (26)\nFor the method H̃∗ to be a properly defined hierarchical quasi-clustering method, we need to establish that ũ∗X is a valid ultrametric. To see that ũ∗X(x, x\n′) = 0 if and only if x = x′, notice that when x = x′, the chain C(x, x) = [x, x] has null cost and when x 6= x′ any chain must contain at least one link with strictly positive cost. To verify that the strong triangle inequality in (7) holds, let C∗(x, x′′) and C∗(x′′, x′) be chains that achieve the minimum in (13) for ũ∗X(x, x ′′) and ũ∗X(x ′′, x′), respectively. The maximum cost in the concatenated chain C(x, x′) = C∗(x, x′′)]C∗(x′′, x′) does not exceed the maximum cost in each individual chain. Thus, while the maximum cost may be smaller on a different chain, the chain C(x, x′) suffices to bound ũ∗X(x, x ′) ≤ max ( ũ∗X(x, x ′′), ũ∗X(x ′′, x′)\n) as in (7).\nTo show fulfillment of Axiom (Ã1), pick an arbitrary two-node network ~∆2(α, β) := ({p, q}, Ap,q) with\nAp,q(p, q) = α and Ap,q(q, p) = β for some α, β > 0 and denote by ({p, q}, ũ∗p,q) = H̃∗(~∆2(α, β)). Then, we have ũ∗p,q(p, q) = α and ũ ∗ p,q(q, p) = β because there is only one possible chain selection in each direction [cf. (13)]. To prove that Axiom (Ã2) is satisfied consider arbitrary points x, x′ ∈ X and denote by C∗(x, x′) one chain achieving the minimum chain cost in (13),\nũ∗X(x, x ′) = max\ni|xi∈C∗(x,x′) A(xi, xi+1). (27)\nConsider the transformed chain CY (φ(x), φ(x′)) = [φ(x) = φ(x0), . . . , φ(xl) = φ(x\n′)] in the space Y . Since the map φ : X → Y reduces dissimilarities we have that for all links in this chain AY (φ(xi), φ(xi+1)) ≤ AX(xi, xi+1). Consequently,\nmax i|φ(xi)∈CY (φ(x),φ(x′)) AY (φ(xi), φ(xi+1)) (28)\n≤ max i|xi∈C∗(x,x′) AX(xi, xi+1).\nFurther note that the minimum chain cost ũ∗Y (φ(x), φ(x ′)) among all chains linking φ(x) to φ(x′) cannot exceed the cost in the given chain CY (φ(x), φ(x′)). Combining this observation with the inequality in (28) it follows that\nũ∗Y (φ(x), φ(x ′))≤ max\ni|xi∈C∗(x,x′) AX(xi, xi+1)= ũ\n∗ X(x, x ′),\n(29)\nwhere we also used (27) to write the equality. Expression (29) ensures fulfillment of Axiom (Ã2), as wanted."
    }, {
      "heading" : "A.3. Proof of Theorem 2",
      "text" : "In proving this theorem, the concept of separation of a network is useful. Given an arbitrary network (X,AX), its separation sep(X,AX) is defined as the minimum positive dissimilarity in the network, that is\nsep(X,AX) = min x 6=x′\nAX(x, x ′). (30)\nThe following auxiliary result is useful in showing Theorem 2.\nLemma 1 A network N = (X,AX) and a positive constant δ are given. Then, for any pair of nodes x, x′ ∈ X whose minimum chain cost [cf. (13)] satisfies\nũ∗X(x, x ′) ≥ δ, (31)\nthere exists a partition Pδ(x, x′) = {Bδ(x), Bδ(x′)} of the node space X into blocks Bδ(x) and Bδ(x′) with x ∈ Bδ(x) and x′ ∈ Bδ(x′) such that for all points b ∈ Bδ(x) and b′ ∈ Bδ(x′)\nAX(b, b ′) ≥ δ. (32)\nProof: We prove this result by contradiction. If a partition Pδ(x, x′) = {Bδ(x), Bδ(x′)} with x ∈ Bδ(x) and x′ ∈ Bδ(x) and satisfying (32) does not exist for all pairs of points x, x′ ∈ X satisfying (31), then there is at least one pair of nodes x, x′ ∈ X satisfying (31) such that for all partitions of X into two blocks P = {B,B′} with x ∈ B and x′ ∈ B′ we can find at least a pair of elements bP ∈ B and b′P ∈ B′ for which\nAX(bP , b ′ P ) < δ. (33)\nBegin by considering the partition P1 = {B1, B′1} where B1 = {x} and B′1 = X\\{x}. Since (33) is true for all partitions having x ∈ B and x′ ∈ B′ and x is the unique element of B1, there must exist a node b′P1 ∈ B ′ 1 such that\nAX(x, b ′ P1) < δ. (34)\nHence, the chain C(x, b′P1) = [x, b ′ P1 ] composed of these two nodes has cost smaller than δ. Moreover, since ũ∗X(x, b ′ P1\n) represents the minimum cost among all chains C(x, b′P1) linking x to b ′ P1 , we can assert that\nũ∗X(x, b ′ P1) ≤ AX(x, b ′ P1) < δ. (35)\nConsider now the partition P2 = {B2, B′2} where B2 = {x, b′P1} and B ′ 2 = X\\B2. From (33), there must exist a node b′P2 ∈ B ′ 2 that satisfies at least one of the two following conditions\nAX(x, b ′ P2) < δ, (36) AX(b ′ P1 , b ′ P2) < δ. (37)\nIf (36) is true, the chain C(x, b′P2) = [x, b ′ P2 ] has cost smaller than δ. If (37) is true, we combine the dissimilarity bound with the one in (34) to conclude that the chain C(x, b′P2) = [x, b ′ P1 , b′P2 ] has cost smaller than δ. In either case we conclude that there exists a chain C(x, b′P2) linking x to b′P2 whose cost is smaller than δ. Therefore, the minimum chain cost must satisfy\nũ∗X(x, b ′ P2) < δ. (38)\nRepeat the process by considering the partition P3 with B3 = {x, b′P1 , b ′ P2 } andB′3 = X\\B3. As we did in arguing (36)-(37) it must follow from (33) that there exists a point b′P3 such that at least one of the dissimilarities AX(x, b ′ P3\n), AX(b ′ P1 , b′P3), or AX(b ′ P2 , b′P3) is smaller than δ. This observation implies that at least one of the chains [x, b′P3 ], [x, b′P1 , b ′ P3 ], [x, b′P2 , b ′ P3 ], or [x, b′P1 , b ′ P2 , b′P3 ] has cost smaller than δ from where it follows that\nũ∗X(x, b ′ P3) < δ. (39)\nThis recursive construction can be repeated n − 1 times to obtain partitions P1, P2, ..., Pn−1 and corresponding nodes\nb′P1 , b ′ P2 , ...b′Pn−1 such that the minimum chain cost satisfies ũ∗X(x, b ′ Pi) < δ, for all i. (40) Observe now that the nodes b′Pi are distinct by construction and distinct from x. Since there are n nodes in the network it must be that x′ = b′Pk for some i ∈ {1, . . . , n − 1}. It then follows from (40) that\nũ∗X(x, x ′) < δ. (41)\nThis is a contradiction because x, x′ ∈ X were assumed to satisfy (31). Thus, the assumption that (33) is true for all partitions is incorrect. Hence, the claim that there exists a partition Pδ(x, x′) = {Bδ(x), Bδ(x′)} satisfying (32) must be true.\nReturning to the main proof, given an arbitrary network N = (X,AX) denote as (X, ũX) = H̃(X,AX) the output quasi-ultrametric resulting from application of an arbitrary admissible quasi-clustering method H̃. We will show that for all x, x′ ∈ X\nũ∗X(x, x ′) ≤ ũX(x, x′) ≤ ũ∗X(x, x′). (42)\nTo prove the rightmost inequality in (42) we begin by showing that the dissimilarity function AX acts as an upper bound on all admissible quasi-ultrametrics ũX , i.e.\nũX(x, x ′) ≤ AX(x, x′), (43)\nfor all x, x′ ∈ X . To see this, suppose AX(x, x′) = α and AX(x′, x) = β. Define the two-node network Np,q = ({p, q}, Ap,q) where Ap,q(p, q) = α and Ap,q(q, p) = β and denote by ({p, q}, ũp,q) = H̃(Np,q) the output of applying the method H̃ to the network Np,q . From axiom (Ã1), we have H̃(Np,q) = Np,q , in particular\nũp,q(p, q) = Ap,q(p, q) = AX(x, x ′). (44)\nMoreover, notice that the map φ : {p, q} → X , where φ(p) = x and φ(q) = x′ is a dissimilarity reducing map, i.e. it does not increase any dissimilarity, from Np,q to N . Hence, from axiom (Ã2), we must have\nũp,q(p, q) ≥ ũX(φ(p), φ(q)) = ũX(x, x′). (45)\nSubstituting (44) in (45), we obtain (43).\nConsider now an arbitrary chain C(x, x′) = [x = x0, x1, . . . , xl = x\n′] linking nodes x and x′. Since ũX is a valid quasi-ultrametric, it satisfies the strong triangle inequality (7). Thus, we have that\nũX(x, x ′) ≤ max\ni|xi∈C(x,x′) ũX(xi, xi+1)\n≤ max i|xi∈C(x,x′) AX(xi, xi+1), (46)\nwhere the last inequality is implied by (43). Since by definition C(x, x′) is an arbitrary chain linking x to x′, we can minimize (46) over all such chains maintaining the validity of the inequality,\nũX(x, x ′)≤ min\nC(x,x′) max i|xi∈C(x,x′) AX(xi, xi+1)= ũ\n∗ X(x, x ′),\n(47) where the last equality is given by the definition of the directed minimum chain cost (13). Thus, the rightmost inequality in (42) is proved.\nTo show the leftmost inequality in (42), consider an arbitrary pair of nodes x, x′ ∈ X and fix δ = ũ∗X(x, x′). Then, by Lemma 1, there exists a partition Pδ(x, x′) = {Bδ(x), Bδ(x′)} of the node space X into blocks Bδ(x) and Bδ(x′) with x ∈ Bδ(x) and x′ ∈ Bδ(x′) such that for all points b ∈ Bδ(x) and b′ ∈ Bδ(x′) we have\nAX(b, b ′) ≥ δ. (48)\nFocus on a two-node network Nu,v = ({u, v}, Au,v) with Au,v(u, v) = δ andAu,v(v, u) = swhere s = sep(X,AX) as defined in (30). Denote by ({u, v}, ũu,v) = H̃(Nu,v) the output of applying the method H̃ to the network Nu,v . Notice that the map φ : X → {u, v} such that φ(b) = u for all b ∈ Bδ(x) and φ(b′) = v for all b′ ∈ Bδ(x′) is dissimilarity reducing because, from (48), dissimilarities mapped to dissimilarities equal to δ inNu,v were originally larger. Moreover, dissimilarities mapped into s cannot have increased due to the definition of separation of a network (30). From Axiom (Ã1),\nũu,v(u, v) = Au,v(u, v) = δ, (49)\nsince Nu,v is a two-node network. Moreover, since φ is dissimilarity reducing, from (Ã2) we may assert that\nũX(x, x ′) ≥ ũu,v(φ(x), φ(x′)) = δ, (50)\nwhere we used (49) for the last equality. Recalling that ũ∗X(x, x\n′) = δ and substituting in (50) concludes the proof of the leftmost inequality in (42).\nSince both inequalities in (42) hold, we must have ũ∗X(x, x ′) = ũX(x, x ′) for all x, x′ ∈ X . Since this is true for any arbitrary network N = (X,AX), it follows that the admissible quasi-clustering method must be H̃ ≡ H̃∗."
    }, {
      "heading" : "A.4. The metric on N",
      "text" : "Consider two networks NX , NY ∈ N such that NX = (X,AX) and NY = (Y,AY ). A correspondence between the sets X and Y is any subset R ⊆ X × Y such that π1(R) = X and π2(R) = Y . Here, π1 and π2 are the usual coordinate-wise projections. The distortion dis(R) of a correspondence R between networks NX and NY is\ndefined as\ndis(R) := max (x,y),(x′,y′)∈R\n|AX(x, x′)−AY (y, y′)|.\nThe underlying notion of equality on N that we use is the following: we say that networks NX and NY are isomorphic or indistinguishable if and only if there exists a bijection φ : X → Y such that AX(x, x′) = AY (φ(x), φ(x′)) for all x, x′ ∈ X . Given NX and NY , we define the network distance dN on N ×N as\ndN ( NX , NY ) := 1\n2 min R dis(R), (51)\nwhereR spans all correspondences betweenX and Y . The structure of this distance is similar to that of the GromovHausdorff distance (Gromov, 2007) that is often used in the context of compact metric spaces. In our context, it still provides a legitimate distance on the collection N modulo our chosen notion of isomorphism.\nTheorem 4 The network distance defined in (51) is a legitimate metric on N modulo isomorphism of networks.\nProof: That dN is symmetric and non-negative is clear. Assume now thatX and Y are isomorphic and let φ : X → Y be a bijection providing this isomorphism. Then, consider Rφ = {(x, φ(x)), x ∈ X}. Since φ is a bijection, it is easy to check that Rφ is a correspondence between X and Y . Finally, by definition of φ, AX(x, x′) = AY (y, y′) for all (x, y), (x′, y′) ∈ Rφ. Hence\n0 ≤ dN (X,Y ) ≤ 1\n2 dis(Rφ) = 0\nand dN (X,Y ) = 0 follows.\nThe triangle inequality follows from the following observation: if R is a correspondence between X and Z and S is a correspondence between Z and Y , then\nT := {(x, y), |∃z ∈ Z with (x, z) ∈ R, (z, y) ∈ S} (52)\nis a correspondence between X and Y . To show that T is in fact a correspondence, we have to prove that for every x ∈ X there exists y ∈ Y such that (x, y) ∈ T . Similarly, we must require that for every y ∈ Y there exists x ∈ X such that (x, y) ∈ T . To see this, pick an arbitrary x ∈ X , by definition of R, there must exist z ∈ Z such that (x, z) ∈ R. By definition of S, there must exist y ∈ Y such that (z, y) ∈ S. Hence, there exists (x, y) ∈ T for every x ∈ X . Similarly, the result can be proven for every element of the set Y .\nWe can prove the triangle inequality in the following way. Consider R and S to be the minimizing correspondences\nassociated with distances dN (X,Z) and dN (Z, Y ) respectively and define T as given by (52). Note that T need not be the minimizing correspondence for dN (X,Y ). Hence,\ndN (X,Y ) ≤ 1\n2 dis(T ) (53)\nFurthermore, if we add and subtract AZ(z, z′) within the absolute value defining the distortion of T in (53), where z and z′ are the elements in the definition of T (52), and we use the fact that the maximum of the absolute value of a sum is less than or equal to the sum of the maximums of absolute values, we obtain\ndN (X,Y )\n≤ 1 2 max (x,z),(x′,z′)∈R |AX(x, x′)−AZ(z, z′)|\n+ 1\n2 max (z,y),(z′,y′)∈S |AZ(z, z′)−AY (y, y′)| (54)\nBy noting that the expression on the right hand side of (54) is the sum of dN (X,Z) and dN (Z, Y ), the proof of the triangle inequality is completed.\nFinally, the most delicate part of the proof is checking that dN (X,Y ) = 0 implies that X and Y are isomorphic. Assume that R is a correspondence such that AX(x, x′) = AY (y, y\n′) for all (x, y) and (x′, y′) both in R. Define φ : X → Y in the following way: for each x ∈ X let Rx ⊆ Y be the set of all y such that (x, y) ∈ R. The fact that R is a correspondence forces that Rx 6= ∅. Hence, we can choose any y in Rx and declare φ(x) = y.\nDefine in the same way a function ψ : Y → X . Notice that then we forcibly have that AX(x, x′) = AY (φ(x), φ(x′)) for all x, x′ ∈ X and also AX(ψ(y), ψ(y′)) = AY (y, y′) for all y, y′ ∈ Y .\nTo prove that φ is injective, assume that x 6= x′ but φ(x) = φ(x′), then AX(x, x′) = AY (φ(x), φ(x′)) = 0, which contradicts our definition of networks. In a similar manner one checks that ψ must also be injective.\nSo we have constructed two injections, one from X into Y , and one in the opposite direction. The Cantor-BernsteinSchroeder theorem now applies and guarantees that there exists a bijection between X and Y . This immediately forces X and Y to have the same cardinality, and in particular, it forces φ (and ψ) to be bijections. This concludes the proof."
    }, {
      "heading" : "A.5. Proof of Theorem 3",
      "text" : "Assume η = dN (NX , NY ) and let R be a correspondence between X and Y such that dis(R) = 2η. Write (X, ũX) = H̃∗(NX) and (Y, ũY ) = H̃∗(NY ). We will prove that |ũX(x, x′) − ũY (y, y′)| ≤ 2η for all\n(x, y), (x′, y′) ∈ R which will imply the claim. Fix (x, y) and (x′, y′) in R. Pick any x = x0, x1, . . . , xn = x′ in X such that maxiAX(xi, xi+1) = ũX(x, x′). Choose y0, y1, . . . , yn ∈ Y so that (xi, yi) ∈ R for all i = 0, 1, . . . , n. Then, by definition of ũY (y, y′) and the definition of η:\nũY (y, y ′) ≤ max\ni AY (yi, yi+1)\n≤ max i AX(xi, xi+1) + 2η = ũX(x, x ′) + 2η.\nBy symmetry, one also obtains ũX(x, x′) ≤ ũY (y, y′) + 2η, and the conclusion follows form the arbitrariness of (x, y), (x′, y′) ∈ R and the definition of dN ."
    }, {
      "heading" : "A.6. Proof of Proposition 3",
      "text" : "Fix any (X,AX) ∈ N and write H̃∗(X,AX) = (X, ũX). Pick any change of scale function Ψ and write (X, ũΨX) = H̃∗(X,Ψ(AX)). We need to prove that ũΨX = Ψ(ũX). But this follows directly from the explicit structure given in equation (13) and the fact that Ψ is non-decreasing.\nA.7. Further invariances: vertex permutations and the metric closure\nNote that Theorem 3 implies that DSL behaves well under permutations of the vertices. The distance between a given network and a second one obtained by permuting its nodes is null. Thus, by Theorem 3, the distance between the corresponding output quasi-dendrograms must be null as well. More precisely, if (X,AX) ∈ N , H̃∗(X,AX) = (X, ũX), and ϕ : X → X is any bijection, then H̃∗(X,AX ◦ (ϕ,ϕ)) = (X, ũX ◦ (ϕ,ϕ)). This means that permuting the labels of points before applying DSL yields the same result as permuting the labels a posteriori.\nFor any (X,AX) ∈ N let ĀX be the maximal function satisfying ĀX ≤ AX pointwisely which in addition satisfies the directed triangle inequality: ĀX(x, x′) ≤ ĀX(x, x′′)+ ĀX(x\n′′, x′) for all x, x′, x′′ ∈ X . Then, one can also prove (similar to the proof of Theorem 18 in (Carlsson & Mémoli, 2010)) that H̃∗(X,AX) = H̃∗(X, ĀX) for all X ∈ N ."
    }, {
      "heading" : "A.8. Proof of Proposition 4",
      "text" : "In Ch.6, Section 6.1 of (Gondran & Minoux, 2008) it is shown that if AX is a dissimilarity matrix then its quasi inverse A∗X in the dioid (R+ ∪{+∞},min,max) contains information about the minimum infinity norm of chains in the network. In fact, [A∗X ]i,j contains the minimum infinity norm of all the chains connecting node i with node j. In (Gondran & Minoux, 2008), the analysis is done for the symmetric case but its extension to the asymmetric case is\nimmediate as we present here,\n[A∗X ]i,j = min C(xi,xj) max k|xk∈C(xi,xj) AX(xk, xk+1). (55)\nBy comparing (55) with (13), we can state that\nA∗X = ũ ∗ X . (56)\nHence, if we show that A∗X = A (n−1) X , then (56) implies (16), completing the proof. Recall the quasi inverse A∗X definition in the dioid (R+ ∪ {+∞},min,max) from Ch. 4, Definition 3.1.2 in (Gondran & Minoux, 2008)\nA∗X = lim k→∞ I ⊕AX ⊕A(2)X ⊕ ...⊕A (k) X , (57)\nwhere I has zeros in the diagonal and +∞ in the off diagonal elements.\nHowever, in our dioid algebra where the ⊕ operation is idempotent, i.e. a ⊕ a = a for all a, it can be shown as in Ch. 4, Proposition 3.1.1 in (Gondran & Minoux, 2008) that\nI ⊕AX ⊕A(2)X ⊕ ...⊕A (k) X = (I ⊕AX) (k). (58)\nIn our case, it is immediate that I⊕AX = AX , since diagonal elements are null in both matrices and the off diagonal elements in I are +∞. Hence, the minimization operation ⊕ preserves AX . Consequently, (58) becomes\nI ⊕AX ⊕A(2)X ⊕ ...⊕A (k) X = A (k) X . (59)\nTaking the limit to infinity in both sides of equality (59) and using the quasi inverse definition (57), we get\nA∗X = lim k→∞ A (k) X . (60)\nFinally, it can be shown as in Theorem 1 of Ch.4, Section 3.3 in (Gondran & Minoux, 2008) that A(n−1)X = A (n) X , proving that the limit in (60) is well defined and, more importantly, that A∗X = A (n−1) X , as wanted."
    }, {
      "heading" : "A.9. Applications",
      "text" : "The dissimilarity functionAS of the migration networkNS used in Section 4 of the paper is computed as follows. Denote byM : S×S → R+ the migration flow function given by the U.S. census bureau in which M(s, s′) is the number of individuals that migrated from state s to s′ in year 2011 and M(s, s) = 0 for all s, s′ ∈ S. We then construct the asymmetric network NS = (S,AS) with node set S and dissimilarities AS such that AS(s, s) = 0 for all s ∈ S and\nAS(s, s ′) = f ( M(s, s′)∑ iM(si, s ′) ) , (61)\nfor all s 6= s′ ∈ S where f : [0, 1) → R++ is a given decreasing function. The normalization M(s, s′)/ ∑ iM(si, s\n′) in (61) can be interpreted as the probability that an immigrant to state s′ comes from state s. The role of the decreasing function f is to transform the similarities M(s, s′)/ ∑ iM(si, s\n′) into corresponding dissimilarities. For the experiments here we use f(x) = 1−x. However, due to the scale invariance property of DSL [cf. Proposition 3] , the particular form of f is of little consequence to our analysis. Indeed, the influence structure between blocks of states obtained when quasi-clustering the network NS is independent of the particular choice of the decreasing function f .\nIn Fig. 4 we present the dendrogram component D∗S of the quasi-dendrogram D̃∗S = (D ∗ S , E ∗ S) analyzed in Section 4. Some identifiable clusters are highlighted in color to illustrate the influence of geographical proximity in migrational preference. E.g., the blue cluster corresponds to the six states in the region of New England, the red cluster contains the remaining East Coast states with the exception of Delaware, and the green cluster corresponds to states in an extended West Coast plus Texas.\nAs a second illustrative example of the DSL method, we quasi-cluster a network that records interactions between sectors of the economy. The Bureau of Economic Analysis of the U.S. Department of Commerce publishes a yearly table of inputs and outputs organized by economic sectors (Bureau of Economic Analysis, 2011). This table records how economic sectors interact to generate gross domestic product. We focus on the section of uses of this table which shows the inputs to production. More precisely, we are given a set I of 61 industrial sectors as defined by the North American Industry Classification System (NAICS) and a function U : I × I → R+ where U(i, i′) for all i, i′ ∈ I represents how much of the production of sector i, expressed in dollars, is used as an input of sector i′. The function U should be interpreted as a measure of directed closeness between two sectors. Thus, we define the network of uses NI = (I, AI) where the dissimilarity function AI satisfies AI(i, i) = 0 and, for i 6= i′ ∈ I , is given by\nAI(i, i ′) = f ( U(i, i′)∑ k U(ik, i ′) ) , (62)\nwhere f : [0, 1) → R++ is a given decreasing function. The normalization U(i, i′)/ ∑ k U(ik, i\n′) in (62) can be interpreted as the probability that an input dollar to productive sector i′ comes from sector i. In this way, we focus on the combination of inputs of a sector rather than the size of the economic sector itself. That is, a small dissimilarity from sector i to sector i′ implies that sector i′ highly relies on the use of sector i output as an input for its own production. Notice that U(i, i) for i ∈ I is generally positive, i.e., a sector uses outputs of its own production as inputs\nin other processes. Consequently, if for a given sector we sum the input proportion from every other sector, we obtain a number less than 1. The role of the decreasing function f is to transform the similarities U(i, i′)/ ∑ k U(ik, i\n′) into corresponding dissimilarities. As in the previous application, we use f(x) = 1 − x, though the particular form of f is of little consequence to the analysis since DSL is scale invariant [cf. Proposition 3].\nThe outcome of applying the DSL quasi-clustering method H̃∗ with output quasi-ultrametrics defined in (13) to the network NI is computed with the algorithmic formula in (16). As we did with the migration network, in order to facilitate understanding we present quasi-partitions obtained by restricting the output quasi-ultrametric to a subset of nodes. In Fig. 5 we present four quasi-partitions focusing on ten economic sectors; see Table 1. We present quasipartitions D̃∗I (δ) for four different resolutions δ ∗ 1 = 0.884, δ∗2 = 0.886, δ ∗ 3 = 0.894, and δ ∗ 4 = 0.899.\nThe edge component E∗I of the quasi-dendrogram D̃ ∗ I captures the asymmetric influence between clusters. E.g. in the quasi-partition in Fig. 5 for resolution δ∗1 = 0.884 every cluster is a singleton since the resolution is smaller than that of the first merging. However, the influence structure reveals an asymmetry in the dependence between the economic sectors. At this resolution the professional service sector MP has influence over every other sector except for the rental services RL as depicted by the eight arrows leaving the MP sector. No sector has influence over MP at this resolution since this would imply, except for RL, the formation of a non-singleton cluster. The influence of MP reaches primary sectors as OG, secondary sectors as PC and tertiary sectors as AS or SC. The versatility of MP’s influence can be explained by the diversity of services condensed in this economic sector, e.g. civil engineering and architectural services are demanded by CO, production engineering by PC and financial consulting by SC. For the rest of the influence pattern, we can observe an influence of CO over OG mainly due to the construction and maintenance of pipelines, which in turn influences PC due to the provision of crude oil for refining. Thus, from the transitiv-\nity (QP2) property of quasi-partitions we have an influence edge from CO to PC. The sectors CO, PC and OG influence the support service sector AS. Moreover, the service sectors RA, SC and FR have a totally hierarchical influence structure where SC has influence over the other two and FR has influence over RA. Since these three nodes remain as singleton clusters for the resolutions studied, the influence structure described is preserved for higher resolutions as it should be from the influence hierarchy property of the edge set E∗S(δ) stated in condition (D̃3) in the definition of quasi-dendrogram in Section 3.1.\nAt resolution δ∗2 = 0.886, we see that the sectors OG-PCCO have formed a three-node cluster depicted in red that influences AS. At this resolution, the influence edge from MP to RL appears and, thus, MP gains influence over every other cluster in the quasi-partition including the three-node cluster. At resolution δ = 0.887 the service sectors AS and MP join the cluster OG-PC-CO and for δ∗3 = 0.894 we have this five-node cluster influencing the other five singleton clusters plus the mentioned hierarchical structure among SC, FR, and RA and an influence edge from WH to RL. When we increase the resolution to δ∗4 = 0.899 we see that RL and WH have joined the main cluster that influences the other three singleton clusters. If we keep increasing the resolution, we would see at resolution δ = 0.900 the sectors SC and FR joining the main cluster which would have influence over RA the only other cluster in the quasipartition. Finally, at resolution δ = 0.909, RA joins the main cluster and the quasi-partition contains only one block.\nThe influence structure between clusters at any given resolution defines a partial order. More precisely, for every resolution δ, the edge set E∗I (δ) defines a partial order between the blocks given by the partition D∗I (δ). We can use this partial order to evaluate the relative importance of different clusters by stating that more important sectors have influence over less important ones. E.g., at resolution δ∗1 = 0.884 we have that MP is more important than every other sector except for RL, which is incomparable at this resolution. There are three totally ordered chains that have MP as the most important sector at this resolution. The first one contains five sectors which are, in decreasing order of importance, MP, CO, OG, PC, and AS. The second one is comprised of MP, SC, FR, and RA and the last one only contains MP and WH. At resolution δ∗2 = 0.886 we observe that the three-node cluster OG-PC-CO, although it contains more nodes than any other cluster, it is not the most important of the quasi-partition. Instead, the singleton cluster MP has influence over the three-node cluster and, on top of that, is comparable with every other cluster in the quasi-partition. From resolution δ∗3 = 0.894 onwards, after MP joins the red cluster, the cluster with the largest number of nodes coincides with the most important of the\nquasi-partition. At resolution δ∗4 = 0.899 we have a total order among the four clusters of the quasi-partition. This is not true for the other three depicted quasi-partitions.\nAs a further illustration of the quasi-clustering method H̃∗, we apply this method to the network NC = (C,AC) of consolidated industrial sectors (Bureau of Economic Analysis, 2011) where |C| = 14 – see Table 2 – instead of the original 61 sectors. Dissimilarity function AC is analogous to AI but computed for the consolidated sectors. Of the output quasi-dendrogram D̃∗C = (D ∗ C , E ∗ C), in Fig. 6-(a) we show the dendrogram component D∗C and in Fig. 6-(b) we depict the quasi-partitions D̃∗C(δ ∗∗ i ) for δ ∗∗ 1 = 0.787, δ∗∗2 = 0.845, δ ∗∗ 3 = 0.868, δ ∗∗ 4 = 0.929, and δ ∗∗ 5 = 0.933. The reason we use the consolidated network NC is to facilitate the visualization of quasi-partitions that capture every sector of the economy instead of only ten particular sectors as in the previous application.\nThe quasi-dendrogram D̃∗C captures the asymmetric influences between clusters of industrial sectors at every resolution. E.g., at resolution δ∗∗1 = 0.787 the dendrogram D∗C in Fig. 6-(a) informs us that every industrial sector forms its own singleton cluster. However, this simplistic representation, characteristic of clustering methods, ignores the asymmetric relations between clusters at resolution δ∗∗1 . These influence relations are formalized in the quasi-dendrogram D̃∗C with the introduction of the edge set E∗C(δ) for every resolution δ. In particular, for δ ∗∗ 1 we see in Fig. 6-(b) that the sectors of ‘Finance, insurance, real estate, rental, and leasing’ (FIR) and ‘Manufacturing’ (MAN) combined have influence over the remaining 12 sectors. More precisely, the influence of FIR is concentrated on the service and commercialization sectors of the economy whereas the influence of MAN is concentrated on primary sectors, transportation, and construction. Furthermore, note that due to the transitivity (QP2) property of quasi-partitions defined in Section 3, the influence of\nFIR over ‘Professional and business services’ (PRO) implies influence of FIR over every sector influenced by PRO. The influence among the remaining 11 sectors, i.e. excluding MAN, FIR and PRO, is minimal, with the ‘Mining’ (MIN) sector influencing the ‘Utilities’ (UTI) sector. This influence is promoted by the influence of the ‘Oil and gas extraction’ (OG) subsector of MIN over the utilities sector. At resolution δ∗∗2 = 0.845, FIR and PRO form one cluster, depicted in red, and they add an influence to the ‘Construction’ (CON) sector apart from the previously formed influences that must persist due to the influence hierarchy property of the edge set E∗C(δ) stated in condition (D̃3) in the definition of quasi-dendrogram in Section 3.1. The manufacturing sector also intensifies its influences by reaching the commercialization sectors ‘Retail trade’ (RET) and ‘Wholesale trade’ (WHO) and the service sector ‘Educational services, health care, and social assistance’ (EHS). The influence among the rest of the sectors is still scarce with the only addition of the influence of ‘Transportation and warehousing’ (TRA) over UTI. At resolution δ∗∗3 = 0.868 we see that mining MIN and manufacturing MAN form their own cluster, depicted in green. The previously formed red cluster has influence over every other cluster in the quasi-partition, including the green one. At resolution δ∗∗4 = 0.929, the red and green clusters become one, composed of four original sectors. Also, the influence of the transportation TRA sector over the rest is intensified with the appearance of edges to the primary sector ‘Agriculture, forestry, fishing, and hunting’ (AGR), the construction CON sector and the commercialization sectors RET and WHO. Finally, at resolution δ∗∗5 = 0.933 there is one clear main cluster depicted in red and composed of seven sectors spanning the primary, secondary, and tertiary sectors of the economy. This main cluster influences every other singleton cluster. The only other influence in the quasi-partition D̃∗C(0.933) is the one of RET over CON. For increasing resolutions, the singleton clusters join the main red cluster until at resolution δ = 0.988 the 14 sec-\ntors form one single cluster.\nThe influence structure at every resolution induces a partial order in the blocks of the corresponding quasi-partition. As done in previous examples, we can interpret this partial order as a relative importance ordering. E.g., we can say that at resolution δ∗∗1 = 0.787, MAN is more important that MIN which in turn is more important than UTI which is less important than PRO. However, PRO and MAN are not comparable at this resolution. At resolution δ∗∗4 = 0.929, after the red and green clusters have merged together at resolution δ = 0.869, we depict the combined cluster as red. This representation is not arbitrary, the red color of the combined cluster is inherited from the most important of the two component cluster. The fact that the red cluster is more important than the green one is represented by the edge from the former to the latter in the quasi-partition at resolution δ∗∗3 . In this sense, the edge component E ∗ C of the quasi-dendrogram formalizes a hierarchical structure between clusters at a fixed resolution apart from the hierarchical structure across resolutions given by the dendrogram component D∗C of the quasi-dendrogram. E.g., if we focus only on the dendrogram D∗C in Fig. 6-(a), the nodes MIN and MAN seem to play the same role. However, when looking at the quasi-partitions at resolutions δ∗∗1 and δ∗∗2 , it is clear that MAN has influence over a larger set of nodes than MIN and hence plays a more important role in the clustering for increasing resolutions. Indeed, if we delete the three nodes with the strongest influence structure, namely PRO, FIR, and MAN, and apply the quasiclustering method H̃∗ on the remaining 11 nodes, the first merging occurs between the mining MIN and utilities UTI sectors at δ = 0.960. At this same resolution, in the original dendrogram component in Fig. 6-(a), a main cluster composed of 12 nodes only excluding ‘Other services, except government’ (OSE) and EHS is formed. This indicates that by removing influential sectors of the economy, the tendency to cluster of the remaining sectors is decreased."
    } ],
    "references" : [ {
      "title" : "Asymmetric clusters of internal migration regions of france",
      "author" : [ "J.P. Boyd" ],
      "venue" : "Ieee Transactions on Systems Man and Cybernetics,",
      "citeRegEx" : "Boyd,? \\Q1980\\E",
      "shortCiteRegEx" : "Boyd",
      "year" : 1980
    }, {
      "title" : "Characterization, stability and convergence of hierarchical clustering methods",
      "author" : [ "G. Carlsson", "F. Mémoli" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Carlsson and Mémoli,? \\Q2010\\E",
      "shortCiteRegEx" : "Carlsson and Mémoli",
      "year" : 2010
    }, {
      "title" : "Classifying clustering schemes",
      "author" : [ "G. Carlsson", "F. Mémoli" ],
      "venue" : "Foundations of Computational Mathematics,",
      "citeRegEx" : "Carlsson and Mémoli,? \\Q2013\\E",
      "shortCiteRegEx" : "Carlsson and Mémoli",
      "year" : 2013
    }, {
      "title" : "Axiomatic construction of hierarchical clustering in asymmetric networks",
      "author" : [ "G. Carlsson", "F. Memoli", "A. Ribeiro", "S. Segarra" ],
      "venue" : "In Acoustics, Speech and Signal Processing (ICASSP),",
      "citeRegEx" : "Carlsson et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Carlsson et al\\.",
      "year" : 2013
    }, {
      "title" : "Fast algorithms for (max, min)matrix multiplication and bottleneck shortest paths",
      "author" : [ "R. Duan", "S. Pettie" ],
      "venue" : "Symposium on discrete algorithms,",
      "citeRegEx" : "Duan and Pettie,? \\Q2009\\E",
      "shortCiteRegEx" : "Duan and Pettie",
      "year" : 2009
    }, {
      "title" : "Graphs, dioids and semi rings: New models and algorithms",
      "author" : [ "M. Gondran", "M. Minoux" ],
      "venue" : null,
      "citeRegEx" : "Gondran and Minoux,? \\Q2008\\E",
      "shortCiteRegEx" : "Gondran and Minoux",
      "year" : 2008
    }, {
      "title" : "Metric structures for Riemannian and nonRiemannian spaces",
      "author" : [ "M. Gromov" ],
      "venue" : null,
      "citeRegEx" : "Gromov,? \\Q2007\\E",
      "shortCiteRegEx" : "Gromov",
      "year" : 2007
    }, {
      "title" : "Characterizing (quasi-) ultrametric finite spaces in terms of (directed) graphs",
      "author" : [ "V. Gurvich", "M. Vyalyi" ],
      "venue" : "Discrete Applied Mathematics,",
      "citeRegEx" : "Gurvich and Vyalyi,? \\Q2012\\E",
      "shortCiteRegEx" : "Gurvich and Vyalyi",
      "year" : 2012
    }, {
      "title" : "Min and max hierarchical clustering using asymmetric similarity measures",
      "author" : [ "L. Hubert" ],
      "venue" : null,
      "citeRegEx" : "Hubert,? \\Q1973\\E",
      "shortCiteRegEx" : "Hubert",
      "year" : 1973
    }, {
      "title" : "Algorithms for clustering data",
      "author" : [ "A.K. Jain", "R.C. Dubes" ],
      "venue" : null,
      "citeRegEx" : "Jain and Dubes,? \\Q1988\\E",
      "shortCiteRegEx" : "Jain and Dubes",
      "year" : 1988
    }, {
      "title" : "Mathematical taxonomy",
      "author" : [ "N. Jardine", "R. Sibson" ],
      "venue" : "Wiley Series in Probability and Mathematical Statistics",
      "citeRegEx" : "Jardine and Sibson,? \\Q1971\\E",
      "shortCiteRegEx" : "Jardine and Sibson",
      "year" : 1971
    }, {
      "title" : "A general theory of classificatory sorting strategies 1. Hierarchical systems",
      "author" : [ "G.N. Lance", "W.T. Williams" ],
      "venue" : "Computer Journal,",
      "citeRegEx" : "Lance and Williams,? \\Q1967\\E",
      "shortCiteRegEx" : "Lance and Williams",
      "year" : 1967
    }, {
      "title" : "Clustering by weighted cuts in directed graphs",
      "author" : [ "M. Meila", "W. Pentney" ],
      "venue" : "Proceedings of the 7th SIAM International Conference on Data Mining,",
      "citeRegEx" : "Meila and Pentney,? \\Q2007\\E",
      "shortCiteRegEx" : "Meila and Pentney",
      "year" : 2007
    }, {
      "title" : "Multidimensional clustering algorithms",
      "author" : [ "F. Murtagh" ],
      "venue" : "Compstat Lectures, Vienna: Physika Verlag, 1985,",
      "citeRegEx" : "Murtagh,? \\Q1985\\E",
      "shortCiteRegEx" : "Murtagh",
      "year" : 1985
    }, {
      "title" : "Community structure in social and biological networks",
      "author" : [ "M. Newman", "M. Girvan" ],
      "venue" : "Proc. Ntnl. Acad. Sci.,",
      "citeRegEx" : "Newman and Girvan,? \\Q2002\\E",
      "shortCiteRegEx" : "Newman and Girvan",
      "year" : 2002
    }, {
      "title" : "Finding and evaluating community structure in networks",
      "author" : [ "M. Newman", "M. Girvan" ],
      "venue" : "Phys. Rev. E,",
      "citeRegEx" : "Newman and Girvan,? \\Q2004\\E",
      "shortCiteRegEx" : "Newman and Girvan",
      "year" : 2004
    }, {
      "title" : "On spectral clustering: Analysis and an algorithm",
      "author" : [ "A. Ng", "M. Jordan", "Y. Weiss" ],
      "venue" : "Advances in neural information processing systems",
      "citeRegEx" : "Ng et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Ng et al\\.",
      "year" : 2002
    }, {
      "title" : "Spectral clustering of biological sequence data",
      "author" : [ "W. Pentney", "M. Meila" ],
      "venue" : "Proc. Ntnl. Conf. Artificial Intel.,",
      "citeRegEx" : "Pentney and Meila,? \\Q2005\\E",
      "shortCiteRegEx" : "Pentney and Meila",
      "year" : 2005
    }, {
      "title" : "Data analysis of asymmetric structures: advanced approaches in computational statistics",
      "author" : [ "T. Saito", "H. Yadohisa" ],
      "venue" : null,
      "citeRegEx" : "Saito and Yadohisa,? \\Q2004\\E",
      "shortCiteRegEx" : "Saito and Yadohisa",
      "year" : 2004
    }, {
      "title" : "Normalized cuts and image segmentation",
      "author" : [ "J. Shi", "J. Malik" ],
      "venue" : "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
      "citeRegEx" : "Shi and Malik,? \\Q2000\\E",
      "shortCiteRegEx" : "Shi and Malik",
      "year" : 2000
    }, {
      "title" : "Hierarchical internal migration regions of france",
      "author" : [ "P.B. Slater" ],
      "venue" : "Systems, Man and Cybernetics, IEEE Transactions on,",
      "citeRegEx" : "Slater,? \\Q1976\\E",
      "shortCiteRegEx" : "Slater",
      "year" : 1976
    }, {
      "title" : "A partial hierarchical regionalization of 3140 us counties on the basis of 1965-1970 intercounty migration",
      "author" : [ "P.B. Slater" ],
      "venue" : "Environment and Planning A,",
      "citeRegEx" : "Slater,? \\Q1984\\E",
      "shortCiteRegEx" : "Slater",
      "year" : 1984
    }, {
      "title" : "An improved algorithm for hierarchical clustering using strong components",
      "author" : [ "R.E. Tarjan" ],
      "venue" : "Inf. Process. Lett.,",
      "citeRegEx" : "Tarjan,? \\Q1983\\E",
      "shortCiteRegEx" : "Tarjan",
      "year" : 1983
    }, {
      "title" : "All pairs bottleneck paths and max-min matrix products in truly subcubic time",
      "author" : [ "V. Vassilevska", "R. Williams", "R. Yuster" ],
      "venue" : "Theory of Computing,",
      "citeRegEx" : "Vassilevska et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Vassilevska et al\\.",
      "year" : 2009
    }, {
      "title" : "A tutorial on spectral clustering",
      "author" : [ "U. Von Luxburg" ],
      "venue" : "Statistics and Computing, 17(4):395–416,",
      "citeRegEx" : "Luxburg,? \\Q2007\\E",
      "shortCiteRegEx" : "Luxburg",
      "year" : 2007
    }, {
      "title" : "Hierarchical clustering algorithms for document datasets",
      "author" : [ "Y. Zhao", "G. Karypis" ],
      "venue" : "Data Mining and Knowledge Discovery,",
      "citeRegEx" : "Zhao and Karypis,? \\Q2005\\E",
      "shortCiteRegEx" : "Zhao and Karypis",
      "year" : 2005
    }, {
      "title" : "H̃(X,AX) = H̃∗(X, ĀX",
      "author" : [ "X ∈ N . A" ],
      "venue" : null,
      "citeRegEx" : "A.8.,? \\Q2008\\E",
      "shortCiteRegEx" : "A.8.",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 16,
      "context" : "Clusters that arise at a given resolution correspond to sets of nodes that are more similar to each other than to the rest and, as such, can be used to study the formation of groups and communities (Shi & Malik, 2000; Newman & Girvan, 2002; 2004; Von Luxburg, 2007; Ng et al., 2002; Lance & Williams, 1967; Jain & Dubes, 1988).",
      "startOffset" : 198,
      "endOffset" : 326
    }, {
      "referenceID" : 8,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 20,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 0,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 22,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 21,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 13,
      "context" : "datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan, 1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila & Pentney, 2007; Zhao & Karypis, 2005).",
      "startOffset" : 9,
      "endOffset" : 160
    }, {
      "referenceID" : 3,
      "context" : "This difficulty motivates formal developments whereby hierarchical clustering methods are constructed as those that are admissible with respect to some reasonable properties (Carlsson & Mémoli, 2010; 2013; Carlsson et al., 2013).",
      "startOffset" : 174,
      "endOffset" : 228
    }, {
      "referenceID" : 3,
      "context" : "A fundamental distinction between symmetric and asymmetric networks is that while it is easy to obtain uniqueness results for the former (Carlsson & Mémoli, 2010), there are a variety of methods that are admissible for the latter (Carlsson et al., 2013).",
      "startOffset" : 230,
      "endOffset" : 253
    }, {
      "referenceID" : 3,
      "context" : "Since dendrograms are symmetric structures one has to make a decision as to how to derive symmetry from an asymmetric dataset and there are different stages of the clustering process at which such symmetrization can be carried out (Carlsson et al., 2013).",
      "startOffset" : 231,
      "endOffset" : 254
    }, {
      "referenceID" : 3,
      "context" : "In (Carlsson et al., 2013), they show that when replacing metric spaces by more general asymmetric networks, the uniqueness result is lost and an infinite number of methods satisfy the admissibility axioms.",
      "startOffset" : 3,
      "endOffset" : 26
    }, {
      "referenceID" : 3,
      "context" : "In this way, it becomes clear that the non-uniqueness result for asymmetric networks in (Carlsson et al., 2013) is originated in the symmetry mismatch between the input asymmetric network and the output symmetric dendrogram.",
      "startOffset" : 88,
      "endOffset" : 111
    }, {
      "referenceID" : 0,
      "context" : "DSL was identified as a natural extension of single linkage hierarchical clustering to asymmetric networks in (Boyd, 1980).",
      "startOffset" : 110,
      "endOffset" : 122
    }, {
      "referenceID" : 6,
      "context" : "We define an analogue to the GromovHausdorff distance (Gromov, 2007) between metric spaces, which we denote dN and defines a legitimate metric on N (see A.",
      "startOffset" : 54,
      "endOffset" : 68
    }, {
      "referenceID" : 23,
      "context" : "Indeed, there exist sub cubic dioid power algorithms (Vassilevska et al., 2009; Duan & Pettie, 2009) of complexity O(n).",
      "startOffset" : 53,
      "endOffset" : 100
    }, {
      "referenceID" : 22,
      "context" : "For instance, Tarjan’s method (Tarjan, 1983), which takes as input an asymmetric network but in contrast to our method enforces symmetry in its output, runs in time O(n log n) for complete networks.",
      "startOffset" : 30,
      "endOffset" : 44
    }, {
      "referenceID" : 20,
      "context" : "The application of hierarchical clustering to migration data has been extensively investigated by Slater, see (Slater, 1976; 1984).",
      "startOffset" : 110,
      "endOffset" : 130
    } ],
    "year" : 2014,
    "abstractText" : "This paper introduces hierarchical quasiclustering methods, a generalization of hierarchical clustering for asymmetric networks where the output structure preserves the asymmetry of the input data. We show that this output structure is equivalent to a finite quasi-ultrametric space and study admissibility with respect to two desirable properties. We prove that a modified version of single linkage is the only admissible quasi-clustering method. Moreover, we show stability of the proposed method and we establish invariance properties fulfilled by it. Algorithms are further developed and the value of quasi-clustering analysis is illustrated with a study of internal migration within United States.",
    "creator" : "LaTeX with hyperref package"
  }
}