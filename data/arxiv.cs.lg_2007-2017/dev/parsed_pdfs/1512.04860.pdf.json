{
  "name" : "1512.04860.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Increasing the Action Gap: New Operators for Reinforcement Learning",
    "authors" : [ "Marc G. Bellemare", "Georg Ostrovski", "Arthur Guez", "Philip S. Thomas", "Rémi Munos" ],
    "emails" : [ "bellemare@google.com;", "ostrovski@google.com;", "aguez@google.com;", "munos@google.com;", "philipt@cs.cmu.edu" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Value-based reinforcement learning is an attractive solution to planning problems in environments with unknown, unstructured dynamics. In its canonical form, value-based reinforcement learning produces successive refinements of an initial value function through repeated application of a convergent operator. In particular, value iteration (Bellman 1957) directly computes the value function through the iterated evaluation of Bellman’s equation, either exactly or from samples (e.g. Q-Learning, Watkins 1989).\nIn its simplest form, value iteration begins with an initial value function V0 and successively computes Vk+1 := T Vk, where T is the Bellman operator. When the environment dynamics are unknown, Vk is typically replaced by Qk, the state-action value function, and T is approximated by an empirical Bellman operator. The fixed point of the Bellman operator, Q∗, is the optimal state-action value function or optimal Q-function, from which an optimal policy π∗ can be recovered.\nIn this paper we argue that the optimal Q-function is inconsistent, in the sense that for any action a which is subop∗Now at Carnegie Mellon University. Copyright c© 2016, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved.\ntimal in state x, Bellman’s equation for Q∗(x, a) describes the value of a nonstationary policy: upon returning to x, this policy selects π∗(x) rather than a. While preserving global consistency appears impractical, we propose a simple modification to the Bellman operator which provides us a with a first-order solution to the inconsistency problem. Accordingly, we call our new operator the consistent Bellman operator.\nWe show that the consistent Bellman operator generally devalues suboptimal actions but preserves the set of optimal policies. As a result, the action gap – the value difference between optimal and second best actions – increases. Increasing the action gap is advantageous in the presence of approximation or estimation error (Farahmand 2011), and may be crucial for systems operating at a fine time scale such as video games (Togelius et al. 2009; Bellemare et al. 2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011). In fact, the idea of devaluating suboptimal actions underpins Baird’s advantage learning (Baird 1999), designed for continuous time control, and occurs naturally when considering the discretized solution of continuous time and space MDPs (e.g. Munos and Moore 1998; 2002), whose limit is the Hamilton-Jacobi-Bellman equation (Kushner and Dupuis 2001). Our empirical results on the bicycle domain (Randlov and Alstrom 1998) show a marked increase in performance from using the consistent Bellman operator.\nIn the second half of this paper we derive novel sufficient conditions for an operator to preserve optimality. The relative weakness of these new conditions reveal that it is possible to deviate significantly from the Bellman operator without sacrificing optimality: an optimality-preserving operator needs not be contractive, nor even guarantee convergence of the Q-values for suboptimal actions. While numerous alternatives to the Bellman operator have been put forward (e.g. recently Azar et al. 2011; Bertsekas and Yu 2012), we believe our work to be the first to propose such a major departure from the canonical fixed-point condition required from an optimality-preserving operator. As proof of the richness of this new operator family we describe a few practical instantiations with unique properties.\nWe use our operators to obtain state-of-the-art empirical\nar X\niv :1\n51 2.\n04 86\n0v 1\n[ cs\n.A I]\n1 5\nD ec\n2 01\n5\nresults on the Arcade Learning Environment (Bellemare et al. 2013). We consider the Deep Q-Network (DQN) architecture of Mnih et al. (2015), replacing only its learning rule with one of our operators. Remarkably, this one-line change produces agents that significantly outperform the original DQN. Our work, we believe, demonstrates the potential impact of rethinking the core components of value-based reinforcement learning."
    }, {
      "heading" : "Background",
      "text" : "We consider a Markov decision process M := (X ,A, P,R, γ) where X is the state space, A is the finite action space, P is the transition probability kernel, R is the reward function mapping state-action pairs to a bounded subset of R, and γ ∈ [0, 1) is the discount factor. We denote by Q := QX ,A and V := VX the space of bounded real-valued functions over X × A and X , respectively. For Q ∈ Q we write V (x) := maxaQ(x, a), and follow this convention for related quantities (Ṽ for Q̃, V ′ for Q′, etc.) whenever convenient and unambiguous. In the context of a specific (x, a) ∈ X × A we further write EP := Ex′∼P (· | x,a) to mean the expectation with respect to P (· |x, a), with the convention that x′ always denotes the next state random variable.\nA deterministic policy π : X → A induces a Q-function Qπ ∈ Q whose Bellman equation is\nQπ(x, a) := R(x, a) + γEP Qπ(x′, π(x′)).\nThe state-conditional expected return V π(x) := Qπ(x, π(x)) is the expected discounted total reward received from starting in x and following π.\nThe Bellman operator T : Q → Q is defined pointwise as\nT Q(x, a) := R(x, a) + γEP max b∈A Q(x′, b). (1)\nT is a contraction mapping in supremum norm (Bertsekas and Tsitsiklis 1996) whose unique fixed point is the optimal Q-function\nQ∗(x, a) = R(x, a) + γEP max b∈A Q∗(x′, b),\nwhich induces the optimal policy π∗:\nπ∗(x) := arg max a∈A Q∗(x, a) ∀x ∈ X .\nA Q-function Q ∈ Q induces a greedy policy π(x) := arg maxaQ(x, a), with the property that Q\nπ = Q if and only if Q = Q∗. For x ∈ X we call π(x) the greedy action with respect to Q and a 6= π(x) a nongreedy action; for π∗ these are the usual optimal and suboptimal actions, respectively.\nWe emphasize that while we focus on the Bellman operator, our results easily extend to its variations such as SARSA (Rummery and Niranjan 1994), policy evaluation (Sutton 1988), and fitted Q-iteration (Ernst, Geurts, and Wehenkel 2005). In particular, our new operators all have a sample-based form, i.e., an analogue to the Q-Learning rule of Watkins (1989)."
    }, {
      "heading" : "The Consistent Bellman Operator",
      "text" : "It is well known (and implicit in our notation) that the optimal policy π∗ for M is stationary (i.e., time-independent) and deterministic. In looking for π∗, we may therefore restrict our search to the space Π of stationary deterministic policies. Interestingly, as we now show the Bellman operator on Q is not, in a sense, restricted to Π.\nTo begin, consider the two-state MDP depicted in Figure 1. This MDP abstracts a Faustian situation in which an agent repeatedly chooses between an immediately rewarding but ultimately harmful option (a1), or an unrewarding alternative (a2). For concreteness, we imagine the agent as faced with an endless supply of delicious cake (with γ > 0) and call these the “cake” and “no cake” actions.\nEating cake can cause a transition to x2, the “bad state”, whose value is independent of the agent’s policy:\nV π(x2) := −2(1 + ) 1\nγ ∀π ∈ Π.\nIn state x1, however, the Q-values depend on the agent’s future behaviour. For a policy π ∈ Π, the value of a1 is\nQπ(x1, a1) = 1 + γ\n[ 1\n2 V π(x1) +\n1 2 V π(x2)\n] (2)\n= 1 + γ\n2 V π(x1)− (1 + ) =\nγ 2 V π(x1)− .\nBy contrast, the value of a2 is\nQπ(x1, a2) = 0 + γV π(x1),\nwhich is greater thanQπ(x1, a1) for all π. It follows that not eating cake is optimal, and thus V ∗(x1) = Q∗(x1, a2) = 0. Furthermore, (2) tells us that the value difference between optimal and second best action, or action gap, is\nQ∗(x1, a2)−Q∗(x1, a1) = . Notice that Q∗(x1, a1) = − does not describe the value of any stationary policy. That is, the policy π̃ with π̃(x1) = a1 has value\nV π̃(x1) = − + γ\n2 V π̃(x1) = − 1− γ/2 , (3)\nand in particular this value is lower than Q∗(x1, a1). Instead,Q∗(x1, a1) describes the value of a nonstationary policy which eats cake once, but then subsequently abstains.\nSo far we have considered the Q-functions of given stationary policies π, and argued that these are nonstationary. We now make a similar statement about the Bellman operator: for any Q ∈ Q, the nongreedy components of Q′ := T Q do not generally describe the expected return of stationary policies. Hence the Bellman operator is not restricted to Π.\nWhen the MDP of interest can be solved exactly, this nonstationarity is a non-issue since only the Q-values for optimal actions matter. In the presence of estimation or approximation error, however, small perturbations in the Q-function may result in erroneously identifying the optimal action. Our example illustrates this effect: an estimate Q̂ of Q∗ which is off by can induce a pessimal greedy policy (i.e. π̃).\nTo address this issue, we may be tempted to define a new Q-function which explicitly incorporates stationarity:\nQπSTAT(x, a) := R(x, a) + γEP max b∈A\nQπ ′ STAT(x ′, b), (4)\nπ′(y) := { a if y = x, π(y) otherwise.\nUnder this new definition, the action gap of the optimal policy is 1−γ/2 > Q\n∗(x1, a2)−Q∗(x1, a1). Unfortunately, (4) does not visibly yield a useful operator on Q. As a practical approximation we now propose the consistent Bellman operator, which preserves a local form of stationarity:\nTCQ(x, a) := R(x, a) + (5) γEP [ I[x 6=x′] max\nb∈A Q(x′, b) + I[x=x′]Q(x, a)\n] .\nEffectively, our operator redefines the meaning of Q-values: if from state x ∈ X an action a is taken and the next state is x′ = x then a is again taken. In our example, this new Q-value describes the expected return for repeatedly eating cake until a transition to the unpleasant state x2.\nSince the optimal policy π∗ is stationary, we may intuit that iterated application of this new operator also yields π∗. In fact, below we show that the consistent Bellman operator is both optimality-preserving and, in the presence of direct loops in the corresponding transition graph, gap-increasing: Definition 1. An operator T ′ is optimality-preserving if, for any Q0 ∈ Q and x ∈ X , letting Qk+1 := T ′Qk,\nṼ (x) := lim k→∞ max a∈A Qk(x, a)\nexists, is unique, Ṽ (x) = V ∗(x), and for all a ∈ A, Q∗(x, a) < V ∗(x, a) =⇒ lim sup\nk→∞ Qk(x, a) < V\n∗(x).\nThus under an optimality-preserving operator at least one optimal action remains optimal, and suboptimal actions remain suboptimal. Definition 2. Let M be an MDP. An operator T ′ for M is gap-increasing if for all Q0 ∈ Q, x ∈ X , a ∈ A, letting Qk+1 := T ′Qk and Vk(x) := maxbQk(x, b),\nlim inf k→∞\n[ Vk(x)−Qk(x, a) ] ≥ V ∗(x)−Q∗(x, a). (6)\nWe are particularly interested in operators which are strictly gap-increasing, in the sense that (6) is a strict inequality for at least one (x, a) pair.\nOur two-state MDP illustrates the first benefit of increasing the action gap: a greater robustness to estimation error. Indeed, under our new operator the optimal Q-value of eating cake becomes\nQ̃(x1, a1) = γ\n2 Q̃(x1, a1)− = − 1− γ/2 ,\nwhich is, again, smaller thanQ∗(x1, a1) whenever γ > 0. In the presence of approximation error in the Q-values, we may thus expect Q̃(x1, a1) < Q̃(x1, a2) to occur more frequently than the converse."
    }, {
      "heading" : "Aggregation Methods",
      "text" : "At first glance, the use of an indicator function in (5) may seem limiting: P (x |x, a) may be zero or close to zero everywhere, or the state may be described by features which preclude a meaningful identity test I[x=x′]. There is, however, one important family of value functions which have “tabular-like” properties: aggregation schemes (Bertsekas 2011). As we now show, the consistent Bellman operator is well-defined for all aggregation schemes.\nAn aggregation scheme for M is a tuple (Z, A,D) where Z is a set of aggregate states, A is a mapping from X to distributions over Z , and D is a mapping from Z to distributions over X . For z ∈ Z, x′ ∈ X let ED := Ex∼D(· | z) and EA := Ez′∼A(· | x′), where as before we assign specific roles to x, x′ ∈ X and z, z′ ∈ Z . We define the aggregation Bellman operator TA : QZ,A → QZ,A as\nTAQ(z, a) := ED [ R(x, a) + γEP EA max\nb∈A Q(z′, b)\n] . (7)\nWhen Z is a finite subset of X and D corresponds to the identity transition function, i.e. D(x | z) = I[x=z], we recover the class of averagers (Gordon 1995; e.g., multilinear interpolation, illustrated in Figure 2) and kernel-based methods (Ormoneit and Sen 2002). If A also corresponds to the identity and X is finite, TA reduces to the Bellman operator (1) and we recover the familiar tabular representation (Sutton and Barto 1998).\nGeneralizing (5), we define the consistent Bellman operator TC over QZ,A: TCQ(z, a) := ED [ R(x, a) + (8)\nγEP EA [ I[z 6=z′] max\nb∈A Q(z′, b) + I[z=z′]Q(z, a)\n]] .\nIntuitively (see, e.g., Bertsekas 2011), the D and A mappings induce a new MDP, M ′ := (Z,A, P ′, R′, γ) with\nR′(z, a) := ED R(x, a),\nP ′(z′′ | z, a) := EDEP EA I[z′′=z′]. In this light, we see that our original definition of TC and (8) only differ in their interpretation of the transition kernel. Thus the consistent Bellman operator remains relevant in cases where P is a deterministic transition kernel, for example when applying multilinear or barycentric interpolation to continuous space MDPs (e.g. Munos and Moore 1998).\nQ-Value Interpolation Aggregation schemes as defined above do not immediately yield a Q-function over X . Indeed, the Q-value at an arbitrary x ∈ X is defined (in the ordinary Bellman operator sense) as\nQ(x, a) := R(x, a) + γEP EA max b∈A\nQ(z′, b), (9)\nwhich may only be computed from a full or partial model of the MDP, or by inverting D. It is often the case that neither is feasible. One solution is instead to perform Q-value interpolation:\nQ(x, a) := Ez′∼A(· | x)Q(z′, a),\nwhich is reasonable when A(· |x) are interpolation coefficients1. This gives the related Bellman operator\nTQVIQ(z, a) := ED [ R(x, a) + γEP max\nb∈A Q(x′, b)\n] ,\nwith TQVIQ(z, a) ≤ T Q(z, a) by convexity of the max operation. From here one may be tempted to define the corresponding consistent operator as\nT ′QVIQ(z, a) := ED [ R(x, a) +\nγEP max b∈A\n[ Q(x′, b)−A(z |x′) ( Q(z, b)−Q(z, a) )]] .\nWhile T ′QVI remains a contraction, T ′QVIQ(z, a) ≤ TQVIQ(z, a) is not guaranteed, and it is easy to show that T ′QVI is not optimality-preserving. Instead we define the consistent Q-value interpolation Bellman operator as\nTCQVIQ := min { TQVIQ, T ′QVIQ } . (10)\nAs a corollary to Theorem 1 below we will prove that TCQVI is also optimality-preserving and gap-increasing.\n1One then typically, but not always, takes D to be the identity."
    }, {
      "heading" : "Experiments on the Bicycle Domain",
      "text" : "We now study the behaviour of our new operators on the bicycle domain (Randlov and Alstrom 1998). In this domain, the agent must simultaneously balance a simulated bicycle and drive it to a goal 1km north of its initial position. Each time step consists of a hundredth of a second, with a successful episode typically lasting 50,000 or more steps. The driving aspect of this problem is particularly challenging for value-based methods, since each step contributes little to an eventual success and the “curse of dimensionality” (Bellman 1957) precludes a fine representation of the state-space. In this setting our consistent operator provides significantly improved performance and stability.\nWe approximated value functions using multilinear interpolation on a uniform 10×· · ·×10 grid over a 6-dimensional feature vector ϕ := (ω, ω̇, θ, θ̇, ψ, d). The first four components of ϕ describe relevant angles and angular velocities, while ψ and d are polar coordinates describing the bicycle’s position relative to the goal. We approximated Q-functions using Q-value interpolation (TCQVI) over this grid, since in a typical setting we may not have access to a forward model.\nWe are interested here in the quality of the value functions produced by different operators. We thus computed our Q-functions using value iteration, rather than a trajectorybased method such as Q-Learning. More precisely, at each iteration we simultaneously apply our operator to all grid points, with expected next state values estimated from samples. The interested reader may find full experimental details and videos in the appendix.2\nWhile the limiting value functions (Ṽ and V ∗) coincide on Z ⊆ X (by the optimality-preserving property), they may differ significantly elsewhere. For x ∈ X we have\nṼ (x) = maxa Q̃(x, a) = maxaEA(· | x) Q̃(z, a)\n6= V ∗(x) in general. This is especially relevant in the relatively highdimensional bicycle domain, where a fine discretization of the state space is not practical and most of the trajectories take place “far” from grid points. As an example, consider ψ, the relative angle to the goal: each grid cell covers an arc of 2π/10 = π/5, while a single time step typically changes ψ by less than π/1000.\nFigure 3 summarizes our results. Policies derived from our consistent operator can safely balance the bicycle earlier on, and also reach the goal earlier than policies derived from the Bellman operator. Note, in particular, the striking difference in the trajectories followed by the resulting policies. The effect is even more pronounced when using a 8 × · · · × 8 grid (results provided in the appendix). Effectively, by decreasing suboptimal Q-values at grid points we produce much better policies within the grid cells. This phenomenon is consistent with the theoretical results of Farahmand (2011) relating the size of action gaps to the quality of derived greedy policies. Thus we find a second benefit to increasing the action gap: it improves policies derived from Q-value interpolation.\n2Videos: https://youtu.be/0pUFjNuom1A"
    }, {
      "heading" : "A Family of Convergent Operators",
      "text" : "One may ask whether it is possible to extend the consistent Bellman operator to Q-value approximation schemes which lack a probabilistic interpretation, such as linear approximation (Sutton 1996), locally weighted regression (Atkeson 1991), neural networks (Tesauro 1995), or even informationtheoretic methods (Veness et al. 2015). In this section we answer by the affirmative.\nThe family of operators which we describe here are applicable to arbitrary Q-value approximation schemes. While these operators are in general no longer contractions, they are gap-increasing, and optimality-preserving when the Qfunction is represented exactly. Theorem 1 is our main result; one corollary is a convergence proof for Baird’s advantage learning (Baird 1999). Incidentally, our taking the minimum in (10) was in fact no accident, but rather a simple application of this theorem. Theorem 1. Let T be the Bellman operator defined by (1). Let T ′ be an operator with the property that there exists an α ∈ [0, 1) such that for all Q ∈ Q, x ∈ X , a ∈ A, and letting V (x) := maxbQ(x, b),\n1. T ′Q(x, a) ≤ T Q(x, a), and 2. T ′Q(x, a) ≥ T Q(x, a)− α [V (x)−Q(x, a)]. Then T ′ is both optimality-preserving and gap-increasing.\nThus any operator which satisfies the conditions of Theorem 1 will eventually yield an optimal greedy policy, assuming an exact representation of the Q-function. Condition 2, in particular, states that we may subtract up to (but not including) maxbQk(x, b) − Qk(x, a) from Qk(x, a) at each iteration. This is exactly the action gap at (x, a), but for Qk,\nrather than the optimal Q∗. For a particular x, this implies we may initially devalue the optimal action a∗ := π∗(x) in favour of the greedy action. But our theorem shows that a∗ cannot be undervalued infinitely often, and in factQk(x, a∗) must ultimately reach V ∗(x).3 The proof of this perhaps surprising result may be found in the appendix.\nTo the best of our knowledge, Theorem 1 is the first result to show the convergence of iterates of dynamic programming-like operators without resorting to a contraction argument. Indeed, the conditions of Theorem 1 are particularly weak: we do not require T ′ to be a contraction, nor do we assume the existence of a fixed point (in the Qfunction space Q) of T ′. In fact, the conditions laid out in Theorem 1 characterize the set of optimality-preserving operators on Q, in the following sense: Remark 1. There exists a single-state MDP M and an operator T ′ with either\n1. T ′Q(x, a) > T Q(x, a) or 2. T ′Q(x, a) < T Q(x, a)− [V (x)−Q(x, a)], and in both cases there exists a Q0 ∈ Q for which limk→∞maxa(T ′)kQ0(x, a) 6= V ∗(x).\nWe note that the above remark does not cover the case where condition (2) is an equality (i.e., α = 1). We leave as an open problem the existence of a divergent example for α = 1.\nCorollary 1. The consistent Bellman operator TC (8) and consistent Q-value interpolation Bellman operator TCQVI (10) are optimality-preserving.\nIn fact, it is not hard to show that the consistent Bellman operator (7) is a contraction, and thus enjoys even stronger convergence guarantees than those provided by Theorem 1. Informally, whenever Condition 2 of the theorem is strengthened to an inequality, we may also expect our operators to be gap-increasing; this is in fact the case for both of our consistent operators.\nTo conclude this section, we describe a few operators which satisfy the conditions of Theorem 1, and are thus optimality-preserving and gap-increasing. Critically, none of these operators are contractions; one of them, the “lazy” operator, also possesses multiple fixed points."
    }, {
      "heading" : "Baird’s Advantage Learning",
      "text" : "The method of advantage learning was proposed by Baird (1999) as a means of increasing the gap between the optimal and suboptimal actions in the context of residual algorithms applied to continuous time problems.4 The corresponding operator is\nT ′Q(x, a) = K−1 [ R(x, a) +\nγ∆t EP V (x′) + (K − 1)V (x) ] ,\n3When two or more actions are optimal, we are only guaranteed that one of them will ultimately be correctly valued. The “1-lazy” operator described below exemplifies this possibility.\n4Advantage updating, also by Baird, is a popular but different idea where an agent maintains both V and A := Q− V .\nwhere ∆t > 0 is a time constant and K := C∆t with C > 0. Taking ∆t = 1 and α := 1−K, we define a new operator with the same fixed point but a now-familiar form:\nTALQ(x, a) := T Q(x, a)− α [V (x)−Q(x, a)] . Note that, while the two operators are motivated by the same principle and share the same fixed point, they are not isomorphic. We believe our version to be more stable in practice, as it avoids the multiplication by the K−1 term. Corollary 2. For α ∈ [0, 1), the advantage learning operator TAL has a unique limit VAL ∈ V , and VAL = V ∗.\nWhile our consistent Bellman operator originates from different principles, there is in fact a close relationship between it and the advantage learning operator. Indeed, we can rewrite (5) as\nTCQ(x, a) = T Q(x, a)− γP (x |x, a) [V (x)−Q(x, a)] , which corresponds to advantage learning with a (x, a)dependent α parameter."
    }, {
      "heading" : "Persistent Advantage Learning",
      "text" : "In domains with a high temporal resolution, it may be advantageous to encourage greedy policies which infrequently switch between actions — to encourage a form of persistence. We define an operator which favours repeated actions:\nTPALQ(x, a) := max { TALQ(x, a), R(x, a) + γEP Q(x′, a) } .\nNote that the second term of the max can also be written as\nT Q(x, a)− γEP [V (x′)−Q(x′, a)] . As we shall see below, persistent advantage learning achieves excellent performance on Atari 2600 games."
    }, {
      "heading" : "The Lazy Operator",
      "text" : "As a curiosity, consider the following operator with α ∈ [0, 1):\nT ′Q(x, a) :=  Q(x, a) if Q(x, a)≤T Q(x, a) and T Q(x, a) ≤αV (x) + (1− α)Q(x, a),\nT Q(x, a) otherwise. This α-lazy operator only updatesQ-values when this would affect the greedy policy. And yet, Theorem 1 applies! Hence T ′ is optimality-preserving and gap-increasing, even though it may possess a multitude of fixed points in Q. Of note, while Theorem 1 does not apply to the 1-lazy operator, the latter is also optimality-preserving; in this case, however, we are only guaranteed that one optimal action remain optimal."
    }, {
      "heading" : "Experimental Results on Atari 2600",
      "text" : "We evaluated our new operators on the Arcade Learning Environment (ALE; Bellemare et al. 2013), a reinforcement learning interface to Atari 2600 games. In the ALE, a frame lasts 1/60th of a second, with actions typically selected every four frames. Intuitively, the ALE setting is related to continuous domains such as the bicycle domain studied above, in the sense that each individual action has little effect on the game.\nFor our evaluation, we trained agents based on the Deep Q-Network (DQN) architecture of Mnih et al. (2015). DQN acts according to an -greedy policy over a learned neuralnetwork Q-function. DQN uses an experience replay mechanism to train this Q-function, performing gradient descent on the sample squared error ∆Q(x, a)2, where\n∆Q(x, a) := R(x, a) + γV (x′)−Q(x, a), where (x, a, x′) is a previously observed transition. We define the corresponding errors for our operators as\n∆ALQ(x, a) := ∆Q(x, a)− α[V (x)−Q(x, a)], ∆PALQ(x, a) := max { ∆ALQ(x, a),\n∆Q(x, a)− α[V (x′)−Q(x′, a)] } ,\nwhere we further parametrized the weight given to Q(x′, a) in persistent advantage learning (compare with TPAL).\nOur first experiment used one of the new ALE standard versions, which we call here the Stochastic Minimal setting. This setting includes stochasticity applied to the Atari 2600 controls, no death information, and a per-game minimal action set. Specifically, at each frame (not time step) the environment accepts the agent’s action with probability 1 − p, or rejects it with probability p (here, p = 0.25). If an action is rejected, the previous frame’s action is repeated. In our setting the agent selects a new action every four frames: the stochastic controls therefore approximate a form of reaction delay. As evidenced by a lower DQN performance, Stochastic Minimal is more challenging than previous settings.\nWe trained each agent for 100 million frames using either regular Bellman updates, advantage learning (A.L.), or persistent advantage learning (P.A.L.). We optimized the α parameters over 5 training games and tested our algorithms on 55 more games using 10 independent trials each.\nFor each game, we performed a paired t-test (99% C.I.) on the post-training evaluation scores obtained by our algorithms and DQN. A.L. and P.A.L. are statistically better than DQN on 37 and 35 out of 60 games, respectively; both perform worse on one (ATLANTIS, JAMES BOND). P.A.L. often achieves higher scores than A.L., and is statistically better on 16 games and worse on 6. These results are especially remarkable given that the only difference between DQN and our operators is a simple modification to the update rule.\nFor comparison, we also trained agents using the Original DQN setting (Mnih et al. 2015), in particular using a longer 200 million frames of training. Figure 4 depicts learning curves for two games, ASTERIX and SPACE INVADERS. These curves are representative of our results, rather than exceptional: on most games, advantage learning outperforms Bellman updates, and persistent advantage learning further improves on this result. Across games, the median score improvement over DQN is 8.4% for A.L. and 9.1% for P.A.L., while the average score improvement is respectively 27.0% and 32.5%. Full experimental details are provided in the appendix.\nThe learning curve for ASTERIX illustrates the poor performance of DQN on certain games. Recently, van Hasselt, Guez, and Silver (2016) argued that this poor performance\nstems from the instability of the Q-functions learned from Bellman updates, and provided conclusive empirical evidence to this effect. In the spirit of their work, we compared our learned Q-functions on a single trajectory generated by a trained DQN agent playing SPACE INVADERS in the Original DQN setting. For each Q-function and each state x along the trajectory, we computed V (x) as well as the action gap at x.\nThe value functions and action gaps resulting from this experiment5 are depicted in Figure 5. As expected, the action gaps are significantly greater for both of our operators, in comparison to the action gaps produced by DQN. Furthermore, the value estimates are themselves lower, and correspond to more realistic estimates of the true value function. In their experiments, van Hasselt et al. observed a similar effect on the value estimates when replacing the Bellman updates with Double Q-Learning updates, one of many solutions recently proposed to mitigate the negative impact of statistical bias in value function estimation (van Hasselt 2010; Azar et al. 2011; Lee, Defourny, and Powell 2013). This bias is positive and is a consequence of the max term in the Bellman operator. We hypothesize that the lower value estimates observed in Figure 5 are also a consequence of bias reduction. Specifically, increased action gaps are consistent with a bias reduction: it is easily shown that the value estimation bias is strongest when Q-values are close to each other. If our hypothesis holds true, the third benefit of increasing the action gap is thus to mitigate the statistical bias of Q-value estimates.\n5Videos: https://youtu.be/wDfUnMY3vF8"
    }, {
      "heading" : "Open Questions",
      "text" : "Weaker Conditions for Optimality. At the core of our results lies the redefinition of Q-values in order to facilitate approximate value estimation. Theorem 1 and our empirical results indicate that there are many practical operators which do not preserve suboptimal Q-values. Naturally, preserving the optimal value function V is itself unnecessary, as long as the iterates converge to a Q-function Q̃ for which arg maxa Q̃(x, a) = π\n∗(x). It may well be that even weaker conditions for optimality exist than those required by Theorem 1. At the present, however, our proof technique does not appear to extend to this case. Statistical Efficiency of New Operators. Advantage learning (as given by our redefinition) may be viewed as a generalization of the consistent Bellman operator when P (· |x, a) is unknown or irrelevant. In this light, we ask: is there a probabilistic interpretation to advantage learning? We further wonder about the statistical efficiency of the consistent Bellman operator: is it ever less efficient than the usual Bellman operator, when considering the probability of misclassifying the optimal action? Both of these answers might shed some light on the differences in performance observed in our experiments. Maximally Efficient Operator. Having revealed the existence of a broad family of optimality-preserving operators, we may now wonder which of these operators, if any, should be preferred to the Bellman operator. Clearly, there are trivial MDPs on which any optimality-preserving operator performs equally well. However, we may ask whether there is, for a given MDP, a “maximally efficient” optimalitypreserving operator; and whether a learning agent can benefit from simultaneously searching for this operator while estimating a value function."
    }, {
      "heading" : "Concluding Remarks",
      "text" : "We presented in this paper a family of optimality-preserving operators, of which the consistent Bellman operator is a distinguished member. At the center of our pursuits lay the desire to increase the action gap; we showed through experiments that this gap plays a central role in the performance of greedy policies over approximate value functions, and how significantly increased performance could be obtained by a simple modification of the Bellman operator. We believe our work highlights the inadequacy of the classical Q-function at producing reliable policies in practice, calls into question the traditional policy-value relationship in value-based reinforcement learning, and illustrates how revisiting the concept of value itself can be fruitful."
    }, {
      "heading" : "Acknowledgments",
      "text" : "The authors thank Michael Bowling, Csaba Szepesvári, Craig Boutilier, Dale Schuurmans, Marty Zinkevich, Lihong Li, Thomas Degris, and Joseph Modayil for useful discussions, as well as the anonymous reviewers for their excellent feedback."
    }, {
      "heading" : "Appendix",
      "text" : "This appendix is divided into three sections. In the first section we present the proofs of our theoretical results. In the second we provide experimental details and additional results for the Bicycle domain. In the final section we provide details of our experiments on the Arcade Learning Environment, including results on 60 games."
    }, {
      "heading" : "Theoretical Results",
      "text" : "Lemma 1. Let Q ∈ Q and πQ be the policy greedy with respect to Q. Let T ′ be an operator with the properties that, for all x ∈ X , a ∈ A,\n1. T ′Q(x, a) ≤ T Q(x, a), and 2. T ′Q(x, πQ(x)) = T Q(x, πQ(x)). Consider the sequenceQk+1 := T ′Qk withQ0 ∈ Q, and let Vk(x) := maxaQk(x, a). Then the sequence (Vk : k ∈ N) converges, and furthermore, for all x ∈ X ,\nlim k→∞\nVk(x) ≤ V ∗(x).\nProof. By Condition 1, we have that\nlim sup k→∞ Qk(x, a) = lim sup k→∞\n(T ′)kQ0(x, a)\n≤ lim sup k→∞ T kQ0(x, a) = Q∗(x, a),\nsince T has a unique fixed point. From this we deduce the second claim. Now, for a given x ∈ X , let ak := πk(x) := arg maxaQk(x, a) and Pk := P (· |x, ak). We have Vk+1(x) ≥ Qk+1(x, ak) = T ′Qk(x, ak)\n= T Qk(x, ak) = T Qk−1(x, ak) + γEPk [Vk(x′)− Vk−1(x′)] ≥ T ′Qk−1(x, ak) + γEPk [Vk(x′)− Vk−1(x′)] = Vk(x) + γEPk [Vk(x\n′)− Vk−1(x′)] , where in the second line we used Condition 2 of the lemma, and in the third the definition of T applied to Qk. Thus we have\nVk+1(x)− Vk(x) ≥ γEPk [Vk(x′)− Vk−1(x′)] , and by induction\nVk+1(x)− Vk(x) ≥ γkEP1:k [V1(x′)− V0(x′)] , (11) where P1:k := PkPk−1 . . . P1 is the k-step transition kernel at x derived from the nonstationary policy πkπk−1 . . . π1. Let Ṽ (x) := lim supk→∞ Vk(x). We now show that lim infk→∞ Vk(x) = Ṽ (x) also. First note that Conditions 1 and 2, together with the boundedness of V0, ensure that V1 is also bounded and thus ‖V1 − V0‖∞ <∞. By definition, for any δ > 0 and n ∈ N, ∃k ≥ n such that Vk(x) > Ṽ (x)− δ. Since P1:k is a nonexpansion in∞-norm, we have\nVk+1(x)− Vk(x) ≥ −γk ‖V1 − V0‖∞ ≥ −γn ‖V1 − V0‖∞ =: − ,\nand for all t ∈ N,\nVk+t(x)− Vk(x) ≥ − t−1∑ i=0 γi ≥ − 1− γ ,\nsuch that\ninf t∈N\nVk+t(x) ≥ Ṽ (x)− δ −\n1− γ .\nIt follows that for any x ∈ X and δ′ > 0, we can choose an n ∈ N to make small enough such that for all k ≥ n, Vk(x) > Ṽ (x)− δ′. Hence\nlim inf k→∞ Vk(x) = Ṽ (x),\nand thus Vk(x) converges.\nLemma 2. Let T ′ be an operator satisfying the conditions of Lemma 1, and let ‖R‖∞ := maxx,aR(x, a). Then for all x ∈ X and all k ∈ N,\n|Vk(x)| ≤ 1 1− γ [ 2 ‖V0‖∞ + ‖R‖∞ ] . (12)\nProof. Following the derivation of Lemma 1, we have\nVk+1(x)− V0(x) ≥ − k∑ i=1 γi ‖V1 − V0‖∞\n≥ −1 1− γ ‖V1 − V0‖∞ .\nBy the same derivation, for a0 := arg maxaQ0(x, a) we have V1(x) ≥ T Q0(x, a0). But then\nV1(x)− V0(x) ≥ R(x, a0) + γEP0 V0(x′)− V0(x), from which the lower bound follows. Now let Pk be defined as in the proof of Lemma 1, and assume the upper bound of (12) holds up to k ∈ N. Then\nVk+1(x) = maxaQk+1(x, a) = maxa T ′Qk(x, a) ≤ maxa T Qk(x, a) = maxa [ R(x, a) + γEPk Vk(x ′) ]\n≤ ‖R‖∞ + γ ‖Vk‖∞ ≤ ‖R‖∞ + γ\n1− γ [2 ‖V0‖∞ + ‖R‖∞]\n≤ 1 1− γ [2 ‖V0‖∞ + ‖R‖∞] ,\nand combined with the fact that (12) holds for k = 0 this proves the upper bound.\nTheorem 2. Let T be the Bellman operator ((1) in the main text). Let T ′ be an operator with the property that there exists an α ∈ [0, 1) such that for all Q ∈ Q, x ∈ X , a ∈ A, and letting V (x) := maxbQ(x, b),\n1. T ′Q(x, a) ≤ T Q(x, a), and\n2. T ′Q(x, a) ≥ T Q(x, a)− α [V (x)−Q(x, a)]. Consider the sequence Qk+1 := T ′Qk with Q0 ∈ Q, and Vk(x) := maxaQk(x, a). Then T ′ is optimality-preserving: for all x ∈ X , (Vk(x) : k ∈ N) converges,\nlim k→∞\nVk(x) = V ∗(x),\nand\nQ∗(x, a) < V ∗(x) =⇒ lim sup k→∞ Qk(x, a) < V ∗(x).\nFurthermore, T ′ is also gap-increasing: lim inf k→∞ [ Vk(x)−Qk(x, a) ] ≥ V ∗(x)−Q∗(x, a).\nProof. Note that these conditions imply the conditions of Lemma 1. Thus for all x ∈ X , (Vk(x) : k ∈ N) converges to the limit Ṽ (x) ≤ V ∗(x). Now let Q̃(x, a) := lim supkQk(x, a). We have\nQ̃(x, a) = lim sup k→∞\nT ′Qk(x, a)\n≤ lim sup k→∞ T Qk(x, a)\n= lim sup k→∞\n[ R(x, a) + γEP max\nb∈A Qk(x\n′, b) ] ≤ R(x, a) + γEP lim sup\nk→∞ max b∈A\nQk(x ′, b) (13)\n= R(x, a) + γEP max b lim sup k→∞\nQk(x ′, b) (14)\n= T Q̃(x, a), (15) where in (13) we used Jensen’s inequality, and (14) follows from the commutativity of max and lim sup. Now\nQk+1(x, a) = T ′Qk(x, a) ≥ T Qk(x, a)− α [Vk(x)−Qk(x, a)] = R(x, a) + γEP Vk(x′)− αVk(x) +\nαQk(x, a). (16)\nNow, by Lemma 1 Vk(x) converges to Ṽ (x). Furthermore, using Lemma 2 and Lebesgue’s dominated convergence theorem, we have\nlim k→∞\nEP Vk(x′) = EP Ṽ (x′). (17)\nWe now take the lim sup of both sides of (16), which Lemma 2 guarantees exists, and obtain\nQ̃(x, a) ≥ R(x, a) + γEP Ṽ (x′)− αṼ (x) + αQ̃(x, a) = T Q̃(x, a)− αṼ (x) + αQ̃(x, a).\nThus\nQ̃(x, a) ≥ 1 1− α\n[ T Q̃(x, a)− αṼ (x) ] , and\nṼ (x) ≥ 1 1− α [ max a∈A T Q̃(x, a)− αṼ (x) ] Ṽ (x) ≥ max\na∈A T Q̃(x, a).\nCombining the above with (15), we deduce that\nṼ (x) = max a∈A T Q̃(x, a) = max a∈A\n[ R(x, a) + γEP Ṽ (x′) ] and, by uniqueness of the fixed point of the Bellman operator over V , it must be that Ṽ = V ∗.\nNow suppose that for some x ∈ X , ã ∈ A, we have Q∗(x, ã) < V ∗(x).\nBy Condition 1\nQk(x, ã) = T ′Qk−1(x, ã) ≤ T Qk−1(x, ã) = T Q∗(x, ã)− γEPã [V ∗(x′)− Vk−1(x′)] = Q∗(x, ã)− γEPã [V ∗(x′)− Vk−1(x′)] ,\nwhere Pã := P (· |x, ã). Using (17) we take the lim sup on both sides and find that\nlim sup k→∞\nQk(x, ã) ≤ Q∗(x, ã)− γEPã [ V ∗(x′)− Ṽ (x′) ] = Q∗(x, ã)\n< V ∗(x).\nWe conclude that\nQ∗(x, a) < V ∗(x) =⇒ lim sup k→∞ Qk(x, a) < V ∗(x).\nHence, T ′ is optimality-preserving. To prove that T ′ is gapincreasing, observe that the statement\nlim inf k→∞\n[ Vk(x)−Qk(x, a) ] ≥ V ∗(x)−Q∗(x, a)\nis now equivalent to\nlim sup k→∞\nQk(x, a) ≤ Q∗(x, a) (18)\nsince limk Vk(x) = V ∗(x). But we know (18) to be true from Condition 1 (see the proof of Lemma 1).\nCorollary 3. The consistent Bellman operator TC ((5) in the main text) and consistent Q-value interpolation Bellman operator TCQVI ((9) in the main text) are optimality-preserving and gap-increasing."
    }, {
      "heading" : "Experimental Details: Bicycle",
      "text" : "We used the bicycle simulator described by Randlov and Alstrom (1998) with a reward function which encourages driving towards the goal. Recall that Randlov and Alstrom’s reward function is\nR(x, a) :=  −1 if bicycle falls0.01 if goal is reached(4− ψ2)× 0.00004 otherwise As noted by Randlov and Alstrom themselves, this reward function is unsuitable for value iteration methods, since it\nrewards driving away from the goal. Instead we use the following related reward function\nR(x, a) :=  −c if fallen1.0 if goal reached(π2/4− ψ2 − 1)× 0.001 otherwise with c := ( 34π\n2 − 1) × 0.001 the largest negative reward achievable by the agent. Empirically, we found this reward function easier to work with, while our results remained qualitatively similar for similar reward functions. We further use a discount factor of γ = 0.99.\nWe consider two sample-based operators on QZ,A, the space of Q-functions over representative states. The samplebased Q-value interpolation Bellman operator is defined as\nTQVIQ(z, a) := R(z, a) + γ 1\nk k∑ i=1 max b∈A Q(x′i, b),\nwith k ∈ N and x′i ∼ P (· | z, a). The sample-based consistent Q-value interpolation Bellman operator TCQVI is similarly defined by sampling x′ from P :\nT ′QVIQ(z, a) := R(z, a)+ γ\nk k∑ i=1 max b∈A [ Q(x′, b)−A(z |x′) (Q(z, b)−Q(z, a)) ] TCQVIQ(z, a) := min { TQVIQ(z, a), T ′QVIQ(z, a) } .\nIn both cases, we use Q-value interpolation to define a Qfunction over X :\nQ(x, a) := Ez∼A(· | x)Q(z, a).\nFor each operator T ′, we computed a sequence of Qfunctions Qk ∈ QZ,A using an averaging form of value iteration:\nQk+1(z, a) = (1− η)Qk(z, a) + ηT ′Qk(z, a), applied simultaneously to all z ∈ Z and a ∈ A. We chose this averaging version because it led to faster convergence, and lets us take k = 1 in the definition of both operators. From a parameter sweep we found η = 0.1 to be a suitable step-size.\nOur multilinear grid was defined over the six state variables. As done elsewhere in the literature, we defined our grid over the following bounded variables:\nω ∈ [ −4\n9 π,\n4 9 π\n] ,\nω̇ ∈ [−2, 2], θ ∈ [ − π\n15 , π 15\n] ,\nθ̇ ∈ [−0.5, 0.5] , ψ ∈ [−π, π], d ∈ [10, 1200].\nValues outside of these ranges were accordingly set to the range’s minimum or maximum.\nFor completeness, Figure 6 compares the performance of the Bellman and consistent Bellman operators, as well as advantage learning and persistent advantage learning (with α = 0.1), on 8 × · · · × 8 and 10 × · · · × 10 grids. Here, the usual Bellman operator is unable to find a solution to the goal, while the consistent Bellman operator successfully does so. The two other operators also achieve superior performance compared to Bellman operator, although appear slightly more unstable in the smaller grid setting."
    }, {
      "heading" : "Experimental Details: ALE",
      "text" : "We omit details of the DQN architecture, which are provided in Mnih et al. (2015). A frame is a single emulation step within the ALE, while a time step consists of four consecutive frames which are treated atomically by the agent.\nOur first Atari 2600 experiment (Stochastic Minimal setting) used stochastic controls, which operate as follows: at each frame (not time step), the environment accepts the agent’s action with probability 1−p, or rejects it with probability p. If an action is rejected, the previous frame’s action is repeated. In our setting, the agent selects a new action every four frames; in this situation, the stochastic controls approximate a form of reaction delay. This particular setting is part of the latest Arcade Learning Environment. For our experiments we use the ALE 0.5 standard value of p = 0.25, and trained agents for 100 million frames.\nOur second Atari 2600 experiment (Original DQN setting) was averaged over three different trials, ran for 200 million frames (instead of 100 million), defined a lost life as a termination signal, and did not use stochastic controls. This matches the experimental setting of Mnih et al. (2015). A full table of our results is provided in Table 1.\nOur last experiment took place in the Original DQN setting. We generated a trajectory from a trained DQN agent playing an -greedy policy with = 0.05. The full trajectory (up to the end of the episode) was recorded in this way.\nGame Bellman Advantage Learning Persistent A.L. ASTERIX 6074.98 12852.08 19564.90 BEAM RIDER 9316.10 10054.58 13145.34 PONG 19.80 19.66 19.76\nSEAQUEST 5458.17 8670.50 13230.74 SPACE INVADERS 2067.19 3460.79 3277.59\nALIEN 3154.67 4990.91 5699.81 AMIDAR 969.88 1557.43 1451.65 ASSAULT 4573.67 3661.51 3304.33 ASTEROIDS 1827.97 1924.42 1673.52\nATLANTIS 636657.62 553591.67 1465250.00 BANK HEIST 511.00 633.63 874.99 BATTLE ZONE 28082.91 28789.29 34583.07 BERZERK 667.61 747.26 1328.25 BOWLING 74.62 57.41 71.59\nBOXING 88.66 93.94 94.30 BREAKOUT 378.69 425.32 431.89 CARNIVAL 5238.14 5111.40 4679.93\nCENTIPEDE 5719.11 4225.18 4539.55 CHOPPER COMMAND 8195.88 5431.36 5734.93\nCRAZY CLIMBER 114105.56 123410.71 130002.71 DEFENDER† 16746.68 30643.59 32038.93\nDEMON ATTACK 23212.19 27153.48 70908.17 DOUBLE DUNK -6.23 -0.15 -2.51 ELEVATOR ACTION 26675.00 27088.89 29100.00 ENDURO 776.14 1252.70 1343.10\nFISHING DERBY 11.65 21.32 28.13 FREEWAY 31.14 31.72 32.30\nFROSTBITE 1485.42 2305.82 3248.96 GOPHER 8479.98 11912.68 10611.81\nGRAVITAR 448.74 417.65 446.92 H.E.R.O. 18490.97 24788.86 24175.79 ICE HOCKEY -2.13 -1.24 -0.25 JAMES BOND 867.84 848.46 772.09\nKANGAROO 9157.98 10809.16 11478.46 KRULL 8500.48 9548.92 8689.81\nKUNG-FU MASTER 25977.53 32182.99 34650.91 MONTEZUMA’S REVENGE 0.64 0.42 1.72\nMS. PAC-MAN 3081.29 4065.80 3917.55 NAME THIS GAME 8585.03 11025.26 10431.33\nPHOENIX† 14278.95 22038.27 14495.56 PITFALL!† 0.00 0.00 0.00\nPOOYAN 4736.79 4801.27 5858.84 PRIVATE EYE 957.83 5276.16 339.15\nQ*BERT 10840.83 14368.03 14254.78 RIVER RAID 7315.20 10585.12 12813.27 ROAD RUNNER 38042.07 52351.23 37856.16 ROBOTANK 61.97 69.31 70.53\nSKIING -13049.42 -13264.51 -12173.35 SOLARIS† 4638.85 4785.16 3274.70\nSTAR GUNNER 55558.27 61353.59 61521.87 SURROUND -5.79 -4.15 0.72\nTENNIS 0.00 0.00 0.00 TIME PILOT 5788.96 8969.12 8749.26 TUTANKHAM 200.17 245.22 197.33 UP AND DOWN 12831.57 13909.74 13542.07\nVENTURE 373.79 198.69 243.75 VIDEO PINBALL 611840.72 543504.00 542052.00 WIZARD OF WOR 2410.47 9541.14 10254.01 YAR’S REVENGE† 21440.45 24240.03 17141.56\nZAXXON 6416.06 9129.61 8155.60 Times Best 12 21 31\nTable 1: Highest performance achieved by each of our operators. For each game, the score of the best operator is highlighted. Games with a † were not used by Bellemare et al. (2013). See Section 4 of the main text for more details.\nWe then queried the value functions of the trained agents, including the DQN used to generate the trajectory, in order to generate Figure 4 of the main text. For clarity we report action gaps averaged according to a rolling window of length 50.\nOut of the 60 games for which we report results, 5 are new when compared to the table of results provided by Bellemare et al. (2013). These five games are identified with a † in Table 1.\nDQN Implementation Details Recall that DQN maintains two networks in parallel: a policy network, which is used to select actions and is updated at every time step, and a target network. The target network is used to compute the error term ∆Q, and is only updated every 10,000 time steps (Mnih et al. 2015). In our experiments we also used this target network to compute the ∆ALQ and ∆PALQ, including the added correction term. Our operators performed worse when the correction term was instead computed from the policy network."
    }, {
      "heading" : "Parameter Selection",
      "text" : "We used five training games (ASTERIX, BEAM RIDER, PONG, SEAQUEST, SPACE INVADERS) to select the α parameter for both of our operators. Specifically, we trained agents using our second experimental setup with parametersα ∈ {0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0}, evaluated them according to the highest score achieved, and manually selected the α value which seemed to achieve the best performance. Note that α = 0.0 corresponds to DQN in both cases. Figure 7 depicts the results of this parameter sweep."
    } ],
    "references" : [ {
      "title" : "Using locally weighted regression for robot learning",
      "author" : [ "C.G. Atkeson" ],
      "venue" : "Proceedings of 1991 IEEE International Conference on Robotics and Automation, 958–963.",
      "citeRegEx" : "Atkeson,? 1991",
      "shortCiteRegEx" : "Atkeson",
      "year" : 1991
    }, {
      "title" : "Speedy Q-learning",
      "author" : [ "M.G. Azar", "R. Munos", "M. Gavamzadeh", "H.J. Kappen" ],
      "venue" : "Advances in Neural Information Processing Systems 24.",
      "citeRegEx" : "Azar et al\\.,? 2011",
      "shortCiteRegEx" : "Azar et al\\.",
      "year" : 2011
    }, {
      "title" : "Reinforcement learning through gradient descent",
      "author" : [ "L.C. Baird" ],
      "venue" : "Ph.D. Dissertation, Carnegie Mellon University.",
      "citeRegEx" : "Baird,? 1999",
      "shortCiteRegEx" : "Baird",
      "year" : 1999
    }, {
      "title" : "The Arcade Learning Environment: An evaluation platform for general agents",
      "author" : [ "M.G. Bellemare", "Y. Naddaf", "J. Veness", "M. Bowling" ],
      "venue" : "Journal of Artificial Intelligence Research 47:253–279.",
      "citeRegEx" : "Bellemare et al\\.,? 2013",
      "shortCiteRegEx" : "Bellemare et al\\.",
      "year" : 2013
    }, {
      "title" : "Dynamic programming",
      "author" : [ "R.E. Bellman" ],
      "venue" : "Princeton, NJ: Princeton University Press.",
      "citeRegEx" : "Bellman,? 1957",
      "shortCiteRegEx" : "Bellman",
      "year" : 1957
    }, {
      "title" : "Neuro-Dynamic Programming",
      "author" : [ "D.P. Bertsekas", "J.N. Tsitsiklis" ],
      "venue" : "Athena Scientific.",
      "citeRegEx" : "Bertsekas and Tsitsiklis,? 1996",
      "shortCiteRegEx" : "Bertsekas and Tsitsiklis",
      "year" : 1996
    }, {
      "title" : "Q-learning and enhanced policy iteration in discounted dynamic programming",
      "author" : [ "D.P. Bertsekas", "H. Yu" ],
      "venue" : "Mathematics of Operations Research 37(1):66–94.",
      "citeRegEx" : "Bertsekas and Yu,? 2012",
      "shortCiteRegEx" : "Bertsekas and Yu",
      "year" : 2012
    }, {
      "title" : "Approximate policy iteration: A survey and some new methods",
      "author" : [ "D.P. Bertsekas" ],
      "venue" : "Journal of Control Theory and Applications 9(3):310–335.",
      "citeRegEx" : "Bertsekas,? 2011",
      "shortCiteRegEx" : "Bertsekas",
      "year" : 2011
    }, {
      "title" : "PILCO: A model-based and data-efficient approach to policy search",
      "author" : [ "M.P. Deisenroth", "C.E. Rasmussen" ],
      "venue" : "Proceedings of the International Conference on Machine Learning.",
      "citeRegEx" : "Deisenroth and Rasmussen,? 2011",
      "shortCiteRegEx" : "Deisenroth and Rasmussen",
      "year" : 2011
    }, {
      "title" : "Tree-based batch mode reinforcement learning",
      "author" : [ "D. Ernst", "P. Geurts", "L. Wehenkel" ],
      "venue" : "Journal of Machine Learning Research 6:503–556.",
      "citeRegEx" : "Ernst et al\\.,? 2005",
      "shortCiteRegEx" : "Ernst et al\\.",
      "year" : 2005
    }, {
      "title" : "Action-gap phenomenon in reinforcement learning",
      "author" : [ "A. Farahmand" ],
      "venue" : "Advances in Neural Information Processing Systems 24.",
      "citeRegEx" : "Farahmand,? 2011",
      "shortCiteRegEx" : "Farahmand",
      "year" : 2011
    }, {
      "title" : "Stable function approximation in dynamic programming",
      "author" : [ "G. Gordon" ],
      "venue" : "Proceedings of the Twelfth International Conference on Machine Learning.",
      "citeRegEx" : "Gordon,? 1995",
      "shortCiteRegEx" : "Gordon",
      "year" : 1995
    }, {
      "title" : "System identification of post stall aerodynamics for UAV perching",
      "author" : [ "W. Hoburg", "R. Tedrake" ],
      "venue" : "Proceedings of the AIAA Infotech Aerospace Conference.",
      "citeRegEx" : "Hoburg and Tedrake,? 2009",
      "shortCiteRegEx" : "Hoburg and Tedrake",
      "year" : 2009
    }, {
      "title" : "Optimal hour ahead bidding in the real time electricity market with battery storage using approximate dynamic programming",
      "author" : [ "D.R. Jiang", "W.B. Powell" ],
      "venue" : "INFORMS Journal on Computing 27(3):525 – 543.",
      "citeRegEx" : "Jiang and Powell,? 2015",
      "shortCiteRegEx" : "Jiang and Powell",
      "year" : 2015
    }, {
      "title" : "Numerical methods for stochastic control problems in continuous time",
      "author" : [ "H. Kushner", "P.G. Dupuis" ],
      "venue" : "Springer.",
      "citeRegEx" : "Kushner and Dupuis,? 2001",
      "shortCiteRegEx" : "Kushner and Dupuis",
      "year" : 2001
    }, {
      "title" : "Biascorrected Q-learning to control max-operator bias in Qlearning",
      "author" : [ "D. Lee", "B. Defourny", "W.B. Powell" ],
      "venue" : "Symposium on Adaptive Dynamic Programming And Reinforcement Learning.",
      "citeRegEx" : "Lee et al\\.,? 2013",
      "shortCiteRegEx" : "Lee et al\\.",
      "year" : 2013
    }, {
      "title" : "Humanlevel control through deep reinforcement learning",
      "author" : [ "V. Mnih", "K. Kavukcuoglu", "D. Silver", "A.A. Rusu", "J. Veness", "M.G. Bellemare", "A. Graves", "M. Riedmiller", "A.K. Fidjeland", "G Ostrovski" ],
      "venue" : "Nature",
      "citeRegEx" : "Mnih et al\\.,? \\Q2015\\E",
      "shortCiteRegEx" : "Mnih et al\\.",
      "year" : 2015
    }, {
      "title" : "Barycentric interpolators for continuous space & time reinforcement learning",
      "author" : [ "R. Munos", "A. Moore" ],
      "venue" : "Advances in Neural Information Processing Systems 11.",
      "citeRegEx" : "Munos and Moore,? 1998",
      "shortCiteRegEx" : "Munos and Moore",
      "year" : 1998
    }, {
      "title" : "Variable resolution discretization in optimal control",
      "author" : [ "R. Munos", "A. Moore" ],
      "venue" : "Machine learning 49(23):291–323.",
      "citeRegEx" : "Munos and Moore,? 2002",
      "shortCiteRegEx" : "Munos and Moore",
      "year" : 2002
    }, {
      "title" : "Kernel-based reinforcement learning",
      "author" : [ "D. Ormoneit", "Ś. Sen" ],
      "venue" : "Machine learning 49(2-3):161–178.",
      "citeRegEx" : "Ormoneit and Sen,? 2002",
      "shortCiteRegEx" : "Ormoneit and Sen",
      "year" : 2002
    }, {
      "title" : "Learning to drive a bicycle using reinforcement learning and shaping",
      "author" : [ "J. Randlov", "P. Alstrom" ],
      "venue" : "Proceedings of the Fifteenth International Conference on Machine Learning.",
      "citeRegEx" : "Randlov and Alstrom,? 1998",
      "shortCiteRegEx" : "Randlov and Alstrom",
      "year" : 1998
    }, {
      "title" : "Reinforcement learning for robot soccer",
      "author" : [ "M. Riedmiller", "T. Gabel", "R. Hafner", "S. Lange" ],
      "venue" : "Autonomous Robots 27(1):55–73.",
      "citeRegEx" : "Riedmiller et al\\.,? 2009",
      "shortCiteRegEx" : "Riedmiller et al\\.",
      "year" : 2009
    }, {
      "title" : "On-line Qlearning using connectionist systems",
      "author" : [ "G.A. Rummery", "M. Niranjan" ],
      "venue" : "Technical report, Cambridge University Engineering Department.",
      "citeRegEx" : "Rummery and Niranjan,? 1994",
      "shortCiteRegEx" : "Rummery and Niranjan",
      "year" : 1994
    }, {
      "title" : "Reinforcement learning: An introduction",
      "author" : [ "R.S. Sutton", "A.G. Barto" ],
      "venue" : "MIT Press.",
      "citeRegEx" : "Sutton and Barto,? 1998",
      "shortCiteRegEx" : "Sutton and Barto",
      "year" : 1998
    }, {
      "title" : "Horde: A scalable real-time architecture for learning knowledge from unsupervised sensorimotor interaction",
      "author" : [ "R. Sutton", "J. Modayil", "M. Delp", "T. Degris", "P. Pilarski", "A. White", "D. Precup" ],
      "venue" : "Proceedings of the Tenth International Conference on Autonomous Agents and Multiagents",
      "citeRegEx" : "Sutton et al\\.,? 2011",
      "shortCiteRegEx" : "Sutton et al\\.",
      "year" : 2011
    }, {
      "title" : "Learning to predict by the methods of temporal differences",
      "author" : [ "R.S. Sutton" ],
      "venue" : "Machine Learning 3(1):9–44.",
      "citeRegEx" : "Sutton,? 1988",
      "shortCiteRegEx" : "Sutton",
      "year" : 1988
    }, {
      "title" : "Generalization in reinforcement learning: Successful examples using sparse coarse coding",
      "author" : [ "R.S. Sutton" ],
      "venue" : "Advances in Neural Information Processing Systems 8, 1038– 1044.",
      "citeRegEx" : "Sutton,? 1996",
      "shortCiteRegEx" : "Sutton",
      "year" : 1996
    }, {
      "title" : "Temporal difference learning and TDGammon",
      "author" : [ "G. Tesauro" ],
      "venue" : "Communications of the ACM 38(3).",
      "citeRegEx" : "Tesauro,? 1995",
      "shortCiteRegEx" : "Tesauro",
      "year" : 1995
    }, {
      "title" : "Deep reinforcement learning with double Q-learning",
      "author" : [ "H. van Hasselt", "A. Guez", "D. Silver" ],
      "venue" : "In Proceedings of the AAAI Conference on Artificial Intelligence (to appear)",
      "citeRegEx" : "Hasselt et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Hasselt et al\\.",
      "year" : 2016
    }, {
      "title" : "Compress and control",
      "author" : [ "J. Veness", "M.G. Bellemare", "M. Hutter", "A. Chua", "G. Desjardins" ],
      "venue" : "Proceedings of the AAAI Conference on Artificial Intelligence.",
      "citeRegEx" : "Veness et al\\.,? 2015",
      "shortCiteRegEx" : "Veness et al\\.",
      "year" : 2015
    }, {
      "title" : "Learning From Delayed Rewards",
      "author" : [ "C. Watkins" ],
      "venue" : "Ph.D. Dissertation, Cambridge University, Cambridge, England.",
      "citeRegEx" : "Watkins,? 1989",
      "shortCiteRegEx" : "Watkins",
      "year" : 1989
    } ],
    "referenceMentions" : [ {
      "referenceID" : 4,
      "context" : "In particular, value iteration (Bellman 1957) directly computes the value function through the iterated evaluation of Bellman’s equation, either exactly or from samples (e.",
      "startOffset" : 31,
      "endOffset" : 45
    }, {
      "referenceID" : 10,
      "context" : "Increasing the action gap is advantageous in the presence of approximation or estimation error (Farahmand 2011), and may be crucial for systems operating at a fine time scale such as video games (Togelius et al.",
      "startOffset" : 95,
      "endOffset" : 111
    }, {
      "referenceID" : 3,
      "context" : "Increasing the action gap is advantageous in the presence of approximation or estimation error (Farahmand 2011), and may be crucial for systems operating at a fine time scale such as video games (Togelius et al. 2009; Bellemare et al. 2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al.",
      "startOffset" : 195,
      "endOffset" : 240
    }, {
      "referenceID" : 13,
      "context" : "2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al.",
      "startOffset" : 25,
      "endOffset" : 48
    }, {
      "referenceID" : 21,
      "context" : "2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011).",
      "startOffset" : 72,
      "endOffset" : 172
    }, {
      "referenceID" : 12,
      "context" : "2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011).",
      "startOffset" : 72,
      "endOffset" : 172
    }, {
      "referenceID" : 8,
      "context" : "2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011).",
      "startOffset" : 72,
      "endOffset" : 172
    }, {
      "referenceID" : 24,
      "context" : "2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011).",
      "startOffset" : 72,
      "endOffset" : 172
    }, {
      "referenceID" : 2,
      "context" : "In fact, the idea of devaluating suboptimal actions underpins Baird’s advantage learning (Baird 1999), designed for continuous time control, and occurs naturally when considering the discretized solution of continuous time and space MDPs (e.",
      "startOffset" : 89,
      "endOffset" : 101
    }, {
      "referenceID" : 14,
      "context" : "Munos and Moore 1998; 2002), whose limit is the Hamilton-Jacobi-Bellman equation (Kushner and Dupuis 2001).",
      "startOffset" : 81,
      "endOffset" : 106
    }, {
      "referenceID" : 20,
      "context" : "Our empirical results on the bicycle domain (Randlov and Alstrom 1998) show a marked increase in performance from using the consistent Bellman operator.",
      "startOffset" : 44,
      "endOffset" : 70
    }, {
      "referenceID" : 6,
      "context" : "While numerous alternatives to the Bellman operator have been put forward (e.g. recently Azar et al. 2011; Bertsekas and Yu 2012), we believe our work to be the first to propose such a major departure from the canonical fixed-point condition required from an optimality-preserving operator.",
      "startOffset" : 74,
      "endOffset" : 129
    }, {
      "referenceID" : 3,
      "context" : "results on the Arcade Learning Environment (Bellemare et al. 2013).",
      "startOffset" : 43,
      "endOffset" : 66
    }, {
      "referenceID" : 3,
      "context" : "results on the Arcade Learning Environment (Bellemare et al. 2013). We consider the Deep Q-Network (DQN) architecture of Mnih et al. (2015), replacing only its learning rule with one of our operators.",
      "startOffset" : 44,
      "endOffset" : 140
    }, {
      "referenceID" : 5,
      "context" : "T is a contraction mapping in supremum norm (Bertsekas and Tsitsiklis 1996) whose unique fixed point is the optimal Q-function",
      "startOffset" : 44,
      "endOffset" : 75
    }, {
      "referenceID" : 22,
      "context" : "We emphasize that while we focus on the Bellman operator, our results easily extend to its variations such as SARSA (Rummery and Niranjan 1994), policy evaluation (Sutton 1988), and fitted Q-iteration (Ernst, Geurts, and Wehenkel 2005).",
      "startOffset" : 116,
      "endOffset" : 143
    }, {
      "referenceID" : 25,
      "context" : "We emphasize that while we focus on the Bellman operator, our results easily extend to its variations such as SARSA (Rummery and Niranjan 1994), policy evaluation (Sutton 1988), and fitted Q-iteration (Ernst, Geurts, and Wehenkel 2005).",
      "startOffset" : 163,
      "endOffset" : 176
    }, {
      "referenceID" : 4,
      "context" : "We emphasize that while we focus on the Bellman operator, our results easily extend to its variations such as SARSA (Rummery and Niranjan 1994), policy evaluation (Sutton 1988), and fitted Q-iteration (Ernst, Geurts, and Wehenkel 2005). In particular, our new operators all have a sample-based form, i.e., an analogue to the Q-Learning rule of Watkins (1989). a1",
      "startOffset" : 40,
      "endOffset" : 359
    }, {
      "referenceID" : 7,
      "context" : "There is, however, one important family of value functions which have “tabular-like” properties: aggregation schemes (Bertsekas 2011).",
      "startOffset" : 117,
      "endOffset" : 133
    }, {
      "referenceID" : 19,
      "context" : ", multilinear interpolation, illustrated in Figure 2) and kernel-based methods (Ormoneit and Sen 2002).",
      "startOffset" : 79,
      "endOffset" : 102
    }, {
      "referenceID" : 23,
      "context" : "If A also corresponds to the identity and X is finite, TA reduces to the Bellman operator (1) and we recover the familiar tabular representation (Sutton and Barto 1998).",
      "startOffset" : 145,
      "endOffset" : 168
    }, {
      "referenceID" : 20,
      "context" : "We now study the behaviour of our new operators on the bicycle domain (Randlov and Alstrom 1998).",
      "startOffset" : 70,
      "endOffset" : 96
    }, {
      "referenceID" : 4,
      "context" : "The driving aspect of this problem is particularly challenging for value-based methods, since each step contributes little to an eventual success and the “curse of dimensionality” (Bellman 1957) precludes a fine representation of the state-space.",
      "startOffset" : 180,
      "endOffset" : 194
    }, {
      "referenceID" : 4,
      "context" : "Policies derived from our consistent operator can safely balance the bicycle earlier on, and also reach the goal earlier than policies derived from the Bellman operator. Note, in particular, the striking difference in the trajectories followed by the resulting policies. The effect is even more pronounced when using a 8 × · · · × 8 grid (results provided in the appendix). Effectively, by decreasing suboptimal Q-values at grid points we produce much better policies within the grid cells. This phenomenon is consistent with the theoretical results of Farahmand (2011) relating the size of action gaps to the quality of derived greedy policies.",
      "startOffset" : 152,
      "endOffset" : 570
    }, {
      "referenceID" : 26,
      "context" : "One may ask whether it is possible to extend the consistent Bellman operator to Q-value approximation schemes which lack a probabilistic interpretation, such as linear approximation (Sutton 1996), locally weighted regression (Atkeson 1991), neural networks (Tesauro 1995), or even informationtheoretic methods (Veness et al.",
      "startOffset" : 182,
      "endOffset" : 195
    }, {
      "referenceID" : 0,
      "context" : "One may ask whether it is possible to extend the consistent Bellman operator to Q-value approximation schemes which lack a probabilistic interpretation, such as linear approximation (Sutton 1996), locally weighted regression (Atkeson 1991), neural networks (Tesauro 1995), or even informationtheoretic methods (Veness et al.",
      "startOffset" : 225,
      "endOffset" : 239
    }, {
      "referenceID" : 27,
      "context" : "One may ask whether it is possible to extend the consistent Bellman operator to Q-value approximation schemes which lack a probabilistic interpretation, such as linear approximation (Sutton 1996), locally weighted regression (Atkeson 1991), neural networks (Tesauro 1995), or even informationtheoretic methods (Veness et al.",
      "startOffset" : 257,
      "endOffset" : 271
    }, {
      "referenceID" : 29,
      "context" : "One may ask whether it is possible to extend the consistent Bellman operator to Q-value approximation schemes which lack a probabilistic interpretation, such as linear approximation (Sutton 1996), locally weighted regression (Atkeson 1991), neural networks (Tesauro 1995), or even informationtheoretic methods (Veness et al. 2015).",
      "startOffset" : 310,
      "endOffset" : 330
    }, {
      "referenceID" : 2,
      "context" : "Theorem 1 is our main result; one corollary is a convergence proof for Baird’s advantage learning (Baird 1999).",
      "startOffset" : 98,
      "endOffset" : 110
    }, {
      "referenceID" : 2,
      "context" : "The method of advantage learning was proposed by Baird (1999) as a means of increasing the gap between the optimal and suboptimal actions in the context of residual algorithms applied to continuous time problems.",
      "startOffset" : 49,
      "endOffset" : 62
    }, {
      "referenceID" : 3,
      "context" : "We evaluated our new operators on the Arcade Learning Environment (ALE; Bellemare et al. 2013), a reinforcement learning interface to Atari 2600 games.",
      "startOffset" : 66,
      "endOffset" : 94
    }, {
      "referenceID" : 3,
      "context" : "We evaluated our new operators on the Arcade Learning Environment (ALE; Bellemare et al. 2013), a reinforcement learning interface to Atari 2600 games. In the ALE, a frame lasts 1/60 of a second, with actions typically selected every four frames. Intuitively, the ALE setting is related to continuous domains such as the bicycle domain studied above, in the sense that each individual action has little effect on the game. For our evaluation, we trained agents based on the Deep Q-Network (DQN) architecture of Mnih et al. (2015). DQN acts according to an -greedy policy over a learned neuralnetwork Q-function.",
      "startOffset" : 72,
      "endOffset" : 530
    }, {
      "referenceID" : 16,
      "context" : "For comparison, we also trained agents using the Original DQN setting (Mnih et al. 2015), in particular using a longer 200 million frames of training.",
      "startOffset" : 70,
      "endOffset" : 88
    }, {
      "referenceID" : 4,
      "context" : "We trained each agent for 100 million frames using either regular Bellman updates, advantage learning (A.L.), or persistent advantage learning (P.A.L.). We optimized the α parameters over 5 training games and tested our algorithms on 55 more games using 10 independent trials each. For each game, we performed a paired t-test (99% C.I.) on the post-training evaluation scores obtained by our algorithms and DQN. A.L. and P.A.L. are statistically better than DQN on 37 and 35 out of 60 games, respectively; both perform worse on one (ATLANTIS, JAMES BOND). P.A.L. often achieves higher scores than A.L., and is statistically better on 16 games and worse on 6. These results are especially remarkable given that the only difference between DQN and our operators is a simple modification to the update rule. For comparison, we also trained agents using the Original DQN setting (Mnih et al. 2015), in particular using a longer 200 million frames of training. Figure 4 depicts learning curves for two games, ASTERIX and SPACE INVADERS. These curves are representative of our results, rather than exceptional: on most games, advantage learning outperforms Bellman updates, and persistent advantage learning further improves on this result. Across games, the median score improvement over DQN is 8.4% for A.L. and 9.1% for P.A.L., while the average score improvement is respectively 27.0% and 32.5%. Full experimental details are provided in the appendix. The learning curve for ASTERIX illustrates the poor performance of DQN on certain games. Recently, van Hasselt, Guez, and Silver (2016) argued that this poor performance",
      "startOffset" : 66,
      "endOffset" : 1586
    }, {
      "referenceID" : 1,
      "context" : "observed a similar effect on the value estimates when replacing the Bellman updates with Double Q-Learning updates, one of many solutions recently proposed to mitigate the negative impact of statistical bias in value function estimation (van Hasselt 2010; Azar et al. 2011; Lee, Defourny, and Powell 2013).",
      "startOffset" : 237,
      "endOffset" : 305
    } ],
    "year" : 2015,
    "abstractText" : "This paper introduces new optimality-preserving operators on Q-functions. We first describe an operator for tabular representations, the consistent Bellman operator, which incorporates a notion of local policy consistency. We show that this local consistency leads to an increase in the action gap at each state; increasing this gap, we argue, mitigates the undesirable effects of approximation and estimation errors on the induced greedy policies. This operator can also be applied to discretized continuous space and time problems, and we provide empirical results evidencing superior performance in this context. Extending the idea of a locally consistent operator, we then derive sufficient conditions for an operator to preserve optimality, leading to a family of operators which includes our consistent Bellman operator. As corollaries we provide a proof of optimality for Baird’s advantage learning algorithm and derive other gap-increasing operators with interesting properties. We conclude with an empirical study on 60 Atari 2600 games illustrating the strong potential of these new operators. Value-based reinforcement learning is an attractive solution to planning problems in environments with unknown, unstructured dynamics. In its canonical form, value-based reinforcement learning produces successive refinements of an initial value function through repeated application of a convergent operator. In particular, value iteration (Bellman 1957) directly computes the value function through the iterated evaluation of Bellman’s equation, either exactly or from samples (e.g. Q-Learning, Watkins 1989). In its simplest form, value iteration begins with an initial value function V0 and successively computes Vk+1 := T Vk, where T is the Bellman operator. When the environment dynamics are unknown, Vk is typically replaced by Qk, the state-action value function, and T is approximated by an empirical Bellman operator. The fixed point of the Bellman operator, Q∗, is the optimal state-action value function or optimal Q-function, from which an optimal policy π∗ can be recovered. In this paper we argue that the optimal Q-function is inconsistent, in the sense that for any action a which is subop∗Now at Carnegie Mellon University. Copyright c © 2016, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved. timal in state x, Bellman’s equation for Q∗(x, a) describes the value of a nonstationary policy: upon returning to x, this policy selects π∗(x) rather than a. While preserving global consistency appears impractical, we propose a simple modification to the Bellman operator which provides us a with a first-order solution to the inconsistency problem. Accordingly, we call our new operator the consistent Bellman operator. We show that the consistent Bellman operator generally devalues suboptimal actions but preserves the set of optimal policies. As a result, the action gap – the value difference between optimal and second best actions – increases. Increasing the action gap is advantageous in the presence of approximation or estimation error (Farahmand 2011), and may be crucial for systems operating at a fine time scale such as video games (Togelius et al. 2009; Bellemare et al. 2013), real-time markets (Jiang and Powell 2015), and robotic platforms (Riedmiller et al. 2009; Hoburg and Tedrake 2009; Deisenroth and Rasmussen 2011; Sutton et al. 2011). In fact, the idea of devaluating suboptimal actions underpins Baird’s advantage learning (Baird 1999), designed for continuous time control, and occurs naturally when considering the discretized solution of continuous time and space MDPs (e.g. Munos and Moore 1998; 2002), whose limit is the Hamilton-Jacobi-Bellman equation (Kushner and Dupuis 2001). Our empirical results on the bicycle domain (Randlov and Alstrom 1998) show a marked increase in performance from using the consistent Bellman operator. In the second half of this paper we derive novel sufficient conditions for an operator to preserve optimality. The relative weakness of these new conditions reveal that it is possible to deviate significantly from the Bellman operator without sacrificing optimality: an optimality-preserving operator needs not be contractive, nor even guarantee convergence of the Q-values for suboptimal actions. While numerous alternatives to the Bellman operator have been put forward (e.g. recently Azar et al. 2011; Bertsekas and Yu 2012), we believe our work to be the first to propose such a major departure from the canonical fixed-point condition required from an optimality-preserving operator. As proof of the richness of this new operator family we describe a few practical instantiations with unique properties. We use our operators to obtain state-of-the-art empirical ar X iv :1 51 2. 04 86 0v 1 [ cs .A I] 1 5 D ec 2 01 5 results on the Arcade Learning Environment (Bellemare et al. 2013). We consider the Deep Q-Network (DQN) architecture of Mnih et al. (2015), replacing only its learning rule with one of our operators. Remarkably, this one-line change produces agents that significantly outperform the original DQN. Our work, we believe, demonstrates the potential impact of rethinking the core components of value-based reinforcement learning.",
    "creator" : "TeX"
  }
}