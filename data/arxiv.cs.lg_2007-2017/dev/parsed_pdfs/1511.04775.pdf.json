{
  "name" : "1511.04775.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Expressive recommender systems through normalized nonnegative models",
    "authors" : [ "Cyril J. Stark" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Recommender systems are algorithms designed to recommend items to users. Good recommender systems address the following three partially conflicting objectives: (1) predictive power (despite very sparse and noisy data), (2) computational tractability (despite quickly growing numbers of users and items), (3) interpretability (to allow for feedback, market analysis and visual representations). Here, to address those difficulties, we are going to adopt the system-state-measurement paradigm in the form of a class of models which we call normalized nonnegative models (NNM).\nAdopting the system-state-measurement paradigm amounts to making a clear distinction between the ‘state of a system’ and the ‘measurement device’ used to probe that system. The success of this paradigm in science and engineering motivates its application in item recommendation and beyond. In the study of recommendation the system is that abstract part of our thinking that determines whether we like or dislike an item. The state of that system varies from person to person; it forms the description of the individual preferences. The measurements that we perform on the system are questions of the form “Do you like the movie Jurassic Park?”. Each measurement probes our taste (e.g., movie taste) and measuring sufficiently many diverse questions allows to get an idea of the preferences/opinion of a person. In the natural sciences and engineering the system is oftentimes described in terms a sample space, the state of the system is probability distribution on that sample space and a measurement is a random variable. Hence, ideally, to adopt that picture, we need to compute the following building blocks: (1) an effective sample space, (2) a probability distribution for each user to describe that user’s taste, (3) a random variable for each item to describe questions like “How do you rate the movie Ex Machina?”. To arrive at NNMs we simply convexify the third of these building blocks, i.e., the space of random variables. This convex relaxation will allow us to compute NNMs through alternating convex optimization. In this manner, approximate inference of NNMs becomes computationally tractable.\nThe main strength of NNMs are highly interpretable user and item representations. The way we represent users allows us to regard users as normalized mixtures of a small number of user stereotypes. We provide\n∗Massachusetts Institute of Technology, 77 Massachusetts Avenue, 6-304, Cambridge MA 02139-4307, USA\nar X\niv :1\n51 1.\n04 77\n5v 1\n[ cs\n.L G\n] 1\n5 N\nov 2\n01 5\nstrategies to characterize those stereotypical users in words so that those stereotypes can be understood intuitively by people who are unfamiliar with data analysis. Hence, NNMs allow everybody to interpret users’ behaviors as mixtures of well-characterized stereotypical behaviors. On the other hand, the way we represent items allows us to infer hierarchical orderings of item categories like movie genres or topics of documents. This is how we address the criterion interpretability. Of course, topic models like those based on latent Dirichlet allocation (LDA) have also been used to derive said expressive descriptions of users and items. We explain this in much more detail when discussing related work towards the end of this paper.\nFinally, we evaluate the last remaining criterion predictive power in numerical experiments. We show that in mean-average-error, NNMs outperform methods like SVD++ [1] on MovieLens datasets. This indicates that the high level of interpretability of NNMs comes not at the price of sacrificing predictive power.\nThroughout the paper we introduce NNMs through their application in item recommendation. But we hope that our presentation will be clear enough to convince the reader that the scope of NNMs is not limited to recommendation—in the very same sense that the scope of probability theory is not limited to one particular branch of science."
    }, {
      "heading" : "2 Notation",
      "text" : "For n ∈ N, we set [n] = {1, ..., n}. Throughout, u ∈ [U ] labels users, i ∈ [I] labels items and z ∈ [Z] denote possible ratings (e.g., z ∈ [5] in case of 5-star ratings). By R ∈ [Z]U×I we denote the complete rating matrix, i.e., Rui ∈ [Z] is the rating that user u provides for item i. In practice, we only know a subset of the entries of R. We use Γ ⊆ [U ] × [I] to mark the known entries, i.e., (u, i) ∈ Γ if Rui is known a priori. We use ∆ = {~p ∈ RD+ |‖~p‖1 = 1} to denote the probability simplex. A finite probability space is described in terms of a sample space Ω = {ω1, ..., ωD}, probability distributions ~p ∈ ∆ and random variables Ê with some alphabet [Z]. Recall that random variables are functions Ê : Ω→ [Z]."
    }, {
      "heading" : "3 Probability theory recap",
      "text" : "According to Kolmogorov, a random experiment with finite sample space is described by the following triple:\n• A sample space Ω = {ω1, ..., ωD}. The elements ωj denote elementary events. • A probability distribution ~p ∈ RD+ with ∑ j(~p)j = 1, i.e., ~p is an element of the probability simplex ∆.\n• A random variable Ê, i.e., a function Ê : Ω→ {1, ..., Z} for some alphabet size Z ∈ N.\nWe denote by P[Ê = z] the probability of the event {ω ∈ Ω|Ê(ω) = z}. Therefore,\nP[Ê = z] = P[Ê−1(z)] = ∑\nω∈Ê−1(z)\npω (1)\nwhere Ê−1(z) ⊆ Ω denotes the pre-image of z under the map Ê. The expression (1) can be rewritten using indicator vectors. For that purpose we define ~Ez by(\n~Ez ) j = { 1, if ωj ∈ Ê−1(z) 0, otherwise.\n(2)\nIt follows that P[Ê = z] = ~ETz ~p ,i.e., probabilities for measuring specific outcomes of random variables can be expressed in terms of inner products between two D-dimensional vectors. By (2), ∑ z ~Ez = (1, ..., 1) T .\nExamples. For an unbiased coin, ~p = (1/2, 1/2)T , ~Eheads = (1, 0) T and ~Etails = (0, 1) T . Consequently, P[Ê = heads] = (1/2, 1/2)(1, 0)T = 1/2. For a biased 4-sided coin, we may have ~p = (1/4, 1/4, 1/8, 3/8)T and ~Ez such that ( ~Ez)j := δzj . It follows for example that P[Ê = 1 or 4] = ~pT ( ~E1 + ~E4) = 5/8."
    }, {
      "heading" : "4 Normalized nonnegative models",
      "text" : "We adopt the system-state-measurement paradigm. The system we are interested in is the part of our mind that determines the outcome to the question “Do you like item i?” (i ∈ [I]). For each user u ∈ [U ] this system is in some state described by a distribution ~pu ∈ ∆ on some unknown sample space Ω = {ω1, ..., ωD} representing the system. Each question “Do you like item i?” is modeled in terms of a random variable Êi with alphabet [Z] (Z = 5 for 5-star ratings). We denote by Pu[Êi = z] the probability for user u to rate item i with z ∈ [Z]. Thus,\nPu[Êi = z] = Pu[Ê−1i (z)] = ~E T iz~pu (3)\nwhere ~pu models the state of user u and where ~Eiz ∈ {0, 1}D is defined by\n( ~Eiz ) j = { 1, if ωj ∈ Ê−1i (z) 0, otherwise.\n(4)\nBy (4), ∑ z ~Eiz = (1, ..., 1)\nT . We denote by M0 the set of all valid descriptions ( ~E1, ..., ~EZ) of a random variable Ê, i.e.,\nM0 = { ( ~E1, ..., ~EZ) ∈ {0, 1}D×Z ∣∣∣∑ z ~Eiz = (1, ..., 1) T } .\nAllowing for stochastic mixtures of elements of M0 we arrive at the convex relaxation M = { ( ~E1, ..., ~EZ) ∈ RD×Z+ ∣∣∣∑ z ~Eiz = (1, ..., 1) T }\nof M0. In the remainder, the tuple of vectors ( (~pu)u∈[U ], ( ~Eiz)i∈[I],z∈[Z] ) denotes a normalized nonnegative model (NNM) if ~pu ∈ ∆ for all users u ∈ [U ] and if ( ~Eiz)z∈[Z] ∈ M for all items i ∈ [I]. A NNM captures observations well if R ≈ ( argmaxz{ ~ETiz~pu}z∈[Z] ) u∈[U ],i∈[I] ."
    }, {
      "heading" : "4.1 Non-categorical",
      "text" : "In the previous description of the random variables Êi we did not make any assumptions on the nature of the outcomes z ∈ [Z]. Hence, the outcomes z ∈ [Z] are categorical, i.e., the outcomes are not ordered (e.g., (z = 3) < (z = 4)) and the numerical values z ∈ [Z] carry no meaning. This is a feature of NNMs as it makes them applicable in a very wide range of settings.\nIn item recommendation, systems that allow for categorical information are particularly convenient to make use of side information such as the gender of users. But even if we only focus on the user-item matrix, systems that allow for categorical information may generally have an advantage over other systems because 5-star ratings do not come with a scale. For example, we cannot claim that we prefer a 2-star-item over a 1-star-item to the same extent as we prefer a 3-star-item over a 2-star-item.\nOn the other hand, star-ratings are clearly ordered as, for example, a 4-star-rating is better than a 3- star-rating. Consequently, we lose information if we treat ratings in a purely categorical manner. Therefore, to avoid the little-data-problem we may want to interpret a rating z ∈ [Z] of an item i by user u as an approximation of P[u likes i], i.e.,\nz/Z ≈ P[u likes i]. (5)\nTo model this interpretation of users’ ratings, we regard the random variables Êi (i ∈ [I]) as binary random variables whose outcomes are interpreted as ‘I like item i’ and ‘I dislike item i’, respectively.\nNNMs allow for the modeling of categorical variables because we assigned individual vectors ( ~Eiz)z∈[Z] to each of the outcomes z ∈ [Z]. This can be done in general matrix factorization (e.g., SVD++ [1]), and the potential possibilities motivate a thorough analysis of the modeling of categorical variables in terms of general matrix factorization."
    }, {
      "heading" : "5 Interpretability",
      "text" : "One of the reasons for the popularity of models from probability theory is their interpretability. To make this more precise, we imagine flipping a coin. The natural probabilistic description of a single coin flip is in terms of a sample space Ω = {ωheads, ωtails} where ωheads is the event heads and ωtails is the event tails. We denote by ~δheads and ~δtails the deterministic distributions located at ωheads and ωtails, respectively. (For\nexample, ( ~δheads ) ω = 1 if ω = ωheads and ( ~δheads ) ω = 0 otherwise.) Hence, we can easily and clearly describe the states ~δheads and ~δtails in terms of words: ~δheads is the state that always returns heads, and ~δtails is the state that always returns tails. It is through those concise descriptions that we get an intuitive understanding of the states ~δheads and ~δtails.\nEvery possible state ~p = (pheads, ptails) of the coin is a probabilistic mixture of ~δheads and ~δtails. Since we have an intuitive understanding of what mixtures are, we can thus lift our intuitive understanding of ~δheads and ~δtails to arrive at an intuitive understanding of general states ~p = (pheads, ptails). We think that this is one of the main strengths of probabilistic models and we think that this is one of the main reasons why those models are so appealing not only to scientists and engineers but also to people with less mathematical training.\nIn NNMs the states of users are distributions ~pu = ∑D ω=1 pu,ω\n~δω where (~δω)k = 1 if ω = k and (~δω)k = 0 otherwise. Hence, we could get a good understanding of the users’ states if we found ways to describe the elementary preferences ~δω in an intuitive manner. We call those elementary preferences ~δω stereotypes because each user’s preference is a mixture of those stereotypes. We next describe approaches to acquire said intuitive description of stereotypes."
    }, {
      "heading" : "5.1 Understanding stereotypes through tags",
      "text" : "Oftentimes, we not only have access to users’ ratings of items but we also have access to side information about items in terms of tags. For example the MovieLens 1M dataset provides genre tags for movies; each movie gets assigned to (sometimes multiple) genres like Action, Adventure, Animation, etc. Note that we do have an intuitive understanding of those genres—just as we have an intuitive understanding of the coin-states ~δheads and ~δtails. Thus, at the example of genre tags we explain next, how side information can be used to get an intuitive characterization of stereotypes.\nWe assume that each movie i is assigned to some genres gi1, ..., g i ni ∈ {g1, ..., gG}. To characterize a stereotype ~δω we want to determine how much the hypothetical user ~δω likes movies of genre g1, movies of genre g2, etc. We make this precise in terms of the following game to characterize stereotypes ~δω. The game involves a referee and two players Alice and Bob. For some ω ∈ Ω, Alice’s user vector is assumed to be ~δω. We proceed as follows.\n1. Fix a genre g ∈ {g1, ..., gG}. Let i1, ..., im denote all the movies that have been tagged with g. 2. Bob is given access to Alice’s vector ~δω, to g, to all genre tags ( gi1, ..., g i ni ) i∈[I] and to all item vectors(\n~Eiz ) i∈[I],z∈[Z] (z ∈ [2]; z = 1 means ‘like’ and z = 2 means ‘dislike’).\n3. The referee draws uniformly at random a movie i∗ from {i1, ..., im}.\n4. By looking up R, the referee checks whether Alice likes or dislikes i∗. We denote her answer by z∗ ∈ {like,dislike}.\n5. Bob guesses z∗. He wins the game if he guesses z∗ correctly. Otherwise, he loses.\nBefore we describe how to make use of this game for the characterization of stereotypical users, we describe Bob’s strategy. First we note that Bob needs to estimate the probability for z∗ = 1 and z∗ = 2,\nrespectively. Conditioned on the event ‘Referee draws i’ we have that P[z∗ = 1 | i] = ~ETi1~p. The probability that the referee draws i is 1/m because there are in total m movies associated with g. Therefore,\nP[z∗ = 1] = ∑\ni∈{i1,...,im}\nP[z∗ = 1 | i] P[i] = ~ETg ~p.\nwhere ~Eg := 1\nm ∑ i∈{i1,...,im} ~Ei1.\nHence, Bob computes ~ETg ~δω = Eg,ω. If Eg,ω ≥ 1/2 he guesses z∗ = 1. Otherwise, he guesses z∗ = 2.\nHow can this game be used for the characterization of stereotypes? The number Eg,ω specifies the probability that the stereotypical user ~δω likes a random movie from genre g. For instance, if Eg,ω ≈ 1 for g ∈ [G] then we know that the stereotypical user ~δω very much likes movies from genre g. We repeat above game for all g ∈ {g1, ..., gG} and for all ω ∈ Ω. We arrive at numbers (Eg,ω)g∈[G],ω∈Ω. For each ω, the tuple (Eg,ω)g∈[G] provides a characterization of the preferences of the stereotypical user ~δω. The characterization (Eg,ω)g∈[G] is convenient because Eg,ω specifies the probability for ~δω to like a movie from genre g, and because those genres g are understood intuitively."
    }, {
      "heading" : "5.2 Understanding stereotypes without tags",
      "text" : "In the previous section we proposed a method for characterizing stereotypes ~δω. That method is applicable whenever items come along with interpretable tags. What can we do if no such tags are available? Assume we only have access to users’ ratings of items. In those cases we suggest to proceed by characterizing each of the stereotypical users through a list of items they like. For a stereotype ~δω, those items can be found by firstly, collecting all items with the property that ( ~EiZ ) ω ≈ 1 (e.g., vectors associated to 5 stars). Denote those highly rated movies by γω1 , ..., γ ω M . Then, in a second step, we select from the set {γω1 , ..., γωM} those items that are popular (i.e., known to many people). We arrive at items γωm1 , ..., γ ω mJ . To characterize the stereotype ~δω, we report the list γ ω m1 , ..., γ ω mJ ."
    }, {
      "heading" : "5.3 Stereotypes in general matrix factorization models",
      "text" : "Let ~ru denote user vectors computed in a general matrix factorization model. Computing the convex hull of the cone spanned by the set {~ru}u∈[U ] we could in principle determine user vectors ~ri1 , ..., ~riT with the property that for all ~ru there exist coefficients λ1, ..., λT ≥ 0 such that ∑T k=1 λk~rik = ~ru. Therefore, as in NNMs, we can still express every user vector as mixture of other user vectors. There are, however, at least two major problems with this approach. Firstly, computing the convex conic hull of the span of {~ru}u∈[U ] is computationally not tractable; even for small numbers of users. Secondly, we expect the number T of extremal rays R~ri1 , ...,R~riT of the convex conic hull to be very large—independently of D. Therefore, users’ states are difficult to interpret because they are the mixture of a very large number of stereotypes. We would like to stress that for each dimension D, NNMs are efficient as they only use the least possible number of D stereotypes. For example, if we only needed D−1 stereotypes then all vectors could be restricted to a sub-space of RD and a (D− 1)-dimensional NNM could be used instead of the D-dimensional NNM."
    }, {
      "heading" : "6 Hierarchical structure of tags",
      "text" : "Assume the considered items are tagged. For instance, as before, if the items are movies then these tags could specify which genre each movie belongs to. We denote by {it1, ..., itmt} all items that have been tagged\nwith a tag τt from the set of all tags {τt}t∈[T ]. As before, we describe tags τt (t ∈ [T ]) in terms of vectors\n~Eτt := 1\nmt ∑ i∈{i1,...,imt} ~EiZ , (6)\nso that ~pTu ~Eτt is the probability that user u likes a randomly chosen item i ∈ {it1, ..., itmt}. As we are going to see next, (6) enables us to order tags in a hierarchical manner.\nWe note that if the tag vectors ~Eτt were binary vectors (i.e., ∈ {0, 1}D), then we would say τt ⊆ τt′ whenever the support of ~Eτt is contained in the support of\n~Eτt′ . This is a meaningful definition of ‘⊆’ for tags because if τt ⊆ τt′ then ‘~δω likes τt’ implies ‘~δω likes τt′ ’.\nGenerally, in NNMs, tag vectors ~Eτt are not binary and therefore, the definition of τt ⊆ τt′ needs to make sense for non-binary vectors. To find a new definition of ‘⊆’ we note that in the previous binary setting, τt ⊆ τt′ if and only if\n~ETτt′ ~Eτt = ∑ ω∈Ω ( ~Eτt ) ω =: ‖ ~Eτt‖1. (7)\nCondition (7) can never be satisfied if the components of ~Eτt and ~Eτt′ are < 1. This can be the case in NNMs. However, the operational meaning of the condition (7) is preserved under the relaxation\n~ETτt′ ~Eτt ≥ (1− ε)‖ ~Eτt‖1 (8)\nif ε > 0 is small. That is because if the relaxed condition (8) is satisfied then we still have that most of the weight of ~Eτt is contained in the approximate support of ~Eτt′ .\nTherefore, we say τt ⊆ε τt′ if condition (8) is satisfied, and we say τt =ε τt′ if both τt ⊆ε τt′ and τt′ ⊇ε τt. The collection of all relations ‘⊆ε’ between tags can be represented graphically in terms of a graph. For that purpose we interpret the set of tags {τt}t∈[T ] as the vertex set V of a graph G = (V,E). G contains directed edges defined through the rule\n(τt → τt′) if τt′ ⊆ε τt.\nFor every choice of ε ∈ [0, 1], the graph G induces an approximate hierarchical ordering of tags; see figure 2."
    }, {
      "heading" : "7 Computation of normalized nonnegative models",
      "text" : "Presumably, the simplest approach for computing a NNM proceeds via alternating constrained optimization to solve\nmin ~pu∈∆,(~Eiz)z∈[Z]∈M ∑ (u,i)∈Γ ( ~ETiz~pu −Rui/Z )2 , (9)\ni.e., the algorithm switches back and forth between optimizing (~pu)u∈[U ] (keeping ( ~Eiz)i∈[I],z∈[Z] fixed) and optimizing ( ~Eiz)i∈[I],z∈[Z] (keeping (~pu)u∈[U ] fixed). Each of these tasks can be computed efficiently and in parallel. Moreover, this approach is guaranteed to converge to a local minimum.\nIn the context of recommendation, training data is typically subject to a large selection bias: a majority of the ratings are high ratings. This significantly impacts the model we fit to the data. For example, if all the known entries (marked by Γ) of the rating matrix R were equal to Z then a 1-dimensional model (user vectors = 1, item vectors = Z) would lead to zero training error. It is commonly believed that (u, i) ∈ Γc implies typically that u does not like i. Thus, during the first 2 iterations, we set the missing entries of R equal to zero. We believe that this preprocessing leads to an initialization for alternating constrained optimization that captures more accurately the ground truth. We arrive at Algorithm 1 to fit NNMs to measured data.\nAlgorithm 1 Alternating constrained least squares for NNM\n1: Fix D (e.g., by cross validation). 2: For all u, initialize ~pu = ~ei where i ∈ [D] is chosen uniformly at random and where (~ei)j = δij . 3: For all items i, solve the (linearly constrained) nonnegative least squares problem\nmin(~Eiz)z∈[Z]∈M ∑ u:(u,i)∈Γ ( ~ETiz~pu −Rui/Z )2 .\n4: For all users u, solve the (linearly constrained) nonnegative least squares problem min~pu∈∆ ∑ i:(u,i)∈Γ ( ~ETiz~pu −Rui/Z )2 . 5: Repeat steps 3 and 4 until a stopping criteria is satisfied; e.g., until a maximum number of iterations is reached. For the first 2 iterations we pretend we knew all of R by setting unknown entries equal to zero."
    }, {
      "heading" : "8 Computational tractability",
      "text" : "All of the steps in Algorithm 1 can be parallelized straightforwardly. The main bottleneck are large number of summands in the objective functions of user and item updates. With standard methods this becomes a potential issue during the first two iterations (i.e., preprocessing). There are at least two loopholes. The easiest solution is in terms of sampling a fixed number of unknown entries and replacing only those with zeros. Here, the number of sampled entries should be comparable to the number of known entries so that we can compensate for the selection bias towards positive ratings.\nAlternatively, we can run Algorithm 1 for a subset of all users and items. We denote these users and items by {un}Nn=1 and {im}Mm=1, respectively. If N and M equal a couple of thousands then we can easily run Algorithm 1; see section ‘Experiments’. How can we compute representations of the remaining users and items? To determine user vectors for u /∈ {un}Nn=1 we simply solve step 4 of Algorithm 1 to determine ~pu. We can proceed analogously to determine representations for i /∈ {im}Mm=1. These single small optimization problems can be solved quickly and therefore, online. The resulting scheme is a two-phase procedure where we compute the representations of the ‘anchor users’ {un}Nn=1 and ‘anchor items’ {im}Mm=1 offline, and where we compute or update all other user and item representations online. Of course, this requires selecting the sets {un}Nn=1 and {im}Mm=1 so that the anchor items are popular (→ u knows some of them), and so that the anchor users rate lots of items (→ soon after release, i is rated by a couple of those users)."
    }, {
      "heading" : "9 Experiments",
      "text" : "We evaluate predictive power and interpretability of NNMs at the example of the omnipresent MovieLens (ML) 100K and 1M datasets.1 Due to lack of space we moved the details about the configurations of all algorithms and results for the MovieLens 100K dataset to the appendix. To use the data economically, we employed interpretation (5) of the rating matrix R. We computed NNMs in Matlab using cvx [2] calling SDPT3 [3].\nInterpretability. We computed figure 1 to illustrate the interpretability of NNMs through user stereotypes. We computed figure 2 to evaluate interpretability of NNMs through emergent hierarchies of tags.\nFigure 1 (left) corresponds to a 2-dimensional NNM. The two towers characterize the two user stereotypes. The second stereotype does not much care about the particular genre; she rates many movies highly and is open to everything. The first stereotype is generally more skeptical but rates movies from the genres ‘Documentaries’ and ‘Film-Noir’ highly; she dislikes the genre ‘Horror’. Interestingly, when increasing the dimension from 2 to 3, we leave those two stereotypes approximately unchanged—we simply add a new stereotype; see figure 1 (right). The newly emergent stereotype has preferences for the genres ‘Action’, ‘Adventure’, ‘Children’s’, ‘Fantasy’ and dislikes both Documentaries and movies from the Horror genre. All probabilities are large due to the selection bias towards high ratings. Filling in missing entries with low ratings affects the size of those probabilities but leaves the structure of the towers approximately unchanged.\n1http://grouplens.org/datasets/movielens/\nFigure 2 serves as an example for how expressive computed tag-hierarchies are. The hierarchy from figure 2 visualizes the pattern of ‘⊆ε’-relations between movie genre for the value ε = 1/3. To decrease the complexity of figure 2, we excluded the genres ‘Film-Noir’ and ‘War’ from the figure. Movies from these genres are rated highly by a majority of users and thus, all genres are connected to these genres.\nEvaluation of predictive power. We evaluate mean-squared-error (MAE) and root-mean-squared-error (RMSE) through 5-fold cross validation with 0.8-to-0.2 data splitting. All results were computed using 16 iterations. Figure 3 (left) shows how MAE depends on D, and Figure 3 (right) shows that the proposed algorithm converges smoothly. In appendix A we argue why MAE is less sensitive to outliers and therefore, we think that MAE should be preferred over RMSE. Table 1 compares NNMs with popular recommender systems (see appendix B). We notice that Algorithm 1 outperforms SVD++ [1] in MAE. Note that neither SVD++ nor NNMs were trained to minimize MAE. We evaluated the previously known methods by using the LibRec library [4]."
    }, {
      "heading" : "10 Related work",
      "text" : "In recommendation we are interested in the co-occurence of pairs (u, i) of users u and items i. Depending on the application, (u, i) may be interpreted as ‘u likes item i’, ‘u attends event i’, etc. In aspect models, pLSA [8, 9] (and similarly in their extension LDA [10]) we model (u, i) as random variable with distribution\nP[u, i] = K∑ k=1 P[u|k] P[i|k]. (10)\nHence, P[u, i] is expressed as a inner product of two vectors: (P[u|k])k∈K and (P[i|k])k∈K . This is reminiscent of (3) where we expressed the probability of the event ‘u rates i with z stars’ in terms of the inner product between ~Eiz and ~pu. Therefore, one half of the inner product (3) agrees with the identity (10) as both (P[u|k])k∈K and ~pu are probability distributions. However, aspect models and NNMs disagree on the other half (i.e., ~Eiz) because ~Eiz is constrained through the existence of ~Ei1, ..., ~Eiz−1, ~Eiz+1, .., ~EiZ such that ( ~Ei1, ..., ~EiZ) ∈ M. More importantly however, the difference between aspect models and NNMs lies in the different interpretations of (P[u|k])k∈K and (P[i|k])k∈K on the one hand and ~pu and ~Eiz on the other hand.\nSimilarly, more general NMF-based models [11] agree with NNM-based models in that they make prediction in terms of inner products of nonnegative vectors but they differ from NNM-based models through different interpretations and regularizations of those nonnegative vectors.\nThese new interpretations of ~pu and ~Eiz allow us to deal with situations where z ∈ [Z] is a categorical random variable and we can extract hierarchical structures from NNMs in a straightforward manner. Aspect models can deal with both of these tasks too. However, we think that dealing with these tasks in terms of aspect models is less natural then dealing with these tasks with NNMs. For instance, to model multiple outcomes like (z ∈ [5]) we need to first decide on a particular graphical model (see section 2.3 in [8]). Moreover, to extract hierarchical classifications of topics, we need to imagine generative processes like the nested Chinese restaurant process [12], or we need to employ nested hierarchical Dirichlet processes [13].\nOn the other hand, probabilistic matrix factorization (PMF, [14]) leads to another interesting and related class of models where we assume that entries Rui of the rating matrix are independent Gaussian random variables with mean ~UTu ~Vi and variance σ. PMF-based models also describe ratings as samples of an underlying random variable and the distribution of that random variable is parameterize symmetrically in terms of vectors ~Uu assigned to users and ~Vi assigned to items. However, for PMF we need to assume that the random variables Rui are normally distributed. In NNM-based models, we do not need to assume anything about the distribution of Rui once the underlying dimension D has been fixed by cross-validation. PMF would allow for the extraction of hierarchical orderings as discussed here but PMF does not allow for the interpretation of data through stereotypes because PMF corresponds to a specific infinite-dimensional NNM (PMF refers to continuous distributions).\nThe evaluation of NNMs in the extreme multi-label setting [15, 16, 17, 18] is still outstanding."
    }, {
      "heading" : "11 Conclusion",
      "text" : "We introduced NNMs at the example of item recommendation. We discussed in which way these models meet the criteria predictive power, computational tractability and interpretability that are ideally met by recommender systems. The main strength of NNMs is their high level of interpretability. This quality can be used to characterize users’ behavior in an interpretable manner, and this quality can be used to derive hierarchical orderings of properties of items and users. Fortunately, as indicated by numerical experiments, these features of NNMs do not come at the price of sacrificing neither predictive power nor computational tractability. Hence, we believe that NNMs will prove valuable in recommendation and beyond."
    }, {
      "heading" : "12 Acknowledgments",
      "text" : "I thank Patrick Pletscher and Sharon Wulff for interesting and fruitful discussions. I acknowledge funding by the ARO grant Contract Number W911NF-12-0486, and I acknowledge funding by the Swiss National Science Foundation through a postdoctoral fellowship."
    }, {
      "heading" : "A MAE vs RMSE",
      "text" : "Assume the considered items are movies. Then, it can happen that a user u likes movie i but rates it badly because of the particular reason that one of the actors is a member of scientology. Hence, the reason for the poor rating is independent of user u’s movie taste; rather it is a consequence of user u being atheist. It seems very unlikely that information of that kind is captured by the few numbers we use to describe a person’s movie taste. Moreover, in practice, we would presumably not have enough data about movie i to infer that one of the actors is a member of scientology. Hence, even extremely good models for capturing movie tastes will make a few predictions that are entirely wrong—nothing else should be expected. In conclusion, when measuring the quality of a model in terms of an error metric we may want to consider error metrics that are not too sensitive to a few outliers (i.e., predictions that are entirely wrong). RMSE is a scaled l2-distance and MAE is a scaled l1-distance. Hence, RMSE is much more sensitive to outliers than MAE. For that reason MAE appears to be more meaningful than RMSE. Moreover, there is an unavoidable tradeoff between enforcing low MAE and low RMSE—a recommender system cannot be near-optimal in both error measures."
    }, {
      "heading" : "B Configurations of algorithms",
      "text" : "Table 2 specifies the configurations of algorithms as called by the Java LibRec library [4]."
    } ],
    "references" : [ {
      "title" : "Factorization meets the neighborhood: a multifaceted collaborative filtering model",
      "author" : [ "Yehuda Koren" ],
      "venue" : "In Proceedings of the 14th ACM SIGKDD international conference on Knowledge discovery and data mining,",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2008
    }, {
      "title" : "CVX: Matlab software for disciplined convex programming, version 2.1",
      "author" : [ "Michael Grant", "Stephen Boyd" ],
      "venue" : null,
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2014
    }, {
      "title" : "SDPT3 a MATLAB software package for semidefinite programming, version 1.3",
      "author" : [ "Kim-Chuan Toh", "Michael J Todd", "Reha H Tütüncü" ],
      "venue" : "Optimization methods and software,",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 1999
    }, {
      "title" : "Grouplens: an open architecture for collaborative filtering of netnews",
      "author" : [ "Paul Resnick", "Neophytos Iacovou", "Mitesh Suchak", "Peter Bergstrom", "John Riedl" ],
      "venue" : "In Proceedings of the 1994 ACM conference on Computer supported cooperative work,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 1994
    }, {
      "title" : "Bpr: Bayesian personalized ranking from implicit feedback",
      "author" : [ "Steffen Rendle", "Christoph Freudenthaler", "Zeno Gantner", "Lars Schmidt-Thieme" ],
      "venue" : "In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence,",
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 2009
    }, {
      "title" : "Algorithms for non-negative matrix factorization",
      "author" : [ "Daniel D Lee", "H Sebastian Seung" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2001
    }, {
      "title" : "Latent class models for collaborative filtering",
      "author" : [ "Thomas Hofmann", "Jan Puzicha" ],
      "venue" : "In IJCAI,",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 1999
    }, {
      "title" : "Probabilistic latent semantic indexing",
      "author" : [ "Thomas Hofmann" ],
      "venue" : "Proceedings of the 22nd annual international ACM SIGIR conference on Research and development in information retrieval,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 1999
    }, {
      "title" : "Latent dirichlet allocation",
      "author" : [ "David M Blei", "Andrew Y Ng", "Michael I Jordan" ],
      "venue" : "Journal of machine Learning research,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2003
    }, {
      "title" : "Recommender systems with social regularization",
      "author" : [ "Hao Ma", "Dengyong Zhou", "Chao Liu", "Michael R Lyu", "Irwin King" ],
      "venue" : "In Proceedings of the fourth ACM international conference on Web search and data mining,",
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 2011
    }, {
      "title" : "The nested chinese restaurant process and bayesian nonparametric inference of topic hierarchies",
      "author" : [ "David M Blei", "Thomas L Griffiths", "Michael I Jordan" ],
      "venue" : "Journal of the ACM (JACM),",
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2010
    }, {
      "title" : "Nested hierarchical dirichlet processes",
      "author" : [ "John Paisley", "Chingyue Wang", "David M Blei", "Michael Jordan" ],
      "venue" : "Pattern Analysis and Machine Intelligence, IEEE Transactions on,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2015
    }, {
      "title" : "Probabilistic matrix factorization",
      "author" : [ "Andriy Mnih", "Ruslan Salakhutdinov" ],
      "venue" : "In Advances in neural information processing systems,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 2007
    }, {
      "title" : "Multi-label learning with millions of labels: Recommending advertiser bid phrases for web pages",
      "author" : [ "Rahul Agrawal", "Archit Gupta", "Yashoteja Prabhu", "Manik Varma" ],
      "venue" : "In Proceedings of the 22nd international conference on World Wide Web,",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2013
    }, {
      "title" : "Multi-label prediction via compressed sensing",
      "author" : [ "Daniel Hsu", "Sham Kakade", "John Langford", "Tong Zhang" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2009
    }, {
      "title" : "Extracting shared subspace for multi-label classification",
      "author" : [ "Shuiwang Ji", "Lei Tang", "Shipeng Yu", "Jieping Ye" ],
      "venue" : "In Proceedings of the 14th ACM SIGKDD international conference on Knowledge discovery and data mining,",
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "We show that in mean-average-error, NNMs outperform methods like SVD++ [1] on MovieLens datasets.",
      "startOffset" : 71,
      "endOffset" : 74
    }, {
      "referenceID" : 3,
      "context" : ", z ∈ [5] in case of 5-star ratings).",
      "startOffset" : 6,
      "endOffset" : 9
    }, {
      "referenceID" : 0,
      "context" : ", SVD++ [1]), and the potential possibilities motivate a thorough analysis of the modeling of categorical variables in terms of general matrix factorization.",
      "startOffset" : 8,
      "endOffset" : 11
    }, {
      "referenceID" : 1,
      "context" : ", g i ni ) i∈[I] and to all item vectors ( ~ Eiz ) i∈[I],z∈[Z] (z ∈ [2]; z = 1 means ‘like’ and z = 2 means ‘dislike’).",
      "startOffset" : 68,
      "endOffset" : 71
    }, {
      "referenceID" : 0,
      "context" : "For every choice of ε ∈ [0, 1], the graph G induces an approximate hierarchical ordering of tags; see figure 2.",
      "startOffset" : 24,
      "endOffset" : 30
    }, {
      "referenceID" : 1,
      "context" : "We computed NNMs in Matlab using cvx [2] calling SDPT3 [3].",
      "startOffset" : 37,
      "endOffset" : 40
    }, {
      "referenceID" : 2,
      "context" : "We computed NNMs in Matlab using cvx [2] calling SDPT3 [3].",
      "startOffset" : 55,
      "endOffset" : 58
    }, {
      "referenceID" : 0,
      "context" : "We notice that Algorithm 1 outperforms SVD++ [1] in MAE.",
      "startOffset" : 45,
      "endOffset" : 48
    }, {
      "referenceID" : 3,
      "context" : "MAE (100K) RMSE (100K) MAE (1M) RMSE (1M) UserKNN [5] 0.",
      "startOffset" : 50,
      "endOffset" : 53
    }, {
      "referenceID" : 4,
      "context" : "905 ItemKNN [6] 0.",
      "startOffset" : 12,
      "endOffset" : 15
    }, {
      "referenceID" : 5,
      "context" : "876 NMF [7] 0.",
      "startOffset" : 8,
      "endOffset" : 11
    }, {
      "referenceID" : 0,
      "context" : "920 SVD++ [1] 0.",
      "startOffset" : 10,
      "endOffset" : 13
    }, {
      "referenceID" : 6,
      "context" : "In aspect models, pLSA [8, 9] (and similarly in their extension LDA [10]) we model (u, i) as random variable with distribution",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 7,
      "context" : "In aspect models, pLSA [8, 9] (and similarly in their extension LDA [10]) we model (u, i) as random variable with distribution",
      "startOffset" : 23,
      "endOffset" : 29
    }, {
      "referenceID" : 8,
      "context" : "In aspect models, pLSA [8, 9] (and similarly in their extension LDA [10]) we model (u, i) as random variable with distribution",
      "startOffset" : 68,
      "endOffset" : 72
    }, {
      "referenceID" : 9,
      "context" : "Similarly, more general NMF-based models [11] agree with NNM-based models in that they make prediction in terms of inner products of nonnegative vectors but they differ from NNM-based models through different interpretations and regularizations of those nonnegative vectors.",
      "startOffset" : 41,
      "endOffset" : 45
    }, {
      "referenceID" : 3,
      "context" : "For instance, to model multiple outcomes like (z ∈ [5]) we need to first decide on a particular graphical model (see section 2.",
      "startOffset" : 51,
      "endOffset" : 54
    }, {
      "referenceID" : 6,
      "context" : "3 in [8]).",
      "startOffset" : 5,
      "endOffset" : 8
    }, {
      "referenceID" : 10,
      "context" : "Moreover, to extract hierarchical classifications of topics, we need to imagine generative processes like the nested Chinese restaurant process [12], or we need to employ nested hierarchical Dirichlet processes [13].",
      "startOffset" : 144,
      "endOffset" : 148
    }, {
      "referenceID" : 11,
      "context" : "Moreover, to extract hierarchical classifications of topics, we need to imagine generative processes like the nested Chinese restaurant process [12], or we need to employ nested hierarchical Dirichlet processes [13].",
      "startOffset" : 211,
      "endOffset" : 215
    }, {
      "referenceID" : 12,
      "context" : "On the other hand, probabilistic matrix factorization (PMF, [14]) leads to another interesting and related class of models where we assume that entries Rui of the rating matrix are independent Gaussian random variables with mean ~ U u ~ Vi and variance σ.",
      "startOffset" : 60,
      "endOffset" : 64
    }, {
      "referenceID" : 13,
      "context" : "The evaluation of NNMs in the extreme multi-label setting [15, 16, 17, 18] is still outstanding.",
      "startOffset" : 58,
      "endOffset" : 74
    }, {
      "referenceID" : 14,
      "context" : "The evaluation of NNMs in the extreme multi-label setting [15, 16, 17, 18] is still outstanding.",
      "startOffset" : 58,
      "endOffset" : 74
    }, {
      "referenceID" : 15,
      "context" : "The evaluation of NNMs in the extreme multi-label setting [15, 16, 17, 18] is still outstanding.",
      "startOffset" : 58,
      "endOffset" : 74
    } ],
    "year" : 2015,
    "abstractText" : "We introduce normalized nonnegative models (NNM) for explorative data analysis. NNMs are partial convexifications of models from probability theory. We demonstrate their value at the example of item recommendation. We show that NNM-based recommender systems satisfy three criteria that all recommender systems should ideally satisfy: high predictive power, computational tractability, and expressive representations of users and items. Expressive user and item representations are important in practice to succinctly summarize the pool of customers and the pool of items. In NNMs, user representations are expressive because each user’s preference can be regarded as normalized mixture of preferences of stereotypical users. The interpretability of item and user representations allow us to arrange properties of items (e.g., genres of movies or topics of documents) or users (e.g., personality traits) hierarchically.",
    "creator" : "LaTeX with hyperref package"
  }
}