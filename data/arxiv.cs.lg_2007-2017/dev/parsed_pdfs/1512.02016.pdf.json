{
  "name" : "1512.02016.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Discriminative Nonparametric Latent Feature Relational Models with Data Augmentation",
    "authors" : [ "Bei Chen", "Ning Chen", "Jun Zhu", "Jiaming Song", "Bo Zhang" ],
    "emails" : [ "{chenbei12@mails.,", "ningchen@,", "dcszj@,", "sjm12@mails.,", "dcszb@}tsinghua.edu.cn" ],
    "sections" : [ {
      "heading" : "Introduction",
      "text" : "Link prediction is a fundamental task in statistical network analysis. For static networks, it is defined as predicting the missing links from a partially observed network topology (and some attributes if exist). Existing approaches include: 1) Unsupervised methods that design good proximity/similarity measures between nodes based on network topology features (Liben-Nowell and Kleinberg 2003), e.g., common neighbors, Jaccard’s coefficient (Salton and McGill 1983), Adamic/Adar (Adamic and Adar 2003), etc; 2) Supervised methods that learn classifiers on labeled data with a set of manually designed features (Lichtenwalter, Lussier, and Chawla 2010; Hasan et al. 2006; Shi et al. 2009); 3) others (Backstrom and Leskovec 2011) that use random walks to combine the network structure information with node and edge attributes. One possible limitation for such methods is that they rely on well-designed features or measures, which can be time demanding to get and/or application specific.\nLatent variable models (Hoff, Raftery, and Handcock 2002; Hoff 2007; Chang and Blei 2009) have been widely applied to discover latent structures from complex network ∗Corresponding authors. Copyright c© 2016, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved.\ndata, based on which prediction models are developed for link prediction. Although these models work well, one remaining problem is how to determine the unknown number of latent classes or features. A typical way using model selection, e.g., cross-validation or likelihood ratio test (Liu and Shao 2003), can be computationally prohibitive by comparing many candidate models. Bayesian nonparametrics has shown promise in bypassing model selection by imposing an appropriate stochastic process prior on a rich class of models (Antoniak 1974; Griffiths and Ghahramani 2005). For link prediction, the infinite relational model (IRM) (Kemp et al. 2006) is class-based and uses Bayesian nonparametrics to discover systems of related concepts. One extension is the mixed membership stochastic blockmodel (MMSB) (Airoldi et al. 2008), which allows entities to have mixed membership. (Miller, Griffiths, and Jordan 2009) and (Zhu 2012) developed nonparametric latent feature relational models (LFRM) by incorporating Indian Buffet Process (IBP) prior to resolve the unknown dimension of a latent feature space. Though LFRM has achieved promising results, exact inference is intractable due to the non-conjugacy of the prior and link likelihood. One has to use Metropolis-Hastings (Miller, Griffiths, and Jordan 2009), which may have low accept rates if the proposal distribution is not well designed, or variational inference (Zhu 2012) with truncated mean-field assumptions, which may be too strict in practice.\nIn this paper, we develop discriminative nonparametric latent feature relational models (DLFRM) by exploiting the ideas of data augmentation with simpler Gibbs sampling (Polson and Scott 2011; Polson, Scott, and Windle 2013) under the regularized Bayesian inference (RegBayes) framework (Zhu, Chen, and Xing 2014). Our major contributions are: 1) We use the RegBayes framework for DLFRM to deal with the imbalance issue in real networks and naturally analyze both the logistic log-loss and the max-margin hinge loss under a unified setting; 2) We explore data augmentation techniques to develop a simple Gibbs sampling algorithm, which is free from unnecessary truncation and assumptions that typically exist in variational approximation methods; 3) We develop an approximate Gibbs sampler using stochastic gradient Langevin dynamics, which can handle large networks with hundreds of thousands of entities and millions of links (See Table 1), orders of magnitude larger than what the existing LFRM models (Miller, Griffiths, and Jordan 2009; ar X\niv :1\n51 2.\n02 01\n6v 1\n[ cs\n.L G\n] 7\nD ec\n2 01\n5\nZhu 2012) can process; and 4) Finally, we conduct experimental studies on a wide range of real networks and the results demonstrate promising results of our methods."
    }, {
      "heading" : "Nonparametric LFRM Models",
      "text" : "We consider static networks with N entities. Let Y be the N × N binary link indicator matrix, where yij = 1 denotes the existence of a link from entity i to j, and yij = −1 denotes no link from i to j. Y is not fully observed.\nOur goal is to learn a model from the partially observed links and predict the values of the unobserved entries of Y . Fig. 1 illustrates a latent feature relational model (LFRM), where each entity is represented by K latent features. Let Z be the N × K feature matrix, each row is associated with an entity and each column corresponds to a feature. We consider the binary fea-\ntures1: If entity i has feature k, then zik = 1, otherwise zik = 0. Let Zi be the feature vector of entity i, U be a K × K real-valued weight matrix, η = vec(U) and Zij = vec(Z>i Zj), where vec(A) is a vector concatenating the row vectors of matrix A. Note that η and Zij are column vectors, while Zi is a row vector. Then the probability of the link from entity i to j is\np(yij = 1|Zi, Zj , U) = σ ( ZiUZ > j ) = σ ( η>Zij ) , (1)\nwhere σ(x)= 1 1+exp(−x) is the sigmoid function. We assume that links are conditionally independent given Z and U , then the link likelihood is p(Y |Z,U) = ∏ (i,j)∈I p(yij |Zi, Zj , U), where I is the set of training links (observed links). In the above formulation, we assume that the dimensionality of the latent featuresK is known a priori. However, this assumption is often unrealistic especially when dealing with large-scale applications. The conventional approaches that usually need a model selection procedure (e.g., cross validation) to choose an appropriate value by trying on a large set of candidates can be expensive and often require extensive human efforts on guiding the search. Recent progress on Bayesian optimization (Snoek, Larochelle, and Adams 2012) provides more effective solution to searching for good parameters, but still needs to learn many models under different configurations of the hyper-parameter K.\nIn this paper, we focus on the nonparametric Bayesian methods (Griffiths and Ghahramani 2005) for link prediction. The recently developed nonparametric latent feature relational models (LFRM) (Miller, Griffiths, and Jordan 2009) leverage the advancement of Bayesian nonparametric methods to automatically resolve the unknown dimensionality of the feature space by applying a flexible nonparametric prior.\n1Real-valued features can be learned by using composition, e.g., Ri = Zi ⊗ Hi, where Hi is the real-valued vector representing the amplitudes of each feature while the binary vector Zi represents the presence of each feature.\nIt assumes that each entity i has an infinite number of binary features, that is Zi ∈ {0, 1}∞, and the Indian Buffet Process (IBP) (Griffiths and Ghahramani 2005) is used as a prior of Z to produce a sparse latent feature vector for each entity.\nWe treat the weight matrix U as random and put a prior on it for fully Bayesian inference. Then with Bayes’ theorem, the posterior distribution is\nq(Z,U |Y ) ∝ p0(Z)p0(U)p(Y |Z,U), (2) where the prior p0(Z) is an IBP and p0(U) is often assumed to be an isotropic Gaussian prior."
    }, {
      "heading" : "Discriminative LFRM Models",
      "text" : "The conventional Bayesian inference as above relies on Bayes’ rule to infer the posterior distribution. In fact, this procedure can be equivalently formulated as solving an optimization problem. For example, the Bayes posterior in Eq. (2) is equivalent to the solution of the following problem:\nmin q(Z,U)∈P\nKL(q(Z,U)||p0(Z,U))−Eq[log p(Y |Z,U)], (3)\nwhere P is the space of well-defined distributions and KL(q||p) is the Kullback-Leibler (KL) divergence from q to p. Such an optimization view has inspired the development of regularized Bayesian inference (RegBayes) which solves:\nmin q(Z,U)∈P\nKL(q(Z,U)||p0(Z,U)) + c · R(q(Z,U)), (4)\nwhere R(q) is a posterior regularization defined on the target posterior distribution and c is a non-negative regularization parameter that balances the prior part and the posterior regularization part. We refer the readers to (Zhu, Chen, and Xing 2014) for more details on a generic representation theorem of the solution and its application (Zhu et al. 2014; Mei, Zhu, and Zhu 2014) to learn latent feature models for classification. Below, we explore the ideas to develop effective latent feature relational models for link prediction.\nAlthough we could define an averaging classifier and make predictions using the sign rule ŷij=sign(Eq[ZiUZ>j ]), the resulting problem needs to be approximately solved by truncated variational methods, which can be inaccurate in practice. Here, we propose to define a Gibbs classifier, which admits simple and efficient sampling algorithms that are guaranteed to be accurate. Our Gibbs sampler randomly draws the latent variables (Z,U) from the unknown but preassumed to be given posterior distribution q(Z,U). Once Z and U are given, we can make predictions using the sign rule ŷij = sign(ZiUZ>j ) and measure the training error r(Z,U) = ∑ (i,j)∈I I(yij 6= ŷij), where I(·) is an indicator function. Since the training error is non-smooth and non-convex, it is often relaxed by a well-behaved loss function. Let ωij = ZiUZ>j , two well-studied examples are the logistic log-loss r1 and the hinge loss r2:\nr1(Z,U) = − ∑\n(i,j)∈I\nlog p(ỹij |Zi, Zj , U),\nr2(Z,U) = ∑\n(i,j)∈I\n(`− yijωij)+,\nwhere p(ỹij |Zi, Zj , U) = e ωij ỹij\n1+eωij , (x)+ := max(0, x), `\nis the pre-defined cost to penalize a wrong prediction, and\nỹij = (yij + 1)/2 so that 0 refers to a negative link instead of −1. To account for the uncertainty of the latent variables, we define the posterior regularization as the expected loss:\nR1(q(U,Z))=Eq[r1(Z,U)],R2(q(U,Z))=Eq[r2(Z,U)]. With these posterior regularization functions, we can do the RegBayes as in problem (4), where the parameter c balances the influence between the prior distribution (i.e., KL divergence) and the observed link structure (i.e., the loss term). We define the un-normalized pseudo link likelihood:\nϕ1(ỹij |Zi, Zj , U) = (eωij )cỹij\n(1 + eωij )c , (5)\nϕ2(yij |Zi, Zj , U) = exp(−2c(`− yijωij)+). (6) Then problem (4) can be written in the equivalent form:\nmin q(Z,U)∈P\nKL(q(Z,U)||p0(Z,U))−Eq[logϕ(Y |Z,U)], (7)\nwhere ϕ(Y |Z,U) = ∏ i,j∈I ϕ(yij |Zi, Zj , U) and ϕ can be ϕ1 or ϕ2. Then the optimal solution of (4) or (7) is the following posterior distribution with link likelihood:\nq(Z,U |Y ) ∝ p0(Z)p0(U)ϕ(Y |Z,U). (8) Notice that if adopting the logistic log-loss, we actually obtain a generalized pseudo-likelihood which is a powered form of likelihood in Eq. (1).\nFor real networks, positive links are often highly sparse as shown in Table 1. Such sparsity could lead to serious imbalance issues in supervised learning, where the negative examples are much more than positive examples. In order to deal with the imbalance issue in network data and make the model more flexible, we perform RegBayes by controlling the regularization parameter. For example, we can choose a larger c value for the fewer positive links and a relatively smaller c for the larger negative links. This strategy has shown effective in dealing with imbalanced data in (Chen et al. 2015; Zhu 2012). We will provide experiments to demonstrate the benefits of RegBayes on dealing with imbalanced networks when learning nonparametric LFRMs."
    }, {
      "heading" : "Gibbs Sampling with Data Augmentation",
      "text" : "As we do not have a conjugate prior on U , exact posterior inference is intractable. Previous inference methods for nonparametric LFRM use either Metropolis-Hastings (Miller, Griffiths, and Jordan 2009) or variational techniques (Zhu 2012) which can be either inefficient or too strict in practice. We explore the ideas of data augmentation to give the pseudo-likelihood a proper design, so that we can directly obtain posterior distributions and develop efficient Gibbs sampling algorithms. Specifically, our algorithm relies on the following unified representation lemma. Lemma 1. Both ϕ1 and ϕ2 can be represented as\nϕ(yij |Zi, Zj , U) ∝ ∫ ∞ 0 exp ( κijωij− ρijω 2 ij 2 ) φ(λij)dλij ,\nwhere for ϕ1 we have\nκij = c(ỹij − 1\n2 ), ρij = λij , φ(λij) = PG(λij ; c, 0);\nAlgorithm 1 Gibbs sampler for DLFRM Init: draw Z from IBP, U from N (0, ν−2); set λ = 1. for iter = 1, 2, . . . , L do\nfor n = 1, 2, . . . , N do draw {znk}Kk=1 from Eq. (11); draw kn using Eq. (12). if kn > 0 then\nupdate K ← K + kn, update new weights; end if\nend for draw U using Eq. (13) and draw λ using Eq. (14).\nend for\nwhile for ϕ2, let γij = λ−1ij , we have\nκij = cyij(1 + c`γij), ρij = c 2γij , φ(λij) = GIG(\n1 2 , 1, c2`2).\nWe have used PG to denote a Polya-Gamma distribution (Polson, Scott, and Windle 2013) and GIG to denote a generalized inverse Gaussian distribution. We defer the proof to Appendix A2, which basically follows (Polson, Scott, and Windle 2013; Polson and Scott 2011) with some algebraic manipulation on re-organizing the terms."
    }, {
      "heading" : "Sampling Algorithm",
      "text" : "Lemma 1 suggests that the pseudo-likelihood ϕ can be considered as the marginal of a higher dimensional distribution that includes the augmented variables λ: ψ(λ, Y |Z,U)∝ ∏\n(i,j)∈I\nexp ( κijωij − ρijω 2 ij\n2\n) φ(λij), (9)\nwhich is a mixture of Gaussian components of U once Z is given, suggesting that we can effectively perform Gibbs sampling if a conjugate Gaussian prior is imposed on U . We also construct the complete posterior distribution:\nq(Z,U, λ|Y ) ∝ p0(Z)p0(U)ψ(λ, Y |Z,U), (10) such that our target posterior q(Z,U |Y ) is a marginal distribution of the complete posterior. Therefore, if we can draw a set of samples {(Zt, Ut, λt)}Lt=1 from the complete posterior, by dropping the augmented variables, the rest samples {(Zt, Ut)}Lt=1 are drawn from the target posterior q(Z,U |Y ). This technique allows us to sample the complete posterior via a Gibbs sampling algorithm, as outlined in Alg. 1 and detailed below.\nFor Z: We assume the Indian Buffet Process (IBP) prior on the latent feature Z. Although the total number of latent features is infinite, every time we only need to store K active features that are not all zero in the columns of Z. When sampling the n-th row, we need to consider two cases, due to the nonparametric nature of IBP.\nFirst, for the active features, we sample znk(k = 1, ...,K) in succession from the following conditional distribution\nq(znk|Z−nk, η, λ) ∝ p(znk)ψ(λ, Y |Z−nk, η, znk), (11) 2Supplemental Material:\nhttp://bigml.cs.tsinghua.edu.cn/%7Ebeichen/pub/DLFRM2.pdf\nwhere p(znk = 1) ∝ m−n,k and m−n,k is the number of entities containing feature k except entity n.\nSecond, for the infinite number of remaining all-zero features, we sample kn number of new features and add them to the nth row. Then we get the new N × (K + kn) matrix Z∗ which becomes old when sampling the (n + 1)-th row. Every time when the number of features changes, we also update U and extend it to a (K + kn) × (K + kn) matrix U∗. Let Z ′ and U ′ be the parts of Z∗ and U∗ that correspond to the kn new features. Also, we define η′ = vec(U ′). During implementation, we can delete the all-zero columns after every resampling of Z, but here we ignore it. Let η follow the isotropic Normal prior N (0, ν−2). Now the conditional distribution for kn = 0 is p(kn = 0|Z, η, λ) = p0(kn), and the probability of kn 6= 0 is\np(kn 6= 0|Z, η, λ)=p0(kn)|Σ| 1 2 νDexp (1 2 µ>Σ−1µ ) , (12)\nwhere p0(kn) = Poisson ( kn; α N ) is from the IBP prior, D = 2knK + k 2 n is the dimension of η\n′ and the mean µ = Σ( ∑ (i,j)∈I(κij − ρijωij)Z ′ij) , covariance Σ =\n( ∑\n(i,j)∈I ρijZ ′ ijZ ′ ij > + ν2I)−1. We compute the probabilities for kn = 0, 1, ...,Kmax, do normalization and sample from the resulting multinomial. Here, Kmax is the maximum number of features to add. Once we have added kn(6=0) new features, we should also sample their weights η′, which follow aD dimensional multivariate Gaussian, in order to resample the next row of Z.\nFor U : After the update of Z, we resample U given the new Z. Let D̃ = K ×K and η follow the isotropic Normal prior p0(η) = ∏D̃ d=1N (ηd; 0, ν−2). Then the posterior is also a Gaussian distribution\nq(η|λ, Z) ∝ p0(η)ψ(λ, Y |Z, η) = N (η; µ̃, Σ̃), (13) with the mean µ̃ = Σ̃( ∑\n(i,j)∈I κijZij) and the convariance Σ̃ = ( ∑ (i,j)∈I ρijZijZ > ij + ν\n2I)−1. For λ: Since the auxiliary variables are independent given the new Z and U , we can draw each λij separately. From the unified representation, we have\nq(λij |Z, η) ∝ exp ( κijωij − ρijω 2 ij\n2\n) φ(λij). (14)\nBy doing some algebra, we can get the following equations. For ϕ1, λij still follows a Polya-Gamma distribution q(λij |Z, η) = PG(λij ; c, ωij), from which a sample can be efficiently drawn. For ϕ2, λij follows a generalized inverse Gaussian distribution q(λij |Z,U, Y ) = GIG( 12 , 1, c\n2ζ2ij), where ζij = ` − yijωij . Then γij := λ−1ij follows an inverse Gaussian distribution q(γij |Z,U, Y ) = IG( 1c|ζij | , 1), from which a sample can be easily drawn in a constant time."
    }, {
      "heading" : "Stochastic Gradient Langevin Dynamics",
      "text" : "Alg. 1 needs to sample from a K2-dim Gaussian distribution to get U , where K is the latent feature dimension. This procedure is prohibitively expensive for large networks when K is large (e.g., K > 40). To address this problem,\nwe employ stochastic gradient Langevin dynamics (SGLD) (Welling and Teh 2011), an efficient gradient-based MCMC method that uses unbiased estimates of gradients with random mini-batches. Let θ denote the model parameters and p(θ) is a prior distribution. Given a set of i.i.d data points D = {xi}Mi=1, the likelihood is p(D|θ) = ∏M i=1 p(xi|θ). At each iteration t, the update equation for θ is:\n∆θt= t 2\n( ∇ log p(θt)+ M\nm ∑ xi∈Dt ∇ log p(xi|θt) ) +δt, (15)\nwhere t is the step size, Dt is a subset of D with size m and δt ∼ N (0, t) is the Gaussian noise. When the stepsize is annealed properly, the Markov chain will converge to the true posterior distribution.\nLet It be a subset of I with size m. We can apply SGLD to sample η (i.e., U ). Specifically, according to the true posterior of η as in Eq. (13), the update rule is:\n∆ηt= t 2\n( −ν2ηt+\n|I| m ∑ (i,j)∈It (κij−ρijωij)Zij ) +δt, (16)\nwhere δt is a K2-dimensional vector and each entry is a Gaussian noise. After a few iterations, we will get the approximate sampler of η (i.e., U ) very efficiently."
    }, {
      "heading" : "Experiments",
      "text" : "We present experimental results to demonstrate the effectiveness of DLFRM on five real datasets as summarized in Table 1, where NIPS contains 234 authors who have the most coauthor-relationships with others from NIPS 1- 17; Kinship includes 26 relationships of 104 people in the Alyawarra tribe in central Australia; WebKB contains 877 webpages from the CS departments of different universities, where the dictionary has 1, 703 unique words; AstroPh contains collaborations between 17, 903 authors of papers submitted to Arxiv Astro Physics in the period from Jan. 1993 to Apr. 2003 (Leskovec, Kleinberg, and Faloutsos 2007); and Gowalla contains 196, 591 people and their friendships on Gowalla social website (Cho, Myers, and Leskovec 2011). All these real networks have very sparse links.\nWe evaluate three variants of our model: (1) DLFRM: to overcome the imbalance issue, we set c+ = 10c− = c as in (Zhu 2012), where c+ is the regularization parameter for positive links and c− for negative links. We use a full asymmetric weight matrix U ; (2) stoDLFRM: the DLFRM model that uses SGLD to sample weight matrix U , where the stepsizes are set by t = a(b + t)−γ for log-loss and AdaGrad (Duchi, Hazan, and Singer 2011) for hinge loss; (3) diagDLFRM: the DLFRM that uses a diagonal weight matrix U . Each variant can be implemented with the logistic log-loss or hinge loss, denoted by the superscript l or h.\nWe randomly select a development set from training set with almost the same number of links as testing set and choose the proper hyper-parameters, which are insensitive in a wide range. All the results are averaged over 5 runs with random initializations and the same group of parameters."
    }, {
      "heading" : "Results on Small Networks",
      "text" : "We first report the prediction performance (AUC scores) on three relatively small networks. For fair comparison, we follow the previous settings to randomly choose 80% of the links for training and use the remaining 20% for testing. AUC score is the area under the Receiver Operating Characteristic (ROC) curve; higher is better.\nNIPS Coauthorship Prediction Table 2 shows the AUC scores on NIPS dataset, where the results of baselines (i.e., LFRM, IRM, MMSB, MedLFRM and BayesMedLFRM) are cited from (Miller, Griffiths, and Jordan 2009; Zhu 2012). We can see that both DLFRMl and DLFRMh outperform all other models, which suggests that our exact Gibbs sampling with data augmentation can lead to more accurate models than MedLFRM / BayesMedLFRM that uses the variational approximation methods with truncated meanfield assumptions. The stoDLFRMs obtain comparable results to DLFRMs, which suggests that approximate sampler for η using SGLD is very effective. With SGLD, we can improve efficiency without sacrificing performance which we will discuss later with Table 4. Furthermore, diagDLFRMl and diagDLFRMh also perform well, as they beat all other methods except (sto)DLFRMs. By using a lower dimensional η derived from the diagonal weight matrix U , diagDLFRM has the advantage of being computationally efficient, as shown in Fig. 3(d). The good performance of stoDLFRMs and diagDLFRMs suggests that we can use SGLD with a full weight matrix or simply use a diagonal weight matrix on large-scale networks.\nKinship Multi-relation Prediction For multi-relational Kinship dataset, we consider the “single” setting (Miller, Griffiths, and Jordan 2009), where we infer an independent set of latent features for each relation. The overall AUC is obtained by averaging the results of all relations. As shown in Table 2, both (sto)DLFRMl and (sto)DLFRMh outperform all other methods, which again proves the effectiveness of our methods. Furthermore, the diagonal variants also\nobtain fairly good results, close to the best baselines. Finally, the better results by the discriminative methods in general demonstrate the effect of RegBayes on using various regularization parameters to deal with the imbalance issue; Fig. 3(b) provides a detailed sensitivity analysis.\nWebKB Hyperlink Prediction We also examine how DLFRMs perform on WebKB network, which has rich text attributes (Craven et al. 1998). Our baselines include: 1) Katz: a proximity measure between two entities—it directly sums over all collection of paths, exponentially damped by the path length to count short paths more heavily (LibenNowell and Kleinberg 2003); 2) Linear SVM: a supervised learning method using linear SVM, where the feature for each link is a vector concatenating the bag-of-words features of two entities; 3) RBF-SVM: SVM with the RBF kernel on the same features as the linear SVM. We use SVM-Light (Joachims 1998) to train these classifiers; and 4) MedLFRM: state-of-the-art methods on learning latent features for link prediction (Zhu 2012). Note that we don’t compare with the relational topic models (Chang and Blei 2009; Chen et al. 2015), whose settings are quite different from ours. Table 3 shows the AUC scores of various methods. We can see that: 1) both MedLFRM and DLFRMs perform better than SVM classifiers on raw bag-of-words features, showing the promise of learning latent features for link prediction on document networks; 2) DLFRMs are much better than MedLFRM3, suggesting the advantages of using data augmentation techniques for accurate inference over variational methods with truncated mean-field assumptions; and 3) both stoDLFRMs and diagDLFRMs achieve competitive results with faster speed."
    }, {
      "heading" : "Results on Large Networks",
      "text" : "We now present results on two much larger networks. As the networks are much sparser, we randomly select 90% of the positive links for training and the number of negative training links is 10 times the number of positive training links. The testing set contains the remaining 10% of the positive links and the same number of negative links, which we uniformly sample from the negative links outside the training set. This test setting is the same as that in (Kim et al. 2013).\n3MedLFRM results are only available when truncation level < 20 due to its inefficiency.\nAstroPh Collaboration Prediction Fig. 2 presents the test AUC scores, where the results of the state-of-the-art nonparametric models aMMSB (assortative MMSB) and aHDPR (assortative HDP relational model, a nonparametric generalization of aMMSB) are cited from (Kim et al. 2013). We can see that DLFRMs achieve significantly better AUCs than aMMSB and aHDPR, which again demonstrates that our models can not only automatically infer the latent dimension, but also learn the effective latent features for entities. Furthermore, stoDLRMs and diagDLFRMs show larger benefits on the larger networks due to the efficiency. As shown in Table 4, the time for sampling U is greatly reduced with SGLD. It only accounts for 4.50% of the whole time for stoDLFRMl, while the number is 74.32% for DLFRMl.\nGowalla Friendship Prediction Finally, we test on the largest Gowalla network, which is out of reach for many state-of-art methods, including LFRM, MedLFRM and our DLFRMs without SGLD. Some previous works combine the geographical information of Gowalla social network to analyze user movements or friendships (Cho, Myers, and Leskovec 2011; Scellato, Noulas, and Mascolo 2011), but we are not aware of any fairly comparable results for our setting of link prediction. Here, we present the results of some proximitiy-measure based methods, including common neighbors (CN), Jaccard coefficient, and Katz. As the network is too large to search for all the paths, we only concern the paths that shorter than 4 for Katz. As shown in previous results and Fig. 3(d), DLFRMs with logistic log-loss are more efficient and have comparable results of DLFRMs with hinge loss, so we only show the results of stoDLFRMl and diagDLFRMl. The AUC scores and train-\ning time are shown in Table 5. We can see that stoDLFRMl outperforms all the other methods and diagDLFRMl obtain competitive results. Our diagDLFRMl gets much better performance than the best baseline with less time. It shows that our models can also deal with the large-scale networks."
    }, {
      "heading" : "Closer Analysis",
      "text" : "We use NIPS network as an example to provide closer analysis. Similar observations can be obtained in larger networks (e.g., AstroPh in Appendix B), but taking longer time to run.\nSensitivity to Burn-In Fig. 3(a) shows the test AUC scores w.r.t. the number of burn-in steps. We can see that all our variant models converge quickly to stable results. The diagDLFRMl is a bit slower, but still within 150 steps. These results demonstrate the stability of our Gibbs sampler.\nSensitivity to Parameter c To study how the regularization parameter c handles the imbalance in real networks, we change the value of c+/c− for DLFRMl from 1 to 15 (with all other parameters selected by the development set); and report AUC scores in Fig. 3(b). The first point (i.e., c+ = c− = 1) corresponds to LFRM with our Gibbs sampler, whose lower AUC demonstrates the effectiveness of a larger c+/c− to deal with the imbalance issue. We can see that the AUC score increases when c+/c− becomes larger and the prediction performance is stable in a wide range (e.g., 6 < c+/c− < 12). How large c+/c− a network needs depends on its sparsity. A rule of thumb is that the sparser a network is, the larger c+/c− it may prefer. The results also show that our setting (c+ = 10c−) is reasonable.\nLatent Dimensions Fig. 3(c) shows the number of latent features automatically learnt by variant models. We can see that diagDLFRMs generally need more features than\nDLFRMs because the simplified weight matrix U doesn’t consider pairwise interactions between features. Moreover, DLFRMh needs more features than DLFRMl, possibly because of the non-smoothness nature of hinge loss. The small variance of each method suggests that the latent dimensions are stable in independent runs with random initializations.\nRunning Time Fig. 3(d) compares the training time. It demonstrates all our variant models are more efficient than MedLFRM and BayesMedLFRM (Zhu 2012) that use truncated mean-field approximation. Compared to DLFRMl, DLFRMh takes more time to get the good AUC. The reason is that DLFRMh often converges slower (see Fig. 3(a)) with a larger latent dimension K (see Fig. 3(c)). stoDLFRMs are more effective as we have discussed before. diagDLFRMs are much more efficient due to the linear increase of training time per iteration with respect to K. The testing time for all the methods are very little, omitted due to space limit.\nOverall, DLFRMs improve prediction performance and are more efficient in training, compared with other state-ofthe-art nonparametric LFRMs."
    }, {
      "heading" : "Conclusions and Future Work",
      "text" : "We present discriminative nonparametric LFRMs for link prediction, which can automatically resolve the unknown dimensionality of the latent feature space with a simple Gibbs sampler using data augmentation; unify the analysis for both logistic log-loss and hinge loss; and deal with the imbalance issue in real networks. Experimental results on a wide range of real networks demonstrate superior performance and scalability. For future work, we are interested in developing more efficient algorithms (e.g., using distributed computing) to solve the link prediction problem in web-scale networks.\nAcknowledgments The work was supported by the National Basic Research Program (973 Program) of China (Nos. 2013CB329403, 2012CB316301), National NSF of China (Nos. 61305066, 61322308, 61332007), TNList Big Data Initiative, and Tsinghua Initiative Scientific Research Program (Nos. 20121088071, 20141080934)."
    }, {
      "heading" : "Supplemental Material",
      "text" : ""
    }, {
      "heading" : "Appendix A: The Proof of Lemma 1",
      "text" : "We prove the cases of logistic log-loss and hinge loss in Lemma 1 respectively.\nProof. For the case with logistic log-loss, we directly follow the data-augmentation strategy from (Polson, Scott, and Windle 2013). Let X follow a Polya-Gamma distribution, denoted by X ∼ PG(a, b), that is\nX = 1\n2π2 ∞∑ d=1 gd (d− 1/2)2 + b2/(4π2) , (17)\nwhere a > 0 and b ∈ R are parameters and each gd ∼ G(a, 1) is an independent Gamma random variable. The main result of (Polson, Scott, and Windle 2013) provides an alternative expression for the form of ϕ1 in Eq. (5) by incorporating an augmented variable λ:\nϕ1(ỹij |Zi, Zj , U)= 1\n2c ∫ ∞ 0 exp ( κijωij− λijω 2 ij 2 ) φ(λij)dλij ,(18)\nwhere κij = c(ỹij − 12 ) and φ(λij) = PG(λij ; c, 0). For the case with hinge loss, we take the advantage of data augmentation for support vector machines (Polson and Scott 2011) and ϕ2 in Eq. (6) can be represented as a scale mixture of Gaussian distributions:\nϕ2(yij |Zi, Zj , U)= ∫ ∞ 0 1√ 2πλij exp ( − (λij + cζij) 2 2λij ) dλij ,(19)\nwhere ζij = ` − yijωij and λij is the augmented variable. By reformulating similar terms in Eq. (19), we have:\nϕ2(yij |Zi, Zj , U) ∝ ∫ ∞ 0 1√ 2πλij exp ( − 1 2 (c2`2 λij + λij ))\nexp ( cyij ( 1 + c`\nλij\n) ωij −\nc2ω2ij 2λij\n) dλij\n∝ ∫ ∞ 0 exp ( κijωij − ρijω 2 ij 2 ) φ(λij)dλij .(20)\nwhere κij = cyij(1 + c`λ−1ij ), ρij = c 2λ−1ij and φ(λij) = GIG( 12 , 1, c 2`2). Given the results of Eq. (18) and Eq. (20), Lemma 1 holds true."
    }, {
      "heading" : "Appendix B: Closer Analysis on AstroPh dataset",
      "text" : "Here, we provide more closer analysis on AstroPh dataset which is much larger than the NIPS dataset.\nSensitivity to Burn-In Fig. 4(a) shows the AUC scores on testing data with respect to the number of burn-in steps on AstroPh dataset. We can observe that all our variant models converge quickly to stable results, similar as on NIPS dataset. Our DLFRMs with full weight matrix (e.g., DLFRMl, DLFRMh, stoDLFRMl and stoDLFRMh) converge quickly within 10 steps. The diagDLFRMs need more steps to converge, but still within 40 steps to converge to stable results. These results demonstrate the stability of our Gibbs sampling algorithm.\nSensitivity to Parameter c We analyze how the regularization parameter c handles the imbalance in real networks using diagDLFRMl, which is very efficient (see Fig. 4(d)). Following the settings on NIPS dataset, we change the ratio of c+/c− for diagDLFRMl from 1 to 15 with all the parameters selected by the development set. As shown in Fig. 4(b), the AUC score increases when c+/c− becomes larger and the prediction performance is stable in a wide range (e.g., 6 < c+/c− < 12). These observations again demonstrate that using a larger c+ than c− can effectively deal with the imbalance issue and our setting (c+ = 10c−) is reasonable.\nLatent Dimensions Our variant models take the advantage of nonparametric technique to automatically learn the dimension of the latent features as shown in Fig. 4(c). We can see that diagDLFRMs generally need more features than DLFRMs because the simplified weight matrix U does not consider pairwise interactions between features. Moreover, DLFRMh needs more features than DLFRMl, possibly because of the non-smoothness nature of hinge loss. The small variance of each method suggests that the latent dimensions are stable in independent runs with random initializations.\nRunning Time The training time of our variant models on AstroPh dataset is shown in Fig. 4(d). We can see that for this relatively large network (with tens of thousands of entities and millions of links), the least time we need to obtain the good AUC score is only about 7 × 103 seconds. As on NIPS dataset, DLFRMh takes more time for training than DLFRMl and this phenomenon is more obvious here due to the scalability of the network. The reason is that DLFRMh often converges slower (see Fig 4(a)) with a larger latent dimension K (see Fig. 4(c)). As discussed before, stoDLFRMs are more effective. When a full weight matrix U is used, training time per iteration increases exponentially with respect to K. Therefore, diagDLFRMs are much more efficient due to the linear increase of training time per iteration with respect to K.\nOverall, DLFRMs are stable and improve prediction performance efficiently ."
    } ],
    "references" : [ {
      "title" : "and Adar",
      "author" : [ "L. Adamic" ],
      "venue" : "E.",
      "citeRegEx" : "Adamic and Adar 2003",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Mixed membership stochastic blockmodels",
      "author" : [ "Airoldi" ],
      "venue" : null,
      "citeRegEx" : "Airoldi,? \\Q2008\\E",
      "shortCiteRegEx" : "Airoldi",
      "year" : 2008
    }, {
      "title" : "and Leskovec",
      "author" : [ "L. Backstrom" ],
      "venue" : "J.",
      "citeRegEx" : "Backstrom and Leskovec 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "and Blei",
      "author" : [ "J. Chang" ],
      "venue" : "D.",
      "citeRegEx" : "Chang and Blei 2009",
      "shortCiteRegEx" : null,
      "year" : 2009
    }, {
      "title" : "Discriminative relational topic models",
      "author" : [ "Chen" ],
      "venue" : null,
      "citeRegEx" : "Chen,? \\Q2015\\E",
      "shortCiteRegEx" : "Chen",
      "year" : 2015
    }, {
      "title" : "Friendship and mobility: User movement in location-based social networks. In SIGKDD",
      "author" : [ "Myers Cho", "E. Leskovec 2011] Cho", "S. Myers", "J. Leskovec" ],
      "venue" : null,
      "citeRegEx" : "Cho et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Cho et al\\.",
      "year" : 2011
    }, {
      "title" : "Learning to extract symbolic knowledge from the world wide web",
      "author" : [ "Craven" ],
      "venue" : "NCAI",
      "citeRegEx" : "Craven,? \\Q1998\\E",
      "shortCiteRegEx" : "Craven",
      "year" : 1998
    }, {
      "title" : "Adaptive subgradient methods for online learning and stochastic optimization. JMLR",
      "author" : [ "Hazan Duchi", "J. Singer 2011] Duchi", "E. Hazan", "Y. Singer" ],
      "venue" : null,
      "citeRegEx" : "Duchi et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Duchi et al\\.",
      "year" : 2011
    }, {
      "title" : "and Ghahramani",
      "author" : [ "T. Griffiths" ],
      "venue" : "Z.",
      "citeRegEx" : "Griffiths and Ghahramani 2005",
      "shortCiteRegEx" : null,
      "year" : 2005
    }, {
      "title" : "M",
      "author" : [ "Hasan" ],
      "venue" : "A.; Chaoji, V.; Salem, S.; and Zaki, M.",
      "citeRegEx" : "Hasan et al. 2006",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "Latent space approaches to social network analysis",
      "author" : [ "Raftery Hoff", "P. Handcock 2002] Hoff", "A. Raftery", "M. Handcock" ],
      "venue" : "Journal of the American Statistical Association",
      "citeRegEx" : "Hoff et al\\.,? \\Q2002\\E",
      "shortCiteRegEx" : "Hoff et al\\.",
      "year" : 2002
    }, {
      "title" : "Learning systems of concepts with an infinite relational model",
      "author" : [ "Kemp" ],
      "venue" : null,
      "citeRegEx" : "Kemp,? \\Q2006\\E",
      "shortCiteRegEx" : "Kemp",
      "year" : 2006
    }, {
      "title" : "Efficient online inference for bayesian nonparametric relational models",
      "author" : [ "Kim" ],
      "venue" : null,
      "citeRegEx" : "Kim,? \\Q2013\\E",
      "shortCiteRegEx" : "Kim",
      "year" : 2013
    }, {
      "title" : "Graph evolution: Densification and shrinking diameters. TKDD",
      "author" : [ "Kleinberg Leskovec", "J. Faloutsos 2007] Leskovec", "J. Kleinberg", "C. Faloutsos" ],
      "venue" : null,
      "citeRegEx" : "Leskovec et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Leskovec et al\\.",
      "year" : 2007
    }, {
      "title" : "and Kleinberg",
      "author" : [ "D. Liben-Nowell" ],
      "venue" : "J.",
      "citeRegEx" : "Liben.Nowell and Kleinberg 2003",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "New perspectives and methods in link prediction",
      "author" : [ "Lussier Lichtenwalter", "R. Chawla 2010] Lichtenwalter", "J. Lussier", "N. Chawla" ],
      "venue" : "In SIGKDD",
      "citeRegEx" : "Lichtenwalter et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Lichtenwalter et al\\.",
      "year" : 2010
    }, {
      "title" : "and Shao",
      "author" : [ "X. Liu" ],
      "venue" : "Y.",
      "citeRegEx" : "Liu and Shao 2003",
      "shortCiteRegEx" : null,
      "year" : 2003
    }, {
      "title" : "Robust RegBayes: Selectively incorporating first-order logic domain knowledge into bayesian models",
      "author" : [ "Zhu Mei", "S. Zhu 2014] Mei", "J. Zhu", "X. Zhu" ],
      "venue" : null,
      "citeRegEx" : "Mei et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Mei et al\\.",
      "year" : 2014
    }, {
      "title" : "Nonparametric latent feature models for link prediction",
      "author" : [ "Griffiths Miller", "K. Jordan 2009] Miller", "T. Griffiths", "M. Jordan" ],
      "venue" : null,
      "citeRegEx" : "Miller et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Miller et al\\.",
      "year" : 2009
    }, {
      "title" : "and Scott",
      "author" : [ "N. Polson" ],
      "venue" : "S.",
      "citeRegEx" : "Polson and Scott 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Bayesian inference for logistic models using polya-gamma latent variables",
      "author" : [ "Scott Polson", "N. Windle 2013] Polson", "J. Scott", "J. Windle" ],
      "venue" : "Journal of the American Statistical Association",
      "citeRegEx" : "Polson et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Polson et al\\.",
      "year" : 2013
    }, {
      "title" : "and McGill",
      "author" : [ "G. Salton" ],
      "venue" : "M.",
      "citeRegEx" : "Salton and McGill 1983",
      "shortCiteRegEx" : null,
      "year" : 1983
    }, {
      "title" : "Exploiting place features in link prediction on location-based social networks. In SIGKDD",
      "author" : [ "Noulas Scellato", "S. Mascolo 2011] Scellato", "A. Noulas", "C. Mascolo" ],
      "venue" : null,
      "citeRegEx" : "Scellato et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Scellato et al\\.",
      "year" : 2011
    }, {
      "title" : "User grouping behavior in online forums",
      "author" : [ "Shi" ],
      "venue" : "In SIGKDD",
      "citeRegEx" : "Shi,? \\Q2009\\E",
      "shortCiteRegEx" : "Shi",
      "year" : 2009
    }, {
      "title" : "Practical bayesian optimization of machine learning",
      "author" : [ "Larochelle Snoek", "J. Adams 2012] Snoek", "H. Larochelle", "R. Adams" ],
      "venue" : null,
      "citeRegEx" : "Snoek et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Snoek et al\\.",
      "year" : 2012
    }, {
      "title" : "and Teh",
      "author" : [ "M. Welling" ],
      "venue" : "Y.",
      "citeRegEx" : "Welling and Teh 2011",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Gibbs max-margin topic models with data augmentation",
      "author" : [ "Zhu" ],
      "venue" : null,
      "citeRegEx" : "Zhu,? \\Q2014\\E",
      "shortCiteRegEx" : "Zhu",
      "year" : 2014
    }, {
      "title" : "Bayesian inference with posterior regularization and applications to infinite latent svms",
      "author" : [ "Chen Zhu", "J. Xing 2014] Zhu", "N. Chen", "E. Xing" ],
      "venue" : null,
      "citeRegEx" : "Zhu et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Zhu et al\\.",
      "year" : 2014
    }, {
      "title" : "Max-margin nonparametric latent feature models for link prediction",
      "author" : [ "J. Zhu" ],
      "venue" : "In ICML",
      "citeRegEx" : "Zhu,? \\Q2012\\E",
      "shortCiteRegEx" : "Zhu",
      "year" : 2012
    } ],
    "referenceMentions" : [ ],
    "year" : 2015,
    "abstractText" : "We present a discriminative nonparametric latent feature relational model (LFRM) for link prediction to automatically infer the dimensionality of latent features. Under the generic RegBayes (regularized Bayesian inference) framework, we handily incorporate the prediction loss with probabilistic inference of a Bayesian model; set distinct regularization parameters for different types of links to handle the imbalance issue in real networks; and unify the analysis of both the smooth logistic log-loss and the piecewise linear hinge loss. For the nonconjugate posterior inference, we present a simple Gibbs sampler via data augmentation, without making restricting assumptions as done in variational methods. We further develop an approximate sampler using stochastic gradient Langevin dynamics to handle large networks with hundreds of thousands of entities and millions of links, orders of magnitude larger than what existing LFRM models can process. Extensive studies on various real networks show promising performance.",
    "creator" : "LaTeX with hyperref package"
  }
}