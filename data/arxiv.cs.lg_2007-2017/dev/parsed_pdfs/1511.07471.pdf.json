{
  "name" : "1511.07471.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Weak Convergence Properties of Constrained Emphatic Temporal-difference Learning with Constant and Slowly Diminishing Stepsize∗",
    "authors" : [ "Huizhen Yu" ],
    "emails" : [ "(janey.hzyu@gmail.com)" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n51 1.\n07 47\n1v 3\n[ cs\n.L G\n] 2\n0 Ja\nKeywords: Markov decision processes; approximate policy evaluation; reinforcement learning; temporal difference methods; importance sampling; stochastic approximation; convergence\n∗This research was supported by a grant from Alberta Innovates—Technology Futures. †RLAI Lab, Department of Computing Science, University of Alberta, Canada (janey.hzyu@gmail.com)\n1"
    }, {
      "heading" : "2 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Contents"
    }, {
      "heading" : "1 Introduction 3",
      "text" : ""
    }, {
      "heading" : "2 Preliminaries 5",
      "text" : "2.1 Off-policy Policy Evaluation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 2.2 The ETD(λ) Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 2.3 Associated Bellman Equations and Approximation and Convergence Properties of\nETD(λ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2.4 Constrained ETD(λ), Averaged Processes and Mean ODE . . . . . . . . . . . . . . . 9"
    }, {
      "heading" : "3 Convergence Results for Constrained ETD(λ) 12",
      "text" : "3.1 Main Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 3.2 Two Variants of Constrained ETD(λ) with Biases . . . . . . . . . . . . . . . . . . . . 14 3.3 More about the Constant-stepsize Case . . . . . . . . . . . . . . . . . . . . . . . . . 16"
    }, {
      "heading" : "4 Proofs for Section 3 19",
      "text" : "4.1 Proofs for Theorems 3.1 and 3.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n4.1.1 Conditions to Verify . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 4.1.2 Proofs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n4.2 Proofs for Theorems 3.3 and 3.4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 4.2.1 Proofs for the First Variant . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 4.2.2 Proofs for the Second Variant . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 4.3 Further Analysis of the Constant-stepsize Case . . . . . . . . . . . . . . . . . . . . . 33 4.3.1 Weak Feller Markov Chains . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33 4.3.2 Proofs of Theorems 3.5 and 3.6 . . . . . . . . . . . . . . . . . . . . . . . . . . 34 4.3.3 Proofs of Theorems 3.7 and 3.8 . . . . . . . . . . . . . . . . . . . . . . . . . . 40"
    }, {
      "heading" : "5 Discussion 45",
      "text" : "5.1 The Case without Assumption 2.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46 5.2 Off-policy TD(λ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48 5.3 Open Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\nReferences 49\nAppendix 51\nAppendix A: Key Properties of Trace Iterates 52\n3"
    }, {
      "heading" : "1 Introduction",
      "text" : "We consider discounted finite state and action Markov decision processes (MDPs) and the problem of learning an approximate value function for a given policy from off-policy data, that is, from data due to a different policy. The first policy is called the target policy and the second the behavior policy. The case of on-policy learning, where the target and behavior policies are the same, has been well-studied and widely applied (see e.g., [41, 48] and the books [4, 44]). Off-policy learning provides additional flexibilities and is useful in many contexts. For example, one may want to avoid executing the target policy before estimating the potential risk for safety concerns, or one may want to learn value functions for many target policies in parallel from one exploratory behavior. These require off-policy learning. In addition, insofar as value functions (with respect to different reward/cost assignments) reflect statistical properties of future outcomes, off-policy learning can be used by an autonomous agent to build an experience-based internal model of the world in artificial intelligence applications [43]. Algorithms for off-policy learning are thus not only useful as modelfree computational methods for solving MDPs, but can also potentially be a step toward the goal of making autonomous agents capable of learning over a long life-time, facing a sequence of diverse tasks.\nIn this paper we focus on a new off-policy learning algorithm proposed recently by Sutton, Mahmood, and White [46]: the emphatic temporal-difference (TD) learning algorithm, or ETD(λ). The algorithm is similar to the standard TD(λ) algorithm with linear function approximation [41], but uses a novel scheme to resolve a long-standing divergence problem in TD(λ) when applied to off-policy data. Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]). The difficulty is intrinsic to sampling states according to an arbitrary distribution. Since then alternative algorithms without convergence issues have been sought for off-policy learning. In particular, in the off-policy LSTD(λ) algorithm [5, 51] (an extension of the on-policy least-squares version of TD(λ), called LSTD(λ) [9, 8]), with higher computational complexity than TD(λ), the linear equation associated with TD(λ) is estimated from data and then solved.1 In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques. (See the surveys [13, 10] for other algorithm examples.)\nCompared to the algorithms just mentioned, ETD(λ) is closer to the standard TD(λ) algorithm and addresses the issue in TD(λ) more directly. It introduces a novel weighting scheme to re-weight the states when forming the eligibility traces in TD(λ), so that the weights reflect the occupation frequencies of the target policy rather than the behavior policy. An important result of this weighting scheme is that under natural conditions on the function approximation architecture, the average dynamics of ETD(λ) can be described by an affine function involving a negative definite matrix [46, 52],2 which provides a desired stability property, similar to the case of convergent on-policy TD algorithms.\nThe almost sure convergence of ETD(λ), under general off-policy training conditions, has been shown in our recent work [52] for diminishing stepsize. That result, however, requires the stepsize to diminish at the rate of O(1/t), with t being the time index of the iterate sequence. This range of stepsize is too narrow for applications. In practice, algorithms tend to make progress too slowly if the stepsize becomes too small, and the environment may be non-stationary, so it is often preferred to use a much larger stepsize or constant stepsize.\n1An efficient algorithm for solving the estimated equations is the one given in [50] based on the line search method. It can also be applied to finding approximate solutions under additional penalty terms suggested by [33].\n2The papers [46, 28] work with the negation of the matrix that we associate with ETD(λ) in this paper. The negative definiteness property we discuss here corresponds to the positive definiteness property discussed in [46, 28]."
    }, {
      "heading" : "4 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "The purpose of this paper is to provide an analysis of ETD(λ) for a broad range of stepsizes. Specifically, we consider constant stepsize and stepsize that can diminish at a rate much slower than O(1/t). We will maintain general off-policy training conditions, without placing restrictions on the behavior policy. However, we will consider constrained versions of ETD(λ), which constrain the iterates to be in a bounded set, and a mode of convergence that is weaker than almost sure convergence. Constraining the ETD(λ) iterates is not only needed in analysis, but also a means to control the variances of the iterates, which is important in practice since off-policy learning algorithms generally have high variances. Almost sure convergence is no longer guaranteed for algorithms using large stepsizes; hence we analyze their behavior with respect to a weaker convergence mode.\nWe study a simple, basic version of constrained ETD(λ) and several variations of it, some of which are biased but can mitigate the variance issue better. To give an overview of our results, we shall refer to the first algorithm as the unbiased algorithm, and its biased variations as the biased variants. Two groups of results will be given to characterize the asymptotic behavior of the trajectory of iterates produced by these algorithms. The first group of results are derived by combining key properties of ETD(λ) with powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19]. The results show (roughly speaking) that:\n(i) In the case of diminishing stepsize, under mild conditions, the trajectory of iterates produced by the unbiased algorithm eventually spends nearly all its time in an arbitrarily small neighborhood of the desired solution, with an arbitrarily high probability (Theorem 3.1); and the trajectory produced by the biased algorithms has a similar behavior, when the algorithmic parameters are set to make the biases sufficiently small (Theorem 3.3). These results entail the convergence in mean to the desired solution for the unbiased algorithm (Cor. 3.1), and the convergence in probability to some vicinity of the desired solution for the biased variants.\n(ii) In the case of constant stepsize, imagine that we run the algorithms for all stepsizes; then conclusions similar to those in (i) hold in the limit as the stepsize parameter approaches zero (Theorems 3.2, 3.4). In particular, a smaller stepsize parameter results in an increasingly longer segment of the trajectory to spend, with an increasing probability, nearly all its time in some neighborhood of the desired solution. The size of the neighborhood can be made arbitrarily small as the stepsize parameter approaches zero and, in the case of the biased variants, also as their biases are reduced.\nThe next group of results are for the constant-stepsize case and complement the results in (ii) by focusing on the asymptotic behavior of the algorithms for a fixed stepsize. Among others, they show (roughly speaking) that:\n(iii) For any given stepsize parameter, asymptotically, the expected maximal deviation of multiple consecutive averaged iterates from the desired solution can be bounded in terms of the masses that the invariant probability measures of certain associated Markov chains assign to a small neighborhood of the desired solution. Those probability masses approach one when the stepsize parameter approaches zero and, in the case of the biased variants, also when their biases are sufficiently small (Theorems 3.5, 3.6).\n(iv) For a perturbed version of the unbiased algorithm and its biased variants, the maximal deviation of averaged iterates from the desired solution, under a given stepsize parameter, can be bounded almost surely in terms of those probability masses mentioned in (iii), for each initial condition (Theorems 3.7, 3.8).\nTo derive the first group of results, we use powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19]. This theory builds on the ordinary differential equation (ODE) based proof method, treats the trajectory of iterates as a whole, and studies its asymptotic behavior through the continuous-time processes corresponding to left-shifted and interpolated iterates. The probability distributions of these continuous-time interpolated processes are analyzed (as probability measures on a function space) by the weak convergence methods, leading to a characterization of their limiting distributions, from which asymptotic properties of the\n5 trajectory of iterates can be obtained. Most of our efforts in the first part of our analysis are to prove that the constrained ETD(λ) algorithms satisfy the conditions required by the general convergence theorems just mentioned. We prove this by using key properties of ETD(λ) iterates, most importantly, the ergodicity and uniform integrability properties of the trace iterates, and the convergence of certain averaged processes which, intuitively speaking, describe the averaged dynamics of ETD(λ). Some of these properties were established earlier in our work [52] when analyzing the almost sure convergence of ETD(λ). Building upon that work, we prove the remaining properties needed in the analysis.\nTo derive the second group of results, we exploit the fact that in the case of constant stepsize, the iterates together with other random variables involved in the algorithms form weak Feller Markov chains, and such Markov chains have nice ergodicity properties. We use ergodic theorems for weak Feller Markov chains [29, 30], together with the properties of ETD(λ) iterates and the convergence results we get from the weak convergence methods, in this second part of our analysis.\nBesides ETD(λ), the analysis we give in the paper also applies to off-policy TD(λ), when the divergence issue mentioned earlier is avoided by setting λ sufficiently close to 1. The reason is that in that case the off-policy TD(λ) iterates have the same properties as the ones used in our analysis of ETD(λ) and therefore, the same conclusions hold for constrained versions of off-policy TD(λ), regarding their asymptotic convergence properties for constant or slowly diminishing stepsize (these results are new, to our knowledge). Similarly, our analysis also applies directly to the ETD(λ, β) algorithm, a variation of ETD(λ) recently proposed by Hallak et al. [15].\nRegarding practical performance of the algorithms, the biased ETD variant algorithms are much more robust than the unbiased algorithm despite the latter’s superior asymptotic convergence properties. (This is not a surprise, for the biased algorithms are in fact defined by using a well-known robustifying approach from stochastic approximation theory [19].) Their behavior is demonstrated by experiments in [28, 53]. In particular, [53] is our companion note for this paper and includes several simulation results to illustrate some of the theorems we give here regarding the behavior of multiple consecutive iterates of the biased algorithms.\nThe paper is organized as follows. In Section 2 we provide the background for the ETD(λ) algorithm. In Section 3 we present our convergence results on constrained ETD(λ) and several variants of it, and we give the proofs in Section 4. We conclude the paper in Section 5 with a brief discussion on direct applications of our convergence results to the off-policy TD(λ) algorithm and the ETD(λ, β) algorithm, as well as to ETD(λ) under relaxed conditions, followed by a discussion on several open issues. In Appendix A we include the key properties of the ETD(λ) trace iterates that are used in the analysis."
    }, {
      "heading" : "2 Preliminaries",
      "text" : "In this section we describe the policy evaluation problem in the off-policy case, the ETD(λ) algorithm and its constrained version, and we also review the results from our prior work [52] that are needed in this paper."
    }, {
      "heading" : "2.1 Off-policy Policy Evaluation",
      "text" : "Let S = {1, . . . , N} be a finite set of states, and let A be a finite set of actions. Without loss of generality we assume that for all states, every action in A can be applied. If a ∈ A is applied at state s ∈ S, the system moves to state s′ with probability p(s′ | s, a) and yields a random reward with mean r(s, a, s′) and bounded variance, according to a probability distribution q(· | s, a, s′). These are the parameters of the MDP model we consider; they are unknown to the learning algorithms to be introduced.\nA stationary policy is a time-invariant decision rule that specifies the probability of taking an action at each state. When actions are taken according to such a policy, the states and actions"
    }, {
      "heading" : "6 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "(St, At) at times t ≥ 0 form a (time-homogeneous) Markov chain on the space S × A, with the marginal state process {St} being also a Markov chain.\nLet π and πo be two given stationary policies, with π(a | s) and πo(a | s) denoting the probability of taking action a at state s under π and πo, respectively. While the system evolves under the policy πo, generating a stream of state transitions and rewards, we wish to use these observations to evaluate the performance of the policy π, with respect to a discounted reward criterion, the definition of which will be given shortly. Here π is the target policy and πo the behavior policy. It is allowed that πo 6= π (the off-policy case), provided that at each state, all actions taken by π can also be taken by πo (cf. Assumption 2.1(ii) below).\nLet γ(s) ∈ [0, 1], s ∈ S, be state-dependent discount factors, with γ(s) < 1 for at least one state. We measure the performance of π in terms of the expected discounted total rewards attained under π as follows: for each state s ∈ S,\nvπ(s) := E π\n[\nR0 + ∞ ∑\nt=1\nγ(S1) γ(S2) · · · γ(St) ·Rt ∣ ∣ ∣ S0 = s\n]\n, (2.1)\nwhere Rt is the random reward received at time t, and E π denotes expectation with respect to the probability distribution of the states, actions and rewards, (St, At, Rt), t ≥ 0, generated under the policy π. The function vπ on S is called the value function of π. The special case of γ being a constant less than 1 corresponds to the γ-discounted reward criterion: vπ(s) = E π [ ∑∞ t=0 γ tRt | S0 = s]. In the general case, by letting γ depend on the state, the formulation is able to also cover certain undiscounted total reward MDPs with termination;3 however, for vπ to be well-defined (i.e., to have the right-hand side of (2.1) well-defined for each state), a condition on the target policy is needed, which is stated below and will be assumed throughout the paper.\nLet Pπ denote the transition matrix of the Markov chain on S induced by π. Let Γ denote the N ×N diagonal matrix with diagonal entries γ(s), s ∈ S.\nAssumption 2.1 (conditions on the target and behavior policies).\n(i) The target policy π is such that (I − PπΓ)−1 exists. (ii) The behavior policy πo induces an irreducible Markov chain on S, and moreover, for all (s, a) ∈\nS ×A, πo(a | s) > 0 if π(a | s) > 0.\nUnder Assumption 2.1(i), the value function vπ in (2.1) is well-defined, and furthermore, vπ satisfies uniquely the Bellman equation4\nvπ = rπ + PπΓ vπ, i.e., vπ = (I − PπΓ)−1rπ,\nwhere rπ is the expected one-stage reward function under π (i.e., rπ(s) = E π[R0 | S0 = s] for s ∈ S)."
    }, {
      "heading" : "2.2 The ETD(λ) Algorithm",
      "text" : "Like the standard TD(λ) algorithm [41, 48], the ETD(λ) algorithm [46] approximates the value function vπ by a function of the form v(s) = φ(s)\n⊤θ, s ∈ S, using a parameter vector θ ∈ Rn and n-dimensional feature representations φ(s) for the states. (Here φ(s) is a column vector and ⊤ stands for transpose.) In matrix notation, denote by Φ the N × n matrix with φ(s)⊤, s ∈ S, as its rows.\n3We may view vπ(s) as the expected (undiscounted) total rewards attained under π starting from the state s and up to a random termination time τ ≥ 1 that depends on the states in a Markovian way. In particular, if at time t ≥ 1, the state is s and termination has not occurred yet, the probability of τ = t (terminating at time t) is 1− γ(s). Then vπ(s) can be equivalently written as vπ(s) = Eπ [ ∑τ−1 t=0 Rt | S0 = s ]\n. 4One can verify this Bellman equation directly. It also follows from the standard MDP theory, as by definition vπ here can be related to a value function in a discounted MDP where the discount factors depend on state transitions, similar to discounted semi-Markov decision processes (see e.g., [37]).\n7 Then the columns of Φ span the subspace of approximate value functions, and the approximation problem is to find in that subspace a function v = Φθ ≈ vπ.\nWe focus on a general form of the ETD(λ) algorithm, which uses state-dependent λ values specified by a function λ : S → [0, 1]. Inputs to the algorithm are the states, actions and rewards, {(St, At, Rt)}, generated under the behavior policy πo, where Rt is the random reward received upon the transition from state St to St+1 with action At. The algorithm can access the following functions, in addition to the features φ(s):\n(i) the state-dependent discount factor γ(s) that defines vπ , as described earlier;\n(ii) λ : S → [0, 1], which determines the single or multi-step Bellman equation for the algorithm (cf. the subsequent Eqs. (2.6)-(2.7) and Footnote 6);\n(iii) ρ : S ×A → R+ given by ρ(s, a) = π(a | s)/πo(a | s) (with 0/0 = 0), which gives the likelihood ratios for action probabilities that can be used to compensate for sampling states and actions according to the behavior policy πo instead of the target policy π; (iv) i : S → R+, which gives the algorithm additional flexibility to weigh states according to the degree of “interest” indicated by i(s). The algorithm also uses a sequence αt > 0, t ≥ 0, as stepsize parameters. We shall consider only deterministic {αt}.\nTo simplify notation, let\nρt = ρ(St, At), γt = γ(St), λt = λ(St).\nETD(λ) calculates recursively θt ∈ Rn, t ≥ 0, according to\nθt+1 = θt + αt et · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt ) , (2.2)\nwhere et ∈ Rn, called the “eligibility trace,” is calculated together with two nonnegative scalar iterates (Ft,Mt) according to 5\nFt = γt ρt−1 Ft−1 + i(St), (2.3) Mt = λt i(St) + (1− λt)Ft, (2.4) et = λt γt ρt−1 et−1 +Mt φ(St). (2.5)\nFor t = 0, (e0, F0, θ0) are given as an initial condition of the algorithm. We recognize that the iteration (2.2) has the same form as TD(λ), but the trace et is calculated differently, involving an “emphasis” weight Mt on the state St, which itself evolves along with the iterate Ft, called the “follow-on” trace. If Mt is always set to 1 regardless of Ft and i(·), then the iteration (2.2) reduces to the off-policy TD(λ) algorithm in the case where γ and λ are constants."
    }, {
      "heading" : "2.3 Associated Bellman Equations and Approximation and Convergence Properties of ETD(λ)",
      "text" : "Let Λ denote the diagonal matrix with diagonal entries λ(s), s ∈ S. Associated with ETD(λ) is a generalized multistep Bellman equation of which vπ is the unique solution [42]: 6\nv = rλπ,γ + P λ π,γ v. (2.6)\n5The definition (2.5) we use here differs slightly from the original definition of et in [46], but the two are equivalent and (2.5) appears to be more convenient for our analysis.\n6For the details of this Bellman equation, we refer the readers to the early work [42, 44] and the recent work [46]. We remark that similar to the standard one-step Bellman equation, which is a recursive relation that expresses vπ in terms of the expected one-stage reward and the expected total future rewards given by vπ itself, one can use the strong Markov property to derive other recursive relations satisfied by vπ, in which the expected one-stage reward is replaced by the expected rewards attained by π up to some random stopping time. This gives rise to a general class of Bellman equations, of which (2.6) is one example. Earlier works on using such equations in TD learning include [42] and [4, Chap. 5.3]. The recent work [49] considers an even broader class of Bellman equations using the concept"
    }, {
      "heading" : "8 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Here Pλπ,γ is an N × N substochastic matrix, rλπ,γ ∈ RN is a vector of expected discounted total rewards attained by π up to some random time depending on the function λ, and they can be expressed in terms of Pπ and rπ as\nPλπ,γ = I − (I − PπΓΛ)−1 (I − PπΓ), rλπ,γ = (I − PπΓΛ)−1 rπ. (2.7)\nETD(λ) aims to solve a projected version of the Bellman equation (2.6) [46], which takes the following forms in the space of approximate value functions and in the space of the θ-parameters, respectively:\nv = Π ( rλπ,γ + P λ π,γ v ) , v ∈ column-space(Φ), ⇐⇒ Cθ + b = 0, θ ∈ Rn. (2.8)\nHere Π is a projection onto the approximation subspace with respect to a weighted Euclidean norm or seminorm, under a condition on the approximation architecture that will be explained shortly. The weights that define this norm also define the diagonal entries M̄ss, s ∈ S, of a diagonal matrix M̄ , which are given by\ndiag(M̄) = d⊤πo,i(I − Pλπ,γ)−1, with dπo,i ∈ RN , dπo,i(s) = dπo(s) · i(s), s ∈ S, (2.9)\nwhere dπo(s) > 0 denotes the steady state probability of state s for the behavior policy π o, under Assumption 2.1(ii). For the corresponding linear equation in the θ-space in (2.8),\nC = −Φ⊤M̄ (I − Pλπ,γ)Φ, b = Φ⊤M̄ rλπ,γ . (2.10)\nFrom the expression (2.9) of the diagonal matrix M̄ , the most important difference between the earlier TD algorithms and ETD(λ) can be seen. For on-policy TD(λ), in stead of (2.9), the diagonal matrix M̄ is determined by the steady state probabilities of the states under the target policy π under an ergodicity assumption [48], and for off-policy TD(λ), it is determined by the steady state probabilities dπo(s) under the behavior policy π\no. Here, due to the emphatic weighting scheme (2.3)-(2.5), the diagonals of M̄ given by (2.9) reflect the occupation frequencies (with respect to Pλπ,γ) of the target policy rather than the behavior policy.\nLet | · | denote the (unweighted) Euclidean norm. The matrix C is said to be negative definite if there exists c > 0 such that θ⊤Cθ ≤ −c|θ|2 for all θ ∈ Rn; and negative semidefinite if in the preceding inequality c = 0. A salient property of ETD(λ) is that the matrix C is always negative semidefinite [46], and under natural and mild conditions, C is negative definite. This is proved in [52] and summarized below.\nCall those states s with M̄ss > 0 emphasized states (define this set of states to be empty if M̄ given by (2.9) is ill-defined, a case we will not encounter).\nAssumption 2.2 (condition on the approximation architecture). The set of feature vectors of emphasized states, {φ(s) | s ∈ S, M̄ss > 0}, contains n linearly independent vectors.\nTheorem 2.1 ([52, Prop. C.2]). Under Assumption 2.1, the matrix C is negative definite if and only if Assumption 2.2 holds.\nAssumption 2.2, which implies the linear independence of the columns of Φ, is satisfied in particular if the set of feature vectors, {φ(s) | s ∈ S, i(s) > 0}, contains n linearly independent vectors,\nof estimating equations from statistics, and the recent work [55] focuses on a special class of generalized Bellman equations and discusses their potential advantages from an approximation viewpoint. But an in-depth study of the application of such equations is still lacking currently. Because generalized Bellman equations offer flexible ways to address the bias vs. variance problem in learning the value functions of a policy, they are especially important and deserve further study, in our opinion.\n9 since states with positive interest i(s) are among the emphasized states.7 So this assumption can be easily satisfied in reinforcement learning without model knowledge.8\nIn view of Theorem 2.1, under Assumptions 2.1-2.2, the equation Cθ+b = 0 has a unique solution θ∗; equivalently, Φθ∗ is the unique solution to the projected Bellman equation (2.7):\nΦθ∗ = Π ( rλπ,γ + P λ π,γ Φθ ∗ ) ,\nwhere Π is a well-defined projection operator that projects a vector in RN onto the approximation subspace with respect to the seminorm on RN given by\n√\n∑\ns∈S M̄ss · v(s)2, ∀ v ∈ RN\n(which is a norm if M̄ss > 0 for all s ∈ S). The relation between the approximate value function v = Φθ∗ and the desired value function vπ, in particular, the approximation error, can be characterized by using the oblique projection viewpoint [40] for projected Bellman equations.9\nThe almost sure convergence of ETD(λ) to θ∗ is proved in [52, Theorem 2.2] under Assumptions 2.1 and 2.2, for diminishing stepsize satisfying αt = O(1/t) and\nαt−αt+1 αt\n= O(1/t). Despite this convergence guarantee, the stepsize range is too narrow for applications, as we discussed in the introduction. In this paper we will focus on constrained ETD(λ) algorithms that restrict the θ-iterates in a bounded set, but can operate with much larger stepsizes and also suffer less from the issue of high variance in off-policy learning. We will analyze their behavior under Assumptions 2.1 and 2.2, although our analysis extends to the case without Assumption 2.2 (see the discussion in Section 5.1)."
    }, {
      "heading" : "2.4 Constrained ETD(λ), Averaged Processes and Mean ODE",
      "text" : "We consider first a constrained version of ETD(λ) that simply scales the θ-iterates, if necessary, to keep them bounded:\nθt+1 = ΠB\n(\nθt + αt et · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt )\n)\n, (2.11)\nwhere ΠB is the Euclidean projection onto a closed ball B ⊂ Rn at the origin with radius rB : B = {θ ∈ Rn | |θ| ≤ rB}. Under Assumptions 2.1 and 2.2, when the radius rB is sufficiently large (greater than the threshold given in Lemma 2.1 below), from any given initial (e0, F0, θ0), the algorithm (2.11) converges almost surely to θ∗, for diminishing stepsize αt = O(1/t) [52, Theorem 4.1].\nOur interest in this paper is to apply (2.11) with a much larger range of stepsize, in particular, constant stepsize or stepsize that diminishes much more slowly than O(1/t). In Sections 3 and 4, we\n7This follows from the definition (2.9) of the diagonals M̄ss. Since (I −Pλπ,γ) −1 = I + ∑∞ k=1(P λ π,γ) k ≥ I, we have\ndiag(M̄ ) = d⊤πo,i(I − P λ π,γ) −1 ≥ d⊤πo,i. Hence i(s) > 0 implies M̄ss ≥ dπo (s) · i(s) > 0. 8There is another way to verify Assumption 2.2 without calculating M̄ . Suppose ETD(λ) starts from a state S0 with i(S0) > 0. Then it can be shown that if St = s and Mt > 0, we must have M̄ss > 0. This means that as soon as we find among states St with emphasis weights Mt > 0 n states that have linearly independent feature vectors, we can be sure that Assumption 2.2 is satisfied.\n9Briefly speaking, [40] showed that the solutions of projected Bellman equations are oblique projections of vπ on the approximation subspace. An oblique projection is defined by two nonorthogonal subspaces of equal dimensions and is the projection onto the first subspace orthogonally to the second [39]. In the special case of ETD(λ), the first of these two subspaces is the approximation subspace {v ∈ RN | v = Φθ for some θ ∈ Rn}, and the second is the image of the approximation subspace under the linear transformation (I − Pλπ,γ)\n⊤M̄ . Essentially it is the angle between the two subspaces that determines the approximation bias Φθ∗ − Πvπ in the worst case, for a worst-case choice of rλπ,γ . (For details, see also [55, Sec. 2.2].) Recently, for the case of constant λ, i and γ, [15] derived bounds on the approximation bias that are based on contraction arguments and are comparable to the bound for on-policy TD(λ) [48]. These bounds lie above the bounds given by the oblique projection view (cf. [54] and [55, Sec. 2.2]); however, they are expressed in terms of λ and γ, so they give us explicit numbers instead of analytical expressions to bound the approximation bias."
    }, {
      "heading" : "10 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "will analyze the algorithm (2.11) and its two variants for such stepsizes. To prepare for the analysis, in the rest of this section, we review several results from [52] that will be needed.\nFirst, we discuss about the “mean ODE” that we wish to associate with (2.11). It is the projected ODE ẋ = h̄(x) + z, z ∈ −NB(x), (2.12) where the function h̄ is the left-hand side of the equation Cx+ b = 0 we want to solve:\nh̄(x) = Cx+ b; (2.13)\nNB(x) is the normal cone of B at x, i.e.,\nNB(x) = {0} for x in the interior of B, NB(x) = {ax | a ≥ 0} for x on the boundary of B;\nand z is the boundary reflection term that cancels out the component of h̄(x) in NB(x) (i.e., z = −y where y is the projection of h̄(x) on NB(x)), and it is the “minimal force” needed to keep the solution x(·) of (2.12) in B [19, Chap. 4.3].\nThe negative definiteness of the matrix C ensures that when the radius of B is sufficiently large, the boundary reflection term is zero for all x ∈ B and the projected ODE (2.12) has no stationary points other than θ∗ (see [52, Sec. 4.1] for a simple proof):\nLemma 2.1. Let c > 0 be such that x⊤Cx ≤ −c|x|2 for all x ∈ Rn. Suppose B has a radius rB > |b|/c. Then θ∗ lies in the interior of B; a solution x(τ), τ ∈ [0,∞), to the projected ODE (2.12) for an initial condition x(0) ∈ B coincides with the unique solution to ẋ = h̄(x), with the boundary reflection term being z(·) ≡ 0; and the only solution x(τ), τ ∈ (−∞,+∞), of (2.12) in B is x(·) ≡ θ∗.\nInformally speaking, suppose we have proved that (2.12) is the mean ODE for the algorithm (2.11) under stepsizes of our interest. Then applying powerful convergence theorems from the stochastic approximation theory [19], we can assert that the iterates θt will eventually “follow closely” a solution of the mean ODE. This together with the solution property of the mean ODE given in Lemma 2.1 will then give us a characterization of the asymptotic behavior of the algorithm (2.11) for a constraint set B with sufficiently large radius.\nSeveral properties of the ETD(λ) iterates will be important in proving that (2.12) is indeed the mean ODE for (2.11) and reflects its average dynamics. We now discuss two such properties (other key properties will be given in Appendix A). They concern the ergodicity of the Markov chain {(St, At, et, Ft)} on the joint space of states, actions and traces, and the convergence of certain averaged sequences associated with the algorithm (2.11). They will also be useful in analyzing variants of (2.11).\nLet Zt = (St, At, et, Ft), t ≥ 0. It is shown in [52] that under Assumption 2.1, {Zt} is a weak Feller Markov chain10 on the infinite state space S × A × Rn+1 and is ergodic. Specifically, on a metric space, a sequence of probability measures {µt} is said to converge weakly to a probability measure µ if for any bounded continuous function f , ∫ fdµt → ∫\nfdµ as t → ∞ [12, Chap. 9.3]. We are interested in the weak convergence of the occupation probability measures of the process {Zt}, where for each initial condition Z0 = z, the occupation probability measures µz,t, t ≥ 0, are defined by µz,t(D) = 1 t+1 ∑t k=0 1(Zk ∈ D) for any Borel subset D of S × A× Rn+1, with 1(·) denoting the indicator function.\nTheorem 2.2 (ergodicity of {Zt}; [52, Theorem 3.2]). Under Assumption 2.1, the Markov chain {Zt} has a unique invariant probability measure ζ, and for each initial condition Z0 = z, the sequence {µz,t} of occupation probability measures converges weakly to ζ, almost surely.\n10See Section 4.3.1 or the book [30, Chap. 6] for the definition and properties of weak Feller Markov chains.\n11\nLet Eζ denote expectation with respect to the stationary process {Zt} with ζ as its initial distribution. By the definition of weak convergence, the weak convergence of {µz,t} given in Theorem 2.2 implies that for each given initial condition of Z0, the averages 1 t ∑t−1 k=0 f(Zk) converge almost surely to Eζ{f(Z0)} for any bounded continuous function f .11 To study the average dynamics of the algorithm (2.11), however, we need to also consider unbounded functions. In particular, the function related to both (2.11) and the unconstrained ETD(λ) is h : Rn × Ξ → Rn,\nh(θ, ξ) = e · ρ(s, a) ( r(s, a, s′) + γ(s′)φ(s′)⊤θ − φ(s)⊤θ ) , (2.14)\nwhere\nξ = (e, F, s, a, s′) ∈ Ξ := Rn+1 × S ×A× S.\nWriting ξt for the traces and transition at time t: ξt = (et, Ft, St, At, St+1), we can express the recursion (2.11) equivalently as\nθt+1 = ΠB ( θt + αt h(θt, ξt) + αt et · ω̃t+1 ) , (2.15)\nwhere ω̃t+1 = ρt (Rt − r(St, At, St+1)) is the noise part of the observed reward. The convergence to h̄(θ) of the averaged sequence 1t ∑t−1 k=0 h(θ, ξk), with θ held fixed and t going to infinity, will be needed to prove that (2.12) is the mean ODE of (2.11). Since h̄(θ) = Cθ+ b, this convergence for each fixed θ can be identified with the convergence of the matrix and vector iterates calculated by ELSTD(λ) (the least-squares version of ETD(λ)) to approximate the left-hand side of the equation Cθ + b = 0. It was proved in [52] as a special case of the convergence of averaged sequences for a larger set of functions including h(θ, ·). Since this general result will be needed in analyzing variants of (2.11), we give its formulation here.\nThroughout the rest of the paper, we let ‖ · ‖ denote the infinity norm of a Euclidean space, and we use this notation for both vectors and matrices (viewed as vectors). For Rm-valued random variables Xt, we say {Xt} converges to a random variable X in mean if E[‖Xt−X‖] → 0 as t → ∞.\nConsider a vector-valued function g : Ξ → Rm such that with ξ = (e, F, s, a, s′), g(ξ) is Lipschitz continuous in (e, F ) uniformly in (s, a, s′). That is, there exists a finite constant Lg such that for any (e, F ), (ê, F̂ ) ∈ Rn+1, ∥\n∥g(e, F, s, a, s′)− g(ê, F̂ , s, a, s′) ∥ ∥ ≤ Lg ∥ ∥(e, F )− (ê, F̂ ) ∥ ∥, ∀ (s, a, s′) ∈ S × A× S. (2.16)\nFor each θ ∈ Rn, the function h(θ, ·) in (2.14) is a special case of g. The convergence of the averaged sequence 1t ∑t−1 k=0 g(ξk) is given in the theorem below; the part on convergence in mean will be used frequently later in this paper (and was actually also needed in [52] to prove the ergodicity of {Zt} given earlier). The convergence of 1t ∑t−1 k=0 h(θ, ξk) then follows as a special case.\nTheorem 2.3 (convergence of averaged sequences; [52, Theorems 3.1-3.3]). Let g be a vector-valued function satisfying the Lipschitz condition (2.16). Then under Assumption 2.1, Eζ [ ‖g(ξ0)‖ ]\n< ∞ and for any given initial (e0, F0) ∈ Rn+1, as t → ∞, 1t ∑t−1 k=0 g(ξk) converges to ḡ = Eζ [ g(ξ0) ]\nin mean and almost surely.\nCorollary 2.1 ([52, Theorem 2.1]). Under Assumption 2.1, for the functions h̄, h given in (2.13), (2.14) respectively, the following hold: For each θ ∈ Rn, Eζ [ ‖h(θ, ξ0)‖ ] < ∞ and h̄(θ) = Eζ [ h(θ, ξ0) ] ; and for any given initial (e0, F0) ∈ Rn+1, as t → ∞, 1t ∑t−1\nk=0 h(θ, ξk) converges to h̄(θ) in mean and almost surely.\n11With the usual discrete topology for the finite space S ×A and the usual topology for the Euclidean space Rn+1, the space S ×A× Rn+1 equipped with the product topology is metrizable. A continuous function f(s, a, e, F ) on this space is a function that is continuous in (e, F ) for each (s, a) ∈ S ×A."
    }, {
      "heading" : "12 Weak Convergence Properties of Constrained ETD Learning",
      "text" : ""
    }, {
      "heading" : "3 Convergence Results for Constrained ETD(λ)",
      "text" : "In this section we present the convergence properties of the constrained ETD(λ) algorithm (2.11) and several variants of it, for constant stepsize and for stepsize that diminishes slowly. We will explain briefly how the results are obtained, leaving the detailed analyses to Section 4. The first set of results about the algorithm (2.11) will be given first in Section 3.1, followed by similar results in Section 3.2 for two variant algorithms that have biases but can mitigate the variance issue in off-policy learning better. These results are obtained through applying two general convergence theorems from [19], which concern weak convergence of stochastic approximation algorithms for diminishing and constant stepsize. Finally, the constant-stepsize case will be analyzed further in Section 3.3, in order to refine some results of Sections 3.1-3.2 so that the asymptotic behavior of the algorithms for a fixed stepsize can be characterized explicitly. In that subsection, besides the three algorithms just mentioned, we will also discuss another variant algorithm with perturbation.\nRegarding notation, recall that 1(·) is the indicator function, |·| stands for the usual (unweighted) Euclidean norm and ‖ · ‖ the infinity norm for Rm. We denote by Nδ(D) the δ-neighborhood of a set D ⊂ Rm: Nδ(D) = {x ∈ Rm | infy∈D |x − y| ≤ δ}, and we write Nδ(θ∗) for the δ-neighborhood of θ∗. For the iteration index t, the notation t ∈ [k1, k2] or t ∈ [k1, k2) will be used to mean that the range of t is the set of integers in the interval [k1, k2] or [k1, k2). More definitions and notation will be introduced later where they are needed."
    }, {
      "heading" : "3.1 Main Results",
      "text" : "We consider first the algorithm (2.11) for diminishing stepsize. Let the stepsize change slowly in the following sense.\nAssumption 3.1 (condition on diminishing stepsize). The (deterministic) nonnegative sequence {αt} satisfies that ∑ t≥0 αt = ∞, αt → 0 as t → ∞, and for some sequence of integers mt → ∞,\nlim t→∞ sup 0≤j≤mt\n∣ ∣ ∣ ∣ αt+j αt − 1 ∣ ∣ ∣ ∣ = 0. (3.1)\nThe condition (3.1) is the condition A.8.2.8 in [19, Chap. 8] and allows stepsizes much larger than O(1/t). We can have αt = O(t\n−β), β ∈ (0, 1], and even larger stepsizes are possible. For example, partition the time interval [0,∞) into increasingly longer intervals Ik, k ≥ 0, and set αt to be constant within each interval Ik. Then the condition (3.1) can be fulfilled by letting the constants for each Ik decrease as O(k\n−β), β ∈ (0, 1]. We now state the convergence result. For any T > 0, let m(k, T ) = min{t ≥ k | ∑t+1j=k αj > T }. If we draw a continuous timeline and put each iteration of the algorithm at a specific moment, with the stepsize αj being the length of time between iterations j and j + 1, then m(k, T ) is the latest iteration before time T has elapsed since the k-th iteration. If αt = O(t\n−β), β ∈ (0, 1], for example, then for fixed T , there are O(kβ) iterates between the k-th and m(k, T )-th iteration.\nTheorem 3.1 (convergence properties of constrained ETD with diminishing stepsize). Suppose Assumptions 2.1, 2.2 hold and the radius of B exceeds the threshold given in Lemma 2.1. Let {θt} be generated by the algorithm (2.11) with stepsize {αt} satisfying Assumption 3.1, from any given initial condition (e0, F0). Then there exists a sequence Tk → ∞ such that for any δ > 0,\nlim sup k→∞\nP ( θt 6∈ Nδ(θ∗), some t ∈ [ k, m(k, Tk) ] ) = 0.\nThis theorem implies θt → θ∗ in probability. Since {θt} is bounded, by [12, Theorem 10.3.6], θt must also converge to θ∗ in mean:\n13\nCorollary 3.1 (convergence in mean). In the setting of Theorem 3.1, E [ ‖θt − θ∗‖ ] → 0 as t → ∞.\nAnother important note is that the conclusion of Theorem 3.1 is much stronger than that θt → θ∗ in probability. Here as k → ∞, we consider an increasingly longer segment [k,m(k, Tk)] of iterates, and are able to conclude that the probability of that entire segment being inside an arbitrarily small neighborhood of θ∗ approaches 1. (This is the power of the weak convergence methods [17, 18, 19], by which our conclusion is obtained.)\nIn the case of constant stepsize, we consider all the trajectories that can be produced by the algorithm (2.11) using some constant stepsize, and we ask what the properties of these trajectories are in the limit as the stepsize parameter approaches 0. Here there is a common timeline used in relating trajectories generated with different stepsizes (and it comes from the ODE-based analysis): we imagine again a continuous timeline, along which we put the iterations at moments that are evenly separated in time by α, if the stepsize parameter is α. The scalars T, Tα in the theorem below represent amounts of time with respect to this continuous timeline.\nTheorem 3.2 (convergence properties of constrained ETD with constant stepsize). Suppose Assumptions 2.1, 2.2 hold and the radius of B exceeds the threshold given in Lemma 2.1. For each α > 0, let {θαt } be generated by the algorithm (2.11) with constant stepsize α, from any given initial condition (e0, F0). Let {kα | α > 0} be any sequence of nonnegative integers that are nondecreasing as α → 0. Then the following hold: (i) For any δ > 0,\nlim T→∞ lim α→0\n1\nT/α\nkα+⌊T/α⌋ ∑\nt=kα\n1 ( θαt ∈ Nδ(θ∗) ) = 1 in probability.\n(ii) Let αkα → ∞ as α → 0. Then there exists a sequence {Tα | α > 0} with Tα → ∞ as α → 0, such that for any δ > 0,\nlim sup α→0\nP (\nθαt 6∈ Nδ(θ∗), some t ∈ [ kα, kα + Tα/α ]\n)\n= 0.\nPart (ii) above is similar to Theorem 3.1. Here as α → 0, an increasingly longer segment [kα, kα+Tα/α] of the tail of the trajectory {θαt } is considered, and it is concluded that the probability of that entire segment being inside an arbitrarily small neighborhood of θ∗ approaches 1. Part (i) above, roughly speaking, says that as α diminishes, within the segment [kα, kα + T/α], the fraction of iterates θαt that lie in a small δ-neighborhood of θ ∗ approaches 1 for sufficiently large T .\nWe give the proofs of Theorems 3.1-3.2 in Section 4.1. As mentioned earlier, most of our efforts will be to use the properties of ETD iterates to show that the conditions of two general convergence theorems from stochastic approximation theory [19, Theorems 8.2.2, 8.2.3] are satisfied by the algorithm (2.11). After that we can specialize the conclusions of those theorems to obtain Theorems 3.1-3.2. Specifically, after furnishing their conditions, applying [19, Theorems 8.2.2, 8.2.3] will give us directly the desired conclusions in Theorems 3.1-3.2 with Nδ(LB) in place of Nδ(θ\n∗), where Nδ(LB) is the δ-neighborhood of the limit set LB for the projected ODE (2.12). This limit set is defined as follows:\nLB := ∩τ̄>0 ∪x(0)∈B{x(τ), τ ≥ τ̄}\nwhere x(τ) is a solution of the projected ODE (2.12) with initial condition x(0), the union is over all the solutions with initial x(0) ∈ B, and D for a set D denotes taking the closure of D. It can be shown that LB = {θ∗} under our assumptions, so Theorems 3.1-3.2 will then follow as special cases of [19, Theorems 8.2.2, 8.2.3]."
    }, {
      "heading" : "14 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Remark 3.1 (on weak convergence methods). The theorems from [19] which we will apply are based on the weak convergence methods. While it is beyond the scope of this paper to explain these powerful methods, let us mention here a few basic facts about them to elucidate the origin of the convergence theorems we gave above. In the framework of [19], one studies a trajectory of iterates produced by an algorithm by working with continuous-time processes that are piecewise constant or linear interpolations of the iterates. (Often one also left-shifts a trajectory of iterates to bring the “asymptotic part” of the trajectory closer to the origin of the continuous time axis.) In the case of our problem, for example, for diminishing stepsize, these continuous-time processes are xk(τ), τ ∈ [0,∞), indexed by k ≥ 0, where for each k, xk is a piecewise constant interpolation of θk+t, t ≥ 0, given by xk(τ) = θk for τ ∈ [0, αk) and xk(τ) = θk+t for τ ∈ [ ∑t−1 m=0 αk+m, ∑t m=0 αk+m), t ≥ 1. Similarly, for constant stepsize, the continuous-time processes involved are xα(τ), τ ∈ [0,∞), indexed by α > 0, and for each α, xα is a piecewise constant interpolation of θαkα+t, t ≥ 0, given by xα(τ) = θkα+t for τ ∈ [tα, (t+1)α). The behavior of the sequence {xk} or {xα} as k → ∞ or α → 0, tells us the asymptotic properties of the algorithm as the number of iterations grows to infinity or as the stepsize parameter approaches 0. With the weak convergence methods, one considers the probability distributions of the continuous-time processes in such sequences, and analyze the convergence of these probability distributions and their limiting distributions along any subsequences. Here each continuous-time process takes values in a space of vector-valued functions on [0,∞) or (−∞,∞) that are rightcontinuous and have left-hand limits, and this function space equipped with an appropriate metric, known as the Skorohod metric, is a complete separable metric space [19, p. 238-240]. On this space, one analyzes the weak convergence of the probability distributions of the continuous-time processes. Under certain conditions on the algorithm, the general conclusions from [19, Theorems 8.2.2, 8.2.3] are that any subsequence of these probability distributions contains a further subsequence which is convergent, and that all the limiting probability distributions must assign the full measure 1 to the set of solutions of the mean ODE associated with the algorithm. This general weak convergence property then yields various conclusions about the asymptotic behavior of the algorithm and its relation with the mean ODE solutions. When further combined with the solution properties of the mean ODE, it leads to specific results such as the theorems we give in this section."
    }, {
      "heading" : "3.2 Two Variants of Constrained ETD(λ) with Biases",
      "text" : "We now consider two simple variants of (2.11). They constrain the ETD iterates even more, at a price of introducing biases in this process, so that unlike (2.11), they can no longer get to θ∗ arbitrarily closely. Instead they aim at a small neighborhood of θ∗, the size of which depends on how they modify the ETD iterates. On the other hand, because the trace iterates {(et, Ft)} can have unbounded variances and are also naturally unbounded in common off-policy situations (see discussions in [51, Prop. 3.1 and Footnote 3, p. 3320-3322] and [52, Remark A.1, p. 23]), these variant algorithms have the advantage that they make the θ-iterates more robust against the drastic changes that can occur to the trace iterates. Indeed our definition of the variant algorithms below follows a well-known approach to “robustifying” algorithms in stochastic approximation theory (see discussions in [19, p. 23 and p. 141]).\nThe two variant algorithms are defined as follows. For each K > 0, let ψK : R n → Rn be a\nbounded Lipschitz continuous function such that\n‖ψK(x)‖ ≤ ‖x‖ ∀x ∈ Rn, and ψK(x) = x if ‖x‖ ≤ K. (3.2)\n(For instance, let ψK(x) = r̄x/|x| if |x| ≥ r̄ and ψK(x) = x otherwise, for r̄ = √ nK; or let ψK(x) be the result of truncating each component of x to be within [−K,K].) For the first variant of the algorithm (2.11), we replace et in (2.11) by ψK(et):\nθt+1 = ΠB\n(\nθt + αt ψK(et) · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt )\n)\n. (3.3)\n15\nFor the second variant, we apply ψK to bound the entire increment in (2.11) before it is multiplied by the stepsize αt and added to θt:\nθt+1 = ΠB (θt + αt ψK(Yt)) , where Yt = et · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt ) . (3.4)\nAs will be proved later, these two algorithms are associated with mean ODEs of the form,\nẋ = h̄K(x) + z, z ∈ −NB(x), (3.5)\nwhere h̄K : R n → Rn is determined by each algorithm and deviates from the function h̄(x) = Cx+ b due to the alterations introduced by ψK . This ODE is similar to the projected ODE (2.12), except that since h̄K is an approximation of h̄, θ\n∗ is no longer a stable or stationary point for the mean ODE (3.5). The two variant algorithms thus have a bias in their θ-iterates, and the bias can be made smaller by choosing a larger K. This is reflected in the two convergence theorems given below. They are similar to the previous two theorems for the algorithm (2.11), except that now given a desired small neighborhood of θ∗, a sufficiently large K needs to be used in order for the θ-iterates to reach that neighborhood of θ∗ and exhibit properties similar to those shown in the previous case.\nTheorem 3.3 (convergence properties of constrained ETD variants with diminishing stepsize). In the setting of Theorem 3.1, let {θt} be generated instead by the algorithm (3.3) or (3.4), with a bounded Lipschitz continuous function ψK satisfying (3.2), and with stepsize {αt} satisfying Assumption 3.1. Then for each δ > 0, there exists Kδ > 0 such that if K ≥ Kδ, then it holds for some sequence Tk → ∞ that\nlim sup k→∞\nP ( θt 6∈ Nδ(θ∗), some t ∈ [ k, m(k, Tk) ] ) = 0.\nTheorem 3.4 (convergence properties of constrained ETD variants with constant stepsize). In the setting of Theorem 3.2, let {θαt } be generated instead by the algorithm (3.3) or (3.4), with a bounded Lipschitz continuous function ψK satisfying (3.2) and with constant stepsize α > 0. Let {kα | α > 0} be any sequence of nonnegative integers that are nondecreasing as α → 0. Then for each δ > 0, there exists Kδ > 0 such that the following hold if K ≥ Kδ: (i)\nlim T→∞ lim α→0\n1\nT/α\nkα+⌊T/α⌋ ∑\nt=kα\n1 ( θαt ∈ Nδ(θ∗) ) = 1 in probability.\n(ii) Let αkα → ∞ as α → 0. Then there exists a sequence {Tα | α > 0} with Tα → ∞ as α → 0, such that\nlim sup α→0\nP (\nθαt 6∈ Nδ(θ∗), some t ∈ [ kα, kα + Tα/α ]\n)\n= 0.\nWe give the proofs of the above two theorems in Section 4.2. The arguments are largely the same as those that we will use first in Section 4.1 to prove Theorems 3.1-3.2 for the algorithm (2.11). Indeed, for all the three algorithms, the main proof step is the same, which is to apply the general conclusions of [19, Theorems 8.2.2, 8.2.3] to establish the connection between the iterates of an algorithm and the solutions of an associated mean ODE, and this step does not concern what the solutions of the ODE are actually. (For the two variant algorithms, verifying that the conditions of [19, Theorems 8.2.2, 8.2.3] are met is, in fact, easier than for the algorithm (2.11), because various functions involved in the analysis become bounded due to the use of the bounded function ψK .) For the two variant algorithms, the result of this step is that the same conclusions given in Theorems 3.1- 3.2 hold with Nδ(LB) in place of Nδ(θ\n∗), where LB is the limit set of the projected mean ODE (3.5) associated with each variant algorithm. To attain Theorems 3.3-3.4, we then combine this with the fact that by choosing K sufficiently large, one can make the limit set LB ⊂ Nδ(θ∗) for an arbitrarily small δ."
    }, {
      "heading" : "16 Weak Convergence Properties of Constrained ETD Learning",
      "text" : ""
    }, {
      "heading" : "3.3 More about the Constant-stepsize Case",
      "text" : "For the constant-stepsize case, the results given in Theorems 3.2 and 3.4 bear similarities to their counterparts for the diminishing stepsize case given in Theorems 3.1 and 3.3. However, they characterize the behavior of the iterates in the limit as the stepsize parameter approaches 0, and deal with only a finite segment of the iterates for each stepsize (although in their part (ii) both the segment’s length Tα/α → ∞ and its starting position kα → ∞ as α → 0). So unlike in the diminishing stepsize case, these results do not tell us explicitly about the behavior of θαt for a fixed stepsize α as we take t to infinity.\nThe purpose of the present subsection is to analyze further the case of a fixed stepsize just mentioned. We observe that for a fixed stepsize α, the iterates θαt together with Zt = (St, At, et, Ft) form a weak Feller Markov chain {(Zt, θαt )} (see Lemma 4.3). Thus we can apply several ergodic theorems for weak Feller Markov chains (Meyn [29], Meyn and Tweedie [30]) to analyze the constant-stepsize case and combine the implications from these theorems with the results we obtained previously using stochastic approximation theory.\nWe now present our results using this approach. Let Mα denote the set of invariant probability measures of the Markov chain {(Zt, θαt )}. This set depends on the particular algorithm used to generate the θ-iterates, but we shall use the notation Mα for all the algorithms we discuss here, for notational simplicity. We know that {Zt} has a unique invariant probability measure (Theorem 2.2), but it need not be so for the Markov chain {(Zt, θαt )} when {θαt } is generated by the algorithm (2.11) or its two variants. The set Mα can therefore have multiple elements (it is nonempty; see Prop. 4.8). We denote by M̄α the set that consists of the marginal of µ on B (the space of the θ’s), for all the invariant probability measures µ ∈ Mα.\nAs in the previous analysis, we are interested in the behavior of multiple consecutive θ-iterates. In order to characterize that, we consider for each m ≥ 1, the Markov chain\n{(\n(Zt, θ α t ), (Zt+1, θ α t+1), . . . , (Zt+m−1, θ α t+m−1)\n)}\nt≥0\n(i.e., each state now consists of m consecutive states of the chain {(Zt, θαt )}). We shall refer to this chain as the m-step version of {(Zt, θαt )}. Similar to Mα, denote by Mmα the set of invariant probability measures of the m-step version of {(Zt, θαt )}, and correspondingly define M̄mα to be the set of marginals of µ on Bm for all µ ∈ Mmα . The set Mmα is, of course, determined by Mα, since each invariant probability measure in Mmα is just the m-dimensional distribution of a stationary Markov chain {(Zt, θαt )}.\nOur first result, given in Theorem 3.5 below, says that for the algorithm (2.11), as the stepsize α approaches zero, the invariant probability measures in Mmα will concentrate their masses on an arbitrarily small neighborhood of (θ∗, . . . , θ∗) (m copies of θ∗). Moreover, for a fixed stepsize, as the number of iterations grows to infinity, the expected maximal deviation of the m consecutive averaged iterates from θ∗ can be bounded in terms of the masses those invariant probability measures assign to the vicinities of (θ∗, . . . , θ∗). Here by averaged iterates, we mean\nθ̄αt = 1\nt\nt−1 ∑\nk=0\nθαk , ∀ t ≥ 1, (3.6)\nand we shall refer to {θ̄αt } as the averaged sequence corresponding to {θαt }. This iterative averaging is also known as “Polyak-averaging” when it is applied to accelerate the convergence of the θ-iterates (see [34], [19, Chap. 10], and the references therein). This is not the role of the averaging operation here, however. The purpose here is to bring to bear the ergodic theorems for weak Feller Markov chains, in particular, the weak convergence of certain averaged probability measures or occupation probability measures to the invariant probability measures of the m-step version of {(Zt, θαt )}. (For the details see Section 4.3, where the proofs of the results of this subsection will be given.) It can also be seen that for a sequence {βt} with βt ∈ [0, 1), βt → 0 as t → ∞, if we drop a fraction βt of\n17\nthe terms in (3.6) when averaging the θ’s at each time t, the resulting differences in the averaged iterates θ̄αt are asymptotically negligible. Therefore, although our results below will be stated for (3.6), they apply to a variety of averaging schemes.\nRecall that Nδ(θ ∗) denotes the closed δ-neighborhood of θ∗. In what follows, N ′δ(θ ∗) denotes the open δ-neighborhood of θ∗, i.e., the open ball around θ∗ with radius δ. We write [Nδ(θ\n∗)]m or [N ′δ(θ ∗)]m for the Cartesian product of m copies of Nδ(θ ∗) or N ′δ(θ\n∗). Recall also that rB is the radius of the constraint set B.\nTheorem 3.5. In the setting of Theorem 3.2, let {θαt } be generated by the algorithm (2.11) with constant stepsize α > 0, and let {θ̄αt } be the corresponding averaged sequence. Then the following hold for any δ > 0 and m ≥ 1: (i) lim infα→0 infµ∈M̄mα µ ( [Nδ(θ ∗)]m ) = 1, and more strongly, with mα = ⌈mα ⌉,\nlim inf α→0 inf µ∈M̄mαα\nµ ( [Nδ(θ ∗)]mα ) = 1.\n(ii) For each stepsize α and any initial condition of (e0, F0, θ α 0 ),\nlim sup k→∞ E\n[\nsup k≤t<k+m\n∣ ∣θ̄αt − θ∗ ∣ ∣\n]\n≤ δ κα,m + 2rB (1 − κα,m),\nwhere κα,m = infµ∈M̄mα µ([N ′ δ(θ ∗)]m).\nNote that in part (ii) above, κα,m → 1 as α → 0 by part (i). Note also that for m = 1, the conclusions from the preceding theorem take the simplest form:\nlim inf α→0 inf µ∈M̄α\nµ ( Nδ(θ ∗) ) = 1,\nlim sup t→∞\nE [ ∣ ∣θ̄αt − θ∗ ∣ ∣ ] ≤ δ κα + 2rB (1− κα), for κα = inf µ∈M̄α µ ( N ′δ(θ ∗) ) .\nThe conclusions for m > 1 are, however, much stronger. They also suggest that in practice, instead of simply choosing the last iterate of the algorithm as its final output at the end of its run, one can base that choice on the behavior of multiple consecutive θ̄αt during the run.\nFor the two variant algorithms (3.3) and (3.4), we have a similar result given in Theorem 3.6 below. Here the neighborhood of (θ∗, . . . , θ∗) around which the masses of the invariant probability measures are concentrated, depends not only on the stepsize α but also on the biases of these algorithms. The proofs of Theorems 3.5-3.6 are given in Section 4.3.2.\nTheorem 3.6. In the setting of Theorem 3.2, let {θαt } be generated instead by the algorithm (3.3) or (3.4), with constant stepsize α > 0 and with a bounded Lipschitz continuous function ψK satisfying (3.2). Let {θ̄αt } be the corresponding averaged sequence. Then the following hold: (i) For any given δ > 0, there exists Kδ > 0 such that for all K ≥ Kδ,\nlim inf α→0 inf µ∈M̄mα\nµ ( [Nδ(θ ∗)]m ) = 1, ∀m ≥ 1,\nand more strongly, with mα = ⌈mα ⌉, lim inf α→0 inf µ∈M̄mαα µ ( [Nδ(θ ∗)]mα ) = 1, ∀m ≥ 1.\n(ii) Regardless of the choice of K, given any δ > 0,m ≥ 1 and stepsize α, for each initial condition of (e0, F0, θ α 0 ),\nlim sup k→∞ E\n[\nsup k≤t<k+m\n∣ ∣θ̄αt − θ∗ ∣ ∣\n]\n≤ δ κα,m + 2rB (1 − κα,m),\nwhere κα,m = infµ∈M̄mα µ([N ′ δ(θ ∗)]m)."
    }, {
      "heading" : "18 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Finally, we consider a simple modification of the preceding algorithms, for which the conclusions of Theorems 3.5(ii) and 3.6(ii) can be strengthened. This is our motivation for introducing the modification, but we shall postpone the discussion till Remark 3.2 at the end of this subsection.\nFor any of the algorithms (2.11), (3.3) or (3.4), if the original recursion under a constant stepsize α can be written as\nθαt+1 = ΠB ( θαt + αY α t ) ,\nwe now modify this recursion formula by adding a perturbation term α∆αθ,t as follows. Let\nθαt+1 = ΠB ( θαt + αY α t + α∆ α θ,t ) , (3.7)\nwhere for each α > 0, ∆αθ,t, t ≥ 0, are Rn-valued random variables such that12 (i) they are independent of each other and also independent of the process {Zt}; (ii) they are identically distributed with zero mean and finite variance, where the variance can be\nbounded uniformly for all α; and\n(iii) they have a positive continuous density function with respect to the Lebesgue measure.\nBelow we refer to (3.7) as the perturbed version of the algorithm (2.11), (3.3) or (3.4).\nTheorem 3.7. In the setting of Theorem 3.2, let {θαt } be generated instead by the perturbed version (3.7) of the algorithm (2.11) for a constant stepsize α > 0, and let {θ̄αt } be the corresponding averaged sequence. Then the conclusions of Theorems 3.2 and 3.5 hold. Furthermore, let the stepsize α be given. Then the Markov chain {(Zt, θαt )} has a unique invariant probability measure µα, and for any δ > 0, m ≥ 1, and initial condition of (e0, F0, θα0 ), almost surely,\nlim inf t→∞\n1\nt\nt−1 ∑\nk=0\n1\n(\nsup k≤j<k+m\n∣ ∣θαj − θ∗ ∣\n∣ < δ )\n≥ µ̄(m)α ( [N ′δ(θ ∗)]m )\nand lim sup t→∞ ∣ ∣θ̄αt − θ∗ ∣ ∣ ≤ δ κα + 2rB (1 − κα), with κα = µ̄α ( N ′δ(θ ∗) ) ,\nwhere µ̄ (m) α is the unique element in M̄mα , and µ̄α is the marginal of µα on B.\nTheorem 3.8. In the setting of Theorem 3.2, let {θαt } be generated instead by the perturbed version (3.7) of the algorithm (3.3) or (3.4), with a constant stepsize α > 0 and with a bounded Lipschitz continuous function ψK satisfying (3.2). Let {θ̄αt } be the corresponding averaged sequence. Then the conclusions of Theorems 3.4 and 3.6 hold. Furthermore, for any given stepsize α, the conclusions of the second part of Theorem 3.7 also hold.\nNote that in the second part of Theorem 3.7, both µ̄ (m) α ( [N ′δ(θ ∗)]m ) and κα approach 1 as α → 0, since by the first part of the theorem, the conclusions of Theorem 3.5 hold. For the second part of Theorem 3.8, the same is true provided that K is sufficiently large (so that Nδ(LB) ⊂ Nδ(θ∗) where LB is the limit set of the ODE associated with the algorithm), and this can be seen from the conclusions of Theorem 3.6(i), which holds for the perturbed version (3.7) of the two variant algorithms, as the first part of Theorem 3.8 says. The proofs of Theorems 3.7-3.8 are given in Section 4.3.3.\nRemark 3.2 (on the role of perturbation). At first sight it may seem counter-productive to add noise to the θ-iterates in the algorithm (3.7). Our motivation for such random perturbations of the θ-iterates is that this can ensure that the Markov chain {(Zt, θαt )} has a unique invariant probability measure (see Prop. 4.11). The uniqueness allows us to invoke a result of Meyn [29] on the convergence\n12We adopt these conditions for simplicity. They are not the weakest possible for our purpose, and our proof techniques can be applied to other types of perturbations as well. See the discussions in Remark 3.2, Remark 4.1, and before Prop. 4.10 in Section 4.3.3.\n19\nof the occupation probability measures of a weak Feller Markov chain, so that we can bound the deviation of the averaged iterates from θ∗ not only in an expected sense as before, but also for almost all sample paths under each initial condition, as in the second part of Theorems 3.7-3.8. For the unperturbed algorithms, we can only prove such pathwise bounds on lim supt→∞ |θ̄αt − θ∗| for a subset of the initial conditions of (Z0, θ α 0 ). A more detailed discussion of this is given in Remark 4.1, at the end of Section 4.3.3, after the proofs of the preceding theorems. Regarding other effects of the perturbation, intuitively, larger noise terms may help the Markov chain “mix” faster, but they can also result in less probability mass µ̄α ( N ′δ(θ ∗) )\naround θ∗ than in the case without perturbation. What is a suitable amount of noise to add to achieve a desired balance? We do not yet have an answer. It seems reasonable to us to let the magnitude of the variance of the perturbation terms ∆αθ,t be approximately α\n2ǫ for some ǫ ∈ (0, 1], so that a typical perturbation α∆αθ,t is at a smaller scale relative to the “signal part” αY α t in an iteration. Further investigation is needed."
    }, {
      "heading" : "4 Proofs for Section 3",
      "text" : "We now prove the theorems given in the preceding section."
    }, {
      "heading" : "4.1 Proofs for Theorems 3.1 and 3.2",
      "text" : "In this subsection we prove Theorems 3.1 and 3.2 on convergence properties of the constrained ETD(λ) algorithm (2.11). We will apply two theorems from [19], Theorems 8.2.2 and 8.2.3, which concern weak convergence of stochastic approximation algorithms for constant and diminishing stepsize, respectively. This requires us to show that the conditions of those theorems are satisfied by our algorithm. The major conditions concern the uniform integrability, tightness, and convergence in mean of certain sequences of random variables involved in the algorithm. Our proofs will rely on many properties of the ETD iterates that we have established in [52] when analyzing the almost sure convergence of the algorithm."
    }, {
      "heading" : "4.1.1 Conditions to Verify",
      "text" : "We need some definitions and notation, before describing the conditions required. For some index set K, let {Xk}k∈K be a set of random variables taking values in a metric space X (in our context X will be Rm or Ξ). The set {Xk}k∈K is said to be tight or bounded in probability, if there exists for each δ > 0 a compact set Dδ ⊂ X such that\ninf k∈K\nP(Xk ∈ Dδ) ≥ 1− δ.\nFor Rm-valued Xk, the set {Xk}k∈K is said to be uniformly integrable (u.i.) if\nlim a→∞ sup k∈K\nE [ ‖Xk‖ 1 ( ‖Xk‖ ≥ a )] = 0.\nTo analyze the constrained ETD(λ) algorithm (2.11), which is given by\nθt+1 = ΠB(θt + αtYt), where Yt := et · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt ) ,\nlet Et denote expectation conditioned on Ft, the sigma-algebra generated by θm, ξm,m ≤ t, where we recall ξm = (em, Fm, Sm, Am, Sm+1) and its space R\nn+1 ×S ×A×S is denoted by Ξ. By writing Yt = Et[Yt] + (Yt − Et[Yt]), we have the equivalent form of (2.11) given in (2.15):\nθt+1 = ΠB(θt + αt h(θt, ξt) + αt et · ω̃t+1) ."
    }, {
      "heading" : "20 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "In other words, h(θt, ξt) = Et[Yt] and et ·ω̃t+1 = Yt−Et[Yt], a noise term that satisfies Et[et ·ω̃t+1] = 0. This algorithm belongs to the class of stochastic approximation algorithms with “exogenous noises” studied in the book [19]—the term “exogenous noises” reflects the fact that the evolution of {ξt} is not driven by the θ-iterates. Theorems 3.1 and 3.2 will follow as special cases from Theorems 8.2.3 and 8.2.2 of [19, Chap. 8], respectively, if we can show that the algorithm (2.11) satisfies the following conditions. Conditions for the case of diminishing stepsize:\n(i) The sequence {Yt} = {h(θt, ξt) + et · ω̃t+1} is u.i. (This corresponds to the condition A.8.2.1 of [19].)\n(ii) The function h(θ, ξ) is continuous in θ uniformly in ξ ∈ D, for each compact set D ⊂ Ξ. (This corresponds to the condition A.8.2.3 of [19].)\n(iii) The sequence {ξt} is tight. (This corresponds to the condition A.8.2.4 of [19].) (iv) The sequence {h(θt, ξt)} is u.i., and so is {h(θ, ξt)} for each fixed θ ∈ B. (This corresponds to\nthe condition A.8.2.5 of [19].)\n(v) There is a continuous function h̄(·) such that for each θ ∈ B and each compact set D ⊂ Ξ,\nlim k→∞,t→∞\n1\nk\nt+k−1 ∑\nm=t\nEt\n[ h(θ, ξm)− h̄(θ) ] 1 ( ξt ∈ D ) = 0 in mean,\nwhere k and t are taken to ∞ in any way possible. In other words, if we denote the average on the left-hand side by Xk,t, then the requirement “limk→∞,t→∞ Xk,t = 0 in mean” means that along any subsequences kj → ∞, tj → ∞, we must have limj→∞ E[‖Xkj,tj‖] = 0. (This condition corresponds to the condition A.8.2.7 of [19].)\nFor the case of constant stepsize, we consider the iterates that could be generated by the algorithm for all stepsizes. To distinguish between the iterates associated with different stepsizes, in the conditions below, the superscript α is attached to the variables involved in the algorithm with stepsize α, and similarly, the conditional expectation Et is denoted by E α t instead.\nConditions for the case of constant stepsize: In addition to the condition (ii) above (which corresponds to the condition A.8.1.6 of [19] for the case of constant stepsize), the following conditions are required.\n(i′) The set {Y αt | t ≥ 0, α > 0} := {h(θαt , ξαt ) + eαt · ω̃αt+1 | t ≥ 0, α > 0} is u.i. (This corresponds to the condition A.8.1.1 of [19].) (iii′) The set {ξαt | t ≥ 0, α > 0} is tight. (This corresponds to the condition A.8.1.7 of [19].) (iv′) The set {h(θαt , ξαt ) | t ≥ 0, α > 0} is u.i., in addition to the uniform integrability of {h(θ, ξαt ) |\nt ≥ 0, α > 0} for each θ ∈ B. (This corresponds to the condition A.8.1.8 of [19].) (v′) There is a continuous function h̄(·) such that for each θ ∈ B and each compact set D ⊂ Ξ,\nlim k→∞,t→∞,α→0\n1\nk\nt+k−1 ∑\nm=t\nE α t\n[ h(θ, ξαm)− h̄(θ) ] 1 ( ξαt ∈ D ) = 0 in mean,\nwhere α is taken to 0 and k, t are taken to ∞ in any way possible. (This condition corresponds to the condition A.8.1.9 of [19], and it is in fact stronger than the latter condition but is satisfied by our algorithms as we will show.)\nThe preceding conditions allow ξαt and θ α t to be generated under different initial conditions for different α. While we will need this generality later in Section 4.3, here we will focus on a common initial condition for all stepsizes, for simplicity. Then, the preceding conditions for the constantstepsize case are essentially the same as those for the diminishing stepsize case, because except for the θ-iterates, all the other variables (such as ξt and ω̃t) involved in the algorithm have identical probability distributions for all stepsizes α and are not affected by the θ-iterates. For this reason, in\n21\nthe proofs below, except for the θ-iterates, we simply omit the superscript α for other variables in the case of constant stepsize, and to verify the two sets of conditions above, we shall treat the case of diminishing stepsize and the case of constant stepsize simultaneously.\nAs mentioned in Section 2.4, these conditions are to ensure that the projected ODE (2.12), ẋ = h̄(x) + z, z ∈ −NB(x), is the mean ODE for the algorithm (2.11) and reflects its average dynamics. Among the proofs for these conditions given next, the proof for the convergence in mean condition (v) and (v′) will be the most involved."
    }, {
      "heading" : "4.1.2 Proofs",
      "text" : "The condition (ii) is clearly satisfied. In what follows, we prove that the rest of the conditions are satisfied as well. We start with the tightness conditions (iii) and (iii′), as they are immediately implied by a property of the trace iterates we already know. We then tackle the uniform integrability conditions (i), (i′), (iv) and (iv′), before we address the convergence in mean required in (v) and (v′). The proofs build upon several key properties of the ETD iterates we have established in [52] and recounted in Section 2.4 and Appendix A.\nFirst, we show that the tightness conditions (iii) and (iii′) are satisfied. This is implied by the following property of traces: for any given initial condition (e0, F0), supt≥0 E [ ∥ ∥(et, Ft) ∥ ∥ ]\n< ∞ (see Prop. A.1, Appendix A).\nProposition 4.1. Under Assumption 2.1, for each given initial (e0, F0) ∈ Rn+1, {(et, Ft)} is tight and hence {ξt} is tight.\nProof. By Prop. A.1, c := supt≥0 E [∥ ∥(et, Ft) ∥ ∥ ] < ∞. Then, by the Markov inequality, for a > 0, supt≥0 P (∥ ∥(et, Ft) ∥ ∥ ≥ a )\n≤ c/a → 0 as a → ∞. This implies that {(et, Ft)} is tight. Since the space S ×A× S is finite and ξt = (et, Ft, St, At, St+1), {ξt} is also tight.\nWe now handle the uniform integrability conditions (i), (i′), (iv) and (iv′). The uniform integrability of the trace sequence {et}, as we will prove, is important here.\nProposition 4.2. Under Assumption 2.1, for each given initial (e0, F0) ∈ Rn+1, the following sets of random variables are u.i.:\n(i) {et}; (ii) {h(θ, ξt)} for each fixed θ ∈ B; (iii) {h(θt, ξt)} in the case of diminishing stepsize; and {h(θαt , ξt) | t ≥ 0, α > 0} in the case of\nconstant stepsize;\n(iv) {h(θt, ξt)+ et ω̃t+1} in the case of diminishing stepsize; and {h(θαt , ξt)+ et ω̃t+1 | t ≥ 0, α > 0} in the case of constant stepsize.\nThe proof of this proposition will use facts about u.i. sequences of random variables given in the lemma below.\nLemma 4.1. Let Xk, Yk, k ∈ K (some index set) be real-valued random variables with Xk and Yk defined on a common probability space for each k.\n(i) If {Xk}k∈K, {Yk}k∈K are u.i., then {Xk + Yk}k∈K is u.i. (ii) If {Xk}k∈K is u.i. and for all k, |Yk| ≤ |Xk| a.s., then {Yk}k∈K is u.i. (iii) If {Xk}k∈K, {Yk}k∈K are u.i. and for some c ≥ 0, E[|Yk| | Xk] ≤ c a.s. for all k, then\n{XkYk}k∈K is u.i.\nProof. Part (i) follows immediately from the definition of uniform integrability and the inequality that for any a > 0,\n|Xk + Yk| 1 ( |Xk + Yk| ≥ a ) ≤ 2|Xk| 1 ( |Xk| ≥ a2 ) + 2|Yk| 1 ( |Yk| ≥ a2 ) ."
    }, {
      "heading" : "22 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Under the assumption of (ii), for any a > 0, we have |Yk|1 ( |Yk| ≥ a ) ≤ |Xk|1 ( |Xk| ≥ a )\na.s., and (ii) is then evident.\nUnder the assumption of (iii), for any a > ā > 0, using the inequality\n|XkYk| 1 ( |XkYk| ≥ a ) ≤ |XkYk| 1 ( |Xk| ≤ ā, |Yk| ≥ aā ) + |XkYk| 1 ( |Xk| ≥ ā ) ,\nwe have\nE [ |XkYk| 1 ( |XkYk| ≥ a )] ≤ E [ |XkYk| 1 ( |Xk| ≤ ā, |Yk| ≥ aā )] + E [ |XkYk| 1 ( |Xk| ≥ ā )]\n≤ ā · E [ |Yk| 1 ( |Yk| ≥ aā )] + E [ |Xk| 1 ( |Xk| ≥ ā ) · E [ |Yk| | Xk ]] ≤ ā · E [ |Yk| 1 ( |Yk| ≥ aā )] + c · E [ |Xk| 1 ( |Xk| ≥ ā )] , (4.1)\nwhere we used the assumption E[|Yk| | Xk] ≤ c a.s. in the last inequality. Since {Xk}k∈K, {Yk}k∈K are assumed to be u.i., we have\nlim a→∞ sup k∈K\nE [ |Yk| 1 ( |Yk| ≥ aā )]\n= 0 for any given ā > 0, lim ā→∞ sup k∈K\nE [ |Xk| 1 ( |Xk| ≥ ā )] = 0.\n(4.2) From (4.1), by taking first a → ∞ and then ā → ∞, and by using (4.2), we then obtain\nlim a→∞ sup k∈K\nE [ |XkYk| 1 ( |XkYk| ≥ a )] = 0,\nand this proves (iii).\nWe now proceed to prove Prop. 4.2. The proof will involve auxiliary variables, which we call truncated traces. They are defined similarly to the trace iterates (et, Ft), but instead of depending on all the past states and actions, they only depend on a certain number of the most recent states and actions. Specifically, for each integer K ≥ 1, we define truncated traces (ẽt,K , F̃t,K) as follows:\n(ẽt,K , F̃t,K) = (et, Ft) for t ≤ K, and for t ≥ K + 1, with the shorthand βt := ρt−1γtλt,\nF̃t,K = t ∑\nk=t−K\ni(Sk) · ( ρkγk+1 · · · ρt−1γt ) , (4.3)\nM̃t,K = λt i(St) + (1− λt)F̃t,K , (4.4)\nẽt,K =\nt ∑\nk=t−K\nM̃k,K · φ(Sk) · ( βk+1 · · ·βt ) . (4.5)\nNote that when t ≥ 2K + 1, the traces (ẽt,K , F̃t,K) no longer depend on the initial (e0, F0); being functions of the states and actions between time t − 2K and t only, they lie in a bounded set determined by K, since the state and action spaces are finite. For t = 0, . . . , 2K, (ẽt,K , F̃t,K) also lie in a bounded set, which is determined by K and the initial (e0, F0). We will use these bounded truncated traces to approximate the original traces {(et, Ft)} in the analysis.\nAn important approximation property, given in Prop. A.3 (Appendix A), is that for each K and any initial (e0, F0) from a given bounded set E,\nsup t≥0 E\n[\n∥ ∥(et, Ft)− (ẽt,K , F̃t,K) ∥ ∥\n]\n≤ LK ,\nwhere LK is a finite constant that depends on K and E and decreases monotonically to 0 as K increases: LK ↓ 0 as K → ∞. We will use this property in the following analysis.\n23\nProof of Prop. 4.2. First, we prove {et} is u.i. We then use this to show the uniform integrability of the other sets required in parts (ii)-(iv).\n(i) To prove {et} is u.i., we shall exploit its relation with the truncated traces, ẽt,K , t ≥ 0 for integers K ≥ 1. Note that since the state and action spaces are finite, the truncated traces {ẽt,K} lie in a bounded set (this set depends on K and the initial (e0, F0)), so there exists a constant aK such that ‖ẽt,K‖ ≤ aK for all t. This fact will greatly simplify the analysis. Let us first fix K and consider a ≥ ak. Denote ā = a− aK ≥ 0. Then\n‖et‖ 1 ( ‖et‖ ≥ a ) ≤ ‖et‖ 1 ( ‖et − ẽt,K‖ ≥ ā )\n≤ ‖et − ẽt,K‖ 1 ( ‖et − ẽt,K‖ ≥ ā ) + ‖ẽt,K‖ 1 ( ‖et − ẽt,K‖ ≥ ā ) ≤ ‖et − ẽt,K‖ 1 ( ‖et − ẽt,K‖ ≥ ā ) + aK 1 ( ‖et − ẽt,K‖ ≥ ā ) . (4.6)\nFor the second term on the right-hand side, we can bound its expectation by\nE [ aK 1 ( ‖et − ẽt,K‖ ≥ ā )] = aKP(‖et − ẽt,K‖ ≥ ā) ≤ aK · LK/ā, ∀ t, (4.7) where in the last inequality LK is a constant that depends on K (and the initial (e0, F0)) and has the property that LK ↓ 0 as K → ∞, and this inequality is derived by combing the Markov inequality P(‖et− ẽt,K‖ ≥ ā) ≤ E[‖et− ẽt,K‖]/ā with Prop. A.3, which bounds supt≥0 E[‖et− ẽt,K‖] by LK . Similarly, for the first term on the right-hand side of (4.6), using Prop. A.3, we can bound its expectation by LK :\nE [ ‖et − ẽt,K‖ 1 ( ‖et − ẽt,K‖ ≥ ā )] ≤ E[‖et − ẽt,K‖] ≤ LK , ∀ t. (4.8) From (4.6)-(4.8) it follows that\nsup t≥0\nE [ ‖et‖ 1 ( ‖et‖ ≥ a )] ≤ LK + aK · LK/(a− aK),\nso for fixed K, by taking a → ∞, we obtain lim a→∞ sup t≥0 E [ ‖et‖ 1 ( ‖et‖ ≥ a )] ≤ LK .\nSince LK ↓ 0 as K → ∞ (Prop. A.3), this implies lima→∞ supt≥0 E [ ‖et‖ 1 ( ‖et‖ ≥ a )]\n= 0, which proves the uniform integrability of {et}. (ii) We now prove for each θ, {h(θ, ξt)} is u.i. Since the state and action spaces are finite and θ is given, using the expression of h(θ, ξt), we can bound it as ‖h(θ, ξt)‖ ≤ L‖et‖ for some constant L. As just proved, {et} is u.i. (equivalently {‖et‖} is u.i.) and thus {L‖et‖} is u.i., so by Lemma 4.1(ii), {h(θ, ξt)} is u.i. (since this is by definition equivalent to {‖h(θ, ξt)‖} being u.i., which is true by Lemma 4.1(ii)).\n(iii) The uniform integrability of {h(θt, ξt)} in the case of diminishing stepsize or {h(θαt , ξt) | t ≥ 0, α > 0} in the case of constant stepsize follows from the same argument given for (ii) above, because θt or θ α t for all t ≥ 0 and α > 0 lie in the bounded set B by the definition of the constrained ETD(λ) algorithm.\n(iv) Consider first the case of diminishing stepsize. We prove that {h(θt, ξt) + et ω̃t+1} is u.i. (recall ω̃t+1 = ρt (Rt − r(St, At, St+1)) is the noise part of the observed reward). Since we already showed that {h(θt, ξt)} is u.i., by Lemma 4.1(i), it is sufficient to prove that {et ω̃t+1} is u.i. Now {et} is u.i. by part (i). Since the random rewards Rt in our model have bounded variances, the noise variables ω̃t+1, t ≥ 0, also have bounded variances. This implies that {ω̃t+1} is u.i. [6, p. 32] and that E[|ω̃t+1| | et] < c for some constant c (independent of t). It then follows from Lemma 4.1(iii) that {et ω̃t+1} is u.i., and hence {h(θt, ξt) + et ω̃t+1} is u.i.\nSimilarly, in the case of constant stepsize, it follows from Lemma 4.1(i) that the set {h(θαt , ξt) + et ω̃t+1 | t ≥ 0, α > 0} is u.i., because {h(θαt , ξt) | t ≥ 0, α > 0} is u.i. by part (iii) proved earlier and {et ω̃t+1} is u.i. as we just proved."
    }, {
      "heading" : "24 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Finally, we handle the conditions (v) and (v′) stated in Section 4.1.1. The two conditions are the same condition in the case here, because they concern each fixed θ, whereas {ξt} is not affected by the stepsize and the θ-iterates. So we can focus just on the condition (v) in presenting the proof, for notational simplicity. For the algorithm (2.11), the continuous function h̄ required in the condition is the function h̄(θ) = Cθ + b associated with the desired mean ODE (2.12). We now prove the required convergence in mean by using the properties of trace iterates and the convergence results given in Theorem 2.3 and Cor. 2.1.\nProposition 4.3. Let Assumption 2.1 hold. For each θ ∈ B and each compact set D ⊂ Ξ,\nlim k→∞,t→∞\n1\nk\nt+k−1 ∑\nm=t\nEt\n[ h(θ, ξm)− h̄(θ) ] 1 ( ξt ∈ D ) = 0 in mean.\nProof. Denote Xk,t = 1 k ∑t+k−1 m=t ( h(θ, ξm) − h̄(θ) ) 1 ( ξt ∈ D ) . Since E [∥ ∥Et{Xk,t} ∥ ∥ ] ≤ E[‖Xk,t‖], to prove limk,t E [∥ ∥Et{Xk,t} ∥ ∥ ]\n= 0 (here and in what follows we simply write “k, t” under a limit symbol for “k → ∞, t → ∞”), it is sufficient to prove limk,t E[‖Xk,t‖] = 0, that is, to prove\nlim k,t\n1\nk\nt+k−1 ∑\nm=t\n( h(θ, ξm)− h̄(θ) ) 1 ( ξt ∈ D ) = 0 in mean. (4.9)\nFurthermore, since\nlim sup k,t\nE [ ‖Xk,t‖ 1 ( ξt ∈ D )] ≤ ∑\n(s,a,s′)∈S×A×S\nlim sup k,t\nE [ ‖Xk,t‖ 1 ( ξt ∈ D, (St, At, St+1) = (s, a, s′) )] ,\nit is sufficient in the proof to consider only those compact sets D of the form D = E × {(s, a, s′)}, for each compact set E ⊂ Rn+1 and each (s, a, s′) ∈ S ×A×S. Henceforth, let us fix a compact set E together with a triplet (s, a, s′) as the set D under consideration, and for this set D, we proceed to prove (4.9).\nTo show (4.9), what we need to show is that for two arbitrary subsequences of integers kj → ∞, tj → ∞,\nlim j→∞\n1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξm)− h̄(θ) ) 1 ( ξtj ∈ D ) = 0 in mean. (4.10)\nTo this end, we first define auxiliary trace variables to decompose each difference term h(θ, ξm)−h̄(θ) into two difference terms as follows:\n(a) Fix a point (ē, F̄ ) ∈ E. (b) For each j ≥ 1, define a sequence of trace pairs, (ejm, F jm), m ≥ tj , by using the same recursion\n(2.3)-(2.5) that defines the traces {(et, Ft)}, based on the same trajectory {(St, At)}, but starting at time m = tj with the initial (e j tj , F j tj ) = (ē, F̄ ).\nDenote ξjm = (e j m, F j m, Sm, Am, Sm+1) for m ≥ tj ; it differs from ξm only in the two trace components. Next, for each m, we write h(θ, ξm) − h̄(θ) = (h(θ, ξjm) − h̄(θ)) + (h(θ, ξm) − h(θ, ξjm)) and correspondingly, we write\n1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξm)− h̄(θ) ) = 1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξjm)− h̄(θ) )\n+ 1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξm)− h(θ, ξjm) ) .\nWe see that for (4.10) to hold, it is sufficient that\nlim j→∞\n1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξjm)− h̄(θ) ) 1 ( ξtj ∈ D ) = 0 in mean, (4.11)\n25\nand\nlim j→∞\n1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξm)− h(θ, ξjm) ) 1 ( ξtj ∈ D ) = 0 in mean. (4.12)\nLet us now prove these two statements.\nProof of (4.11): Since the set D = E × {(s, a, s′)} and 1 ( ξtj ∈ D ) ≤ 1 ( (Stj , Atj , Stj+1) = (s, a, s ′) )\n, we can remove ξtj from consideration and show instead\nlim j→∞\n1\nkj\ntj+kj−1 ∑\nm=tj\n( h(θ, ξjm)− h̄(θ) ) 1 ( (Stj , Atj , Stj+1) = (s, a, s ′) ) = 0 in mean, (4.13)\nwhich will imply (4.11). By definition ξjm,m ≥ tj , are generated from the initial trace pairs (ē, F̄ ) and initial transition (Stj , Atj , Stj+1) at time m = tj . So if (Stj , Atj , Stj+1) = (s, a, s\n′), then conditioned on this transition at tj , the sequence {ξjm,m ≥ tj} has the same probability distribution as a sequence ξ̂m,m ≥ 0, where ξ̂m = (êm, F̂m, Ŝm, Âm, Ŝm+1) is generated from the initial condition ξ̂0 = (ē, F̄ , s, a, s\n′) by the same recursion (2.3)-(2.5) and a trajectory {(Ŝm, Âm)} of states and actions under the behavior policy. This shows that\nE\n\n\n∥ ∥ ∥ ∥ ∥ ∥ 1 kj tj+kj−1 ∑\nm=tj\n( h(θ, ξjm)− h̄(θ) ) 1 ( (Stj , Atj , Stj+1) = (s, a, s ′) )\n∥ ∥ ∥ ∥ ∥ ∥   ≤ E   ∥ ∥ ∥ ∥ ∥ ∥ 1 kj kj−1 ∑\nm=0\n( h(θ, ξ̂m)− h̄(θ) )\n∥ ∥ ∥ ∥ ∥ ∥   ,\nfrom which we see that the convergence in mean stated by (4.13) holds if we have\nlim k→∞\n1\nk\nk−1 ∑\nm=0\n( h(θ, ξ̂m)− h̄(θ) ) = 0 in mean. (4.14)\nNow since for each θ, the function h(θ, ·) is Lipschitz continuous in e uniformly in the other arguments, (4.14) holds by Theorem 2.3 and its implication Cor. 2.1. Consequently, (4.13) holds, and this implies (4.11).\nProof of (4.12): Using the expression of h and the finiteness of the state and action spaces, we can bound the difference h(θ, ξm)− h(θ, ξjm) by\n∥ ∥h(θ, ξm)− h(θ, ξjm) ∥ ∥ ≤ c · ∥ ∥em − ejm ∥ ∥\nfor some constant c (independent of m, j). Let us show\nlim j→∞\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ejm ∥ ∥ 1 ( ξtj ∈ D ) = 0 in mean, (4.15)\nwhich will imply (4.12). To prove (4.15), similarly to the preceding proof, we first decompose each difference term em−ejm in (4.15) into several difference terms, by using truncated traces {(ẽm,K , F̃m,K)} and {(ẽjm,K , F̃ jm,K) | m ≥ tj}, j ≥ 1,K ≥ 1, which we now introduce. Specifically, for each K ≥ 1, {(ẽm,K , F̃m,K)} are defined by (4.3)-(4.5). For each j ≥ 1 and K ≥ 1, the truncated traces {(ẽjm,K , F̃ jm,K) | m ≥ tj} are also defined by (4.3)-(4.5), except that the initial time is set to be tj (instead of 0) and for m ≤ tj +K, (ẽjm,K , F̃ jm,K) is set to be (ejm, F jm) (instead of (em, Fm)). Let us fix K for now. We bound the difference em − ejm by the sum of three difference terms as\n∥ ∥em − ejm ∥ ∥ ≤ ∥ ∥em − ẽm,K ∥ ∥+ ∥ ∥ejm − ẽjm,K ∥ ∥+ ∥ ∥ẽm,K − ẽjm,K ∥ ∥, (4.16)"
    }, {
      "heading" : "26 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "and correspondingly, we consider the following three sequences of variables, as j tends to ∞:\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ẽm,K ∥ ∥ 1 ( ξtj ∈ D )\n, 1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ejm − ẽjm,K ∥ ∥, (4.17)\nand\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ẽm,K − ẽjm,K ∥ ∥ 1 ( ξtj ∈ D ) . (4.18)\nIn what follows, we will bound their expected values as j → ∞ and then take K → ∞; this will lead to (4.15).\nThe analyses for the two sequences in (4.17) are similar. Recall D = E × {(s, a, s′)}, so ξtj ∈ D implies (etj , Ftj ) ∈ E. Since the set E is bounded, if (etj , Ftj ) ∈ E, then we can use Prop. A.3 to bound the expectation of ‖em − ẽm,K‖ for m ≥ tj conditioned on Ftj , and this gives us the bound\nsup m≥tj Etj\n[ ∥ ∥em − ẽm,K ∥ ∥ ] 1 ( ξtj ∈ D ) ≤ LK\nwhere LK is a constant that depends on K and the set E, and has the property that LK ↓ 0 as K → ∞. From this bound, we obtain\nE\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ẽm,K ∥ ∥ 1 ( ξtj ∈ D )\n\n ≤ LK , ∀ j ≥ 1. (4.19)\nSimilarly, for the second sequence in (4.17), by Prop. A.3 we have\nE\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ejm − ẽjm,K ∥ ∥\n\n ≤ LK , ∀ j ≥ 1, (4.20)\nwhere LK is some constant that can be chosen to be the same constant in (4.19) (because the point (ē, F̄ ), which is the initial trace pair for (ejm, F j m) at time m = tj , lies in E).\nConsider now the sequence in (4.18). As discussed after the definition (4.3)-(4.5) of truncated traces, because of truncation, these traces lie in a bounded set determined by K and the set in which the initial trace pair lies. Therefore, there exists a finite constant cK which depends on K and E, such that for all m ≥ tj ,\n‖ẽjm,K‖ ≤ cK , and ‖ẽm,K‖ ≤ cK if (etj , Ftj ) ∈ E.\nAlso by their definition, once m is sufficiently large, the truncated traces do not depend on the initial trace pairs; in particular,\nẽjm,K = ẽm,K , ∀m ≥ tj + 2K + 1.\nFrom these two arguments it follows that\nE\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ẽm,K − ẽjm,K ∥ ∥ 1 ( ξtj ∈ D )\n  ≤ (2K + 1) · 2cK kj → 0 as j → ∞. (4.21)\n27\nFinally, combining (4.19)-(4.21) with (4.16), we obtain\nlim sup j→∞ E\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ejm ∥ ∥ 1 ( ξtj ∈ D )\n\n ≤ lim sup j→∞ E\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ẽm,K ∥ ∥ 1 ( ξtj ∈ D )\n\n\n+ lim sup j→∞ E\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ejm − ẽjm,K ∥ ∥\n\n\n+ lim j→∞ E\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥ẽm,K − ẽjm,K ∥ ∥ 1 ( ξtj ∈ D )\n\n\n≤ 2LK . Since LK ↓ 0 as K → ∞ (Prop. A.3), by taking K → ∞, we obtain\nlim j→∞ E\n\n\n1\nkj\ntj+kj−1 ∑\nm=tj\n∥ ∥em − ejm ∥ ∥ 1 ( ξtj ∈ D )\n\n = 0.\nThis proves (4.15), which implies (4.12).\nWith Props. 4.1-4.3, we have furnished all the conditions required in order to apply [19, Theorems 8.2.2, 8.2.3] to the constrained ETD algorithm (2.11), so we can now specialize the conclusions of these two theorems to our problem. In particular, they tell us that the projected ODE (2.12) is the mean ODE for (2.11), and furthermore, by [19, Theorem 8.2.3] (respectively, [19, Theorem 8.2.2]), the conclusions of Theorem 3.1 (respectively, Theorem 3.2) hold with Nδ(LB) in place of Nδ(θ\n∗), where Nδ(LB) is the δ-neighborhood of the limit set LB for the projected ODE (2.12). Recall that this limit set is given by LB = ∩τ̄>0 ∪x(0)∈B{x(τ), τ ≥ τ̄} where x(τ) is a solution of the projected ODE (2.12) with initial condition x(0), the union is over all the solutions with initial x(0) ∈ B, and D for a set D denotes taking the closure of D.\nNow when the matrix C is negative definite (as implied by Assumptions 2.1, 2.2) and when the radius of B exceeds the threshold given in Lemma 2.1, by the latter lemma, the solutions x(τ), τ ∈ [0,∞), of the ODE (2.12) coincide with the solutions of ẋ = h̄(x) = Cx + b for all initial x(0) ∈ B. Then from the negative definiteness of C (Theorem 2.1), it follows that as τ → ∞, x(τ) → θ∗ uniformly in the initial condition, and consequently, LB = {θ∗}.13 ThusNδ(LB) = Nδ(θ∗) and we obtain Theorems 3.1 and 3.2."
    }, {
      "heading" : "4.2 Proofs for Theorems 3.3 and 3.4",
      "text" : "In this subsection we prove Theorems 3.3-3.4 for the two variants of the constrained ETD(λ) algorithm given in (3.3) and (3.4). Like in the previous subsection, we will apply [19, Theorems 8.2.2, 8.2.3] and show, separately for each variant algorithm, that the required conditions are met. Using the properties of the mean ODEs of the variant algorithms, we will then specialize the conclusions of those theorems to obtain the desired results.\n13The details for this statement are as follows. Since h̄ is bounded on B and the boundary reflection term z(·) ≡ 0 under our assumptions (Lemma 2.1), a solution x(·) of (2.12) is Lipschitz continuous on [0,∞). We calculate V̇ (τ) for the Lyapunov function V (τ) = |x(τ) − θ∗|2. By the negative definiteness of the matrix C, for some c > 0, x⊤Cx ≤ −c|x|2 for all x ∈ Rn. Then, since h̄(x) = Cx + b = C(x − θ∗), we have V̇ (τ) = 2 〈 x(τ) − θ∗ , h̄(x(τ)) 〉 ≤ −2c ∣ ∣x(τ) − θ∗ ∣ ∣ 2 , and hence for any δ > 0, there exists ǫ > 0 such that V̇ (τ) ≤ −ǫ if V (τ) = |x(τ)− θ∗|2 ≥ δ2. This together with the continuity of the solution x(·) implies that for any x(0) ∈ B, within time τ̄ = r2B/ǫ, the trajectory x(τ) must reach Nδ(θ\n∗) and stay in that set thereafter. By the definition of the limit set and the arbitrariness of δ, this implies LB = {θ ∗}."
    }, {
      "heading" : "28 Weak Convergence Properties of Constrained ETD Learning",
      "text" : ""
    }, {
      "heading" : "4.2.1 Proofs for the First Variant",
      "text" : "Consider the first variant algorithm (3.3):\nθt+1 = ΠB\n(\nθt + αt ψK(et) · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt )\n)\n.\nWe define a function hK : R n × Ξ → Rn by\nhK(θ, ξ) = ψK(e) · ρ(s, a) ( r(s, a, s′) + γ(s′)φ(s′)⊤θ − φ(s)⊤θ ) , for ξ = (e, F, s, a, s′), (4.22)\nand write (3.3) equivalently as\nθt+1 = ΠB\n( θt + αt hK(θt, ξt) + αt ψK(et) · ω̃t+1 )\nwith ω̃t+1 = ρt(Rt − r(St, At, St+1)) as before. Note that Et [ψK(e) ω̃t+1] = 0, and the algorithm is similar to the algorithm (2.11) (equivalently, (2.15)), except that we have hK and ψK(et) in place of h and et, respectively.\nWe note two properties of the function hK . They follow from direct calculations and will be useful in our analysis shortly:\n(a) Using the Lipschitz continuity of the function ψK (cf. (3.2)), we have that for each θ ∈ Rn, there exists a finite c > 0 such that with ξ = (e, F, s, a, s′) and ξ′ = (e′, F ′, s, a, s′),\n‖hK(θ, ξ) − hK(θ, ξ′)‖ ≤ c ‖e− e′‖, ∀ (s, a, s′) ∈ S ×A× S. (4.23)\nThus hK(θ, ·) is Lipschitz continuous in (e, F ) uniformly in (s, a, s′). (b) Since the set B is bounded, we can bound the difference hK(θ, ξ) − h(θ, ξ) for all θ in B as\nfollows. For some finite constant c > 0,\n‖hK(θ, ξ)− h(θ, ξ)‖ ≤ c ‖ψK(e)− e‖ ≤ 2c ‖e‖ · 1(‖e‖ ≥ K), ∀ θ ∈ B, (4.24)\nwhere the last inequality follows from the property (3.2) of ψK :\n‖ψK(x)‖ ≤ ‖x‖ ∀x ∈ Rn, and ψK(x) = x if ‖x‖ ≤ K.\nWe now apply [19, Theorems 8.2.2, 8.2.3] to obtain the desired conclusions in Theorems 3.3-3.4 for the algorithm (3.3). This requires us to show that the conditions (i)-(v) and (i′)-(v′) given in Section 4.1.1 are still satisfied when we replace et by ψK(et) and h by hK . The uniform integrability conditions (i), (i′), (iv) and (iv′) require the following sets to be u.i.: {hK(θt, ξt) + ψK(et) · ω̃t+1} and {hK(θαt , ξt) + ψK(et) · ω̃t+1 | t ≥ 0, α > 0}, {hK(θt, ξt)} and {hK(θαt , ξt) | t ≥ 0, α > 0}, and {hK(θ, ξt)} for each θ. These conditions are evidently satisfied, in view of the boundedness of the functions ψK and hK(θ, ·) for each θ, the boundedness of the θ-iterates due to constraints, and the finite variances of {ω̃t}. The condition (ii) on the continuity of hK(·, ξ) uniformly in ξ ∈ D, for each compact set D ⊂ Ξ, is also clearly satisfied, whereas the condition (iii) (equivalently (iii′)) on the tightness of {ξt} was already verified earlier in Prop. 4.1.\nWhat remains is the condition (v) (which is equivalent to (v′), for the same reason as discussed immediately before Prop. 4.3). It requires the existence of a continuous function h̄K : R\nn → Rn such that for each θ ∈ B and each compact set D ⊂ Ξ,\nlim k→∞,t→∞\n1\nk\nt+k−1 ∑\nm=t\nEt\n[ hK(θ, ξm)− h̄K(θ) ] 1 ( ξt ∈ D ) = 0 in mean. (4.25)\nIf this condition is satisfied as well, then the mean ODE for the algorithm (3.3) is given by\nẋ = h̄K(x) + z, z ∈ −NB(x). (4.26)\n29\nTo furnish the condition (v), we first identify the function h̄K(θ) to be Eζ [hK(θ, ξ0)], the expectation of hK(θ, ξ0) under the stationary distribution of the process {Zt} with the invariant probability measure ζ as its initial distribution. We relate the functions h̄K ,K > 0, to h̄ in the proposition below, and we will use it to characterize the bias of the algorithm (3.3) later.\nProposition 4.4. Let Assumption 2.1 hold. Consider the setting of the algorithm (3.3), and for each θ ∈ Rn, let h̄K(θ) = Eζ [hK(θ, ξ0)]. Then the function h̄K is Lipschitz continuous on Rn, and\nsup θ∈B\n‖h̄K(θ)− h̄(θ)‖ → 0 as K → ∞. (4.27)\nProof. For each θ, the function hK(θ, ·) is by definition bounded. Under Assumption 2.1, the Markov chain {(St, At, et, Ft)} has a unique invariant probability measure ζ (Theorem 2.2). Therefore, h̄K(θ) is well-defined and finite. Let c1 = supe∈Rn ‖ψK(e)‖ < ∞ (since ψK is bounded). For any θ, θ′, using the definition of hK , a direct calculation shows that for some c2 > 0, ‖hK(θ, ξ)− hK(θ′, ξ)‖ ≤ c1c2‖θ − θ′‖ for all ξ ∈ Ξ, from which it follows that\n‖h̄K(θ)− h̄K(θ′)‖ ≤ Eζ [‖hK(θ, ξ0)− hK(θ′, ξ0)‖] ≤ c1c2‖θ − θ′‖.\nThis shows that h̄K is Lipschitz continuous. We now prove (4.27). Since h̄K(θ) = Eζ [hK(θ, ξ0)] by definition and h̄(θ) = Eζ [h(θ, ξ0)] by Cor. 2.1, it is sufficient to prove the following statement, which entails (4.27):\nsup θ∈B Eζ\n[ ∥ ∥hK(θ, ξ0)− h(θ, ξ0) ∥ ∥ ] → 0 as K → ∞. (4.28)\nBy (4.24), for some constant c > 0,\n‖hK(θ, ξ0)− h(θ, ξ0)‖ ≤ 2c ‖e0‖ · 1(‖e0‖ ≥ K), ∀ θ ∈ B,\nand therefore, sup θ∈B Eζ [ ∥ ∥hK(θ, ξ0)− h(θ, ξ0) ∥ ∥ ] ≤ 2cEζ [ ‖e0‖ · 1(‖e0‖ ≥ K) ] . By Theorem 2.3, Eζ [‖e0‖] < ∞ and hence Eζ [‖e0‖ · 1(‖e0‖ ≥ K)] → 0 as K → ∞. Together with the preceding inequality, this implies (4.28), which in turn implies (4.27).\nWe now show that the convergence in mean required in (4.25) is satisfied.\nProposition 4.5. Under Assumption 2.1, the conclusion of Prop. 4.3 holds in the setting of the algorithm (3.3), with the functions hK and h̄K in place of h and h̄, respectively.\nProof. The same arguments given in the proof of Prop. 4.3 apply here, with the functions hK , h̄K in place of h, h̄, respectively. Only two details are worth noting here. The proof relies on the Lipschitz continuity property of hK given in (4.23). As mentioned earlier, this property implies that for each θ, with ξ = (e, F, s, a, s′), hK(θ, ξ) is Lipschitz continuous in (e, F ) uniformly in (s, a, s\n′), so we can apply Theorem 2.3 to conclude that (4.14) and hence (4.11) hold in this case (for hK , h̄K instead of h, h̄). The property (4.23) also allows us to obtain (4.12) in this case, by exactly the same proof given earlier.\nThus we have furnished all the conditions required by [19, Theorems 8.2.2, 8.2.3]. As in the case of (2.11), by these two theorems, the assertions of Theorems 3.1 and 3.2 hold for the variant algorithm (3.3) with Nδ(LB) in place of Nδ(θ\n∗), where LB is the limit set of the projected mean ODE associated with (3.3): ẋ = h̄K(x) + z, z ∈ −NB(x). To finish the proof for Theorems 3.3-3.4, it is now sufficient to show that for any given δ > 0, we can choose a number Kδ large enough so that LB ⊂ Nδ(θ∗) for all K ≥ Kδ. We prove this below, using Prop. 4.4. Note that the set LB reflects the bias of the constrained algorithm (3.3), so what we are showing now is that this bias decreases as K increases."
    }, {
      "heading" : "30 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Lemma 4.2. Let Assumptions 2.1, 2.2 hold, and let the radius of the set B exceed the threshold given in Lemma 2.1. Then for all K sufficiently large, given any initial condition x(0) ∈ B, a solution to the projected ODE (4.26) coincides with the unique solution to ẋ = h̄K(x), with the boundary reflection term being z(·) ≡ 0. Given δ > 0, there exists Kδ such that for K ≥ Kδ, the limit set LB of (4.26) satisfies LB ⊂ Nδ(θ∗).\nProof. Under Assumptions 2.1, 2.2, the matrix C is negative definite (Theorem 2.1), and when the radius of the set B exceeds the threshold given in Lemma 2.1, there exists a constant ǫ > 0 such that for all boundary points x of B, 〈x, h̄(x)〉 < −ǫ. At such points x, the normal cone NB(x) = {ax | a ≥ 0}, and\n〈x, h̄K(x)〉 = 〈x, h̄(x)〉 + 〈x, h̄K(x) − h̄(x)〉 < −ǫ+ 〈x, h̄K(x)− h̄(x)〉.\nBy (4.27) in Prop. 4.4, 〈x, h̄K(x)−h̄(x)〉 → 0 uniformly on B asK → ∞. Thus when K is sufficiently large, at all boundary points x of B, 〈x, h̄K(x)〉 < 0; i.e., h̄K(x) points inside B and the boundary reflection term z = 0. It then follows that for such K, given an initial condition x(0) ∈ B, a solution to (4.26) coincides with the unique solution to ẋ = h̄K(x), where the uniqueness is ensured by the Lipschitz continuity of h̄K proved in Prop. 4.4 (cf. [7, Chap. 11.2]).\nTo prove the second statement concerning the limit set of the projected ODE, let K be large enough so that the conclusion of the first part holds. Let x(τ), τ ∈ [0,∞), be the solution of (4.26) for a given initial x(0) ∈ B. Since h̄K is bounded on B, x(·) is Lipschitz continuous on [0,∞). Let V (τ) = |x(τ) − θ∗|2, and we calculate V̇ (τ). Since for all x, h̄(x) = Cx + b = C(x − θ∗) and x⊤Cx ≤ −c|x|2 for some c > 0 by the negative definiteness of C, a direct calculation shows that\nV̇ (τ) = 2 〈 x(τ) − θ∗ , h̄K(x(τ)) 〉 = 2 〈 x(τ) − θ∗ , h̄(x(τ)) 〉 + 2 〈 x(τ) − θ∗, h̄K(x(τ)) − h̄(x(τ)) 〉\n≤ −2c ∣ ∣x(τ) − θ∗ ∣ ∣ 2 + 2 ∣ ∣x(τ) − θ∗ ∣ ∣ · ∣ ∣h̄K(x(τ)) − h̄(x(τ)) ∣ ∣.\nBy (4.27) in Prop. 4.4, supx∈B |hK(x) − h̄(x)| → 0 as K → ∞. It then follows that for any δ > 0, there exist ǫ > 0 and Kδ > 0 such that for all K ≥ Kδ, V̇ (τ) ≤ −ǫ if V (τ) = |x(τ)− θ∗|2 ≥ δ2. This together with the continuity of the solution x(·) shows that for any x(0) ∈ B, within time τ̄ = r2B/ǫ (where rB is the radius of B), the trajectory x(τ) must reach Nδ(θ\n∗) and stay in that set thereafter. Consequently, for all K ≥ Kδ, the limit set LB = ∩τ̄≥0 ∪x(0)∈B{x(τ), τ ≥ τ̄} ⊂ Nδ(θ∗).\nThis completes the proofs of Theorems 3.3 and 3.4 for the first variant."
    }, {
      "heading" : "4.2.2 Proofs for the Second Variant",
      "text" : "We now analyze the second variant algorithm (3.4),\nθt+1 = ΠB (θt + αt ψK(Yt)) , where Yt = et · ρt ( Rt + γt+1φ(St+1) ⊤θt − φ(St)⊤θt ) .\nSimilarly to the previous case, with ξ = (e, F, s, a, s′), we define a bounded function hK : R n×Ξ → Rn by\nhK(θ, ξ) =\n∫\nψK\n(\ne · ρ(s, a) ( r + γ(s′)φ(s′)⊤θ − φ(s)⊤θ )\n)\nq(dr | s, a, s′),\nwhere we recall that q(dr | s, a, s′) is the conditional probability distribution of the reward given the state transition (s, s′) under the action a. We can write the algorithm (3.4) equivalently in terms of hK as\nθt+1 = ΠB\n(\nθt + αt hK(θt, ξt) + αt ∆t\n)\n,\nwhere ∆t = ψK(Yt)− hK(θt, ξt), and it can be seen that hK(θt, ξt) = Et[ψK(Yt)] and Et[∆t] = 0. Two properties of the function hK will be useful shortly in our analysis:\n31\n(a) The Lipschitz continuity property (4.23) holds for the function hK here. In particular, let c1 > 0 be the Lipschitz modulus of the function ψK with respect to ‖ · ‖. A direct calculation using the Lipschitz property of ψK shows that with ξ = (e, F, s, a, s ′) and ξ′ = (e′, F ′, s, a, s′),\n‖hK(θ, ξ)− hK(θ, ξ′)‖ ≤ ∫ c1 ∥ ∥ ∥ (e − e′) · ρ(s, a) ( r + γ(s′)φ(s′)⊤θ − φ(s)⊤θ ) ∥ ∥ ∥ q(dr|s, a, s′),\nso for each θ, there exists a finite constant c > 0 such that\n‖hK(θ, ξ) − hK(θ, ξ′)‖ ≤ c ‖e− e′‖, ∀ (s, a, s′) ∈ S ×A× S. (4.29)\n(b) The second property given below also follows from a direct calculation using the Lipschitz continuity of ψK : there exists a finite constant c > 0 such that for any θ, θ ′,\n‖hK(θ, ξ)− hK(θ′, ξ)‖ ≤ c‖e‖ · ‖θ − θ′‖, ∀ ξ ∈ Ξ. (4.30)\nWe now proceed to prove Theorems 3.3-3.4 for the algorithm (3.4). As before, we will apply [19, Theorems 8.2.2, 8.2.3], and this requires us to show that the conditions (i)-(v) and (i′)-(v′) given in Section 4.1.1, with the function hK above in place of h, are satisfied. The conditions (i)-(iv) and (i′)-(iv′) are clearly met. In particular, the uniform integrability conditions (i), (i′), (iv) and (iv′) are trivially fulfilled because by the definitions of hK and the algorithm (3.4), {ψK(Yt)}, {hK(θt, ξt)}, and {hK(θ, ξt)} for each θ, regardless of stepsizes, all lie in a bounded set determined by K. As for the continuity condition (ii), in view of the boundedness and Lipschitz continuity of ψK , it is also clear that hK(θ, ξ) is bounded and continuous in θ uniformly in ξ ∈ D, for each compact set D ⊂ Ξ (cf. (4.30)).\nThe condition (v) (equivalently (v′)) requires the existence of a continuous function h̄K : R n → Rn\nsuch that for each θ ∈ B and each compact set D ⊂ Ξ,\nlim k→∞,t→∞\n1\nk\nt+k−1 ∑\nm=t\nEt\n[ hK(θ, ξm)− h̄K(θ) ] 1 ( ξt ∈ D ) = 0 in mean. (4.31)\nSimilarly to the analysis for the first variant algorithm, we identify this function h̄K(θ) to be the expectation of hK(θ, ξ0) with respect to the stationary distribution of the process {Zt}, and if condition (v) is satisfied, then the mean ODE of the algorithm (3.4) will be given by\nẋ = h̄K(x) + z, z ∈ −NB(x).\nProposition 4.6. Let Assumption 2.1 hold. Consider the setting of the algorithm (3.4), and for each θ ∈ Rn, let h̄K(θ) = Eζ [hK(θ, ξ0)]. Then the conclusion of Prop. 4.4 holds.\nProof. The function hK is by definition bounded, and under Assumption 2.1, the Markov chain {(St, At, et, Ft)} has a unique invariant probability measure ζ (Theorem 2.2). The function h̄K(θ) is therefore well-defined and bounded. Using the property (4.30) of the function hK , we have that there exists a finite constant c > 0 such that for any θ, θ′,\n‖h̄K(θ)− h̄K(θ′)‖ ≤ Eζ [∥ ∥hK(θ, ξ0)− hK(θ′, ξ0) ∥ ∥ ] ≤ cEζ [‖e0‖] · ‖θ − θ′‖.\nSince Eζ{‖e0‖} < ∞ by Theorem 2.3, this shows that h̄K is Lipschitz continuous. To prove (4.27), let us prove\nsup θ∈B Eζ′\n[\n∥ ∥ĥK(θ, ξ0, R0)− ĥ(θ, ξ0, R0) ∥ ∥\n]\n→ 0 as K → ∞, (4.32)"
    }, {
      "heading" : "32 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "where ĥK , ĥ : R n × Ξ× R → Rn are defined by\nĥK(θ, ξ, r) := ψK\n(\ne · ρ(s, a) ( r + γ(s′)φ(s′)⊤θ − φ(s)⊤θ )\n)\n,\nĥ(θ, ξ, r) := e · ρ(s, a) ( r + γ(s′)φ(s′)⊤θ − φ(s)⊤θ ) ,\nand ζ′ denotes the unique invariant probability measure of the Markov chain {(ξt, Rt)}, the existence and uniqueness of such a measure being implied by Theorem 2.2, and the expectation Eζ′ is over (ξ0, R0) with respect to ζ ′. By taking expectation over R0 conditioned on ξ0, we have\nEζ′ [ ĥK(θ, ξ0, R0) ] = Eζ [ hK(θ, ξ0) ] = h̄K(θ), Eζ′ [ ĥ(θ, ξ0, R0) ] = Eζ [ h(θ, ξ0) ] = h̄(θ),\nso (4.32) implies (4.27).\nWe now prove (4.32). Note that ĥK(θ, ξ0, R0) = ψK(ĥ(θ, ξ0, R0)). So using the property (3.2) of ψK , we have for any θ,\n∥ ∥ĥK(θ, ξ0, R0)− ĥ(θ, ξ0, R0) ∥ ∥ ≤ 2 ∥ ∥ĥ(θ, ξ0, R0) ∥ ∥ · 1 (∥ ∥ĥ(θ, ξ0, R0) ∥ ∥ ≥ K ) ,\nand using the definition of ĥ and the boundedness of B, we also have that for some constants c1, c2 > 0,\n∥ ∥ĥ(θ, ξ0, R0) ∥ ∥ ≤ c1‖e0R0‖+ c2‖e0‖ =: g(e0, R0), ∀ θ ∈ B. Combining the preceding two relations, we have for any θ ∈ B,\n∥ ∥ĥK(θ, ξ0, R0)− ĥ(θ, ξ0, R0) ∥ ∥ ≤ 2 g(e0, R0) · 1 ( g(e0, R0) ≥ K )\nand hence\nsup θ∈B Eζ′\n[\n∥ ∥ĥK(θ, ξ0, R0)− ĥ(θ, ξ0, R0) ∥ ∥\n]\n≤ 2Eζ′ [ g(e0, R0) · 1 ( g(e0, R0) ≥ K )] . (4.33)\nSince Eζ′ [g(e0, R0)] = Eζ′ [c1‖e0R0‖+ c2‖e0‖] < ∞ (we obtain the finiteness of the expectation here by first taking expectation over R0 conditioned on ξ0 and then applying Theorem 2.3), the expectation on the right-hand side of (4.33) converges to 0 as K → ∞. We thus obtain (4.32), which implies (4.27).\nThe rest of the analysis is similar to that for the first variant algorithm. First, using the Lipschitz continuity property (4.29) of the function hK given earlier, we obtain that the convergence-in-mean condition (4.31) holds, by the same proof arguments for Prop. 4.3:\nProposition 4.7. Under Assumption 2.1 and in the setting of the algorithm (3.4), (4.31) holds for each θ ∈ B and each compact set D ⊂ Ξ.\nNow we have furnished all the conditions required by [19, Theorems 8.2.2, 8.2.3]. By these two theorems, we can assert that the conclusions of Theorems 3.1-3.2 hold for the variant algorithm (3.4) with Nδ(LB) in place of Nδ(θ\n∗), where LB is the limit set of the projected mean ODE associated with (3.4): ẋ = h̄K(x) + z, z ∈ −NB(x). So to finish the proof for Theorems 3.3-3.4, it is sufficient to show that for any given δ > 0, we can choose a number Kδ large enough so that LB ⊂ Nδ(θ∗) for all K ≥ Kδ. In other words, the conclusions of Lemma 4.2 hold for the case of the algorithm (3.4). This is true by the same proof for Lemma 4.2 with Prop. 4.6 in place of Prop. 4.4. This completes the proofs of Theorems 3.3-3.4 for the second variant.\n33"
    }, {
      "heading" : "4.3 Further Analysis of the Constant-stepsize Case",
      "text" : "We now consider again the case of constant stepsize, and prove Theorems 3.5-3.8 given in Section 3.3. The proofs will be based on combining the results we obtained earlier by using the stochastic approximation theory, with the ergodic theorems of weak Feller Markov chains. As before the proofs will also rely on the key properties of the ETD iterates."
    }, {
      "heading" : "4.3.1 Weak Feller Markov Chains",
      "text" : "We shall focus on Markov chains on complete separable metric spaces. For such a Markov chain {Xt} with state space X, let P (·, ·) denote its transition kernel, that is, P : X× B(X) → [0, 1],\nP (x,D) = Px(X1 ∈ D), ∀x ∈ X, D ∈ B(X),\nwhere B(X) denotes the Borel sigma-algebra on X, and Px denotes the probability distribution of {Xt} conditioned on X0 = x. Multiple-step transition kernels will also be needed. For t ≥ 1, the t-step transition kernel P t(·, ·) : X× B(X) → [0, 1] is given by\nP t(x,D) = Px(Xt ∈ D), ∀x ∈ X, D ∈ B(X),\nand for t = 0, P 0 is defined as P 0(x, ·) = δx, the Dirac measure that assigns probability 1 to the point x, for each x ∈ X. Define averaged probability measures P̄k(x, ·) for k ≥ 1 and x ∈ X, as\nP̄k(x, ·) = 1\nk\nk−1 ∑\nt=0\nP t(x, ·).\nThe Markov chain {Xt} has the weak Feller property if for every bounded continuous function f on X,\nPf(x) :=\n∫\nf(y)P (x, dy) = E [ f(X1) | X0 = x ]\nis a continuous function of x [30, Prop. 6.1.1]. Weak Feller Markov chains have nice properties. In our analysis, we will use in particular several properties relating to the invariant probability measures of these chains and convergence of certain probability measures to the invariant probability measures.\nRecall that if µ and µt, t ≥ 0, are probability measures on X, {µt} is said to converge weakly to µ if ∫ fdµt → ∫\nfdµ for every bounded continuous function f on X. For {µt} that is not necessarily convergent, we shall call the limiting probability measure of any of its convergent subsequence, in the sense of weak convergence, a weak limit of {µt}. For an (arbitrary) index set K, a set of probability measures {µk}k∈K on X is said to be tight if for every δ > 0, there exists a compact set Dδ ⊂ X such that µk(Dδ) ≥ 1 − δ for all k ∈ K. An important fact is that on a complete separable metric space, any tight sequence of probability measures has a further subsequence that converges weakly to some probability measure [12, Theorem 11.5.4].\nFor weak Feller Markov chains, their averaged probability measures {P̄k(x, ·)}k≥1 are known to have the following property; see e.g., the proof of Lemma 4.1 in [29]. It will be needed in our proofs of Theorems 3.5-3.6.\nLemma 4.3. Let {Xt} be a weak Feller Markov chain with transition kernel P (·, ·) on a metric space X. For each x ∈ X, any weak limit of {P̄k(x, ·)} is an invariant probability measure of {Xt}.\nRecall that the occupation probability measures of {Xt}, denoted {µx,t} for each initial condition x ∈ X, are defined as follows:\nµx,t(D) := 1\nt\nt−1 ∑\nk=0\n1(Xk ∈ D), ∀D ∈ B(X),"
    }, {
      "heading" : "34 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "where the chain {Xt} starts from X0 = x, and each µx,t is a random variable taking values in the space of probability measures on X. Let “Px-a.s.” stand for “almost surely with respect to Px.” The next lemma concerns the convergence of occupation probability measures of a weak Feller Markov chain. It is a result of Meyn [29] and will be needed in our proofs of Theorems 3.7-3.8.\nLemma 4.4 ([29, Prop. 4.2]). Let {Xt} be a weak Feller Markov chain with transition kernel P (·, ·) on a complete separable metric space X. Suppose that\n(i) {Xt} has a unique invariant probability measure µ; (ii) for each compact set E ⊂ X, the set {P̄k(x, ·) | x ∈ E, k ≥ 1} is tight; and (iii) for all initial conditions x ∈ X, there exists a sequence of compact sets Ek ↑ X (that is\nEk ⊂ Ek+1 for all k and ∪kEk = X) such that\nlim k→∞ lim inf t→∞ µx,t(Ek) = 1, Px-a.s.\nThen, for each initial condition x ∈ X, the sequence {µx,t} of occupation probability measures converges weakly to µ, Px-almost surely.\nThe condition (iii) above is equivalent to that the sequence {µx,t} of occupation probability measures is almost surely tight for each initial condition."
    }, {
      "heading" : "4.3.2 Proofs of Theorems 3.5 and 3.6",
      "text" : "In this subsection we prove Theorem 3.5 for the algorithm (2.11) and Theorem 3.6 for its two variants (3.3) and (3.4). We also show that the conclusions of Theorems 3.5-3.6 hold for the perturbed version (3.7) of these algorithms as well. The proof arguments are largely the same for all the algorithms we consider here. So except where noted otherwise, it will be taken for granted through out this subsection that {θαt } is generated by either of the six algorithms just mentioned, for a constant stepsize α > 0.\nWe start with some preliminary analysis given in the next two lemmas. Recall Zt = (St, At, et, Ft) and {Zt} is a weak Feller Markov chain on Z := S ×A×Rn+1 [52, Sec. 3.1], and its evolution is not affected by the θ-iterates. We consider the Markov chain {(Zt, θαt )} on the state space Z ×B (note that this is a complete separable metric space). This chain also has the weak Feller property:\nLemma 4.5. Let Assumption 2.1(ii) hold. The process {(Zt, θαt )} is a weak Feller Markov chain.\nProof. We omit the superscript α in the proof. We need to show that for any bounded continuous function f(z, θ), the function E[f(Z1, θ1) | Z0 = z, θ0 = θ] is continuous in (z, θ). Express z in terms of its components as z = (s, a, e, F ). Given that the space S×A is discrete, a function continuous in (z, θ) is a function that is continuous in (e, F, θ) for each (s, a) ∈ S ×A. So in view of the finiteness of S ×A, what we need to show is that for any two state-action pairs (s, a), (s′, a′) ∈ S ×A,\nḡ(e, F, θ) := E [ f(Z1, θ1) ∣ ∣ (e0, F0, θ0) = (e, F, θ), (S0, A0, S1, A1) = (s, a, s ′, a′) ]\n(4.34)\nis a continuous function of (e, F, θ). Consider first the case where θt is generated by either of the algorithms (2.11), (3.3) and (3.4). By the definitions of these algorithms, given (S0, A0, S1, A1) as in (4.34), e1 and F1 are continuous functions of (e0, F0), and θ1 is a continuous function of (e0, F0, θ0, R0). Thus f(Z1, θ1) is a continuous function of (e0, F0, θ0, R0); to simplify notation, denote this function by g(x, r) with x = (e, F, θ) and r corresponding to the reward variable R0. Then, to show the continuity of the function in (4.34) is to show the continuity of the function\nḡ(x) =\n∫\ng(x, r) q(dr |s, a, s′).\n35\nTo verify that ḡ is continuous, consider an arbitrary point x̄ = (ē, F̄ , θ̄) ∈ Rn+1 × B. Given any ǫ > 0, pick r̄ > 0 large enough so that q([−r̄, r̄] |s, a, s′) ≥ 1− ǫ/(4‖g‖∞) (where ‖g‖∞ ≤ ‖f‖∞ < ∞, and ‖g‖∞, ‖f‖∞ are the infinity norm of the functions g, f , respectively). Since g is continuous, it is uniformly continuous on any compact set. Therefore, there exists δ > 0 small enough so that for any r ∈ [−r̄, r̄] and x ∈ Rn+1 × B with |x − x̄| ≤ δ, |g(x, r) − g(x̄, r)| ≤ ǫ/2. Consequently, for any x ∈ Rn+1 ×B with |x− x̄| ≤ δ, we have\n∣ ∣ḡ(x) − ḡ(x̄) ∣ ∣ ≤ ∫ ∣ ∣g(x, r) − g(x̄, r) ∣ ∣ q(dr |s, a, s′)\n=\n∫\n{|r|>r̄}\n∣ ∣g(x, r) − g(x̄, r) ∣ ∣ q(dr |s, a, s′) + ∫\n[−r̄,r̄]\n∣ ∣g(x, r) − g(x̄, r) ∣ ∣ q(dr |s, a, s′)\n≤ 2‖g‖∞ · ǫ/(4‖g‖∞) + ǫ/2 = ǫ.\nThis shows that ḡ is a continuous function, and proves that {(Zt, θαt )} is a weak Feller chain. The proof for the perturbed version (3.7) of the algorithms (2.11), (3.3) and (3.4) follows the same arguments, except that g is now a continuous function of (x, r,∆) where ∆ is the perturbation variable, and ḡ is defined by the integration over both r and ∆. The proof details are almost identical to those given above and therefore omitted. We only note a minor difference in the last step of the proof: in addition to choosing a sufficiently large r̄, we also choose a sufficiently large compact set E∆ on the space of ∆, and we work with the resulting compact set Ex̄ × [−r̄, r̄] × E∆ for a closed neighborhood Ex̄ of the point x̄, and use the uniform continuity of the function g on compact sets, as in the above proof.\nIn order to study the behavior of multiple consecutive θ-iterates, we consider for m ≥ 1, the m-step version of {(Zt, θαt )}, that is, the Markov chain {Xt} on (Z × B)m where each state Xt consists of m consecutive states of the original chain {(Zt, θαt )}:\nXt = ( (Zt, θ α t ), . . . , (Zt+m−1, θ α t+m−1) ) .\nSimilarly to the proof of Lemma 4.5, it is straightforward to show that the m-step version of a weak Feller Markov chain is a weak Feller chain as well. Thus the m-step version of {(Zt, θαt )} is also a weak Feller Markov chain, and we can apply the ergodic theorems for weak Feller Markov chains to analyze it. In particular, in this subsection we will use Lemma 4.3 to prove Theorems 3.5-3.6; in the next subsection we will also use Lemma 4.4.\nIn analyzing the m-step version of {(Zt, θαt )}, sometimes it will be more convenient for us to take as its initial condition the condition of just (Z0, θ α 0 )—instead of (Z0, θ α 0 , . . . , Z α m−1, θ α m−1)—and to work with the following objects that are essentially equivalent to the averaged probability measures {P̄k(x, ·)} and the occupation probability measures {µx,t} defined earlier for a general Markov chain {Xt}. Specifically, with {Xt} denoting the m-step version of {(Zt, θαt )}, for each (z, θ) ∈ Z ×B, we define probability measures P̄\n(m,k) (z,θ) , k ≥ 1, on the space X = (Z ×B)m, by\nP̄ (m,k) (z,θ) (D) :=\n1\nk\nk−1 ∑\nt=0\nP(z,θ) ( Xt ∈ D ) , ∀D ∈ B(X). (4.35)\nSimilarly, we define occupation probability measures {µ(m)(z,θ),t} for each (z, θ) ∈ Z ×B by\nµ (m) (z,θ),t(D) :=\n1\nt\nt−1 ∑\nk=0\n1 ( Xk ∈ D ) , ∀D ∈ B(X), (4.36)\nwhere the initial (Z0, θ α 0 ) = (z, θ). Compared with the definitions of {P̄k(x, ·)} and {µx,t} for {Xt}, apparently, all the previous conclusions given in Section 4.3.1 for {P̄k(x, ·)} and {µx,t} hold for\n36 Weak Convergence Properties of Constrained ETD Learning\n{ P̄ (m,k) (z,θ) } and { µ (m) (z,θ),t } as well; therefore we can use the objects { P̄ (m,k) (z,θ) } and {P̄k(x, ·)}, and {\nµ (m) (z,θ),t } and {µx,t}, interchangeably in our analysis.\nLemma 4.6. Let Assumption 2.1 hold. For m ≥ 1, let {Xt} be the m-step version of {(Zt, θαt )} on X = (Z × B)m, with transition kernel P (·, ·). Then {Xt} satisfies the conditions (ii)-(iii) of Lemma 4.4.\nProof. To show that the condition (ii) of Lemma 4.4 is satisfied, fix a compact set E ⊂ X and let us first show that the set {P t(x, ·) | x ∈ E, t ≥ 0} is tight. Since the set B is compact and the state and action spaces are finite, of concern here is just the tightness of the marginals of these probability measures on the space of the trace components (et, Ft, . . . , et+m−1, Ft+m−1) of the state Xt. By Prop. A.1, for all initial conditions of (e0, F0) in a given bounded subset of R\nn+1, supt≥0 E[‖(et, Ft)‖] ≤ L for a constant L (that depends on the subset). So for the set E, applying the Markov inequality together with the union bound, we have that there exists a constant L > 0 such that for all x ∈ E and a > 0, Px ( supk≤t<k+m ‖(et, Ft)‖ ≥ a )\n≤ mL/a for all k ≥ 0. Now for any given δ > 0, let a be large enough so that mL/a < δ and let Da be the closed ball in R n+1 centered at the origin with radius a. Then for the compact set D = (S × A ×Da × B)m, we have P k(x,D) = Px ( supk≤t<k+m ‖(et, Ft)‖ ≤ a )\n≥ 1− δ for all x ∈ E and all k ≥ 0. This shows that the set {P t(x, ·) | x ∈ E, t ≥ 0} is tight. Consequently, the averages of the probability measures in this set must also form a tight set; in particular, the set {P̄k(x, ·) | x ∈ E, k ≥ 1} must be tight. Hence {Xt} satisfies the condition (ii) of Lemma 4.4.\nConsider now the condition (iii) of Lemma 4.4. For positive integers k, let Ek in that condition be the compact set (S ×A×Dk ×B)m, where Dk is the closed ball of radius k in Rn+1 centered at the origin. We wish to show that for each initial condition x ∈ X,\nlim k→∞ lim inf t→∞ µx,t(Ek) = 1, Px-a.s.\nSince the θ-iterates do not affect the evolution of Zt, they can be neglected in the proof. It is sufficient to consider instead the m-step version of {Zt} and show that for the compact sets Êk = (S ×A×Dk)m, it holds for any initial condition z ∈ Z of Z0 that\nlim k→∞ lim inf t→∞\nµ̂ (m) z,t ( Êk ) = 1, Pz-a.s., (4.37)\nwhere {µ̂(m)z,t } are the occupation probability measures of the m-step version of {Zt}, defined analogously to (4.36) with (Zt, . . . , Zt+m−1) in place of Xt.\nTo prove (4.37), consider {Zt} first and its occupation probability measures {µ̂z,t} for each initial condition Z0 = z ∈ Z. By Theorem 2.2, Pz-almost surely, {µ̂z,t} converges weakly to ζ (the unique invariant probability measure of {Zt}). So by [12, Theorem 11.1.1], for the open set D̃k = S×A×Dok, where Dok denotes the interior of Dk (i.e., D o k is the open ball with radius k), almost surely,\nlim inf t→∞\nµ̂z,t ( D̃k ) ≥ ζ(D̃k), and hence lim k→∞ lim inf t→∞ µ̂z,t ( D̃k ) = 1. (4.38)\nNow for the m-step version of {Zt}, with [D̃k]m denoting the Cartesian product of m copies of D̃k, we have\nµ̂ (m) z,t ( [D̃k] m )\n:= 1\nt\nt−1 ∑\nj=0\n1 ( Zj+j′ ∈ D̃k, 0 ≤ j′ < m ) ≥ 1− m−1 ∑\nj′=0\n1\nt\nt−1 ∑\nj=0\n1 ( Zj+j′ 6∈ D̃k ) . (4.39)\nFor each j′ < m, by the definition of µ̂z,t, lim supt→∞ 1 t ∑t−1 j=0 1 ( Zj+j′ 6∈ D̃k ) = lim supt→∞ µ̂z,t ( D̃ck ) , where D̃ck denotes the complement of D̃k in S×A×Rn+1. By (4.38), limk→∞ lim supt→∞ µ̂z,t ( D̃ck ) =\n37\n0 almost surely. Hence for each j′ < m, limk→∞ lim supt→∞ 1 t ∑t−1 j=0 1 ( Zj+j′ 6∈ D̃k )\n= 0 almost surely. We then obtain from (4.39), by taking the limits as t → ∞ and k → ∞, that\nlim inf k→∞ lim inf t→∞\nµ̂ (m) z,t ( [D̃k] m )\n≥ 1− m−1 ∑\nj′=0\nlim sup k→∞ lim sup t→∞\n1\nt\nt−1 ∑\nj=0\n1 ( Zj+j′ 6∈ D̃k ) = 1\nalmost surely. The desired equality (4.37) then follows, since [D̃k] m ⊂ Êk.\nRecall that Mmα is the set of invariant probability measures of the m-step version of {(Zt, θαt )}. By Lemma 4.6 the latter Markov chain satisfies the condition (ii) of Lemma 4.4, and this implies that the set {\nP̄ (m,k) (z,θ) } k≥1 is tight for each initial condition (Z0, θ α 0 ) = (z, θ). Recall that any subsequence\nof a tight sequence has a further convergent subsequence [12, Theorem 11.5.4]. For { P̄ (m,k) (z,θ) } k≥1 , all the weak limits (i.e., the limits of its convergent subsequences) must be invariant probability measures in Mmα , by the property of weak Feller Markov chains given in Lemma 4.3:\nProposition 4.8. Under Assumption 2.1, consider the m-step version of {(Zt, θαt )} for m ≥ 1. For each (z, θ) ∈ Z × B, the sequence {\nP̄ (m,k) (z,θ) } k≥1 of probability measures is tight, and any weak\nlimit of this sequence is an invariant probability measure of the m-step version of {(Zt, θαt )}. (Thus Mmα 6= ∅.)\nWe are now ready to prove Theorems 3.5-3.6. The idea is to use the conclusions on the θ-iterates that we can obtain by applying [19, Theorem 8.2.2], to infer the concentration of the mass around a small neighborhood of (θ∗, . . . , θ∗) (m copies of θ∗) for the marginals of all the invariant probability measures in the set Mmα , when α is sufficiently small. This can then be combined with Prop. 4.8 to prove the desired conclusions on the θ-iterates for a given stepsize.\nRecall that Mα is the set of invariant probability measures of {(Zt, θαt )}. Recall also that M̄mα denotes the set of marginals of the invariant probability measures in Mmα , on the space of the θ’s.\nProposition 4.9. In the setting of Theorem 3.2, for each α > 0, let {θαt } be generated instead by the algorithm (2.11) or its perturbed version (3.7), with constant stepsize α and under the condition that the initial (Z0, θ α 0 ) is distributed according to some invariant probability measure in Mα. Then the conclusions of Theorem 3.2 continue to hold.\nProof. The proof arguments are the same as those for Theorem 3.2 given in Section 4.1. We only need to show that the conditions (ii) and (i′)-(v′) given in Section 4.1.1 for applying [19, Theorem 8.2.2] are still satisfied under our present assumptions.\nFor the algorithm (2.11), the only difference from the previous assumptions in Theorem 3.2 is that here for each stepsize α, the initial (Z0, θ α 0 ) has a distribution µα ∈ Mα. The condition (ii) does not depend on such initial conditions, so it continues to hold. For the other conditions, note that since {Zt} has a unique invariant probability measure ζ (Theorem 2.2), regardless of the choice of µα, for all α, {Zt} is stationary and has the same distribution. Then the tightness condition (iii′) trivially holds because as {ξt} is also stationary and unaffected by the stepsize, each ξαt in (iii′) has the same distribution. Similarly, since {et} is stationary and unaffected by the stepsize, and each et has the same distribution with the mean of ‖et‖ given by Eζ [‖et‖] < ∞ (Theorem 2.3), we obtain that {et} is u.i. From this the uniform integrability required in the conditions (i′) and (iv′) follows as a consequence, as shown in the proof of Prop. 4.2(ii)-(iv). Lastly, the convergence in mean condition (v′) continues to hold (by the same proof given for Prop. 4.3). This is because {ξt} has the same distribution regardless of the stepsize, and because the condition (v′) is for each compact set D and concerns tails of a trajectory starting at instants t with ξt ∈ D, which renders any initial condition on Z0 ineffective. Thus all the required conditions are met, and we obtain the same conclusions on the θ-iterates as given in Theorem 3.2."
    }, {
      "heading" : "38 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "For the perturbed version (3.7) of the algorithm (2.11), the only difference to (2.11) under the present assumptions is the perturbation variables ∆αθ,t involved in each iteration. But by definition these variables have conditional zero mean: Eαt [∆ α θ,t] = 0, so the only condition in which they appear is the uniform integrability condition (i′): {Y αt | t ≥ 0, α > 0} is u.i., where Y αt is now given by Y αt = h(θ α t , ξt) + et · ω̃t+1 + ∆αθ,t. By definition ∆αθ,t for all α and t have bounded variance, and hence {∆αθ,t} is u.i. [6, p. 32]. The set {h(θαt , ξt) + et · ω̃t+1 | t ≥ 0, α > 0} is u.i., which follows from the u.i. of {et}, as we just verified in the case of the algorithm (2.11). Therefore, by Lemma 4.1(i), {Y αt | t ≥ 0, α > 0} is u.i. and the condition (i′) is satisfied. Since the perturbed version (3.7) meets all the required conditions, and shares with (2.11) the same mean ODE, the same conclusions given in Theorem 3.2 hold for this algorithm as well.\nWe now prove Theorem 3.5 for the algorithm (2.11). We prove its part (i) and part (ii) separately, as the arguments are different. Our proofs below also apply to the perturbed version (3.7) of the algorithm (2.11), and together with the preceding proposition, they establish the first part of Theorem 3.7 (which says that the conclusions of both Theorem 3.2 and Theorem 3.5 hold for the perturbed algorithm).\nProof of Theorem 3.5(i). Proof by contradiction. Consider the statement of Theorem 3.5(i):\n∀ δ > 0, lim inf α→0 inf µ∈M̄mαα µ ( [Nδ(θ ∗)]mα ) = 1, where mα = ⌈mα ⌉.\nSuppose it is not true. Then there exist δ, ǫ > 0, m ≥ 1, a sequence αk → 0, and a sequence µαk ∈ M̄mkαk , where mk = mαk , such that\nµαk([Nδ(θ ∗)]mk) ≤ 1− ǫ, ∀ k ≥ 0. (4.40)\nEach µαk corresponds to an invariant probability measure of {(Zt, θαkt )} in Mαk , which we denote by µ̂αk . For each k ≥ 0, generate the iterates {θαkt } using µ̂αk as the initial distribution of (Z0, θαk0 ). For other values of α, generate the iterates {θαt } using some µ̂α ∈ Mα as the initial distribution of (Z0, θ α 0 ). By Prop. 4.9, the conclusions of Theorem 3.2 hold:\nlim sup α→0\nP (\nθαt 6∈ Nδ(θ∗), some t ∈ [ kα, kα + Tα/α ]\n)\n= 0,\nwhere Tα → ∞ as α → 0, and this implies for the given m,\nlim sup α→0\nP (\nθαt 6∈ Nδ(θ∗), some t ∈ [ kα, kα + ⌈mα ⌉ )\n)\n= 0. (4.41)\nBut for each α > 0, the process {(Zt, θαt )} with the initial distribution µ̂α is stationary, so the probability in the left-hand side of (4.41) is just 1 − µα([Nδ(θ∗)]mα), for the marginal probability measure µα ∈ M̄mαα that corresponds to the invariant probability measure µ̂α. Therefore, by (4.41), lim infα→0 µα([Nδ(θ ∗)]mα) = 1. On the other hand, by (4.40), lim infα→0 µα([Nδ(θ ∗)]mα) ≤ lim infk→∞ µαk([Nδ(θ ∗)]mk) < 1, a contradiction. Thus the statement of Theorem 3.5(i) recounted at the beginning of this proof must hold. This also proves the other statement of Theorem 3.5(i), lim infα→0 infµ∈M̄mα µ ( [Nδ(θ ∗)]m )\n= 1, because for α < 1, by the correspondences between those invariant probability measures in Mmα and those in Mmαα , infµ∈M̄mα µ ( [Nδ(θ ∗)]m ) ≥ infµ∈M̄mαα µ ( [Nδ(θ ∗)]mα ) . This completes the proof.\nProof of Theorem 3.5(ii). We suppress the superscript α of θαt in the proof. The statement is trivially true if δ ≥ 2rB, so consider the case δ < 2rB. Let (z, θ) ∈ Z × B be the initial condition of (Z0, θ0). By convexity of the Euclidean norm, ∣ ∣θ̄t − θ∗ ∣ ∣ ≤ 1t ∑t−1\nj=0 |θj − θ∗|, and therefore, for all k ≥ 1,\nsup k≤t<k+m\n∣ ∣θ̄t − θ∗ ∣ ∣ ≤ 1 k\nk−1 ∑\nj=0\nsup j≤t<j+m\n|θt − θ∗|, (4.42)\n39\nand\nE\n[\nsup k≤t<k+m\n∣ ∣θ̄t − θ∗ ∣ ∣\n]\n≤ 1 k\nk−1 ∑\nj=0\nE\n[\nsup j≤t<j+m\n|θt − θ∗| ] . (4.43)\nWith N ′δ(θ ∗) denoting the open δ-neighborhood of θ∗, we have\n1\nk\nk−1 ∑\nj=0\nE\n[\nsup j≤t<j+m\n|θt − θ∗| ] ≤ 1 k\nk−1 ∑\nj=0\nE\n[\n(\nsup j≤t<j+m\n|θt − θ∗| ) · 1 ( θt ∈ N ′δ(θ∗), j ≤ t < j +m )\n]\n+ 1\nk\nk−1 ∑\nj=0\nE\n[\n(\nsup j≤t<j+m\n|θt − θ∗| ) · 1 ( θt 6∈ N ′δ(θ∗), some t ∈ [j, j +m) )\n]\n≤ δ · P̄ (m,k)(z,θ) (Dδ) + 2rB · ( 1− P̄ (m,k)(z,θ) (Dδ) ) , (4.44)\nwhere Dδ = {( z1, θ1, . . . , zm, θm ) ∈ (Z ×B)m ∣ ∣ sup1≤j≤m ∣ ∣θj − θ∗ ∣ ∣ < δ } , and the second inequality follows from the definition (4.35) of the averaged probability measure P̄ (m,k) (z,θ) .\nBy Prop. 4.8, { P̄ (m,k) (z,θ) } k≥1 is tight and all its weak limits are in Mmα , the set of invariant probability measure of the m-step version of {(Zt, θt)}. There is also the fact that on a metric space, if a sequence of probability measures µk converges to some probability measure µ weakly, then lim infk→∞ µk(D) ≥ µ(D) for any open set D [12, Theorem 11.1.1]. From these two arguments we have that for the set Dδ, which is open with respect to the topology on (Z ×B)m,\nlim inf k→∞ P̄ (m,k) (z,θ) (Dδ) ≥ infµ∈Mmα µ(Dδ) = inf µ∈M̄mα µ ( [N ′δ(θ ∗)]m ) =: κα,m. (4.45)\nCombining the three inequalities (4.43)-(4.45), and using also the relation δ < 2rB, we obtain\nlim sup k→∞ E\n[\nsup k≤t<k+m\n∣ ∣θ̄t − θ∗ ∣ ∣\n]\n≤ δ κα,m + 2rB ( 1− κα,m ) .\nWe prove Theorem 3.6 in exactly the same way as we proved Theorem 3.5, so we omit the details and only outline the proof here. First, for the variant algorithms (3.3) and (3.4) as well as their perturbed version (3.7), we consider fixed K and ψK . Similar to Prop. 4.9, we show that if for each stepsize α, the initial (Z0, θ α 0 ) is distributed according to some invariant probability measure in Mα, then the algorithms continue to satisfy the conditions given in Section 4.1.1, so we can apply [19, Theorem 8.2.2] to assert that the conclusions of Theorem 3.2 continue to hold with Nδ(θ\n∗) replaced by the limit set Nδ(LB) of the mean ODE associated with each algorithm. (Recall Theorem 3.4 is also obtained in this way.) Subsequently, with Nδ(LB) in place of Nδ(θ\n∗) again, and with K and ψK still held fixed, we use the same proof for Theorem 3.5(i) to obtain that for any δ > 0 and m ≥ 1,\nlim inf α→0 inf µ∈M̄mαα\nµ ( [Nδ(LB)] mα ) = 1, where mα = ⌈mα ⌉.\nFinally, we combine this with the fact that given any δ > 0, the limit set Nδ(LB) ⊂ Nδ(θ∗) for all K sufficiently large (see Lemma 4.2, which holds for (3.3) and (3.4), as well as their perturbed version (3.7) since the latter has the same mean ODE as the original algorithm). Theorem 3.6(i) then follows: given δ > 0, for all K sufficiently large,\nlim inf α→0 inf µ∈M̄mαα\nµ ( [Nδ(θ ∗)]mα ) = 1.\nThe proof for Theorem 3.6(ii) is exactly the same as that for Theorem 3.5(ii) given earlier. In particular, this proof relies solely on the weak Feller property of the Markov chain {(Zt, θαt )} and"
    }, {
      "heading" : "40 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "the convergence property of the averaged probability measures of the m-step version of {(Zt, θαt )}, all of which were proved for the algorithms (3.3) and (3.4) and their perturbed version (3.7) in this subsection.\nThe preceding arguments also show that the first part of Theorem 3.8 holds; that is, the conclusions of Theorem 3.4 and Theorem 3.6 hold for the perturbed version (3.7) of the algorithm (3.3) or (3.4) as well."
    }, {
      "heading" : "4.3.3 Proofs of Theorems 3.7 and 3.8",
      "text" : "In this subsection we establish completely Theorems 3.7 and 3.8 regarding the perturbed version (3.7) of the algorithms (2.11), (3.3) and (3.4). We have already proved the first part of both of these theorems in the previous subsection. Below we tackle their second part, which, as we recall, is stronger than the corresponding part of Theorems 3.5 and 3.6 in that for a fixed stepsize α, the deviation of the averaged iterates {θ̄αt } from θ∗ in the limit as t → ∞ is now characterized not in an expected sense but for almost all sample paths.\nTo simplify the presentation, except where noted otherwise, it will be taken for granted throughout this subsection that {θαt } is generated by the perturbed version (3.7) of any of the three algorithms (2.11), (3.3) and (3.4). Recall that when updating θαt to θ α t+1, the perturbed algorithm (3.7) adds the perturbation term α∆θ,t to the iterate before the projection ΠB, where ∆θ,t, t ≥ 0, are assumed to be i.i.d. Rn-valued random variables that have zero mean and bounded variances and have a positive continuous density function with respect to the Lebesgue measure. (Here and in what follows, we omit the superscript α of the noise terms ∆θ,t since we deal with a fixed stepsize α in this part of the analysis.) As mentioned in Section 3.3, these conditions are not as weak as possible. Indeed, the purpose of the perturbation is to make the invariant probability measure of {(Zt, θαt )} unique so that we can invoke the ergodic theorem for weak Feller Markov chains given in Lemma 4.4. Therefore, any conditions that can guarantee the uniqueness of the invariant probability measure can be used. In the present paper, for simplicity, we focus on the conditions we assumed earlier on ∆θ,t, and prove the uniqueness just mentioned under these conditions, although our proof arguments can be useful for weaker conditions as well.\nProposition 4.10. Under Assumption 2.1, {(Zt, θαt )} has a unique invariant probability measure.\nThe next two lemmas are the intermediate steps to prove Prop. 4.10. We need the notion of a stochastic kernel, of which the transition kernel of a Markov chain is one example. For two topological spaces X and Y, a function Q : B(X) ×Y → [0, 1] is a (Borel measurable) stochastic kernel on X given Y, if for each y ∈ Y, Q(· | y) is a probability measure on B(X) and for each D ∈ B(X), Q(D | y) is a Borel measurable function on Y. For the algorithms we consider, the iteration that generates (Zt+1, θ α t+1) from (Zt, θ α t ) can be equivalently described in terms of stochastic kernels. In particular, the transition from Zt to Zt+1 is described by the transition kernel of the Markov chain {Zt}, and the probability distribution of θαt+1 given θαt and ξt = (et, Ft, St, At, St+1) is described by another stochastic kernel, which will be our focus in the analysis below.\nLemma 4.7. Let Assumption 2.1(ii) hold. Let Q(dθ′ | ξ, θ) be the stochastic kernel (on B given Ξ×B) that describes the probability distribution of θαt+1 given ξt = ξ, θαt = θ. Then for each bounded set E ⊂ Ξ, there exist β ∈ (0, 1] and a probability measure Q1 on B such that\nQ(dθ′ | ξ, θ) ≥ β Q1(dθ′), ∀ ξ ∈ E, θ ∈ B. (4.46)\nProof. We consider only the case where {θαt } is generated by the perturbed version of the algorithm (2.11); the proof for the perturbed version of the two other algorithms (3.3) and (3.4) follows exactly the same arguments. In the proof below we use the notation that for a scalar c and a set D ⊂ Rn, the set cD = {cx | x ∈ D}.\n41\nBy the definitions of the algorithms (2.11) and (3.7), for ξ = (e, F, s, a, s′) ∈ Ξ and θ ∈ B, we can express Q(· | ξ, θ) as\nQ(D | ξ, θ) = ∫ ∫ 1 ( ΠB ( θ + αf(ξ, θ, r) + α∆ ) ∈ D ) p(d∆) q(dr | s, a, s′), ∀D ∈ B(B), (4.47)\nwhere f(ξ, θ, r) = e · ρ(s, a) ( r + γ(s′)φ(s′)⊤θ − φ(s)⊤θ ) , and p(·) is the common distribution of the perturbation variables ∆θ,t. Let r̄ > 0 be large enough so that for some c > 0, q([−r̄, r̄] | s̄, ā, s̄′) ≥ c for all (s̄, ā, s̄′) ∈ S × A× S. Let E be an arbitrary bounded subset of Ξ. For all ξ ∈ E, θ ∈ B and r ∈ [−r̄, r̄], since E and B are bounded, g(ξ, θ, r) := (θ+αf(ξ, θ, r))/α lies in a compact subset of Rn, which we denote by D̄. Let ǫ ∈ (0, rB/α] and let D̄ǫ be the ǫ-neighborhood of D̄. By our assumption on the perturbation variables involved in the algorithm (3.7), p(·) has a positive continuous density function with respect to the Lebesgue measure ℓ(·). Therefore, there exists some c′ > 0 such that for any Borel subset D of the compact set −D̄ǫ := {−x | x ∈ D̄ǫ}, p(D) ≥ c′ℓ(D).\nNow consider an arbitrary ξ ∈ E, θ ∈ B, and r ∈ [−r̄, r̄]. We have y := g(ξ, θ, r) ∈ D̄. Let Bǫ(−y) be the ǫ-neighborhood of −y, and let Bǫ denote the closed ball in Rn centered at the origin with radius ǫ. If ∆ ∈ Bǫ(−y), then θ + αf(ξ, θ, r) + α∆ = αy + α∆ ∈ αBǫ ⊂ B (since αǫ ≤ rB). Therefore, for any D ∈ B(B),\n∫\n1\n(\nΠB ( θ + αf(ξ, θ, r) + α∆ ) ∈ D ) p(d∆) ≥ ∫\nBǫ(−y)\n1 ( αy + α∆ ∈ D ) p(d∆)\n≥ c′ ∫\nBǫ(−y)\n1 ( αy + α∆ ∈ D ) ℓ(d∆)\n= c′ℓ ( 1 αD ∩Bǫ ) , (4.48)\nwhere in the second inequality we used the fact that Bǫ(−y) ⊂ −D̄ǫ and restricted to B(−D̄ǫ), p(d∆) ≥ c′ℓ(d∆), as discussed earlier.\nTo finish the proof, define the probability measure Q1 on B by Q1(D) = ℓ( 1 αD ∩ Bǫ)/ℓ(Bǫ) for\nall D ∈ B(B). Then for all ξ ∈ E and θ ∈ B, using (4.47) and (4.48) and our choice of r̄, we have\nQ(D | ξ, θ) ≥ ∫\n[−r̄,r̄]\nc′ℓ(Bǫ) ·Q1(D) q(dr | s, a, s′) ≥ c · c′ℓ(Bǫ) ·Q1(D), D ∈ B(B),\nand the desired inequality (4.46) then follows by letting β = cc′ℓ(Bǫ) > 0 (we must have β ≤ 1 since we can choose D = B in the inequality above).\nWe will use the preceding result in the proof of the next lemma.\nLemma 4.8. Let Assumption 2.1 hold. Let {µx,t} be the sequence of occupation probability measures of {(Zt, θαt )} for each initial condition x ∈ Z × B. Suppose that for some x = (z, θ) ∈ Z × B and µ ∈ Mα, {µx,t} converges weakly to µ, Px-almost surely. Then for each θ′ ∈ B and x′ = (z, θ′), {µx′,t} also converges weakly to µ, Px′-almost surely. Proof. We use a coupling argument to prove the statement. In the proof, we suppress the superscript α of θαt . Let {Xt} denote the process {(Zt, θt)} with initial condition x = (z, θ), and let {X ′t} denote the process {(Zt, θt)} with initial condition x′ = (z, θ′), for an arbitrary θ′ ∈ B. In what follows, we first define a sequence {(Zt, θ̃t, θ̃′t)} with (Z0, θ̃0, θ̃′0) = (z, θ, θ′), in such a way that the two marginal processes {(Zt, θ̃t)} and {(Zt, θ̃′t)} have the same probability distributions as {Xt} and {X ′t}, respectively. We then relate the occupation probability measures {µx,t}, {µx′,t} to those of the marginal processes, {µ̃x,t}, {µ̃x′,t}, which are defined as\nµ̃x,t(D) = 1\nt\nt−1 ∑\nk=0\n1 ( (Zk, θ̃k) ∈ D ) , µ̃x′,t(D) = 1\nt\nt−1 ∑\nk=0\n1 ( (Zk, θ̃ ′ k) ∈ D ) , ∀D ∈ B(Z ×B)."
    }, {
      "heading" : "42 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "We now define {(Zt, θ̃t, θ̃′t)}. First, let {Zt} be generated as before with Z0 = z. Denote ξt = (et, Ft, St, At, St+1) as before, and let Q be the stochastic kernel that describes the evolution of θt+1 given (ξt, θt). By Lemma 4.6, the occupation probability measures of {Zt} is almost surely tight for each initial condition. This implies the existence of a compact set Ē ⊂ Rn+1 such that for the compact set E = Ē×S ×A×S ⊂ Ξ, the sequence {ξt} visits E infinitely often with probability one. For this set E, by Lemma 4.7, there exist some β ∈ (0, 1] and probability measure Q1 on B such that Q(· | ξ̄, θ̄) ≥ βQ1(·) for all ξ̄ ∈ E and θ̄ ∈ B. Therefore, on E ×B, we can write Q(· | ξ̄, θ̄) as the convex combination of Q1 and another stochastic kernel Q0 as follows:\nQ(· | ξ̄, θ̄) = β Q1(·) + (1− β)Q0(· | ξ̄, θ̄), ∀ ξ̄ ∈ E, θ̄ ∈ B, (4.49)\nwhere Q0(· | ξ̄, θ̄) = [ Q(· | ξ̄, θ̄)− β Q1(·) ] /(1− β) and Q0 is a stochastic kernel on B given E × B. Next, independently of {Zt}, generate a sequence {Yt}t≥1 of i.i.d., {0, 1}-valued random variables such that Yt = 1 with probability β and Yt = 0 with probability 1− β. Set Y0 = 0. Let\ntY = min{t ≥ 1 | Yt = 1, ξt−1 ∈ E}.\nThen tY < ∞ with probability one. (Since {ξt} visits E infinitely often and the process {Yt} is independent of {ξt}, this follows easily from applying the Borel-Cantelli lemma to {(ξtk , Ytk+1)}k≥1, where tk is when the k-th visit to E by {ξt} occurs.)\nNow for each t ≥ 0, let us define the pair (θ̃t+1, θ̃′t+1) according to the following rule, based on the values of (ξ0, θ̃0, θ̃ ′ 0), . . . , (ξt, θ̃t, θ̃ ′ t) and (Y0, . . . , Yt, Yt+1):\n(i) In the case t < tY and ξt 6∈ E, generate θ̃t+1 and θ̃′t+1 according to Q(· | ξt, θ̃t) and Q(· | ξt, θ̃′t) respectively.\n(ii) In the case t < tY and ξt ∈ E, if Yt+1 = 0, generate θ̃t+1 and θ̃′t+1 according to Q0(· | ξt, θ̃t) and Q0(· | ξt, θ̃′t) respectively; if Yt+1 = 1, generate θ̃t+1 according to Q1(·) and let θ̃′t+1 = θ̃t+1.\n(iii) In the case t ≥ tY , generate θ̃t+1 according to Q(· | ξt, θ̃t) and let θ̃′t+1 = θ̃t+1. In view of (4.49), it can be verified directly by induction on t that the marginal process {(Zt, θ̃t)} (resp. {(Zt, θ̃′t)}) in the preceding construction has the same probability distribution as {Xt} (resp. {X ′t}). This implies that {µx,t} (resp. {µx′,t}) converges weakly to µ with probability one if and only if {µ̃x,t} (resp. {µ̃x′,t}) converges weakly to µ with probability one. On the other hand, by construction θ̃t = θ̃ ′ t for t ≥ tY , where tY < ∞ with probability one, so except on a null set, {µ̃x,t} and {µ̃x′,t} have the same weak limits. Combining these two arguments with the assumption that {µx,t} converges weakly to µ with probability one, it follows that the three sequences {µ̃x,t}, {µ̃x′,t}, and {µx′,t} must all converge weakly to µ with probability one.\nProof of Prop. 4.10. We suppress the superscript α of θαt in the proof. Let {Xt} = {(Zt, θt)}. By Prop. 4.8, the set Mα of invariant probability measures of {Xt} is nonempty. Recall also that since the evolution of {Zt} is not affected by the θ-iterates, the marginal of any µ ∈ Mα on the space Z must equal ζ, the unique invariant probability measure of {Zt} (Theorem 2.2).\nSuppose {Xt} has multiple invariant probability measures; i.e., there exist µ, µ′ ∈ Mα with µ 6= µ′. Then by [12, Theorem 11.3.2] there exists a bounded continuous function f on Z ×B such that\n∫ f dµ 6= ∫ f dµ′. (4.50)\nOn the other hand, since µ is an invariant probability measure of {Xt}, applying a strong law of large numbers for stationary processes [11, Chap. X, Theorem 2.1] (see also [30, Lemma 17.1.1 and Theorem 17.1.2]) to the stationary Markov chain {Xt} with initial distribution µ, we have that there exist a set D1 ⊂ Z ×B with µ(D1) = 1 and a measurable function gf on Z ×B such that (i) for each x ∈ D1, with the initial condition X0 = x, limt→∞ 1t ∑t−1 k=0 f(Xk) = gf(x), Px-a.s.;\n(ii) Eµ[gf (X0)] = Eµ[f(X0)] (i.e., ∫ gfdµ = ∫ fdµ).\n43\nThe same is true for the invariant probability measure µ′: there exist a set D2 ⊂ Z × B with µ′(D2) = 1 and a measurable function g ′ f(x) such that\n(i) for each x ∈ D2, with the initial condition X0 = x, limt→∞ 1t ∑t−1 k=0 f(Xk) = g ′ f(x), Px-a.s.;\n(ii) Eµ′ [g ′ f (X0)] = Eµ′ [f(X0)] (i.e.,\n∫\ng′fdµ ′ =\n∫\nfdµ′).\nAlso, since {Xt} is a weak Feller Markov chain (Lemma 4.5), by [29, Prop. 4.1], for a set of initial conditions x with µ-measure 1, the occupation probability measures {µx,t} of {Xt} converge weakly, Px-almost surely, to some (nonrandom) µ̃x ∈ Mα that depends on the initial x. The same is true for µ′. So by excluding from D1 a µ-null set and from D2 a µ\n′-null set if necessary, we can assume that the sets D1, D2 above also satisfy that for each x ∈ D1∪D2, the occupation probability measures {µx,t} converge weakly to an invariant probability measure µ̃x almost surely. Then since 1 t ∑t−1 k=0 f(Xk) is the same as ∫\nfdµx,t for X0 = x, we have, by the weak convergence of {µx,t} just discussed, that\ngf (x) =\n∫ fdµ̃x for each x ∈ D1, g′f (x) = ∫ fdµ̃x for each x ∈ D2. (4.51)\nCertainly we must have gf (x) = g ′ f(x) onD1∩D2. We now relate the values of these two functions at points that share the same z-component. In particular, let proj(D1) denote the projection of D1 on Z: proj(D1) = {z ∈ Z | ∃ θ with (z, θ) ∈ D1}, and let D1,z be the vertical section of D1 at z: D1,z = {θ | (z, θ) ∈ D1}. Define proj(D2) and D2,z similarly. If x = (z, θ) ∈ D1 ∪ D2 and x′ = (z, θ′) ∈ D1 ∪D2, then in view of Lemma 4.8 and the weak convergence of {µx,t} and {µx′,t}, we must have µ̃x = µ̃x′ . Consequently, by (4.51), for each z ∈ proj(D1), gf (z, ·) is constant on D1,z; for each z ∈ proj(D2), g′f (z, ·) is constant on D2,z; and for each z ∈ proj(D1) ∩ proj(D2), the constants that gf (z, ·), g′f(z, ·) take on D1,z, D2,z, respectively, are the same.\nWe now show ∫ fdµ = ∫ fdµ′ to contradict (4.50) and finish the proof. Since µ(D1) = µ ′(D2) = 1 and by Theorem 2.2 µ, µ′ have the same marginal distribution on Z, which is ζ, there exists a Borel set E ⊂ proj(D1) ∩ proj(D2) with ζ(E) = 1. Consider the sets (E × B) ∩ D1 and (E × B) ∩ D2, which have µ-measure 1 and µ′-measure 1, respectively. By [12, Prop. 10.2.8], we can decompose µ, µ′ into the marginal ζ on Z and the conditional distributions µ(dθ | z), µ′(dθ | z) for z ∈ Z. Then\n1 = µ ( (E ×B)∩D1 ) =\n∫\nE\n∫\nD1,z\nµ(dθ | z) ζ(dz), 1 = µ′ ( (E ×B)∩D2 ) =\n∫\nE\n∫\nD2,z\nµ′(dθ | z) ζ(dz),\nwhere the equality for the iterated integral in each relation follows from [12, Theorem 10.2.1(ii)]. These relations imply that for some set E0 ⊂ E with ζ(E0) = 0,\n∫\nD1,z\nµ(dθ | z) = ∫\nD2,z\nµ′(dθ | z) = 1, ∀ z ∈ E \\ E0. (4.52)\nWe now calculate ∫ gfdµ and ∫ g′fdµ ′. We have\n∫\ngf dµ =\n∫\n(E×B)∩D1\ngf dµ =\n∫\nE\n∫\nD1,z gf(z, θ)µ(dθ | z) ζ(dz), (4.53) ∫\ng′f dµ ′ =\n∫\n(E×B)∩D2\ng′f dµ ′ =\n∫\nE\n∫\nD2,z\ng′f (z, θ)µ ′(dθ | z) ζ(dz), (4.54)\nwhere the equality for the iterated integral in each relation also follows from [12, Theorem 10.2.1(ii)]. As discussed earlier, for each z ∈ E ⊂ proj(D1) ∩ proj(D2), the two constant functions, gf (z, ·) on D1,z and g ′ f (z, ·) on D2,z, have the same value. Using this together with (4.52), we conclude that\n∫\nD1,z\ngf(z, θ)µ(dθ | z) = ∫\nD2,z\ng′f (z, θ)µ ′(dθ | z), ∀ z ∈ E \\ E0. (4.55)"
    }, {
      "heading" : "44 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "Since ζ(E0) = 0, we obtain from (4.53)-(4.55) that\n∫\ngf dµ =\n∫\ng′f dµ ′.\nBut ∫ gfdµ = ∫ fdµ and ∫ g′fdµ ′ = ∫ fdµ′ (as we obtained at the beginning of the proof), so ∫\nfdµ = ∫ fdµ′, a contradiction to (4.50). This proves that {Xt} must have a unique invariant probability measure.\nProposition 4.10 implies that for every m ≥ 1, the m-step version of {(Zt, θαt )} has a unique invariant probability measure. This together with Lemma 4.6 furnishes the conditions (A1)-(A3) of [29, Prop. 4.2] for weak Feller Markov chains (these conditions are the conditions (i)-(iii) of our Lemma 4.4). We can therefore apply the conclusions of [29, Prop. 4.2] (see Lemma 4.4 in our Section 4.3.1) to the m-step version of {(Zt, θαt )} here, and the result is the following proposition:\nProposition 4.11. Under Assumption 2.1, for each m ≥ 1, the m-step version of {(Zt, θαt )} has a unique invariant probability measure µ(m), and the occupation probability measures µ\n(m) (z,θ),t, t ≥ 1, as\ndefined by (4.36), converge weakly to µ(m) almost surely, for each initial condition (z, θ) ∈ Z ×B of (Z0, θ α 0 ).\nWith Prop. 4.11 we can proceed to prove the second part of Theorems 3.7 and 3.8. Given that we have already established their first part in the previous subsection, the arguments for their second part are the same for both theorems and are given below. The proof is similar to that for Theorem 3.5(ii), except that here, instead of working with the averaged probability measures {\nP̄ (m,k) (z,θ) } , Prop. 4.11 allows us to work with the occupation probability measures.\nProof of the second part of both Theorem 3.7 and Theorem 3.8. We suppress the superscript α of θαt in the proof. By Prop. 4.11, {(Zt, θt)} has a unique invariant probability measure µα, and its m-step version has a corresponding unique invariant probability measure µ (m) α . We prove first the statement that for each initial condition (z, θ) ∈ Z ×B, almost surely,\nlim inf t→∞\n1\nt\nt−1 ∑\nk=0\n1\n(\nsup k≤j<k+m\n∣ ∣θj − θ∗ ∣ ∣ < δ ) ≥ µ̄(m)α ( [N ′δ(θ ∗)]m ) , (4.56)\nwhere µ̄ (m) α is the unique element in M̄mα , and N ′δ(θ∗) is the open δ-neighborhood of θ∗. For each t, by the definition (4.36) of the occupation probability measure µ (m) (z,θ),t, the average in the left-hand side above is the same as µ (m) (z,θ),t(Dδ), whereDδ = {( z1, θ1, . . . , zm, θm ) ∈ (Z×B)m ∣ ∣ sup1≤j≤m ∣\n∣θj− θ∗ ∣ ∣ < δ }\n. By Prop. 4.11, P(z,θ)-almost surely, {µ(m)(z,θ),t} converges weakly to µ (m) α , and therefore,\nexcept on a null set of sample paths, we have by [12, Theorem 11.1.1] that for the open set Dδ,\nlim inf t→∞\nµ (m) (z,θ),t(Dδ) ≥ µ(m)α (Dδ) = µ̄(m)α ( [N ′δ(θ ∗)]m ) .\nThis proves (4.56). We now prove the statement that for each initial condition (z, θ) ∈ Z ×B, almost surely,\nlim sup t→∞\n∣ ∣θ̄t − θ∗ ∣ ∣ ≤ δ κα + 2rB (1− κα), where κα = µ̄α ( N ′δ(θ ∗) ) , (4.57)\nand µ̄α is the marginal of µα on B. The statement is trivially true if δ ≥ 2rB, so consider the case δ < 2rB. Fix an initial condition (z, θ) ∈ Z ×B for (Z0, θ0), and let {µ(z,θ),t} be the corresponding\n45\noccupation probability measures of {(Zt, θt)}. For the averaged sequence {θ̄t}, by convexity of the norm | · |,\n∣ ∣θ̄t − θ∗ ∣ ∣ ≤ 1 t\nt−1 ∑\nk=0\n|θk − θ∗|. (4.58)\nWe have\n1\nt\nt−1 ∑\nk=0\n|θk − θ∗| ≤ 1\nt\nt−1 ∑\nk=0\n|θk − θ∗| · 1 ( θk ∈ N ′δ(θ∗) )\n+ 1\nt\nt−1 ∑\nk=0\n|θt − θ∗| · 1 ( θk 6∈ N ′δ(θ∗) )\n≤ δ · µ(z,θ),t(Dδ) + 2rB · ( 1− µ(z,θ),t(Dδ) ) , (4.59)\nwhere Dδ = { (z1, θ1) ∈ Z × B ∣ ∣ |θ1 − θ∗| < δ } . By Prop. 4.11, P(z,θ)-almost surely, {µ(z,θ),t} converges weakly to µα. Therefore, except on a null set of sample paths, we have by [12, Theorem 11.1.1] that for the open set Dδ,\nlim inf t→∞\nµ(z,θ),t(Dδ) ≥ µα(Dδ) = µ̄α ( N ′δ(θ ∗) ) . (4.60)\nCombining the three inequalities (4.58)-(4.60), and using also the relation δ < 2rB , we obtain that (4.57) holds almost surely for each initial condition (z, θ) ∈ Z ×B. This completes the proof. Remark 4.1 (on the role of perturbation again). As mentioned before Prop. 4.10, our purpose of perturbing the constrained ETD algorithms is to guarantee that the Markov chain {(Zt, θαt )} has a unique invariant probability measure. Without the perturbation, this cannot be ensured, so we cannot apply the ergodic theorem given in Lemma 4.4 to exploit the convergence of occupation probability measures, as we did in the preceding proof, even though {(Zt, θαt )} satisfies the remaining two conditions required by that ergodic theorem (cf. Lemma 4.6, Section 4.3.2).\nIn connection with this discussion, let us clarify a point. We know that the occupation probability measures of {Zt} converge weakly to its unique invariant probability measure ζ almost surely for each initial condition of Z0 (Theorem 2.2). But this fact alone cannot rule out the possibility that {(Zt, θαt )} has multiple invariant probability measures and that its occupation probability measures do not converge for some initial condition (z, θ).\nFinally, another property of weak Feller Markov chains and its implication for our problem are worth noting here. By [29, Prop. 4.1], for a weak Feller Markov chain {Xt}, provided that an invariant probability measure µ exists, we have that for a set of initial conditions x with µ-measure 1, the occupation probability measures {µx,t} converge weakly, Px-almost surely, to an invariant probability measure µx that depends on the initial condition. Thus, for the unperturbed algorithms (2.11), (3.3) and (3.4), despite the possibility of {(Zt, θαt )} having multiple invariant probability measures, the preceding proof can be applied to those initial conditions from which the occupation probability measures converge almost surely. In particular, this argument leads to the following conclusion. In the case of the algorithm (2.11), (3.3) or (3.4), under the same conditions as in Theorem 3.5 or 3.6, it holds for any invariant probability measure µ of {(Zt, θαt )} that for each initial condition (z, θ) from some set of initial conditions with µ-measure 1,\nlim sup t→∞\n∣ ∣θ̄αt − θ∗ ∣ ∣ ≤ δ κα + 2rB (1 − κα) P(z,θ)-a.s.,\nwhere κα = infµ∈M̄α µ(N ′ δ(θ ∗)). The limitation of this result, however, is that the set of initial conditions involved is unknown and can be small."
    }, {
      "heading" : "5 Discussion",
      "text" : "In this section we discuss direct applications of our convergence results to ETD(λ) under relaxed conditions and to two other algorithms, the off-policy TD(λ) algorithm and the ETD(λ, β) algorithm proposed by Hallak et al. [15]. We then discuss several open issues to conclude the paper."
    }, {
      "heading" : "46 Weak Convergence Properties of Constrained ETD Learning",
      "text" : ""
    }, {
      "heading" : "5.1 The Case without Assumption 2.2",
      "text" : "Let Assumption 2.1 hold. Recall from Section 2.3 that ETD(λ) aims to solve the equation Cθ+b = 0, where b = Φ⊤M̄ rλπ,γ , C = −Φ⊤GΦ with G = M̄(I − Pλπ,γ). In this paper we have focused on the case where Assumption 2.2 holds and C is negative definite (Theorem 2.1). If Assumption 2.2 does not hold, then either there are less than n emphasized states (i.e., states s with M̄ss > 0), or the feature vectors of emphasized states are not rich enough to contain n linearly independent vectors. In either case the function approximation capacity is not fully utilized. It is hence desirable to fulfill Assumption 2.2 by adding more states with positive interest weights i(s) or by enriching the feature representation.\nNevertheless, suppose Assumption 2.2 does not hold (in which case C is negative semidefinite [46]). This essentially has no effects on the convergence properties of the constrained or unconstrained ETD(λ) algorithms, because of the emphatic weighting scheme (2.3)-(2.5), as we explain now.\nLet there be at least one state s with interest weight i(s) > 0 (the case is vacuous otherwise). Partition the state space into the set of emphasized states and the set of non-emphasized states:\nJ1 = {s ∈ S | M̄ss > 0}, J0 = {s ∈ S | M̄ss = 0}.\nCorresponding to the partition, by rearranging the indices of states if necessary, we can write\nΦ =\n[\nΦ1 Φ0\n]\n, rλπ,γ =\n[\nr1 r0\n]\n, M̄ =\n[\nM̂ 0|J1|×|J0| 0|J0|×|J1| 0|J0|×|J0|\n]\n,\nwhere 0m×m′ denotes an m × m′ zero matrix, M̂ is a diagonal matrix with M̄ss, s ∈ J1, as its diagonals. Let Q̂ be the sub-matrix of Pλπ,γ that consists of the entries whose row/column indices are in J1. For the equation Cθ+b = 0, clearly b = Φ⊤1 M̂r1. Consider now the matrix C. It is shown in the proof of Prop. C.2 in [52] that G has a block-diagonal structure with respect to the partition {J1,J0},\nG =\n[\nĜ 0|J1|×|J0| 0|J0|×|J1| 0|J0|×|J0|\n]\n,\nwhere the block corresponding to J0 is a zero matrix as shown above, and the block Ĝ corresponding to J1 is a positive definite matrix given by\nĜ = M̂(I − Q̂), (5.1)\nand M̂ can be expressed explicitly as\ndiag(M̂) = d1πo,i ⊤ (I − Q̂)−1, d1πo,i ∈ R|J1|, d1πo,i(s) = dπo(s) · i(s), s ∈ J1. (5.2)\nThus the matrix C has a special structure:\nTheorem 5.1 (structure of the matrix C; [52, Appendix C.2, p. 41-44]). Let Assumption 2.1 hold, and let i(s) > 0 for at least one state s ∈ S. Then"
    }, {
      "heading" : "C = −Φ⊤1 ĜΦ1, where Ĝ = M̂(I − Q̂) is positive definite.",
      "text" : "Let range(A) denote the range space of a matrix A. By the positive definiteness of the matrix Ĝ given in the preceding theorem, the negative semidefinite matrix C possesses the following properties (we omit the straightforward proof):\nProposition 5.1. Let Assumption 2.1 hold, and let i(s) > 0 for at least one state s ∈ S. Then the matrix C satisfies that\n47\n(i) range(C) = range(C⊤) = span{φ(s) | s ∈ J1}; and (ii) there exists c > 0 such that for all x ∈ span{φ(s) | s ∈ J1}, x⊤Cx ≤ −c |x|2.\nTwo observations then follow immediately:\n(i) Since b = Φ⊤1 M̂r1 ∈ span{φ(s)|s ∈ J1}, Prop. 5.1(i) shows that the equation Cθ + b = 0 admits a solution, and a unique one in span{φ(s) | s ∈ J1}, which we denote by θ∗.14\n(ii) Prop. 5.1(ii) shows that C acts like a negative definite matrix on the space of feature vectors, span{φ(s)|s ∈ J1}, that the ETD(λ) algorithms naturally operate on.15 We remark that for an arbitrary negative semidefinite matrix C, neither of these conclusions holds. They hold here as direct consequences of the positive definiteness of the matrix Ĝ that underlies C, and this positive definiteness property is due to the emphatic weighting scheme (2.3)-(2.5) employed by ETD(λ).\nNow let us discuss the behavior of the constrained ETD(λ) algorithms starting from some state S0 of interest (i.e., i(S0) > 0), in the absence of Assumption 2.2. Recall that earlier we did not need Assumption 2.2 when applying the two general convergence theorems from [19], and we used the negative definiteness of C implied by this assumption only near the end of our proofs to get the solution properties of the mean ODE associated with each algorithm. In the absence of Assumption 2.2, for the unperturbed algorithms (2.11), (3.3) and (3.4), we can simply restrict attention to the subspace span{φ(s)|s ∈ J1} and use the property in Prop. 5.1(ii) in lieu of negative definiteness. After all, the θ-iterates of these algorithms always lie in the span of the feature vectors if the initial θ0, e0 ∈ span{φ(s)|s ∈ J1} and in the case of the two biased algorithms (3.3) and (3.4), if the function ψK(x) does not change the direction of x. On the subspace span{φ(s)|s ∈ J1}, in view of Prop. 5.1(ii), the function |θ − θ∗|2 serves again as a Lyapunov function for analyzing the ODE solutions in exactly the same way as before. Thus, in the absence of Assumption 2.2, for the algorithms (2.11), (3.3) and (3.4) that set θ0, e0 and ψK as just described, and for rB > |b|/c where c is as in Prop. 5.1(ii), the conclusions of Theorems 3.1-3.6 in Section 3 continue to hold with Nδ(θ\n∗) or N ′δ(θ ∗) replaced by Nδ(θ ∗) ∩ span{φ(s)|s ∈ J1} or N ′δ(θ∗) ∩ span{φ(s)|s ∈ J1}.\nThe same is true for the almost sure convergence of the unconstrained ETD(λ) algorithm (2.2) under diminishing stepsize: with i(S0) > 0 and θ0, e0 ∈ span{φ(s)|s ∈ J1}, the conclusion of [52, Theorem 2.2] continues to hold in the absence of Assumption 2.2; that is, for αt = O(1/t) with αt−αt+1\nαt = O(1/t), θt a.s.→ θ∗. It can be seen now that without Assumption 2.2, complications can only arise through initializing the algorithms outside the desired subspace. We discuss such situations briefly, although they do not seem natural and can be easily avoided. Suppose for some reason we give the initial θ0, e0 a component perpendicular to span{φ(s)|s ∈ J1}. Let i(S0) > 0. The behavior of the unconstrained ETD(λ) algorithm (2.2) is easy to describe. For each t, write θt = θ (1) t + θ (0) t and et = e (1) t + e (0) t , where θ (1) t , e (1) t ∈ span{φ(s)|s ∈ J1} and θ(0)t , e(0)t ⊥ span{φ(s)|s ∈ J1}. The latter components do not affect the evolution of {θ(1)t } and {e(1)t }, and they also do not affect the approximate value functions Φ1θt = Φ1θ (1) t for the emphasized states. For the component process {θ(1)t }, by the\n14From the structures of G, Pλπ,γ , Q̂ and M̂ shown in [52, Appendix C.2, p. 41-44], which give rise to (5.1)-(5.2), we also have the following facts. The approximate value function v = Φ1θ∗ for the emphasized states J1 is the unique solution of the projected Bellman equation v = Π(r1 + Q̂v), where Π is the projection onto the column space of Φ1 with respect to the weighted Euclidean norm on R|J1| defined by the weights M̄ss, s ∈ J1 (the diagonals of M̂). The equation v = r1 + Q̂v is indeed a generalized Bellman equation for the emphasized states only, and has vπ(s), s ∈ J1, as its unique solution. Then for the emphasized states, the relation between the approximate value function Φ1θ∗ and vπ on J1, in particular the approximation error, can again be characterized using the oblique projection viewpoint [40], similar to the case with Assumption 2.2 discussed in Section 2.3.\n15Start ETD(λ) from a state S0 with i(S0) > 0. It can be verified that the emphatic weighting scheme dictates that if St ∈ J0, then the emphasis weight Mt for that state must be zero. Consequently, et is a linear combination of the features of the emphasized states and the initial e0. So when e0 ∈ span{φ(s)|s ∈ J1}, et ∈ span{φ(s)|s ∈ J1} always, and if in addition θ0 ∈ span{φ(s)|s ∈ J1}, then θt ∈ span{φ(s)|s ∈ J1} always. This is very similar to the case of TD(λ) with possibly linearly dependent features discussed in [48]."
    }, {
      "heading" : "48 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "discussion earlier, for stepsize αt = O(1/t) with αt−αt+1\nαt = O(1/t) , θ\n(1) t a.s.→ θ∗. If e(0)0 = 0, then clearly the components e\n(0) t = 0 and θ (0) t = θ (0) 0 through out the iterations. If e (0) 0 6= 0, then by\nrelating to the case where this component is zero and applying Prop. A.2, we have e (0) t a.s.→ 0. In the on-policy case with γ(s)λ(s) < 1 for all s, the magnitude of e\n(0) t in fact shrinks exponentially fast\nand consequently it can be shown that {θ(0)t } converges to a point depending on the sample path. In the general off-policy case, depending on how fast e\n(0) t shrinks, θ (0) t may not converge, we think,\nalthough this does not affect the approximate value function for the emphasized states, as noted earlier.\nFor the constrained ETD(λ) algorithms, if we decompose their iterates into two components as above, the evolution of {θ(1)t } and {e(1)t } can be affected by the components perpendicular to span{φ(s)|s ∈ J1} through the scaling performed by ΠB or ψK (assuming again that ψK(x) maintains the direction of x). Nevertheless, the asymptotic behavior of the algorithms is still characterized by the limit set of their respective mean ODEs. For the algorithm (2.11), the mean ODE is ẋ = h̄(x) + z, z ∈ NB(x), where h̄(x) = Cx + b = C(x − θ∗). Let rB > |b|/c where c is as in Prop. 5.1(ii). Let (x(τ), z(τ)) be a solution of this ODE with x(0) ∈ B. Decompose x as x(τ) = x(1)(τ) + x(0)(τ), with x(1) lying inside the subspace span{φ(s)|s ∈ J1} and x(0) perpendicular to that subspace. Then since h̄(x) = C(x(1) − θ∗) ∈ span{φ(s)|s ∈ J1} by Prop. 5.1(i), based on the Euclidean geometry and Prop. 5.1(ii), we observe that for V1(τ) = |x(1)(τ) − θ∗|2 and V0(τ) = |x(0)(τ)|2, we have V̇1(τ) < 0 whenever x(1)(τ) 6= θ∗, and V̇0(τ) ≤ 0 always and V̇0(τ) < 0 whenever z(τ) 6= 0. Following this observation it can be worked out that the limit set LB ⊂ { θ∗ + y | y ⊥ span{φ(s)|s ∈ J1} }\n∩ B; i.e., LB is a subset of the solutions of Cθ + b = 0 in B. Then the conclusions in Section 3 about the algorithm (2.11) and its perturbed version (3.7) hold with the cylindrical solution neighborhood Nδ(LB) or N ′ δ(LB) in place of Nδ(θ ∗) or N ′δ(θ ∗). Similar conclusions hold for the biased algorithms (3.3) and (3.4) and their perturbed version (3.7), in view of the uniform approximation property given in (4.27) for the functions h̄K involved in their mean ODEs. We omit the details in part because it does not seem natural to initialize θ0, e0 with a component perpendicular to span{φ(s)|s ∈ J1} in the first place.\nAs a final note, in the absence of Assumption 2.2, any solution θ̄ of Cθ+b = 0 gives the same approximate value function for emphasized states, but the approximate values Φ0θ̄ for non-emphasized states in J0 are different for different solutions θ̄. Thus one needs to be cautious in using the approximate values Φ0θ̄. They correspond to different extrapolations from the approximate values Φ1θ ∗ for the emphasized states, whereas Φ1θ ∗ is not defined to take into account approximation errors for those states in J0, although its approximation error for emphasized states can be well characterized (cf. Footnote 14)."
    }, {
      "heading" : "5.2 Off-policy TD(λ)",
      "text" : "Applying TD(λ) to off-policy learning by using importance sampling techniques was first proposed in [36, 35], and the focus there was on episodic data. The analysis we gave in this paper applies directly to the (non-episodic) off-policy TD(λ) algorithm studied in [5, 51, 10], when its divergence issue is avoided by setting λ sufficiently large. Specifically, we consider constant γ ∈ [0, 1) and constant λ ∈ [0, 1], and an infinitely long trajectory generated by the behavior policy as before. The algorithm is the same as TD(λ) except for incorporating the importance sampling weight ρt: 16\nθt+1 = θt + αt et · ρt ( Rt + γφ(St+1) ⊤θt − φ(St)⊤θt ) ,\n16It is not necessary to multiply the term φ(St)⊤θt by ρt, and that version of the algorithm was the one given in [5, 51]. The experimental results in [10] suggest to us that each version can have less variance than the other in some occasions, however. As far as convergence analysis is concerned, the two versions are essentially the same and the analyses given in [51, 52] and this paper indeed apply simultaneously to both versions of the algorithm.\n49\nwhere\net = λγρt−1 et−1 + φ(St).\nThe constrained versions of the algorithm are defined similarly to those for ETD(λ).\nUnder Assumption 2.1(ii), the associated projected Bellman equation is the same as that for onpolicy TD(λ) [48] except that the projection norm is the weighted Euclidean norm with weights given by the steady state probabilities dπo(s), s ∈ S. Assuming Φ has full column rank, the corresponding equation in the θ-space, Cθ+ b = 0, has the desired property that the matrix C is negative definite, if λ is sufficiently large (in particular if λ = 1) [5]. For that case, the conclusions given in this paper for constrained ETD(λ) all hold for the corresponding versions of off-policy TD(λ). (Similarly, for the case of C being negative semidefinite due to Φ having rank less than n, the discussion given in the previous subsection for ETD(λ) also applies.) The reason is that besides the property of C, the other properties of the iterates that we used in our analysis, which are given in Section 2 and Appendix A, all hold for off-policy TD(λ). (In fact, some of these properties were first derived for off-policy LSTD(λ) and TD(λ) in [51] and extended later in [52] to ETD(λ).)\nFor the same reason, the convergence analyses we gave in [52] and this paper for ETD also apply to a variation of the ETD algorithm, ETD(λ, β), proposed recently by Hallak et al. [15], when the parameter β is set in an appropriate range."
    }, {
      "heading" : "5.3 Open Issues",
      "text" : "A major difficulty in applying off-policy TD learning, especially with λ > 0, is the high variances of the iterates. For ETD(λ), off-policy TD(λ) and their least-squares versions, because of the growing variances of products of the importance sampling weights ρtρt+1 · · · along a trajectory, and because of the amplifying effects these weights can have on the traces, the variances of the traces iterates can grow unboundedly with time, severely affecting the behavior of the algorithms in practice. (The problem of growing variances when applying importance sampling to simulate Markov systems was also known earlier and discussed in prior works; see e.g., [14, 38].) The two biased constrained algorithms discussed in this paper were motivated by the need to mitigate the variance problem, and their robust behavior has been observed in our experiments [28, 53]. However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26]. To overcome the variance problem in off-policy learning, further research is required.\nRegarding convergence analysis of ETD(λ), the results we gave in [52] and this paper concern only the convergence properties and not the rates of convergence. For on-policy TD(λ) and LSTD(λ), convergence rate analyses are available [16, Chap. 6]. Such analyses in the off-policy case will give us better understanding of the asymptotic behavior of the off-policy algorithms. Finally, besides asymptotic behavior of the algorithms, their finite-time or finite-sample properties (such as those considered by [31, 2, 20, 21]), and their large deviations properties are also worth studying."
    }, {
      "heading" : "Acknowledgement",
      "text" : "I thank Professors Richard Sutton and Csaba Szepesvári for helpful discussions, and I thank two anonymous reviewers for their helpful feedback. This research was supported by a grant from Alberta Innovates—Technology Futures."
    }, {
      "heading" : "50 Weak Convergence Properties of Constrained ETD Learning",
      "text" : "[2] Antos, A., Szepesv́ari, C., and Munos, R. (2008). Learning near-optimal policies with Bellman residual minimization based fitted policy iteration and a single sample path. Machine Learning, 71:89–129. [3] Baird, L. C. (1995). Residual algorithms: Reinforcement learning with function approximation. In The 12th International Conference on Machine Learning (ICML). [4] Bertsekas, D. P. and Tsitsiklis, J. N. (1996). Neuro-Dynamic Programming. Athena Scientific, Belmont, MA. [5] Bertsekas, D. P. and Yu, H. (2009). Projected equation methods for approximate solution of large linear systems. Journal of Computational and Applied Mathematics, 227(1):27–50. [6] Billingsley, P. (1968). Convergence of Probability Measures. John Wiley & Sons, New York. [7] Borkar, V. S. (2008). Stochastic Approximation: A Dynamic Viewpoint. Cambridge University Press,\nCambridge. [8] Boyan, J. A. (1999). Least-squares temporal difference learning. In The 16th International Conference\non Machine Learning (ICML). [9] Bradtke, S. J. and Barto, A. G. (1996). Linear least-squares algorithms for temporal difference learning.\nMachine Learning, 22(2):33–57. [10] Dann, C., Neumann, G., and Peters, J. (2014). Policy evaluation with temporal differences: A survey\nand comparison. Journal of Machine Learning Research, 15:809–883. [11] Doob, J. L. (1953). Stochastic Processes. John Wiley & Sons, New York. [12] Dudley, R. M. (2002). Real Analysis and Probability. Cambridge University Press, Cambridge. [13] Geist, M. and Scherrer, B. (2014). Off-policy learning with eligibility traces: A survey. Journal of\nMachine Learning Research, 15:289–333. [14] Glynn, P. W. and Iglehart, D. L. (1989). Importance sampling for stochastic simulations. Management\nScience, 35:1367–1392. [15] Hallak, A., Tamar, A., Munos, R., and Mannor, S. (2016). Generalized emphatic temporal difference\nlearning: Bias-variance analysis. In The 30th AAAI Conference on Artificial Intelligence. [16] Konda, V. R. (2002). Actor-Critic Algorithms. PhD thesis, MIT. [17] Kushner, H. J. and Clark, D. S. (1978). Stochastic Approximation Methods for Constrained and Un-\nconstrained Systems. Springer-Verlag, New York. [18] Kushner, H. J. and Shwartz, A. (1984). Weak convergence and asymptotic properties of adaptive filters\nwith constant gains. IEEE Transactions on Information Theory, 30:177–182. [19] Kushner, H. J. and Yin, G. G. (2003). Stochastic Approximation and Recursive Algorithms and Appli-\ncations. Springer-Verlag, New York, 2nd edition. [20] Lazaric, A., Ghavamzadeh, M., and Munos, R. (2012). Finite-sample analysis of least-squares policy\niteration. Journal of Machine Learning Research, 13:3041–3074. [21] Liu, B., Liu, J., Ghavamzadeh, M., Mahadevan, S., and Petrik, M. (2015). Finite-sample analysis of\nproximal gradient TD algorithms. In The 31st Conference on Uncertainty in Artificial Intelligence (UAI). [22] Liu, B., Mahadevan, S., and Liu, J. (2009). Regularized off-policy TD-learning. In Advances in Neural\nInformation Processing Systems (NIPS) 22. [23] Maei, H. R. (2011). Gradient Temporal-Difference Learning Algorithms. PhD thesis, University of\nAlberta. [24] Mahadevan, S. and Liu, B. (2012). Sparse Q-learning with mirror descent. In The 28th Conference on\nUncertainty in Artificial Intelligence (UAI). [25] Mahadevan, S., Liu, B., Thomas, P., Dabney, W., Giguere, S., Jacek, N., Gemp, I., and Liu, J. (2014).\nProximal reinforcement learning: A new theory of sequential decision making in primal-dual spaces. arXiv:1405.6757. [26] Mahmood, A. R. and Sutton, R. S. (2015). Off-policy learning based on weighted importance sampling with linear computational complexity. In The 31st Conference on Uncertainty in Artificial Intelligence (UAI). [27] Mahmood, A. R., van Hasselt, H., and Sutton, R. S. (2014). Weighted importance sampling for offpolicy learning with linear function approximation. In Advances in Neural Information Processing Systems (NIPS) 27. [28] Mahmood, A. R., Yu, H., White, M., and Sutton, R. S. (2015). Emphatic temporal-difference learning. In European Workshops on Reinforcement Learning (EWRL). [29] Meyn, S. (1989). Ergodic theorems for discrete time stochastic systems using a stochastic Lyapunov function. SIAM Journal on Control and Optimization, 27:1409–1439.\n51\n[30] Meyn, S. and Tweedie, R. L. (2009). Markov Chains and Stochastic Stability. Cambridge University Press, Cambridge, 2nd edition. [31] Munos, R. and Szepesv́ari, C. (2008). Finite time bounds for fitted value iteration. Journal of Machine Learning Research, 9:815–857. [32] Neveu, J. (1975). Discrete-Parameter Martingales. North-Holland, Amsterdam. [33] Pires, B. A. and Szepesv́ari, C. (2012). Statistical linear estimation with penalized estimators: An\napplication to reinforcement learning. In The 29th International Conference on Machine Learning (ICML). [34] Polyak, B. T. and Juditsky, A. B. (1992). Acceleration of stochastic approximation by averaging. SIAM\nJournal on Control and Optimization, 30:838–855. [35] Precup, D., Sutton, R. S., and Dasgupta, S. (2001). Off-policy temporal-difference learning with function\napproximation. In The 18th International Conference on Machine Learning (ICML). [36] Precup, D., Sutton, R. S., and Singh, S. (2000). Eligibility traces for off-policy policy evaluation. In\nThe 17th International Conference on Machine Learning (ICML). [37] Puterman, M. L. (1994). Markov Decision Processes: Discrete Stochastic Dynamic Programming. John\nWiley & Sons, New York. [38] Randhawa, R. S. and Juneja, S. (2004). Combining importance sampling and temporal difference\ncontrol variates to simulate Markov chains. ACM Transactions on Modeling and Computer Simulation, 14(1):1–30. [39] Saad, Y. (2003). Iterative Methods for Sparse Linear Systems. SIAM, Philadelphia, 2nd edition. [40] Scherrer, B. (2010). Should one compute the temporal difference fix point or minimize the Bellman\nresidual? The unified oblique projection view. In The 27th International Conference on Machine Learning (ICML). [41] Sutton, R. S. (1988). Learning to predict by the methods of temporal differences. Machine Learning, 3:9–44. [42] Sutton, R. S. (1995). TD models: Modeling the world at a mixture of time scales. In The 12th International Conference on Machine Learning (ICML). [43] Sutton, R. S. (2009). The grand challenge of predictive empirical abstract knowledge. In IJCAI Workshop on Grand Challenges for Reasoning from Experiences. [44] Sutton, R. S. and Barto, A. G. (1998). Reinforcement Learning. MIT Press, Cambridge, MA. [45] Sutton, R. S., Maei, H. R., Precup, D., Bhatnagar, S., Silver, D., Szepesvári, C., and Wiewiora, E.\n(2009). Fast gradient-descent methods for temporal-difference learning with linear function approximation. In The 26th International Conference on Machine Learning (ICML). [46] Sutton, R. S., Mahmood, A. R., and White, M. (2016). An emphatic approach to the problem of off-policy temporal-difference learning. Journal of Machine Learning Research, 17(73):1–29. [47] Sutton, R. S., Szepesvári, C., and Maei, H. (2008). A convergent O(n) algorithm for off-policy temporaldifference learning with linear function approximation. In Advances in Neural Information Processing Systems (NIPS) 21. [48] Tsitsiklis, J. N. and Van Roy, B. (1997). An analysis of temporal-difference learning with function approximation. IEEE Transactions on Automatic Control, 42(5):674–690. [49] Ueno, T., Maeda, S., Kawanabe, M., and Ishii, S. (2011). Generalized TD learning. Journal of Machine Learning Research, 12:1977–2020. [50] Yao, H. S. and Liu, Z. Q. (2008). Preconditioned temporal difference learning. In The 25th International Conference on Machine Learning (ICML). [51] Yu, H. (2012). Least squares temporal difference methods: An analysis under general conditions. SIAM Journal on Control and Optimization, 50:3310–3343. [52] Yu, H. (2015). On convergence of emphatic temporal-difference learning. http://arxiv.org/abs/1506.02582; a shorter version appeared in The 28th Annual Conference on Learning Theory (COLT), 2015. [53] Yu, H. (2016). Some simulation results for emphatic temporal-difference learning algorithms. http://arxiv.org/abs/1605.02099. [54] Yu, H. and Bertsekas, D. P. (2010). Error bounds for approximations from projected linear equations. Mathematics of Operations Research, 35(2):306–329. [55] Yu, H. and Bertsekas, D. P. (2012). Weighted Bellman equations and their applications in approximate dynamic programming. LIDS Technical Report 2876, MIT."
    }, {
      "heading" : "52 Weak Convergence Properties of Constrained ETD Learning",
      "text" : ""
    }, {
      "heading" : "Appendix A: Key Properties of Trace Iterates",
      "text" : "In this appendix we list four key properties of trace iterates {(et, Ft)} generated by the ETD(λ) algorithm. Three of them were derived in [52, Appendix A], and used in the convergence analysis of ETD(λ) in both [52] and the present paper.\nAs discussed in Section 3.2, {(et, Ft)} can have unbounded variances and is naturally unbounded in common off-policy situations. However, as the proposition below shows, {(et, Ft)} is bounded in a stochastic sense.\nProposition A.1. Under Assumption 2.1, given a bounded set E ⊂ Rn+1, there exists a constant L < ∞ such that if the initial (e0, F0) ∈ E, then supt≥0 E [ ∥ ∥(et, Ft) ∥ ∥ ] < L.\nThe preceding proposition is the same as [52, Prop. A.1] except that the conclusion is for all the initial (e0, F0) from the set E, instead of a fixed initial (e0, F0). By making explicit the dependence of the constant L on the initial (e0, F0), the same proof of [52, Prop. A.1] (which is a relatively straightforward calculation) applies to the preceding proposition.\nWe note that Prop. A.1 does not imply the uniform integrability of {(et, Ft)}—this stronger property does hold for the trace iterates, as we proved in Prop. 4.2(i). (The latter and its proof focus on {et} only, but the same argument applies to {(et, Ft)}.)\nThe next proposition concerns the change in the trace iterates due to the change in its initial condition. It is the same as [52, Prop. A.2]; its proof is more involved than the proofs of the two other properties of the trace iterates and uses, among others, a theorem for nonnegative random processes [32]. We did not use this proposition directly in the analysis of the present paper, but it is important in establishing that the Markov chain {Zt} has a unique invariant probability measure (Theorem 2.2), which the results of the present paper rely on. In addition, it is helpful for understanding the behavior of the trace iterates.\nLet (êt, F̂t), t ≥ 1, be defined by the same recursion (2.3)-(2.5) that defines (et, Ft), using the same state and action random variables {(St, At)}, but with a different initial condition (ê0, F̂0). We write a zero vector in any Euclidean space as 0.\nProposition A.2. Under Assumption 2.1, for any two given initial conditions (e0, F0) and (ê0, F̂0),\nFt − F̂t a.s.→ 0, et − êt a.s.→ 0.\nThe third proposition below concerns approximating the trace iterates (et, Ft) by truncated traces that depend on a fixed number of the most recent states and actions only. First, let us express the traces (et, Ft), by using their definitions (cf. Eqs. (2.3)-(2.5)), as\nFt = F0 · ( ρ0γ1 · · · ρt−1γt ) +\nt ∑\nk=1\ni(Sk) · ( ρkγk+1 · · · ρt−1γt ) , (A.1)\net = e0 · ( β1 · · ·βt ) + t ∑\nk=1\nMk · φ(Sk) · ( βk+1 · · ·βt ) , (A.2)\nwhere βk = ρk−1γkλk and\nMk = λk i(Sk) + (1− λk)Fk.\nFor each integer K ≥ 1, the truncated traces (ẽt,K , F̃t,K) are defined by limiting the summations in (A.1)-(A.2) to be over K + 1 terms only as follows:\n(ẽt,K , F̃t,K) = (et, Ft) for t ≤ K,\n53\nand for t ≥ K + 1,\nF̃t,K = t ∑\nk=t−K\ni(Sk) · ( ρkγk+1 · · · ρt−1γt ) , (A.3)\nM̃t,K = λt i(St) + (1− λt)F̃t,K , (A.4)\nẽt,K =\nt ∑\nk=t−K\nM̃k,K · φ(Sk) · ( βk+1 · · ·βt ) . (A.5)\nWe have the following approximation property for truncated traces, in which the notation “LK ↓ 0” means that LK decreases monotonically to 0 as K → ∞.\nProposition A.3. Let Assumption 2.1 hold. Given a bounded set E ⊂ Rn+1, there exist constants LK ,K ≥ 1, with LK ↓ 0 as K → ∞, such that if the initial (e0, F0) ∈ E, then\nsup t≥0 E\n[\n∥ ∥(et, Ft)− (ẽt,K , F̃t,K) ∥ ∥\n]\n≤ LK .\nThe preceding proposition is the same as [52, Prop. A.3(i)], except that the initial (e0, F0) can be from a bounded set E instead of being fixed. The proof given in [52] applies here as well, similar to the case of Prop. A.1. This proposition about truncated traces was used in [52] to obtain the convergence in mean given in Theorem 2.3 and allowed us to work with simple finite-space Markov chains, instead of working with the infinite-space Markov chain {Zt} directly, in that proof. In the present paper, it has expedited our proofs of Props. 4.2, 4.3 regarding the uniform integrability and convergence in mean conditions for constrained ETD(λ).\nFinally, the uniform integrability of {(et, Ft)} (proved in Prop. 4.2(i) in this paper, as already mentioned) is important both for convergence analysis and for understanding the behavior of the trace iterates."
    } ],
    "references" : [ {
      "title" : "Adaptive importance sampling technique for Markov chains using stochastic approximation. Operations Research, 54:489–504",
      "author" : [ "T.P. Ahamed", "V.S. Borkar", "S. Juneja" ],
      "venue" : "Weak Convergence Properties of Constrained ETD Learning",
      "citeRegEx" : "1",
      "shortCiteRegEx" : "1",
      "year" : 2006
    }, {
      "title" : "Learning near-optimal policies with Bellman residual minimization based fitted policy iteration and a single sample path",
      "author" : [ "A. Antos", "C. Szepesv́ari", "R. Munos" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "2",
      "shortCiteRegEx" : "2",
      "year" : 2008
    }, {
      "title" : "Residual algorithms: Reinforcement learning with function approximation",
      "author" : [ "L.C. Baird" ],
      "venue" : "In The 12th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "3",
      "shortCiteRegEx" : "3",
      "year" : 1995
    }, {
      "title" : "Projected equation methods for approximate solution of large linear systems",
      "author" : [ "D.P. Bertsekas", "H. Yu" ],
      "venue" : "Journal of Computational and Applied Mathematics,",
      "citeRegEx" : "5",
      "shortCiteRegEx" : "5",
      "year" : 2009
    }, {
      "title" : "Convergence of Probability Measures",
      "author" : [ "P. Billingsley" ],
      "venue" : null,
      "citeRegEx" : "6",
      "shortCiteRegEx" : "6",
      "year" : 1968
    }, {
      "title" : "Stochastic Approximation: A Dynamic Viewpoint",
      "author" : [ "V.S. Borkar" ],
      "venue" : null,
      "citeRegEx" : "7",
      "shortCiteRegEx" : "7",
      "year" : 2008
    }, {
      "title" : "Least-squares temporal difference learning",
      "author" : [ "J.A. Boyan" ],
      "venue" : "In The 16th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "8",
      "shortCiteRegEx" : "8",
      "year" : 1999
    }, {
      "title" : "Linear least-squares algorithms for temporal difference learning",
      "author" : [ "S.J. Bradtke", "A.G. Barto" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "9",
      "shortCiteRegEx" : "9",
      "year" : 1996
    }, {
      "title" : "Policy evaluation with temporal differences: A survey and comparison",
      "author" : [ "C. Dann", "G. Neumann", "J. Peters" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "10",
      "shortCiteRegEx" : "10",
      "year" : 2014
    }, {
      "title" : "Stochastic Processes",
      "author" : [ "J.L. Doob" ],
      "venue" : null,
      "citeRegEx" : "11",
      "shortCiteRegEx" : "11",
      "year" : 1953
    }, {
      "title" : "Real Analysis and Probability",
      "author" : [ "R.M. Dudley" ],
      "venue" : null,
      "citeRegEx" : "12",
      "shortCiteRegEx" : "12",
      "year" : 2002
    }, {
      "title" : "Off-policy learning with eligibility traces: A survey",
      "author" : [ "M. Geist", "B. Scherrer" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "13",
      "shortCiteRegEx" : "13",
      "year" : 2014
    }, {
      "title" : "Importance sampling for stochastic simulations",
      "author" : [ "P.W. Glynn", "D.L. Iglehart" ],
      "venue" : "Management Science,",
      "citeRegEx" : "14",
      "shortCiteRegEx" : "14",
      "year" : 1989
    }, {
      "title" : "Generalized emphatic temporal difference learning: Bias-variance analysis",
      "author" : [ "A. Hallak", "A. Tamar", "R. Munos", "S. Mannor" ],
      "venue" : "In The 30th AAAI Conference on Artificial Intelligence",
      "citeRegEx" : "15",
      "shortCiteRegEx" : "15",
      "year" : 2016
    }, {
      "title" : "Actor-Critic Algorithms",
      "author" : [ "V.R. Konda" ],
      "venue" : "PhD thesis,",
      "citeRegEx" : "16",
      "shortCiteRegEx" : "16",
      "year" : 2002
    }, {
      "title" : "Stochastic Approximation Methods for Constrained and Unconstrained Systems",
      "author" : [ "H.J. Kushner", "D.S. Clark" ],
      "venue" : null,
      "citeRegEx" : "17",
      "shortCiteRegEx" : "17",
      "year" : 1978
    }, {
      "title" : "Weak convergence and asymptotic properties of adaptive filters with constant gains",
      "author" : [ "H.J. Kushner", "A. Shwartz" ],
      "venue" : "IEEE Transactions on Information",
      "citeRegEx" : "18",
      "shortCiteRegEx" : "18",
      "year" : 1984
    }, {
      "title" : "Stochastic Approximation and Recursive Algorithms and Applications",
      "author" : [ "H.J. Kushner", "G.G. Yin" ],
      "venue" : null,
      "citeRegEx" : "19",
      "shortCiteRegEx" : "19",
      "year" : 2003
    }, {
      "title" : "Finite-sample analysis of least-squares policy iteration",
      "author" : [ "A. Lazaric", "M. Ghavamzadeh", "R. Munos" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "20",
      "shortCiteRegEx" : "20",
      "year" : 2012
    }, {
      "title" : "Finite-sample analysis of proximal gradient TD algorithms",
      "author" : [ "B. Liu", "J. Liu", "M. Ghavamzadeh", "S. Mahadevan", "M. Petrik" ],
      "venue" : "In The 31st Conference on Uncertainty in Artificial Intelligence (UAI)",
      "citeRegEx" : "21",
      "shortCiteRegEx" : "21",
      "year" : 2015
    }, {
      "title" : "Regularized off-policy TD-learning",
      "author" : [ "B. Liu", "S. Mahadevan", "J. Liu" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS)",
      "citeRegEx" : "22",
      "shortCiteRegEx" : "22",
      "year" : 2009
    }, {
      "title" : "Gradient Temporal-Difference Learning Algorithms. PhD thesis, University of Alberta",
      "author" : [ "H.R. Maei" ],
      "venue" : null,
      "citeRegEx" : "23",
      "shortCiteRegEx" : "23",
      "year" : 2011
    }, {
      "title" : "Sparse Q-learning with mirror descent",
      "author" : [ "S. Mahadevan", "B. Liu" ],
      "venue" : "In The 28th Conference on Uncertainty in Artificial Intelligence (UAI)",
      "citeRegEx" : "24",
      "shortCiteRegEx" : "24",
      "year" : 2012
    }, {
      "title" : "Proximal reinforcement learning: A new theory of sequential decision making in primal-dual spaces. arXiv:1405.6757",
      "author" : [ "S. Mahadevan", "B. Liu", "P. Thomas", "W. Dabney", "S. Giguere", "N. Jacek", "I. Gemp", "J. Liu" ],
      "venue" : null,
      "citeRegEx" : "25",
      "shortCiteRegEx" : "25",
      "year" : 2014
    }, {
      "title" : "Off-policy learning based on weighted importance sampling with linear computational complexity",
      "author" : [ "A.R. Mahmood", "R.S. Sutton" ],
      "venue" : "In The 31st Conference on Uncertainty in Artificial Intelligence (UAI)",
      "citeRegEx" : "26",
      "shortCiteRegEx" : "26",
      "year" : 2015
    }, {
      "title" : "Weighted importance sampling for offpolicy learning with linear function approximation",
      "author" : [ "A.R. Mahmood", "H. van Hasselt", "R.S. Sutton" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS)",
      "citeRegEx" : "27",
      "shortCiteRegEx" : "27",
      "year" : 2014
    }, {
      "title" : "Emphatic temporal-difference learning",
      "author" : [ "A.R. Mahmood", "H. Yu", "M. White", "R.S. Sutton" ],
      "venue" : "In European Workshops on Reinforcement Learning (EWRL)",
      "citeRegEx" : "28",
      "shortCiteRegEx" : "28",
      "year" : 2015
    }, {
      "title" : "Ergodic theorems for discrete time stochastic systems using a stochastic Lyapunov function",
      "author" : [ "S. Meyn" ],
      "venue" : "SIAM Journal on Control and Optimization,",
      "citeRegEx" : "29",
      "shortCiteRegEx" : "29",
      "year" : 1989
    }, {
      "title" : "Markov Chains and Stochastic Stability",
      "author" : [ "S. Meyn", "R.L. Tweedie" ],
      "venue" : null,
      "citeRegEx" : "30",
      "shortCiteRegEx" : "30",
      "year" : 2009
    }, {
      "title" : "Finite time bounds for fitted value iteration",
      "author" : [ "R. Munos", "C. Szepesv́ari" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "31",
      "shortCiteRegEx" : "31",
      "year" : 2008
    }, {
      "title" : "Discrete-Parameter Martingales",
      "author" : [ "J. Neveu" ],
      "venue" : null,
      "citeRegEx" : "32",
      "shortCiteRegEx" : "32",
      "year" : 1975
    }, {
      "title" : "Statistical linear estimation with penalized estimators: An application to reinforcement learning",
      "author" : [ "B.A. Pires", "C. Szepesv́ari" ],
      "venue" : "In The 29th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "33",
      "shortCiteRegEx" : "33",
      "year" : 2012
    }, {
      "title" : "Acceleration of stochastic approximation by averaging",
      "author" : [ "B.T. Polyak", "A.B. Juditsky" ],
      "venue" : "SIAM Journal on Control and Optimization,",
      "citeRegEx" : "34",
      "shortCiteRegEx" : "34",
      "year" : 1992
    }, {
      "title" : "Off-policy temporal-difference learning with function approximation",
      "author" : [ "D. Precup", "R.S. Sutton", "S. Dasgupta" ],
      "venue" : "In The 18th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "35",
      "shortCiteRegEx" : "35",
      "year" : 2001
    }, {
      "title" : "Eligibility traces for off-policy policy evaluation",
      "author" : [ "D. Precup", "R.S. Sutton", "S. Singh" ],
      "venue" : "In The 17th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "36",
      "shortCiteRegEx" : "36",
      "year" : 2000
    }, {
      "title" : "Markov Decision Processes: Discrete Stochastic Dynamic Programming",
      "author" : [ "M.L. Puterman" ],
      "venue" : null,
      "citeRegEx" : "37",
      "shortCiteRegEx" : "37",
      "year" : 1994
    }, {
      "title" : "Combining importance sampling and temporal difference control variates to simulate Markov chains",
      "author" : [ "R.S. Randhawa", "S. Juneja" ],
      "venue" : "ACM Transactions on Modeling and Computer Simulation,",
      "citeRegEx" : "38",
      "shortCiteRegEx" : "38",
      "year" : 2004
    }, {
      "title" : "Iterative Methods for Sparse Linear Systems",
      "author" : [ "Y. Saad" ],
      "venue" : "SIAM, Philadelphia,",
      "citeRegEx" : "39",
      "shortCiteRegEx" : "39",
      "year" : 2003
    }, {
      "title" : "Should one compute the temporal difference fix point or minimize the Bellman residual? The unified oblique projection view",
      "author" : [ "B. Scherrer" ],
      "venue" : "In The 27th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "40",
      "shortCiteRegEx" : "40",
      "year" : 2010
    }, {
      "title" : "Learning to predict by the methods of temporal differences",
      "author" : [ "R.S. Sutton" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "41",
      "shortCiteRegEx" : "41",
      "year" : 1988
    }, {
      "title" : "TD models: Modeling the world at a mixture of time scales",
      "author" : [ "R.S. Sutton" ],
      "venue" : "In The 12th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "42",
      "shortCiteRegEx" : "42",
      "year" : 1995
    }, {
      "title" : "The grand challenge of predictive empirical abstract knowledge",
      "author" : [ "R.S. Sutton" ],
      "venue" : "In IJCAI Workshop on Grand Challenges for Reasoning from Experiences",
      "citeRegEx" : "43",
      "shortCiteRegEx" : "43",
      "year" : 2009
    }, {
      "title" : "Reinforcement Learning",
      "author" : [ "R.S. Sutton", "A.G. Barto" ],
      "venue" : null,
      "citeRegEx" : "44",
      "shortCiteRegEx" : "44",
      "year" : 1998
    }, {
      "title" : "Fast gradient-descent methods for temporal-difference learning with linear function approximation",
      "author" : [ "R.S. Sutton", "H.R. Maei", "D. Precup", "S. Bhatnagar", "D. Silver", "C. Szepesvári", "E. Wiewiora" ],
      "venue" : "In The 26th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "45",
      "shortCiteRegEx" : "45",
      "year" : 2009
    }, {
      "title" : "An emphatic approach to the problem of off-policy temporal-difference learning",
      "author" : [ "R.S. Sutton", "A.R. Mahmood", "M. White" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "46",
      "shortCiteRegEx" : "46",
      "year" : 2016
    }, {
      "title" : "A convergent O(n) algorithm for off-policy temporaldifference learning with linear function approximation",
      "author" : [ "R.S. Sutton", "C. Szepesvári", "H. Maei" ],
      "venue" : "In Advances in Neural Information Processing Systems (NIPS)",
      "citeRegEx" : "47",
      "shortCiteRegEx" : "47",
      "year" : 2008
    }, {
      "title" : "An analysis of temporal-difference learning with function approximation",
      "author" : [ "J.N. Tsitsiklis", "B. Van Roy" ],
      "venue" : "IEEE Transactions on Automatic Control,",
      "citeRegEx" : "48",
      "shortCiteRegEx" : "48",
      "year" : 1997
    }, {
      "title" : "Generalized TD learning",
      "author" : [ "T. Ueno", "S. Maeda", "M. Kawanabe", "S. Ishii" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "49",
      "shortCiteRegEx" : "49",
      "year" : 2011
    }, {
      "title" : "Preconditioned temporal difference learning",
      "author" : [ "H.S. Yao", "Z.Q. Liu" ],
      "venue" : "In The 25th International Conference on Machine Learning (ICML)",
      "citeRegEx" : "50",
      "shortCiteRegEx" : "50",
      "year" : 2008
    }, {
      "title" : "Least squares temporal difference methods: An analysis under general conditions",
      "author" : [ "H. Yu" ],
      "venue" : "SIAM Journal on Control and Optimization,",
      "citeRegEx" : "51",
      "shortCiteRegEx" : "51",
      "year" : 2012
    }, {
      "title" : "On convergence of emphatic temporal-difference learning. http://arxiv.org/abs/1506.02582; a shorter version appeared in The 28th",
      "author" : [ "H. Yu" ],
      "venue" : "Annual Conference on Learning Theory (COLT),",
      "citeRegEx" : "52",
      "shortCiteRegEx" : "52",
      "year" : 2015
    }, {
      "title" : "Some simulation results for emphatic temporal-difference learning algorithms. http://arxiv.org/abs/1605.02099",
      "author" : [ "H. Yu" ],
      "venue" : null,
      "citeRegEx" : "53",
      "shortCiteRegEx" : "53",
      "year" : 2016
    }, {
      "title" : "Error bounds for approximations from projected linear equations",
      "author" : [ "H. Yu", "D.P. Bertsekas" ],
      "venue" : "Mathematics of Operations Research,",
      "citeRegEx" : "54",
      "shortCiteRegEx" : "54",
      "year" : 2010
    } ],
    "referenceMentions" : [ {
      "referenceID" : 44,
      "context" : "The ETD(λ) algorithm was recently proposed by Sutton, Mahmood, and White [46] to solve a long-standing divergence problem of the standard TD algorithm when it is applied to off-policy training, where data from an exploratory policy are used to evaluate other policies of interest.",
      "startOffset" : 73,
      "endOffset" : 77
    }, {
      "referenceID" : 39,
      "context" : ", [41, 48] and the books [4, 44]).",
      "startOffset" : 2,
      "endOffset" : 10
    }, {
      "referenceID" : 46,
      "context" : ", [41, 48] and the books [4, 44]).",
      "startOffset" : 2,
      "endOffset" : 10
    }, {
      "referenceID" : 42,
      "context" : ", [41, 48] and the books [4, 44]).",
      "startOffset" : 25,
      "endOffset" : 32
    }, {
      "referenceID" : 41,
      "context" : "In addition, insofar as value functions (with respect to different reward/cost assignments) reflect statistical properties of future outcomes, off-policy learning can be used by an autonomous agent to build an experience-based internal model of the world in artificial intelligence applications [43].",
      "startOffset" : 295,
      "endOffset" : 299
    }, {
      "referenceID" : 44,
      "context" : "In this paper we focus on a new off-policy learning algorithm proposed recently by Sutton, Mahmood, and White [46]: the emphatic temporal-difference (TD) learning algorithm, or ETD(λ).",
      "startOffset" : 110,
      "endOffset" : 114
    }, {
      "referenceID" : 39,
      "context" : "The algorithm is similar to the standard TD(λ) algorithm with linear function approximation [41], but uses a novel scheme to resolve a long-standing divergence problem in TD(λ) when applied to off-policy data.",
      "startOffset" : 92,
      "endOffset" : 96
    }, {
      "referenceID" : 46,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 92,
      "endOffset" : 96
    }, {
      "referenceID" : 2,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 169,
      "endOffset" : 176
    }, {
      "referenceID" : 46,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 169,
      "endOffset" : 176
    }, {
      "referenceID" : 42,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 222,
      "endOffset" : 229
    }, {
      "referenceID" : 44,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 251,
      "endOffset" : 259
    }, {
      "referenceID" : 26,
      "context" : "Regarding the divergence problem, while TD(λ) was proved to converge for the on-policy case [48], it was known quite early that the algorithm can diverge in other cases [3, 48] (for related discussions, see also the books [4, 44] and the recent works [46, 28]).",
      "startOffset" : 251,
      "endOffset" : 259
    }, {
      "referenceID" : 3,
      "context" : "In particular, in the off-policy LSTD(λ) algorithm [5, 51] (an extension of the on-policy least-squares version of TD(λ), called LSTD(λ) [9, 8]), with higher computational complexity than TD(λ), the linear equation associated with TD(λ) is estimated from data and then solved.",
      "startOffset" : 51,
      "endOffset" : 58
    }, {
      "referenceID" : 49,
      "context" : "In particular, in the off-policy LSTD(λ) algorithm [5, 51] (an extension of the on-policy least-squares version of TD(λ), called LSTD(λ) [9, 8]), with higher computational complexity than TD(λ), the linear equation associated with TD(λ) is estimated from data and then solved.",
      "startOffset" : 51,
      "endOffset" : 58
    }, {
      "referenceID" : 7,
      "context" : "In particular, in the off-policy LSTD(λ) algorithm [5, 51] (an extension of the on-policy least-squares version of TD(λ), called LSTD(λ) [9, 8]), with higher computational complexity than TD(λ), the linear equation associated with TD(λ) is estimated from data and then solved.",
      "startOffset" : 137,
      "endOffset" : 143
    }, {
      "referenceID" : 6,
      "context" : "In particular, in the off-policy LSTD(λ) algorithm [5, 51] (an extension of the on-policy least-squares version of TD(λ), called LSTD(λ) [9, 8]), with higher computational complexity than TD(λ), the linear equation associated with TD(λ) is estimated from data and then solved.",
      "startOffset" : 137,
      "endOffset" : 143
    }, {
      "referenceID" : 45,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 30,
      "endOffset" : 42
    }, {
      "referenceID" : 43,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 30,
      "endOffset" : 42
    }, {
      "referenceID" : 21,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 30,
      "endOffset" : 42
    }, {
      "referenceID" : 20,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 83,
      "endOffset" : 91
    }, {
      "referenceID" : 22,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 83,
      "endOffset" : 91
    }, {
      "referenceID" : 19,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 102,
      "endOffset" : 110
    }, {
      "referenceID" : 23,
      "context" : "In the gradient-TD algorithms [47, 45, 23] and the proximal gradient-TD algorithms [22, 24] (see also [21, 25]), the difficulty in TD(λ) is overcome by reformulating the approximate policy evaluation problem TD(λ) attempts to solve as optimization problems and then tackle them with optimization techniques.",
      "startOffset" : 102,
      "endOffset" : 110
    }, {
      "referenceID" : 11,
      "context" : "(See the surveys [13, 10] for other algorithm examples.",
      "startOffset" : 17,
      "endOffset" : 25
    }, {
      "referenceID" : 8,
      "context" : "(See the surveys [13, 10] for other algorithm examples.",
      "startOffset" : 17,
      "endOffset" : 25
    }, {
      "referenceID" : 44,
      "context" : "An important result of this weighting scheme is that under natural conditions on the function approximation architecture, the average dynamics of ETD(λ) can be described by an affine function involving a negative definite matrix [46, 52], which provides a desired stability property, similar to the case of convergent on-policy TD algorithms.",
      "startOffset" : 229,
      "endOffset" : 237
    }, {
      "referenceID" : 50,
      "context" : "An important result of this weighting scheme is that under natural conditions on the function approximation architecture, the average dynamics of ETD(λ) can be described by an affine function involving a negative definite matrix [46, 52], which provides a desired stability property, similar to the case of convergent on-policy TD algorithms.",
      "startOffset" : 229,
      "endOffset" : 237
    }, {
      "referenceID" : 50,
      "context" : "The almost sure convergence of ETD(λ), under general off-policy training conditions, has been shown in our recent work [52] for diminishing stepsize.",
      "startOffset" : 119,
      "endOffset" : 123
    }, {
      "referenceID" : 48,
      "context" : "An efficient algorithm for solving the estimated equations is the one given in [50] based on the line search method.",
      "startOffset" : 79,
      "endOffset" : 83
    }, {
      "referenceID" : 31,
      "context" : "It can also be applied to finding approximate solutions under additional penalty terms suggested by [33].",
      "startOffset" : 100,
      "endOffset" : 104
    }, {
      "referenceID" : 44,
      "context" : "The papers [46, 28] work with the negation of the matrix that we associate with ETD(λ) in this paper.",
      "startOffset" : 11,
      "endOffset" : 19
    }, {
      "referenceID" : 26,
      "context" : "The papers [46, 28] work with the negation of the matrix that we associate with ETD(λ) in this paper.",
      "startOffset" : 11,
      "endOffset" : 19
    }, {
      "referenceID" : 44,
      "context" : "The negative definiteness property we discuss here corresponds to the positive definiteness property discussed in [46, 28].",
      "startOffset" : 114,
      "endOffset" : 122
    }, {
      "referenceID" : 26,
      "context" : "The negative definiteness property we discuss here corresponds to the positive definiteness property discussed in [46, 28].",
      "startOffset" : 114,
      "endOffset" : 122
    }, {
      "referenceID" : 15,
      "context" : "The first group of results are derived by combining key properties of ETD(λ) with powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 181,
      "endOffset" : 193
    }, {
      "referenceID" : 16,
      "context" : "The first group of results are derived by combining key properties of ETD(λ) with powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 181,
      "endOffset" : 193
    }, {
      "referenceID" : 17,
      "context" : "The first group of results are derived by combining key properties of ETD(λ) with powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 181,
      "endOffset" : 193
    }, {
      "referenceID" : 15,
      "context" : "To derive the first group of results, we use powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 144,
      "endOffset" : 156
    }, {
      "referenceID" : 16,
      "context" : "To derive the first group of results, we use powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 144,
      "endOffset" : 156
    }, {
      "referenceID" : 17,
      "context" : "To derive the first group of results, we use powerful convergence theorems from the weak convergence methods in stochastic approximation theory [17, 18, 19].",
      "startOffset" : 144,
      "endOffset" : 156
    }, {
      "referenceID" : 50,
      "context" : "Some of these properties were established earlier in our work [52] when analyzing the almost sure convergence of ETD(λ).",
      "startOffset" : 62,
      "endOffset" : 66
    }, {
      "referenceID" : 27,
      "context" : "We use ergodic theorems for weak Feller Markov chains [29, 30], together with the properties of ETD(λ) iterates and the convergence results we get from the weak convergence methods, in this second part of our analysis.",
      "startOffset" : 54,
      "endOffset" : 62
    }, {
      "referenceID" : 28,
      "context" : "We use ergodic theorems for weak Feller Markov chains [29, 30], together with the properties of ETD(λ) iterates and the convergence results we get from the weak convergence methods, in this second part of our analysis.",
      "startOffset" : 54,
      "endOffset" : 62
    }, {
      "referenceID" : 13,
      "context" : "[15].",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 17,
      "context" : "(This is not a surprise, for the biased algorithms are in fact defined by using a well-known robustifying approach from stochastic approximation theory [19].",
      "startOffset" : 152,
      "endOffset" : 156
    }, {
      "referenceID" : 26,
      "context" : ") Their behavior is demonstrated by experiments in [28, 53].",
      "startOffset" : 51,
      "endOffset" : 59
    }, {
      "referenceID" : 51,
      "context" : ") Their behavior is demonstrated by experiments in [28, 53].",
      "startOffset" : 51,
      "endOffset" : 59
    }, {
      "referenceID" : 51,
      "context" : "In particular, [53] is our companion note for this paper and includes several simulation results to illustrate some of the theorems we give here regarding the behavior of multiple consecutive iterates of the biased algorithms.",
      "startOffset" : 15,
      "endOffset" : 19
    }, {
      "referenceID" : 50,
      "context" : "2 Preliminaries In this section we describe the policy evaluation problem in the off-policy case, the ETD(λ) algorithm and its constrained version, and we also review the results from our prior work [52] that are needed in this paper.",
      "startOffset" : 199,
      "endOffset" : 203
    }, {
      "referenceID" : 0,
      "context" : "Let γ(s) ∈ [0, 1], s ∈ S, be state-dependent discount factors, with γ(s) < 1 for at least one state.",
      "startOffset" : 11,
      "endOffset" : 17
    }, {
      "referenceID" : 39,
      "context" : "2 The ETD(λ) Algorithm Like the standard TD(λ) algorithm [41, 48], the ETD(λ) algorithm [46] approximates the value function vπ by a function of the form v(s) = φ(s) θ, s ∈ S, using a parameter vector θ ∈ R and n-dimensional feature representations φ(s) for the states.",
      "startOffset" : 57,
      "endOffset" : 65
    }, {
      "referenceID" : 46,
      "context" : "2 The ETD(λ) Algorithm Like the standard TD(λ) algorithm [41, 48], the ETD(λ) algorithm [46] approximates the value function vπ by a function of the form v(s) = φ(s) θ, s ∈ S, using a parameter vector θ ∈ R and n-dimensional feature representations φ(s) for the states.",
      "startOffset" : 57,
      "endOffset" : 65
    }, {
      "referenceID" : 44,
      "context" : "2 The ETD(λ) Algorithm Like the standard TD(λ) algorithm [41, 48], the ETD(λ) algorithm [46] approximates the value function vπ by a function of the form v(s) = φ(s) θ, s ∈ S, using a parameter vector θ ∈ R and n-dimensional feature representations φ(s) for the states.",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 35,
      "context" : ", [37]).",
      "startOffset" : 2,
      "endOffset" : 6
    }, {
      "referenceID" : 0,
      "context" : "We focus on a general form of the ETD(λ) algorithm, which uses state-dependent λ values specified by a function λ : S → [0, 1].",
      "startOffset" : 120,
      "endOffset" : 126
    }, {
      "referenceID" : 0,
      "context" : "The algorithm can access the following functions, in addition to the features φ(s): (i) the state-dependent discount factor γ(s) that defines vπ , as described earlier; (ii) λ : S → [0, 1], which determines the single or multi-step Bellman equation for the algorithm (cf.",
      "startOffset" : 182,
      "endOffset" : 188
    }, {
      "referenceID" : 40,
      "context" : "Associated with ETD(λ) is a generalized multistep Bellman equation of which vπ is the unique solution [42]: 6 v = r π,γ + P λ π,γ v.",
      "startOffset" : 102,
      "endOffset" : 106
    }, {
      "referenceID" : 44,
      "context" : "5) we use here differs slightly from the original definition of et in [46], but the two are equivalent and (2.",
      "startOffset" : 70,
      "endOffset" : 74
    }, {
      "referenceID" : 40,
      "context" : "For the details of this Bellman equation, we refer the readers to the early work [42, 44] and the recent work [46].",
      "startOffset" : 81,
      "endOffset" : 89
    }, {
      "referenceID" : 42,
      "context" : "For the details of this Bellman equation, we refer the readers to the early work [42, 44] and the recent work [46].",
      "startOffset" : 81,
      "endOffset" : 89
    }, {
      "referenceID" : 44,
      "context" : "For the details of this Bellman equation, we refer the readers to the early work [42, 44] and the recent work [46].",
      "startOffset" : 110,
      "endOffset" : 114
    }, {
      "referenceID" : 40,
      "context" : "Earlier works on using such equations in TD learning include [42] and [4, Chap.",
      "startOffset" : 61,
      "endOffset" : 65
    }, {
      "referenceID" : 47,
      "context" : "The recent work [49] considers an even broader class of Bellman equations using the concept",
      "startOffset" : 16,
      "endOffset" : 20
    }, {
      "referenceID" : 44,
      "context" : "6) [46], which takes the following forms in the space of approximate value functions and in the space of the θ-parameters, respectively: v = Π ( r π,γ + P λ π,γ v ) , v ∈ column-space(Φ), ⇐⇒ Cθ + b = 0, θ ∈ R.",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 46,
      "context" : "9), the diagonal matrix M̄ is determined by the steady state probabilities of the states under the target policy π under an ergodicity assumption [48], and for off-policy TD(λ), it is determined by the steady state probabilities dπo(s) under the behavior policy π .",
      "startOffset" : 146,
      "endOffset" : 150
    }, {
      "referenceID" : 44,
      "context" : "A salient property of ETD(λ) is that the matrix C is always negative semidefinite [46], and under natural and mild conditions, C is negative definite.",
      "startOffset" : 82,
      "endOffset" : 86
    }, {
      "referenceID" : 50,
      "context" : "This is proved in [52] and summarized below.",
      "startOffset" : 18,
      "endOffset" : 22
    }, {
      "referenceID" : 38,
      "context" : "The relation between the approximate value function v = Φθ and the desired value function vπ, in particular, the approximation error, can be characterized by using the oblique projection viewpoint [40] for projected Bellman equations.",
      "startOffset" : 197,
      "endOffset" : 201
    }, {
      "referenceID" : 38,
      "context" : "Briefly speaking, [40] showed that the solutions of projected Bellman equations are oblique projections of vπ on the approximation subspace.",
      "startOffset" : 18,
      "endOffset" : 22
    }, {
      "referenceID" : 37,
      "context" : "An oblique projection is defined by two nonorthogonal subspaces of equal dimensions and is the projection onto the first subspace orthogonally to the second [39].",
      "startOffset" : 157,
      "endOffset" : 161
    }, {
      "referenceID" : 13,
      "context" : ") Recently, for the case of constant λ, i and γ, [15] derived bounds on the approximation bias that are based on contraction arguments and are comparable to the bound for on-policy TD(λ) [48].",
      "startOffset" : 49,
      "endOffset" : 53
    }, {
      "referenceID" : 46,
      "context" : ") Recently, for the case of constant λ, i and γ, [15] derived bounds on the approximation bias that are based on contraction arguments and are comparable to the bound for on-policy TD(λ) [48].",
      "startOffset" : 187,
      "endOffset" : 191
    }, {
      "referenceID" : 52,
      "context" : "[54] and [55, Sec.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 50,
      "context" : "To prepare for the analysis, in the rest of this section, we review several results from [52] that will be needed.",
      "startOffset" : 89,
      "endOffset" : 93
    }, {
      "referenceID" : 17,
      "context" : "Then applying powerful convergence theorems from the stochastic approximation theory [19], we can assert that the iterates θt will eventually “follow closely” a solution of the mean ODE.",
      "startOffset" : 85,
      "endOffset" : 89
    }, {
      "referenceID" : 50,
      "context" : "It is shown in [52] that under Assumption 2.",
      "startOffset" : 15,
      "endOffset" : 19
    }, {
      "referenceID" : 50,
      "context" : "It was proved in [52] as a special case of the convergence of averaged sequences for a larger set of functions including h(θ, ·).",
      "startOffset" : 17,
      "endOffset" : 21
    }, {
      "referenceID" : 50,
      "context" : "The convergence of the averaged sequence 1t ∑t−1 k=0 g(ξk) is given in the theorem below; the part on convergence in mean will be used frequently later in this paper (and was actually also needed in [52] to prove the ergodicity of {Zt} given earlier).",
      "startOffset" : 199,
      "endOffset" : 203
    }, {
      "referenceID" : 17,
      "context" : "These results are obtained through applying two general convergence theorems from [19], which concern weak convergence of stochastic approximation algorithms for diminishing and constant stepsize.",
      "startOffset" : 82,
      "endOffset" : 86
    }, {
      "referenceID" : 15,
      "context" : "(This is the power of the weak convergence methods [17, 18, 19], by which our conclusion is obtained.",
      "startOffset" : 51,
      "endOffset" : 63
    }, {
      "referenceID" : 16,
      "context" : "(This is the power of the weak convergence methods [17, 18, 19], by which our conclusion is obtained.",
      "startOffset" : 51,
      "endOffset" : 63
    }, {
      "referenceID" : 17,
      "context" : "(This is the power of the weak convergence methods [17, 18, 19], by which our conclusion is obtained.",
      "startOffset" : 51,
      "endOffset" : 63
    }, {
      "referenceID" : 17,
      "context" : "The theorems from [19] which we will apply are based on the weak convergence methods.",
      "startOffset" : 18,
      "endOffset" : 22
    }, {
      "referenceID" : 17,
      "context" : "In the framework of [19], one studies a trajectory of iterates produced by an algorithm by working with continuous-time processes that are piecewise constant or linear interpolations of the iterates.",
      "startOffset" : 20,
      "endOffset" : 24
    }, {
      "referenceID" : 27,
      "context" : "Thus we can apply several ergodic theorems for weak Feller Markov chains (Meyn [29], Meyn and Tweedie [30]) to analyze the constant-stepsize case and combine the implications from these theorems with the results we obtained previously using stochastic approximation theory.",
      "startOffset" : 79,
      "endOffset" : 83
    }, {
      "referenceID" : 28,
      "context" : "Thus we can apply several ergodic theorems for weak Feller Markov chains (Meyn [29], Meyn and Tweedie [30]) to analyze the constant-stepsize case and combine the implications from these theorems with the results we obtained previously using stochastic approximation theory.",
      "startOffset" : 102,
      "endOffset" : 106
    }, {
      "referenceID" : 32,
      "context" : "This iterative averaging is also known as “Polyak-averaging” when it is applied to accelerate the convergence of the θ-iterates (see [34], [19, Chap.",
      "startOffset" : 133,
      "endOffset" : 137
    }, {
      "referenceID" : 27,
      "context" : "The uniqueness allows us to invoke a result of Meyn [29] on the convergence We adopt these conditions for simplicity.",
      "startOffset" : 52,
      "endOffset" : 56
    }, {
      "referenceID" : 17,
      "context" : "We will apply two theorems from [19], Theorems 8.",
      "startOffset" : 32,
      "endOffset" : 36
    }, {
      "referenceID" : 50,
      "context" : "Our proofs will rely on many properties of the ETD iterates that we have established in [52] when analyzing the almost sure convergence of the algorithm.",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 17,
      "context" : "This algorithm belongs to the class of stochastic approximation algorithms with “exogenous noises” studied in the book [19]—the term “exogenous noises” reflects the fact that the evolution of {ξt} is not driven by the θ-iterates.",
      "startOffset" : 119,
      "endOffset" : 123
    }, {
      "referenceID" : 17,
      "context" : "1 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "3 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "4 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "5 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "7 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "6 of [19] for the case of constant stepsize), the following conditions are required.",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "1 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "7 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "8 of [19].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "9 of [19], and it is in fact stronger than the latter condition but is satisfied by our algorithms as we will show.",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 50,
      "context" : "The proofs build upon several key properties of the ETD iterates we have established in [52] and recounted in Section 2.",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 0,
      "context" : "For such a Markov chain {Xt} with state space X, let P (·, ·) denote its transition kernel, that is, P : X× B(X) → [0, 1], P (x,D) = Px(X1 ∈ D), ∀x ∈ X, D ∈ B(X), where B(X) denotes the Borel sigma-algebra on X, and Px denotes the probability distribution of {Xt} conditioned on X0 = x.",
      "startOffset" : 115,
      "endOffset" : 121
    }, {
      "referenceID" : 0,
      "context" : "For t ≥ 1, the t-step transition kernel P t(·, ·) : X× B(X) → [0, 1] is given by P (x,D) = Px(Xt ∈ D), ∀x ∈ X, D ∈ B(X), and for t = 0, P 0 is defined as P (x, ·) = δx, the Dirac measure that assigns probability 1 to the point x, for each x ∈ X.",
      "startOffset" : 62,
      "endOffset" : 68
    }, {
      "referenceID" : 27,
      "context" : "1 in [29].",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 27,
      "context" : "It is a result of Meyn [29] and will be needed in our proofs of Theorems 3.",
      "startOffset" : 23,
      "endOffset" : 27
    }, {
      "referenceID" : 0,
      "context" : "For two topological spaces X and Y, a function Q : B(X) ×Y → [0, 1] is a (Borel measurable) stochastic kernel on X given Y, if for each y ∈ Y, Q(· | y) is a probability measure on B(X) and for each D ∈ B(X), Q(D | y) is a Borel measurable function on Y.",
      "startOffset" : 61,
      "endOffset" : 67
    }, {
      "referenceID" : 13,
      "context" : "[15].",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 44,
      "context" : "2 does not hold (in which case C is negative semidefinite [46]).",
      "startOffset" : 58,
      "endOffset" : 62
    }, {
      "referenceID" : 50,
      "context" : "2 in [52] that G has a block-diagonal structure with respect to the partition {J1,J0}, G = [",
      "startOffset" : 5,
      "endOffset" : 9
    }, {
      "referenceID" : 17,
      "context" : "2 when applying the two general convergence theorems from [19], and we used the negative definiteness of C implied by this assumption only near the end of our proofs to get the solution properties of the mean ODE associated with each algorithm.",
      "startOffset" : 58,
      "endOffset" : 62
    }, {
      "referenceID" : 38,
      "context" : "Then for the emphasized states, the relation between the approximate value function Φ1θ and vπ on J1, in particular the approximation error, can again be characterized using the oblique projection viewpoint [40], similar to the case with Assumption 2.",
      "startOffset" : 207,
      "endOffset" : 211
    }, {
      "referenceID" : 46,
      "context" : "This is very similar to the case of TD(λ) with possibly linearly dependent features discussed in [48].",
      "startOffset" : 97,
      "endOffset" : 101
    }, {
      "referenceID" : 34,
      "context" : "2 Off-policy TD(λ) Applying TD(λ) to off-policy learning by using importance sampling techniques was first proposed in [36, 35], and the focus there was on episodic data.",
      "startOffset" : 119,
      "endOffset" : 127
    }, {
      "referenceID" : 33,
      "context" : "2 Off-policy TD(λ) Applying TD(λ) to off-policy learning by using importance sampling techniques was first proposed in [36, 35], and the focus there was on episodic data.",
      "startOffset" : 119,
      "endOffset" : 127
    }, {
      "referenceID" : 3,
      "context" : "The analysis we gave in this paper applies directly to the (non-episodic) off-policy TD(λ) algorithm studied in [5, 51, 10], when its divergence issue is avoided by setting λ sufficiently large.",
      "startOffset" : 112,
      "endOffset" : 123
    }, {
      "referenceID" : 49,
      "context" : "The analysis we gave in this paper applies directly to the (non-episodic) off-policy TD(λ) algorithm studied in [5, 51, 10], when its divergence issue is avoided by setting λ sufficiently large.",
      "startOffset" : 112,
      "endOffset" : 123
    }, {
      "referenceID" : 8,
      "context" : "The analysis we gave in this paper applies directly to the (non-episodic) off-policy TD(λ) algorithm studied in [5, 51, 10], when its divergence issue is avoided by setting λ sufficiently large.",
      "startOffset" : 112,
      "endOffset" : 123
    }, {
      "referenceID" : 0,
      "context" : "Specifically, we consider constant γ ∈ [0, 1) and constant λ ∈ [0, 1], and an infinitely long trajectory generated by the behavior policy as before.",
      "startOffset" : 63,
      "endOffset" : 69
    }, {
      "referenceID" : 3,
      "context" : ", It is not necessary to multiply the term φ(St)θt by ρt, and that version of the algorithm was the one given in [5, 51].",
      "startOffset" : 113,
      "endOffset" : 120
    }, {
      "referenceID" : 49,
      "context" : ", It is not necessary to multiply the term φ(St)θt by ρt, and that version of the algorithm was the one given in [5, 51].",
      "startOffset" : 113,
      "endOffset" : 120
    }, {
      "referenceID" : 8,
      "context" : "The experimental results in [10] suggest to us that each version can have less variance than the other in some occasions, however.",
      "startOffset" : 28,
      "endOffset" : 32
    }, {
      "referenceID" : 49,
      "context" : "As far as convergence analysis is concerned, the two versions are essentially the same and the analyses given in [51, 52] and this paper indeed apply simultaneously to both versions of the algorithm.",
      "startOffset" : 113,
      "endOffset" : 121
    }, {
      "referenceID" : 50,
      "context" : "As far as convergence analysis is concerned, the two versions are essentially the same and the analyses given in [51, 52] and this paper indeed apply simultaneously to both versions of the algorithm.",
      "startOffset" : 113,
      "endOffset" : 121
    }, {
      "referenceID" : 46,
      "context" : "1(ii), the associated projected Bellman equation is the same as that for onpolicy TD(λ) [48] except that the projection norm is the weighted Euclidean norm with weights given by the steady state probabilities dπo(s), s ∈ S.",
      "startOffset" : 88,
      "endOffset" : 92
    }, {
      "referenceID" : 3,
      "context" : "Assuming Φ has full column rank, the corresponding equation in the θ-space, Cθ+ b = 0, has the desired property that the matrix C is negative definite, if λ is sufficiently large (in particular if λ = 1) [5].",
      "startOffset" : 204,
      "endOffset" : 207
    }, {
      "referenceID" : 49,
      "context" : "(In fact, some of these properties were first derived for off-policy LSTD(λ) and TD(λ) in [51] and extended later in [52] to ETD(λ).",
      "startOffset" : 90,
      "endOffset" : 94
    }, {
      "referenceID" : 50,
      "context" : "(In fact, some of these properties were first derived for off-policy LSTD(λ) and TD(λ) in [51] and extended later in [52] to ETD(λ).",
      "startOffset" : 117,
      "endOffset" : 121
    }, {
      "referenceID" : 50,
      "context" : ") For the same reason, the convergence analyses we gave in [52] and this paper for ETD also apply to a variation of the ETD algorithm, ETD(λ, β), proposed recently by Hallak et al.",
      "startOffset" : 59,
      "endOffset" : 63
    }, {
      "referenceID" : 13,
      "context" : "[15], when the parameter β is set in an appropriate range.",
      "startOffset" : 0,
      "endOffset" : 4
    }, {
      "referenceID" : 12,
      "context" : ", [14, 38].",
      "startOffset" : 2,
      "endOffset" : 10
    }, {
      "referenceID" : 36,
      "context" : ", [14, 38].",
      "startOffset" : 2,
      "endOffset" : 10
    }, {
      "referenceID" : 26,
      "context" : ") The two biased constrained algorithms discussed in this paper were motivated by the need to mitigate the variance problem, and their robust behavior has been observed in our experiments [28, 53].",
      "startOffset" : 188,
      "endOffset" : 196
    }, {
      "referenceID" : 51,
      "context" : ") The two biased constrained algorithms discussed in this paper were motivated by the need to mitigate the variance problem, and their robust behavior has been observed in our experiments [28, 53].",
      "startOffset" : 188,
      "endOffset" : 196
    }, {
      "referenceID" : 36,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 122,
      "endOffset" : 129
    }, {
      "referenceID" : 0,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 122,
      "endOffset" : 129
    }, {
      "referenceID" : 34,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 163,
      "endOffset" : 179
    }, {
      "referenceID" : 33,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 163,
      "endOffset" : 179
    }, {
      "referenceID" : 25,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 163,
      "endOffset" : 179
    }, {
      "referenceID" : 24,
      "context" : "However, beyond simply constraining the iterates, more variance reduction techniques are needed, such as control variates [38, 1] and weighted importance sampling [36, 35, 27, 26].",
      "startOffset" : 163,
      "endOffset" : 179
    }, {
      "referenceID" : 50,
      "context" : "Regarding convergence analysis of ETD(λ), the results we gave in [52] and this paper concern only the convergence properties and not the rates of convergence.",
      "startOffset" : 65,
      "endOffset" : 69
    }, {
      "referenceID" : 29,
      "context" : "Finally, besides asymptotic behavior of the algorithms, their finite-time or finite-sample properties (such as those considered by [31, 2, 20, 21]), and their large deviations properties are also worth studying.",
      "startOffset" : 131,
      "endOffset" : 146
    }, {
      "referenceID" : 1,
      "context" : "Finally, besides asymptotic behavior of the algorithms, their finite-time or finite-sample properties (such as those considered by [31, 2, 20, 21]), and their large deviations properties are also worth studying.",
      "startOffset" : 131,
      "endOffset" : 146
    }, {
      "referenceID" : 18,
      "context" : "Finally, besides asymptotic behavior of the algorithms, their finite-time or finite-sample properties (such as those considered by [31, 2, 20, 21]), and their large deviations properties are also worth studying.",
      "startOffset" : 131,
      "endOffset" : 146
    }, {
      "referenceID" : 19,
      "context" : "Finally, besides asymptotic behavior of the algorithms, their finite-time or finite-sample properties (such as those considered by [31, 2, 20, 21]), and their large deviations properties are also worth studying.",
      "startOffset" : 131,
      "endOffset" : 146
    } ],
    "year" : 2017,
    "abstractText" : "We consider the emphatic temporal-difference (TD) algorithm, ETD(λ), for learning the value functions of stationary policies in a discounted, finite state and action Markov decision process. The ETD(λ) algorithm was recently proposed by Sutton, Mahmood, and White [46] to solve a long-standing divergence problem of the standard TD algorithm when it is applied to off-policy training, where data from an exploratory policy are used to evaluate other policies of interest. The almost sure convergence of ETD(λ) has been proved in our recent work under general off-policy training conditions, but for a narrow range of diminishing stepsize. In this paper we present convergence results for constrained versions of ETD(λ) with constant stepsize and with diminishing stepsize from a broad range. Our results characterize the asymptotic behavior of the trajectory of iterates produced by those algorithms, and are derived by combining key properties of ETD(λ) with powerful convergence theorems from the weak convergence methods in stochastic approximation theory. For the case of constant stepsize, in addition to analyzing the behavior of the algorithms in the limit as the stepsize parameter approaches zero, we also analyze their behavior for a fixed stepsize and bound the deviations of their averaged iterates from the desired solution. These results are obtained by exploiting the weak Feller property of the Markov chains associated with the algorithms, and by using ergodic theorems for weak Feller Markov chains, in conjunction with the convergence results we get from the weak convergence methods. Besides ETD(λ), our analysis also applies to the off-policy TD(λ) algorithm, when the divergence issue is avoided by setting λ sufficiently large. It yields, for that case, new results on the asymptotic convergence properties of constrained off-policy TD(λ) with constant or slowly diminishing stepsize.",
    "creator" : "LaTeX with hyperref package"
  }
}